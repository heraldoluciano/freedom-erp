/******************************************************************************/
/*             Generated by IBExpert 2008.08.08 9/2/2009 20:57:15             */
/******************************************************************************/

SET SQL DIALECT 3;

SET NAMES NONE;

CREATE DATABASE 'localhost:/opt/firebird/dados/desenv/freedom.fdb'
USER 'SYSDBA' PASSWORD 'masterkey'
PAGE_SIZE 4096
DEFAULT CHARACTER SET NONE;



/******************************************************************************/
/*                           User Defined Functions                           */
/******************************************************************************/

DECLARE EXTERNAL FUNCTION ABS
    DOUBLE PRECISION
    RETURNS DOUBLE PRECISION BY VALUE
    ENTRY_POINT 'IB_UDF_abs' MODULE_NAME 'ib_udf';


DECLARE EXTERNAL FUNCTION ACOS
    DOUBLE PRECISION
    RETURNS DOUBLE PRECISION BY VALUE
    ENTRY_POINT 'IB_UDF_acos' MODULE_NAME 'ib_udf';


DECLARE EXTERNAL FUNCTION ADDDAY
    TIMESTAMP,
    INTEGER
    RETURNS TIMESTAMP
    ENTRY_POINT 'addDay' MODULE_NAME 'fbudf';


DECLARE EXTERNAL FUNCTION ADDHOUR
    TIMESTAMP,
    INTEGER
    RETURNS TIMESTAMP
    ENTRY_POINT 'addHour' MODULE_NAME 'fbudf';


DECLARE EXTERNAL FUNCTION ADDMILLISECOND
    TIMESTAMP,
    INTEGER
    RETURNS TIMESTAMP
    ENTRY_POINT 'addMilliSecond' MODULE_NAME 'fbudf';


DECLARE EXTERNAL FUNCTION ADDMINUTE
    TIMESTAMP,
    INTEGER
    RETURNS TIMESTAMP
    ENTRY_POINT 'addMinute' MODULE_NAME 'fbudf';


DECLARE EXTERNAL FUNCTION ADDMONTH
    TIMESTAMP,
    INTEGER
    RETURNS TIMESTAMP
    ENTRY_POINT 'addMonth' MODULE_NAME 'fbudf';


DECLARE EXTERNAL FUNCTION ADDSECOND
    TIMESTAMP,
    INTEGER
    RETURNS TIMESTAMP
    ENTRY_POINT 'addSecond' MODULE_NAME 'fbudf';


DECLARE EXTERNAL FUNCTION ADDWEEK
    TIMESTAMP,
    INTEGER
    RETURNS TIMESTAMP
    ENTRY_POINT 'addWeek' MODULE_NAME 'fbudf';


DECLARE EXTERNAL FUNCTION ADDYEAR
    TIMESTAMP,
    INTEGER
    RETURNS TIMESTAMP
    ENTRY_POINT 'addYear' MODULE_NAME 'fbudf';


DECLARE EXTERNAL FUNCTION ASCII_CHAR
    INTEGER
    RETURNS CSTRING(1) FREE_IT
    ENTRY_POINT 'IB_UDF_ascii_char' MODULE_NAME 'ib_udf';


DECLARE EXTERNAL FUNCTION ASCII_VAL
    CHAR(1)
    RETURNS INTEGER BY VALUE
    ENTRY_POINT 'IB_UDF_ascii_val' MODULE_NAME 'ib_udf';


DECLARE EXTERNAL FUNCTION ASIN
    DOUBLE PRECISION
    RETURNS DOUBLE PRECISION BY VALUE
    ENTRY_POINT 'IB_UDF_asin' MODULE_NAME 'ib_udf';


DECLARE EXTERNAL FUNCTION ATAN
    DOUBLE PRECISION
    RETURNS DOUBLE PRECISION BY VALUE
    ENTRY_POINT 'IB_UDF_atan' MODULE_NAME 'ib_udf';


DECLARE EXTERNAL FUNCTION ATAN2
    DOUBLE PRECISION,
    DOUBLE PRECISION
    RETURNS DOUBLE PRECISION BY VALUE
    ENTRY_POINT 'IB_UDF_atan2' MODULE_NAME 'ib_udf';


DECLARE EXTERNAL FUNCTION BIN_AND
    INTEGER,
    INTEGER
    RETURNS INTEGER BY VALUE
    ENTRY_POINT 'IB_UDF_bin_and' MODULE_NAME 'ib_udf';


DECLARE EXTERNAL FUNCTION BIN_OR
    INTEGER,
    INTEGER
    RETURNS INTEGER BY VALUE
    ENTRY_POINT 'IB_UDF_bin_or' MODULE_NAME 'ib_udf';


DECLARE EXTERNAL FUNCTION BIN_XOR
    INTEGER,
    INTEGER
    RETURNS INTEGER BY VALUE
    ENTRY_POINT 'IB_UDF_bin_xor' MODULE_NAME 'ib_udf';


DECLARE EXTERNAL FUNCTION CEILING
    DOUBLE PRECISION
    RETURNS DOUBLE PRECISION BY VALUE
    ENTRY_POINT 'IB_UDF_ceiling' MODULE_NAME 'ib_udf';


DECLARE EXTERNAL FUNCTION COS
    DOUBLE PRECISION
    RETURNS DOUBLE PRECISION BY VALUE
    ENTRY_POINT 'IB_UDF_cos' MODULE_NAME 'ib_udf';


DECLARE EXTERNAL FUNCTION COSH
    DOUBLE PRECISION
    RETURNS DOUBLE PRECISION BY VALUE
    ENTRY_POINT 'IB_UDF_cosh' MODULE_NAME 'ib_udf';


DECLARE EXTERNAL FUNCTION COT
    DOUBLE PRECISION
    RETURNS DOUBLE PRECISION BY VALUE
    ENTRY_POINT 'IB_UDF_cot' MODULE_NAME 'ib_udf';


DECLARE EXTERNAL FUNCTION DIV
    INTEGER,
    INTEGER
    RETURNS DOUBLE PRECISION BY VALUE
    ENTRY_POINT 'IB_UDF_div' MODULE_NAME 'ib_udf';


DECLARE EXTERNAL FUNCTION DNULLIF
    DOUBLE PRECISION BY DESCRIPTOR,
    DOUBLE PRECISION BY DESCRIPTOR
    RETURNS DOUBLE PRECISION BY DESCRIPTOR
    ENTRY_POINT 'dNullIf' MODULE_NAME 'fbudf';


DECLARE EXTERNAL FUNCTION DNVL
    DOUBLE PRECISION BY DESCRIPTOR,
    DOUBLE PRECISION BY DESCRIPTOR
    RETURNS DOUBLE PRECISION BY DESCRIPTOR
    ENTRY_POINT 'idNvl' MODULE_NAME 'fbudf';


DECLARE EXTERNAL FUNCTION DOW
    TIMESTAMP,
    VARCHAR(15)
    RETURNS PARAMETER 2
    ENTRY_POINT 'DOW' MODULE_NAME 'fbudf';


DECLARE EXTERNAL FUNCTION DPOWER
    DOUBLE PRECISION BY DESCRIPTOR,
    DOUBLE PRECISION BY DESCRIPTOR,
    DOUBLE PRECISION BY DESCRIPTOR
    RETURNS PARAMETER 3
    ENTRY_POINT 'power' MODULE_NAME 'fbudf';


DECLARE EXTERNAL FUNCTION FLOOR
    DOUBLE PRECISION
    RETURNS DOUBLE PRECISION BY VALUE
    ENTRY_POINT 'IB_UDF_floor' MODULE_NAME 'ib_udf';


DECLARE EXTERNAL FUNCTION GETEXACTTIMESTAMP
    TIMESTAMP
    RETURNS PARAMETER 1
    ENTRY_POINT 'getExactTimestamp' MODULE_NAME 'fbudf';


DECLARE EXTERNAL FUNCTION I64NULLIF
    NUMERIC(18,4) BY DESCRIPTOR,
    NUMERIC(18,4) BY DESCRIPTOR
    RETURNS NUMERIC(18,4) BY DESCRIPTOR
    ENTRY_POINT 'iNullIf' MODULE_NAME 'fbudf';


DECLARE EXTERNAL FUNCTION I64NVL
    NUMERIC(18,0) BY DESCRIPTOR,
    NUMERIC(18,0) BY DESCRIPTOR
    RETURNS NUMERIC(18,0) BY DESCRIPTOR
    ENTRY_POINT 'idNvl' MODULE_NAME 'fbudf';


DECLARE EXTERNAL FUNCTION I64ROUND
    NUMERIC(18,4) BY DESCRIPTOR,
    NUMERIC(18,4) BY DESCRIPTOR
    RETURNS PARAMETER 2
    ENTRY_POINT 'fbround' MODULE_NAME 'fbudf';


DECLARE EXTERNAL FUNCTION I64TRUNCATE
    NUMERIC(18,0) BY DESCRIPTOR,
    NUMERIC(18,0) BY DESCRIPTOR
    RETURNS PARAMETER 2
    ENTRY_POINT 'fbtruncate' MODULE_NAME 'fbudf';


DECLARE EXTERNAL FUNCTION INULLIF
    INTEGER BY DESCRIPTOR,
    INTEGER BY DESCRIPTOR
    RETURNS INTEGER BY DESCRIPTOR
    ENTRY_POINT 'iNullIf' MODULE_NAME 'fbudf';


DECLARE EXTERNAL FUNCTION INVL
    INTEGER BY DESCRIPTOR,
    INTEGER BY DESCRIPTOR
    RETURNS INTEGER BY DESCRIPTOR
    ENTRY_POINT 'idNvl' MODULE_NAME 'fbudf';


DECLARE EXTERNAL FUNCTION LN
    DOUBLE PRECISION
    RETURNS DOUBLE PRECISION BY VALUE
    ENTRY_POINT 'IB_UDF_ln' MODULE_NAME 'ib_udf';


DECLARE EXTERNAL FUNCTION LOG
    DOUBLE PRECISION,
    DOUBLE PRECISION
    RETURNS DOUBLE PRECISION BY VALUE
    ENTRY_POINT 'IB_UDF_log' MODULE_NAME 'ib_udf';


DECLARE EXTERNAL FUNCTION LOG10
    DOUBLE PRECISION
    RETURNS DOUBLE PRECISION BY VALUE
    ENTRY_POINT 'IB_UDF_log10' MODULE_NAME 'ib_udf';


DECLARE EXTERNAL FUNCTION LOWER
    CSTRING(80)
    RETURNS CSTRING(80) FREE_IT
    ENTRY_POINT 'IB_UDF_lower' MODULE_NAME 'ib_udf';


DECLARE EXTERNAL FUNCTION LTRIM
    CSTRING(80)
    RETURNS CSTRING(80) FREE_IT
    ENTRY_POINT 'IB_UDF_ltrim' MODULE_NAME 'ib_udf';


DECLARE EXTERNAL FUNCTION MOD
    INTEGER,
    INTEGER
    RETURNS DOUBLE PRECISION BY VALUE
    ENTRY_POINT 'IB_UDF_mod' MODULE_NAME 'ib_udf';


DECLARE EXTERNAL FUNCTION PI

    RETURNS DOUBLE PRECISION BY VALUE
    ENTRY_POINT 'IB_UDF_pi' MODULE_NAME 'ib_udf';


DECLARE EXTERNAL FUNCTION RAND

    RETURNS DOUBLE PRECISION BY VALUE
    ENTRY_POINT 'IB_UDF_rand' MODULE_NAME 'ib_udf';


DECLARE EXTERNAL FUNCTION ROUND
    INTEGER BY DESCRIPTOR,
    INTEGER BY DESCRIPTOR
    RETURNS PARAMETER 2
    ENTRY_POINT 'fbround' MODULE_NAME 'fbudf';


DECLARE EXTERNAL FUNCTION RTRIM
    CSTRING(80)
    RETURNS CSTRING(80) FREE_IT
    ENTRY_POINT 'IB_UDF_rtrim' MODULE_NAME 'ib_udf';


DECLARE EXTERNAL FUNCTION SDOW
    TIMESTAMP,
    VARCHAR(5)
    RETURNS PARAMETER 2
    ENTRY_POINT 'SDOW' MODULE_NAME 'fbudf';


DECLARE EXTERNAL FUNCTION SIGN
    DOUBLE PRECISION
    RETURNS INTEGER BY VALUE
    ENTRY_POINT 'IB_UDF_sign' MODULE_NAME 'ib_udf';


DECLARE EXTERNAL FUNCTION SIN
    DOUBLE PRECISION
    RETURNS DOUBLE PRECISION BY VALUE
    ENTRY_POINT 'IB_UDF_sin' MODULE_NAME 'ib_udf';


DECLARE EXTERNAL FUNCTION SINH
    DOUBLE PRECISION
    RETURNS DOUBLE PRECISION BY VALUE
    ENTRY_POINT 'IB_UDF_sinh' MODULE_NAME 'ib_udf';


DECLARE EXTERNAL FUNCTION SQRT
    DOUBLE PRECISION
    RETURNS DOUBLE PRECISION BY VALUE
    ENTRY_POINT 'IB_UDF_sqrt' MODULE_NAME 'ib_udf';


DECLARE EXTERNAL FUNCTION STRLEN
    CSTRING(32767)
    RETURNS INTEGER BY VALUE
    ENTRY_POINT 'IB_UDF_strlen' MODULE_NAME 'ib_udf';


DECLARE EXTERNAL FUNCTION SUBSTR
    CSTRING(80),
    SMALLINT,
    SMALLINT
    RETURNS CSTRING(80) FREE_IT
    ENTRY_POINT 'IB_UDF_substr' MODULE_NAME 'ib_udf';


DECLARE EXTERNAL FUNCTION TAN
    DOUBLE PRECISION
    RETURNS DOUBLE PRECISION BY VALUE
    ENTRY_POINT 'IB_UDF_tan' MODULE_NAME 'ib_udf';


DECLARE EXTERNAL FUNCTION TANH
    DOUBLE PRECISION
    RETURNS DOUBLE PRECISION BY VALUE
    ENTRY_POINT 'IB_UDF_tanh' MODULE_NAME 'ib_udf';


DECLARE EXTERNAL FUNCTION TRUNCATE
    INTEGER BY DESCRIPTOR,
    INTEGER BY DESCRIPTOR
    RETURNS PARAMETER 2
    ENTRY_POINT 'fbtruncate' MODULE_NAME 'fbudf';




/******************************************************************************/
/*                                  Domains                                   */
/******************************************************************************/

CREATE DOMAIN CHARMIDDLEDN AS
CHAR(50);

CREATE DOMAIN CHARSMALLDN AS
CHAR(30);

CREATE DOMAIN NEW_DOMAIN AS
INTEGER;

CREATE DOMAIN NUMERICDN AS
NUMERIC(15,5);

CREATE DOMAIN TIMEDN AS
TIME;



/******************************************************************************/
/*                                 Generators                                 */
/******************************************************************************/

CREATE GENERATOR SGOBJETOINC;
SET GENERATOR SGOBJETOINC TO 0;



/******************************************************************************/
/*                                 Exceptions                                 */
/******************************************************************************/

CREATE EXCEPTION CPCOMPRAEX03 'COMPRA NÃO PODE SER MAIS ALTERADA!';

CREATE EXCEPTION CPCOMPRAEX04 'VALOR DA COMPRA É DIFERENTE DO VALOR A RECEBER!';

CREATE EXCEPTION CPITCOMPRAEX01 'PRODUTO NÃO PODE SER ALTERADO!';

CREATE EXCEPTION CPITCOMPRAEX02 'LOTE NÃO PODE SER ALTERADO!';

CREATE EXCEPTION CPITSOLICITACAO 'QUANTIDADE APROVADA MAIOR QUE A SOLICITADA!';

CREATE EXCEPTION CPITSOLICITACAOEX01 'PRODUTO NÃO PODE SER ALTERADO!';

CREATE EXCEPTION EQALMOX01 'ALMOXARIFADO NÃO PODE SER TROCADO!';

CREATE EXCEPTION EQINVPRODEX01 'O PRODUTO NÃO PODE SER ALTERADO!';

CREATE EXCEPTION EQINVPRODEX02 'O LOTE NÃO PODE SER ALTERADO!';

CREATE EXCEPTION EQINVPRODEX03 'A DATA NÃO PODE SER ALTERADA!';

CREATE EXCEPTION EQINVPRODEX04 'O ALMOXARIFADO NÃO PODE SER ALTERADO!';

CREATE EXCEPTION EQINVPRODEX05 'CÓDIGO DO LOTE É REQUERIDO';

CREATE EXCEPTION EQITRMA 'QUANTIDADE APROVADA MAIOR QUE A SOLICITADA!';

CREATE EXCEPTION EQITRMA01 'Item não pode ser excluído pois já está em andamento.';

CREATE EXCEPTION EQITRMA02 'Item não pode ser excluído pois foi criado por outro usuário.';

CREATE EXCEPTION EQLOTEEX01 'ESTOQUE DO LOTE ZERADO!';

CREATE EXCEPTION EQPRODUTOEX01 'ESTOQUE ZERADO!';

CREATE EXCEPTION EQSIMILAREX01 'Produto já foi agrupado!';

CREATE EXCEPTION EQTIPOMOVEX01 'MOVIMENTO DE COMPRA NÃO PODE TER TABELA DE PREÇO!';

CREATE EXCEPTION EQTIPOMOVEX02 'TABELA DE PREÇO EM BRANCO!';

CREATE EXCEPTION FNITRECEBEREX01 'PARCELA JÁ FOI PAGA!';

CREATE EXCEPTION FNPAGAREX01 'PARCELA JÁ FOI PAGA!';

CREATE EXCEPTION FNRECEBEREX01 'Cliente inativo!';

CREATE EXCEPTION FNRECEBEREX02 'Cliente possui restrições!';

CREATE EXCEPTION FNSUBLANCAEX01 'NÃO É POSSÍVEL ADICIONAR DOIS SUBLANÇAMENTOS PARA UMA TRANSFERÊNCIA!';

CREATE EXCEPTION FNSUBLANCAEX02 'CONTAS DE DESPESAS OU RECEITAS NÃO PODEM PARTICIPAR DE TRANSFERÊNCIAS!';

CREATE EXCEPTION FNSUBLANCAEX03 'CONTAS DE BANCOS OU CAIXAS SÓ PODEM SE INTERAGIREM EM TRANSFERÊNCIAS!';

CREATE EXCEPTION FNSUBLANCAEX04 'LANÇAMENTO COM VALOR ZERO!';

CREATE EXCEPTION FNSUBSLANCAEX01 'NÃO É POSSÍVEL ADICIONAR DOIS SUBLANÇAMENTOS PARA UMA TRANSFERÊNCIA!';

CREATE EXCEPTION FNSUBSLANCAEX02 'CONTAS DE DESPESAS OU RECEITAS NÃO PODEM PARTICIPAR DE TRANSFERÊNCIAS!';

CREATE EXCEPTION FNSUBSLANCAEX03 'CONTAS DE BANCOS OU CAIXAS SÓ PODEM SE INTERAGIREM EM TRANSFERÊNCIAS!';

CREATE EXCEPTION PPESTRUFASE01 'Já existe uma fase que finalizadora neste processo!';

CREATE EXCEPTION PPESTRUTURAEX01 'Estrutura não pode ser ativada, pois não possui uma fase finalizadora!';

CREATE EXCEPTION PPOPFASE 'Existem fases não concluidas para essa OP.';

CREATE EXCEPTION PVSEQCAIXA01 'FAIXA DE SEQUENCIA DO CAIXA NÃO DEFINIDA';

CREATE EXCEPTION PVSEQCAIXA02 'FAIXA DE SEQUENCIA DO CAIXA EXCEDIDA!';

CREATE EXCEPTION SGCONEXAOEX01 'Banco de dados está conectado com este usuário em outra filial!';

CREATE EXCEPTION SGCONEXAOEX02 'Usuário inválido.';

CREATE EXCEPTION SGFILIALEX01 'EMPRESA NÃO POSSUI MATRIZ!';

CREATE EXCEPTION SGFILIALEX02 'NÃO FOI POSSÍVEL ENCONTRAR FILIAL ATIVA PARA ESTE USUÁRIO!';

CREATE EXCEPTION TKGERACAMANHACTO01 'Não existe atendente vinculado ao usuário atual!';

CREATE EXCEPTION VDCLCOMISEX01 'PERCENTUAL TOTAL DE DISTRIBUIÇÃO INVÁLIDO!';

CREATE EXCEPTION VDCOMISSAOEX01 'COMISSAO JA FOI PAGA!';

CREATE EXCEPTION VDCOMISSAOEX02 'COMISSAO NAO FOI LIBERADA!';

CREATE EXCEPTION VDITVENDAEX01 'PRODUTO NÃO PODE SER ALTERADO!';

CREATE EXCEPTION VDITVENDAEX02 'LOTE NÃO PODE SER ALTERADO!';

CREATE EXCEPTION VDITVENDAEX03 'NÃO FOI POSSÍVEL ENCONTRAR A NATUREZA DA OPERAÇÃO';

CREATE EXCEPTION VDVENDAEX01 'ERRO LIVRE!!!!';

CREATE EXCEPTION VDVENDAEX02 'Venda não foi liberada!';

CREATE EXCEPTION VDVENDAEX03 'Valor ultrapassa o valor liberado!';

CREATE EXCEPTION VDVENDAEX04 'Valor ultrapassa o limite de crédito!';

CREATE EXCEPTION VDVENDAEX05 'ESTA VENDA FOI CANCELADA!';

CREATE EXCEPTION VDVENDAEX06 'O TOTAL DA NOTA NÃO CONFERE COM TOTAL DAS PARCELAS!';



SET TERM ^ ; 



/******************************************************************************/
/*                             Stored Procedures                              */
/******************************************************************************/

CREATE PROCEDURE ARREDDOUBLE (
    DEVALOR DOUBLE PRECISION,
    ICASASDEC INTEGER)
RETURNS (
    DERETORNO DOUBLE PRECISION)
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE ATADICATENDIMENTOCLISP (
    ICODTIPOATENDO INTEGER,
    ICODATEND INTEGER,
    ICODSETOR INTEGER,
    ICODEMP INTEGER,
    ICODFILIAL INTEGER,
    IDOC INTEGER,
    DATAATENDO DATE,
    DATAATENDOFIN DATE,
    HORAATENDO TIME,
    HORAATENDOFIN TIME,
    OBSATENDO VARCHAR(1000),
    CODEMPCL INTEGER,
    CODFILIALCL SMALLINT,
    CODCLI INTEGER)
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE ATADICATENDIMENTOSP (
    ICODCONV INTEGER,
    ICODTIPOATENDO INTEGER,
    ICODATEND INTEGER,
    ICODSETOR INTEGER,
    VOBSATENDO VARCHAR(10000),
    ICODEMP INTEGER,
    ICODFILIAL INTEGER,
    IDOC INTEGER)
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE ATBUSCAPRECOSP (
    ICODPROD INTEGER,
    ICODCONV INTEGER,
    ICODEMPCV INTEGER,
    ICODFILIALCV SMALLINT,
    ICODPLANOPAG INTEGER,
    ICODEMPPG INTEGER,
    ICODFILIALPG SMALLINT,
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT)
RETURNS (
    PRECO NUMERIC(15,5))
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE CPADICFORSP (
    CODEMP INTEGER,
    CODFILIAL INTEGER,
    CODFILIALCL INTEGER,
    CODCLI INTEGER)
RETURNS (
    CODFOR INTEGER)
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE CPBLOQCOMPRASP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODCOMPRA INTEGER,
    CBLOQCOMPRA CHAR(1))
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE CPCOMPRASP01 (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    NQTD NUMERIC(15,5),
    NVLRTOT NUMERIC(15,5),
    NVLRICMS NUMERIC(15,5))
RETURNS (
    NVLRCUSTO NUMERIC(15,5))
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE CPGERAENTRADASP (
    CODEMP INTEGER,
    CODFILIAL INTEGER,
    CODFILIALVD INTEGER,
    TIPOVENDA CHAR(1),
    CODVENDA INTEGER,
    CITEM CHAR(1))
RETURNS (
    CODCOMPRA INTEGER)
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE CPGERAITENTRADASP (
    CODEMP INTEGER,
    CODFILIAL INTEGER,
    CODCOMPRA INTEGER,
    CODFILIALVD INTEGER,
    TIPOVENDA CHAR(1),
    CODVENDA INTEGER,
    CODITVENDA INTEGER,
    QTDIT INTEGER)
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE EQACERTACUSTORMASP
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE EQADICPRODUTOSP (
    ICODPROD INTEGER,
    SDESCPROD CHAR(50),
    SDESCAUXPROD CHAR(40),
    SREFPROD CHAR(13),
    SCODFABPROD CHAR(13),
    SCODBARPROD CHAR(13),
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT)
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE EQBUSCASIMILARSP (
    CODEMP INTEGER,
    CODFILIAL CHAR(8),
    IPROD INTEGER,
    SREFPROD CHAR(13))
RETURNS (
    SRET CHAR(13),
    IRET INTEGER,
    CORIG CHAR(1),
    ICODFOR INTEGER,
    SRAZFOR CHAR(50),
    NPRECO NUMERIC(15,5),
    SSIM CHAR(18),
    SSIMMASTER CHAR(18))
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE EQCALCPEPSSP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODPROD INTEGER,
    NSLDPROD NUMERIC(15,5),
    DTESTOQ DATE,
    ICODEMPAX INTEGER,
    SCODFILIALAX SMALLINT,
    ICODALMOX INTEGER)
RETURNS (
    NCUSTOPEPS NUMERIC(15,5))
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE EQCOPIAPROD (
    ICODPROD INTEGER,
    ICODEMP INTEGER,
    ICODFILIAL INTEGER)
RETURNS (
    ICOD INTEGER)
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE EQCUSTOPRODSP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODPROD INTEGER,
    DTESTOQ DATE,
    CTIPOCUSTO CHAR(1),
    ICODEMPAX INTEGER,
    SCODFILIALAX SMALLINT,
    ICODALMOX INTEGER,
    CCOMSALDO CHAR(10))
RETURNS (
    SLDPROD NUMERIC(15,5),
    CUSTOUNIT NUMERIC(15,5),
    CUSTOTOT NUMERIC(15,5))
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE EQGERARMASP (
    CODEMPOP INTEGER,
    CODFILIALOP INTEGER,
    CODOP INTEGER,
    SEQOP SMALLINT)
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE EQMOVPRODATEQSP (
    ICODEMPPD INTEGER,
    SCODFILIALPD SMALLINT,
    ICODPROD INTEGER,
    ICODEMPLEOLD INTEGER,
    SCODFILIALLEOLD SMALLINT,
    CCODLOTEOLD VARCHAR(20),
    ICODEMPLENEW INTEGER,
    SCODFILIALLENEW SMALLINT,
    CCODLOTENEW VARCHAR(20),
    SOPERADOR SMALLINT,
    NQTDMOVPRODOLD NUMERIC(15,5),
    NQTDMOVPRODNEW NUMERIC(15,5),
    ICODEMPAXOLD INTEGER,
    SCODFILIALAXOLD SMALLINT,
    ICODALMOXOLD INTEGER,
    ICODEMPAXNEW INTEGER,
    SCODFILIALAXNEW SMALLINT,
    ICODALMOXNEW INTEGER)
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE EQMOVPRODCKCPSP (
    ICODEMPPD INTEGER,
    SCODFILIALPD SMALLINT,
    ICODPROD INTEGER,
    ICODCOMPRA INTEGER,
    ICODINVPROD INTEGER,
    DDTMOVPROD DATE,
    NQTDMOVPROD NUMERIC(15,5),
    NCUSTOMPMMOVPROD NUMERIC(15,5))
RETURNS (
    DDTULTCPPROD DATE,
    NQTDULTCPPROD NUMERIC(15,5),
    DDTMPMPROD DATE,
    NCUSTOMPMPROD NUMERIC(15,5))
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE EQMOVPRODCKTMSP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODTIPOMOV INTEGER)
RETURNS (
    CESTIPOMOV CHAR(1),
    SOPERADOR SMALLINT)
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE EQMOVPRODCKUTMSP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODTIPOMOV INTEGER,
    ICODEMPOLD INTEGER,
    SCODFILIALOLD SMALLINT,
    ICODTIPOMOVOLD INTEGER)
RETURNS (
    CALTTM CHAR(1))
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE EQMOVPRODCSLDSP (
    ICODEMPTM INTEGER,
    SCODFILIALTM SMALLINT,
    ICODTIPOMOV INTEGER,
    NQTDMOVPROD NUMERIC(15,5),
    NPRECOMOVPROD NUMERIC(15,5),
    NCUSTOMPMMOVPROD NUMERIC(15,5),
    NSLDMOVPROD NUMERIC(15,5))
RETURNS (
    NCUSTOMPM NUMERIC(15,5),
    NSALDO NUMERIC(15,5),
    CESTOQMOVPROD CHAR(1),
    CTIPOMOVPROD CHAR(1),
    SOPERADOR SMALLINT)
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE EQMOVPRODDSP (
    ICODEMPPD INTEGER,
    SCODFILIALPD SMALLINT,
    ICODPROD INTEGER,
    ICODEMPIV INTEGER,
    SCODFILIALIV SMALLINT,
    ICODINVPROD INTEGER,
    ICODEMPCP INTEGER,
    SCODFILIALCP SMALLINT,
    ICODCOMPRA INTEGER,
    SCODITCOMPRA SMALLINT,
    ICODEMPVD INTEGER,
    SCODFILIALVD SMALLINT,
    CTIPOVENDA CHAR(1),
    ICODVENDA INTEGER,
    SCODITVENDA SMALLINT,
    ICODEMPRM INTEGER,
    SCODFILIALRM SMALLINT,
    ICODRMA INTEGER,
    SCODITRMA SMALLINT,
    ICODEMPOP INTEGER,
    SCODFILIALOP SMALLINT,
    ICODOP INTEGER,
    SSEQOP SMALLINT,
    DDTMOVPROD DATE,
    ICODEMPAX INTEGER,
    SCODFILIALAX SMALLINT,
    ICODALMOX INTEGER,
    CMULTIALMOX CHAR(1))
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE EQMOVPRODISP (
    ICODEMPPD INTEGER,
    SCODFILIALPD SMALLINT,
    ICODPROD INTEGER,
    ICODEMPLE INTEGER,
    SCODFILIALLE SMALLINT,
    CCODLOTE VARCHAR(20),
    ICODEMPTM INTEGER,
    SCODFILIALTM SMALLINT,
    ICODTIPOMOV INTEGER,
    ICODEMPIV INTEGER,
    SCODFILIALIV SMALLINT,
    ICODINVPROD INTEGER,
    ICODEMPCP INTEGER,
    SCODFILIALCP SMALLINT,
    ICODCOMPRA INTEGER,
    SCODITCOMPRA SMALLINT,
    ICODEMPVD INTEGER,
    SCODFILIALVD SMALLINT,
    CTIPOVENDA CHAR(1),
    ICODVENDA INTEGER,
    SCODITVENDA SMALLINT,
    ICODEMPRM INTEGER,
    SCODFILIALRM SMALLINT,
    ICODRMA INTEGER,
    SCODITRMA SMALLINT,
    ICODEMPOP INTEGER,
    SCODFILIALOP SMALLINT,
    ICODOP INTEGER,
    SSEQOP SMALLINT,
    ICODEMPNT INTEGER,
    SCODFILIALNT SMALLINT,
    CCODNAT CHAR(4),
    DDTMOVPROD DATE,
    IDOCMOVPROD INTEGER,
    CFLAG CHAR(1),
    NQTDMOVPROD NUMERIC(15,5),
    NPRECOMOVPROD NUMERIC(15,5),
    ICODEMPAX INTEGER,
    SCODFILIALAX SMALLINT,
    ICODALMOX INTEGER,
    CMULTIALMOX CHAR(1))
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE EQMOVPRODIUDSP (
    CIUD CHAR(1),
    ICODEMPPD INTEGER,
    SCODFILIALPD SMALLINT,
    ICODPROD INTEGER,
    ICODEMPLE INTEGER,
    SCODFILIALLE SMALLINT,
    CCODLOTE VARCHAR(20),
    ICODEMPTM INTEGER,
    SCODFILIALTM SMALLINT,
    ICODTIPOMOV INTEGER,
    ICODEMPIV INTEGER,
    SCODFILIALIV SMALLINT,
    ICODINVPROD INTEGER,
    ICODEMPCP INTEGER,
    SCODFILIALCP SMALLINT,
    ICODCOMPRA INTEGER,
    SCODITCOMPRA SMALLINT,
    ICODEMPVD INTEGER,
    SCODFILIALVD SMALLINT,
    CTIPOVENDA CHAR(1),
    ICODVENDA INTEGER,
    SCODITVENDA SMALLINT,
    ICODEMPRM INTEGER,
    SCODFILIALRM SMALLINT,
    ICODRMA INTEGER,
    SCODITRMA SMALLINT,
    ICODEMPOP INTEGER,
    SCODFILIALOP SMALLINT,
    ICODOP INTEGER,
    SSEQOP SMALLINT,
    ICODEMPNT INTEGER,
    SCODFILIALNT SMALLINT,
    CCODNAT CHAR(4),
    DDTMOVPROD DATE,
    IDOCMOVPROD INTEGER,
    CFLAG CHAR(1),
    NQTDMOVPROD NUMERIC(15,5),
    NPRECOMOVPROD NUMERIC(15,5),
    ICODEMPAX INTEGER,
    SCODFILIALAX SMALLINT,
    ICODALMOX INTEGER)
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE EQMOVPRODPRCSLDSP (
    SCODFILIAL SMALLINT,
    ICODMOVPROD INTEGER,
    ICODEMPPD INTEGER,
    SCODFILIALPD SMALLINT,
    ICODPROD INTEGER,
    DDTMOVPROD DATE,
    DDTMOVPRODPRC DATE,
    NSLDMOVPROD NUMERIC(15,5),
    NCUSTOMPMMOVPROD NUMERIC(15,5),
    NSLDMOVPRODAX NUMERIC(15,5),
    NCUSTOMPMMOVPRODAX NUMERIC(15,5),
    ICODEMPAX INTEGER,
    SCODFILIALAX SMALLINT,
    ICODALMOX INTEGER,
    CMULTIALMOX CHAR(1))
RETURNS (
    NSLDPRC NUMERIC(15,5),
    NCUSTOMPMPRC NUMERIC(15,5),
    NSLDPRCAX NUMERIC(15,5),
    NCUSTOMPMPRCAX NUMERIC(15,5))
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE EQMOVPRODRETCODSP (
    ICODEMPIV INTEGER,
    SCODFILIALIV SMALLINT,
    ICODINVPROD INTEGER,
    ICODEMPCP INTEGER,
    SCODFILIALCP SMALLINT,
    ICODCOMPRA INTEGER,
    SCODITCOMPRA SMALLINT,
    ICODEMPVD INTEGER,
    SCODFILIALVD SMALLINT,
    CTIPOVENDA CHAR(1),
    ICODVENDA INTEGER,
    SCODITVENDA SMALLINT,
    ICODEMPRM INTEGER,
    SCODFILIALRM SMALLINT,
    ICODRMA INTEGER,
    SCODITRMA SMALLINT,
    ICODEMPOP INTEGER,
    SCODFILIALOP SMALLINT,
    ICODOP INTEGER,
    SSEQOP SMALLINT)
RETURNS (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODMOVPROD INTEGER)
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE EQMOVPRODSEQSP (
    ICODEMP INTEGER)
RETURNS (
    SCODFILIAL SMALLINT,
    ICODMOVPROD INTEGER)
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE EQMOVPRODSLDSP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODMOVPROD INTEGER,
    ICODEMPPD INTEGER,
    SCODFILIALPD SMALLINT,
    ICODPROD INTEGER,
    DDTMOVPROD DATE,
    NCUSTOMPMMOVPROD NUMERIC(15,5),
    NCUSTOMPMMOVPRODAX NUMERIC(15,5),
    ICODEMPAX INTEGER,
    SCODFILIALAX SMALLINT,
    ICODALMOX INTEGER,
    CMULTIALMOX CHAR(1))
RETURNS (
    NSALDO NUMERIC(15,5),
    NCUSTOMPM NUMERIC(15,5),
    ICODMOVPRODSLD INTEGER,
    NSALDOAX NUMERIC(15,5),
    NCUSTOMPMAX NUMERIC(15,5),
    ICODMOVPRODSLDAX INTEGER)
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE EQMOVPRODUSP (
    ICODEMPPD INTEGER,
    SCODFILIALPD SMALLINT,
    ICODPROD INTEGER,
    ICODEMPLE INTEGER,
    SCODFILIALLE SMALLINT,
    CCODLOTE VARCHAR(20),
    ICODEMPTM INTEGER,
    SCODFILIALTM SMALLINT,
    ICODTIPOMOV INTEGER,
    ICODEMPIV INTEGER,
    SCODFILIALIV SMALLINT,
    ICODINVPROD INTEGER,
    ICODEMPCP INTEGER,
    SCODFILIALCP SMALLINT,
    ICODCOMPRA INTEGER,
    SCODITCOMPRA SMALLINT,
    ICODEMPVD INTEGER,
    SCODFILIALVD SMALLINT,
    CTIPOVENDA CHAR(1),
    ICODVENDA INTEGER,
    SCODITVENDA SMALLINT,
    ICODEMPRM INTEGER,
    SCODFILIALRM SMALLINT,
    ICODRMA INTEGER,
    SCODITRMA SMALLINT,
    ICODEMPOP INTEGER,
    SCODFILIALOP SMALLINT,
    ICODOP INTEGER,
    SSEQOP SMALLINT,
    ICODEMPNT INTEGER,
    SCODFILIALNT SMALLINT,
    CCODNAT CHAR(4),
    DDTMOVPROD DATE,
    IDOCMOVPROD INTEGER,
    CFLAG CHAR(1),
    NQTDMOVPROD NUMERIC(15,5),
    NPRECOMOVPROD NUMERIC(15,5),
    ICODEMPAX INTEGER,
    SCODFILIALAX SMALLINT,
    ICODALMOX INTEGER,
    CMULTIALMOX CHAR(1))
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE EQPRODUTOSP01 (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODPROD INTEGER,
    ICODEMPAX INTEGER,
    SCODFILIALAX SMALLINT,
    ICODALMOX INTEGER)
RETURNS (
    NSALDO NUMERIC(15,5),
    NSALDOAX NUMERIC(15,5),
    NCUSTOMPM NUMERIC(15,5),
    NCUSTOPEPS NUMERIC(15,5),
    NCUSTOMPMAX NUMERIC(15,5),
    NCUSTOPEPSAX NUMERIC(15,5))
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE EQREFPRODSP (
    CODEMP INTEGER,
    CODFILIAL SMALLINT,
    CODPROD INTEGER)
RETURNS (
    REFPROD CHAR(13))
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE EQRELDEMANDASP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    SCODFILIALPD SMALLINT,
    DDTINI DATE,
    DDTFIM DATE)
RETURNS (
    CODMARCA CHAR(6),
    CODGRUP CHAR(14),
    CODPROD INTEGER,
    REFPROD CHAR(13),
    DESCPROD CHAR(50),
    DESCGRUP CHAR(50),
    SLDINI NUMERIC(15,5),
    VLRCOMPRAS NUMERIC(15,5),
    VLRDEVENT NUMERIC(15,5),
    VLROUTENT NUMERIC(15,5),
    VLRVENDAS NUMERIC(15,5),
    VLRDEVSAI NUMERIC(15,5),
    VLROUTSAI NUMERIC(15,5),
    SLDFIM NUMERIC(15,5))
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE EQRELINVPRODSP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    CTIPOCUSTO CHAR(1),
    ICODEMPGP INTEGER,
    SCODFILIALGP SMALLINT,
    CCODGRUP CHAR(14),
    DDTESTOQ DATE,
    ICODEMPAX INTEGER,
    SCODFILIALAX SMALLINT,
    ICODALMOX INTEGER)
RETURNS (
    CODPROD INTEGER,
    REFPROD CHAR(13),
    DESCPROD CHAR(50),
    CODGRUP CHAR(14),
    SALDO NUMERIC(15,5),
    CUSTO NUMERIC(15,5),
    VLRESTOQ NUMERIC(15,5))
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE EQRELPEPSSP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    DTESTOQ DATE,
    ICODEMPMC INTEGER,
    SCODFILIALMC SMALLINT,
    CCODMARCA CHAR(6),
    ICODEMPGP INTEGER,
    SCODFILIALGP SMALLINT,
    CCODGRUP CHAR(14),
    CTIPOCUSTO CHAR(1),
    ICODEMPAX INTEGER,
    SCODFILIALAX SMALLINT,
    ICODALMOX INTEGER)
RETURNS (
    CODPROD INTEGER,
    REFPROD CHAR(13),
    DESCPROD CHAR(50),
    SLDPROD NUMERIC(15,5),
    CUSTOUNIT NUMERIC(15,5),
    CUSTOTOT NUMERIC(15,5),
    CODBARPROD CHAR(13),
    CODFABPROD CHAR(13))
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE EQSALDOLOTEATEQSP (
    ICODEMPLEOLD INTEGER,
    SCODFILIALLEOLD SMALLINT,
    ICODPROD INTEGER,
    CCODLOTEOLD VARCHAR(20),
    ICODEMPLENEW INTEGER,
    SCODFILIALLENEW SMALLINT,
    CCODLOTENEW VARCHAR(20),
    SOPERADOR SMALLINT,
    NQTDMOVPRODOLD NUMERIC(15,5),
    NQTDMOVPRODNEW NUMERIC(15,5),
    ICODEMPAXOLD INTEGER,
    SCODFILIALAXOLD SMALLINT,
    ICODALMOXOLD INTEGER,
    ICODEMPAXNEW INTEGER,
    SCODFILIALAXNEW SMALLINT,
    ICODALMOXNEW INTEGER)
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE EQSALDOPRODATEQSP (
    ICODEMPPD INTEGER,
    SCODFILIALPD SMALLINT,
    ICODPROD INTEGER,
    SOPERADOR SMALLINT,
    NQTDMOVPRODOLD NUMERIC(15,5),
    NQTDMOVPRODNEW NUMERIC(15,5),
    ICODEMPAXOLD INTEGER,
    SCODFILIALAXOLD SMALLINT,
    ICODALMOXOLD INTEGER,
    ICODEMPAXNEW INTEGER,
    SCODFILIALAXNEW SMALLINT,
    ICODALMOXNEW INTEGER)
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE FNADICITRECEBERSP01 (
    CALTVLR CHAR(1),
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODREC INTEGER,
    INPARCITREC INTEGER,
    NVLRDESCITREC NUMERIC(15,5),
    NVLRMULTAITREC NUMERIC(15,5),
    NVLRJUROSITREC NUMERIC(15,5),
    NVLRPARCITREC NUMERIC(15,5),
    NVLRPAGOITREC NUMERIC(15,5),
    DDTITREC DATE,
    DDTVENCITREC DATE,
    CSTATUSITREC CHAR(2),
    CFLAG CHAR(1),
    ICODEMPBO INTEGER,
    SCODFILIALBO SMALLINT,
    CCODBANCO CHAR(3),
    ICODEMPTC INTEGER,
    SCODFILIALTC SMALLINT,
    ICODTIPOCOB INTEGER,
    ICODEMPCB INTEGER,
    SCODFILIALCB SMALLINT,
    CODCARTCOB CHAR(2),
    NVLRCOMIITREC NUMERIC(15,5),
    OBSITREC VARCHAR(250))
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE FNADICLANCASP01 (
    ICODREC INTEGER,
    INPARCITREC INTEGER,
    PDVITREC CHAR(1),
    SNUMCONTA CHAR(10),
    ICODEMPCA INTEGER,
    ICODFILIALCA INTEGER,
    ICODCLI INTEGER,
    ICODEMPCL INTEGER,
    ICODFILIALCL INTEGER,
    SCODPLAN CHAR(13),
    ICODEMPPN INTEGER,
    ICODFILIALPN INTEGER,
    IANOCC INTEGER,
    SCODCC CHAR(19),
    ICODEMPCC INTEGER,
    ICODFILIALCC INTEGER,
    DDTPAGOITREC DATE,
    SDOCLANCAITREC CHAR(10),
    SOBSITREC CHAR(50),
    DVLRPAGOITREC NUMERIC(18,2),
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT)
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE FNADICLANCASP02 (
    ICODPAG INTEGER,
    INPARCPAG INTEGER,
    SNUMCONTA CHAR(10),
    ICODEMPCA INTEGER,
    ICODFILIALCA INTEGER,
    ICODFOR INTEGER,
    ICODEMPFR INTEGER,
    ICODFILIALFR INTEGER,
    SCODPLAN CHAR(13),
    ICODEMPPN INTEGER,
    ICODFILIALPN INTEGER,
    IANOCC INTEGER,
    SCODCC CHAR(19),
    ICODEMPCC INTEGER,
    ICODFILIALCC INTEGER,
    DDTPAGOITPAG DATE,
    SDOCLANCAITPAG CHAR(10),
    SOBSITPAG CHAR(50),
    DVLRPAGOITPAG NUMERIC(15,5),
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT)
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE FNADICPAGARSP01 (
    CODCOMPRA INTEGER,
    ICODEMPPG INTEGER,
    ICODFILIALPG SMALLINT,
    CODPLANOPAG INTEGER,
    ICODEMPFR INTEGER,
    ICODFILIALFR SMALLINT,
    CODFOR INTEGER,
    VLRLIQCOMPRA NUMERIC(18,2),
    DTSAIDACOMPRA DATE,
    DOCCOMPRA INTEGER,
    ICODEMPBO INTEGER,
    ICODFILIALBO SMALLINT,
    CODBANCO CHAR(3),
    FLAG CHAR(1),
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT)
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE FNADICRECEBERSP01 (
    CTIPOVENDA CHAR(1),
    ICODVENDA INTEGER,
    ICODEMPTC INTEGER,
    ICODFILIALTC INTEGER,
    CODTIPOCOB INTEGER,
    ICODEMPPG INTEGER,
    ICODFILIALPG SMALLINT,
    CODPLANOPAG INTEGER,
    ICODEMPCL INTEGER,
    ICODFILIALCL SMALLINT,
    CODCLI INTEGER,
    ICODEMPVD INTEGER,
    ICODFILIALVD SMALLINT,
    CODVEND INTEGER,
    VLRLIQVENDA NUMERIC(15,5),
    DTSAIDAVENDA DATE,
    VLRCOMISVENDA NUMERIC(15,5),
    DOCVENDA INTEGER,
    ICODEMPBO INTEGER,
    ICODFILIALBO SMALLINT,
    CODBANCO CHAR(3),
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT,
    CODEMPCB INTEGER,
    CODFILIALCB SMALLINT,
    CODCARTCOB CHAR(2),
    FLAG CHAR(1))
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE FNCHECAPGTOSP (
    ICODCLI INTEGER,
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT)
RETURNS (
    SRETORNO CHAR(1))
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE FNDELETARECEBERSP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    CTIPOVENDA CHAR(1),
    ICODVENDA INTEGER)
RETURNS (
    SDELETADO SMALLINT)
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE FNGERAITRECEBERSP01 (
    CALTVLR CHAR(1),
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODREC INTEGER,
    ICODEMPPG INTEGER,
    SCODFILIALPG SMALLINT,
    ICODPLANOPAG INTEGER,
    NVLRREC NUMERIC(15,5),
    DDATAREC DATE,
    CFLAG CHAR(1),
    ICODEMPBO INTEGER,
    SCODFILIALBO SMALLINT,
    CCODBANCO CHAR(3),
    ICODEMPTC INTEGER,
    SCODFILIALTC SMALLINT,
    ICODTIPOCOB INTEGER,
    ICODEMPCB INTEGER,
    SCODFILIALCB SMALLINT,
    CODCARTCOB CHAR(2),
    NVLRCOMIREC NUMERIC(15,5),
    OBSREC VARCHAR(250))
RETURNS (
    I INTEGER)
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE FNITRECEBERSP01 (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODREC INTEGER,
    NVLRPARCREC NUMERIC(15,5),
    NVLRCOMIREC NUMERIC(15,5),
    INROPARCREC INTEGER,
    CCLASCOMIS CHAR(1))
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE FNLIBCREDSP (
    CODEMPVD INTEGER,
    CODFILIALVD INTEGER,
    TIPOVENDA CHAR(1),
    CODVENDA INTEGER,
    CODCLI INTEGER,
    CODEMPCL INTEGER,
    CODFILIALCL INTEGER,
    VLRVENDA NUMERIC(15,5),
    VLRADIC NUMERIC(15,2),
    CODITEM INTEGER)
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE FNSALDOPLANSP (
    ICODEMPPN INTEGER,
    ICODFILIALPN INTEGER,
    SCODPLANANT CHAR(13),
    DDATAANT DATE,
    DVLRANT NUMERIC(15,5),
    SCODPLANATU CHAR(13),
    DDATAATU DATE,
    DVLRATU NUMERIC(15,5))
RETURNS (
    SRETORNO CHAR(1))
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE GERAVISITASSP (
    NUMVISITAS INTEGER,
    TIPOVISITA CHAR(10),
    CODATEND INTEGER,
    CODFILIALATEND INTEGER,
    CODEMPATEND INTEGER,
    CODCLI INTEGER,
    CODFILIALCLI INTEGER,
    CODEMPCLI INTEGER,
    DATA DATE)
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE LFBUSCAFISCALSP (
    FILIALATUAL INTEGER,
    CODEMP INTEGER,
    CODFILIAL INTEGER,
    CODPROD INTEGER,
    CODEMPCL INTEGER,
    CODFILIALCL INTEGER,
    CODCLI INTEGER,
    CODEMPTM INTEGER,
    CODFILIALTM SMALLINT,
    CODTIPOMOV INTEGER)
RETURNS (
    ORIGFISC CHAR(1),
    CODTRATTRIB CHAR(2),
    REDFISC NUMERIC(9,2),
    TIPOFISC CHAR(2),
    CODMENS INTEGER,
    ALIQFISC NUMERIC(9,2),
    ALIQIPIFISC NUMERIC(9,2),
    TPREDICMSFISC CHAR(1))
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE LFBUSCAICMSSP (
    CODNAT CHAR(4),
    ESTCLI CHAR(2),
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT)
RETURNS (
    PERCICMS NUMERIC(9,2))
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE LFBUSCANATSP (
    FILIALATUAL INTEGER,
    CODEMP INTEGER,
    CODFILIAL INTEGER,
    CODPROD INTEGER,
    CODEMPCL INTEGER,
    CODFILIALCL INTEGER,
    CODCLI INTEGER,
    CODEMPFR INTEGER,
    CODFILIALFR INTEGER,
    CODFOR INTEGER,
    CODFILIALTM SMALLINT,
    CODTIPOMOV INTEGER)
RETURNS (
    CODNAT CHAR(4))
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE LFNOVODOCSP (
    SSERIE CHAR(4),
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT)
RETURNS (
    DOC INTEGER)
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE PPATUDISTOPSP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODOP INTEGER,
    SSEQOP SMALLINT,
    NQTDDISTOLD NUMERIC(15,5),
    NQTDDISTNEW NUMERIC(15,5))
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE PPCUSTOPRODSP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODPROD INTEGER,
    DTESTOQ DATE,
    CTIPOCUSTO CHAR(1),
    ICODEMPAX INTEGER,
    SCODFILIALAX SMALLINT,
    ICODALMOX INTEGER,
    CCOMSALDO CHAR(10))
RETURNS (
    CUSTOUNIT NUMERIC(15,5),
    SLDPROD NUMERIC(15,5))
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE PPGERAOPCQ (
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT,
    ICODOP INTEGER,
    ISEQOP SMALLINT)
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE PPITOPSP01 (
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT,
    ICODOP INTEGER,
    ISEQOP SMALLINT)
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE PPITOPSP02 (
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT,
    ICODOP INTEGER,
    ISEQOP SMALLINT)
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE PPRELCUSTOSP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    DTESTOQ DATE,
    ICODEMPMC INTEGER,
    SCODFILIALMC SMALLINT,
    CCODMARCA CHAR(6),
    ICODEMPGP INTEGER,
    SCODFILIALGP SMALLINT,
    CCODGRUP CHAR(14),
    CTIPOCUSTO CHAR(1),
    ICODEMPAX INTEGER,
    SCODFILIALAX SMALLINT,
    ICODALMOX INTEGER)
RETURNS (
    CODPROD INTEGER,
    REFPROD CHAR(13),
    DESCPROD CHAR(50),
    TIPOPROD CHAR(1),
    SLDPROD NUMERIC(15,5),
    CUSTOUNIT NUMERIC(15,5),
    CUSTOTOT NUMERIC(15,5))
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE PVABRECAIXASP (
    ICODCAIXA INTEGER,
    SCODFILIAL SMALLINT,
    ICODEMP INTEGER,
    NVLRINICAIXA NUMERIC(15,5),
    DDTAMOV DATE,
    ICODFILIALUS SMALLINT,
    CIDUSU CHAR(8))
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE PVADICMOVCAIXASP01 (
    ICODCAIXA INTEGER,
    NVLRINICAIXA NUMERIC(18,3),
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    DDTAMOV DATE)
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE PVFECHACAIXASP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODCAIXA INTEGER,
    DDTAMOV DATE,
    REDUZ CHAR(1),
    ICODFILIALUS SMALLINT,
    CIDUSU CHAR(8))
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE PVFECHAVENDASP (
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT,
    NVALOR NUMERIC(15,5),
    ITERM INTEGER,
    DDTAMOV DATE,
    CIDUSU CHAR(8))
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE PVRETMOVCAIXASP (
    ICODCAIXA INTEGER,
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT,
    DDTAMOV DATE)
RETURNS (
    DDTAMOVRET DATE,
    CTIPOMOV CHAR(1),
    NVLRSLDMOV NUMERIC(15,5),
    CIDUSU CHAR(8))
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE PVSANGRIASP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    NVALOR NUMERIC(18,3),
    ICODCAIXA INTEGER,
    DDTAMOV DATE,
    CIDUSU CHAR(8))
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE PVSEQMOVCAIXASP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODCAIXA INTEGER,
    DDTAMOV DATE)
RETURNS (
    INROMOV INTEGER)
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE PVSUPRIMENTOSP (
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT,
    NVALOR NUMERIC(18,3),
    ITERM INTEGER,
    DDTAMOV DATE,
    CIDUSU CHAR(8))
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE PVVALIDFAIXACAIXASP (
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT,
    ICODCAIXA INTEGER,
    NEWSEQINI INTEGER,
    NEWSEQMAX INTEGER)
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE PVVERIFCAIXASP (
    ICODCAIXA INTEGER,
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    DDTAMOV DATE,
    SCODFILIALUS SMALLINT,
    CIDUSU CHAR(8))
RETURNS (
    IRETORNO INTEGER)
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE RHLISTACANDVAGASP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODVAGA INTEGER,
    ICODFUNC INTEGER)
RETURNS (
    CODCAND INTEGER,
    NOMECAND CHAR(50),
    FONECAND CHAR(12),
    PRETENSAOSAL NUMERIC(15,2),
    QUALIFICACOES INTEGER,
    RESTRICOES INTEGER,
    CURSOS INTEGER,
    EXPERIENCIA INTEGER,
    STVAGACAND CHAR(2),
    STCAND CHAR(2))
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE RHLISTAVAGACANDSP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODCAND INTEGER)
RETURNS (
    CODVAGA INTEGER,
    NOMEEMPR CHAR(60),
    CODFUNC INTEGER,
    DESCFUNC VARCHAR(100),
    FAIXASALINI NUMERIC(15,2),
    FAIXASALFIM NUMERIC(15,2),
    STVAGA CHAR(2),
    QUALIFICACOES INTEGER,
    RESTRICOES INTEGER,
    CURSOS INTEGER,
    STVAGACAND CHAR(2))
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE SGAGENTEISP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    CTIPOAGE CHAR(5),
    CDESCAGE CHAR(50))
RETURNS (
    CODAGE INTEGER)
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE SGAGENTEUIDSP (
    CIUD CHAR(1),
    ICODEMP INTEGER,
    CTIPOAGE CHAR(5),
    ICODAGE INTEGER,
    CDESCAGE CHAR(50))
RETURNS (
    CODEMP INTEGER,
    CODFILIAL SMALLINT,
    TIPOAGE CHAR(5),
    CODAGE INTEGER)
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE SGAGENTEUSP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    CTIPOAGE CHAR(5),
    ICODAGE INTEGER,
    CDESCAGE CHAR(50))
RETURNS (
    CODAGE INTEGER)
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE SGATUALIZABDSP (
    ICODEMP INTEGER)
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE SGCALCVENCSP (
    CODEMP INTEGER,
    DTBASE DATE,
    DTVENC DATE,
    REGRVCTO CHAR(1),
    RVSAB CHAR(1),
    RVDOM CHAR(1),
    RVFER CHAR(1),
    RVDIA CHAR(1),
    DIAVCTO SMALLINT,
    DIASVCTO SMALLINT)
RETURNS (
    DTVENCRET DATE)
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE SGDADOSINISP (
    ICODEMP INTEGER)
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE SGESTACAOIMPSP01 (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODEST INTEGER,
    SNROIMP SMALLINT,
    CPADIMP CHAR(1))
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE SGFIMCONSP
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE SGGRANTADMSP (
    ICODEMP INTEGER)
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE SGGRANTUSERSP
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE SGINICONSP (
    ICODEMP INTEGER,
    CIDUSU CHAR(8),
    ICODFILIALSEL SMALLINT,
    ICODTERM SMALLINT)
RETURNS (
    SRET SMALLINT)
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE SGLOGSP01 (
    CLASLOG CHAR(2),
    TIPOLOG CHAR(3),
    DESCLOG CHAR(60),
    OBSLOG VARCHAR(1000))
RETURNS (
    CODFILIAL SMALLINT,
    CODLOG INTEGER)
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE SGOBJETOINSTBSP (
    ICODEMP INTEGER)
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE SGRETCAIXA
RETURNS (
    CODEMP INTEGER,
    CODFILIAL SMALLINT,
    CODTERM INTEGER)
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE SGRETFILIAL (
    ICODEMP INTEGER,
    SNOMETAB CHAR(30))
RETURNS (
    ICODFILIAL SMALLINT)
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE SGRETINFOUSU (
    IDUSU CHAR(8))
RETURNS (
    ANOCCUSU SMALLINT,
    CODFILIALCCUSU SMALLINT,
    CODEMPUSU INTEGER,
    CODFILIALUSU SMALLINT,
    CODCCUSU CHAR(19),
    IDUSUS CHAR(8),
    ALMOXARIFE CHAR(1),
    APROVARMA CHAR(2))
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE SGRETMULTIALMOXSP (
    ICODEMP INTEGER)
RETURNS (
    CMULTIALMOX CHAR(1))
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE SGRETMULTICOMISSP (
    ICODEMP INTEGER,
    CODEMPTM INTEGER,
    CODFILIALTM SMALLINT,
    CODTIPOMOV INTEGER)
RETURNS (
    CMULTICOMIS CHAR(1))
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE SGSETAGENDASP (
    CODAGD INTEGER,
    CODEMP INTEGER,
    DTAINIAGD DATE,
    HRINIAGD TIME,
    DTAFIMAGD DATE,
    HRFIMAGD TIME,
    ASSUNTOAGD CHAR(50),
    DESCAGD VARCHAR(10000),
    CODFILIALTA SMALLINT,
    CODTIPOAGD INTEGER,
    PRIORAGD SMALLINT,
    CODAGE INTEGER,
    TIPOAGE CHAR(5),
    CODFILIALAE SMALLINT,
    CODAGEEMIT INTEGER,
    TIPOAGEEMIT CHAR(5),
    CAAGD CHAR(2))
RETURNS (
    IRET INTEGER)
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE SGULTIMODIAMESSP (
    DTCALC DATE)
RETURNS (
    DTRET DATE)
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE SGUPACESSOMUSP (
    ICODEMP INTEGER,
    ICODFILIAL INTEGER,
    SIDUSU CHAR(8),
    ICODSIS INTEGER,
    ICODMODU INTEGER,
    ICODMENU INTEGER,
    CTPACESSOMU CHAR(1))
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE SGUPMENUSP01 (
    ICODSIS INTEGER,
    CDESCSIS CHAR(50),
    ICODMODU INTEGER,
    CDESCMODU CHAR(50),
    ICODMENU INTEGER,
    CDESCMENU CHAR(50),
    CNOMEMENU CHAR(50),
    CACAOMENU CHAR(100),
    ICODSISPAI INTEGER,
    ICODMODUPAI INTEGER,
    ICODMENUPAI INTEGER)
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE SPGERANUM (
    ICODEMP INTEGER,
    ICODFILIAL INTEGER,
    STAB CHAR(2))
RETURNS (
    ISEQ INTEGER)
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE SPGERANUMPDV (
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT,
    ICODCAIXA INTEGER)
RETURNS (
    ISEQ INTEGER)
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE TKCONTTOCLI (
    CODEMP INTEGER,
    CODFILIAL INTEGER,
    CODCTO INTEGER,
    CODFILIALTI INTEGER,
    CODTIPOCLI INTEGER,
    CODFILIALCC INTEGER,
    CODCLASCLI INTEGER,
    CODFILIALSR INTEGER,
    CODSETOR INTEGER)
RETURNS (
    IRET INTEGER)
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE TKGERACAMPANHACTO (
    CODEMPCA INTEGER,
    CODFILIALCA SMALLINT,
    CODCAMP CHAR(13),
    CODEMPCO INTEGER,
    CODFILIALCO SMALLINT,
    CODCTO INTEGER,
    CODEMPAT INTEGER,
    CODFILIALAT SMALLINT,
    CODATIV INTEGER,
    SITHISTTK CHAR(2),
    DESCHISTTK VARCHAR(1000))
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE TKSETHISTSP (
    CODHISTTK INTEGER,
    CODEMP INTEGER,
    CODFILIALCO INTEGER,
    CODCTO INTEGER,
    CODFILIALCL INTEGER,
    CODCLI INTEGER,
    DESCHISTTK VARCHAR(10000),
    CODFILIALAE INTEGER,
    CODATEND INTEGER,
    SITHISTTK CHAR(2),
    DATAHISTTK DATE,
    TIPOHISTTK CHAR(1))
RETURNS (
    IRET INTEGER)
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE VDADICCOMISSAOSP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODREC INTEGER,
    INPARCITREC INTEGER,
    NVLRVENDACOMI NUMERIC(15,5),
    NVLRCOMI NUMERIC(15,5),
    DDATACOMI DATE,
    DDTVENCCOMI DATE,
    CTIPOCOMI CHAR(1),
    CODEMPVD INTEGER,
    CODFILIALVD SMALLINT,
    CODVEND INTEGER)
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE VDADICITEMPDVSP (
    CODVENDA INTEGER,
    CODEMP INTEGER,
    CODFILIAL CHAR(8),
    CODPROD INTEGER,
    CODEMPPD INTEGER,
    CODFILIALPD INTEGER,
    QTDITVENDA NUMERIC(9,5),
    VLRPRECOITVENDA NUMERIC(18,5),
    VLRDESCITVENDA NUMERIC(18,5),
    PERCDESCITVENDA NUMERIC(15,5),
    VLRCOMISITVENDA NUMERIC(15,5),
    PERCCOMISITVENDA NUMERIC(15,5),
    SCODLOTE VARCHAR(20),
    CODEMPLE INTEGER,
    CODFILIALLE SMALLINT,
    CODFILIALCV SMALLINT,
    CODCONV INTEGER)
RETURNS (
    CODITVENDA INTEGER,
    PERCICMSITVENDA NUMERIC(9,2),
    VLRBASEICMSITVENDA NUMERIC(18,3),
    VLRICMSITVENDA NUMERIC(18,3),
    VLRLIQITVENDA NUMERIC(18,3))
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE VDADICITVENDAORCSP (
    FILIALATUAL INTEGER,
    ICODVENDA INTEGER,
    ICODORC INTEGER,
    ICODITORC INTEGER,
    ICODFILIAL SMALLINT,
    ICODEMP INTEGER,
    STIPOVENDA CHAR(10),
    TPAGRUP CHAR(1),
    IQTDITVENDA FLOAT,
    VLRDESCITVENDA NUMERIC(15,5))
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE VDADICVENDAORCSP (
    ICODORC INTEGER,
    ICODFILIAL SMALLINT,
    ICODEMP INTEGER,
    STIPOVENDA CHAR(10),
    NEWCODVENDA INTEGER)
RETURNS (
    IRET INTEGER)
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE VDBAIXACOMISSAOSP (
    STIPO CHAR(1),
    DINI DATE,
    DFIM DATE,
    ICODVEND INTEGER,
    ICODEMPVD INTEGER,
    ICODFILIALVD SMALLINT,
    SCODCONTA CHAR(10),
    ICODEMPCA INTEGER,
    ICODFILIALCA SMALLINT,
    SCODPLAN CHAR(13),
    ICODEMPPN INTEGER,
    ICODFILIALPN SMALLINT,
    DDATA DATE,
    IDOC INTEGER,
    DVLR NUMERIC(15,5),
    SOBS CHAR(50),
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT)
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE VDBLOQVENDASP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    CTIPOVENDA CHAR(1),
    ICODVENDA INTEGER,
    CBLOQVENDA CHAR(1))
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE VDBUSCAPRECOSP (
    ICODPROD INTEGER,
    ICODCLI INTEGER,
    ICODEMPCL INTEGER,
    ICODFILIALCL SMALLINT,
    ICODPLANOPAG INTEGER,
    ICODEMPPG INTEGER,
    ICODFILIALPG SMALLINT,
    ICODTIPOMOV INTEGER,
    ICODEMPTM INTEGER,
    ICODFILIALTM SMALLINT,
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT)
RETURNS (
    PRECO NUMERIC(18,2))
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE VDCLIENTEATIVOSP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODCLI INTEGER)
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE VDCOPIAORCSP (
    CODEMP INTEGER,
    CODFILIAL INTEGER,
    CODORC INTEGER,
    CODFILIALCL INTEGER,
    CODCLI INTEGER)
RETURNS (
    IRET INTEGER)
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE VDDESBAIXACOMISSAOSP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODVEND INTEGER,
    CORDEM CHAR(1),
    DINI DATE,
    DFIM DATE)
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE VDESTORNACOMISSAOSP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODEMPVD INTEGER,
    SCODFILIALVD SMALLINT,
    ICODVEND INTEGER,
    DINI DATE,
    DFIM DATE,
    CORDEM CHAR(1))
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE VDEVOLUVENDAS (
    ICODEMP SMALLINT,
    ICODFILIAL SMALLINT,
    DATAINI DATE,
    DATAFIM DATE,
    ICODTIPOCLI SMALLINT,
    ICODCLI SMALLINT,
    FILTRAVENDAS CHAR(1))
RETURNS (
    VALOR NUMERIC(15,5),
    MES SMALLINT,
    ANO SMALLINT)
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE VDGERACOMISSAOSP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODREC INTEGER,
    INPARCITREC INTEGER,
    NVLRCOMIITREC NUMERIC(15,5),
    DDTVENCITREC DATE)
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE VDGERAESTORNOCOMISP
AS
BEGIN
  EXIT;
END^


CREATE PROCEDURE VDRETULTVDCLIPROD (
    ICODEMP INTEGER,
    ICODCLI INTEGER,
    ICODFILIALVD SMALLINT,
    ICODVEND INTEGER,
    DTINI DATE,
    DTFIM DATE)
RETURNS (
    RAZCLI_RET CHAR(50),
    CODCLI_RET INTEGER,
    DESCPROD_RET CHAR(50),
    CODPROD_RET INTEGER,
    DTEMITVENDA_RET DATE,
    DOCVENDA_RET INTEGER,
    SERIE_RET CHAR(4),
    PRECOVENDA_RET NUMERIC(15,4))
AS
BEGIN
  SUSPEND;
END^


CREATE PROCEDURE VDUPVENDAORCSP (
    ICODEMP INTEGER,
    ICODFILIAL INTEGER,
    ICODORC INTEGER,
    ICODITORC INTEGER,
    ICODFILIALVD INTEGER,
    ICODVENDA INTEGER,
    ICODITVENDA INTEGER,
    STIPOVENDA CHAR(10))
AS
BEGIN
  EXIT;
END^



SET TERM ; ^



/******************************************************************************/
/*                                   Tables                                   */
/******************************************************************************/



CREATE TABLE ATAGENDA (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODAG        INTEGER NOT NULL,
    CODEMPSA     INTEGER NOT NULL,
    CODFILIALSA  SMALLINT NOT NULL,
    CODSETAT     INTEGER NOT NULL,
    DTACADAG     DATE DEFAULT 'today' NOT NULL,
    HORACATAG    TIME DEFAULT 'now' NOT NULL,
    DTAAG        DATE DEFAULT 'today' NOT NULL,
    HORAAG       TIME DEFAULT 'now' NOT NULL,
    DESCAGENDA   CHAR(50) NOT NULL,
    CODEMPAE     INTEGER,
    CODFILIALAE  SMALLINT,
    CODATEND     INTEGER,
    DTAATENDAG   DATE,
    HORAATENDAG  TIME,
    OBSAGENDA    VARCHAR(10000),
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now'
);

CREATE TABLE ATATENDENTE (
    CODEMP          INTEGER NOT NULL,
    CODFILIAL       SMALLINT NOT NULL,
    CODATEND        INTEGER NOT NULL,
    NOMEATEND       CHAR(50) NOT NULL,
    CODEMPTA        INTEGER NOT NULL,
    CODFILIALTA     SMALLINT NOT NULL,
    CODTPATEND      INTEGER NOT NULL,
    RGATEND         CHAR(10),
    ENDATEND        CHAR(50),
    BAIRATEND       CHAR(30),
    CIDATEND        CHAR(30),
    CEPATEND        CHAR(8),
    FONEATEND       CHAR(12),
    FAXATEND        CHAR(8),
    EMAILATEND      CHAR(60),
    NUMATEND        INTEGER,
    UFATEND         CHAR(2),
    CELATEND        CHAR(8),
    IDENTIFICATEND  CHAR(18),
    CODEMPUS        INTEGER,
    CODFILIALUS     INTEGER,
    IDUSU           CHAR(8),
    CPFATEND        CHAR(11),
    CODVEND         INTEGER,
    CODEMPVE        INTEGER,
    CODFILIALVE     INTEGER,
    DTINS           DATE DEFAULT 'now',
    IDUSUINS        CHAR(8) DEFAULT USER,
    DTALT           DATE DEFAULT 'now',
    IDUSUALT        CHAR(8) DEFAULT USER,
    HINS            TIME DEFAULT 'now',
    HALT            TIME DEFAULT 'now'
);

CREATE TABLE ATATENDIMENTO (
    CODEMP         INTEGER NOT NULL,
    CODFILIAL      SMALLINT NOT NULL,
    CODATENDO      INTEGER NOT NULL,
    CODCONV        INTEGER,
    CODEMPCV       INTEGER,
    CODFILIALCV    INTEGER,
    CODEMPTO       INTEGER NOT NULL,
    CODFILIALTO    SMALLINT NOT NULL,
    CODTPATENDO    INTEGER NOT NULL,
    CODEMPAE       INTEGER NOT NULL,
    CODFILIALAE    SMALLINT NOT NULL,
    CODATEND       INTEGER NOT NULL,
    CODEMPSA       INTEGER NOT NULL,
    CODFILIALSA    INTEGER NOT NULL,
    CODSETAT       INTEGER NOT NULL,
    DATAATENDO     DATE DEFAULT 'today' NOT NULL,
    HORAATENDO     TIME DEFAULT 'now' NOT NULL,
    DATAATENDOFIN  DATE DEFAULT 'today' NOT NULL,
    HORAATENDOFIN  TIME DEFAULT 'now' NOT NULL,
    OBSATENDO      VARCHAR(10000),
    STATUSATENDO   CHAR(2) NOT NULL,
    CODEMPCL       INTEGER,
    CODFILIALCL    SMALLINT,
    CODCLI         INTEGER,
    IDUSU          CHAR(8) NOT NULL,
    CODEMPUS       INTEGER NOT NULL,
    CODFILIALUS    INTEGER NOT NULL,
    DOCATENDO      INTEGER NOT NULL,
    DTINS          DATE DEFAULT 'now',
    IDUSUINS       CHAR(8) DEFAULT USER,
    DTALT          DATE DEFAULT 'now',
    IDUSUALT       CHAR(8) DEFAULT USER,
    HINS           TIME DEFAULT 'now',
    HALT           TIME DEFAULT 'now'
);

CREATE TABLE ATATENDIMENTOORC (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODATENDO    INTEGER NOT NULL,
    CODEMPOC     INTEGER NOT NULL,
    CODFILIALOC  SMALLINT NOT NULL,
    TIPOORC      CHAR(1) NOT NULL,
    CODORC       INTEGER NOT NULL,
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now'
);

CREATE TABLE ATATRIBUICAO (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  INTEGER NOT NULL,
    CODATRIB   CHAR(15) NOT NULL,
    DESCATRIB  CHAR(50) NOT NULL,
    OBSATRIB   VARCHAR(10000),
    DTINS      DATE DEFAULT 'now',
    IDUSUINS   CHAR(8) DEFAULT USER,
    DTALT      DATE DEFAULT 'now',
    IDUSUALT   CHAR(8) DEFAULT USER,
    HINS       TIME DEFAULT 'now',
    HALT       TIME DEFAULT 'now'
);

CREATE TABLE ATCONVATRIB (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    CODCONV       INTEGER NOT NULL,
    SEQCONVATRIB  SMALLINT NOT NULL,
    CODEMPAB      INTEGER NOT NULL,
    CODFILIALAB   SMALLINT NOT NULL,
    CODATRIB      CHAR(15) NOT NULL,
    OBSCONVATRIB  VARCHAR(10000),
    DTINS         DATE DEFAULT 'now',
    IDUSUINS      CHAR(8) DEFAULT USER,
    DTALT         DATE DEFAULT 'now',
    IDUSUALT      CHAR(8) DEFAULT USER,
    HINS          TIME DEFAULT 'now',
    HALT          TIME DEFAULT 'now'
);

CREATE TABLE ATCONVATRIBTB (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    CODCONV       INTEGER NOT NULL,
    SEQCONVATRIB  SMALLINT NOT NULL,
    CODEMPTB      INTEGER NOT NULL,
    CODFILIALTB   SMALLINT NOT NULL,
    CODTB         SMALLINT NOT NULL,
    CODITTB       INTEGER NOT NULL,
    DTINS         DATE DEFAULT 'now',
    IDUSUINS      CHAR(8) DEFAULT USER,
    DTALT         DATE DEFAULT 'now',
    IDUSUALT      CHAR(8) DEFAULT USER,
    HINS          TIME DEFAULT 'now',
    HALT          TIME DEFAULT 'now'
);

CREATE TABLE ATCONVENIADO (
    CODEMP         INTEGER NOT NULL,
    CODFILIAL      SMALLINT NOT NULL,
    CODCONV        INTEGER NOT NULL,
    NOMECONV       CHAR(50) NOT NULL,
    CODEMPTC       INTEGER NOT NULL,
    CODFILIALTC    SMALLINT NOT NULL,
    CODTPCONV      INTEGER NOT NULL,
    DTNASCCONV     DATE NOT NULL,
    CODEMPAE       INTEGER,
    CODFILIALAE    SMALLINT,
    CODATEND       INTEGER,
    CODEMPGI       INTEGER,
    CODFILIALGI    SMALLINT,
    CODGRI         INTEGER,
    RGCONV         CHAR(10),
    CPFCONV        CHAR(11),
    ENDCONV        CHAR(50),
    NUMCONV        INTEGER,
    BAIRCONV       CHAR(30),
    CIDCONV        CHAR(30),
    CEPCONV        CHAR(8),
    FONECONV       CHAR(12),
    FAXCONV        CHAR(8),
    EMAILCONV      CHAR(60),
    PAICONV        CHAR(50),
    MAECONV        CHAR(50),
    RGPAICONV      CHAR(10),
    RGMAECONV      CHAR(10),
    CNSCONV        CHAR(15),
    CODEMPCL       INTEGER,
    CODFILIALCL    INTEGER,
    CODCLI         INTEGER,
    UFCONV         CHAR(2),
    CELCONV        CHAR(8),
    SEXOCONV       CHAR(1),
    IDENTIFICCONV  CHAR(20),
    COMPLCONV      CHAR(20),
    CODEMPEC       INTEGER,
    CODFILIALEC    SMALLINT,
    CODENC         INTEGER,
    CODEMPFC       INTEGER,
    CODFILIALFC    SMALLINT,
    CODFUNC        INTEGER,
    ICARDCONV      CHAR(15),
    NRVIACONV      SMALLINT,
    DTINS          DATE DEFAULT 'now',
    IDUSUINS       CHAR(8) DEFAULT USER,
    DTALT          DATE DEFAULT 'now',
    IDUSUALT       CHAR(8) DEFAULT 'now',
    HINS           TIME DEFAULT 'now',
    HALT           TIME DEFAULT 'now',
    DDDCONV        CHAR(4),
    DDDFAXCONV     CHAR(4),
    DDDCELCONV     CHAR(4)
);

CREATE TABLE ATENCAMINHADOR (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    CODENC     INTEGER NOT NULL,
    NOMEENC    CHAR(50) NOT NULL,
    ENDENC     CHAR(50),
    NUMENC     INTEGER,
    COMPLENC   CHAR(30),
    CIDENC     CHAR(30),
    BAIRENC    CHAR(30),
    UFENC      CHAR(2),
    CEPENC     CHAR(8),
    FONEENC    CHAR(12),
    FAXENC     CHAR(8),
    DTINS      DATE DEFAULT 'now',
    IDUSUINS   CHAR(8) DEFAULT USER,
    DTALT      DATE DEFAULT 'now',
    IDUSUALT   CHAR(8) DEFAULT USER,
    HINS       TIME DEFAULT 'now',
    HALT       TIME DEFAULT 'now'
);

CREATE TABLE ATSETOR (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    CODSETAT   INTEGER NOT NULL,
    DESCSETAT  CHAR(50) NOT NULL,
    DTINS      DATE DEFAULT 'now',
    IDUSUINS   CHAR(8) DEFAULT USER,
    DTALT      DATE DEFAULT 'now',
    IDUSUALT   CHAR(8) DEFAULT USER,
    HINS       TIME DEFAULT 'now',
    HALT       TIME DEFAULT 'now'
);

CREATE TABLE ATSETORATENDENTE (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODSETAT     INTEGER NOT NULL,
    CODEMPAE     INTEGER NOT NULL,
    CODFILIALAE  SMALLINT NOT NULL,
    CODATEND     INTEGER NOT NULL,
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now'
);

CREATE TABLE ATTIPOATEND (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODTPATEND   INTEGER NOT NULL,
    DESCTPATEND  CHAR(50) NOT NULL,
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now'
);

CREATE TABLE ATTIPOATENDO (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    CODTPATENDO   INTEGER NOT NULL,
    DESCTPATENDO  CHAR(50) NOT NULL,
    CODEMPFX      INTEGER,
    CODFILIALFX   SMALLINT,
    CODFLUXO      INTEGER,
    DTINS         DATE DEFAULT 'now',
    IDUSUINS      CHAR(8) DEFAULT USER,
    DTALT         DATE DEFAULT 'now',
    IDUSUALT      CHAR(8) DEFAULT USER,
    HINS          TIME DEFAULT 'now',
    HALT          TIME DEFAULT 'now'
);

CREATE TABLE ATTIPOATENDOSETOR (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODTPATENDO  INTEGER NOT NULL,
    CODEMPST     INTEGER NOT NULL,
    CODFILIALST  SMALLINT NOT NULL,
    CODSETAT     INTEGER NOT NULL,
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now'
);

CREATE TABLE ATTIPOCONV (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    CODTPCONV     INTEGER NOT NULL,
    DESCTPCONV    CHAR(50) NOT NULL,
    CLASSTPCONV   CHAR(20),
    CODAUXTPCONV  CHAR(20) DEFAULT ' ' NOT NULL,
    DTINS         DATE DEFAULT 'now',
    IDUSUINS      CHAR(8) DEFAULT USER,
    DTALT         DATE DEFAULT 'now',
    IDUSUALT      CHAR(8) DEFAULT USER,
    HINS          TIME DEFAULT 'now',
    HALT          TIME DEFAULT 'now'
);

CREATE TABLE CPCOMPRA (
    CODEMP             INTEGER NOT NULL,
    CODFILIAL          SMALLINT NOT NULL,
    CODCOMPRA          INTEGER NOT NULL,
    CODEMPPG           INTEGER NOT NULL,
    CODFILIALPG        SMALLINT NOT NULL,
    CODPLANOPAG        INTEGER NOT NULL,
    CODEMPFR           INTEGER NOT NULL,
    CODFILIALFR        SMALLINT NOT NULL,
    CODFOR             INTEGER NOT NULL,
    CODEMPSE           INTEGER NOT NULL,
    CODFILIALSE        SMALLINT NOT NULL,
    SERIE              CHAR(4) NOT NULL,
    CODEMPTM           INTEGER NOT NULL,
    CODFILIALTM        SMALLINT NOT NULL,
    CODTIPOMOV         INTEGER NOT NULL,
    DOCCOMPRA          INTEGER NOT NULL,
    DTENTCOMPRA        DATE NOT NULL,
    DTEMITCOMPRA       DATE NOT NULL,
    VLRPRODCOMPRA      NUMERICDN,
    PERCDESCCOMPRA     NUMERIC(6,2),
    VLRDESCCOMPRA      NUMERICDN,
    VLRDESCITCOMPRA    NUMERICDN,
    VLRCOMPRA          NUMERICDN,
    VLRBASEICMSCOMPRA  NUMERICDN,
    VLRICMSCOMPRA      NUMERICDN,
    VLRISENTASCOMPRA   NUMERICDN,
    VLROUTRASCOMPRA    NUMERICDN,
    VLRBASEIPICOMPRA   NUMERICDN,
    VLRLIQCOMPRA       NUMERICDN,
    STATUSCOMPRA       CHAR(2) NOT NULL,
    VLRFRETECOMPRA     NUMERICDN,
    VLRADICCOMPRA      NUMERICDN,
    PERCIPICOMPRA      NUMERIC(6,2),
    VLRIPICOMPRA       NUMERICDN,
    CODEMPBO           INTEGER,
    CODFILIALBO        SMALLINT,
    CODBANCO           CHAR(3),
    IMPNOTACOMPRA      CHAR(1) DEFAULT 'N' NOT NULL,
    BLOQCOMPRA         CHAR(1) DEFAULT 'N' NOT NULL,
    EMMANUT            CHAR(1) DEFAULT 'N' NOT NULL,
    FLAG               CHAR(1) DEFAULT 'N',
    ADICFRETECOMPRA    CHAR(1) DEFAULT 'N' NOT NULL,
    TIPOFRETECOMPRA    CHAR(1),
    CODEMPSOL          INTEGER,
    CODFILIALSOL       SMALLINT,
    CODSOL             INTEGER,
    CODEMPTN           INTEGER,
    CODFILIALTN        SMALLINT,
    CODTRAN            INTEGER,
    OBSERVACAO         VARCHAR(1024),
    OBS01              VARCHAR(1024),
    OBS02              VARCHAR(1024),
    OBS03              VARCHAR(1024),
    OBS04              VARCHAR(1024),
    DTINS              DATE DEFAULT 'now',
    HINS               TIME DEFAULT 'now',
    DTALT              DATE DEFAULT 'now',
    HALT               TIME DEFAULT 'now',
    IDUSUINS           CHAR(8) DEFAULT USER,
    IDUSUALT           CHAR(8) DEFAULT USER
);

CREATE TABLE CPCOMPRAVENDA (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    INTEGER NOT NULL,
    CODCOMPRA    INTEGER NOT NULL,
    CODITCOMPRA  INTEGER NOT NULL,
    CODEMPVD     INTEGER NOT NULL,
    CODFILIALVD  INTEGER NOT NULL,
    TIPOVENDA    CHAR(1) NOT NULL,
    CODVENDA     INTEGER NOT NULL,
    CODITVENDA   INTEGER NOT NULL,
    QTDDEV       NUMERICDN NOT NULL
);

CREATE TABLE CPCOTACAO (
    CODEMP              INTEGER NOT NULL,
    CODFILIAL           SMALLINT NOT NULL,
    CODSOL              INTEGER NOT NULL,
    CODITSOL            SMALLINT NOT NULL,
    CODCOT              SMALLINT NOT NULL,
    DTCOT               DATE DEFAULT 'now' NOT NULL,
    IDUSUCOT            CHAR(8) DEFAULT user NOT NULL,
    CODEMPFR            INTEGER NOT NULL,
    CODFILIALFR         SMALLINT NOT NULL,
    CODFOR              INTEGER NOT NULL,
    QTDCOT              NUMERICDN DEFAULT 0 NOT NULL,
    QTDAPROVCOT         NUMERICDN DEFAULT 0 NOT NULL,
    PRECOCOT            NUMERICDN DEFAULT 0 NOT NULL,
    SITCOMPITSOL        CHAR(2) DEFAULT 'PE',
    SITAPROVITSOL       CHAR(2) DEFAULT 'PE',
    SITITSOL            CHAR(2) DEFAULT 'PE',
    MOTIVOCANCCOT       VARCHAR(10000),
    MOTIVOCOTABAIXO     VARCHAR(10000),
    DTINS               DATE DEFAULT 'now',
    HINS                TIME DEFAULT 'now',
    IDUSUINS            CHAR(8) DEFAULT USER,
    DTALT               DATE,
    HALT                TIME,
    IDUSUALT            CHAR(8),
    VLRFRETEITCOMPRA    NUMERIC(15,5),
    PERCIPIITCOMPRA     NUMERIC(9,2),
    VLRBASEIPIITCOMPRA  NUMERIC(15,5),
    VLRIPIITCOMPRA      NUMERIC(15,5),
    VLRLIQITCOMPRA      NUMERIC(15,5)
);

CREATE TABLE CPEQUIVCFOP (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODNAT       CHAR(4) NOT NULL,
    CODEMPND     INTEGER NOT NULL,
    CODFILIALND  SMALLINT NOT NULL,
    CODNATND     CHAR(4) NOT NULL,
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8),
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now'
);

CREATE TABLE CPFORNECED (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    CODFOR        INTEGER NOT NULL,
    RAZFOR        CHAR(50) NOT NULL,
    CODEMPTF      INTEGER NOT NULL,
    CODFILIALTF   SMALLINT NOT NULL,
    CODTIPOFOR    INTEGER NOT NULL,
    CODEMPBO      INTEGER,
    CODFILIALBO   SMALLINT,
    CODBANCO      CHAR(3),
    CODEMPHP      INTEGER,
    CODFILIALHP   SMALLINT,
    CODHIST       INTEGER,
    NOMEFOR       CHAR(50) NOT NULL,
    DATAFOR       DATE DEFAULT 'today' NOT NULL,
    ATIVOFOR      CHAR(1),
    PESSOAFOR     CHAR(1) NOT NULL,
    CNPJFOR       CHAR(14),
    CPFFOR        CHAR(11),
    INSCFOR       VARCHAR(20),
    RGFOR         CHAR(10),
    ENDFOR        CHAR(50),
    NUMFOR        INTEGER,
    COMPLFOR      CHAR(20),
    BAIRFOR       CHAR(30),
    CEPFOR        CHAR(8),
    CIDFOR        CHAR(30),
    UFFOR         CHAR(2),
    CONTFOR       CHAR(40),
    FONEFOR       CHAR(12),
    FAXFOR        CHAR(8),
    AGENCIAFOR    CHAR(6),
    CONTAFOR      CHAR(10),
    EMAILFOR      CHAR(50),
    OBSFOR        VARCHAR(10000),
    CELFOR        CHAR(8),
    CLIFOR        CHAR(1) DEFAULT 'F',
    SSPFOR        CHAR(10),
    DDDFONEFOR    CHAR(4),
    DDDFAXFOR     CHAR(4),
    DDDCELFOR     CHAR(4),
    SITEFOR       CHAR(50),
    CODCONTDEB    VARCHAR(20),
    CODCONTCRED   VARCHAR(20),
    CODFORCONTAB  VARCHAR(20),
    CODMUNIC      CHAR(5),
    SIGLAUF       CHAR(2),
    CODPAIS       SMALLINT,
    DTINS         DATE DEFAULT 'now',
    IDUSUINS      CHAR(8) DEFAULT USER,
    DTALT         DATE DEFAULT 'now',
    IDUSUALT      CHAR(8) DEFAULT USER,
    HINS          TIME DEFAULT 'now',
    HALT          TIME DEFAULT 'now'
);

CREATE TABLE CPITCOMPRA (
    CODEMP               INTEGER NOT NULL,
    CODFILIAL            SMALLINT NOT NULL,
    CODCOMPRA            INTEGER NOT NULL,
    CODITCOMPRA          INTEGER NOT NULL,
    CODEMPPD             INTEGER NOT NULL,
    CODFILIALPD          SMALLINT NOT NULL,
    CODPROD              INTEGER NOT NULL,
    CODEMPLE             INTEGER,
    CODFILIALLE          SMALLINT,
    CODLOTE              VARCHAR(20),
    CODEMPNT             INTEGER NOT NULL,
    CODFILIALNT          SMALLINT NOT NULL,
    CODNAT               CHAR(4) NOT NULL,
    CODEMPAX             INTEGER NOT NULL,
    CODFILIALAX          SMALLINT NOT NULL,
    CODALMOX             INTEGER NOT NULL,
    QTDITCOMPRA          NUMERICDN NOT NULL,
    PRECOITCOMPRA        NUMERICDN NOT NULL,
    PERCDESCITCOMPRA     NUMERIC(9,2),
    VLRDESCITCOMPRA      NUMERICDN,
    PERCICMSITCOMPRA     NUMERIC(9,2),
    VLRBASEICMSITCOMPRA  NUMERICDN,
    VLRICMSITCOMPRA      NUMERICDN,
    PERCIPIITCOMPRA      NUMERIC(9,2),
    VLRBASEIPIITCOMPRA   NUMERICDN,
    VLRIPIITCOMPRA       NUMERICDN,
    VLRLIQITCOMPRA       NUMERICDN,
    VLRADICITCOMPRA      NUMERICDN,
    VLRFRETEITCOMPRA     NUMERICDN,
    VLRISENTASITCOMPRA   NUMERICDN,
    VLROUTRASITCOMPRA    NUMERICDN,
    VLRPRODITCOMPRA      NUMERICDN,
    CUSTOITCOMPRA        NUMERICDN DEFAULT 0,
    REFPROD              CHAR(13),
    DTINS                DATE DEFAULT 'now',
    IDUSUINS             CHAR(8) DEFAULT USER,
    DTALT                DATE DEFAULT 'now',
    IDUSUALT             CHAR(8) DEFAULT USER,
    HINS                 TIME DEFAULT 'now',
    HALT                 TIME DEFAULT 'now',
    CUSTOVDITCOMPRA      NUMERICDN DEFAULT 0 NOT NULL,
    EMMANUT              CHAR(1) DEFAULT 'N' NOT NULL
);

CREATE TABLE CPITSOLICITACAO (
    CODEMP            INTEGER NOT NULL,
    CODFILIAL         SMALLINT NOT NULL,
    CODSOL            INTEGER NOT NULL,
    CODITSOL          SMALLINT NOT NULL,
    CODEMPPD          INTEGER NOT NULL,
    CODFILIALPD       SMALLINT NOT NULL,
    CODPROD           INTEGER NOT NULL,
    REFPROD           CHAR(13) NOT NULL,
    QTDITSOL          NUMERICDN DEFAULT 0 NOT NULL,
    QTDAPROVITSOL     NUMERICDN DEFAULT 0 NOT NULL,
    IDUSUITSOL        CHAR(8) DEFAULT USER NOT NULL,
    DTITSOL           DATE DEFAULT 'now' NOT NULL,
    IDUSUAPROVITSOL   CHAR(8),
    DTAPROVITSOL      DATE,
    SITAPROVITSOL     CHAR(2) DEFAULT 'PE' NOT NULL,
    SITCOMPITSOL      CHAR(2) DEFAULT 'PE' NOT NULL,
    SITITSOL          CHAR(2) DEFAULT 'PE' NOT NULL,
    CODEMPAM          INTEGER NOT NULL,
    CODFILIALAM       SMALLINT NOT NULL,
    CODALMOX          INTEGER NOT NULL,
    MOTIVOITSOL       VARCHAR(10000),
    MOTIVOAPROVITSOL  VARCHAR(10000),
    MOTIVOCOMPITSOL   VARCHAR(10000),
    IDUSUCANCITSOL    CHAR(8),
    PRIORITSOL        CHAR(1) DEFAULT 'B' NOT NULL,
    MOTIVOPRIORITSOL  VARCHAR(10000),
    MOTIVOCANCITSOL   VARCHAR(10000),
    MOTIVOCOTABAIX    VARCHAR(10000),
    CODEMPUA          INTEGER,
    CODFILIALUA       SMALLINT,
    DTINS             DATE DEFAULT 'now',
    HINS              TIME DEFAULT 'now',
    IDUSUINS          CHAR(8) DEFAULT USER,
    DTALT             DATE,
    HALT              TIME,
    IDUSUALT          CHAR(8)
);

CREATE TABLE CPITSUMSOL (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODSUMSOL    INTEGER NOT NULL,
    CODEMPSC     INTEGER NOT NULL,
    CODFILIALSC  SMALLINT NOT NULL,
    CODSOL       INTEGER NOT NULL,
    CODITSOL     SMALLINT NOT NULL,
    DTCOT        DATE,
    IDUSUCOT     CHAR(8),
    CODEMPFR     INTEGER,
    CODFILIALFR  SMALLINT,
    CODFOR       INTEGER,
    QTDCOT       NUMERIC(15,5),
    PRECOCOT     NUMERIC(15,5),
    DTINS        DATE DEFAULT 'now',
    HINS         TIME DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE,
    HALT         TIME,
    IDUSUALT     CHAR(8)
);

CREATE TABLE CPPRODFOR (
    CODEMP      INTEGER NOT NULL,
    CODFILIAL   SMALLINT NOT NULL,
    CODPROD     INTEGER NOT NULL,
    CODFOR      INTEGER NOT NULL,
    REFPRODFOR  CHAR(21),
    DTINS       DATE DEFAULT 'now',
    IDUSUINS    CHAR(8) DEFAULT USER,
    DTALT       DATE DEFAULT 'now',
    IDUSUALT    CHAR(8) DEFAULT USER,
    HINS        TIME DEFAULT 'now',
    HALT        TIME DEFAULT 'now'
);

CREATE TABLE CPRATEIO (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODCOMPRA    INTEGER NOT NULL,
    SEQRATEIO    SMALLINT NOT NULL,
    CODEMPFN     INTEGER NOT NULL,
    CODFILIALFN  SMALLINT NOT NULL,
    CODPLAN      CHAR(13) NOT NULL,
    CODEMPCC     INTEGER NOT NULL,
    CODFILIALCC  SMALLINT NOT NULL,
    ANOCC        SMALLINT NOT NULL,
    CODCC        CHAR(19) NOT NULL,
    PERCRATEIO   NUMERIC(6,2) DEFAULT 0 NOT NULL,
    VLRRATEIO    NUMERICDN DEFAULT 0 NOT NULL,
    SITRATEIO    CHAR(1) DEFAULT 'N' NOT NULL,
    IDUSUIN      CHAR(8) DEFAULT user,
    DTINS        DATE DEFAULT 'now',
    HINS         TIME DEFAULT 'now',
    IDUSUALT     CHAR(8),
    DTALT        DATE,
    HALT         TIME
);

CREATE TABLE CPSOLICITACAO (
    CODEMP         INTEGER NOT NULL,
    CODFILIAL      SMALLINT NOT NULL,
    CODSOL         INTEGER NOT NULL,
    DTEMITSOL      DATE NOT NULL,
    SITSOL         CHAR(2) DEFAULT 'PE' NOT NULL,
    ORIGSOL        CHAR(2) DEFAULT 'AX' NOT NULL,
    MOTIVOSOL      VARCHAR(10000),
    CODEMPUU       INTEGER NOT NULL,
    CODFILIALUU    SMALLINT NOT NULL,
    IDUSU          CHAR(8) NOT NULL,
    DTAAPROVSOL    DATE,
    CODEMPUA       INTEGER,
    CODFILIALUA    SMALLINT,
    IDUSUAPROV     CHAR(8),
    CODEMPCC       INTEGER NOT NULL,
    CODFILIALCC    SMALLINT NOT NULL,
    CODCC          CHAR(19) NOT NULL,
    ANOCC          SMALLINT NOT NULL,
    IDUSUCANCSOL   CHAR(8),
    MOTIVOCANCSOL  VARCHAR(10000),
    DTINS          DATE DEFAULT 'now',
    HINS           TIME DEFAULT 'now',
    DTALT          DATE,
    HALT           TIME,
    IDUSUINS       CHAR(8) DEFAULT USER,
    IDUSUALT       CHAR(8)
);

CREATE TABLE CPSUMSOL (
    CODEMP           INTEGER NOT NULL,
    CODFILIAL        SMALLINT NOT NULL,
    CODSUMSOL        INTEGER NOT NULL,
    CODEMPPD         INTEGER NOT NULL,
    CODFILIALPD      SMALLINT NOT NULL,
    CODPROD          INTEGER NOT NULL,
    REFPROD          CHAR(13) NOT NULL,
    QTDITSOL         NUMERICDN DEFAULT 0 NOT NULL,
    QTDAPROVITSOL    NUMERICDN DEFAULT 0 NOT NULL,
    SITITSOL         CHAR(2) DEFAULT 'PE' NOT NULL,
    DTAPROVITSOL     DATE,
    IDUSUAPROVITSOL  CHAR(8),
    SITAPROVITSOL    CHAR(2),
    MOTIVOCOTABAIX   VARCHAR(10000),
    DTINS            DATE DEFAULT 'now',
    HINS             TIME DEFAULT 'now',
    IDUSUINS         CHAR(8) DEFAULT USER,
    DTALT            DATE,
    HALT             TIME,
    IDUSUALT         CHAR(8)
);

CREATE TABLE CPTABFOR (
    CODEMP         INTEGER NOT NULL,
    CODFILIAL      SMALLINT NOT NULL,
    CODFOR         INTEGER NOT NULL,
    REFPRODTFOR    CHAR(21) NOT NULL,
    DESCPRODTFOR   CHAR(50) NOT NULL,
    PRECOPRODTFOR  NUMERICDN DEFAULT 0 NOT NULL,
    CODEMPPD       INTEGER,
    CODFILIALPD    SMALLINT,
    CODPROD        INTEGER,
    REFORIGTFOR    CHAR(18),
    LINHATFOR      CHAR(30),
    DTINS          DATE DEFAULT 'now',
    IDUSUINS       CHAR(8) DEFAULT USER,
    DTALT          DATE DEFAULT 'now',
    IDUSUALT       CHAR(8) DEFAULT USER,
    HINS           TIME DEFAULT 'now',
    HALT           TIME DEFAULT 'now'
);

CREATE TABLE CPTIPOFOR (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODTIPOFOR   INTEGER NOT NULL,
    DESCTIPOFOR  CHAR(40),
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now'
);

CREATE TABLE EQALMOX (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    CODALMOX   INTEGER NOT NULL,
    DESCALMOX  CHAR(40) NOT NULL,
    DTINS      DATE DEFAULT 'now',
    IDUSUINS   CHAR(8) DEFAULT USER,
    DTALT      DATE DEFAULT 'now',
    IDUSUALT   CHAR(8) DEFAULT USER,
    HINS       TIME DEFAULT 'now',
    HALT       TIME DEFAULT 'now'
);

CREATE TABLE EQALMOXFILIAL (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    CODALMOX      INTEGER NOT NULL,
    CODEMPAF      INTEGER NOT NULL,
    CODFILIALAF   SMALLINT NOT NULL,
    BAIXAESTOQAF  CHAR(1) DEFAULT 'N' NOT NULL
);

CREATE TABLE EQCLIFOR (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODCLI       INTEGER NOT NULL,
    CODEMPFR     INTEGER NOT NULL,
    CODFILIALFR  SMALLINT NOT NULL,
    CODFOR       INTEGER NOT NULL,
    DTINS        DATE DEFAULT 'now' NOT NULL,
    IDUSUINS     VARCHAR(128) DEFAULT USER NOT NULL,
    DTALT        DATE DEFAULT 'now' NOT NULL,
    IDUSUALT     VARCHAR(128) DEFAULT USER NOT NULL,
    HINS         TIME DEFAULT 'now' NOT NULL,
    HALT         TIME DEFAULT 'now' NOT NULL
);

CREATE TABLE EQCODALTPROD (
    CODEMP      INTEGER NOT NULL,
    CODFILIAL   SMALLINT NOT NULL,
    CODPROD     INTEGER NOT NULL,
    CODALTPROD  CHAR(20) NOT NULL,
    REFPROD     CHAR(13) NOT NULL,
    IDUSUINS    CHAR(8) DEFAULT user,
    IDUSUALT    CHAR(8),
    DTINS       DATE DEFAULT 'now',
    DTALT       DATE,
    HINS        TIME DEFAULT 'now',
    HALT        TIME
);

CREATE TABLE EQETIQPROD (
    NRCONEXAO  INTEGER NOT NULL,
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    CODPROD    INTEGER NOT NULL
);

CREATE TABLE EQFATCONV (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    CODPROD    INTEGER NOT NULL,
    CODUNID    VARCHAR(20) NOT NULL,
    FATCONV    NUMERIC(10,3) NOT NULL,
    CPFATCONV  CHAR(1) DEFAULT 'N' NOT NULL,
    DTINS      DATE DEFAULT 'now',
    IDUSUINS   CHAR(8) DEFAULT USER,
    DTALT      DATE DEFAULT 'now',
    IDUSUALT   CHAR(8) DEFAULT USER,
    HINS       TIME DEFAULT 'now',
    HALT       TIME DEFAULT 'now'
);

CREATE TABLE EQGRUPO (
    CODEMP         INTEGER NOT NULL,
    CODFILIAL      SMALLINT NOT NULL,
    CODGRUP        CHAR(14) NOT NULL,
    DESCGRUP       CHAR(50) NOT NULL,
    NIVELGRUP      INTEGER,
    CODEMPSG       INTEGER,
    CODFILIALSG    SMALLINT,
    CODSUBGRUP     CHAR(14),
    SIGLAGRUP      CHAR(10),
    DTINS          DATE DEFAULT 'now',
    IDUSUINS       CHAR(8) DEFAULT USER,
    DTALT          DATE DEFAULT 'now',
    IDUSUALT       CHAR(8) DEFAULT USER,
    HINS           TIME DEFAULT 'now',
    HALT           TIME DEFAULT 'now',
    ESTNEGGRUP     CHAR(1) DEFAULT 'N' NOT NULL,
    ESTLOTNEGGRUP  CHAR(1) DEFAULT 'N' NOT NULL
);

CREATE TABLE EQGUIATRAF (
    CODEMP           INTEGER NOT NULL,
    CODFILIAL        SMALLINT NOT NULL,
    CODCOMPRA        INTEGER NOT NULL,
    CODITCOMPRA      INTEGER NOT NULL,
    DTEMISGUIATRAF   DATE NOT NULL,
    NROGUIATRAF      VARCHAR(20),
    NROSELOGUIATRAF  VARCHAR(15),
    DTINS            DATE DEFAULT 'now',
    IDUSUINS         CHAR(8) DEFAULT USER,
    DTALT            DATE DEFAULT 'now',
    IDUSUALT         CHAR(8) DEFAULT USER,
    HINS             TIME DEFAULT 'now',
    HALT             TIME DEFAULT 'now'
);

CREATE TABLE EQINVPROD (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    CODINVPROD    INTEGER NOT NULL,
    CODEMPPD      INTEGER NOT NULL,
    CODFILIALPD   SMALLINT NOT NULL,
    CODPROD       INTEGER NOT NULL,
    CODEMPLE      INTEGER,
    CODFILIALLE   SMALLINT,
    CODLOTE       VARCHAR(20),
    CODEMPTM      INTEGER NOT NULL,
    CODFILIALTM   SMALLINT NOT NULL,
    CODTIPOMOV    INTEGER NOT NULL,
    DATAINVP      DATE NOT NULL,
    QTDINVP       NUMERICDN NOT NULL,
    PRECOINVP     NUMERICDN DEFAULT 0 NOT NULL,
    CODEMPAX      INTEGER NOT NULL,
    CODFILIALAX   SMALLINT NOT NULL,
    CODALMOX      INTEGER NOT NULL,
    REFPROD       CHAR(13),
    SLDATUALINVP  NUMERICDN,
    SLDDIGINVP    NUMERICDN,
    FLAG          CHAR(1) DEFAULT 'S',
    OBSINVP       VARCHAR(500),
    DTINS         DATE DEFAULT 'now',
    IDUSUINS      CHAR(8) DEFAULT USER,
    DTALT         DATE DEFAULT 'now',
    IDUSUALT      CHAR(8) DEFAULT USER,
    HINS          TIME DEFAULT 'now',
    HALT          TIME DEFAULT 'now'
);

CREATE TABLE EQITMODGRADE (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    CODMODG       INTEGER NOT NULL,
    CODITMODG     INTEGER NOT NULL,
    REFITMODG     CHAR(6),
    CODEMPVG      INTEGER NOT NULL,
    CODFILIALVG   SMALLINT NOT NULL,
    CODVARG       INTEGER NOT NULL,
    CODFABITMODG  CHAR(6),
    CODBARITMODG  CHAR(6),
    DESCITMODG    CHAR(20) NOT NULL,
    DTINS         DATE DEFAULT 'now',
    IDUSUINS      CHAR(8) DEFAULT USER,
    DTALT         DATE DEFAULT 'now',
    IDUSUALT      CHAR(8) DEFAULT USER,
    HINS          TIME DEFAULT 'now',
    HALT          TIME DEFAULT 'now'
);

CREATE TABLE EQITRMA (
    CODEMP            INTEGER NOT NULL,
    CODFILIAL         SMALLINT NOT NULL,
    CODRMA            INTEGER NOT NULL,
    CODITRMA          SMALLINT NOT NULL,
    CODEMPPD          INTEGER NOT NULL,
    CODFILIALPD       SMALLINT NOT NULL,
    CODPROD           INTEGER NOT NULL,
    QTDITRMA          NUMERICDN NOT NULL,
    SITITRMA          CHAR(2) DEFAULT 'PE' NOT NULL,
    CODEMPAX          INTEGER NOT NULL,
    CODFILIALAX       SMALLINT NOT NULL,
    CODALMOX          INTEGER,
    QTDAPROVITRMA     NUMERICDN DEFAULT 0 NOT NULL,
    QTDEXPITRMA       NUMERICDN DEFAULT 0 NOT NULL,
    CODEMPLE          INTEGER,
    CODFILIALLE       SMALLINT,
    CODLOTE           VARCHAR(20),
    REFPROD           CHAR(13) NOT NULL,
    DTAPROVITRMA      DATE,
    DTAEXPITRMA       DATE,
    PRECOITRMA        NUMERICDN DEFAULT 0 NOT NULL,
    SITAPROVITRMA     CHAR(2) DEFAULT 'PE' NOT NULL,
    SITEXPITRMA       CHAR(2) DEFAULT 'PE' NOT NULL,
    MOTIVOCANCITRMA   VARCHAR(10000),
    PRIORITRMA        CHAR(1) DEFAULT 'B' NOT NULL,
    MOTIVOPRIORITRMA  VARCHAR(10000),
    DTINS             DATE DEFAULT 'now',
    HINS              TIME DEFAULT 'now',
    IDUSUINS          CHAR(8) DEFAULT USER,
    DTALT             DATE DEFAULT 'now',
    HALT              TIME DEFAULT 'now',
    IDUSUALT          CHAR(8) DEFAULT USER
);

CREATE TABLE EQITSIMILAR (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODSIM       INTEGER NOT NULL,
    CODEMPPD     INTEGER NOT NULL,
    CODFILIALPD  SMALLINT NOT NULL,
    CODPROD      INTEGER NOT NULL,
    REFPROD      CHAR(13) NOT NULL,
    IDUSUINS     CHAR(8) DEFAULT user,
    IDUSUALT     CHAR(8),
    DTINS        DATE DEFAULT 'now',
    DTALT        DATE,
    HINS         TIME DEFAULT 'now',
    HALT         TIME
);

CREATE TABLE EQLANCTOEXP (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODLEXP      INTEGER NOT NULL,
    CODEMPTE     INTEGER NOT NULL,
    CODFILIALTE  SMALLINT NOT NULL,
    CODTIPOEXP   INTEGER NOT NULL,
    CODEMPCL     INTEGER NOT NULL,
    CODFILIALCL  SMALLINT NOT NULL,
    CODCLI       INTEGER NOT NULL,
    DTLEXP       DATE NOT NULL,
    QTDLEXP      INTEGER NOT NULL,
    DTRETLEXP    DATE,
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now'
);

CREATE TABLE EQLOTE (
    CODEMP         INTEGER NOT NULL,
    CODFILIAL      SMALLINT NOT NULL,
    CODPROD        INTEGER NOT NULL,
    CODLOTE        VARCHAR(20) NOT NULL,
    VENCTOLOTE     DATE NOT NULL,
    SLDLOTE        NUMERICDN,
    SLDRESLOTE     NUMERICDN,
    SLDCONSIGLOTE  NUMERICDN,
    SLDLIQLOTE     NUMERICDN,
    DINILOTE       DATE,
    DTINS          DATE DEFAULT 'now',
    IDUSUINS       CHAR(8) DEFAULT USER,
    DTALT          DATE DEFAULT 'now',
    IDUSUALT       CHAR(8) DEFAULT USER,
    HINS           TIME DEFAULT 'now',
    HALT           TIME DEFAULT 'now'
);

CREATE TABLE EQMARCA (
    CODEMP      INTEGER NOT NULL,
    CODFILIAL   SMALLINT NOT NULL,
    CODMARCA    CHAR(6) NOT NULL,
    DESCMARCA   CHAR(40) NOT NULL,
    SIGLAMARCA  CHAR(20),
    DTINS       DATE DEFAULT 'now',
    IDUSUINS    CHAR(8) DEFAULT USER,
    DTALT       DATE DEFAULT 'now',
    IDUSUALT    CHAR(8) DEFAULT USER,
    HINS        TIME DEFAULT 'now',
    HALT        TIME DEFAULT 'now'
);

CREATE TABLE EQMODGRADE (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    CODMODG       INTEGER NOT NULL,
    CODEMPPD      INTEGER NOT NULL,
    CODFILIALPD   SMALLINT NOT NULL,
    CODPROD       INTEGER NOT NULL,
    DESCMODG      CHAR(40) NOT NULL,
    DESCPRODMODG  CHAR(20) NOT NULL,
    REFMODG       CHAR(10) NOT NULL,
    CODFABMODG    CHAR(10) NOT NULL,
    CODBARMODG    CHAR(10) NOT NULL,
    DTINS         DATE DEFAULT 'now',
    IDUSUINS      CHAR(8) DEFAULT USER,
    DTALT         DATE DEFAULT 'now',
    IDUSUALT      CHAR(8) DEFAULT USER,
    HINS          TIME DEFAULT 'now',
    HALT          TIME DEFAULT 'now'
);

CREATE TABLE EQMODLOTE (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODMODLOTE   INTEGER NOT NULL,
    DESCMODLOTE  CHAR(30) NOT NULL,
    TXAMODLOTE   VARCHAR(100) NOT NULL
);

CREATE TABLE EQMOVEXP (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODMOVEXP    INTEGER NOT NULL,
    CODEMPTE     INTEGER NOT NULL,
    CODFILIALTE  SMALLINT NOT NULL,
    CODTIPOEXP   INTEGER NOT NULL,
    CODEMPCL     INTEGER NOT NULL,
    CODFILIALCL  SMALLINT NOT NULL,
    CODCLI       INTEGER NOT NULL,
    DTSAIMOVEXP  DATE NOT NULL,
    QTDMOVEXP    INTEGER NOT NULL,
    DTENTMOVEXP  DATE,
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now'
);

CREATE TABLE EQMOVPROD (
    CODEMP             INTEGER NOT NULL,
    CODFILIAL          SMALLINT NOT NULL,
    CODMOVPROD         INTEGER NOT NULL,
    CODEMPPD           INTEGER NOT NULL,
    CODFILIALPD        SMALLINT NOT NULL,
    CODPROD            INTEGER NOT NULL,
    CODEMPVD           INTEGER,
    CODFILIALVD        SMALLINT,
    TIPOVENDA          CHAR(1),
    CODVENDA           INTEGER,
    CODITVENDA         INTEGER,
    CODEMPLE           INTEGER,
    CODFILIALLE        SMALLINT,
    CODLOTE            VARCHAR(20),
    CODEMPTM           INTEGER NOT NULL,
    CODFILIALTM        SMALLINT NOT NULL,
    CODTIPOMOV         INTEGER NOT NULL,
    CODEMPCP           INTEGER,
    CODFILIALCP        SMALLINT,
    CODCOMPRA          INTEGER,
    CODITCOMPRA        INTEGER,
    CODEMPIV           INTEGER,
    CODFILIALIV        SMALLINT,
    CODINVPROD         INTEGER,
    DTMOVPROD          DATE NOT NULL,
    TIPOMOVPROD        CHAR(1) NOT NULL,
    ESTOQMOVPROD       CHAR(1) DEFAULT 'S' NOT NULL,
    CODEMPAX           INTEGER NOT NULL,
    CODFILIALAX        SMALLINT NOT NULL,
    CODALMOX           INTEGER NOT NULL,
    QTDMOVPROD         NUMERICDN NOT NULL,
    PRECOMOVPROD       NUMERICDN,
    CUSTOMPMMOVPROD    NUMERICDN DEFAULT 0,
    CUSTOMPMMOVPRODAX  NUMERICDN,
    SLDMOVPROD         NUMERICDN,
    SLDMOVPRODAX       NUMERICDN,
    FLAG               CHAR(1) DEFAULT 'N',
    CODEMPNT           INTEGER,
    CODFILIALNT        SMALLINT,
    CODNAT             CHAR(4),
    DOCMOVPROD         INTEGER,
    CODEMPRM           INTEGER,
    CODFILIALRM        SMALLINT,
    CODRMA             INTEGER,
    CODITRMA           SMALLINT,
    EMMANUT            CHAR(1) DEFAULT 'N',
    DTINS              DATE DEFAULT 'now',
    IDUSUINS           CHAR(8) DEFAULT USER,
    DTALT              DATE DEFAULT 'now',
    IDUSUALT           CHAR(8) DEFAULT USER,
    HINS               TIME DEFAULT 'now',
    HALT               TIME DEFAULT 'now',
    CODEMPOP           INTEGER,
    CODFILIALOP        SMALLINT,
    CODOP              INTEGER,
    SEQOP              SMALLINT
);

CREATE TABLE EQPRODACESSO (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODPROD      INTEGER NOT NULL,
    TIPOPA       CHAR(3) NOT NULL,
    CODPA        INTEGER NOT NULL,
    CODEMPCC     INTEGER,
    CODFILIALCC  SMALLINT,
    ANOCC        SMALLINT,
    CODCC        CHAR(19),
    CODEMPCX     INTEGER,
    CODFILIALCX  SMALLINT,
    CODCAIXA     INTEGER,
    IDUSUINS     CHAR(8) DEFAULT user,
    DTINS        DATE DEFAULT 'now',
    HINS         TIME DEFAULT 'now',
    IDUSUALT     CHAR(8),
    DTALT        DATE,
    HALT         TIME
);

CREATE TABLE EQPRODPLAN (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODPROD      INTEGER NOT NULL,
    SEQPP        SMALLINT NOT NULL,
    TIPOPP       CHAR(1) NOT NULL,
    CODEMPPN     INTEGER NOT NULL,
    CODFILIALPN  SMALLINT NOT NULL,
    CODPLAN      CHAR(13) NOT NULL,
    CODEMPCC     INTEGER NOT NULL,
    CODFILIALCC  SMALLINT NOT NULL,
    ANOCC        SMALLINT NOT NULL,
    CODCC        CHAR(19) NOT NULL,
    PERCPP       NUMERIC(6,2) DEFAULT 0 NOT NULL,
    IDUSUINS     CHAR(8) DEFAULT user,
    DTINS        DATE DEFAULT 'now',
    HINS         TIME DEFAULT 'now',
    IDUSUALT     CHAR(8),
    DTALT        DATE,
    HALT         TIME
);

CREATE TABLE EQPRODUTO (
    CODEMP          INTEGER NOT NULL,
    CODFILIAL       SMALLINT NOT NULL,
    CODPROD         INTEGER NOT NULL,
    DESCPROD        CHAR(50) NOT NULL,
    REFPROD         CHAR(13) NOT NULL,
    CODEMPAX        INTEGER NOT NULL,
    CODFILIALAX     SMALLINT NOT NULL,
    CODALMOX        INTEGER NOT NULL,
    CODEMPMA        INTEGER NOT NULL,
    CODFILIALMA     SMALLINT NOT NULL,
    CODMOEDA        CHAR(4) NOT NULL,
    CODEMPUD        INTEGER NOT NULL,
    CODFILIALUD     SMALLINT NOT NULL,
    CODUNID         VARCHAR(20) NOT NULL,
    CODEMPFC        INTEGER NOT NULL,
    CODFILIALFC     SMALLINT NOT NULL,
    CODFISC         CHAR(13) NOT NULL,
    CODEMPMC        INTEGER NOT NULL,
    CODFILIALMC     SMALLINT NOT NULL,
    CODMARCA        CHAR(6) NOT NULL,
    DESCAUXPROD     CHAR(40),
    TIPOPROD        CHAR(1) NOT NULL,
    CVPROD          CHAR(1) NOT NULL,
    CODEMPGP        INTEGER NOT NULL,
    CODFILIALGP     SMALLINT NOT NULL,
    CODGRUP         CHAR(14) NOT NULL,
    CODBARPROD      CHAR(13),
    CLOTEPROD       CHAR(1) NOT NULL,
    CODFABPROD      CHAR(13),
    COMISPROD       NUMERIC(6,2),
    PESOLIQPROD     NUMERIC(10,3),
    PESOBRUTPROD    NUMERIC(10,3),
    QTDMINPROD      NUMERICDN,
    QTDMAXPROD      NUMERICDN,
    DTMPMPROD       DATE,
    CUSTOMPMPROD    NUMERICDN DEFAULT 0,
    CUSTOPEPSPROD   NUMERICDN DEFAULT 0,
    PRECOBASEPROD   NUMERICDN,
    SLDPROD         NUMERICDN,
    SLDRESPROD      NUMERICDN,
    SLDCONSIGPROD   NUMERICDN,
    SLDLIQPROD      NUMERICDN,
    ATIVOPROD       CHAR(1) DEFAULT 'S',
    DTULTCPPROD     DATE,
    QTDULTCPPROD    NUMERICDN,
    DESCCOMPPROD    VARCHAR(500),
    VERIFPROD       CHAR(1) DEFAULT 'S',
    LOCALPROD       CHAR(15),
    RMAPROD         CHAR(1) DEFAULT 'N' NOT NULL,
    DTINS           DATE DEFAULT 'now',
    IDUSUINS        CHAR(8) DEFAULT USER,
    DTALT           DATE DEFAULT 'now',
    IDUSUALT        CHAR(8) DEFAULT USER,
    HINS            TIME DEFAULT 'now',
    HALT            TIME DEFAULT 'now',
    CODEMPPE        INTEGER,
    CODFILIALPE     SMALLINT,
    CODPE           INTEGER,
    USARECEITAPROD  CHAR(1) DEFAULT 'N' NOT NULL,
    USATELAADICPDV  CHAR(1) DEFAULT 'N' NOT NULL,
    VLRDENSIDADE    NUMERIC(15,5),
    VLRCONCENT      NUMERIC(15,5),
    COMPRIMENTO     NUMERICDN,
    LARGURA         NUMERICDN,
    ESPESSURA       NUMERICDN,
    GUIATRAFPROD    CHAR(1) DEFAULT 'N' NOT NULL
);

CREATE TABLE EQRMA (
    CODEMP         INTEGER NOT NULL,
    CODFILIAL      SMALLINT NOT NULL,
    CODRMA         INTEGER NOT NULL,
    IDUSU          CHAR(8) NOT NULL,
    CODEMPTM       INTEGER NOT NULL,
    CODFILIALTM    SMALLINT NOT NULL,
    CODTIPOMOV     INTEGER NOT NULL,
    DTINS          DATE DEFAULT 'now',
    IDUSUINS       CHAR(8) DEFAULT USER,
    DTALT          DATE DEFAULT 'now',
    IDUSUALT       CHAR(8) DEFAULT USER,
    HINS           TIME DEFAULT 'now',
    HALT           TIME DEFAULT 'now',
    MOTIVORMA      VARCHAR(10000),
    MOTIVOCANCRMA  VARCHAR(10000),
    SITRMA         CHAR(2) DEFAULT 'PE' NOT NULL,
    CODEMPCC       INTEGER NOT NULL,
    CODFILIALCC    SMALLINT NOT NULL,
    ANOCC          SMALLINT NOT NULL,
    CODCC          CHAR(19) NOT NULL,
    CODEMPUU       INTEGER NOT NULL,
    CODFILIALUU    SMALLINT NOT NULL,
    DTAREQRMA      DATE DEFAULT 'today' NOT NULL,
    DTAEXPRMA      DATE,
    SITAPROVRMA    CHAR(2) DEFAULT 'PE' NOT NULL,
    SITEXPRMA      CHAR(2) DEFAULT 'PE' NOT NULL,
    IDUSUAPROV     CHAR(8),
    CODEMPUA       INTEGER,
    CODFILIALUA    SMALLINT,
    IDUSUEXP       CHAR(8),
    CODEMPUE       INTEGER,
    CODFILIALUE    SMALLINT,
    DTAAPROVRMA    DATE,
    CODEMPOF       INTEGER,
    CODFILIALOF    SMALLINT,
    CODOP          INTEGER,
    SEQOP          SMALLINT,
    SEQOF          SMALLINT
);

CREATE TABLE EQRMAAL (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODRMA       INTEGER NOT NULL,
    TIPORMAAL    CHAR(1) DEFAULT 'L' NOT NULL,
    CODEMPUU     INTEGER NOT NULL,
    CODFILIALUU  SMALLINT NOT NULL,
    IDUSU        CHAR(8) NOT NULL
);

CREATE TABLE EQSALDOLOTE (
    CODEMP         INTEGER NOT NULL,
    CODFILIAL      SMALLINT NOT NULL,
    CODPROD        INTEGER NOT NULL,
    CODLOTE        VARCHAR(20) NOT NULL,
    CODEMPAX       INTEGER NOT NULL,
    CODFILIALAX    SMALLINT NOT NULL,
    CODALMOX       INTEGER NOT NULL,
    SLDLOTE        NUMERICDN DEFAULT 0 NOT NULL,
    SLDRESLOTE     NUMERICDN DEFAULT 0 NOT NULL,
    SLDCONSIGLOTE  NUMERICDN DEFAULT 0 NOT NULL,
    SLDLIQLOTE     NUMERICDN DEFAULT 0 NOT NULL,
    DTINS          DATE DEFAULT 'now',
    IDUSUINS       CHAR(8) DEFAULT USER,
    DTALT          DATE DEFAULT 'now',
    IDUSUALT       CHAR(8) DEFAULT USER,
    HINS           TIME DEFAULT 'now',
    HALT           TIME DEFAULT 'now'
);

CREATE TABLE EQSALDOPROD (
    CODEMP         INTEGER NOT NULL,
    CODFILIAL      SMALLINT NOT NULL,
    CODPROD        INTEGER NOT NULL,
    CODEMPAX       INTEGER NOT NULL,
    CODFILIALAX    SMALLINT NOT NULL,
    CODALMOX       INTEGER NOT NULL,
    SLDPROD        NUMERICDN DEFAULT 0 NOT NULL,
    SLDRESPROD     NUMERICDN DEFAULT 0 NOT NULL,
    SLDCONSIGPROD  NUMERICDN DEFAULT 0 NOT NULL,
    SLDLIQPROD     NUMERICDN DEFAULT 0 NOT NULL,
    DTINS          DATE DEFAULT 'now',
    IDUSUINS       CHAR(8) DEFAULT USER,
    DTALT          DATE DEFAULT 'now',
    IDUSUALT       CHAR(8) DEFAULT USER,
    HINS           TIME DEFAULT 'now',
    HALT           TIME DEFAULT 'now'
);

CREATE TABLE EQSIMILAR (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    CODSIM     INTEGER NOT NULL,
    DESCSIM    CHAR(50) NOT NULL,
    DTINS      DATE DEFAULT 'now',
    IDUSUINS   CHAR(8) DEFAULT USER,
    DTALT      DATE DEFAULT 'now',
    IDUSUALT   CHAR(8) DEFAULT USER,
    HINS       TIME DEFAULT 'now',
    HALT       TIME DEFAULT 'now'
);

CREATE TABLE EQTIPOEXP (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODTIPOEXP   INTEGER NOT NULL,
    DESCTIPOEXP  CHAR(40) NOT NULL,
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now'
);

CREATE TABLE EQTIPOMOV (
    CODEMP          INTEGER NOT NULL,
    CODFILIAL       SMALLINT NOT NULL,
    CODTIPOMOV      INTEGER NOT NULL,
    CODEMPMN        INTEGER NOT NULL,
    CODFILIALMN     SMALLINT NOT NULL,
    CODMODNOTA      INTEGER NOT NULL,
    CODEMPSE        INTEGER NOT NULL,
    CODFILIALSE     SMALLINT NOT NULL,
    SERIE           CHAR(4) NOT NULL,
    DESCTIPOMOV     CHAR(40) NOT NULL,
    ESTIPOMOV       CHAR(1) NOT NULL,
    FISCALTIPOMOV   CHAR(1) NOT NULL,
    ESTOQTIPOMOV    CHAR(1) NOT NULL,
    TIPOMOV         CHAR(2) NOT NULL,
    CODEMPTB        INTEGER,
    CODFILIALTB     SMALLINT,
    CODTAB          INTEGER,
    ESPECIETIPOMOV  CHAR(4),
    CODEMPTM        INTEGER,
    CODFILIALTM     SMALLINT,
    CODTIPOMOVTM    INTEGER,
    IMPPEDTIPOMOV   CHAR(1) DEFAULT 'N' NOT NULL,
    IMPNFTIPOMOV    CHAR(1) DEFAULT 'N' NOT NULL,
    IMPBOLTIPOMOV   CHAR(1) DEFAULT 'N' NOT NULL,
    IMPRECTIPOMOV   CHAR(1) DEFAULT 'N' NOT NULL,
    REIMPNFTIPOMOV  CHAR(1) DEFAULT 'N' NOT NULL,
    TUSUTIPOMOV     CHAR(1) DEFAULT 'S' NOT NULL,
    SOMAVDTIPOMOV   CHAR(1) DEFAULT 'N',
    SEQNFTIPOMOV    CHAR(1) DEFAULT 'N' NOT NULL,
    VLRMFINTIPOMOV  CHAR(1) DEFAULT 'N' NOT NULL,
    MCOMISTIPOMOV   CHAR(1) DEFAULT 'N' NOT NULL,
    CTIPOFRETE      CHAR(1) DEFAULT 'C',
    CODEMPRC        INTEGER,
    CODFILIALRC     SMALLINT,
    CODREGRCOMIS    INTEGER,
    CODEMPTN        INTEGER,
    CODFILIALTN     SMALLINT,
    CODTRAN         INTEGER,
    DTINS           DATE DEFAULT 'now',
    IDUSUINS        CHAR(8) DEFAULT USER,
    DTALT           DATE DEFAULT 'now',
    IDUSUALT        CHAR(8) DEFAULT USER,
    HINS            TIME DEFAULT 'now',
    HALT            TIME DEFAULT 'now'
);

CREATE TABLE EQTIPOMOVUSU (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODTIPOMOV   INTEGER NOT NULL,
    CODEMPUS     INTEGER NOT NULL,
    CODFILIALUS  SMALLINT NOT NULL,
    IDUSU        CHAR(8) NOT NULL
);

CREATE TABLE EQUNIDADE (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    CODUNID    VARCHAR(20) NOT NULL,
    DESCUNID   VARCHAR(60) NOT NULL,
    CASASDEC   SMALLINT DEFAULT 2 NOT NULL,
    DTINS      DATE DEFAULT 'now',
    IDUSUINS   CHAR(8) DEFAULT USER,
    DTALT      DATE DEFAULT 'now',
    IDUSUALT   CHAR(8) DEFAULT USER,
    HINS       TIME DEFAULT 'now',
    HALT       TIME DEFAULT 'now'
);

CREATE TABLE EQVARGRADE (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    CODVARG    INTEGER NOT NULL,
    DESCVARG   CHAR(30) NOT NULL,
    DTINS      DATE DEFAULT 'now',
    IDUSUINS   CHAR(8) DEFAULT USER,
    DTALT      DATE DEFAULT 'now',
    IDUSUALT   CHAR(8) DEFAULT USER,
    HINS       TIME DEFAULT 'now',
    HALT       TIME DEFAULT 'now'
);

CREATE TABLE FNBANCO (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODBANCO     CHAR(3) NOT NULL,
    NOMEBANCO    CHAR(40) NOT NULL,
    DVBANCO      CHAR(1) DEFAULT '' NOT NULL,
    SITEBANCO    VARCHAR(80) DEFAULT '',
    CODEMPMB     INTEGER,
    CODFILIALMB  INTEGER,
    CODMODBOL    INTEGER,
    IMGBOLBANCO  BLOB SUB_TYPE 0 SEGMENT SIZE 50,
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now'
);

CREATE TABLE FNCARTCOB (
    CODEMPBO     INTEGER NOT NULL,
    CODFILIALBO  SMALLINT NOT NULL,
    CODBANCO     CHAR(3) NOT NULL,
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODCARTCOB   CHAR(2) NOT NULL,
    DESCCARTCOB  VARCHAR(50) NOT NULL,
    CARTCOBCNAB  CHAR(1) NOT NULL
);

CREATE TABLE FNCC (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    ANOCC         SMALLINT NOT NULL,
    CODCC         CHAR(19) NOT NULL,
    DESCCC        CHAR(50) NOT NULL,
    NIVELCC       INTEGER NOT NULL,
    CODREDCC      INTEGER,
    CODEMPSCC     INTEGER,
    CODFILIALSCC  SMALLINT,
    ANOSCC        SMALLINT,
    CODSUBCC      CHAR(19),
    SIGLACC       CHAR(10) DEFAULT '' NOT NULL,
    DTINS         DATE DEFAULT 'now',
    IDUSUINS      CHAR(8) DEFAULT USER,
    DTALT         DATE DEFAULT 'now',
    IDUSUALT      CHAR(8) DEFAULT USER,
    HINS          TIME DEFAULT 'now',
    HALT          TIME DEFAULT 'now'
);

CREATE TABLE FNCONTA (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    NUMCONTA      CHAR(10) NOT NULL,
    DESCCONTA     CHAR(50) NOT NULL,
    CODEMPMA      INTEGER NOT NULL,
    CODFILIALMA   SMALLINT NOT NULL,
    CODMOEDA      CHAR(4) NOT NULL,
    CODEMPBO      INTEGER,
    CODFILIALBO   SMALLINT,
    CODBANCO      CHAR(3),
    CODEMPPN      INTEGER NOT NULL,
    CODFILIALPN   SMALLINT NOT NULL,
    CODPLAN       CHAR(13) NOT NULL,
    TIPOCONTA     CHAR(1) NOT NULL,
    DATACONTA     DATE NOT NULL,
    CODEMPHP      INTEGER,
    CODFILIALHP   SMALLINT,
    CODHIST       INTEGER,
    CODCONTDEB    VARCHAR(20),
    CODCONTCRED   VARCHAR(20),
    AGENCIACONTA  CHAR(6),
    CONVCOBCONTA  VARCHAR(10),
    DTINS         DATE DEFAULT 'now',
    IDUSUINS      CHAR(8) DEFAULT USER,
    DTALT         DATE DEFAULT 'now',
    IDUSUALT      CHAR(8) DEFAULT USER,
    HINS          TIME DEFAULT 'now',
    HALT          TIME DEFAULT 'now',
    ATIVACONTA    CHAR(1) DEFAULT 'S' NOT NULL,
    TUSUCONTA     CHAR(1) DEFAULT 'S' NOT NULL
);

CREATE TABLE FNCONTAUSU (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    NUMCONTA     CHAR(10) NOT NULL,
    CODEMPUS     INTEGER NOT NULL,
    CODFILIALUS  SMALLINT NOT NULL,
    IDUSU        CHAR(8) NOT NULL
);

CREATE TABLE FNCOTMOEDA (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    CODMOEDA   CHAR(4) NOT NULL,
    DATACOT    DATE NOT NULL,
    VALORCOT   NUMERICDN NOT NULL,
    DTINS      DATE DEFAULT 'now',
    IDUSUINS   CHAR(8) DEFAULT USER,
    DTALT      DATE DEFAULT 'now',
    IDUSUALT   CHAR(8) DEFAULT USER,
    HINS       TIME DEFAULT 'now',
    HALT       TIME DEFAULT 'now'
);

CREATE TABLE FNFBNCLI (
    CODEMP         INTEGER NOT NULL,
    CODFILIAL      SMALLINT NOT NULL,
    CODCLI         INTEGER NOT NULL,
    CODEMPPF       INTEGER NOT NULL,
    CODFILIALPF    SMALLINT NOT NULL,
    CODEMPBO       INTEGER NOT NULL,
    CODFILIALBO    SMALLINT NOT NULL,
    CODBANCO       CHAR(3) NOT NULL,
    TIPOFEBRABAN   CHAR(2) NOT NULL,
    NUMCONTACLI    CHAR(10),
    AGENCIACLI     VARCHAR(9),
    IDENTCLI       VARCHAR(14) NOT NULL,
    STIPOFEBRABAN  CHAR(2) DEFAULT '02' NOT NULL,
    TIPOREMCLI     CHAR(1) DEFAULT 'B' NOT NULL,
    CODEMPCA       INTEGER,
    CODFILIALCA    SMALLINT,
    NUMCONTA       CHAR(10),
    CODEMPPN       INTEGER,
    CODFILIALPN    SMALLINT,
    CODPLAN        CHAR(13)
);

CREATE TABLE FNFBNCODRET (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    CODEMPBO      INTEGER NOT NULL,
    CODFILIALBO   SMALLINT NOT NULL,
    CODBANCO      CHAR(3) NOT NULL,
    TIPOFEBRABAN  CHAR(2) NOT NULL,
    CODRET        VARCHAR(4) NOT NULL,
    DESCRET       VARCHAR(50) NOT NULL,
    DTINS         DATE DEFAULT 'now' NOT NULL,
    HINS          TIME DEFAULT 'now' NOT NULL,
    IDUSUINS      CHAR(8) DEFAULT USER NOT NULL,
    DTALT         DATE DEFAULT 'now' NOT NULL,
    HALT          TIME DEFAULT 'now' NOT NULL,
    IDUSUALT      CHAR(8) DEFAULT USER NOT NULL
);

CREATE TABLE FNFBNREC (
    CODEMP         INTEGER NOT NULL,
    CODFILIAL      SMALLINT NOT NULL,
    CODREC         INTEGER NOT NULL,
    NPARCITREC     INTEGER NOT NULL,
    CODEMPPF       INTEGER NOT NULL,
    CODFILIALPF    SMALLINT NOT NULL,
    CODEMPBO       INTEGER NOT NULL,
    CODFILIALBO    SMALLINT NOT NULL,
    CODBANCO       CHAR(3) NOT NULL,
    TIPOFEBRABAN   CHAR(2) NOT NULL,
    STIPOFEBRABAN  CHAR(2) NOT NULL,
    SITREMESSA     CHAR(2) DEFAULT '00' NOT NULL,
    SITRETORNO     CHAR(2) DEFAULT '00' NOT NULL
);

CREATE TABLE FNHISTPAD (
    CODEMP      INTEGER NOT NULL,
    CODFILIAL   SMALLINT NOT NULL,
    CODHIST     INTEGER NOT NULL,
    DESCHIST    VARCHAR(80) NOT NULL,
    TXAHISTPAD  VARCHAR(500) DEFAULT '' NOT NULL,
    DTINS       DATE DEFAULT 'now' NOT NULL,
    IDUSUINS    CHAR(8) DEFAULT USER NOT NULL,
    DTALT       DATE DEFAULT 'now' NOT NULL,
    IDUSUALT    CHAR(8) DEFAULT USER NOT NULL,
    HINS        TIME DEFAULT 'now' NOT NULL,
    HALT        TIME DEFAULT 'now' NOT NULL
);

CREATE TABLE FNITMODBOLETO (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODMODBOL    INTEGER NOT NULL,
    CODEMPBO     INTEGER NOT NULL,
    CODFILIALBO  SMALLINT NOT NULL,
    CODBANCO     CHAR(3) NOT NULL,
    CODEMPCB     INTEGER NOT NULL,
    CODFILIALCB  SMALLINT NOT NULL,
    CODCARTCOB   CHAR(2) NOT NULL,
    CONVCOB      VARCHAR(10) DEFAULT ' ' NOT NULL
);

CREATE TABLE FNITPAGAR (
    CODEMP         INTEGER NOT NULL,
    CODFILIAL      SMALLINT NOT NULL,
    CODPAG         INTEGER NOT NULL,
    NPARCPAG       INTEGER NOT NULL,
    VLRITPAG       NUMERICDN NOT NULL,
    VLRDESCITPAG   NUMERICDN,
    VLRMULTAITPAG  NUMERICDN,
    VLRJUROSITPAG  NUMERICDN,
    VLRDEVITPAG    NUMERICDN DEFAULT 0 NOT NULL,
    VLRPARCITPAG   NUMERICDN NOT NULL,
    VLRPAGOITPAG   NUMERICDN,
    VLRAPAGITPAG   NUMERICDN,
    DTITPAG        DATE NOT NULL,
    DTVENCITPAG    DATE NOT NULL,
    DTPAGOITPAG    DATE,
    STATUSITPAG    CHAR(2) NOT NULL,
    CODEMPCA       INTEGER,
    CODFILIALCA    SMALLINT,
    NUMCONTA       CHAR(10),
    CODEMPPN       INTEGER,
    CODFILIALPN    SMALLINT,
    CODPLAN        CHAR(13),
    DOCLANCAITPAG  CHAR(10),
    OBSITPAG       VARCHAR(250),
    VLRADICITPAG   NUMERICDN DEFAULT 0,
    FLAG           CHAR(1) DEFAULT 'N',
    CODEMPCC       INTEGER,
    CODFILIALCC    SMALLINT,
    ANOCC          SMALLINT,
    CODCC          CHAR(19),
    CODEMPTC       INTEGER,
    CODFILIALTC    SMALLINT,
    CODTIPOCOB     INTEGER,
    DTINS          DATE DEFAULT 'now',
    IDUSUINS       CHAR(8) DEFAULT USER,
    DTALT          DATE DEFAULT 'now',
    IDUSUALT       CHAR(8) DEFAULT USER,
    HINS           TIME DEFAULT 'now',
    HALT           TIME DEFAULT 'now'
);

CREATE TABLE FNITRECEBER (
    CODEMP          INTEGER NOT NULL,
    CODFILIAL       SMALLINT NOT NULL,
    CODREC          INTEGER NOT NULL,
    NPARCITREC      INTEGER NOT NULL,
    VLRITREC        NUMERICDN NOT NULL,
    VLRDESCITREC    NUMERICDN,
    VLRMULTAITREC   NUMERICDN,
    VLRJUROSITREC   NUMERICDN,
    VLRDEVITREC     NUMERICDN DEFAULT 0 NOT NULL,
    VLRPARCITREC    NUMERICDN,
    VLRPAGOITREC    NUMERICDN,
    VLRAPAGITREC    NUMERICDN,
    DESCPONT        CHAR(1) DEFAULT 'N' NOT NULL,
    DTITREC         DATE NOT NULL,
    DTVENCITREC     DATE NOT NULL,
    DTPAGOITREC     DATE,
    STATUSITREC     CHAR(2) NOT NULL,
    CODEMPPN        INTEGER,
    CODFILIALPN     SMALLINT,
    CODPLAN         CHAR(13),
    OBSITREC        VARCHAR(250),
    CODEMPCA        INTEGER,
    CODFILIALCA     SMALLINT,
    NUMCONTA        CHAR(10),
    CODEMPBO        INTEGER,
    CODFILIALBO     SMALLINT,
    CODBANCO        CHAR(3),
    CODEMPTC        INTEGER,
    CODFILIALTC     SMALLINT,
    CODTIPOCOB      INTEGER,
    CODEMPCB        INTEGER,
    CODFILIALCB     SMALLINT,
    CODCARTCOB      CHAR(2),
    DOCLANCAITREC   CHAR(10),
    FLAG            CHAR(1) DEFAULT 'N',
    CODEMPCC        INTEGER,
    CODFILIALCC     SMALLINT,
    ANOCC           SMALLINT,
    CODCC           CHAR(19),
    VLRCOMIITREC    NUMERICDN DEFAULT 0,
    IMPRECIBOITREC  CHAR(1) DEFAULT 'N' NOT NULL,
    RECIBOITREC     INTEGER,
    ALTUSUITREC     CHAR(1) DEFAULT 'S' NOT NULL,
    PDVITREC        CHAR(1) DEFAULT 'N' NOT NULL,
    DTINS           DATE DEFAULT 'now',
    IDUSUINS        CHAR(8) DEFAULT USER,
    DTALT           DATE DEFAULT 'now',
    IDUSUALT        CHAR(8) DEFAULT USER,
    HINS            TIME DEFAULT 'now',
    HALT            TIME DEFAULT 'now'
);

CREATE TABLE FNITTBJUROS (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    CODTBJ     INTEGER NOT NULL,
    ANOITTBJ   SMALLINT NOT NULL,
    MESITTBJ   SMALLINT NOT NULL,
    PERCITTBJ  NUMERIC(7,3) DEFAULT 0 NOT NULL,
    DTINS      DATE DEFAULT 'now',
    IDUSUINS   CHAR(8) DEFAULT USER,
    DTALT      DATE DEFAULT 'now',
    IDUSUALT   CHAR(8) DEFAULT USER,
    HINS       TIME DEFAULT 'now',
    HALT       TIME DEFAULT 'now'
);

CREATE TABLE FNLANCA (
    CODEMP          INTEGER NOT NULL,
    CODFILIAL       SMALLINT NOT NULL,
    CODLANCA        INTEGER NOT NULL,
    CODCOMI         INTEGER,
    CODEMPPG        INTEGER,
    CODFILIALPG     SMALLINT,
    CODPAG          INTEGER,
    NPARCPAG        INTEGER,
    CODEMPRC        INTEGER,
    CODFILIALRC     SMALLINT,
    CODREC          INTEGER,
    NPARCITREC      INTEGER,
    CODEMPPN        INTEGER NOT NULL,
    CODFILIALPN     SMALLINT NOT NULL,
    CODPLAN         CHAR(13) NOT NULL,
    DATALANCA       DATE NOT NULL,
    DOCLANCA        CHAR(15),
    HISTBLANCA      VARCHAR(100) NOT NULL,
    HISTLANCA       VARCHAR(10000),
    TRANSFLANCA     CHAR(1) DEFAULT 'N',
    STATUSLANCA     CHAR(2),
    DTPREVLANCA     DATE,
    DTPREVSUBLANCA  DATE,
    VLRLANCA        NUMERICDN DEFAULT 0,
    CODEMPCI        INTEGER,
    CODFILIALCI     SMALLINT,
    CODPCOMI        INTEGER,
    FLAG            CHAR(1) DEFAULT 'N',
    TIPOLANCA       CHAR(1) DEFAULT 'A' NOT NULL,
    PDVITREC        CHAR(1) DEFAULT 'N' NOT NULL,
    CODCLI          INTEGER,
    CODEMPCL        INTEGER,
    CODFILIALCL     SMALLINT,
    CODEMPFR        INTEGER,
    CODFILIALFR     SMALLINT,
    CODFOR          INTEGER,
    DTINS           DATE DEFAULT 'now',
    IDUSUINS        CHAR(8) DEFAULT USER,
    DTALT           DATE DEFAULT 'now',
    IDUSUALT        CHAR(8) DEFAULT USER,
    HINS            TIME DEFAULT 'now',
    HALT            TIME DEFAULT 'now'
);

CREATE TABLE FNLIBCRED (
    CODEMP           INTEGER NOT NULL,
    CODFILIAL        SMALLINT NOT NULL,
    CODLCRED         INTEGER NOT NULL,
    TIPOVENDA        CHAR(1) NOT NULL,
    CODEMPVD         INTEGER NOT NULL,
    CODFILIALVD      SMALLINT NOT NULL,
    CODVENDA         INTEGER NOT NULL,
    DTAEMITLCRED     DATE DEFAULT 'now' NOT NULL,
    VLRAUTORIZLCRED  NUMERICDN DEFAULT 0 NOT NULL,
    VLRUTILLCRED     NUMERICDN DEFAULT 0 NOT NULL,
    VLRVENDACRED     NUMERICDN,
    CODEMPUS         INTEGER,
    CODFILIALUS      SMALLINT,
    IDUSU            CHAR(8),
    DTAUTILLCRED     DATE,
    SITLCRED         CHAR(1) DEFAULT 'L' NOT NULL,
    CODEMPCL         INTEGER NOT NULL,
    CODFILIALCL      SMALLINT NOT NULL,
    CODCLI           INTEGER NOT NULL,
    DTAVCTOLCRED     DATE DEFAULT 'today' NOT NULL,
    DTINS            DATE DEFAULT 'now',
    IDUSUINS         CHAR(8) DEFAULT USER,
    DTALT            DATE DEFAULT 'now',
    IDUSUALT         CHAR(8) DEFAULT USER,
    HINS             TIME DEFAULT 'now',
    HALT             TIME DEFAULT 'now'
);

CREATE TABLE FNMODBOLETO (
    CODEMP         INTEGER NOT NULL,
    CODFILIAL      INTEGER NOT NULL,
    CODMODBOL      INTEGER NOT NULL,
    DESCMODBOL     CHAR(30) NOT NULL,
    TXAMODBOL      VARCHAR(10000) DEFAULT ' ' NOT NULL,
    PREIMPMODBOL   CHAR(1) DEFAULT 'S' NOT NULL,
    CARTCOB        CHAR(2) DEFAULT '' NOT NULL,
    MDECOB         CHAR(2) DEFAULT '21' NOT NULL,
    ACEITEMODBOL   CHAR(1) DEFAULT 'N' NOT NULL,
    CLASSMODBOL    VARCHAR(80),
    ESPDOCMODBOL   CHAR(3),
    DESCLPMODBOL   VARCHAR(80),
    INSTPAGMODBOL  VARCHAR(500),
    CODEMPCC       INTEGER,
    CODFILIALCC    SMALLINT,
    NUMCONTA       CHAR(10),
    IMPINFOPARC    CHAR(1) DEFAULT 'N' NOT NULL,
    DTINS          DATE DEFAULT 'now',
    IDUSUINS       CHAR(8) DEFAULT USER,
    DTALT          DATE DEFAULT 'now',
    IDUSUALT       CHAR(8) DEFAULT USER,
    HINS           TIME DEFAULT 'now',
    HALT           TIME DEFAULT 'now'
);

CREATE TABLE FNMOEDA (
    CODEMP         INTEGER NOT NULL,
    CODFILIAL      SMALLINT NOT NULL,
    CODMOEDA       CHAR(4) NOT NULL,
    TIPOMOEDA      CHAR(1) NOT NULL,
    ATUALIZAMOEDA  CHAR(1) NOT NULL,
    SINGMOEDA      CHAR(20) NOT NULL,
    PLURMOEDA      CHAR(20) NOT NULL,
    CODFBNMOEDA    CHAR(1) DEFAULT '9' NOT NULL,
    DECSMOEDA      CHAR(20),
    DECPMOEDA      CHAR(20),
    DTINS          DATE DEFAULT 'now',
    IDUSUINS       CHAR(8) DEFAULT USER,
    DTALT          DATE DEFAULT 'now',
    IDUSUALT       CHAR(8) DEFAULT USER,
    HINS           TIME DEFAULT 'now',
    HALT           TIME DEFAULT 'now'
);

CREATE TABLE FNPAGAR (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODPAG       INTEGER NOT NULL,
    CODEMPCP     INTEGER,
    CODFILIALCP  SMALLINT,
    CODCOMPRA    INTEGER,
    CODEMPPG     INTEGER NOT NULL,
    CODFILIALPG  SMALLINT NOT NULL,
    CODPLANOPAG  INTEGER NOT NULL,
    CODEMPFR     INTEGER NOT NULL,
    CODFILIALFR  SMALLINT NOT NULL,
    CODFOR       INTEGER NOT NULL,
    CODEMPBO     INTEGER,
    CODFILIALBO  SMALLINT,
    CODBANCO     CHAR(3),
    VLRDESCPAG   NUMERICDN,
    VLRMULTAPAG  NUMERICDN,
    VLRJUROSPAG  NUMERICDN,
    VLRDEVPAG    NUMERICDN DEFAULT 0 NOT NULL,
    VLRPARCPAG   NUMERICDN NOT NULL,
    VLRPAGOPAG   NUMERICDN,
    VLRAPAGPAG   NUMERICDN,
    DATAPAG      DATE,
    STATUSPAG    CHAR(2) NOT NULL,
    DTQUITPAG    DATE,
    DOCPAG       INTEGER NOT NULL,
    VLRPAG       NUMERICDN DEFAULT 0,
    NROPARCPAG   INTEGER DEFAULT 0,
    OBSPAG       CHAR(50),
    VLRADICPAG   NUMERICDN DEFAULT 0,
    FLAG         CHAR(1) DEFAULT 'N',
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now',
    CODEMPTC     INTEGER,
    CODFILIALTC  SMALLINT,
    CODTIPOCOB   INTEGER
);

CREATE TABLE FNPAGTOCOMI (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODPCOMI     INTEGER NOT NULL,
    CODEMPPN     INTEGER NOT NULL,
    CODFILIALPN  SMALLINT NOT NULL,
    CODPLAN      CHAR(13) NOT NULL,
    CODEMPCA     INTEGER NOT NULL,
    CODFILIALCA  SMALLINT NOT NULL,
    NUMCONTA     CHAR(10) NOT NULL,
    VLRPCOMI     NUMERICDN DEFAULT 0,
    DOCPCOMI     INTEGER NOT NULL,
    OBSPCOMI     VARCHAR(300),
    DATAPCOMI    DATE NOT NULL,
    FLAG         CHAR(1) DEFAULT 'N',
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now'
);

CREATE TABLE FNPARCPAG (
    CODEMP         INTEGER NOT NULL,
    CODFILIAL      SMALLINT NOT NULL,
    CODPLANOPAG    INTEGER NOT NULL,
    NROPARCPAG     INTEGER NOT NULL,
    PERCPAG        NUMERIC(9,5),
    DIASPAG        INTEGER,
    DESCPARCPAG    CHAR(30),
    AUTOBAIXAPARC  CHAR(1) DEFAULT 'N' NOT NULL,
    DTINS          DATE DEFAULT 'now',
    IDUSUINS       CHAR(8) DEFAULT USER,
    DTALT          DATE DEFAULT 'now',
    IDUSUALT       CHAR(8) DEFAULT USER,
    HINS           TIME DEFAULT 'now',
    HALT           TIME DEFAULT 'now'
);

CREATE TABLE FNPLANEJAMENTO (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODPLAN      CHAR(13) NOT NULL,
    DESCPLAN     CHAR(50) NOT NULL,
    NIVELPLAN    INTEGER NOT NULL,
    CODREDPLAN   INTEGER,
    CODEMPSP     INTEGER,
    CODFILIALSP  SMALLINT,
    CODSUBPLAN   CHAR(13),
    TIPOPLAN     CHAR(1) NOT NULL,
    FINPLAN      CHAR(2),
    CODEMPHP     INTEGER,
    CODFILIALHP  SMALLINT,
    CODHIST      INTEGER,
    CODCONTCRED  VARCHAR(20),
    CODCONTDEB   VARCHAR(20),
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now'
);

CREATE TABLE FNPLANOPAG (
    CODEMP             INTEGER NOT NULL,
    CODFILIAL          SMALLINT NOT NULL,
    CODPLANOPAG        INTEGER NOT NULL,
    DESCPLANOPAG       CHAR(40),
    PARCPLANOPAG       INTEGER NOT NULL,
    APORCPLANOPAG      CHAR(1) DEFAULT 'N' NOT NULL,
    AUTOBAIXAPLANOPAG  CHAR(1) DEFAULT 'N',
    CODEMPCA           INTEGER,
    CODFILIALCA        SMALLINT,
    NUMCONTA           CHAR(10),
    CODEMPPN           INTEGER,
    CODFILIALPN        SMALLINT,
    CODPLAN            CHAR(13),
    CODEMPCC           INTEGER,
    CODFILIALCC        SMALLINT,
    ANOCC              SMALLINT,
    CODCC              CHAR(19),
    DTINS              DATE DEFAULT 'now',
    IDUSUINS           CHAR(8) DEFAULT USER,
    DTALT              DATE DEFAULT 'now',
    IDUSUALT           CHAR(8) DEFAULT USER,
    HINS               TIME DEFAULT 'now',
    HALT               TIME DEFAULT 'now',
    ATIVOPLANOPAG      CHAR(1) DEFAULT 'S' NOT NULL,
    CVPLANOPAG         CHAR(1) DEFAULT 'A' NOT NULL,
    CODEMPTBJ          INTEGER,
    CODFILIALTBJ       SMALLINT,
    CODTBJ             INTEGER,
    PERCDESC           NUMERIC(9,2),
    REGRVCTOPLANOPAG   CHAR(1) DEFAULT 'N' NOT NULL,
    RVSABPLANOPAG      CHAR(1) DEFAULT 'N' NOT NULL,
    RVDOMPLANOPAG      CHAR(1) DEFAULT 'N' NOT NULL,
    RVFERPLANOPAG      CHAR(1) DEFAULT 'N' NOT NULL,
    RVDIAPLANOPAG      CHAR(1) DEFAULT 'A' NOT NULL,
    DIAVCTOPLANOPAG    SMALLINT DEFAULT 0 NOT NULL
);

CREATE TABLE FNRECEBER (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODREC       INTEGER NOT NULL,
    CODEMPBO     INTEGER,
    CODFILIALBO  SMALLINT,
    CODBANCO     CHAR(3),
    CODEMPPG     INTEGER NOT NULL,
    CODFILIALPG  SMALLINT NOT NULL,
    CODPLANOPAG  INTEGER NOT NULL,
    CODEMPCL     INTEGER NOT NULL,
    CODFILIALCL  SMALLINT NOT NULL,
    CODCLI       INTEGER NOT NULL,
    CODEMPVD     INTEGER,
    CODFILIALVD  SMALLINT,
    CODVEND      INTEGER,
    CODEMPVA     INTEGER,
    CODFILIALVA  SMALLINT,
    TIPOVENDA    CHAR(1),
    CODVENDA     INTEGER,
    CODEMPTC     INTEGER,
    CODFILIALTC  SMALLINT,
    CODTIPOCOB   INTEGER,
    CODEMPCB     INTEGER,
    CODFILIALCB  SMALLINT,
    CODCARTCOB   CHAR(2),
    VLRREC       NUMERICDN NOT NULL,
    VLRDESCREC   NUMERICDN,
    VLRMULTAREC  NUMERICDN,
    VLRJUROSREC  NUMERICDN,
    VLRDEVREC    NUMERICDN DEFAULT 0 NOT NULL,
    VLRPARCREC   NUMERICDN NOT NULL,
    VLRPAGOREC   NUMERICDN,
    VLRAPAGREC   NUMERICDN,
    DATAREC      DATE NOT NULL,
    STATUSREC    CHAR(2) NOT NULL,
    VLRCOMIREC   NUMERICDN,
    DTQUITREC    DATE,
    DOCREC       INTEGER NOT NULL,
    NROPARCREC   INTEGER DEFAULT 0,
    OBSREC       VARCHAR(250),
    FLAG         CHAR(1) DEFAULT 'N',
    ALTUSUREC    CHAR(1) DEFAULT 'N',
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now'
);

CREATE TABLE FNRESTRICAO (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODCLI       INTEGER NOT NULL,
    SEQRESTR     SMALLINT NOT NULL,
    CODEMPTR     INTEGER NOT NULL,
    CODFILIALTR  SMALLINT NOT NULL,
    CODTPRESTR   INTEGER NOT NULL,
    SITRESTR     CHAR(1) DEFAULT 'I' NOT NULL,
    DTRESTR      DATE NOT NULL,
    OBSRESTR     VARCHAR(512),
    DTCANCRESTR  DATE,
    DTINS        DATE DEFAULT 'now' NOT NULL,
    IDUSUINS     VARCHAR(128) DEFAULT USER NOT NULL,
    DTALT        DATE DEFAULT 'now' NOT NULL,
    IDUSUALT     VARCHAR(128) DEFAULT USER NOT NULL,
    HINS         TIME DEFAULT 'now' NOT NULL,
    HALT         TIME DEFAULT 'now' NOT NULL
);

CREATE TABLE FNSALDOLANCA (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODEMPPN     INTEGER NOT NULL,
    CODFILIALPN  INTEGER NOT NULL,
    CODPLAN      CHAR(13) NOT NULL,
    DATASL       DATE NOT NULL,
    PREVSL       NUMERICDN,
    SALDOSL      NUMERICDN NOT NULL,
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now'
);

CREATE TABLE FNSUBLANCA (
    CODEMP          INTEGER NOT NULL,
    CODFILIAL       SMALLINT NOT NULL,
    CODLANCA        INTEGER NOT NULL,
    CODSUBLANCA     INTEGER NOT NULL,
    CODEMPPN        INTEGER NOT NULL,
    CODFILIALPN     SMALLINT NOT NULL,
    CODPLAN         CHAR(13) NOT NULL,
    STATUSSUBLANCA  CHAR(2) NOT NULL,
    ORIGSUBLANCA    CHAR(1),
    DTPREVSUBLANCA  DATE,
    DATASUBLANCA    DATE,
    VLRSUBLANCA     NUMERICDN DEFAULT 0,
    FLAG            CHAR(1) DEFAULT 'N',
    CODEMPCC        INTEGER,
    CODFILIALCC     SMALLINT,
    ANOCC           SMALLINT,
    CODCC           CHAR(19),
    CODEMPCL        INTEGER,
    CODFILIALCL     SMALLINT,
    CODCLI          INTEGER,
    CODEMPFR        INTEGER,
    CODFILIALFR     SMALLINT,
    CODFOR          INTEGER,
    HISTSUBLANCA    VARCHAR(100),
    DTINS           DATE DEFAULT 'now',
    IDUSUINS        CHAR(8) DEFAULT USER,
    DTALT           DATE DEFAULT 'now',
    IDUSUALT        CHAR(8) DEFAULT USER,
    HINS            TIME DEFAULT 'now',
    HALT            TIME DEFAULT 'now'
);

CREATE TABLE FNTBJUROS (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    CODTBJ     INTEGER NOT NULL,
    DESCTBJ    CHAR(50) NOT NULL,
    TIPOTBJ    CHAR(1) NOT NULL,
    DTINS      DATE DEFAULT 'now',
    IDUSUINS   CHAR(8) DEFAULT USER,
    DTALT      DATE DEFAULT 'now',
    IDUSUALT   CHAR(8) DEFAULT USER,
    HINS       TIME DEFAULT 'now',
    HALT       TIME DEFAULT 'now'
);

CREATE TABLE FNTIPOCOB (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    CODTIPOCOB    INTEGER NOT NULL,
    DESCTIPOCOB   CHAR(40) NOT NULL,
    TIPOFEBRABAN  CHAR(2) DEFAULT '00' NOT NULL,
    DUPLCOB       CHAR(8),
    OBRIGCARTCOB  CHAR(1) DEFAULT 'N' NOT NULL,
    DTINS         DATE DEFAULT 'now',
    IDUSUINS      CHAR(8) DEFAULT USER,
    DTALT         DATE DEFAULT 'now',
    IDUSUALT      CHAR(8) DEFAULT USER,
    HINS          TIME DEFAULT 'now',
    HALT          TIME DEFAULT 'now'
);

CREATE TABLE FNTIPOCRED (
    CODEMP      INTEGER NOT NULL,
    CODFILIAL   SMALLINT NOT NULL,
    CODTPCRED   INTEGER NOT NULL,
    DESCTPCRED  CHAR(50) NOT NULL,
    VLRTPCRED   NUMERICDN NOT NULL,
    DTINS       DATE DEFAULT 'now',
    IDUSUINS    CHAR(8) DEFAULT USER,
    DTALT       DATE DEFAULT 'now',
    IDUSUALT    CHAR(8) DEFAULT USER,
    HINS        TIME DEFAULT 'now',
    HALT        TIME DEFAULT 'now'
);

CREATE TABLE FNTIPORESTR (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODTPRESTR   INTEGER NOT NULL,
    DESCTPRESTR  CHAR(50) NOT NULL,
    BLOQTPRESTR  CHAR(1) DEFAULT 'N' NOT NULL,
    DTINS        DATE DEFAULT 'now' NOT NULL,
    IDUSUINS     VARCHAR(128) DEFAULT USER NOT NULL,
    DTALT        DATE DEFAULT 'now' NOT NULL,
    IDUSUALT     VARCHAR(128) DEFAULT USER NOT NULL,
    HINS         TIME DEFAULT 'now' NOT NULL,
    HALT         TIME DEFAULT 'now' NOT NULL
);

CREATE TABLE LFCLFISCAL (
    CODEMP         INTEGER NOT NULL,
    CODFILIAL      SMALLINT NOT NULL,
    CODFISC        CHAR(13) NOT NULL,
    DESCFISC       CHAR(50) NOT NULL,
    TIPOFISC       CHAR(2) NOT NULL,
    TPREDICMSFISC  CHAR(1) DEFAULT 'B' NOT NULL,
    ALIQFISC       NUMERIC(6,2),
    ALIQLFISC      NUMERIC(6,2),
    REDFISC        NUMERIC(6,2),
    ALIQIPIFISC    NUMERIC(6,2),
    CODEMPRA       INTEGER NOT NULL,
    CODFILIALRA    SMALLINT NOT NULL,
    CODREGRA       CHAR(4) NOT NULL,
    ORIGFISC       CHAR(1),
    CODEMPTT       INTEGER,
    CODFILIALTT    SMALLINT,
    CODTRATTRIB    CHAR(2),
    CODEMPME       INTEGER,
    CODFILIALME    SMALLINT,
    CODMENS        INTEGER,
    SITPISFISC     CHAR(1) DEFAULT 'T',
    SITCOFINSFISC  CHAR(1) DEFAULT 'T',
    DTINS          DATE DEFAULT 'now',
    IDUSUINS       CHAR(8) DEFAULT USER,
    DTALT          DATE DEFAULT 'now',
    IDUSUALT       CHAR(8) DEFAULT USER,
    HINS           TIME DEFAULT 'now',
    HALT           TIME DEFAULT 'now'
);

CREATE TABLE LFITCLFISCAL (
    CODEMP         INTEGER NOT NULL,
    CODFILIAL      INTEGER NOT NULL,
    CODFISC        CHAR(13) NOT NULL,
    CODITFISC      INTEGER NOT NULL,
    ORIGFISC       CHAR(1) NOT NULL,
    CODEMPTT       INTEGER NOT NULL,
    CODFILIALTT    INTEGER NOT NULL,
    TIPOFISC       CHAR(2) NOT NULL,
    TPREDICMSFISC  CHAR(1) DEFAULT 'B' NOT NULL,
    REDFISC        NUMERIC(9,2),
    CODTRATTRIB    CHAR(2) NOT NULL,
    NOUFITFISC     CHAR(1) CHARACTER SET WIN1252 DEFAULT 'N' NOT NULL,
    CODEMPFC       INTEGER,
    CODFILIALFC    INTEGER,
    CODFISCCLI     INTEGER,
    ALIQFISC       NUMERIC(9,2),
    ALIQLFISC      NUMERIC(9,2),
    ALIQIPIFISC    NUMERIC(6,2) DEFAULT 0 NOT NULL,
    CODEMPME       INTEGER,
    CODFILIALME    SMALLINT,
    CODMENS        INTEGER,
    CODEMPTM       INTEGER,
    CODFILIALTM    SMALLINT,
    CODTIPOMOV     INTEGER,
    DTINS          DATE DEFAULT 'now',
    IDUSUINS       CHAR(8) DEFAULT USER,
    DTALT          DATE DEFAULT 'now',
    IDUSUALT       CHAR(8) DEFAULT USER,
    HINS           TIME DEFAULT 'now',
    HALT           TIME DEFAULT 'now'
);

CREATE TABLE LFITNATOPER (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     INTEGER NOT NULL,
    CODNAT        CHAR(4) NOT NULL,
    CODITNATOPER  INTEGER NOT NULL,
    CODEMPTI      INTEGER NOT NULL,
    CODFILIALTI   INTEGER NOT NULL,
    UFTI          CHAR(2) NOT NULL,
    DTINS         DATE DEFAULT 'now',
    IDUSUINS      CHAR(8) DEFAULT USER,
    DTALT         DATE DEFAULT 'now',
    IDUSUALT      CHAR(8) DEFAULT USER,
    HINS          TIME DEFAULT 'now',
    HALT          TIME DEFAULT 'now'
);

CREATE TABLE LFITREGRAFISCAL (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODREGRA     CHAR(4) NOT NULL,
    CODNAT       CHAR(4) NOT NULL,
    NOUFITRF     CHAR(1) NOT NULL,
    CVITRF       CHAR(1) NOT NULL,
    CODEMPTM     INTEGER,
    CODFILIALTM  SMALLINT,
    CODTIPOMOV   INTEGER,
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now'
);

CREATE TABLE LFLIVROFISCAL (
    CODEMP            INTEGER NOT NULL,
    CODFILIAL         SMALLINT NOT NULL,
    TIPOLF            CHAR(1) NOT NULL,
    ANOMESLF          CHAR(6) NOT NULL,
    CODLF             INTEGER NOT NULL,
    CODEMPET          INTEGER NOT NULL,
    CODFILIALET       SMALLINT NOT NULL,
    CODEMITLF         INTEGER NOT NULL,
    SERIELF           CHAR(4) NOT NULL,
    DOCINILF          INTEGER NOT NULL,
    DTEMITLF          DATE NOT NULL,
    DTESLF            DATE NOT NULL,
    CODEMPNT          INTEGER,
    CODFILIALNT       SMALLINT,
    CODNAT            CHAR(4),
    DOCFIMLF          INTEGER NOT NULL,
    ESPECIELF         CHAR(3) NOT NULL,
    UFLF              CHAR(2) NOT NULL,
    VLRCONTABILLF     NUMERICDN DEFAULT 0,
    VLRBASEICMSLF     NUMERICDN DEFAULT 0,
    ALIQICMSLF        NUMERIC(7,3) DEFAULT 0,
    VLRICMSLF         NUMERICDN DEFAULT 0,
    VLRISENTASICMSLF  NUMERICDN DEFAULT 0,
    VLROUTRASICMSLF   NUMERICDN DEFAULT 0,
    VLRBASEIPILF      NUMERICDN DEFAULT 0,
    ALIQIPILF         NUMERIC(7,3) DEFAULT 0,
    VLRIPILF          NUMERICDN DEFAULT 0,
    VLRISENTASIPILF   NUMERICDN DEFAULT 0,
    VLROUTRASIPILF    NUMERICDN DEFAULT 0,
    OBSLF             CHAR(30),
    CODEMPMN          INTEGER,
    CODFILIALMN       SMALLINT,
    CODMODNOTA        INTEGER,
    DTINS             DATE DEFAULT 'now',
    IDUSUINS          CHAR(8) DEFAULT USER,
    DTALT             DATE DEFAULT 'now',
    IDUSUALT          CHAR(8) DEFAULT USER,
    HINS              TIME DEFAULT 'now',
    HALT              TIME DEFAULT 'now'
);

CREATE TABLE LFMENSAGEM (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    CODMENS    INTEGER NOT NULL,
    MENS       VARCHAR(10000) NOT NULL,
    DTINS      DATE DEFAULT 'now',
    IDUSUINS   CHAR(8) DEFAULT USER,
    DTALT      DATE DEFAULT 'now',
    IDUSUALT   CHAR(8) DEFAULT USER,
    HINS       TIME DEFAULT 'now',
    HALT       TIME DEFAULT 'now'
);

CREATE TABLE LFMODNOTA (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODMODNOTA   INTEGER NOT NULL,
    DESCMODNOTA  CHAR(30) NOT NULL,
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now'
);

CREATE TABLE LFNATOPER (
    CODEMP         INTEGER NOT NULL,
    CODFILIAL      SMALLINT NOT NULL,
    CODNAT         CHAR(4) NOT NULL,
    DESCNAT        CHAR(60) NOT NULL,
    IMPDTSAIDANAT  CHAR(1) DEFAULT 'S' NOT NULL,
    ALIQENAT       NUMERIC(6,2) DEFAULT 0 NOT NULL,
    ALIQFNAT       NUMERIC(6,2) DEFAULT 0 NOT NULL,
    TXTNAT         VARCHAR(500),
    DTINS          DATE DEFAULT 'now',
    IDUSUINS       CHAR(8) DEFAULT USER,
    DTALT          DATE DEFAULT 'now',
    IDUSUALT       CHAR(8) DEFAULT USER,
    HINS           TIME DEFAULT 'now',
    HALT           TIME DEFAULT 'now'
);

CREATE TABLE LFREGRAFISCAL (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    CODREGRA   CHAR(4) NOT NULL,
    DESCREGRA  CHAR(50),
    DTINS      DATE DEFAULT 'now',
    IDUSUINS   CHAR(8) DEFAULT USER,
    DTALT      DATE DEFAULT 'now',
    IDUSUALT   CHAR(8) DEFAULT USER,
    HINS       TIME DEFAULT 'now',
    HALT       TIME DEFAULT 'now'
);

CREATE TABLE LFSERIE (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    SERIE      CHAR(4) NOT NULL,
    DOCSERIE   INTEGER DEFAULT 1 NOT NULL,
    DTINS      DATE DEFAULT 'now',
    IDUSUINS   CHAR(8) DEFAULT USER,
    DTALT      DATE DEFAULT 'now',
    IDUSUALT   CHAR(8) DEFAULT USER,
    HINS       TIME DEFAULT 'now',
    HALT       TIME DEFAULT 'now'
);

CREATE TABLE LFTABICMS (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  INTEGER NOT NULL,
    UFTI       CHAR(2) NOT NULL,
    ALIQTI     NUMERIC(9,2) NOT NULL,
    DTINS      DATE DEFAULT 'now',
    IDUSUINS   CHAR(8) DEFAULT USER,
    DTALT      DATE DEFAULT 'now',
    IDUSUALT   CHAR(8) DEFAULT USER,
    HINS       TIME DEFAULT 'now',
    HALT       TIME DEFAULT 'now'
);

CREATE TABLE LFTIPOFISCCLI (
    CODEMP         INTEGER NOT NULL,
    CODFILIAL      INTEGER NOT NULL,
    CODFISCCLI     INTEGER NOT NULL,
    DESCFISCCLI    CHAR(40) NOT NULL,
    DTINS          DATE DEFAULT 'now',
    IDUSUINS       CHAR(8) DEFAULT USER,
    DTALT          DATE DEFAULT 'now',
    IDUSUALT       CHAR(8) DEFAULT USER,
    HINS           TIME DEFAULT 'now',
    HALT           TIME DEFAULT 'now',
    CALCCOFINSTF   CHAR(1) DEFAULT 'N' NOT NULL,
    CALCCSOCIALTF  CHAR(1) DEFAULT 'N' NOT NULL,
    CALCICMSTF     CHAR(1) DEFAULT 'N' NOT NULL,
    CALCIPITF      CHAR(1) DEFAULT 'N' NOT NULL,
    CALCIRTF       CHAR(1) DEFAULT 'N' NOT NULL,
    CALCISSTF      CHAR(1) DEFAULT 'N' NOT NULL,
    CALCPISTF      CHAR(1) DEFAULT 'N' NOT NULL,
    IMPCOFINSTF    CHAR(1) DEFAULT 'N' NOT NULL,
    IMPCSOCIALTF   CHAR(1) DEFAULT 'N' NOT NULL,
    IMPICMSTF      CHAR(1) DEFAULT 'N' NOT NULL,
    IMPISSTF       CHAR(1) DEFAULT 'N' NOT NULL,
    IMPIPITF       CHAR(1) DEFAULT  'N' NOT NULL,
    IMPIRTF        CHAR(1) DEFAULT 'N' NOT NULL,
    IMPPISTF       CHAR(1) DEFAULT 'N' NOT NULL
);

CREATE TABLE LFTRATTRIB (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    CODTRATTRIB   CHAR(2) NOT NULL,
    DESCTRATTRIB  CHAR(60) NOT NULL,
    DTINS         DATE DEFAULT 'now',
    IDUSUINS      CHAR(8) DEFAULT USER,
    DTALT         DATE DEFAULT 'now',
    IDUSUALT      CHAR(8) DEFAULT USER,
    HINS          TIME DEFAULT 'now',
    HALT          TIME DEFAULT 'now'
);

CREATE TABLE PPDISTRIB (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODPROD      INTEGER NOT NULL,
    SEQEST       SMALLINT NOT NULL,
    SEQEF        SMALLINT NOT NULL,
    CODEMPFS     INTEGER NOT NULL,
    CODFILIALFS  SMALLINT NOT NULL,
    CODFASE      INTEGER NOT NULL,
    SEQDE        SMALLINT NOT NULL,
    CODEMPDE     INTEGER NOT NULL,
    CODFILIALDE  SMALLINT NOT NULL,
    CODPRODDE    INTEGER NOT NULL,
    SEQESTDE     SMALLINT NOT NULL
);

CREATE TABLE PPESTRUANALISE (
    CODEMP         INTEGER NOT NULL,
    CODFILIAL      SMALLINT NOT NULL,
    CODESTANALISE  INTEGER NOT NULL,
    CODPROD        INTEGER NOT NULL,
    SEQEST         SMALLINT NOT NULL,
    SEQEF          SMALLINT NOT NULL,
    CODEMPFS       INTEGER NOT NULL,
    CODFILIALFS    SMALLINT NOT NULL,
    CODFASE        INTEGER NOT NULL,
    CODEMPTA       INTEGER NOT NULL,
    CODFILIALTA    SMALLINT NOT NULL,
    CODTPANALISE   SMALLINT NOT NULL,
    VLRMIN         NUMERIC(15,5),
    VLRMAX         NUMERIC(15,5),
    ESPECIFICACAO  CHAR(50),
    EMITCERT       CHAR(1) DEFAULT 'S' NOT NULL,
    DTINS          DATE DEFAULT 'now' NOT NULL,
    IDUSUINS       CHAR(8) DEFAULT USER NOT NULL,
    DTALT          DATE DEFAULT 'now' NOT NULL,
    IDUSUALT       CHAR(8) DEFAULT USER NOT NULL,
    HINS           TIME DEFAULT 'now' NOT NULL,
    HALT           TIME DEFAULT 'now' NOT NULL
);

CREATE TABLE PPESTRUFASE (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODPROD      INTEGER NOT NULL,
    SEQEST       SMALLINT DEFAULT 0 NOT NULL,
    SEQEF        SMALLINT NOT NULL,
    CODEMPFS     INTEGER NOT NULL,
    CODFILIALFS  SMALLINT NOT NULL,
    CODFASE      INTEGER NOT NULL,
    CODEMPTR     INTEGER NOT NULL,
    CODFILIALTR  SMALLINT NOT NULL,
    CODTPREC     INTEGER NOT NULL,
    TEMPOEF      NUMERICDN DEFAULT 0 NOT NULL,
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now',
    FINALIZAOP   CHAR(1) DEFAULT 'N' NOT NULL,
    INSTRUCOES   VARCHAR(5000)
);

CREATE TABLE PPESTRUTURA (
    CODEMP          INTEGER NOT NULL,
    CODFILIAL       SMALLINT NOT NULL,
    CODPROD         INTEGER NOT NULL,
    SEQEST          SMALLINT DEFAULT 0 NOT NULL,
    DESCEST         CHAR(50) NOT NULL,
    QTDEST          NUMERICDN NOT NULL,
    REFPROD         CHAR(13) NOT NULL,
    ATIVOEST        CHAR(1) DEFAULT 'N' NOT NULL,
    DTINS           DATE DEFAULT 'now',
    IDUSUINS        CHAR(8) DEFAULT USER,
    DTALT           DATE DEFAULT 'now',
    IDUSUALT        CHAR(8) DEFAULT USER,
    HINS            TIME DEFAULT 'now',
    HALT            TIME DEFAULT 'now',
    CODEMPML        INTEGER,
    CODFILIALML     SMALLINT,
    CODMODLOTE      INTEGER,
    NRODIASVALID    SMALLINT,
    GLOTEOPP        CHAR(1) DEFAULT 'N' NOT NULL,
    USADENSIDADEOP  CHAR(1) DEFAULT 'N' NOT NULL
);

CREATE TABLE PPFASE (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    CODFASE    INTEGER NOT NULL,
    DESCFASE   CHAR(50) NOT NULL,
    DTINS      DATE DEFAULT 'now',
    IDUSUINS   CHAR(8) DEFAULT USER,
    DTALT      DATE DEFAULT 'now',
    IDUSUALT   CHAR(8) DEFAULT USER,
    TIPOFASE   CHAR(2) NOT NULL,
    HINS       TIME DEFAULT 'now',
    HALT       TIME DEFAULT 'now'
);

CREATE TABLE PPFOTOMTAN (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    CODMTANALISE  INTEGER NOT NULL,
    CODFOTOMTAN   INTEGER NOT NULL,
    DESCFOTOMTAN  VARCHAR(300) NOT NULL,
    FOTOMTAN      BLOB SUB_TYPE 0 SEGMENT SIZE 50 NOT NULL,
    DTINS         DATE DEFAULT 'now',
    IDUSUINS      CHAR(8) DEFAULT USER,
    DTALT         DATE DEFAULT 'now',
    IDUSUALT      CHAR(8) DEFAULT USER,
    HINS          TIME DEFAULT 'now',
    HALT          TIME DEFAULT 'now'
);

CREATE TABLE PPITESTRUTURA (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    CODPROD       INTEGER NOT NULL,
    SEQEST        SMALLINT DEFAULT 0 NOT NULL,
    SEQITEST      SMALLINT NOT NULL,
    REFPROD       CHAR(13),
    CODEMPPD      INTEGER NOT NULL,
    CODFILIALPD   SMALLINT NOT NULL,
    CODPRODPD     INTEGER NOT NULL,
    REFPRODPD     CHAR(13),
    CODEMPFS      INTEGER NOT NULL,
    CODFILIALFS   SMALLINT NOT NULL,
    CODFASE       INTEGER NOT NULL,
    SEQEF         SMALLINT NOT NULL,
    QTDITEST      NUMERICDN NOT NULL,
    RMAAUTOITEST  CHAR(1) DEFAULT 'N' NOT NULL,
    CPROVA        CHAR(1) DEFAULT 'N' NOT NULL,
    QTDVARIAVEL   CHAR(1) DEFAULT 'N' NOT NULL,
    QTDFIXA       CHAR(1) DEFAULT 'N' NOT NULL,
    DTINS         DATE DEFAULT 'now' NOT NULL,
    HINS          TIME DEFAULT 'now' NOT NULL,
    IDUSUINS      CHAR(8) DEFAULT USER NOT NULL,
    DTALT         DATE DEFAULT 'now',
    HALT          TIME DEFAULT 'now',
    IDUSUALT      CHAR(8) DEFAULT USER
);

CREATE TABLE PPITOP (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    CODOP         INTEGER NOT NULL,
    SEQOP         SMALLINT DEFAULT 0 NOT NULL,
    SEQITOP       SMALLINT NOT NULL,
    CODEMPPD      INTEGER NOT NULL,
    CODFILIALPD   SMALLINT NOT NULL,
    CODPROD       INTEGER NOT NULL,
    REFPROD       CHAR(13) NOT NULL,
    QTDITOP       NUMERICDN DEFAULT 0 NOT NULL,
    CODEMPFS      INTEGER NOT NULL,
    CODFILIALFS   SMALLINT NOT NULL,
    CODFASE       INTEGER NOT NULL,
    CODEMPLE      INTEGER,
    CODFILIALLE   SMALLINT,
    CODLOTE       VARCHAR(20),
    SEQITOPCP     SMALLINT,
    CODLOTERAT    VARCHAR(20),
    QTDCOPIAITOP  NUMERICDN,
    GERARMA       CHAR(1) NOT NULL,
    SEQAC         SMALLINT,
    DTINS         DATE DEFAULT 'now',
    IDUSUINS      CHAR(8) DEFAULT USER,
    DTALT         DATE DEFAULT 'now',
    IDUSUALT      CHAR(8) DEFAULT USER,
    HINS          TIME DEFAULT 'now',
    HALT          TIME DEFAULT 'now',
    BLOQOP        CHAR(1) DEFAULT 'N' NOT NULL
);

CREATE TABLE PPITRETCP (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODOP        INTEGER NOT NULL,
    SEQOP        SMALLINT DEFAULT 0 NOT NULL,
    CODITRETCP   SMALLINT NOT NULL,
    CODEMPPD     INTEGER NOT NULL,
    CODFILIALPD  SMALLINT NOT NULL,
    CODPROD      INTEGER NOT NULL,
    QTDITRET     NUMERICDN DEFAULT 0 NOT NULL,
    DTINS        DATE DEFAULT 'now' NOT NULL,
    IDUSUINS     CHAR(8) DEFAULT USER NOT NULL,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now'
);

CREATE TABLE PPMETODOANALISE (
    CODEMP          INTEGER NOT NULL,
    CODFILIAL       SMALLINT NOT NULL,
    CODMTANALISE    SMALLINT NOT NULL,
    DESCMTANALISE   VARCHAR(80) NOT NULL,
    TITULOANALISE   VARCHAR(100) NOT NULL,
    FONTEMTANALISE  VARCHAR(100),
    MATANALISE      VARCHAR(6000),
    REAGANALISE     VARCHAR(6000),
    PROCANALISE     VARCHAR(6000),
    DTINS           DATE DEFAULT 'now' NOT NULL,
    IDUSUINS        VARCHAR(128) DEFAULT USER NOT NULL,
    HINS            TIME DEFAULT 'now' NOT NULL,
    DTALT           DATE DEFAULT 'now' NOT NULL,
    IDUSUALT        VARCHAR(128) DEFAULT USER NOT NULL,
    HALT            TIME DEFAULT 'now' NOT NULL
);

CREATE TABLE PPOP (
    CODEMP          INTEGER NOT NULL,
    CODFILIAL       SMALLINT NOT NULL,
    CODOP           INTEGER NOT NULL,
    SEQOP           SMALLINT DEFAULT 0 NOT NULL,
    DTEMITOP        DATE DEFAULT 'now' NOT NULL,
    CODEMPPD        INTEGER NOT NULL,
    CODFILIALPD     SMALLINT NOT NULL,
    CODPROD         INTEGER NOT NULL,
    SEQEST          SMALLINT DEFAULT 0 NOT NULL,
    REFPROD         CHAR(13) NOT NULL,
    DTFABROP        DATE NOT NULL,
    QTDSUGPRODOP    NUMERICDN DEFAULT 0 NOT NULL,
    QTDPREVPRODOP   NUMERICDN NOT NULL,
    QTDFINALPRODOP  NUMERICDN DEFAULT 0 NOT NULL,
    QTDDISTPOP      NUMERICDN DEFAULT 0 NOT NULL,
    QTDDISTIOP      NUMERICDN DEFAULT 0 NOT NULL,
    DTVALIDPDOP     DATE,
    CODEMPLE        INTEGER,
    CODFILIALLE     SMALLINT,
    CODLOTE         VARCHAR(20),
    CODEMPTM        INTEGER NOT NULL,
    CODFILIALTM     SMALLINT NOT NULL,
    CODTIPOMOV      INTEGER NOT NULL,
    CODEMPAX        INTEGER NOT NULL,
    CODFILIALAX     SMALLINT NOT NULL,
    CODALMOX        INTEGER NOT NULL,
    CODEMPOPM       INTEGER,
    CODFILIALOPM    SMALLINT,
    CODOPM          INTEGER,
    SEQOPM          SMALLINT,
    SITOP           CHAR(2) DEFAULT 'PE' NOT NULL,
    OBSOP           VARCHAR(1000),
    JUSTFICQTDPROD  VARCHAR(500),
    JUSTIFICCANC    VARCHAR(500),
    DTCANC          TIMESTAMP,
    IDUSUCANC       CHAR(8),
    HCANC           TIME,
    DTINS           DATE DEFAULT 'now',
    HINS            TIME DEFAULT 'now',
    IDUSUINS        CHAR(8) DEFAULT USER,
    DTALT           DATE DEFAULT 'now',
    HALT            TIME DEFAULT 'now',
    IDUSUALT        CHAR(8) DEFAULT USER
);

CREATE TABLE PPOPACAOCORRET (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    CODOP      INTEGER NOT NULL,
    SEQOP      SMALLINT NOT NULL,
    SEQAC      SMALLINT NOT NULL,
    TPCAUSA    CHAR(2) NOT NULL,
    OBSCAUSA   VARCHAR(500),
    TPACAO     CHAR(2),
    OBSACAO    VARCHAR(500),
    DTINS      DATE DEFAULT 'now' NOT NULL,
    IDUSUINS   CHAR(8) DEFAULT USER NOT NULL,
    DTALT      DATE DEFAULT 'now' NOT NULL,
    IDUSUALT   CHAR(8) DEFAULT USER NOT NULL,
    HINS       TIME DEFAULT 'now' NOT NULL,
    HALT       TIME DEFAULT 'now' NOT NULL,
    STATUS     CHAR(2) DEFAULT 'PE' NOT NULL
);

CREATE TABLE PPOPCQ (
    CODEMP         INTEGER NOT NULL,
    CODFILIAL      SMALLINT NOT NULL,
    CODOP          INTEGER NOT NULL,
    SEQOP          SMALLINT NOT NULL,
    SEQOPCQ        INTEGER NOT NULL,
    SEQAC          SMALLINT,
    CODEMPEA       INTEGER NOT NULL,
    CODFILIALEA    SMALLINT NOT NULL,
    CODESTANALISE  INTEGER NOT NULL,
    VLRAFER        NUMERIC(15,5),
    DESCAFER       CHAR(80),
    STATUS         CHAR(2) DEFAULT 'PE' NOT NULL,
    DTINS          DATE DEFAULT 'now' NOT NULL,
    IDUSUINS       CHAR(8) DEFAULT USER NOT NULL,
    DTALT          DATE DEFAULT 'now' NOT NULL,
    IDUSUALT       CHAR(8) DEFAULT USER NOT NULL,
    HINS           TIME DEFAULT 'now' NOT NULL,
    HALT           TIME DEFAULT 'now' NOT NULL
);

CREATE TABLE PPOPFASE (
    CODEMP         INTEGER NOT NULL,
    CODFILIAL      SMALLINT NOT NULL,
    CODOP          INTEGER NOT NULL,
    SEQOP          SMALLINT DEFAULT 0 NOT NULL,
    SEQOF          SMALLINT NOT NULL,
    CODEMPFS       INTEGER NOT NULL,
    CODFILIALFS    SMALLINT NOT NULL,
    CODFASE        INTEGER NOT NULL,
    CODEMPRP       INTEGER NOT NULL,
    CODFILIALRP    SMALLINT NOT NULL,
    CODRECP        INTEGER NOT NULL,
    TEMPOOF        NUMERICDN DEFAULT 0 NOT NULL,
    CODEMPTR       INTEGER NOT NULL,
    CODFILIALTR    SMALLINT NOT NULL,
    CODTPREC       INTEGER NOT NULL,
    DTINS          DATE DEFAULT 'now',
    IDUSUINS       CHAR(8) DEFAULT USER,
    DTALT          DATE DEFAULT 'now',
    IDUSUALT       CHAR(8) DEFAULT USER,
    HINS           TIME DEFAULT 'now',
    HALT           TIME DEFAULT 'now',
    DATAINIPRODFS  DATE,
    HINIPRODFS     TIME,
    DATAFIMPRODFS  DATE,
    HFIMPRODFS     TIME,
    OBSFS          VARCHAR(500),
    SITFS          CHAR(2) DEFAULT 'PE'
);

CREATE TABLE PPRECURSO (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODRECP      INTEGER NOT NULL,
    DESCRECP     CHAR(50) NOT NULL,
    CODEMPTR     INTEGER NOT NULL,
    CODFILIALTR  SMALLINT NOT NULL,
    CODTPREC     INTEGER NOT NULL,
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now'
);

CREATE TABLE PPRETCP (
    CODEMP      INTEGER NOT NULL,
    CODFILIAL   SMALLINT NOT NULL,
    CODOP       INTEGER NOT NULL,
    SEQOP       SMALLINT DEFAULT 0 NOT NULL,
    DTRETENCAO  DATE DEFAULT 'now' NOT NULL,
    DTDESCARTE  DATE DEFAULT 'now' NOT NULL,
    DTINS       DATE DEFAULT 'now' NOT NULL,
    IDUSUINS    CHAR(8) DEFAULT USER NOT NULL,
    DTALT       DATE DEFAULT 'now',
    IDUSUALT    CHAR(8) DEFAULT USER,
    HINS        TIME DEFAULT 'now',
    HALT        TIME DEFAULT 'now'
);

CREATE TABLE PPTIPOANALISE (
    CODEMP         INTEGER NOT NULL,
    CODFILIAL      SMALLINT NOT NULL,
    CODTPANALISE   SMALLINT NOT NULL,
    DESCTPANALISE  VARCHAR(80),
    OBSTPANALISE   VARCHAR(500),
    TIPOEXPEC      CHAR(2) NOT NULL,
    CODEMPUD       INTEGER,
    CODFILIALUD    SMALLINT,
    CODUNID        VARCHAR(20),
    CODEMPMA       INTEGER NOT NULL,
    CODFILIALMA    SMALLINT NOT NULL,
    CODMTANALISE   SMALLINT NOT NULL,
    DTINS          DATE DEFAULT 'now' NOT NULL,
    IDUSUINS       VARCHAR(128) DEFAULT USER NOT NULL,
    HINS           TIME DEFAULT 'now' NOT NULL,
    DTALT          DATE DEFAULT 'now' NOT NULL,
    IDUSUALT       VARCHAR(128) DEFAULT USER NOT NULL,
    HALT           TIME DEFAULT 'now' NOT NULL
);

CREATE TABLE PPTIPOREC (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    CODTPREC   INTEGER NOT NULL,
    DESCTPREC  CHAR(50) NOT NULL,
    DTINS      DATE DEFAULT 'now',
    IDUSUINS   CHAR(8) DEFAULT USER,
    DTALT      DATE DEFAULT 'now',
    IDUSUALT   CHAR(8) DEFAULT USER,
    HINS       TIME DEFAULT 'now',
    HALT       TIME DEFAULT 'now'
);

CREATE TABLE PVCAIXA (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODCAIXA     INTEGER NOT NULL,
    DESCCAIXA    CHAR(40) NOT NULL,
    CODEMPET     INTEGER NOT NULL,
    CODFILIALET  SMALLINT NOT NULL,
    CODEST       INTEGER NOT NULL,
    SEQINI       INTEGER,
    SEQMAX       INTEGER,
    ECFCAIXA     CHAR(1) DEFAULT 'S' NOT NULL,
    TEFCAIXA     CHAR(1) DEFAULT 'N',
    ORCCAIXA     CHAR(1) DEFAULT 'N' NOT NULL,
    MODODEMO     CHAR(1) DEFAULT 'S' NOT NULL,
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now'
);

CREATE TABLE PVCAIXAIMP (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    CODCAIXA   INTEGER NOT NULL,
    CODIMP     INTEGER NOT NULL,
    IMPPAD     CHAR(1),
    DTINS      DATE DEFAULT 'now',
    IDUSUINS   CHAR(8) DEFAULT USER,
    DTALT      DATE DEFAULT 'now',
    IDUSUALT   CHAR(8) DEFAULT USER,
    HINS       TIME DEFAULT 'now',
    HALT       TIME DEFAULT 'now'
);

CREATE TABLE PVLEITURAX (
    CODEMP          INTEGER NOT NULL,
    CODFILIAL       SMALLINT NOT NULL,
    CODCAIXA        INTEGER NOT NULL,
    DTLX            DATE NOT NULL,
    TT01            NUMERICDN,
    TT02            NUMERICDN,
    TT03            NUMERICDN,
    TT04            NUMERICDN,
    TT05            NUMERICDN,
    TT06            NUMERICDN,
    TT07            NUMERICDN,
    TT08            NUMERICDN,
    TT09            NUMERICDN,
    TT10            NUMERICDN,
    TT11            NUMERICDN,
    TT12            NUMERICDN,
    TT13            NUMERICDN,
    TT14            NUMERICDN,
    TT15            NUMERICDN,
    TT16            NUMERICDN,
    TISENCAO        NUMERICDN,
    TNINCIDENCIA    NUMERICDN,
    TSUBSTITUICAO   NUMERICDN,
    TN1             NUMERICDN,
    TN2             NUMERICDN,
    TN3             NUMERICDN,
    TN4             NUMERICDN,
    TN5             NUMERICDN,
    TN6             NUMERICDN,
    TN7             NUMERICDN,
    TN8             NUMERICDN,
    TN9             NUMERICDN,
    TSANGRIA        NUMERICDN,
    TSUPRIMENTO     NUMERICDN,
    TGTOTAL         NUMERICDN,
    ALIQ01          NUMERICDN,
    ALIQ02          NUMERICDN,
    ALIQ03          NUMERICDN,
    ALIQ04          NUMERICDN,
    ALIQ05          NUMERICDN,
    ALIQ06          NUMERICDN,
    ALIQ07          NUMERICDN,
    ALIQ08          NUMERICDN,
    ALIQ09          NUMERICDN,
    ALIQ10          NUMERICDN,
    ALIQ11          NUMERICDN,
    ALIQ12          NUMERIC(15,3),
    ALIQ13          NUMERIC(15,3),
    ALIQ14          NUMERIC(15,3),
    ALIQ15          NUMERIC(15,3),
    ALIQ16          NUMERIC(15,3),
    VLRCONTABILLX   NUMERIC(15,3),
    VLRBASECALCLX   NUMERIC(15,3),
    NUMCANCLX       INTEGER,
    NUMREDLX        INTEGER,
    VLRCANCLX       NUMERIC(15,3),
    VLRDESCLX       NUMERIC(15,3),
    CONTALX         NUMERIC(15,3),
    VLROUTROSRECLX  NUMERIC(15,3),
    ULTCUPOMLX      INTEGER,
    PRIMCUPOMLX     INTEGER,
    DTINS           DATE DEFAULT 'now',
    IDUSUINS        CHAR(8) DEFAULT USER,
    DTALT           DATE DEFAULT 'now',
    IDUSUALT        CHAR(8) DEFAULT USER,
    HINS            TIME DEFAULT 'now',
    HALT            TIME DEFAULT 'now'
);

CREATE TABLE PVMOVCAIXA (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODCAIXA     INTEGER NOT NULL,
    DTAMOV       DATE NOT NULL,
    NROMOV       INTEGER NOT NULL,
    TIPOMOV      CHAR(1) NOT NULL,
    VLRMOV       NUMERICDN NOT NULL,
    VLRSLDMOV    NUMERICDN,
    CODEMPUS     INTEGER NOT NULL,
    CODFILIALUS  SMALLINT NOT NULL,
    IDUSU        CHAR(8) NOT NULL
);

CREATE TABLE PVSEQMOVCAIXA (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    CODCAIXA   INTEGER NOT NULL,
    DTAMOV     DATE NOT NULL,
    NROMOV     INTEGER DEFAULT 0 NOT NULL,
    DTINS      DATE DEFAULT 'now',
    IDUSUINS   CHAR(8) DEFAULT USER,
    DTALT      DATE DEFAULT 'now',
    IDUSUALT   CHAR(8) DEFAULT USER,
    HINS       DATE DEFAULT 'now',
    HALT       TIME DEFAULT 'now'
);

CREATE TABLE PVSEQUENCIA (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    CODCAIXA   INTEGER NOT NULL,
    SEQCAIXA   INTEGER DEFAULT 1 NOT NULL
);

CREATE TABLE RHAREA (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    CODAREA    INTEGER NOT NULL,
    DESCAREA   CHAR(60) NOT NULL
);

CREATE TABLE RHBENEFICIO (
    CODEMP      INTEGER NOT NULL,
    CODFILIAL   SMALLINT NOT NULL,
    CODBENEF    INTEGER NOT NULL,
    DESCBENEF   CHAR(60) NOT NULL,
    VALORBENEF  NUMERICDN,
    DTINS       DATE DEFAULT 'now',
    HINS        TIME DEFAULT 'now',
    IDUSUINS    CHAR(8) DEFAULT USER,
    DTALT       DATE DEFAULT 'now',
    HALT        TIME DEFAULT 'now',
    IDUSUALT    CHAR(8) DEFAULT USER
);

CREATE TABLE RHCANDIDATO (
    CODEMP          INTEGER NOT NULL,
    CODFILIAL       SMALLINT NOT NULL,
    CODCAND         INTEGER NOT NULL,
    NOMECAND        CHAR(50) NOT NULL,
    ENDCAND         CHAR(50),
    NUMCAND         INTEGER,
    UFCAND          CHAR(2),
    CIDCAND         CHAR(50),
    BAIRCAND        CHAR(30),
    CEPCAND         CHAR(8),
    FONECAND        CHAR(12),
    DDDCAND         CHAR(4),
    CELCAND         CHAR(8),
    DTNASCCAND      DATE,
    SEXOCAND        CHAR(1) NOT NULL,
    PISPASEPCAND    CHAR(20),
    CTPSCAND        CHAR(20),
    CPFCAND         CHAR(11),
    RGCAND          CHAR(10),
    SSPCAND         CHAR(10),
    TITELEITCAND    CHAR(15),
    EMAILCAND       CHAR(50),
    OUTROSEMPREGOS  VARCHAR(1000),
    CODEMPES        INTEGER NOT NULL,
    CODFILIALES     SMALLINT NOT NULL,
    CODESTCIVIL     CHAR(2) NOT NULL,
    PRETENSAOSAL    NUMERICDN,
    STCAND          CHAR(2) DEFAULT 'DI' NOT NULL,
    DTULTST         DATE DEFAULT 'now' NOT NULL,
    OBSCAND         VARCHAR(1000),
    NROFILHOS       SMALLINT DEFAULT 0,
    ISENCTRANSP     CHAR(1) DEFAULT 'N' NOT NULL
);

CREATE TABLE RHCANDIDATOCARAC (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODCAND      INTEGER NOT NULL,
    CODEMPCT     INTEGER NOT NULL,
    CODFILIALCT  SMALLINT NOT NULL,
    CODCARAC     CHAR(15) NOT NULL
);

CREATE TABLE RHCANDIDATOCURSO (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODCAND      INTEGER NOT NULL,
    CODEMPCS     INTEGER NOT NULL,
    CODFILIALCS  SMALLINT NOT NULL,
    CODCURSO     INTEGER NOT NULL
);

CREATE TABLE RHCANDIDATOFUNC (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODCAND      INTEGER NOT NULL,
    CODEMPFC     INTEGER NOT NULL,
    CODFILIALFC  SMALLINT NOT NULL,
    CODFUNC      INTEGER NOT NULL,
    SEQCANDFUNC  SMALLINT NOT NULL,
    EMPRESA      CHAR(60),
    DTINIFUNC    DATE,
    DTFIMFUNC    DATE,
    OBSFUNC      VARCHAR(500),
    SALARIO      NUMERICDN
);

CREATE TABLE RHCANDIDATOSTATUS (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODCAND      INTEGER NOT NULL,
    CODEMPVG     INTEGER,
    CODFILIALVG  SMALLINT,
    CODVAGA      INTEGER,
    SQSTCAND     INTEGER NOT NULL,
    STCAND       CHAR(2) DEFAULT 'DI',
    DTSTATUS     DATE DEFAULT 'now' NOT NULL
);

CREATE TABLE RHCARACTERISTICA (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  INTEGER NOT NULL,
    CODCARAC   CHAR(15) NOT NULL,
    DESCCARAC  CHAR(50) NOT NULL,
    OBSCARAC   VARCHAR(10000),
    DTINS      DATE DEFAULT 'now',
    IDUSUINS   CHAR(8) DEFAULT USER,
    DTALT      DATE DEFAULT 'now',
    IDUSUALT   CHAR(8) DEFAULT USER,
    HINS       TIME DEFAULT 'now',
    HALT       TIME DEFAULT 'now'
);

CREATE TABLE RHCURSO (
    CODEMP            INTEGER NOT NULL,
    CODFILIAL         SMALLINT NOT NULL,
    CODCURSO          INTEGER NOT NULL,
    DESCCURSO         CHAR(60) NOT NULL,
    CONTPROGCURSO     VARCHAR(1000),
    INSTITUICAOCURSO  CHAR(80),
    DURACAOCURSO      SMALLINT,
    CODAREA           INTEGER,
    CODEMPAR          INTEGER,
    CODFILIALAR       SMALLINT,
    CODNIVELCURSO     SMALLINT NOT NULL,
    CODEMPNC          INTEGER NOT NULL,
    CODFILIALNC       SMALLINT NOT NULL
);

CREATE TABLE RHDEPTO (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    CODDEP     INTEGER NOT NULL,
    DESCDEP    CHAR(50) NOT NULL
);

CREATE TABLE RHEMPREGADO (
    CODEMP          INTEGER NOT NULL,
    CODFILIAL       SMALLINT NOT NULL,
    MATEMPR         INTEGER NOT NULL,
    NOMEEMPR        CHAR(50) NOT NULL,
    APELIDOEMPR     CHAR(30) NOT NULL,
    CODEMPFO        INTEGER NOT NULL,
    CODFILIALFO     SMALLINT NOT NULL,
    CODFUNC         INTEGER NOT NULL,
    CODEMPDP        INTEGER NOT NULL,
    CODFILIALDP     SMALLINT NOT NULL,
    CODDEP          INTEGER NOT NULL,
    CODEMPTO        INTEGER NOT NULL,
    CODFILIALTO     SMALLINT NOT NULL,
    CODTURNO        INTEGER,
    ENDEMPR         CHAR(50),
    NUMEMPR         INTEGER,
    CIDEMPR         CHAR(30),
    BAIREMPR        CHAR(30),
    CEPEMPR         CHAR(8),
    FONEEMPR        CHAR(12),
    DTADMISSAO      DATE NOT NULL,
    FOTOEMPR        BLOB SUB_TYPE 0 SEGMENT SIZE 50,
    STATUSEMPR      CHAR(2) NOT NULL,
    DTINS           DATE DEFAULT 'now',
    IDUSUINS        CHAR(8) DEFAULT USER,
    DTALT           DATE DEFAULT 'now',
    IDUSUALT        CHAR(8) DEFAULT USER,
    HINS            TIME DEFAULT 'now',
    HALT            TIME DEFAULT 'now',
    SEXOEMPR        CHAR(1) DEFAULT 'M' NOT NULL,
    DTNASCEMPR      DATE,
    CTPSEMPR        VARCHAR(20),
    SERIECTPSEMPR   VARCHAR(6),
    UFCTPSEMPR      CHAR(2),
    CERTRESERVEMPR  VARCHAR(20),
    PISPASEPEMPR    VARCHAR(20),
    RGEMPR          CHAR(10),
    ORGEXPRHEMPR    CHAR(10),
    CPFEMPR         CHAR(11),
    UFRGEMPR        CHAR(2),
    DTEXPRGEMPR     DATE,
    TITELEITEMPR    CHAR(15),
    ZONAELEITEMPR   INTEGER,
    SECAOELEITEMPR  INTEGER,
    CNHEMPR         VARCHAR(20),
    MAEEMPR         VARCHAR(80),
    PAIEMPR         CHAR(80),
    COMPLENDEMPR    VARCHAR(40),
    UFEMPR          CHAR(2),
    DTDEMISSAOEMPR  DATE,
    DDDEMPR         CHAR(4),
    FONE2EMPR       CHAR(12),
    CELEMPR         CHAR(12),
    EMAILEMPR       VARCHAR(40)
);

CREATE TABLE RHEMPREGADOBENEF (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    MATEMPR      INTEGER NOT NULL,
    CODEMPBN     INTEGER NOT NULL,
    CODFILIALBN  SMALLINT NOT NULL,
    CODBENEF     INTEGER NOT NULL,
    QTDBENEF     NUMERICDN,
    VLRTOTBENEF  NUMERICDN,
    DTINS        DATE DEFAULT 'now' NOT NULL,
    HINS         TIME DEFAULT 'now' NOT NULL,
    IDUSUINS     CHAR(8) DEFAULT USER NOT NULL,
    DTALT        DATE DEFAULT 'now',
    HALT         TIME DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER
);

CREATE TABLE RHEMPREGADOR (
    CODEMP      INTEGER NOT NULL,
    CODFILIAL   SMALLINT NOT NULL,
    CODEMPR     INTEGER NOT NULL,
    NOMEEMPR    CHAR(60) NOT NULL,
    ATIVOEMPR   CHAR(1) NOT NULL,
    CNPJEMPR    CHAR(14),
    INSCEMPR    CHAR(15),
    ENDEMPR     CHAR(50),
    NUMEMPR     INTEGER,
    BAIREMPR    CHAR(30),
    CIDEMPR     CHAR(30),
    UFEMPR      CHAR(2),
    CEPEMPR     CHAR(8),
    DDDEMPR     CHAR(4),
    FONEEMPR    CHAR(12),
    RAMALEMPR   CHAR(6),
    DDDFAXEMPR  CHAR(4),
    FAXEMPR     CHAR(8),
    EMAILEMPR   CHAR(50),
    CONTEMPR    CHAR(40),
    OBSEMPR     VARCHAR(10000),
    DDDCELEMPR  CHAR(4),
    CELEMPR     CHAR(8),
    SITEEMPR    CHAR(50),
    DTINS       DATE DEFAULT 'now',
    IDUSUINS    CHAR(8) DEFAULT USER,
    DTALT       DATE DEFAULT 'now',
    IDUSUALT    CHAR(8) DEFAULT user,
    HINS        TIME DEFAULT 'now',
    HALT        TIME DEFAULT 'now'
);

CREATE TABLE RHEMPREGADOSAL (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    MATEMPR    INTEGER NOT NULL,
    SEQSAL     SMALLINT NOT NULL,
    VALORSAL   NUMERICDN,
    DTVIGOR    DATE DEFAULT 'now' NOT NULL,
    OBSSAL     VARCHAR(1000),
    DTINS      DATE DEFAULT 'now' NOT NULL,
    HINS       TIME DEFAULT 'now' NOT NULL,
    IDUSUINS   CHAR(8) DEFAULT USER NOT NULL,
    DTALT      DATE DEFAULT 'now',
    HALT       TIME DEFAULT 'now',
    IDUSUALT   CHAR(8) DEFAULT USER
);

CREATE TABLE RHFUNCAO (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    CODFUNC    INTEGER NOT NULL,
    DESCFUNC   VARCHAR(100) NOT NULL,
    CBOFUNC    VARCHAR(10)
);

CREATE TABLE RHNIVELCURSO (
    CODEMP          INTEGER NOT NULL,
    CODFILIAL       SMALLINT NOT NULL,
    CODNIVELCURSO   SMALLINT NOT NULL,
    DESCNIVELCURSO  CHAR(60) NOT NULL
);

CREATE TABLE RHPONTO (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    MATEMPR    INTEGER NOT NULL,
    DTPT       DATE DEFAULT 'now' NOT NULL,
    HRPT       TIME DEFAULT 'now' NOT NULL,
    IDUSUINS   CHAR(8) DEFAULT USER NOT NULL
);

CREATE TABLE RHTURNO (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    CODTURNO      SMALLINT NOT NULL,
    DESCTURNO     CHAR(60) NOT NULL,
    NHSTURNO      SMALLINT DEFAULT 0 NOT NULL,
    TIPOTURNO     CHAR(1) DEFAULT 'N' NOT NULL,
    HINITURNO     TIMEDN NOT NULL,
    HFIMTURNO     TIMEDN NOT NULL,
    HINIINTTURNO  TIMEDN,
    HFIMINTTURNO  TIMEDN,
    TOLENTRADA    SMALLINT DEFAULT 0 NOT NULL,
    TOLSAIDA      SMALLINT DEFAULT 0 NOT NULL
);

CREATE TABLE RHVAGA (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODVAGA      INTEGER NOT NULL,
    CODEMPEM     INTEGER NOT NULL,
    CODFILIALEM  SMALLINT NOT NULL,
    CODEMPR      INTEGER NOT NULL,
    CODEMPFC     INTEGER NOT NULL,
    CODFILIALFC  SMALLINT NOT NULL,
    CODFUNC      INTEGER NOT NULL,
    FAIXASALINI  NUMERICDN NOT NULL,
    FAIXASALFIM  NUMERICDN NOT NULL,
    CODEMPTN     INTEGER,
    CODFILIALTN  SMALLINT,
    CODTURNO     SMALLINT,
    STVAGA       CHAR(2) DEFAULT 'AB' NOT NULL,
    DTULTST      DATE DEFAULT 'now' NOT NULL,
    DTINS        DATE DEFAULT 'now' NOT NULL,
    HINS         TIME DEFAULT 'now' NOT NULL,
    IDUSUINS     CHAR(8) DEFAULT USER NOT NULL,
    DTALT        DATE DEFAULT 'now',
    HALT         TIME DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER
);

CREATE TABLE RHVAGACANDIDATO (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODVAGA      INTEGER NOT NULL,
    CODEMPCA     INTEGER NOT NULL,
    CODFILIALCA  SMALLINT NOT NULL,
    CODCAND      INTEGER NOT NULL,
    STVAGACAND   CHAR(2) NOT NULL
);

CREATE TABLE RHVAGACARACQUALI (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODVAGA      INTEGER NOT NULL,
    CODEMPCT     INTEGER NOT NULL,
    CODFILIALCT  SMALLINT NOT NULL,
    CODCARAC     CHAR(15) NOT NULL
);

CREATE TABLE RHVAGACARACREST (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODVAGA      INTEGER NOT NULL,
    CODEMPCT     INTEGER NOT NULL,
    CODFILIALCT  SMALLINT NOT NULL,
    CODCARAC     CHAR(15) NOT NULL
);

CREATE TABLE RHVAGACURSO (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODVAGA      INTEGER NOT NULL,
    CODEMPCS     INTEGER NOT NULL,
    CODFILIALCS  SMALLINT NOT NULL,
    CODCURSO     INTEGER NOT NULL
);

CREATE TABLE RHVAGASTATUS (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    CODVAGA    INTEGER NOT NULL,
    SQSTVAGA   INTEGER NOT NULL,
    STVAGA     CHAR(2) DEFAULT 'AB' NOT NULL,
    DTSTATUS   DATE DEFAULT 'now' NOT NULL
);

CREATE TABLE SGACESSOEU (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    IDUSU        CHAR(8) NOT NULL,
    CODEMPFL     INTEGER NOT NULL,
    CODFILIALFL  SMALLINT NOT NULL,
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now'
);

CREATE TABLE SGACESSOMG (
    CODEMP      INTEGER NOT NULL,
    CODFILIAL   SMALLINT NOT NULL,
    IDGRPUSU    CHAR(8) NOT NULL,
    CODSIS      INTEGER NOT NULL,
    CODMODU     INTEGER NOT NULL,
    CODMENU     INTEGER NOT NULL,
    TPACESSOMG  CHAR(1) NOT NULL,
    DTINS       DATE DEFAULT 'now',
    IDUSUINS    CHAR(8) DEFAULT USER,
    DTALT       DATE DEFAULT 'now',
    IDUSUALT    CHAR(8) DEFAULT USER,
    HINS        TIME DEFAULT 'now',
    HALT        TIME DEFAULT 'now'
);

CREATE TABLE SGACESSOMU (
    CODEMP      INTEGER NOT NULL,
    CODFILIAL   SMALLINT NOT NULL,
    IDUSU       CHAR(8) NOT NULL,
    CODSIS      INTEGER NOT NULL,
    CODMODU     INTEGER NOT NULL,
    CODMENU     INTEGER NOT NULL,
    TPACESSOMU  CHAR(1) NOT NULL,
    PLANOMU     CHAR(1) DEFAULT 'O' NOT NULL
);

CREATE TABLE SGAGENDA (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    TIPOAGE      CHAR(5) NOT NULL,
    CODAGE       INTEGER NOT NULL,
    CODAGD       INTEGER NOT NULL,
    DATAAGD      DATE NOT NULL,
    DTAINIAGD    DATE NOT NULL,
    HRINIAGD     TIME NOT NULL,
    DTAFIMAGD    DATE NOT NULL,
    HRFIMAGD     TIME NOT NULL,
    ASSUNTOAGD   CHAR(50) NOT NULL,
    DESCAGD      VARCHAR(10000) NOT NULL,
    PRIORAGD     SMALLINT NOT NULL,
    SITAGD       CHAR(2) NOT NULL,
    CODEMPAE     INTEGER NOT NULL,
    CODFILIALAE  SMALLINT NOT NULL,
    CODAGEEMIT   INTEGER NOT NULL,
    TIPOAGEEMIT  CHAR(5) NOT NULL,
    CAAGD        CHAR(2) DEFAULT 'PR' NOT NULL,
    CODEMPTA     INTEGER NOT NULL,
    CODFILIALTA  SMALLINT NOT NULL,
    CODTIPOAGD   INTEGER NOT NULL
);

CREATE TABLE SGAGENTE (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    TIPOAGE    CHAR(5) NOT NULL,
    CODAGE     INTEGER NOT NULL,
    DESCAGE    CHAR(50) NOT NULL,
    DTINS      DATE DEFAULT 'now',
    HINS       TIME DEFAULT 'now',
    IDUSUINS   CHAR(8) DEFAULT user,
    DTALT      DATE,
    HALT       TIME,
    IDUSUALT   CHAR(8)
);

CREATE TABLE SGATRIBUICAO (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    IDATRIB    CHAR(10) NOT NULL,
    DESCATRIB  CHAR(50) NOT NULL,
    RMAATRIB   CHAR(2) NOT NULL,
    OBSATRIB   VARCHAR(500),
    DTINS      DATE DEFAULT 'now',
    IDUSUINS   CHAR(8) DEFAULT USER,
    DTALT      DATE DEFAULT 'now',
    IDUSUALT   CHAR(8) DEFAULT USER,
    HINS       TIME DEFAULT 'now',
    HALT       TIME DEFAULT 'now'
);

CREATE TABLE SGATRIBUSU (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    IDATRIB      CHAR(10) NOT NULL,
    CODEMPUU     INTEGER NOT NULL,
    CODFILIALUU  SMALLINT NOT NULL,
    IDUSU        CHAR(8) NOT NULL,
    IDUSUINS     CHAR(8) DEFAULT user,
    DTINS        DATE DEFAULT 'now',
    HINS         TIME DEFAULT 'now',
    IDUSUALT     CHAR(8),
    DTALT        DATE,
    HALT         TIME
);

CREATE TABLE SGCIDADE (
    CODCID    INTEGER NOT NULL,
    NOMECID   CHAR(50) NOT NULL,
    SIGLACID  CHAR(5),
    DDDCID    INTEGER
);

CREATE TABLE SGCONEXAO (
    NRCONEXAO     INTEGER NOT NULL,
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    IDUSU         CHAR(10) NOT NULL,
    CODFILIALSEL  SMALLINT NOT NULL,
    CODTERM       INTEGER,
    CONECTADO     INTEGER DEFAULT 0 NOT NULL
);

CREATE TABLE SGEMPRESA (
    CODEMP         INTEGER NOT NULL,
    RAZEMP         CHAR(50),
    NOMEEMP        CHAR(50),
    CNPJEMP        CHAR(14),
    INSCEMP        CHAR(15),
    ENDEMP         CHAR(50),
    NUMEMP         INTEGER,
    COMPLEMP       CHAR(20),
    BAIREMP        CHAR(30),
    CEPEMP         CHAR(8),
    CIDEMP         CHAR(30),
    UFEMP          CHAR(2),
    FONEEMP        CHAR(12),
    FAXEMP         CHAR(8),
    EMAILEMP       CHAR(50),
    WWWEMP         CHAR(50),
    CODEANEMP      CHAR(10),
    CODPAISEMP     CHAR(3),
    PERCISSEMP     NUMERIC(6,2) DEFAULT 0,
    NOMECONTEMP    CHAR(40),
    MULTIALMOXEMP  CHAR(1) DEFAULT 'N' NOT NULL,
    FOTOEMP        BLOB SUB_TYPE 0 SEGMENT SIZE 50,
    CODMUNIC       CHAR(5),
    SIGLAUF        CHAR(2),
    CODPAIS        SMALLINT,
    DTINS          DATE DEFAULT 'now',
    IDUSUINS       CHAR(8) DEFAULT USER,
    DTALT          DATE DEFAULT 'now',
    IDUSUALT       CHAR(8) DEFAULT USER,
    HINS           TIME DEFAULT 'now',
    HALT           TIME DEFAULT 'now',
    DDDEMP         CHAR(4)
);

CREATE TABLE SGEQVCLIFOR (
    CODEMPCL     INTEGER NOT NULL,
    CODFILIALCL  INTEGER NOT NULL,
    CODCLI       INTEGER NOT NULL,
    CODEMPFR     INTEGER NOT NULL,
    CODFILIALFR  INTEGER NOT NULL,
    CODFOR       INTEGER NOT NULL,
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now'
);

CREATE TABLE SGESTACAO (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODEST       SMALLINT NOT NULL,
    DESCEST      CHAR(50) NOT NULL,
    MODODEMOEST  CHAR(1) DEFAULT 'N' NOT NULL,
    IDUSUINS     CHAR(8),
    DTINS        DATE DEFAULT 'now',
    HINS         TIME DEFAULT 'now',
    IDUSUALT     CHAR(8),
    DTALT        DATE,
    HALT         TIME
);

CREATE TABLE SGESTACAOIMP (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODEST       INTEGER NOT NULL,
    NROIMP       SMALLINT NOT NULL,
    CODEMPIP     INTEGER NOT NULL,
    CODFILIALIP  SMALLINT NOT NULL,
    CODIMP       INTEGER NOT NULL,
    CODEMPPP     INTEGER NOT NULL,
    CODFILIALPP  SMALLINT NOT NULL,
    CODPAPEL     CHAR(10) NOT NULL,
    PORTAWIN     CHAR(50) NOT NULL,
    PORTALIN     CHAR(50) NOT NULL,
    IMPPAD       CHAR(1) DEFAULT 'N' NOT NULL,
    TIPOUSOIMP   CHAR(2) NOT NULL,
    IMPGRAFICA   CHAR(1) DEFAULT 'N' NOT NULL,
    IDUSUINS     CHAR(8) DEFAULT user,
    DTINS        DATE DEFAULT 'now',
    HINS         TIME DEFAULT 'now',
    IDUSUALT     CHAR(8),
    DTALT        DATE,
    HALT         TIME
);

CREATE TABLE SGESTCIVIL (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    CODESTCIVIL   CHAR(2) NOT NULL,
    DESCESTCIVIL  CHAR(50) NOT NULL
);

CREATE TABLE SGFERIADO (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    DATAFER    DATE NOT NULL,
    DESCFER    CHAR(50) NOT NULL,
    BANCFER    CHAR(1) default 'S' NOT NULL,
    DTINS      DATE DEFAULT 'now' NOT NULL,
    IDUSUINS   VARCHAR(128) DEFAULT USER NOT NULL,
    DTALT      DATE DEFAULT 'now' NOT NULL,
    IDUSUALT   VARCHAR(128) DEFAULT USER NOT NULL,
    HINS       TIME DEFAULT 'now' NOT NULL,
    HALT       TIME DEFAULT 'now' NOT NULL,
    TRABFER    CHAR(1) DEFAULT 'S' NOT NULL
);

CREATE TABLE SGFILIAL (
    CODEMP             INTEGER NOT NULL,
    CODFILIAL          SMALLINT NOT NULL,
    RAZFILIAL          CHAR(50) NOT NULL,
    NOMEFILIAL         CHAR(50) NOT NULL,
    MZFILIAL           CHAR(1) NOT NULL,
    CNPJFILIAL         CHAR(14),
    INSCFILIAL         CHAR(15),
    ENDFILIAL          CHAR(50),
    NUMFILIAL          INTEGER,
    COMPLFILIAL        CHAR(20),
    BAIRFILIAL         CHAR(30),
    CEPFILIAL          CHAR(8),
    CIDFILIAL          CHAR(30),
    UFFILIAL           CHAR(2),
    FONEFILIAL         CHAR(12),
    FAXFILIAL          CHAR(8),
    EMAILFILIAL        CHAR(50),
    WWWFILIAL          CHAR(50),
    CODDISTFILIAL      INTEGER,
    PERCPISFILIAL      NUMERIC(5,2) DEFAULT 0,
    PERCCOFINSFILIAL   NUMERIC(5,2) DEFAULT 0,
    PERCIRFILIAL       NUMERIC(5,2) DEFAULT 0,
    PERCCSOCIALFILIAL  NUMERIC(5,2) DEFAULT 0,
    SIMPLESFILIAL      CHAR(1),
    CODMUNIC           CHAR(5),
    SIGLAUF            CHAR(2),
    CODPAIS            SMALLINT,
    DTINS              DATE DEFAULT 'now',
    IDUSUINS           CHAR(8) DEFAULT USER,
    DTALT              DATE DEFAULT 'now',
    IDUSUALT           CHAR(8) DEFAULT USER,
    HINS               TIME DEFAULT 'now',
    HALT               TIME DEFAULT 'now'
);

CREATE TABLE SGFLUXO (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    CODFLUXO   INTEGER NOT NULL,
    DESCFLUXO  CHAR(50) NOT NULL,
    DTINS      DATE DEFAULT 'now',
    IDUSUINS   CHAR(8) DEFAULT USER,
    DTALT      DATE DEFAULT 'now',
    IDUSUALT   CHAR(8) DEFAULT USER,
    HINS       TIME DEFAULT 'now',
    HALT       TIME DEFAULT 'now'
);

CREATE TABLE SGGATILHO (
    CODEMP    INTEGER NOT NULL,
    CODOBJ    INTEGER NOT NULL,
    DISPGAT   CHAR(2) NOT NULL,
    ATIVOGAT  CHAR(1) DEFAULT 'S' NOT NULL,
    DTINS     DATE DEFAULT 'now',
    IDUSUINS  CHAR(8) DEFAULT USER,
    DTALT     DATE DEFAULT 'now',
    IDUSUALT  CHAR(8) DEFAULT USER,
    HINS      TIME DEFAULT 'now',
    HALT      TIME DEFAULT 'now'
);

CREATE TABLE SGGRAUINST (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    CODGRI     INTEGER NOT NULL,
    DESCGRI    CHAR(50) NOT NULL,
    DTINS      DATE DEFAULT 'now',
    IDUSUINS   CHAR(8) DEFAULT USER,
    DTALT      DATE DEFAULT 'now',
    IDUSUALT   CHAR(8) DEFAULT USER,
    HINS       TIME DEFAULT 'now',
    HALT       TIME DEFAULT 'now'
);

CREATE TABLE SGGRPUSU (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    IDGRPUSU      CHAR(8) NOT NULL,
    NOMEGRPUSU    CHAR(50) NOT NULL,
    COMENTGRPUSU  VARCHAR(10000),
    DTINS         DATE DEFAULT 'now',
    IDUSUINS      CHAR(8) DEFAULT USER,
    DTALT         DATE DEFAULT 'now',
    IDUSUALT      CHAR(8) DEFAULT USER,
    HINS          TIME DEFAULT 'now',
    HALT          TIME DEFAULT 'now'
);

CREATE TABLE SGIMPRESSORA (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODIMP       INTEGER NOT NULL,
    DESCIMP      CHAR(40) NOT NULL,
    TIPOIMP      CHAR(2) NOT NULL,
    LINPAGIMP    INTEGER,
    NSERIEIMP    VARCHAR(20),
    PORTAWINIMP  CHAR(4),
    PORTALINIMP  CHAR(60),
    CODEMPPL     INTEGER,
    CODFILIALPL  SMALLINT,
    CODPAPEL     CHAR(10),
    DESTIMP      CHAR(2) DEFAULT 'TO',
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now'
);

CREATE TABLE SGITFLUXO (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODFLUXO     INTEGER NOT NULL,
    SEQITFLUXO   SMALLINT NOT NULL,
    CODEMPPC     INTEGER NOT NULL,
    CODFILIALPC  SMALLINT NOT NULL,
    CODPROC      INTEGER NOT NULL,
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         DATE DEFAULT 'now',
    HALT         TIME DEFAULT 'now'
);

CREATE TABLE SGITPREFERE6 (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    CODEMPBO      INTEGER NOT NULL,
    CODFILIALBO   SMALLINT NOT NULL,
    CODBANCO      CHAR(3) NOT NULL,
    TIPOFEBRABAN  CHAR(2) NOT NULL,
    MDECOB        CHAR(2) DEFAULT '00' NOT NULL,
    CODCONV       VARCHAR(20),
    CONVCOB       VARCHAR(10),
    VERLAYOUT     VARCHAR(2),
    IDENTSERV     VARCHAR(17),
    CONTACOMPR    VARCHAR(16),
    IDENTAMBCLI   VARCHAR(1),
    IDENTAMBBCO   VARCHAR(1),
    NROSEQ        INTEGER,
    CODEMPCA      INTEGER,
    CODFILIALCA   SMALLINT,
    NUMCONTA      CHAR(10),
    FORCADTIT     SMALLINT DEFAULT 1,
    TIPODOC       SMALLINT DEFAULT 1,
    IDENTEMITBOL  SMALLINT DEFAULT 1,
    IDENTDISTBOL  SMALLINT DEFAULT 1,
    ESPECTIT      SMALLINT DEFAULT 1,
    CODJUROS      SMALLINT DEFAULT 1,
    VLRPERCJUROS  NUMERIC(15,5) DEFAULT 0.0,
    CODDESC       SMALLINT DEFAULT 1,
    VLRPERCDESC   NUMERIC(15,5) DEFAULT 0.0,
    CODPROT       SMALLINT DEFAULT 3,
    DIASPROT      SMALLINT DEFAULT 0,
    CODBAIXADEV   SMALLINT DEFAULT 1,
    DIASBAIXADEV  SMALLINT DEFAULT 1,
    ACEITE        CHAR(1) DEFAULT 'N',
    DTINS         DATE DEFAULT 'now' NOT NULL,
    HINS          TIME DEFAULT 'now' NOT NULL,
    IDUSUINS      CHAR(8) DEFAULT USER NOT NULL,
    DTALT         DATE DEFAULT 'now' NOT NULL,
    HALT          TIME DEFAULT 'now' NOT NULL,
    IDUSUALT      CHAR(8) DEFAULT USER NOT NULL
);

CREATE TABLE SGITPROCESSO (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODPROC      INTEGER NOT NULL,
    SEQITPROC    SMALLINT NOT NULL,
    CODEMPTA     INTEGER NOT NULL,
    CODFILIALTA  SMALLINT NOT NULL,
    CODTAREFA    INTEGER NOT NULL,
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now',
    HALT         DATE DEFAULT 'now'
);

CREATE TABLE SGITTABELA (
    CODEMP      INTEGER NOT NULL,
    CODFILIAL   SMALLINT NOT NULL,
    CODTB       SMALLINT NOT NULL,
    CODITTB     INTEGER NOT NULL,
    DESCITTB    CHAR(50) NOT NULL,
    PADRAOITTB  CHAR(1) DEFAULT 'N' NOT NULL,
    DTINS       DATE DEFAULT 'now',
    IDUSUINS    CHAR(8) DEFAULT USER,
    DTALT       DATE DEFAULT 'now',
    IDUSUALT    CHAR(8) DEFAULT USER,
    HINS        TIME DEFAULT 'now',
    HALT        TIME DEFAULT 'now'
);

CREATE TABLE SGLOG (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODLOG       INTEGER NOT NULL,
    DATALOG      DATE DEFAULT 'now' NOT NULL,
    HORALOG      TIME DEFAULT 'now' NOT NULL,
    CODEMPUS     INTEGER NOT NULL,
    CODFILIALUS  SMALLINT NOT NULL,
    IDUSU        CHAR(8) NOT NULL,
    CLASLOG      CHAR(2) DEFAULT 01 NOT NULL,
    TIPOLOG      CHAR(3) NOT NULL,
    CODEMPCX     INTEGER NOT NULL,
    CODFILIALCX  SMALLINT NOT NULL,
    CODCAIXA     INTEGER NOT NULL,
    DESCLOG      CHAR(60) NOT NULL,
    OBSLOG       VARCHAR(1000)
);

CREATE TABLE SGMENU (
    CODSIS      INTEGER NOT NULL,
    CODMODU     INTEGER NOT NULL,
    CODMENU     INTEGER NOT NULL,
    DESCMENU    CHARMIDDLEDN NOT NULL,
    NOMEMENU    CHARMIDDLEDN NOT NULL,
    PLANOMENU   CHAR(1) DEFAULT 'O' NOT NULL,
    ACAOMENU    CHAR(100) NOT NULL,
    CODSISPAI   INTEGER,
    CODMODUPAI  INTEGER,
    CODMENUPAI  INTEGER,
    DTINS       DATE DEFAULT 'now',
    IDUSUINS    CHAR(8) DEFAULT USER,
    DTALT       DATE DEFAULT 'now',
    IDUSUALT    CHAR(8) DEFAULT USER,
    HINS        TIME DEFAULT 'now',
    HALT        TIME DEFAULT 'now'
);

CREATE TABLE SGMENUOBJ (
    CODEMP    INTEGER NOT NULL,
    IDOBJ     CHAR(30) NOT NULL,
    CODSIS    INTEGER NOT NULL,
    CODMODU   INTEGER NOT NULL,
    CODMENU   INTEGER NOT NULL,
    DTINS     DATE DEFAULT 'now',
    IDUSUINS  CHAR(8) DEFAULT USER,
    DTALT     DATE DEFAULT 'now',
    IDUSUALT  CHAR(8) DEFAULT USER,
    HINS      TIME DEFAULT 'now',
    HALT      TIME DEFAULT 'now'
);

CREATE TABLE SGMODETIQUETA (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    INTEGER NOT NULL,
    CODMODETIQ   INTEGER NOT NULL,
    DESCMODETIQ  CHAR(30) NOT NULL,
    NCOLMODETIQ  SMALLINT DEFAULT 0,
    EECMODETIQ   SMALLINT DEFAULT 0,
    TXAMODETIQ   VARCHAR(1000),
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now',
    CODEMPPL     INTEGER,
    CODFILIALPL  SMALLINT,
    CODPAPEL     CHAR(10),
    COMPRIMIDO   CHAR(1) DEFAULT 'S' NOT NULL,
    POSSCRIPT    CHAR(1) DEFAULT 'N',
    MODETIQ      VARCHAR(30)
);

CREATE TABLE SGMODULO (
    CODSIS      INTEGER NOT NULL,
    CODMODU     INTEGER NOT NULL,
    DESCMODU    CHAR(50) NOT NULL,
    COMENTMODU  VARCHAR(10000),
    DTINS       DATE DEFAULT 'now',
    IDUSUINS    CHAR(8) DEFAULT USER,
    DTALT       DATE DEFAULT 'now',
    IDUSUALT    CHAR(8) DEFAULT USER,
    HINS        TIME DEFAULT 'now',
    HALT        TIME DEFAULT 'now'
);

CREATE TABLE SGMUNICIPIO (
    CODMUNIC   CHAR(5) NOT NULL,
    SIGLAUF    CHAR(2) NOT NULL,
    CODPAIS    SMALLINT NOT NULL,
    NOMEMUNIC  CHAR(80) NOT NULL,
    DDDMUNIC   CHAR(4) NOT NULL
);

CREATE TABLE SGOBJETO (
    CODEMP     INTEGER NOT NULL,
    IDOBJ      CHAR(30) NOT NULL,
    DESCOBJ    CHAR(50) NOT NULL,
    TIPOOBJ    CHAR(2) NOT NULL,
    COMENTOBJ  VARCHAR(10000),
    USOMEOBJ   CHAR(1) DEFAULT 'N',
    SIGLAOBJ   CHAR(8),
    DTINS      DATE DEFAULT 'now',
    IDUSUINS   CHAR(8) DEFAULT USER,
    DTALT      DATE DEFAULT 'now',
    IDUSUALT   CHAR(8) DEFAULT USER,
    HINS       TIME DEFAULT 'now',
    HALT       TIME DEFAULT 'now'
);

CREATE TABLE SGOBJETOTB (
    CODEMP       INTEGER NOT NULL,
    IDOBJ        CHAR(30) NOT NULL,
    CODEMPTB     INTEGER NOT NULL,
    CODFILIALTB  SMALLINT NOT NULL,
    CODTB        SMALLINT NOT NULL,
    OBRIGOBJTB   CHAR(1) DEFAULT 'N' NOT NULL,
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now'
);

CREATE TABLE SGPAIS (
    CODPAIS      SMALLINT NOT NULL,
    NOMEPAIS     CHAR(50) NOT NULL,
    SIGLA3CPAIS  CHAR(3) NOT NULL,
    DDIPAIS      SMALLINT,
    SIGLA2CPAIS  CHAR(2) NOT NULL
);

CREATE TABLE SGPAPEL (
    CODEMP          INTEGER NOT NULL,
    CODFILIAL       SMALLINT NOT NULL,
    CODPAPEL        CHAR(10) NOT NULL,
    DESCPAPEL       CHAR(40),
    LINPAPEL        INTEGER,
    ALTPAPEL        INTEGER,
    LARGPAPEL       INTEGER,
    CLASSNOTAPAPEL  CHAR(20),
    DTINS           DATE DEFAULT 'now',
    IDUSUINS        CHAR(8) DEFAULT USER,
    DTALT           DATE DEFAULT 'now',
    IDUSUALT        CHAR(8) DEFAULT USER,
    HINS            TIME DEFAULT 'now',
    HALT            TIME DEFAULT 'now',
    COLPAPEL        SMALLINT
);

CREATE TABLE SGPREFERE1 (
    CODEMP             INTEGER NOT NULL,
    CODFILIAL          SMALLINT NOT NULL,
    USAREFPROD         CHAR(1) NOT NULL,
    CODTIPOMOV         INTEGER,
    CODEMPTM           SMALLINT,
    CODFILIALTM        SMALLINT,
    USAPEDSEQ          CHAR(1),
    USAORCSEQ          CHAR(1) DEFAULT 'N' NOT NULL,
    FILTRO             CHAR(2),
    USALIQREL          CHAR(1) DEFAULT 'N',
    TIPOPRECOCUSTO     CHAR(1) DEFAULT 'M' NOT NULL,
    ANOCENTROCUSTO     SMALLINT,
    OBSORCPAD          VARCHAR(10000),
    CODTIPOMOV2        INTEGER,
    CODFILIALT2        SMALLINT,
    CODEMPT2           INTEGER,
    CLASSORC           VARCHAR(80),
    TITORCTXT01        CHAR(20),
    CODTIPOMOV3        INTEGER,
    CODFILIALT3        SMALLINT,
    CODEMPT3           INTEGER,
    ORDNOTA            CHAR(1),
    SETORVENDA         CHAR(1) DEFAULT 'C',
    PREFCRED           CHAR(1),
    TIPOPREFCRED       CHAR(2) DEFAULT 'AB' NOT NULL,
    CODEMPMO           INTEGER NOT NULL,
    CODFILIALMO        INTEGER NOT NULL,
    CODMOEDA           CHAR(4) NOT NULL,
    CODTIPOMOV4        INTEGER,
    CODFILIALT4        INTEGER,
    CODEMPT4           INTEGER,
    USACLASCOMIS       CHAR(1),
    PERCPRECOCUSTO     NUMERIC(9,2) DEFAULT 0 NOT NULL,
    CODGRUP            CHAR(14),
    CODFILIALGP        INTEGER,
    CODEMPGP           INTEGER,
    CODMARCA           CHAR(6),
    CODFILIALMC        INTEGER,
    CODEMPMC           INTEGER,
    RGCLIOBRIG         CHAR(1) DEFAULT 'S' NOT NULL,
    TABFRETEVD         CHAR(1) DEFAULT 'S' NOT NULL,
    TABADICVD          CHAR(1) DEFAULT 'S' NOT NULL,
    TRAVATMNFVD        CHAR(1) DEFAULT 'S' NOT NULL,
    TIPOVALIDORC       CHAR(1) DEFAULT 'D',
    CLIMESMOCNPJ       CHAR(1) DEFAULT 'N',
    CODTBJ             INTEGER,
    CODEMPTJ           INTEGER,
    CODFILIALTJ        INTEGER,
    CNPJOBRIGCLI       CHAR(1) DEFAULT 'S' NOT NULL,
    JUROSPOSCALC       CHAR(1),
    CODEMPFR           INTEGER,
    CODFILIALFR        INTEGER,
    CODFOR             INTEGER,
    CODEMPTN           INTEGER,
    CODFILIALTN        SMALLINT,
    CODTRAN            INTEGER,
    CODEMPTF           INTEGER,
    CODFILIALTF        INTEGER,
    CODTIPOFOR         INTEGER,
    CODEMPT5           INTEGER,
    CODFILIALT5        INTEGER,
    CODTIPOMOV5        INTEGER,
    DTINS              DATE DEFAULT 'now',
    IDUSUINS           CHAR(8) DEFAULT USER,
    DTALT              DATE DEFAULT 'now',
    IDUSUALT           CHAR(8) DEFAULT USER,
    HINS               TIME DEFAULT 'now',
    HALT               TIME DEFAULT 'now',
    ESTLOTNEG          CHAR(1) DEFAULT 'N',
    ESTNEG             CHAR(1) DEFAULT 'N',
    NATVENDA           CHAR(1) DEFAULT 'S',
    IPIVENDA           CHAR(1) DEFAULT 'N',
    CUSTOSICMS         CHAR(1) DEFAULT 'S' NOT NULL,
    CODEMPPG           INTEGER,
    CODFILIALPG        SMALLINT,
    CODPLANOPAG        INTEGER,
    CODEMPTB           INTEGER,
    CODFILIALTB        SMALLINT,
    CODTAB             INTEGER,
    CODEMPCE           INTEGER,
    CODFILIALCE        SMALLINT,
    CODCLASCLI         INTEGER,
    CASASDEC           SMALLINT default 2,
    CASASDECFIN        SMALLINT DEFAULT 2,
    COMISPDUPL         CHAR(1) DEFAULT 'S',
    CODEMPT6           INTEGER,
    CODFILIALT6        SMALLINT,
    CODTIPOMOV6        INTEGER,
    BLOQVENDA          CHAR(1) DEFAULT 'S' NOT NULL,
    BLOQCOMPRA         CHAR(1) DEFAULT 'N' NOT NULL,
    VENDAMATPRIM       CHAR(1) DEFAULT 'N' NOT NULL,
    PEPSPROD           CHAR(1) DEFAULT 'N' NOT NULL,
    CNPJFOROBRIG       CHAR(1) DEFAULT 'S' NOT NULL,
    INSCESTFOROBRIG    CHAR(1) DEFAULT 'S' NOT NULL,
    BUSCAPRODSIMILAR   CHAR(1) DEFAULT 'N' NOT NULL,
    MULTIALMOX         CHAR(1) DEFAULT 'N' NOT NULL,
    CODEMPT8           INTEGER,
    CODFILIALT8        SMALLINT,
    CODTIPOMOV8        INTEGER,
    ESTNEGGRUP         CHAR(1) DEFAULT 'N' NOT NULL,
    USATABPE           CHAR(1) DEFAULT 'N' NOT NULL,
    TAMDESCPROD        SMALLINT DEFAULT 50,
    DESCCOMPPED        CHAR(1) DEFAULT 'N' NOT NULL,
    OBSCLIVEND         CHAR(1) DEFAULT 'N' NOT NULL,
    CONTESTOQ          CHAR(1) DEFAULT 'S' NOT NULL,
    DIASPEDT           CHAR(1) DEFAULT 'N' NOT NULL,
    RECALCPCVENDA      CHAR(1) DEFAULT 'N' NOT NULL,
    RECALCPCORC        CHAR(1) DEFAULT 'N' NOT NULL,
    USALAYOUTPED       CHAR(1) DEFAULT 'N' NOT NULL,
    VERIFALTPARCVENDA  CHAR(1) DEFAULT 'N' NOT NULL,
    BUSCACODPRODGEN    CHAR(1) DEFAULT 'N' NOT NULL,
    FILBUSCGENPROD     CHAR(1) DEFAULT 'N' NOT NULL,
    FILBUSCGENREF      CHAR(1) DEFAULT 'N' NOT NULL,
    FILBUSCGENCODBAR   CHAR(1) NOT NULL,
    FILBUSCGENCODFAB   CHAR(1) DEFAULT 'N' NOT NULL,
    BUSCAVLRULTCOMPRA  CHAR(1) DEFAULT 'N' NOT NULL,
    ICMSVENDA          CHAR(1) DEFAULT 'N' NOT NULL,
    USAPRECOZERO       CHAR(1) DEFAULT 'N' NOT NULL,
    USAIMGASSORC       CHAR(1) DEFAULT 'N' NOT NULL,
    IMGASSORC          BLOB SUB_TYPE 0 SEGMENT SIZE 50,
    CONSISTCPFCLI      CHAR(1) DEFAULT 'S' NOT NULL,
    CONSISTEIECLI      CHAR(1) DEFAULT 'S' NOT NULL,
    CONSISTEIEFOR      CHAR(1) DEFAULT 'S' NOT NULL,
    USANOMEVENDORC     CHAR(1) DEFAULT 'N' NOT NULL,
    SISCONTABIL        CHAR(2) DEFAULT '00' NOT NULL,
    ATBANCOIMPBOL      CHAR(1) DEFAULT 'N' NOT NULL,
    TIPOCODBAR         CHAR(1) DEFAULT '1' NOT NULL,
    ADICORCOBSPED      CHAR(1) DEFAULT 'N' NOT NULL,
    CODEMPMENSORC      INTEGER,
    CODFILIALMENSORC   SMALLINT,
    CODMENSORC         INTEGER,
    CUSTOCOMPRA        CHAR(1) DEFAULT 'N' NOT NULL,
    TABTRANSPCP        CHAR(1) DEFAULT 'N' NOT NULL,
    TABSOLCP           CHAR(1) DEFAULT 'N' NOT NULL,
    ADICFRETEBASEICM   CHAR(1) DEFAULT 'N' NOT NULL,
    PRECOCPREL         CHAR(1) DEFAULT 'N' NOT NULL,
    DESCORC            VARCHAR(80),
    MULTICOMIS         CHAR(1) DEFAULT 'N' NOT NULL,
    USUATIVCLI         CHAR(1) DEFAULT 'N' NOT NULL,
    CODEMPHISTREC      INTEGER,
    CODFILIALHISTREC   SMALLINT,
    CODHISTREC         INTEGER,
    CODEMPHISTPAG      INTEGER,
    CODFILIALHISTPAG   SMALLINT,
    CODHISTPAG         INTEGER,
    CODEMPTC           INTEGER,
    CODFILIALTC        SMALLINT,
    CODTIPOCLI         INTEGER,
    ESTITRECALTDTVENC  CHAR(1) DEFAULT 'N' NOT NULL,
    LCREDGLOBAL        CHAR(1) DEFAULT 'S' NOT NULL,
    VDMANUTCOMOBRIG    CHAR(1) DEFAULT 'S' NOT NULL,
    CLASSPED           VARCHAR(80),
    TIPOCLASSPED       CHAR(2) DEFAULT 'QA' NOT NULL,
    USAIBGECLI         CHAR(1) DEFAULT 'N' NOT NULL,
    USAIBGEFOR         CHAR(1) DEFAULT 'N' NOT NULL,
    USAIBGETRANSP      CHAR(1) DEFAULT 'N' NOT NULL,
    SOMAVOLUMES        CHAR(1) DEFAULT 'N' NOT NULL,
    BUSCACEP           CHAR(1) DEFAULT 'N' NOT NULL,
    URLWSCEP           VARCHAR(150),
    CLASSCP            VARCHAR(80),
    LABELOBS01CP       CHAR(40),
    LABELOBS02CP       CHAR(40),
    LABELOBS03CP       CHAR(40),
    LABELOBS04CP       CHAR(40),
    CONSISTEIEPF       CHAR(1) DEFAULT 'N' NOT NULL
);

CREATE TABLE SGPREFERE2 (
    CODFILIAL     INTEGER NOT NULL,
    CODEMP        INTEGER NOT NULL,
    CODTPATENDO   INTEGER,
    CODFILIALTO   INTEGER,
    CODEMPTO      INTEGER,
    CODTPATENDO2  INTEGER,
    CODFILIALT2   INTEGER,
    CODEMPT2      INTEGER,
    CODTPATENDO3  INTEGER,
    CODFILIALT3   INTEGER,
    CODEMPT3      INTEGER,
    CODSETAT      INTEGER,
    CODFILIALSA   INTEGER,
    CODEMPSA      INTEGER,
    CODSETAT2     INTEGER,
    CODFILIALS2   INTEGER,
    CODEMPS2      INTEGER,
    CODEMPAE      INTEGER,
    CODFILIALAE   SMALLINT,
    CODATEND      INTEGER,
    CLASSMEDIDA   CHAR(20),
    CODEMPTI      INTEGER,
    CODFILIALTI   SMALLINT,
    CODTIPOCLI    INTEGER,
    CODEMPCI      INTEGER,
    CODFILIALCI   SMALLINT,
    CODCLASCLI    INTEGER,
    CODEMPTA      INTEGER,
    CODFILIALTA   SMALLINT,
    CODTBA        SMALLINT,
    CODITTBA      INTEGER,
    CODEMPTV      INTEGER,
    CODFILIALTV   SMALLINT,
    CODTBV        SMALLINT,
    CODITTBV      INTEGER,
    CODEMPVD      INTEGER NOT NULL,
    CODFILIALVD   SMALLINT NOT NULL,
    CODVEND       INTEGER NOT NULL,
    CABTERMR01    VARCHAR(1024),
    CABTERMR02    VARCHAR(1024),
    RODTERMR      VARCHAR(1024),
    DTINS         DATE DEFAULT 'now',
    IDUSUINS      CHAR(8) DEFAULT USER,
    DTALT         DATE DEFAULT 'now',
    IDUSUALT      CHAR(8) DEFAULT USER,
    HINS          TIME DEFAULT 'now',
    HALT          TIME DEFAULT 'now'
);

CREATE TABLE SGPREFERE3 (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    INTEGER NOT NULL,
    SMTPMAIL     CHAR(40),
    SMTPSSLMAIL  CHAR(1) DEFAULT 'N',
    SMTPAUTMAIL  CHAR(1) DEFAULT 'N',
    PORTAMAIL    INTEGER DEFAULT 25,
    USERMAIL     CHAR(40),
    PASSMAIL     CHAR(40),
    ENDMAIL      VARCHAR(60),
    CODEMPCE     INTEGER,
    CODFILIALCE  SMALLINT,
    CODATIVCE    INTEGER,
    CODEMPTE     INTEGER,
    CODFILIALTE  SMALLINT,
    CODATIVTE    INTEGER,
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now'
);

CREATE TABLE SGPREFERE4 (
    CODEMP           INTEGER NOT NULL,
    CODFILIAL        INTEGER NOT NULL,
    CODTIPOMOV       INTEGER,
    CODEMPTM         INTEGER,
    CODFILIALTM      INTEGER,
    CODEMPPP         INTEGER,
    CODFILIALPP      SMALLINT,
    CODPLANOPAG      INTEGER,
    CODEMPCL         INTEGER,
    CODFILIALCL      SMALLINT,
    CODCLI           INTEGER,
    CODEMPPD         INTEGER,
    CODFILIALPD      SMALLINT,
    CODPROD          INTEGER,
    PRAZO            SMALLINT,
    DTINS            DATE DEFAULT 'now',
    IDUSUINS         CHAR(8) DEFAULT USER,
    DTALT            DATE DEFAULT 'now',
    IDUSUALT         CHAR(8) DEFAULT USER,
    HINS             TIME DEFAULT 'now',
    HALT             TIME DEFAULT 'now',
    ADICPDV          CHAR(1) DEFAULT 'N' NOT NULL,
    APROVORC         CHAR(1) DEFAULT 'N' NOT NULL,
    DIASVENCORC      INTEGER,
    USABUSCAGENPROD  CHAR(1) DEFAULT 'N' NOT NULL,
    AUTOFECHAVENDA   CHAR(1) DEFAULT 'N' NOT NULL,
    USALOTEORC       CHAR(1) DEFAULT 'N' NOT NULL,
    HABRECEBER       CHAR(1) DEFAULT 'N' NOT NULL
);

CREATE TABLE SGPREFERE5 (
    CODEMP         INTEGER NOT NULL,
    CODFILIAL      INTEGER NOT NULL,
    CLASSOP        CHAR(20),
    NOMERESP       CHAR(50),
    IDENTPROFRESP  CHAR(30),
    CARGORESP      CHAR(30),
    MESESDESCCP    SMALLINT DEFAULT 3 NOT NULL,
    CODTIPOMOV     INTEGER,
    CODEMPTM       SMALLINT,
    CODFILIALTM    SMALLINT,
    SITRMAOP       CHAR(2) DEFAULT 'PE',
    IMGASSRESP     BLOB SUB_TYPE 0 SEGMENT SIZE 50,
    BAIXARMAAPROV  CHAR(1) DEFAULT 'N' NOT NULL,
    RATAUTO        CHAR(1) DEFAULT 'N' NOT NULL,
    APAGARMAOP     CHAR(1) DEFAULT 'N' NOT NULL,
    DTINS          DATE DEFAULT 'now',
    HINS           TIME DEFAULT 'now',
    IDUSUINS       CHAR(8) DEFAULT USER,
    DTALT          DATE DEFAULT 'now',
    HALT           TIME DEFAULT 'now',
    IDUSUALT       CHAR(8) DEFAULT USER
);

CREATE TABLE SGPREFERE6 (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    NOMEEMP      VARCHAR(20) NOT NULL,
    NOMEEMPCNAB  VARCHAR(30) DEFAULT '' NOT NULL,
    DTINS        DATE DEFAULT 'now' NOT NULL,
    HINS         TIME DEFAULT 'now' NOT NULL,
    IDUSUINS     CHAR(8) DEFAULT USER NOT NULL,
    DTALT        DATE DEFAULT 'now' NOT NULL,
    HALT         TIME DEFAULT 'now' NOT NULL,
    IDUSUALT     CHAR(8) DEFAULT USER NOT NULL
);

CREATE TABLE SGPROCESSO (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    CODPROC    INTEGER NOT NULL,
    DESCPROC   CHAR(50) NOT NULL,
    DTINS      DATE DEFAULT 'now',
    IDUSUINS   CHAR(8) DEFAULT USER,
    DTALT      DATE DEFAULT 'now',
    IDUSUALT   CHAR(8) DEFAULT USER,
    HINS       TIME DEFAULT 'now',
    HALT       TIME DEFAULT 'now'
);

CREATE TABLE SGSEQUENCIA (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    SGTAB      CHAR(2) NOT NULL,
    NROSEQ     INTEGER,
    DTINS      DATE DEFAULT 'now',
    IDUSUINS   CHAR(8) DEFAULT USER,
    DTALT      DATE DEFAULT 'now',
    IDUSUALT   CHAR(8) DEFAULT USER,
    HINS       TIME DEFAULT 'now',
    HALT       TIME DEFAULT 'now'
);

CREATE TABLE SGSISTEMA (
    CODSIS     INTEGER NOT NULL,
    DESCSIS    CHAR(50) NOT NULL,
    COMENTSIS  VARCHAR(10000),
    DTINS      DATE DEFAULT 'now',
    IDUSUINS   CHAR(8) DEFAULT USER,
    DTALT      DATE DEFAULT 'now',
    IDUSUALT   CHAR(8) DEFAULT USER,
    HINS       TIME DEFAULT 'now',
    HALT       TIME DEFAULT 'now'
);

CREATE TABLE SGTABELA (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    CODTB      SMALLINT NOT NULL,
    DESCTB     CHAR(50) NOT NULL,
    SIGLATB    CHAR(10),
    DTINS      DATE DEFAULT 'now',
    IDUSUINS   CHAR(8) DEFAULT USER,
    DTALT      DATE DEFAULT 'now',
    IDUSUALT   CHAR(8) DEFAULT USER,
    HINS       TIME DEFAULT 'now',
    HALT       TIME DEFAULT 'now'
);

CREATE TABLE SGTAREFA (
    CODEMP      INTEGER NOT NULL,
    CODFILIAL   SMALLINT NOT NULL,
    CODTAREFA   INTEGER NOT NULL,
    DESCTAREFA  CHAR(50) NOT NULL,
    CODEMPOB    INTEGER NOT NULL,
    CODOBJ      INTEGER NOT NULL,
    TIPOTAREFA  CHAR(2) NOT NULL,
    DTINS       DATE DEFAULT 'now',
    IDUSUINS    CHAR(8) DEFAULT USER,
    DTALT       DATE DEFAULT 'now',
    IDUSUALT    CHAR(8) DEFAULT USER,
    HINS        TIME DEFAULT 'now',
    HALT        TIME DEFAULT 'now'
);

CREATE TABLE SGTIPOAGENDA (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODTIPOAGD   INTEGER NOT NULL,
    DESCTIPOAGD  CHAR(50),
    DTINI        DATE,
    IDUSUINI     CHAR(8),
    HINI         TIME,
    DTALT        DATE,
    IDUSUALT     CHAR(8),
    HALT         TIME
);

CREATE TABLE SGTRATARET (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODPROC      INTEGER NOT NULL,
    SEQITPROC    SMALLINT NOT NULL,
    CODTRATRET   SMALLINT NOT NULL,
    TIPOTRATRET  CHAR(2) NOT NULL,
    CODEMPGT     INTEGER,
    CODFILIALGT  SMALLINT,
    SEQITPROCGT  SMALLINT,
    CODPROCGT    INTEGER,
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now'
);

CREATE TABLE SGUF (
    SIGLAUF   CHAR(2) NOT NULL,
    CODPAIS   SMALLINT NOT NULL,
    NOMEUF    CHAR(80) NOT NULL,
    CODUF     SMALLINT NOT NULL,
    REGIAOUF  CHAR(2) NOT NULL
);

CREATE TABLE SGUSUARIO (
    CODEMP                 INTEGER NOT NULL,
    CODFILIAL              SMALLINT NOT NULL,
    IDUSU                  CHAR(8) NOT NULL,
    NOMEUSU                CHAR(50) NOT NULL,
    CODEMPIG               INTEGER,
    CODFILIALIG            SMALLINT,
    IDGRPUSU               CHAR(8),
    CODEMPCC               INTEGER,
    CODFILIALCC            SMALLINT,
    ANOCC                  SMALLINT,
    CODCC                  CHAR(19),
    PNOMEUSU               CHAR(20),
    UNOMEUSU               CHAR(20),
    COMENTUSU              VARCHAR(10000),
    BAIXOCUSTOUSU          CHAR(1) DEFAULT 'N',
    CODALMOX               INTEGER,
    CODEMPAM               INTEGER,
    CODFILIALAM            SMALLINT,
    ABREGAVETAUSU          CHAR(1) DEFAULT 'S',
    APROVCPSOLICITACAOUSU  CHAR(2) DEFAULT 'ND',
    ALMOXARIFEUSU          CHAR(1) DEFAULT 'N',
    CODEMPAE               INTEGER,
    CODFILIALAE            SMALLINT,
    TIPOAGE                CHAR(5),
    CODAGE                 INTEGER,
    APROVRMAUSU            CHAR(2) DEFAULT 'ND',
    COMPRASUSU             CHAR(1) DEFAULT 'N',
    ALTPARCVENDA           CHAR(1) DEFAULT 'N',
    APROVRECEITA           CHAR(1) DEFAULT 'N',
    ATIVCLI                CHAR(1) DEFAULT 'N' NOT NULL,
    LIBERACREDUSU          CHAR(1) DEFAULT 'N' NOT NULL
);

CREATE TABLE SGVARIAVEL (
    IDVAR       CHAR(18) NOT NULL,
    IDCON       INTEGER NOT NULL,
    VLRINTEGER  INTEGER,
    VLRCHAR1    CHAR(20),
    VLRCHAR2    CHAR(50),
    VLRDECIMAL  NUMERICDN,
    DTINS       DATE DEFAULT 'now',
    IDUSUINS    CHAR(8) DEFAULT USER,
    DTALT       DATE DEFAULT 'now',
    IDUSUALT    CHAR(8) DEFAULT USER,
    HINS        TIME DEFAULT 'now',
    HALT        TIME DEFAULT 'now'
);

CREATE TABLE SVAVALIACAO (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    CODOS         INTEGER NOT NULL,
    CODITOS       SMALLINT NOT NULL,
    CODAVAL       SMALLINT NOT NULL,
    CODEMPPD      INTEGER NOT NULL,
    CODFILIALPD   SMALLINT NOT NULL,
    CODPROD       INTEGER NOT NULL,
    REFPROD       CHAR(13) NOT NULL,
    QTDAVAL       NUMERICDN NOT NULL,
    PRECOAVAL     NUMERICDN NOT NULL,
    VLRTOTAVAL    NUMERICDN NOT NULL,
    VLRDESCAVAL   NUMERICDN NOT NULL,
    VLRLIQAVAL    NUMERICDN NOT NULL,
    SITAVAL       CHAR(2) NOT NULL,
    SITAPROVAVAL  CHAR(2) NOT NULL
);

CREATE TABLE SVEXECUCAO (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODOS        INTEGER NOT NULL,
    CODITOS      INTEGER NOT NULL,
    CODEXEC      SMALLINT NOT NULL,
    CODEMPPD     INTEGER NOT NULL,
    CODFILIALPD  SMALLINT NOT NULL,
    CODPROD      INTEGER NOT NULL,
    REFPROD      CHAR(13) NOT NULL,
    SITEXEC      CHAR(2) NOT NULL,
    QTDEXEC      NUMERICDN NOT NULL,
    PRECOEXEC    NUMERICDN NOT NULL,
    VLRTOTEXEC   NUMERICDN NOT NULL,
    VLRDESCEXEC  NUMERICDN NOT NULL,
    VLRLIQEXEC   NUMERICDN NOT NULL,
    DTEXEC       DATE,
    OBSEXEC      VARCHAR(1000)
);

CREATE TABLE SVITOS (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODOS        INTEGER NOT NULL,
    CODITOS      SMALLINT NOT NULL,
    CODEMPPD     INTEGER NOT NULL,
    CODFILIALPD  SMALLINT NOT NULL,
    CODPROD      INTEGER NOT NULL,
    REFPROD      CHAR(13) NOT NULL,
    QTDITOS      NUMERICDN NOT NULL,
    PRECOITOS    NUMERICDN NOT NULL,
    SITITOS      CHAR(2) NOT NULL,
    OBSITOS      VARCHAR(1000)
);

CREATE TABLE SVOS (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODOS        INTEGER NOT NULL,
    CODEMPCL     INTEGER NOT NULL,
    CODFILIALCL  SMALLINT NOT NULL,
    CODCLI       INTEGER NOT NULL,
    DTENTOS      DATE NOT NULL,
    SITOS        CHAR(2) NOT NULL,
    CODEMPCV     INTEGER,
    CODFILIALCV  SMALLINT,
    CODCONV      INTEGER,
    DTPREVOS     DATE,
    DTSAIOS      DATE,
    DESCOS       VARCHAR(1000),
    OBSOS        VARCHAR(1000)
);

CREATE TABLE TKATIVIDADE (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    CODATIV    INTEGER NOT NULL,
    DESCATIV   CHAR(50) NOT NULL,
    DTINS      DATE DEFAULT 'now',
    IDUSUINS   CHAR(8) DEFAULT USER,
    DTALT      DATE DEFAULT 'now',
    IDUSUALT   CHAR(8) DEFAULT USER,
    HINS       TIME DEFAULT 'now',
    HALT       TIME DEFAULT 'now'
);

CREATE TABLE TKCAMPANHA (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    CODCAMP    CHAR(13) NOT NULL,
    DESCCAMP   CHAR(80) NOT NULL,
    OBSCAMP    VARCHAR(500),
    DTINS      DATE DEFAULT 'now',
    IDUSUINS   CHAR(8) DEFAULT USER,
    DTALT      DATE DEFAULT 'now',
    IDUSUALT   CHAR(8) DEFAULT USER,
    HINS       TIME DEFAULT 'now',
    HALT       TIME DEFAULT 'now'
);

CREATE TABLE TKCAMPANHACTO (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODCAMP      CHAR(13) NOT NULL,
    CODEMPCO     INTEGER NOT NULL,
    CODFILIALCO  SMALLINT NOT NULL,
    CODCTO       INTEGER NOT NULL,
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now'
);

CREATE TABLE TKCAMPANHAEMAIL (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODCAMP      CHAR(13) NOT NULL,
    CODEMPEM     INTEGER NOT NULL,
    CODFILIALEM  SMALLINT NOT NULL,
    CODEMAIL     INTEGER NOT NULL,
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now'
);

CREATE TABLE TKCONFEMAIL (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    CODCONFEMAIL  INTEGER NOT NULL,
    EMAILREMET    VARCHAR(60) NOT NULL,
    NOMEREMET     CHAR(50) NOT NULL,
    USUARIOREMET  CHAR(40) NOT NULL,
    SENHAREMET    CHAR(40),
    EMAILRESP     VARCHAR(60) NOT NULL,
    HOSTSMTP      CHAR(40) NOT NULL,
    USASSL        CHAR(1) DEFAULT 'N' NOT NULL,
    USAAUTSMTP    CHAR(1) DEFAULT 'N' NOT NULL,
    PORTASMTP     INTEGER DEFAULT 25 NOT NULL,
    DTINS         DATE DEFAULT 'now',
    IDUSUINS      CHAR(8) DEFAULT USER,
    DTALT         DATE DEFAULT 'now',
    IDUSUALT      CHAR(8) DEFAULT USER,
    HINS          TIME DEFAULT 'now',
    HALT          TIME DEFAULT 'now'
);

CREATE TABLE TKCONTATO (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    CODCTO        INTEGER NOT NULL,
    RAZCTO        CHAR(50) NOT NULL,
    CODEMPVD      INTEGER,
    CODFILIALVD   SMALLINT,
    CODVEND       INTEGER,
    CODEMPSR      INTEGER NOT NULL,
    CODFILIALSR   SMALLINT NOT NULL,
    CODSETOR      INTEGER NOT NULL,
    NOMECTO       CHAR(50) NOT NULL,
    DATACTO       DATE DEFAULT 'today' NOT NULL,
    PESSOACTO     CHAR(1) NOT NULL,
    ATIVOCTO      CHAR(1) NOT NULL,
    CNPJCTO       CHAR(14),
    INSCCTO       CHAR(15),
    CPFCTO        CHAR(11),
    RGCTO         CHAR(10),
    ENDCTO        CHAR(50),
    NUMCTO        INTEGER,
    COMPLCTO      CHAR(20),
    BAIRCTO       CHAR(30),
    CIDCTO        CHAR(30),
    UFCTO         CHAR(2),
    CEPCTO        CHAR(8),
    DDDCTO        CHAR(4),
    FONECTO       CHAR(12),
    FAXCTO        CHAR(8),
    EMAILCTO      CHAR(50),
    CONTCTO       CHAR(40),
    CARGOCONTCTO  CHAR(30),
    OBSCTO        VARCHAR(10000),
    REMOVCTO      CHAR(1) DEFAULT 'N' NOT NULL,
    CODEMPTI      INTEGER,
    CODFILIALTI   SMALLINT,
    CODTPIMP      INTEGER,
    CODEMPSO      INTEGER,
    CODFILIALSO   SMALLINT,
    CODSETORCTO   INTEGER,
    NUMEMPCTO     INTEGER,
    CODMUNIC      CHAR(5),
    SIGLAUF       CHAR(2),
    CODPAIS       SMALLINT,
    CODEMPTC      INTEGER NOT NULL,
    CODFILIALTC   SMALLINT NOT NULL,
    CODTIPOCLI    INTEGER NOT NULL,
    CODEMPOC      INTEGER NOT NULL,
    CODFILIALOC   SMALLINT NOT NULL,
    CODORIGCONT   INTEGER NOT NULL,
    DTINS         DATE DEFAULT 'now',
    IDUSUINS      CHAR(8) DEFAULT USER,
    DTALT         DATE DEFAULT 'now',
    IDUSUALT      CHAR(8) DEFAULT USER,
    HINS          TIME DEFAULT 'now',
    HALT          TIME DEFAULT 'now'
);

CREATE TABLE TKCTOATIV (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODCTO       INTEGER NOT NULL,
    CODEMPAV     INTEGER NOT NULL,
    CODFILIALAV  SMALLINT NOT NULL,
    CODATIV      INTEGER NOT NULL,
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now'
);

CREATE TABLE TKCTOGRPINT (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODCTO       INTEGER NOT NULL,
    CODEMPGP     INTEGER NOT NULL,
    CODFILIALGP  SMALLINT NOT NULL,
    CODGRUP      CHAR(14) NOT NULL,
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now'
);

CREATE TABLE TKEMAIL (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    CODEMAIL      INTEGER NOT NULL,
    DESCEMAIL     CHAR(50) NOT NULL,
    ASSUNTO       VARCHAR(120) NOT NULL,
    CORPO         VARCHAR(20000) NOT NULL,
    FORMATO       CHAR(10) DEFAULT 'text/plain' NOT NULL,
    CHARSET       CHAR(10) DEFAULT 'iso-8859-1' NOT NULL,
    CODEMPCM      INTEGER NOT NULL,
    CODFILIALCM   SMALLINT NOT NULL,
    CODCONFEMAIL  INTEGER NOT NULL,
    DTINS         DATE DEFAULT 'now',
    IDUSUINS      CHAR(8) DEFAULT USER,
    DTALT         DATE DEFAULT 'now',
    IDUSUALT      CHAR(8) DEFAULT USER,
    HINS          TIME DEFAULT 'now',
    HALT          TIME DEFAULT 'now'
);

CREATE TABLE TKHISTORICO (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODHISTTK    INTEGER NOT NULL,
    DATAHISTTK   DATE NOT NULL,
    HORAHISTTK   TIME NOT NULL,
    CODEMPCO     INTEGER,
    CODFILIALCO  SMALLINT,
    CODCTO       INTEGER,
    CODEMPCL     INTEGER,
    CODFILIALCL  SMALLINT,
    CODCLI       INTEGER,
    DESCHISTTK   VARCHAR(10000) NOT NULL,
    CODEMPAE     INTEGER NOT NULL,
    CODFILIALAE  SMALLINT NOT NULL,
    CODATEND     INTEGER NOT NULL,
    SITHISTTK    CHAR(2) NOT NULL,
    TIPOHISTTK   CHAR(1) DEFAULT 'H',
    CODEMPCA     INTEGER,
    CODFILIALCA  SMALLINT,
    CODCAMP      CHAR(13),
    SEQSITCAMP   SMALLINT,
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    IDUSUALT     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now'
);

CREATE TABLE TKORIGCONT (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    CODORIGCONT   INTEGER NOT NULL,
    DESCORIGCONT  CHAR(40) NOT NULL,
    DTINS         DATE DEFAULT 'now',
    IDUSUINS      CHAR(8) DEFAULT USER,
    DTALT         DATE DEFAULT 'now',
    IDUSUALT      CHAR(8) DEFAULT USER,
    HINS          TIME DEFAULT 'now',
    HALT          TIME DEFAULT 'now'
);

CREATE TABLE TKSETORCTO (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    CODSETORCTO   INTEGER NOT NULL,
    DESCSETORCTO  CHAR(50) NOT NULL,
    DTINS         DATE DEFAULT 'now',
    IDUSUINS      CHAR(8) DEFAULT USER,
    DTALT         DATE DEFAULT 'now',
    IDUSUALT      CHAR(8) DEFAULT USER,
    HINS          TIME DEFAULT 'now',
    HALT          TIME DEFAULT 'now'
);

CREATE TABLE TKSITCAMP (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODCAMP      CHAR(13) NOT NULL,
    CODEMPCO     INTEGER NOT NULL,
    CODFILIALCO  SMALLINT NOT NULL,
    CODCTO       INTEGER NOT NULL,
    SEQSITCAMP   INTEGER NOT NULL,
    CODEMPAV     INTEGER NOT NULL,
    CODFILIALAV  SMALLINT NOT NULL,
    CODATIV      INTEGER NOT NULL,
    DTSITCAMP    DATE DEFAULT 'now' NOT NULL,
    HRSITCAMP    TIME DEFAULT 'now' NOT NULL
);

CREATE TABLE TKTIPOIMP (
    CODEMP         INTEGER NOT NULL,
    CODFILIAL      SMALLINT NOT NULL,
    CODTPIMP       INTEGER NOT NULL,
    DESCTPIMP      CHAR(50) NOT NULL,
    TRANSBINTPIMP  CHAR(1) DEFAULT 'N' NOT NULL,
    CSEPTPIMP      CHAR(1) DEFAULT 'N' NOT NULL,
    ENTERLNTPIMP   CHAR(1) DEFAULT 'S' NOT NULL,
    SEPTPIMP       CHAR(10),
    LAYOUTTPIMP    VARCHAR(256),
    DELCRTTPIMP    SMALLINT,
    DTINS          DATE DEFAULT 'now',
    IDUSUINS       CHAR(8) DEFAULT USER,
    DTALT          DATE DEFAULT 'now',
    IDUSUALT       CHAR(8) DEFAULT USER,
    HINS           TIME DEFAULT 'now',
    HALT           TIME DEFAULT 'now'
);

CREATE TABLE VDAUXVENDA (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    TIPOVENDA    CHAR(1) NOT NULL,
    CODVENDA     INTEGER NOT NULL,
    CODAUXV      SMALLINT NOT NULL,
    CPFCLIAUXV   CHAR(11),
    NOMECLIAUXV  CHAR(50),
    ENDCLIAUXV   CHAR(50),
    NUMCLIAUXV   INTEGER,
    CIDCLIAUXV   CHAR(30),
    UFCLIAUXV    CHAR(2),
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now'
);

CREATE TABLE VDCLASCLI (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    CODCLASCLI    INTEGER NOT NULL,
    DESCCLASCLI   CHAR(40) NOT NULL,
    DTINS         DATE DEFAULT 'now',
    IDUSUINS      CHAR(8) DEFAULT USER,
    DTALT         DATE DEFAULT 'now',
    IDUSUALT      CHAR(8) DEFAULT USER,
    HINS          TIME DEFAULT 'now',
    HALT          TIME DEFAULT 'now',
    SIGLACLASCLI  CHAR(3)
);

CREATE TABLE VDCLCOMIS (
    CODEMP           INTEGER NOT NULL,
    CODFILIAL        INTEGER NOT NULL,
    CODCLCOMIS       INTEGER NOT NULL,
    DESCCLCOMIS      CHAR(50) NOT NULL,
    PERCFATCLCOMIS   NUMERIC(9,2),
    PERCPGTOCLCOMIS  NUMERIC(9,2)
);

CREATE TABLE VDCLIAUTP (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    CODCLI     INTEGER NOT NULL,
    CODAUTP    SMALLINT NOT NULL,
    NOMEAUTP   CHAR(50) NOT NULL,
    ENDAUTP    CHAR(50),
    NUMAUTP    INTEGER,
    COMPLAUTP  CHAR(30),
    BAIRAUTP   CHAR(30),
    CIDAUTP    CHAR(30),
    UFAUTP     CHAR(2),
    CEPAUTP    CHAR(8),
    DDDAUTP    CHAR(4),
    FONEAUTP   CHAR(12),
    RGAUTP     CHAR(10),
    SSPAUTP    CHAR(10),
    CPFAUTP    CHAR(11),
    FUNCAUTP   CHAR(30)
);

CREATE TABLE VDCLICOMPL (
    CODEMP            INTEGER NOT NULL,
    CODFILIAL         SMALLINT NOT NULL,
    CODCLI            INTEGER NOT NULL,
    PAICLI            CHAR(50),
    MAECLI            CHAR(50),
    RGPAICLI          CHAR(10),
    SSPPAICLI         CHAR(10),
    RGMAECLI          CHAR(10),
    SSPMAECLI         CHAR(10),
    EMPTRABCLI        CHAR(50),
    CARGOTRABCLI      CHAR(20),
    DTADMTRABCLI      DATE,
    RENDATRABCLI      NUMERICDN,
    DDDTRABCLI        CHAR(4),
    FONETRABCLI       CHAR(8),
    ENDTRABCLI        CHAR(50),
    NUMTRABCLI        INTEGER,
    BAIRTRABCLI       CHAR(30),
    CIDTRABCLI        CHAR(30),
    UFTRABCLI         CHAR(2),
    OUTRENDACLI       NUMERICDN,
    FONTRENDACLI      CHAR(50),
    NOMECONJCLI       CHAR(50),
    DTNASCCONJCLI     DATE,
    RENDACONJCLI      NUMERICDN,
    COMPLTRABCLI      CHAR(20),
    CEPTRABCLI        CHAR(8),
    RAMALTRABCLI      CHAR(8),
    RGCONJCLI         CHAR(10),
    SSPCONJCLI        CHAR(10),
    CPFCONJCLI        CHAR(11),
    NATCONJCLI        CHAR(30),
    UFNATCONJCLI      CHAR(2),
    CARGOCONJCLI      CHAR(20),
    EMPTRABCONJCLI    CHAR(50),
    DTADMTRABCONJCLI  DATE,
    NOMEAVALCLI       CHAR(50),
    DTNASCAVALCLI     DATE,
    RGAVALCLI         CHAR(10),
    SSPAVALCLI        CHAR(10),
    CPFAVALCLI        CHAR(11),
    ENDAVALCLI        CHAR(50),
    NUMAVALCLI        INTEGER,
    BAIRAVALCLI       CHAR(30),
    CIDVALCLI         CHAR(30),
    CEPAVALCLI        CHAR(8),
    UFAVALCLI         CHAR(2),
    DDDAVALCLI        CHAR(4),
    FONEAVALCLI       CHAR(8),
    EMPTRABAVALCLI    CHAR(50),
    DTADMTRABAVALCLI  DATE,
    CARGOAVALCLI      CHAR(20),
    RENDAAVALCLI      NUMERICDN,
    DTFUNDACCLI       DATE,
    RAMOATIVCLI       CHAR(50),
    NUMFILIAISCLI     SMALLINT,
    NUMFUNCCLI        INTEGER,
    COMPRAREQCLI      CHAR(1) DEFAULT 'S',
    FATURCLI          NUMERICDN
);

CREATE TABLE VDCLICONTAS (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODCLI       INTEGER NOT NULL,
    CODEMPBC     INTEGER,
    CODFILIALBC  SMALLINT,
    CODBANCO     CHAR(3),
    CONTA        CHAR(20) NOT NULL,
    DTABCONTA    DATE,
    AGENCIA      CHAR(30)
);

CREATE TABLE VDCLIENTE (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    CODCLI        INTEGER NOT NULL,
    RAZCLI        CHAR(50) NOT NULL,
    NOMECLI       CHAR(50) NOT NULL,
    CODEMPCC      INTEGER,
    CODFILIALCC   SMALLINT,
    CODCLASCLI    INTEGER,
    CODEMPVD      INTEGER,
    CODFILIALVD   SMALLINT,
    CODVEND       INTEGER,
    CODEMPTC      INTEGER,
    CODFILIALTC   SMALLINT,
    CODTIPOCOB    INTEGER,
    CODEMPPG      INTEGER,
    CODFILIALPG   SMALLINT,
    CODPLANOPAG   INTEGER,
    CODEMPTN      INTEGER,
    CODFILIALTN   SMALLINT,
    CODTRAN       INTEGER,
    CODEMPBO      INTEGER,
    CODFILIALBO   SMALLINT,
    CODBANCO      CHAR(3),
    CODEMPSR      INTEGER,
    CODFILIALSR   SMALLINT,
    CODSETOR      INTEGER,
    CODEMPTI      INTEGER NOT NULL,
    CODFILIALTI   SMALLINT NOT NULL,
    CODTIPOCLI    INTEGER NOT NULL,
    CODTPCRED     INTEGER,
    CODFILIALTR   INTEGER,
    CODEMPTR      INTEGER,
    CODFISCCLI    INTEGER,
    CODEMPFC      INTEGER,
    CODFILIALFC   INTEGER,
    CODEMPEC      INTEGER,
    CODFILIALEC   SMALLINT,
    CODTBEC       SMALLINT,
    CODITTBEC     INTEGER,
    CODEMPHP      INTEGER,
    CODFILIALHP   SMALLINT,
    CODHIST       INTEGER,
    CODEMPCB      INTEGER,
    CODFILIALCB   SMALLINT,
    CODCARTCOB    CHAR(2),
    DATACLI       DATE DEFAULT 'today' NOT NULL,
    PESSOACLI     CHAR(1) NOT NULL,
    ATIVOCLI      CHAR(1) NOT NULL,
    CNPJCLI       CHAR(14),
    INSCCLI       VARCHAR(20),
    CPFCLI        CHAR(11),
    RGCLI         CHAR(10),
    SSPCLI        CHAR(10),
    ENDCLI        CHAR(50),
    NUMCLI        INTEGER,
    COMPLCLI      CHAR(20),
    BAIRCLI       CHAR(30),
    CIDCLI        CHAR(30),
    UFCLI         CHAR(2),
    CEPCLI        CHAR(8),
    DDDCLI        CHAR(4),
    FONECLI       CHAR(12),
    RAMALCLI      CHAR(6),
    DDDFAXCLI     CHAR(4),
    FAXCLI        CHAR(8),
    EMAILCLI      CHAR(50),
    CONTCLI       CHAR(40),
    ENDCOB        CHAR(50),
    NUMCOB        INTEGER,
    COMPLCOB      CHAR(20),
    BAIRCOB       CHAR(30),
    CIDCOB        CHAR(30),
    UFCOB         CHAR(2),
    CEPCOB        CHAR(8),
    DDDFONECOB    CHAR(4),
    FONECOB       CHAR(12),
    DDDFAXCOB     CHAR(4),
    FAXCOB        CHAR(8),
    ENDENT        CHAR(50),
    NUMENT        INTEGER,
    COMPLENT      CHAR(20),
    BAIRENT       CHAR(30),
    CIDENT        CHAR(30),
    UFENT         CHAR(2),
    CEPENT        CHAR(8),
    DDDFONEENT    CHAR(4),
    FONEENT       CHAR(12),
    DDDFAXENT     CHAR(4),
    FAXENT        CHAR(8),
    OBSCLI        VARCHAR(10000),
    AGENCIACLI    CHAR(6),
    CODEMPPQ      INTEGER,
    CODFILIALPQ   SMALLINT,
    CODPESQ       INTEGER,
    INCRACLI      CHAR(15),
    DTINITR       DATE,
    DTVENCTOTR    DATE,
    NIRFCLI       CHAR(15),
    SIMPLESCLI    CHAR(1),
    DDDCELCLI     CHAR(4),
    CELCLI        CHAR(8),
    NATCLI        CHAR(30),
    UFNATCLI      CHAR(2),
    TEMPORESCLI   CHAR(20),
    APELIDOCLI    CHAR(30),
    SITECLI       CHAR(50),
    CODCONTDEB    VARCHAR(20),
    CODCONTCRED   VARCHAR(20),
    CODCLICONTAB  VARCHAR(20),
    FOTOCLI       BLOB SUB_TYPE 0 SEGMENT SIZE 50,
    IMGASSCLI     BLOB SUB_TYPE 0 SEGMENT SIZE 50,
    CODMUNIC      CHAR(5),
    SIGLAUF       CHAR(2),
    CODPAIS       SMALLINT,
    CODMUNICENT   CHAR(5),
    SIGLAUFENT    CHAR(2),
    CODPAISENT    SMALLINT,
    CODMUNICCOB   CHAR(5),
    SIGLAUFCOB    CHAR(2),
    CODPAISCOB    SMALLINT,
    DTINS         DATE DEFAULT 'now',
    IDUSUINS      CHAR(8) DEFAULT USER,
    DTALT         DATE DEFAULT 'now',
    IDUSUALT      CHAR(8) DEFAULT user,
    HINS          TIME DEFAULT 'now',
    HALT          TIME DEFAULT 'now'
);

CREATE TABLE VDCLIENTEFOR (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODCLI       INTEGER NOT NULL,
    CODEMPFR     INTEGER NOT NULL,
    CODFILIALFR  SMALLINT NOT NULL,
    CODFOR       INTEGER NOT NULL,
    CODCLIFOR    INTEGER,
    CODCPCLIFOR  CHAR(10),
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now'
);

CREATE TABLE VDCLIIMOV (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODCLI       INTEGER NOT NULL,
    CODIMOV      SMALLINT NOT NULL,
    TIPOIMOV     CHAR(30),
    CONSTRIMOV   CHAR(30),
    AREATERIMOV  CHAR(30),
    VALORIMOV    NUMERICDN
);

CREATE TABLE VDCLIMETAVEND (
    CODCLI       INTEGER NOT NULL,
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    ANOMETAVEND  SMALLINT NOT NULL,
    VLRMETAVEND  NUMERICDN NOT NULL,
    OBSMETAVEND  VARCHAR(500)
);

CREATE TABLE VDCLIREFC (
    CODEMP          INTEGER NOT NULL,
    CODFILIAL       SMALLINT NOT NULL,
    CODCLI          INTEGER NOT NULL,
    CODREFC         SMALLINT NOT NULL,
    NOMEEMPREFC     CHAR(50) NOT NULL,
    DDDREFC         CHAR(4),
    FONEREFC        CHAR(12),
    DTMAIORCP       DATE,
    VLRMAIORCP      NUMERICDN,
    NROPARCMAIORCP  SMALLINT,
    DTULTCP         DATE,
    VLRULTCP        NUMERICDN,
    NROPARCULTCP    SMALLINT,
    DTPRIMCP        DATE,
    PONTUAL         CHAR(1),
    MEDIAATRASO     CHAR(20),
    CONCEITO        CHAR(30),
    AVALISTA        CHAR(1),
    INFORMANTE      CHAR(50),
    OBSREFC         VARCHAR(500)
);

CREATE TABLE VDCLIREFP (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    CODCLI     INTEGER NOT NULL,
    NOMEREFP   CHAR(50) NOT NULL,
    ENDREFP    CHAR(50),
    NUMREFP    INTEGER,
    COMPLREFP  CHAR(30),
    BAIRREFP   CHAR(30),
    CIDREFP    CHAR(30),
    UFREFP     CHAR(2),
    CEPREFP    CHAR(8),
    DDDREFP    CHAR(4),
    FONEREFP   CHAR(12),
    CODREFP    SMALLINT NOT NULL
);

CREATE TABLE VDCLISOCIOS (
    CODEMP          INTEGER NOT NULL,
    CODFILIAL       SMALLINT NOT NULL,
    CODCLI          INTEGER NOT NULL,
    NOMESOCIO       CHAR(50) NOT NULL,
    DTNASCSOCIO     DATE,
    RGSOCIO         CHAR(10),
    SSPSOCIO        CHAR(10),
    CPFSOCIO        CHAR(11),
    PERCCOTASSOCIO  INTEGER
);

CREATE TABLE VDCLITERRA (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    CODCLI        INTEGER NOT NULL,
    CODTERRA      SMALLINT NOT NULL,
    ENDTERRA      CHAR(50),
    NUMTERRA      INTEGER,
    BAIRTERRA     CHAR(30),
    CIDTERRA      CHAR(30),
    UFTERRA       CHAR(2),
    AREATERRA     CHAR(30),
    QTDCAFETERRA  INTEGER,
    QTDGADOTERRA  INTEGER,
    OBSTERRA      VARCHAR(500)
);

CREATE TABLE VDCLIVEIC (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    CODCLI        INTEGER NOT NULL,
    PLACAVEIC     CHAR(10) NOT NULL,
    MODELOVEIC    CHAR(50),
    ALIENADOVEIC  CHAR(30),
    ANOVEIC       SMALLINT,
    VALORVEIC     NUMERICDN
);

CREATE TABLE VDCOMISSAO (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    CODCOMI       INTEGER NOT NULL,
    TIPOCOMI      CHAR(1) DEFAULT 'F' NOT NULL,
    CODEMPRC      INTEGER NOT NULL,
    CODFILIALRC   SMALLINT NOT NULL,
    CODREC        INTEGER NOT NULL,
    NPARCITREC    INTEGER NOT NULL,
    VLRVENDACOMI  NUMERICDN NOT NULL,
    VLRCOMI       NUMERICDN DEFAULT 0 NOT NULL,
    VLRPAGOCOMI   NUMERICDN DEFAULT 0 NOT NULL,
    VLRAPAGCOMI   NUMERICDN DEFAULT 0 NOT NULL,
    DATACOMI      DATE NOT NULL,
    DTVENCCOMI    DATE NOT NULL,
    DTPAGTOCOMI   DATE,
    STATUSCOMI    CHAR(2) NOT NULL,
    CODEMPCI      INTEGER,
    CODFILIALCI   SMALLINT,
    CODPCOMI      INTEGER,
    FLAG          CHAR(1) DEFAULT 'N',
    CODEMPCT      INTEGER,
    CODFILIALCT   SMALLINT,
    CODPCOMIANT   INTEGER,
    CODEMPVD      INTEGER,
    CODFILIALVD   SMALLINT,
    CODVEND       INTEGER,
    DTINS         DATE DEFAULT 'now',
    IDUSUINS      CHAR(8) DEFAULT USER,
    DTALT         DATE DEFAULT 'now',
    IDUSUALT      CHAR(8) DEFAULT USER,
    HINS          TIME DEFAULT 'now',
    HALT          TIME DEFAULT 'now'
);

CREATE TABLE VDCONTRATO (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    CODCONTR      INTEGER NOT NULL,
    DESCCONTR     CHAR(80) NOT NULL,
    MINUTACONTR   VARCHAR(32000) NOT NULL,
    CODEMPCL      INTEGER NOT NULL,
    CODFILIALCL   SMALLINT NOT NULL,
    CODCLI        INTEGER NOT NULL,
    DTINICIO      DATE NOT NULL,
    DTFIM         DATE NOT NULL,
    TPCOBCONTR    CHAR(2) NOT NULL,
    DIAVENCCONTR  SMALLINT,
    DIAFECHCONTR  SMALLINT,
    DTINS         DATE DEFAULT 'now',
    IDUSUINS      CHAR(8) DEFAULT USER,
    DTALT         DATE DEFAULT 'now',
    IDUSUALT      CHAR(8) DEFAULT USER,
    HINS          TIME DEFAULT 'now',
    HALT          TIME DEFAULT 'now'
);

CREATE TABLE VDETIQCLI (
    NRCONEXAO  INTEGER NOT NULL,
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    CODCLI     INTEGER NOT NULL
);

CREATE TABLE VDFOTOPROD (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    CODPROD       INTEGER NOT NULL,
    CODFOTOPROD   INTEGER NOT NULL,
    DESCFOTOPROD  CHAR(40) NOT NULL,
    TIPOFOTOPROD  CHAR(1) NOT NULL,
    LARGFOTOPROD  INTEGER NOT NULL,
    ALTFOTOPROD   INTEGER NOT NULL,
    FOTOPROD      BLOB SUB_TYPE 0 SEGMENT SIZE 50 NOT NULL,
    DTINS         DATE DEFAULT 'now',
    IDUSUINS      CHAR(8) DEFAULT USER,
    DTALT         DATE DEFAULT 'now',
    IDUSUALT      CHAR(8) DEFAULT USER,
    HINS          TIME DEFAULT 'now',
    HALT          TIME DEFAULT 'now'
);

CREATE TABLE VDFRETEVD (
    CODEMP            INTEGER NOT NULL,
    CODFILIAL         SMALLINT NOT NULL,
    TIPOVENDA         CHAR(1) DEFAULT 'V' NOT NULL,
    CODVENDA          INTEGER NOT NULL,
    CODEMPTN          INTEGER,
    CODFILIALTN       SMALLINT,
    CODTRAN           INTEGER,
    TIPOFRETEVD       CHAR(1) NOT NULL,
    PLACAFRETEVD      CHAR(10) NOT NULL,
    UFFRETEVD         CHAR(2) NOT NULL,
    VLRFRETEVD        NUMERICDN NOT NULL,
    QTDFRETEVD        NUMERICDN NOT NULL,
    PESOBRUTVD        NUMERICDN NOT NULL,
    PESOLIQVD         NUMERICDN NOT NULL,
    ESPFRETEVD        CHAR(10) NOT NULL,
    MARCAFRETEVD      CHAR(10) NOT NULL,
    CONHECFRETEVD     CHAR(13),
    PERCVENDAFRETEVD  NUMERIC(9,2),
    FLAG              CHAR(1) DEFAULT 'N',
    ADICFRETEVD       CHAR(1) DEFAULT 'N' NOT NULL,
    DTINS             DATE DEFAULT 'now',
    IDUSUINS          CHAR(8) DEFAULT USER,
    DTALT             DATE DEFAULT 'now',
    IDUSUALT          CHAR(8) DEFAULT USER,
    HINS              TIME DEFAULT 'now',
    HALT              TIME DEFAULT 'now',
    ADICFRETEBASEICM  CHAR(1) DEFAULT 'N' NOT NULL,
    ALIQICMSFRETEVD   NUMERICDN,
    VLRICMSFRETEVD    NUMERICDN
);

CREATE TABLE VDITCONTRATO (
    CODEMP           INTEGER NOT NULL,
    CODFILIAL        SMALLINT NOT NULL,
    CODCONTR         INTEGER NOT NULL,
    CODITCONTR       SMALLINT NOT NULL,
    CODEMPPD         INTEGER NOT NULL,
    CODFILIALPD      SMALLINT NOT NULL,
    CODPROD          INTEGER NOT NULL,
    QTDITCONTR       NUMERICDN NOT NULL,
    VLRITCONTR       NUMERICDN NOT NULL,
    VLRITCONTREXCED  NUMERICDN NOT NULL,
    DTINS            DATE DEFAULT 'now',
    IDUSUINS         CHAR(8) DEFAULT USER,
    DTALT            DATE DEFAULT 'now',
    IDUSUALT         CHAR(8) DEFAULT USER,
    HINS             TIME DEFAULT 'now',
    HALT             TIME DEFAULT 'now'
);

CREATE TABLE VDITKIT (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODKIT       INTEGER NOT NULL,
    SEQITKIT     SMALLINT NOT NULL,
    CODEMPPD     INTEGER NOT NULL,
    CODFILIALPD  SMALLINT NOT NULL,
    CODPROD      INTEGER NOT NULL,
    REFPROD      CHAR(13) NOT NULL,
    QTDITKIT     NUMERICDN DEFAULT 0 NOT NULL,
    PRECOITKIT   NUMERICDN DEFAULT 0 NOT NULL,
    VLRTOTITKIT  NUMERICDN DEFAULT 0 NOT NULL,
    IDUSUINS     CHAR(8),
    DTINS        DATE,
    HINS         TIME,
    IDUSUALT     CHAR(8),
    DTALT        DATE,
    HALT         TIME
);

CREATE TABLE VDITORCAMENTO (
    CODEMP          INTEGER NOT NULL,
    CODFILIAL       SMALLINT NOT NULL,
    TIPOORC         CHAR(1) DEFAULT 'O' NOT NULL,
    CODORC          INTEGER NOT NULL,
    CODITORC        INTEGER NOT NULL,
    CODEMPPD        INTEGER NOT NULL,
    CODFILIALPD     SMALLINT NOT NULL,
    CODPROD         INTEGER NOT NULL,
    CODEMPAX        INTEGER NOT NULL,
    CODFILIALAX     SMALLINT NOT NULL,
    CODALMOX        INTEGER NOT NULL,
    QTDITORC        NUMERICDN NOT NULL,
    PRECOITORC      NUMERICDN NOT NULL,
    PERCDESCITORC   NUMERIC(9,2),
    VLRDESCITORC    NUMERICDN,
    VLRLIQITORC     NUMERICDN,
    VLRPRODITORC    NUMERICDN,
    REFPROD         CHAR(13),
    NUMAUTORIZORC   CHAR(15),
    ACEITEITORC     CHAR(1) DEFAULT 'N' NOT NULL,
    APROVITORC      CHAR(1) DEFAULT 'N' NOT NULL,
    EMITITORC       CHAR(1) DEFAULT 'N' NOT NULL,
    VENCAUTORIZORC  DATE,
    STRDESCITORC    CHAR(50),
    OBSITORC        VARCHAR(1000),
    STATUSITORC     CHAR(2),
    DTINS           DATE DEFAULT 'now',
    IDUSUINS        CHAR(8) DEFAULT USER,
    DTALT           DATE DEFAULT 'now',
    IDUSUALT        CHAR(8) DEFAULT USER,
    HINS            TIME DEFAULT 'now',
    HALT            TIME DEFAULT 'now',
    CODEMPPE        INTEGER,
    CODFILIALPE     SMALLINT,
    CODPE           INTEGER,
    DIASPE          SMALLINT,
    EMMANUT         CHAR(1),
    CODEMPLG        INTEGER,
    CODFILIALLG     INTEGER,
    CODLOG          INTEGER,
    CODEMPLE        INTEGER,
    CODFILIALLE     SMALLINT,
    CODLOTE         VARCHAR(20),
    SITENTITORC     CHAR(1) DEFAULT 'N' NOT NULL,
    SITTERMRITORC   CHAR(1) DEFAULT 'E' NOT NULL
);

CREATE TABLE VDITREGRACOMIS (
    CODEMP         INTEGER NOT NULL,
    CODFILIAL      SMALLINT NOT NULL,
    CODREGRCOMIS   INTEGER NOT NULL,
    SEQITRC        SMALLINT NOT NULL,
    CODEMPTV       INTEGER NOT NULL,
    CODFILIALTV    SMALLINT NOT NULL,
    CODTIPOVEND    INTEGER NOT NULL,
    OBRIGITRC      CHAR(1) DEFAULT 'S' NOT NULL,
    PERCCOMISITRC  DECIMAL(7,3) DEFAULT 0 NOT NULL,
    DTINS          DATE DEFAULT 'now' NOT NULL,
    IDUSUINS       CHAR(8) DEFAULT USER NOT NULL,
    DTALT          DATE DEFAULT 'now' NOT NULL,
    IDUSUALT       CHAR(8) DEFAULT USER NOT NULL,
    HINS           TIME DEFAULT 'now' NOT NULL,
    HALT           TIME DEFAULT 'now' NOT NULL
);

CREATE TABLE VDITROMANEIO (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    CODROMA       INTEGER NOT NULL,
    CODITROMA     INTEGER NOT NULL,
    CODEMPVA      INTEGER NOT NULL,
    CODFILIALVA   SMALLINT NOT NULL,
    TIPOVENDA     CHAR(1) DEFAULT 'V' NOT NULL,
    CODVENDA      INTEGER NOT NULL,
    DTPREVITROMA  DATE NOT NULL,
    FLAG          CHAR(1) DEFAULT 'N',
    DTINS         DATE DEFAULT 'now',
    IDUSUINS      CHAR(8) DEFAULT USER,
    DTALT         DATE DEFAULT 'now',
    IDUSUALT      CHAR(8) DEFAULT USER,
    HINS          TIME DEFAULT 'now',
    HALT          TIME DEFAULT 'now'
);

CREATE TABLE VDITVENDA (
    CODEMP              INTEGER NOT NULL,
    CODFILIAL           SMALLINT NOT NULL,
    TIPOVENDA           CHAR(1) DEFAULT 'V' NOT NULL,
    CODVENDA            INTEGER NOT NULL,
    CODITVENDA          INTEGER NOT NULL,
    CODEMPNT            INTEGER NOT NULL,
    CODFILIALNT         SMALLINT NOT NULL,
    CODNAT              CHAR(4) NOT NULL,
    CODEMPPD            INTEGER NOT NULL,
    CODFILIALPD         SMALLINT NOT NULL,
    CODPROD             INTEGER NOT NULL,
    CODEMPLE            INTEGER,
    CODFILIALLE         SMALLINT,
    CODLOTE             VARCHAR(20),
    CODEMPAX            INTEGER NOT NULL,
    CODFILIALAX         SMALLINT NOT NULL,
    CODALMOX            INTEGER NOT NULL,
    QTDITVENDA          NUMERICDN NOT NULL,
    PRECOITVENDA        NUMERICDN NOT NULL,
    PERCDESCITVENDA     NUMERIC(9,2),
    VLRDESCITVENDA      NUMERICDN,
    PERCICMSITVENDA     NUMERIC(9,2),
    VLRBASEICMSITVENDA  NUMERICDN,
    VLRICMSITVENDA      NUMERICDN,
    PERCIPIITVENDA      NUMERIC(9,2),
    VLRBASEIPIITVENDA   NUMERICDN,
    VLRIPIITVENDA       NUMERICDN,
    VLRLIQITVENDA       NUMERICDN,
    PERCCOMISITVENDA    NUMERIC(9,2),
    VLRCOMISITVENDA     NUMERICDN,
    VLRADICITVENDA      NUMERICDN,
    PERCISSITVENDA      NUMERIC(9,2),
    VLRISSITVENDA       NUMERICDN,
    VLRFRETEITVENDA     NUMERICDN,
    VLRPRODITVENDA      NUMERICDN,
    VLRISENTASITVENDA   NUMERICDN,
    VLROUTRASITVENDA    NUMERICDN,
    REFPROD             CHAR(13),
    VLRBASEISSITVENDA   NUMERICDN DEFAULT 0,
    OBSITVENDA          VARCHAR(1000),
    ORIGFISC            CHAR(1),
    CODEMPTT            INTEGER,
    CODFILIALTT         INTEGER,
    CODTRATTRIB         CHAR(2),
    TIPOFISC            CHAR(2),
    CODEMPME            INTEGER,
    CODFILIALME         SMALLINT,
    CODMENS             INTEGER,
    STRDESCITVENDA      CHAR(50),
    QTDDEVITVENDA       NUMERICDN DEFAULT 0,
    CODEMPLG            INTEGER,
    CODFILIALLG         SMALLINT,
    CODLOG              INTEGER,
    DTINS               DATE DEFAULT 'now',
    IDUSUINS            CHAR(8) DEFAULT USER,
    DTALT               DATE DEFAULT 'now',
    IDUSUALT            CHAR(8) DEFAULT USER,
    HINS                TIME DEFAULT 'now',
    HALT                TIME DEFAULT 'now',
    EMMANUT             CHAR(1) DEFAULT 'N',
    CANCITVENDA         CHAR(1),
    CODEMPPE            INTEGER,
    CODFILIALPE         SMALLINT,
    CODPE               INTEGER,
    DIASPE              SMALLINT,
    CODEMPCV            INTEGER,
    CODFILIALCV         SMALLINT,
    CODCONV             INTEGER
);

CREATE TABLE VDKIT (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODKIT       INTEGER NOT NULL,
    CODEMPPD     INTEGER NOT NULL,
    CODFILIALPD  SMALLINT NOT NULL,
    CODPROD      INTEGER NOT NULL,
    REFPROD      CHAR(13) NOT NULL,
    QTDKIT       NUMERICDN DEFAULT 0 NOT NULL,
    PRECOKIT     NUMERICDN DEFAULT 0 NOT NULL,
    VLRTOTKIT    NUMERICDN DEFAULT 0 NOT NULL,
    DTINS        DATE,
    HINS         TIME,
    IDUSUINS     CHAR(8),
    DTALT        DATE,
    HALT         TIME,
    IDUSUALT     CHAR(8)
);

CREATE TABLE VDOBSCLI (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    CODCLI     INTEGER NOT NULL,
    SEQOBSCLI  INTEGER NOT NULL,
    DTOBSCLI   DATE NOT NULL,
    HOBSCLI    TIME NOT NULL,
    TXTOBSCLI  VARCHAR(10000) NOT NULL
);

CREATE TABLE VDORCAMENTO (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    TIPOORC       CHAR(1) DEFAULT 'O' NOT NULL,
    CODORC        INTEGER NOT NULL,
    CODEMPAE      INTEGER,
    CODFILIALAE   SMALLINT,
    CODATEND      INTEGER,
    CODEMPCV      INTEGER,
    CODFILIALCV   SMALLINT,
    CODCONV       INTEGER,
    DTORC         DATE NOT NULL,
    DTVENCORC     DATE NOT NULL,
    VLRPRODORC    NUMERICDN,
    PERCDESCORC   NUMERIC(9,2),
    VLRDESCORC    NUMERICDN,
    PERCADICORC   NUMERIC(15,5),
    VLRADICORC    NUMERICDN,
    VLRDESCITORC  NUMERICDN,
    VLRLIQORC     NUMERICDN,
    STATUSORC     CHAR(2) NOT NULL,
    OBSORC        VARCHAR(10000),
    CODPLANOPAG   INTEGER,
    CODFILIALPG   INTEGER,
    CODEMPPG      INTEGER,
    TXT01         CHAR(20),
    CODEMPVD      INTEGER NOT NULL,
    CODFILIALVD   SMALLINT NOT NULL,
    CODVEND       INTEGER NOT NULL,
    CODEMPCL      INTEGER NOT NULL,
    CODFILIALCL   SMALLINT NOT NULL,
    CODCLI        INTEGER NOT NULL,
    CODTPCONV     INTEGER,
    CODFILIALTC   INTEGER,
    CODEMPTC      INTEGER,
    PRAZOENTORC   SMALLINT,
    DTINS         DATE DEFAULT 'now',
    IDUSUINS      CHAR(8) DEFAULT USER,
    DTALT         DATE DEFAULT 'now',
    IDUSUALT      CHAR(8) DEFAULT USER,
    HINS          TIME DEFAULT 'now',
    HALT          TIME DEFAULT 'now',
    EMMANUT       CHAR(1),
    CODCLCOMIS    INTEGER,
    CODEMPCM      SMALLINT,
    CODFILIALCM   INTEGER
);

CREATE TABLE VDPRAZOENT (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    CODPE      INTEGER NOT NULL,
    DESCPE     CHARMIDDLEDN NOT NULL,
    DIASPE     SMALLINT DEFAULT 0 NOT NULL
);

CREATE TABLE VDPRECOPROD (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    CODPROD       INTEGER NOT NULL,
    CODPRECOPROD  INTEGER NOT NULL,
    CODEMPTB      INTEGER NOT NULL,
    CODFILIALTB   SMALLINT NOT NULL,
    CODTAB        INTEGER NOT NULL,
    CODEMPCC      INTEGER,
    CODFILIALCC   SMALLINT,
    CODCLASCLI    INTEGER,
    CODEMPPG      INTEGER NOT NULL,
    CODFILIALPG   SMALLINT NOT NULL,
    CODPLANOPAG   INTEGER NOT NULL,
    PRECOPROD     NUMERICDN NOT NULL,
    DTINS         DATE DEFAULT 'now',
    IDUSUINS      CHAR(8) DEFAULT USER,
    DTALT         DATE DEFAULT 'now',
    IDUSUALT      CHAR(8) DEFAULT USER,
    HINS          TIME DEFAULT 'now',
    HALT          TIME DEFAULT 'now'
);

CREATE TABLE VDREGRACOMIS (
    CODEMP         INTEGER NOT NULL,
    CODFILIAL      SMALLINT NOT NULL,
    CODREGRCOMIS   INTEGER NOT NULL,
    DESCREGRCOMIS  CHAR(50) NOT NULL,
    DTINS          DATE DEFAULT 'now' NOT NULL,
    IDUSUINS       CHAR(8) DEFAULT USER NOT NULL,
    DTALT          DATE DEFAULT 'now' NOT NULL,
    IDUSUALT       CHAR(8) DEFAULT USER NOT NULL,
    HINS           TIME DEFAULT 'now' NOT NULL,
    HALT           TIME DEFAULT 'now' NOT NULL
);

CREATE TABLE VDROMANEIO (
    CODEMP         INTEGER NOT NULL,
    CODFILIAL      SMALLINT NOT NULL,
    CODROMA        INTEGER NOT NULL,
    DATAROMA       DATE NOT NULL,
    DTSAIDAROMA    DATE NOT NULL,
    DTPREVROMA     DATE NOT NULL,
    DTENTREGAROMA  DATE,
    STATUSROMA     CHAR(2) NOT NULL,
    DTINS          DATE DEFAULT 'now',
    IDUSUINS       CHAR(8) DEFAULT USER,
    DTALT          DATE DEFAULT 'now',
    IDUSUALT       CHAR(8) DEFAULT USER,
    HINS           TIME DEFAULT 'now',
    HALT           TIME DEFAULT 'now'
);

CREATE TABLE VDSETOR (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    CODSETOR   INTEGER NOT NULL,
    DESCSETOR  CHAR(40) NOT NULL,
    DTINS      DATE DEFAULT 'now',
    IDUSUINS   CHAR(8) DEFAULT USER,
    DTALT      DATE DEFAULT 'now',
    IDUSUALT   CHAR(8) DEFAULT USER,
    HINS       TIME DEFAULT 'now' NOT NULL,
    HALT       TIME DEFAULT 'now'
);

CREATE TABLE VDSTATUSORC (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    TIPOORC      CHAR(1) NOT NULL,
    CODORC       INTEGER NOT NULL,
    CODEMPTB     INTEGER NOT NULL,
    CODFILIALTB  SMALLINT NOT NULL,
    CODTB        SMALLINT NOT NULL,
    CODITTB      SMALLINT NOT NULL,
    DTASTORC     DATE DEFAULT 'today' NOT NULL,
    HORASTORC    TIME DEFAULT 'now' NOT NULL,
    MOTIVOSTORC  VARCHAR(10000),
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now'
);

CREATE TABLE VDTABPRECO (
    CODEMP     INTEGER NOT NULL,
    CODFILIAL  SMALLINT NOT NULL,
    CODTAB     INTEGER NOT NULL,
    DESCTAB    CHAR(40) NOT NULL,
    DTINS      DATE DEFAULT 'now',
    IDUSUINS   CHAR(8) DEFAULT USER,
    DTALT      DATE DEFAULT 'now',
    IDUSUALT   CHAR(8) DEFAULT USER,
    HINS       TIME DEFAULT 'now',
    HALT       TIME DEFAULT 'now'
);

CREATE TABLE VDTEF (
    CODEMP      INTEGER NOT NULL,
    CODFILIAL   INTEGER NOT NULL,
    TIPOVENDA   CHAR(1) NOT NULL,
    CODVENDA    INTEGER NOT NULL,
    NSUTEF      CHAR(20) NOT NULL,
    REDETEF     CHAR(30),
    DTTRANSTEF  DATE,
    VLRTEF      NUMERIC(15,3)
);

CREATE TABLE VDTIPOCLI (
    CODEMP           INTEGER NOT NULL,
    CODFILIAL        SMALLINT NOT NULL,
    CODTIPOCLI       INTEGER NOT NULL,
    DESCTIPOCLI      CHAR(40) NOT NULL,
    CHEQTIPOCLI      CHAR(1) DEFAULT 'N' NOT NULL,
    FISTIPOCLI       CHAR(1) DEFAULT 'N' NOT NULL,
    JURTIPOCLI       CHAR(1) DEFAULT 'N' NOT NULL,
    FILTIPOCLI       CHAR(1) DEFAULT 'N' NOT NULL,
    LOCTRABTIPOCLI   CHAR(1) DEFAULT 'N' NOT NULL,
    REFCOMLTIPOCLI   CHAR(1) DEFAULT 'N' NOT NULL,
    BANCTIPOCLI      CHAR(1) DEFAULT 'N' NOT NULL,
    REFPESTIPOCLI    CHAR(1) DEFAULT 'N' NOT NULL,
    CONJTIPOCLI      CHAR(1) DEFAULT 'N' NOT NULL,
    VEICTIPOCLI      CHAR(1) DEFAULT 'N' NOT NULL,
    IMOVTIPOCLI      CHAR(1) DEFAULT 'N' NOT NULL,
    TERRATIPOCLI     CHAR(1) DEFAULT 'N' NOT NULL,
    PESAUTCPTIPOCLI  CHAR(1) DEFAULT 'N' NOT NULL,
    AVALTIPOCLI      CHAR(1) DEFAULT 'N' NOT NULL,
    SOCIOTIPOCLI     CHAR(1) DEFAULT 'N' NOT NULL,
    DTINS            DATE DEFAULT 'now',
    IDUSUINS         CHAR(8) DEFAULT USER,
    DTALT            DATE DEFAULT 'now',
    IDUSUALT         CHAR(8) DEFAULT USER,
    HINS             TIME DEFAULT 'now',
    HALT             TIME DEFAULT 'now',
    SIGLATIPOCLI     CHAR(3)
);

CREATE TABLE VDTIPOVEND (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    CODTIPOVEND   INTEGER NOT NULL,
    DESCTIPOVEND  CHAR(50) NOT NULL,
    DTINS         DATE DEFAULT 'now' NOT NULL,
    IDUSUINS      VARCHAR(128) DEFAULT USER NOT NULL,
    DTALT         DATE DEFAULT 'now' NOT NULL,
    IDUSUALT      VARCHAR(128) DEFAULT USER NOT NULL,
    HINS          TIME DEFAULT 'now' NOT NULL,
    HALT          TIME DEFAULT 'now' NOT NULL
);

CREATE TABLE VDTRANSP (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODTRAN      INTEGER NOT NULL,
    RAZTRAN      CHAR(50) NOT NULL,
    NOMETRAN     CHAR(40) NOT NULL,
    CNPJTRAN     CHAR(14),
    CPFTRAN      CHAR(11),
    INSCTRAN     VARCHAR(20),
    ENDTRAN      CHAR(50),
    NUMTRAN      INTEGER,
    COMPLTRAN    CHAR(20),
    BAIRTRAN     CHAR(30),
    CIDTRAN      CHAR(30),
    CEPTRAN      CHAR(8),
    FONETRAN     CHAR(12),
    FAXTRAN      CHAR(8),
    UFTRAN       CHAR(2),
    TIPOTRAN     CHAR(1) DEFAULT 'T',
    CELTRAN      CHAR(8),
    CONTTRAN     CHAR(40),
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now',
    DDDFONETRAN  CHAR(4),
    DDDFAXTRAN   CHAR(4),
    DDDCELTRAN   CHAR(4),
    CODMUNIC     CHAR(5),
    SIGLAUF      CHAR(2),
    CODPAIS      SMALLINT
);

CREATE TABLE VDVENDA (
    CODEMP            INTEGER NOT NULL,
    CODFILIAL         SMALLINT NOT NULL,
    TIPOVENDA         CHAR(1) DEFAULT 'V' NOT NULL,
    CODVENDA          INTEGER NOT NULL,
    CODEMPVD          INTEGER,
    CODFILIALVD       SMALLINT,
    CODVEND           INTEGER,
    CODEMPCL          INTEGER NOT NULL,
    CODFILIALCL       SMALLINT NOT NULL,
    CODCLI            INTEGER NOT NULL,
    CODEMPPG          INTEGER NOT NULL,
    CODFILIALPG       SMALLINT NOT NULL,
    CODPLANOPAG       INTEGER NOT NULL,
    CODEMPSE          INTEGER NOT NULL,
    CODFILIALSE       SMALLINT NOT NULL,
    SERIE             CHAR(4) NOT NULL,
    CODEMPTM          INTEGER NOT NULL,
    CODFILIALTM       SMALLINT NOT NULL,
    CODTIPOMOV        INTEGER NOT NULL,
    CODEMPCX          INTEGER,
    CODFILIALCX       SMALLINT,
    CODCAIXA          INTEGER,
    DOCVENDA          INTEGER NOT NULL,
    DTSAIDAVENDA      DATE NOT NULL,
    DTEMITVENDA       DATE NOT NULL,
    VLRPRODVENDA      NUMERICDN,
    PERCDESCVENDA     NUMERIC(9,2),
    VLRDESCVENDA      NUMERICDN,
    VLRDESCITVENDA    NUMERICDN,
    VLRVENDA          NUMERICDN,
    VLRBASEICMSVENDA  NUMERICDN,
    VLRICMSVENDA      NUMERICDN,
    CALCICMSVENDA     CHAR(1) DEFAULT 'N',
    IMPICMSVENDA      CHAR(1) DEFAULT 'N',
    VLRISENTASVENDA   NUMERICDN,
    VLROUTRASVENDA    NUMERICDN,
    VLRBASEIPIVENDA   NUMERICDN,
    VLRLIQVENDA       NUMERICDN,
    PERCCOMISVENDA    NUMERIC(9,2),
    VLRCOMISVENDA     NUMERICDN,
    STATUSVENDA       CHAR(2) NOT NULL,
    VLRFRETEVENDA     NUMERICDN,
    VLRADICVENDA      NUMERICDN,
    VLRIPIVENDA       NUMERICDN,
    CALCIPIVENDA      CHAR(1) DEFAULT 'N',
    IMPIPIVENDA       CHAR(1) DEFAULT 'N',
    OBSVENDA          VARCHAR(10000),
    CODEMPBO          INTEGER,
    CODFILIALBO       SMALLINT,
    CODBANCO          CHAR(3),
    CODEMPTC          INTEGER,
    CODFILIALTC       SMALLINT,
    CODTIPOCOB        INTEGER,
    VLRBASEISSVENDA   NUMERICDN DEFAULT 0,
    VLRISSVENDA       NUMERICDN DEFAULT 0,
    CALCISSVENDA      CHAR(1) DEFAULT 'N',
    IMPIISSVENDA      CHAR(1) DEFAULT 'N',
    IMPNOTAVENDA      CHAR(1) DEFAULT 'N',
    FLAG              CHAR(1) DEFAULT 'N',
    CODCLASCOMIS      CHAR(1),
    VLRPISVENDA       NUMERICDN DEFAULT 0,
    CALCPISVENDA      CHAR(1) DEFAULT 'N',
    IMPPISVENDA       CHAR(1) DEFAULT 'N',
    VLRCOFINSVENDA    NUMERICDN DEFAULT 0,
    CALCCOFINSVENDA   CHAR(1) DEFAULT 'N',
    IMPCOFINSVENDA    CHAR(1) DEFAULT 'N',
    VLRIRVENDA        NUMERICDN DEFAULT 0,
    CALCIRVENDA       CHAR(1) DEFAULT 'N',
    IMPIRVENDA        CHAR(1) DEFAULT 'N',
    VLRCSOCIALVENDA   NUMERICDN DEFAULT 0,
    CALCCSOCIALVENDA  CHAR(1) DEFAULT 'N',
    IMPCSOCIALVENDA   CHAR(1) DEFAULT 'N',
    PERCMCOMISVENDA   NUMERIC(7,3) DEFAULT 0,
    CODEMPCM          INTEGER,
    CODFILIALCM       INTEGER,
    CODCLCOMIS        INTEGER,
    CODEMPCB          INTEGER,
    CODFILIALCB       SMALLINT,
    CODCARTCOB        CHAR(2),
    PEDCLIVENDA       CHAR(10),
    DTINS             DATE DEFAULT 'now',
    IDUSUINS          CHAR(8) DEFAULT USER,
    DTALT             DATE DEFAULT 'now',
    IDUSUALT          CHAR(8) DEFAULT USER,
    HINS              TIME DEFAULT 'now',
    HALT              TIME DEFAULT 'now',
    EMMANUT           CHAR(1) DEFAULT 'N',
    BLOQVENDA         CHAR(1) DEFAULT 'N' NOT NULL
);

CREATE TABLE VDVENDACOMIS (
    CODEMP        INTEGER NOT NULL,
    CODFILIAL     SMALLINT NOT NULL,
    TIPOVENDA     CHAR(1) DEFAULT 'V' NOT NULL,
    CODVENDA      INTEGER NOT NULL,
    SEQVC         SMALLINT NOT NULL,
    CODEMPRC      INTEGER NOT NULL,
    CODFILIALRC   SMALLINT NOT NULL,
    CODREGRCOMIS  INTEGER NOT NULL,
    SEQITRC       INTEGER NOT NULL,
    CODEMPVD      INTEGER,
    CODFILIALVD   SMALLINT,
    CODVEND       INTEGER,
    PERCVC        NUMERIC(6,3) DEFAULT 0 NOT NULL
);

CREATE TABLE VDVENDAORC (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    INTEGER NOT NULL,
    TIPOVENDA    CHAR(1) NOT NULL,
    CODVENDA     INTEGER NOT NULL,
    CODITVENDA   INTEGER NOT NULL,
    CODEMPOR     INTEGER NOT NULL,
    CODFILIALOR  INTEGER NOT NULL,
    TIPOORC      CHAR(1) NOT NULL,
    CODORC       INTEGER NOT NULL,
    CODITORC     INTEGER NOT NULL
);

CREATE TABLE VDVENDEDOR (
    CODEMP       INTEGER NOT NULL,
    CODFILIAL    SMALLINT NOT NULL,
    CODVEND      INTEGER NOT NULL,
    NOMEVEND     CHAR(40),
    ENDVEND      CHAR(50),
    NUMVEND      INTEGER,
    COMPLVEND    CHAR(20),
    BAIRVEND     CHAR(30),
    CIDVEND      CHAR(30),
    CEPVEND      CHAR(8),
    UFVEND       CHAR(2),
    FONEVEND     CHAR(12),
    FAXVEND      CHAR(8),
    EMAILVEND    CHAR(50),
    PERCCOMVEND  NUMERIC(7,3),
    COMIPIVEND   CHAR(1),
    CODEMPPN     INTEGER,
    CODFILIALPN  SMALLINT,
    CODPLAN      CHAR(13),
    CPFVEND      CHAR(11),
    RGVEND       CHAR(10),
    CNPJVEND     CHAR(14),
    INSCVEND     VARCHAR(20),
    CELVEND      CHAR(12),
    CODEMPSE     INTEGER,
    CODFILIALSE  INTEGER,
    CODSETOR     INTEGER,
    CODEMPCM     INTEGER,
    CODFILIALCM  INTEGER,
    CODCLCOMIS   INTEGER,
    DTINS        DATE DEFAULT 'now',
    IDUSUINS     CHAR(8) DEFAULT USER,
    DTALT        DATE DEFAULT 'now',
    IDUSUALT     CHAR(8) DEFAULT USER,
    CODFORNVEND  CHAR(13),
    HINS         TIME DEFAULT 'now',
    HALT         TIME DEFAULT 'now',
    CODFUNC      INTEGER,
    CODEMPFU     INTEGER,
    CODFILIALFU  SMALLINT,
    CODEMPTV     INTEGER,
    CODFILIALTV  SMALLINT,
    CODTIPOVEND  INTEGER,
    DDDFONEVEND  CHAR(4),
    DDDFAXVEND   CHAR(4),
    DDDCELVEND   CHAR(4),
    SSPVEND      CHAR(10),
    OBSVEND      VARCHAR(500),
    ATIVOCOMIS   CHAR(1) DEFAULT 'S' NOT NULL,
    IMGASSVEND   BLOB SUB_TYPE 0 SEGMENT SIZE 50
);



/******************************************************************************/
/*                                   Views                                    */
/******************************************************************************/


/* View: EQCONFESTOQVW01 */
CREATE VIEW EQCONFESTOQVW01(
    CODEMP,
    CODFILIAL,
    ATIVOPROD,
    DESCPROD,
    CODPROD,
    REFPROD,
    SLDLIQPROD,
    QTDINVP,
    QTDITCOMPRA,
    QTDFINALPRODOP,
    QTDEXPITRMA,
    QTDITVENDA,
    SLDMOVPROD,
    SLDLIQPRODAX)
AS
SELECT P.CODEMP, P.CODFILIAL, P.ATIVOPROD, P.DESCPROD,P.CODPROD,P.REFPROD,P.SLDLIQPROD,
    COALESCE((SELECT SUM(QTDINVP)  FROM EQINVPROD IT WHERE IT.CODEMPPD=P.CODEMP AND
       IT.CODFILIALPD=P.CODFILIAL AND IT.CODPROD=P.CODPROD ),0) QTDINVP,
   COALESCE((SELECT SUM(QTDITCOMPRA)  FROM CPITCOMPRA IC, CPCOMPRA C, EQTIPOMOV TM
       WHERE IC.CODEMPPD=P.CODEMP AND IC.CODFILIALPD=P.CODFILIAL AND
       IC.CODPROD=P.CODPROD AND  C.CODCOMPRA=IC.CODCOMPRA AND
       C.CODEMP=IC.CODEMP AND C.CODFILIAL=IC.CODFILIAL AND  TM.CODTIPOMOV=C.CODTIPOMOV AND
       TM.CODEMP=C.CODEMPTM AND TM.CODFILIAL=C.CODFILIALTM AND TM.ESTOQTIPOMOV='S' ),0) QTDITCOMPRA,
   COALESCE((SELECT SUM(QTDFINALPRODOP) FROM PPOP O, EQTIPOMOV TM
      WHERE O.CODEMPPD=P.CODEMP AND O.CODFILIALPD=P.CODFILIAL AND O.CODPROD=P.CODPROD AND
      TM.CODTIPOMOV=O.CODTIPOMOV AND TM.CODEMP=O.CODEMPTM AND
      TM.CODFILIAL=O.CODFILIALTM  AND TM.ESTOQTIPOMOV='S' ),0) QTDFINALPRODOP,
   COALESCE((SELECT SUM(QTDEXPITRMA) FROM EQRMA R, EQITRMA IR, EQTIPOMOV TM  WHERE IR.CODEMPPD=P.CODEMP AND
      IR.CODFILIALPD=P.CODFILIAL AND IR.CODPROD=P.CODPROD AND  R.CODRMA=IR.CODRMA AND
      R.CODEMP=IR.CODEMP AND R.CODFILIAL=IR.CODFILIAL AND
      TM.CODTIPOMOV=R.CODTIPOMOV AND TM.CODEMP=R.CODEMPTM AND
      TM.CODFILIAL=R.CODFILIALTM  AND TM.ESTOQTIPOMOV='S' ),0) QTDEXPITRMA,
   COALESCE((SELECT SUM(QTDITVENDA) FROM VDITVENDA IV, VDVENDA V, EQTIPOMOV TM
      WHERE IV.CODEMPPD=P.CODEMP AND IV.CODFILIALPD=P.CODFILIAL AND IV.CODPROD=P.CODPROD AND
      V.CODVENDA=IV.CODVENDA AND V.TIPOVENDA=IV.TIPOVENDA AND
      V.CODEMP=IV.CODEMP AND V.CODFILIAL=IV.CODFILIAL AND
      (NOT SUBSTR(V.STATUSVENDA,1,1)='C') AND TM.CODTIPOMOV=V.CODTIPOMOV AND
      TM.CODEMP=V.CODEMPTM AND TM.CODFILIAL=V.CODFILIALTM  AND TM.ESTOQTIPOMOV='S' ),0) QTDITVENDA,
   COALESCE((SELECT FIRST 1 M.SLDMOVPROD FROM EQMOVPROD M WHERE M.CODEMPPD=P.CODEMP AND
      M.CODFILIALPD=P.CODFILIAL AND  M.CODPROD=P.CODPROD
      ORDER BY M.DTMOVPROD DESC, M.CODMOVPROD DESC ),0) SLDMOVPROD,
   COALESCE((SELECT SUM(SP.SLDLIQPROD) FROM EQSALDOPROD SP WHERE SP.CODEMP=P.CODEMP AND
      SP.CODFILIAL=P.CODFILIAL AND SP.CODPROD=P.CODPROD),0) SLDLIQPRODAX
   FROM EQPRODUTO P
;



/* View: PPLISTAOPVW01 */
CREATE VIEW PPLISTAOPVW01(
    CODEMP,
    CODFILIAL,
    DTEMITOP,
    DTFABROP,
    CODOP,
    SEQOP,
    DESCEST,
    SITOP,
    TEMPOTOT,
    TEMPOFIN,
    FASEATUAL,
    TOTFASES,
    QTDSUG,
    QTDPREV,
    QTDFINAL)
AS
select op.codemp,op.codfilial,op.dtemitop, op.dtfabrop,op.codop, op.seqop, et.descest,op.sitop,
(select coalesce(sum( ef.tempoef ),0)
    from ppestrufase ef
    where
    ef.codemp=et.codemp and ef.codfilial=et.codfilial and ef.codprod=et.codprod and ef.seqest=et.seqest) as tempotot,
(select coalesce(sum( opf.tempoof ),0)
    from ppopfase opf
    where
    opf.codemp=op.codemp and opf.codfilial=op.codfilial and opf.codop=op.codop and opf.seqop=op.seqop
    and opf.sitfs='FN') as tempofin,
(select coalesce(min(opf.seqof),0) from ppopfase opf
    where
    opf.codemp=op.codemp and opf.codfilial=op.codfilial and opf.codop=op.codop and opf.seqop=op.seqop
    and opf.sitfs='PE') as faseatual,
(select count(*) from ppopfase opf
    where
    opf.codemp=op.codemp and opf.codfilial=op.codfilial and opf.codop=op.codop and opf.seqop=op.seqop) as totfases,
    op.qtdsugprodop,
    op.qtdprevprodop,
    op.qtdfinalprodop
from ppop op, ppestrutura et
where
et.codemp=op.codemppd and et.codfilial=op.codfilialpd and et.codprod=op.codprod and et.seqest=op.seqest
;



/* View: VWTMPCUSTOITRMA */
CREATE VIEW VWTMPCUSTOITRMA(
    CODEMP,
    CODFILIAL,
    CODRMA,
    CODITRMA,
    CODPROD,
    CUSTODATA)
AS
select ITR.CODEMP,ITR.CODFILIAL,ITR.CODRMA,ITR.CODITRMA,ITR.CODPROD,COALESCE((SELECT FIRST 1 MP.CUSTOMPMMOVPROD
    FROM EQMOVPROD MP
    WHERE MP.CODEMPPD=ITR.codemppd AND MP.CODFILIALPD=ITR.codfilialpd
    AND MP.CODPROD=ITR.codprod AND MP.dtmovprod <= rm.dtareqrma
    ORDER BY MP.DTMOVPROD DESC, MP.CODMOVPROD DESC),0) AS CUSTO
from eqitrma itr, eqrma rm where rm.codrma = itr.codrma
;




/* Check constraints definition */

ALTER TABLE RHEMPREGADOR ADD CONSTRAINT RHEMPREGADOR01 CHECK(ATIVOEMPR IN ('S', 'N'));
ALTER TABLE ATCONVENIADO ADD CHECK (SEXOCONV IN ('M','F'));
ALTER TABLE PVCAIXAIMP ADD CONSTRAINT PVCAIXAIMPCK CHECK(IMPPAD IN ('S', 'N'));
ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1CK01 CHECK(usapedseq in ('S','N'));
ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1CK02 CHECK(tipoprecocusto in ('M','P'));
ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTECK01 CHECK(PESSOACLI IN ('F', 'J'));
ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTECK02 CHECK(ATIVOCLI IN ('S', 'N'));
ALTER TABLE VDTRANSP ADD check (TIPOTRAN IN ('T','C','F'));


/******************************************************************************/
/*                                Primary Keys                                */
/******************************************************************************/

ALTER TABLE ATATENDENTE ADD CONSTRAINT ATATENDENTEPK PRIMARY KEY (CODATEND, CODFILIAL, CODEMP);
ALTER TABLE ATATENDIMENTO ADD CONSTRAINT ATATENDIMENTOPK PRIMARY KEY (CODATENDO, CODFILIAL, CODEMP);
ALTER TABLE ATATENDIMENTOORC ADD CONSTRAINT ATATENDIMENTOORCPK PRIMARY KEY (CODATENDO, CODFILIAL, CODEMP, CODORC, TIPOORC, CODFILIALOC, CODEMPOC);
ALTER TABLE ATATRIBUICAO ADD CONSTRAINT ATATRIBUICAOPK PRIMARY KEY (CODATRIB, CODFILIAL, CODEMP);
ALTER TABLE ATCONVATRIB ADD CONSTRAINT ATCONVATRIBPK PRIMARY KEY (CODCONV, SEQCONVATRIB, CODFILIAL, CODEMP);
ALTER TABLE ATCONVATRIBTB ADD CONSTRAINT ATCONVATRIBTB PRIMARY KEY (CODITTB, CODTB, CODFILIALTB, CODEMPTB, SEQCONVATRIB, CODCONV, CODFILIAL, CODEMP);
ALTER TABLE ATCONVENIADO ADD CONSTRAINT ATCONVENIADOPK PRIMARY KEY (CODCONV, CODFILIAL, CODEMP);
ALTER TABLE ATENCAMINHADOR ADD CONSTRAINT ATENCAMINHADORPK PRIMARY KEY (CODENC, CODFILIAL, CODEMP);
ALTER TABLE ATSETOR ADD CONSTRAINT ATSETORPK PRIMARY KEY (CODSETAT, CODFILIAL, CODEMP);
ALTER TABLE ATSETORATENDENTE ADD CONSTRAINT ATSETORATENDENTEPK PRIMARY KEY (CODSETAT, CODFILIAL, CODEMP, CODATEND, CODFILIALAE, CODEMPAE);
ALTER TABLE ATTIPOATEND ADD CONSTRAINT ATTIPOATENDPK PRIMARY KEY (CODTPATEND, CODFILIAL, CODEMP);
ALTER TABLE ATTIPOATENDO ADD CONSTRAINT ATTIPOATENDOPK PRIMARY KEY (CODTPATENDO, CODFILIAL, CODEMP);
ALTER TABLE ATTIPOATENDOSETOR ADD CONSTRAINT ATTIPOATENDOSETOPK PRIMARY KEY (CODSETAT, CODFILIALST, CODEMPST, CODTPATENDO, CODFILIAL, CODEMP)
USING INDEX ATTIPOATENDOSETORPK;
ALTER TABLE ATTIPOCONV ADD CONSTRAINT ATTIPOCONVPK PRIMARY KEY (CODTPCONV, CODFILIAL, CODEMP);
ALTER TABLE CPCOMPRA ADD CONSTRAINT CPCOMPRAPK PRIMARY KEY (CODCOMPRA, CODFILIAL, CODEMP);
ALTER TABLE CPCOMPRAVENDA ADD CONSTRAINT CPCOMPRAVENDAPK PRIMARY KEY (CODITCOMPRA, CODCOMPRA, CODFILIAL, CODEMP);
ALTER TABLE CPCOTACAO ADD CONSTRAINT CPCOTACAOPK PRIMARY KEY (CODSOL, CODITSOL, CODCOT, CODFILIAL, CODEMP);
ALTER TABLE CPEQUIVCFOP ADD CONSTRAINT CPEQUIVCFOPPK PRIMARY KEY (CODNAT, CODFILIAL, CODEMP);
ALTER TABLE CPFORNECED ADD CONSTRAINT CPFORNECEDPK PRIMARY KEY (CODFOR, CODFILIAL, CODEMP);
ALTER TABLE CPITCOMPRA ADD CONSTRAINT CPITCOMPRAPK PRIMARY KEY (CODITCOMPRA, CODCOMPRA, CODFILIAL, CODEMP);
ALTER TABLE CPITSOLICITACAO ADD CONSTRAINT CPITSOLICITACAOPK PRIMARY KEY (CODSOL, CODITSOL, CODFILIAL, CODEMP);
ALTER TABLE CPITSUMSOL ADD CONSTRAINT PK_CPITSUMSOL PRIMARY KEY (CODITSOL, CODSOL, CODFILIALSC, CODEMPSC, CODSUMSOL, CODFILIAL, CODEMP);
ALTER TABLE CPPRODFOR ADD CONSTRAINT CPPRODFORPK PRIMARY KEY (CODFOR, CODPROD, CODFILIAL, CODEMP);
ALTER TABLE CPRATEIO ADD CONSTRAINT CPRATEIOPK PRIMARY KEY (CODCOMPRA, SEQRATEIO, CODFILIAL, CODEMP);
ALTER TABLE CPSOLICITACAO ADD CONSTRAINT CPSOLICITACAOPK PRIMARY KEY (CODSOL, CODFILIAL, CODEMP);
ALTER TABLE CPSUMSOL ADD CONSTRAINT CPSUMSOLPK PRIMARY KEY (CODSUMSOL, CODFILIAL, CODEMP);
ALTER TABLE CPTABFOR ADD CONSTRAINT CPTABFORPK PRIMARY KEY (REFPRODTFOR, CODFOR, CODFILIAL, CODEMP);
ALTER TABLE CPTIPOFOR ADD CONSTRAINT CPTIPOFORPK PRIMARY KEY (CODTIPOFOR, CODFILIAL, CODEMP);
ALTER TABLE EQALMOX ADD CONSTRAINT EQALMOXPK PRIMARY KEY (CODALMOX, CODFILIAL, CODEMP);
ALTER TABLE EQALMOXFILIAL ADD CONSTRAINT EQALMOXFILIALPK PRIMARY KEY (CODALMOX, CODFILIAL, CODEMP, CODFILIALAF, CODEMPAF);
ALTER TABLE EQCLIFOR ADD CONSTRAINT EQCLIFORPK PRIMARY KEY (CODCLI, CODEMP, CODFILIAL, CODFOR, CODEMPFR, CODFILIALFR);
ALTER TABLE EQCODALTPROD ADD CONSTRAINT EQCODALTPRODPK PRIMARY KEY (CODALTPROD, CODPROD, CODFILIAL, CODEMP);
ALTER TABLE EQFATCONV ADD CONSTRAINT EQFATCONVPK PRIMARY KEY (CODUNID, CODPROD, CODFILIAL, CODEMP);
ALTER TABLE EQGRUPO ADD CONSTRAINT EQGRUPOPK PRIMARY KEY (CODGRUP, CODFILIAL, CODEMP);
ALTER TABLE EQGUIATRAF ADD CONSTRAINT EQGUIATRAFPK PRIMARY KEY (CODITCOMPRA, CODCOMPRA, CODFILIAL, CODEMP);
ALTER TABLE EQINVPROD ADD CONSTRAINT EQINVPRODPK PRIMARY KEY (CODINVPROD, CODFILIAL, CODEMP);
ALTER TABLE EQITMODGRADE ADD CONSTRAINT EQITMODGRADEPK PRIMARY KEY (CODITMODG, CODMODG, CODFILIAL, CODEMP);
ALTER TABLE EQITRMA ADD CONSTRAINT EQITRMAPK PRIMARY KEY (CODRMA, CODITRMA, CODFILIAL, CODEMP);
ALTER TABLE EQITSIMILAR ADD CONSTRAINT EQITSIMILARPK PRIMARY KEY (CODPROD, CODFILIALPD, CODEMPPD, CODSIM, CODFILIAL, CODEMP);
ALTER TABLE EQLANCTOEXP ADD CONSTRAINT EQLANCTOEXPPK PRIMARY KEY (CODLEXP, CODFILIAL, CODEMP);
ALTER TABLE EQLOTE ADD CONSTRAINT EQLOTEPK PRIMARY KEY (CODLOTE, CODPROD, CODFILIAL, CODEMP);
ALTER TABLE EQMARCA ADD CONSTRAINT EQMARCAPK PRIMARY KEY (CODMARCA, CODFILIAL, CODEMP);
ALTER TABLE EQMODGRADE ADD CONSTRAINT EQMODGRADEPK PRIMARY KEY (CODMODG, CODFILIAL, CODEMP);
ALTER TABLE EQMODLOTE ADD CONSTRAINT EQMODLOTEPK PRIMARY KEY (CODMODLOTE, CODFILIAL, CODEMP);
ALTER TABLE EQMOVEXP ADD CONSTRAINT EQMOVEXPPK PRIMARY KEY (CODMOVEXP, CODFILIAL, CODEMP);
ALTER TABLE EQMOVPROD ADD CONSTRAINT EQMOVPRODPK PRIMARY KEY (CODMOVPROD, CODFILIAL, CODEMP);
ALTER TABLE EQPRODACESSO ADD CONSTRAINT EQPRODACESSOPK PRIMARY KEY (CODPROD, CODPA, TIPOPA, CODFILIAL, CODEMP);
ALTER TABLE EQPRODPLAN ADD CONSTRAINT EQPRODPLANPK PRIMARY KEY (CODPROD, CODFILIAL, CODEMP, SEQPP);
ALTER TABLE EQPRODUTO ADD CONSTRAINT EQPRODUTOPK PRIMARY KEY (CODPROD, CODFILIAL, CODEMP);
ALTER TABLE EQRMA ADD CONSTRAINT EQRMAPK PRIMARY KEY (CODRMA, CODFILIAL, CODEMP);
ALTER TABLE EQRMAAL ADD CONSTRAINT EQRMAALPK PRIMARY KEY (CODRMA, TIPORMAAL, CODFILIAL, CODEMP, IDUSU, CODFILIALUU, CODEMPUU);
ALTER TABLE EQSALDOLOTE ADD CONSTRAINT EQSALDOLOTEPK PRIMARY KEY (CODLOTE, CODPROD, CODFILIAL, CODEMP, CODALMOX, CODFILIALAX, CODEMPAX);
ALTER TABLE EQSALDOPROD ADD CONSTRAINT EQSALDOPRODPK PRIMARY KEY (CODPROD, CODFILIAL, CODEMP, CODALMOX, CODFILIALAX, CODEMPAX);
ALTER TABLE EQSIMILAR ADD CONSTRAINT EQSIMILARPK PRIMARY KEY (CODSIM, CODFILIAL, CODEMP);
ALTER TABLE EQTIPOEXP ADD CONSTRAINT EQTIPOEXPPK PRIMARY KEY (CODTIPOEXP, CODFILIAL, CODEMP);
ALTER TABLE EQTIPOMOV ADD CONSTRAINT EQTIPOMOVPK PRIMARY KEY (CODTIPOMOV, CODFILIAL, CODEMP);
ALTER TABLE EQTIPOMOVUSU ADD CONSTRAINT EQTIPOMOVUSUPK PRIMARY KEY (CODTIPOMOV, CODFILIAL, CODEMP, IDUSU, CODFILIALUS, CODEMPUS);
ALTER TABLE EQUNIDADE ADD CONSTRAINT EQUNIDADEPK PRIMARY KEY (CODUNID, CODFILIAL, CODEMP);
ALTER TABLE EQVARGRADE ADD CONSTRAINT EQVARGRADEPK PRIMARY KEY (CODVARG, CODFILIAL, CODEMP);
ALTER TABLE FNBANCO ADD CONSTRAINT FNBANCOPK PRIMARY KEY (CODBANCO, CODFILIAL, CODEMP);
ALTER TABLE FNCARTCOB ADD CONSTRAINT FNCARTCOBPK PRIMARY KEY (CODCARTCOB, CODFILIAL, CODEMP, CODBANCO, CODFILIALBO, CODEMPBO);
ALTER TABLE FNCC ADD CONSTRAINT FNCCPK PRIMARY KEY (CODCC, ANOCC, CODFILIAL, CODEMP);
ALTER TABLE FNCONTA ADD CONSTRAINT FNCONTAPK PRIMARY KEY (NUMCONTA, CODFILIAL, CODEMP);
ALTER TABLE FNCONTAUSU ADD CONSTRAINT FNCONTAUSUPK PRIMARY KEY (NUMCONTA, CODFILIAL, CODEMP, IDUSU, CODFILIALUS, CODEMPUS);
ALTER TABLE FNCOTMOEDA ADD CONSTRAINT FNCOTMOEDAPK PRIMARY KEY (DATACOT, CODMOEDA, CODFILIAL, CODEMP);
ALTER TABLE FNFBNCLI ADD CONSTRAINT FNFBNCLIPK PRIMARY KEY (CODCLI, CODFILIAL, CODEMP, CODBANCO, CODFILIALBO, CODEMPBO, CODFILIALPF, CODEMPPF, TIPOFEBRABAN);
ALTER TABLE FNFBNCODRET ADD CONSTRAINT FNFBNCODRETPK PRIMARY KEY (CODRET, TIPOFEBRABAN, CODBANCO, CODFILIALBO, CODEMPBO, CODFILIAL, CODEMP);
ALTER TABLE FNFBNREC ADD CONSTRAINT FNFBNRECPK PRIMARY KEY (CODREC, NPARCITREC, CODFILIAL, CODEMP);
ALTER TABLE FNHISTPAD ADD CONSTRAINT FNHISTPADPK PRIMARY KEY (CODHIST, CODFILIAL, CODEMP);
ALTER TABLE FNITMODBOLETO ADD CONSTRAINT FNITMODBOLETOPK PRIMARY KEY (CODMODBOL, CODFILIAL, CODEMP, CODBANCO, CODFILIALBO, CODEMPBO, CODCARTCOB, CODFILIALCB, CODEMPCB);
ALTER TABLE FNITPAGAR ADD CONSTRAINT FNITPAGARPK PRIMARY KEY (NPARCPAG, CODPAG, CODFILIAL, CODEMP);
ALTER TABLE FNITRECEBER ADD CONSTRAINT FNITRECEBERPK PRIMARY KEY (NPARCITREC, CODREC, CODFILIAL, CODEMP);
ALTER TABLE FNITTBJUROS ADD CONSTRAINT FNITTBJUROSPK PRIMARY KEY (CODTBJ, MESITTBJ, ANOITTBJ, CODFILIAL, CODEMP);
ALTER TABLE FNLANCA ADD CONSTRAINT FNLANCAPK PRIMARY KEY (CODLANCA, CODFILIAL, CODEMP);
ALTER TABLE FNLIBCRED ADD CONSTRAINT FNLIBCREDPK PRIMARY KEY (CODLCRED, CODFILIAL, CODEMP);
ALTER TABLE FNMODBOLETO ADD CONSTRAINT FNMODBOLETOPK PRIMARY KEY (CODMODBOL, CODFILIAL, CODEMP);
ALTER TABLE FNMOEDA ADD CONSTRAINT FNMOEDAPK PRIMARY KEY (CODMOEDA, CODFILIAL, CODEMP);
ALTER TABLE FNPAGAR ADD CONSTRAINT FNPAGARPK PRIMARY KEY (CODPAG, CODFILIAL, CODEMP);
ALTER TABLE FNPAGTOCOMI ADD CONSTRAINT FNPAGTOCOMIPK PRIMARY KEY (CODPCOMI, CODFILIAL, CODEMP);
ALTER TABLE FNPARCPAG ADD CONSTRAINT FNPARCPAGPK PRIMARY KEY (NROPARCPAG, CODPLANOPAG, CODFILIAL, CODEMP);
ALTER TABLE FNPLANEJAMENTO ADD CONSTRAINT FNPLANEJAMENTOPK PRIMARY KEY (CODPLAN, CODFILIAL, CODEMP);
ALTER TABLE FNPLANOPAG ADD CONSTRAINT FNPLANOPAGPK PRIMARY KEY (CODPLANOPAG, CODFILIAL, CODEMP);
ALTER TABLE FNRECEBER ADD CONSTRAINT FNRECEBERPK PRIMARY KEY (CODREC, CODFILIAL, CODEMP);
ALTER TABLE FNRESTRICAO ADD CONSTRAINT FNRESTRICAOPK PRIMARY KEY (CODCLI, SEQRESTR, CODFILIAL, CODEMP);
ALTER TABLE FNSALDOLANCA ADD CONSTRAINT FNSALDOLANCAPK PRIMARY KEY (DATASL, CODFILIALPN, CODEMPPN, CODPLAN, CODFILIAL, CODEMP);
ALTER TABLE FNSUBLANCA ADD CONSTRAINT FNSUBLANCAPK PRIMARY KEY (CODSUBLANCA, CODLANCA, CODFILIAL, CODEMP);
ALTER TABLE FNTBJUROS ADD CONSTRAINT FNTBJUROSPK PRIMARY KEY (CODTBJ, CODFILIAL, CODEMP);
ALTER TABLE FNTIPOCOB ADD CONSTRAINT FNTIPOCOBPK PRIMARY KEY (CODTIPOCOB, CODFILIAL, CODEMP);
ALTER TABLE FNTIPOCRED ADD CONSTRAINT FNTIPOCREDPK PRIMARY KEY (CODTPCRED, CODFILIAL, CODEMP);
ALTER TABLE FNTIPORESTR ADD CONSTRAINT FNTIPORESTRPK PRIMARY KEY (CODTPRESTR, CODFILIAL, CODEMP);
ALTER TABLE LFCLFISCAL ADD CONSTRAINT LFCLFISCALPK PRIMARY KEY (CODFISC, CODFILIAL, CODEMP);
ALTER TABLE LFITCLFISCAL ADD CONSTRAINT LFITCLFISCAL PRIMARY KEY (CODEMP, CODFILIAL, CODFISC, CODITFISC);
ALTER TABLE LFITNATOPER ADD CONSTRAINT LFITNATOPER PRIMARY KEY (CODITNATOPER, CODNAT, CODFILIAL, CODEMP);
ALTER TABLE LFITREGRAFISCAL ADD CONSTRAINT LFITREGRAFISCALPK PRIMARY KEY (CODNAT, CODREGRA, CODFILIAL, CODEMP);
ALTER TABLE LFLIVROFISCAL ADD CONSTRAINT LFLIVROFISCALPK PRIMARY KEY (CODLF, ANOMESLF, TIPOLF, CODFILIAL, CODEMP);
ALTER TABLE LFMENSAGEM ADD CONSTRAINT LFMENSAGEMPK PRIMARY KEY (CODMENS, CODFILIAL, CODEMP);
ALTER TABLE LFMODNOTA ADD CONSTRAINT LFMODNOTAPK PRIMARY KEY (CODMODNOTA, CODFILIAL, CODEMP);
ALTER TABLE LFNATOPER ADD CONSTRAINT LFNATOPERPK PRIMARY KEY (CODNAT, CODFILIAL, CODEMP);
ALTER TABLE LFREGRAFISCAL ADD CONSTRAINT LFREGRAFISCALPK PRIMARY KEY (CODREGRA, CODFILIAL, CODEMP);
ALTER TABLE LFSERIE ADD CONSTRAINT LFSERIEPK PRIMARY KEY (SERIE, CODFILIAL, CODEMP);
ALTER TABLE LFTABICMS ADD CONSTRAINT LFTABICMSPK PRIMARY KEY (UFTI, CODFILIAL, CODEMP);
ALTER TABLE LFTIPOFISCCLI ADD CONSTRAINT LFTIPOFISCCLIPK PRIMARY KEY (CODFISCCLI, CODFILIAL, CODEMP);
ALTER TABLE LFTRATTRIB ADD CONSTRAINT LFTRATTRIBPK PRIMARY KEY (CODTRATTRIB, CODFILIAL, CODEMP);
ALTER TABLE PPDISTRIB ADD CONSTRAINT PPDISTRIBPK PRIMARY KEY (CODPROD, CODFILIAL, CODEMP, SEQEST, SEQEF, CODPRODDE, CODFILIALDE, CODEMPDE, SEQDE, SEQESTDE, CODFASE, CODFILIALFS, CODEMPFS);
ALTER TABLE PPESTRUANALISE ADD CONSTRAINT PPESTRUANALISEPK PRIMARY KEY (CODESTANALISE, CODFILIAL, CODEMP);
ALTER TABLE PPESTRUFASE ADD CONSTRAINT PPESTRUFASEPK PRIMARY KEY (CODPROD, SEQEST, SEQEF, CODFILIAL, CODEMP, CODFASE, CODFILIALFS, CODEMPFS);
ALTER TABLE PPESTRUTURA ADD CONSTRAINT PPESTRUTURAPK PRIMARY KEY (CODPROD, SEQEST, CODFILIAL, CODEMP);
ALTER TABLE PPFASE ADD CONSTRAINT PPFASEPK PRIMARY KEY (CODFASE, CODFILIAL, CODEMP);
ALTER TABLE PPFOTOMTAN ADD CONSTRAINT VDFOTOMTAN PRIMARY KEY (CODFOTOMTAN, CODMTANALISE, CODFILIAL, CODEMP);
ALTER TABLE PPITESTRUTURA ADD CONSTRAINT PPITESTRUTURAPK PRIMARY KEY (CODPROD, SEQEST, SEQITEST, CODFILIAL, CODEMP, SEQEF, CODFASE, CODFILIALFS, CODEMPFS);
ALTER TABLE PPITOP ADD CONSTRAINT PPITOPPK PRIMARY KEY (CODOP, SEQOP, SEQITOP, CODFILIAL, CODEMP);
ALTER TABLE PPITRETCP ADD CONSTRAINT PPITRETCPPK PRIMARY KEY (CODITRETCP, CODOP, SEQOP, CODFILIAL, CODEMP);
ALTER TABLE PPMETODOANALISE ADD CONSTRAINT PPMETODOANALISEPK PRIMARY KEY (CODMTANALISE, CODFILIAL, CODEMP);
ALTER TABLE PPOP ADD CONSTRAINT PPOPPK PRIMARY KEY (CODOP, SEQOP, CODFILIAL, CODEMP);
ALTER TABLE PPOPACAOCORRET ADD CONSTRAINT PPOPACAOCORRETPK PRIMARY KEY (CODOP, SEQOP, SEQAC, CODFILIAL, CODEMP);
ALTER TABLE PPOPCQ ADD CONSTRAINT PPOPCQPK PRIMARY KEY (CODOP, SEQOP, SEQOPCQ, CODFILIAL, CODEMP);
ALTER TABLE PPOPFASE ADD CONSTRAINT PPOPFASEPK PRIMARY KEY (CODOP, SEQOP, SEQOF, CODFILIAL, CODEMP);
ALTER TABLE PPRECURSO ADD CONSTRAINT PPRECURSOPK PRIMARY KEY (CODRECP, CODFILIAL, CODEMP);
ALTER TABLE PPRETCP ADD CONSTRAINT PPRETCPPK PRIMARY KEY (CODOP, SEQOP, CODFILIAL, CODEMP);
ALTER TABLE PPTIPOANALISE ADD CONSTRAINT PPTIPOANALISEPK PRIMARY KEY (CODTPANALISE, CODFILIAL, CODEMP);
ALTER TABLE PPTIPOREC ADD CONSTRAINT PPTIPORECPK PRIMARY KEY (CODTPREC, CODFILIAL, CODEMP);
ALTER TABLE PVCAIXA ADD CONSTRAINT PVCAIXAPK PRIMARY KEY (CODCAIXA, CODFILIAL, CODEMP);
ALTER TABLE PVCAIXAIMP ADD CONSTRAINT PVCAIXAIMPPK PRIMARY KEY (CODIMP, CODCAIXA, CODFILIAL, CODEMP);
ALTER TABLE PVLEITURAX ADD PRIMARY KEY (CODEMP, CODFILIAL, CODCAIXA, DTLX);
ALTER TABLE PVMOVCAIXA ADD CONSTRAINT PVMOVCAIXAPK PRIMARY KEY (NROMOV, DTAMOV, CODCAIXA, CODFILIAL, CODEMP);
ALTER TABLE PVSEQMOVCAIXA ADD CONSTRAINT PVSEQMOVCAIXA PRIMARY KEY (DTAMOV, CODCAIXA, CODFILIAL, CODEMP);
ALTER TABLE PVSEQUENCIA ADD CONSTRAINT PK_PVSEQUENCIA PRIMARY KEY (CODEMP, CODFILIAL, CODCAIXA);
ALTER TABLE RHAREA ADD CONSTRAINT RHAREAPK PRIMARY KEY (CODAREA, CODFILIAL, CODEMP);
ALTER TABLE RHBENEFICIO ADD CONSTRAINT RHBENEFICIOPK PRIMARY KEY (CODBENEF, CODFILIAL, CODEMP);
ALTER TABLE RHCANDIDATO ADD CONSTRAINT RHCANDIDATOPK PRIMARY KEY (CODCAND, CODFILIAL, CODEMP);
ALTER TABLE RHCANDIDATOCARAC ADD CONSTRAINT RHCANDATOCARACPK PRIMARY KEY (CODCAND, CODFILIAL, CODEMP, CODCARAC, CODFILIALCT, CODEMPCT);
ALTER TABLE RHCANDIDATOCURSO ADD CONSTRAINT RHCANDIDATOCURSOPK PRIMARY KEY (CODCAND, CODFILIAL, CODEMP, CODCURSO, CODFILIALCS, CODEMPCS);
ALTER TABLE RHCANDIDATOFUNC ADD CONSTRAINT RHCANDIDATOFUNCPK PRIMARY KEY (CODCAND, CODFILIAL, CODEMP, CODFUNC, CODFILIALFC, CODEMPFC, SEQCANDFUNC);
ALTER TABLE RHCANDIDATOSTATUS ADD CONSTRAINT RHCANDIDATOSTATUSPK PRIMARY KEY (CODCAND, CODFILIAL, CODEMP, SQSTCAND);
ALTER TABLE RHCARACTERISTICA ADD CONSTRAINT ATCARACTERISTICAPK PRIMARY KEY (CODCARAC, CODFILIAL, CODEMP);
ALTER TABLE RHCURSO ADD CONSTRAINT RHCURSOPK PRIMARY KEY (CODCURSO, CODFILIAL, CODEMP);
ALTER TABLE RHDEPTO ADD CONSTRAINT RHDEPTOPK PRIMARY KEY (CODDEP, CODFILIAL, CODEMP);
ALTER TABLE RHEMPREGADO ADD CONSTRAINT RHEMPREGADOPK PRIMARY KEY (MATEMPR, CODFILIAL, CODEMP);
ALTER TABLE RHEMPREGADOBENEF ADD CONSTRAINT RHEMPREGADOBENEFPK PRIMARY KEY (MATEMPR, CODFILIAL, CODEMP, CODBENEF, CODFILIALBN, CODEMPBN);
ALTER TABLE RHEMPREGADOR ADD CONSTRAINT RHEMPREGADORPK PRIMARY KEY (CODEMPR, CODFILIAL, CODEMP);
ALTER TABLE RHEMPREGADOSAL ADD CONSTRAINT RHEMPREGADOSALPK PRIMARY KEY (MATEMPR, SEQSAL, CODFILIAL, CODEMP);
ALTER TABLE RHFUNCAO ADD CONSTRAINT RHFUNCAOPK PRIMARY KEY (CODFUNC, CODFILIAL, CODEMP);
ALTER TABLE RHNIVELCURSO ADD CONSTRAINT RHNIVELCURSOPK PRIMARY KEY (CODNIVELCURSO, CODFILIAL, CODEMP);
ALTER TABLE RHPONTO ADD CONSTRAINT RHPONTOPK PRIMARY KEY (DTPT, HRPT, MATEMPR, CODFILIAL, CODEMP);
ALTER TABLE RHTURNO ADD CONSTRAINT RHTURNOPK PRIMARY KEY (CODTURNO, CODFILIAL, CODEMP);
ALTER TABLE RHVAGA ADD CONSTRAINT RHVAGAPK PRIMARY KEY (CODVAGA, CODFILIAL, CODEMP);
ALTER TABLE RHVAGACANDIDATO ADD CONSTRAINT RHVAGACANDPK PRIMARY KEY (CODVAGA, CODFILIAL, CODEMP, CODCAND, CODFILIALCA, CODEMPCA);
ALTER TABLE RHVAGACARACQUALI ADD CONSTRAINT RHVAGACTRQUALIPK PRIMARY KEY (CODVAGA, CODFILIAL, CODEMP, CODCARAC, CODFILIALCT, CODEMPCT);
ALTER TABLE RHVAGACARACREST ADD CONSTRAINT RHVAGACTRESTPK PRIMARY KEY (CODVAGA, CODFILIAL, CODEMP, CODCARAC, CODFILIALCT, CODEMPCT);
ALTER TABLE RHVAGACURSO ADD CONSTRAINT RHVAGACURSOPK PRIMARY KEY (CODVAGA, CODFILIAL, CODEMP, CODCURSO, CODFILIALCS, CODEMPCS);
ALTER TABLE RHVAGASTATUS ADD CONSTRAINT RHVAGASTATUSPK PRIMARY KEY (CODVAGA, CODFILIAL, CODEMP, SQSTVAGA);
ALTER TABLE SGACESSOEU ADD CONSTRAINT SGACESSOEUPK PRIMARY KEY (CODFILIALFL, CODEMPFL, IDUSU, CODEMP, CODFILIAL);
ALTER TABLE SGACESSOMG ADD CONSTRAINT SGACESSOMGPK PRIMARY KEY (CODMENU, CODMODU, CODSIS, IDGRPUSU, CODFILIAL, CODEMP);
ALTER TABLE SGACESSOMU ADD CONSTRAINT SGACESSOMUPK PRIMARY KEY (CODMENU, CODMODU, CODSIS, IDUSU, CODFILIAL, CODEMP);
ALTER TABLE SGAGENDA ADD CONSTRAINT SGAGENDAPK PRIMARY KEY (CODAGE, TIPOAGE, CODAGD, CODFILIAL, CODEMP);
ALTER TABLE SGAGENTE ADD CONSTRAINT SGAGENTEPK PRIMARY KEY (CODAGE, TIPOAGE, CODFILIAL, CODEMP);
ALTER TABLE SGATRIBUICAO ADD CONSTRAINT SGATRIBUICAOPK PRIMARY KEY (IDATRIB, CODFILIAL, CODEMP);
ALTER TABLE SGATRIBUSU ADD CONSTRAINT SGATRIBUSUPK PRIMARY KEY (IDUSU, CODFILIALUU, CODEMPUU, IDATRIB, CODFILIAL, CODEMP);
ALTER TABLE SGCIDADE ADD CONSTRAINT PK_SGCIDADE PRIMARY KEY (CODCID);
ALTER TABLE SGCONEXAO ADD CONSTRAINT SGCONEXAOPK PRIMARY KEY (NRCONEXAO);
ALTER TABLE SGEMPRESA ADD CONSTRAINT SGEMPRESAPK PRIMARY KEY (CODEMP);
ALTER TABLE SGEQVCLIFOR ADD CONSTRAINT SGEQVCLIFORPK PRIMARY KEY (CODCLI, CODFILIALCL, CODEMPCL, CODFOR, CODFILIALFR, CODEMPFR);
ALTER TABLE SGESTACAO ADD CONSTRAINT SGESTACAOPK PRIMARY KEY (CODEST, CODFILIAL, CODEMP)
USING INDEX SGESTACAOIDXPK;
ALTER TABLE SGESTACAOIMP ADD CONSTRAINT SGESTACAOIMPPK PRIMARY KEY (CODEST, NROIMP, CODFILIAL, CODEMP);
ALTER TABLE SGESTCIVIL ADD CONSTRAINT SGESTCIVILPK PRIMARY KEY (CODESTCIVIL, CODFILIAL, CODEMP);
ALTER TABLE SGFERIADO ADD CONSTRAINT SGFERIADOPK PRIMARY KEY (DATAFER, CODFILIAL, CODEMP);
ALTER TABLE SGFILIAL ADD CONSTRAINT SGFILIALPK PRIMARY KEY (CODFILIAL, CODEMP);
ALTER TABLE SGFLUXO ADD CONSTRAINT SGFLUXOPK PRIMARY KEY (CODFLUXO, CODFILIAL, CODEMP);
ALTER TABLE SGGATILHO ADD CONSTRAINT SGGATILHOPK PRIMARY KEY (CODOBJ, DISPGAT, CODEMP);
ALTER TABLE SGGRAUINST ADD CONSTRAINT SGGRAUINSTPK PRIMARY KEY (CODGRI, CODFILIAL, CODEMP);
ALTER TABLE SGGRPUSU ADD CONSTRAINT SGGRPUSUPK PRIMARY KEY (IDGRPUSU, CODFILIAL, CODEMP);
ALTER TABLE SGIMPRESSORA ADD CONSTRAINT SGIMPRESSORAPK PRIMARY KEY (CODIMP, CODFILIAL, CODEMP);
ALTER TABLE SGITFLUXO ADD CONSTRAINT SGITFLUXOPK PRIMARY KEY (CODFLUXO, SEQITFLUXO, CODFILIAL, CODEMP);
ALTER TABLE SGITPREFERE6 ADD CONSTRAINT SGITPREFERE6PK PRIMARY KEY (CODBANCO, TIPOFEBRABAN, CODFILIALBO, CODEMPBO, CODFILIAL, CODEMP);
ALTER TABLE SGITPROCESSO ADD CONSTRAINT SGITPROCESSOPK PRIMARY KEY (CODPROC, SEQITPROC, CODFILIAL, CODEMP);
ALTER TABLE SGITTABELA ADD CONSTRAINT SGITTABELAPK PRIMARY KEY (CODITTB, CODTB, CODFILIAL, CODEMP);
ALTER TABLE SGLOG ADD CONSTRAINT SGLOGPK PRIMARY KEY (CODLOG, CODFILIAL, CODEMP);
ALTER TABLE SGMENU ADD CONSTRAINT SGMENUPK PRIMARY KEY (CODMENU, CODMODU, CODSIS);
ALTER TABLE SGMENUOBJ ADD CONSTRAINT SGMENUOBJOK PRIMARY KEY (CODMENU, CODMODU, CODSIS, IDOBJ, CODEMP);
ALTER TABLE SGMODETIQUETA ADD CONSTRAINT SGMODETIQUETAPK PRIMARY KEY (CODMODETIQ, CODFILIAL, CODEMP);
ALTER TABLE SGMODULO ADD CONSTRAINT SGMODULOPK PRIMARY KEY (CODMODU, CODSIS);
ALTER TABLE SGMUNICIPIO ADD CONSTRAINT SGMUNICIPIOPK PRIMARY KEY (CODMUNIC, SIGLAUF, CODPAIS);
ALTER TABLE SGOBJETO ADD CONSTRAINT SGOBJETOPK PRIMARY KEY (IDOBJ, CODEMP);
ALTER TABLE SGOBJETOTB ADD CONSTRAINT SGOBJETOTBPK PRIMARY KEY (CODTB, CODFILIALTB, CODEMPTB, IDOBJ, CODEMP);
ALTER TABLE SGPAIS ADD CONSTRAINT SGPAISPK PRIMARY KEY (CODPAIS);
ALTER TABLE SGPAPEL ADD CONSTRAINT SGPAPELPK PRIMARY KEY (CODPAPEL, CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1PK PRIMARY KEY (CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE2 ADD CONSTRAINT PKSGPREFERE2 PRIMARY KEY (CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE4 ADD CONSTRAINT SGPREFERE4PK PRIMARY KEY (CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE5 ADD CONSTRAINT SGPREFERE5PK PRIMARY KEY (CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE6 ADD CONSTRAINT SGPREFERE6PK PRIMARY KEY (CODFILIAL, CODEMP);
ALTER TABLE SGPROCESSO ADD CONSTRAINT SGPROCESSOPK PRIMARY KEY (CODPROC, CODFILIAL, CODEMP);
ALTER TABLE SGSEQUENCIA ADD CONSTRAINT SGSEQUENCIAPK PRIMARY KEY (SGTAB, CODFILIAL, CODEMP);
ALTER TABLE SGSISTEMA ADD CONSTRAINT SGSISTEMAPK PRIMARY KEY (CODSIS);
ALTER TABLE SGTABELA ADD CONSTRAINT SGTABELAPK PRIMARY KEY (CODTB, CODFILIAL, CODEMP);
ALTER TABLE SGTAREFA ADD CONSTRAINT SGTAREFAPK PRIMARY KEY (CODTAREFA, CODFILIAL, CODEMP);
ALTER TABLE SGTIPOAGENDA ADD CONSTRAINT PK_SGTIPOAGENDA PRIMARY KEY (CODEMP, CODFILIAL, CODTIPOAGD);
ALTER TABLE SGTRATARET ADD CONSTRAINT SGTRATARETPK PRIMARY KEY (CODPROC, CODTRATRET, SEQITPROC, CODFILIAL, CODEMP);
ALTER TABLE SGUF ADD CONSTRAINT SGUFPK PRIMARY KEY (SIGLAUF, CODPAIS);
ALTER TABLE SGUSUARIO ADD CONSTRAINT SGUSUARIOPK PRIMARY KEY (IDUSU, CODFILIAL, CODEMP);
ALTER TABLE SGVARIAVEL ADD CONSTRAINT SGVARIAVELPK PRIMARY KEY (IDVAR, IDCON);
ALTER TABLE SVAVALIACAO ADD CONSTRAINT SVAVALIACAOPK PRIMARY KEY (CODOS, CODITOS, CODAVAL, CODFILIAL, CODEMP);
ALTER TABLE SVEXECUCAO ADD CONSTRAINT SVEXECUCAOPK PRIMARY KEY (CODOS, CODITOS, CODEXEC, CODFILIAL, CODEMP);
ALTER TABLE SVITOS ADD CONSTRAINT SVITOSPK PRIMARY KEY (CODOS, CODITOS, CODFILIAL, CODEMP);
ALTER TABLE SVOS ADD CONSTRAINT SVOSPK PRIMARY KEY (CODOS, CODFILIAL, CODEMP);
ALTER TABLE TKATIVIDADE ADD CONSTRAINT TKATIVIDADEPK PRIMARY KEY (CODATIV, CODFILIAL, CODEMP);
ALTER TABLE TKCAMPANHA ADD CONSTRAINT TKCAMPANHAPK PRIMARY KEY (CODCAMP, CODFILIAL, CODEMP);
ALTER TABLE TKCAMPANHACTO ADD CONSTRAINT TKCAMPANHACTOPK PRIMARY KEY (CODCAMP, CODFILIAL, CODEMP, CODCTO, CODFILIALCO, CODEMPCO);
ALTER TABLE TKCAMPANHAEMAIL ADD CONSTRAINT TKCAMPANHAEMAILPK PRIMARY KEY (CODCAMP, CODFILIAL, CODEMP, CODEMAIL, CODFILIALEM, CODEMPEM);
ALTER TABLE TKCONFEMAIL ADD CONSTRAINT TKCONFEMAILPK PRIMARY KEY (CODCONFEMAIL, CODFILIAL, CODEMP);
ALTER TABLE TKCONTATO ADD CONSTRAINT TKCONTATOPK PRIMARY KEY (CODCTO, CODFILIAL, CODEMP);
ALTER TABLE TKCTOATIV ADD CONSTRAINT TKCTOATIVPK PRIMARY KEY (CODCTO, CODFILIAL, CODEMP, CODATIV, CODFILIALAV, CODEMPAV);
ALTER TABLE TKCTOGRPINT ADD CONSTRAINT TKCTOGRPINTPK PRIMARY KEY (CODCTO, CODFILIAL, CODEMP, CODGRUP, CODFILIALGP, CODEMPGP);
ALTER TABLE TKEMAIL ADD CONSTRAINT TKEMAILPK PRIMARY KEY (CODEMAIL, CODFILIAL, CODEMP);
ALTER TABLE TKHISTORICO ADD CONSTRAINT TKHISTORICOPK PRIMARY KEY (CODHISTTK, CODFILIAL, CODEMP);
ALTER TABLE TKORIGCONT ADD CONSTRAINT TKORIGCONTPK PRIMARY KEY (CODORIGCONT, CODFILIAL, CODEMP);
ALTER TABLE TKSETORCTO ADD CONSTRAINT TKSETORCTOPK PRIMARY KEY (CODSETORCTO, CODFILIAL, CODEMP);
ALTER TABLE TKSITCAMP ADD CONSTRAINT TKSITCAMPPK PRIMARY KEY (CODCAMP, CODFILIAL, CODEMP, CODCTO, CODFILIALCO, CODEMPCO, SEQSITCAMP);
ALTER TABLE TKTIPOIMP ADD CONSTRAINT TKTIPOIMPPK PRIMARY KEY (CODTPIMP, CODFILIAL, CODEMP);
ALTER TABLE VDAUXVENDA ADD CONSTRAINT VDAUXVENDAPK PRIMARY KEY (CODVENDA, CODAUXV, TIPOVENDA, CODFILIAL, CODEMP);
ALTER TABLE VDCLASCLI ADD CONSTRAINT VDCLASCLIPK PRIMARY KEY (CODCLASCLI, CODFILIAL, CODEMP);
ALTER TABLE VDCLCOMIS ADD CONSTRAINT VDCLCOMISPK PRIMARY KEY (CODCLCOMIS, CODFILIAL, CODEMP);
ALTER TABLE VDCLIAUTP ADD CONSTRAINT VDCLIAUTPPK PRIMARY KEY (CODCLI, CODAUTP, CODFILIAL, CODEMP);
ALTER TABLE VDCLICOMPL ADD CONSTRAINT VDCLICOMPLPK PRIMARY KEY (CODCLI, CODFILIAL, CODEMP);
ALTER TABLE VDCLICONTAS ADD CONSTRAINT VDCLICONTASPK PRIMARY KEY (CODCLI, CODFILIAL, CODEMP, CONTA);
ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTEPK PRIMARY KEY (CODCLI, CODFILIAL, CODEMP);
ALTER TABLE VDCLIENTEFOR ADD CONSTRAINT VDCLIENTEFORPK PRIMARY KEY (CODCLI, CODFILIAL, CODEMP, CODFOR, CODFILIALFR, CODEMPFR);
ALTER TABLE VDCLIIMOV ADD CONSTRAINT VDCLIIMOVPK PRIMARY KEY (CODCLI, CODFILIAL, CODEMP, CODIMOV);
ALTER TABLE VDCLIMETAVEND ADD CONSTRAINT VDCLIMETAVENDPK PRIMARY KEY (CODCLI, CODFILIAL, CODEMP, ANOMETAVEND);
ALTER TABLE VDCLIREFC ADD CONSTRAINT VDCLIREFCPK PRIMARY KEY (CODCLI, CODREFC, CODFILIAL, CODEMP);
ALTER TABLE VDCLIREFP ADD CONSTRAINT VDCLIREFPPK PRIMARY KEY (CODCLI, CODREFP, CODFILIAL, CODEMP);
ALTER TABLE VDCLISOCIOS ADD CONSTRAINT VDCLISOCIOSPK PRIMARY KEY (CODCLI, CODFILIAL, CODEMP, NOMESOCIO);
ALTER TABLE VDCLITERRA ADD CONSTRAINT VDCLITERRAPK PRIMARY KEY (CODCLI, CODFILIAL, CODEMP, CODTERRA);
ALTER TABLE VDCLIVEIC ADD CONSTRAINT VDCLIVEICPK PRIMARY KEY (PLACAVEIC, CODCLI, CODFILIAL, CODEMP);
ALTER TABLE VDCOMISSAO ADD CONSTRAINT VDCOMISSAOPK PRIMARY KEY (CODCOMI, CODFILIAL, CODEMP);
ALTER TABLE VDCONTRATO ADD CONSTRAINT VDCONTRATOPK PRIMARY KEY (CODCONTR, CODFILIAL, CODEMP);
ALTER TABLE VDFOTOPROD ADD CONSTRAINT VDFOTOPRODPK PRIMARY KEY (CODFOTOPROD, CODPROD, CODFILIAL, CODEMP);
ALTER TABLE VDFRETEVD ADD CONSTRAINT VDFRETEVDPK PRIMARY KEY (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP);
ALTER TABLE VDITCONTRATO ADD CONSTRAINT VDIDCONTRATOPK PRIMARY KEY (CODCONTR, CODITCONTR, CODFILIAL, CODEMP);
ALTER TABLE VDITKIT ADD CONSTRAINT VDITKITPK PRIMARY KEY (CODKIT, SEQITKIT, CODFILIAL, CODEMP);
ALTER TABLE VDITORCAMENTO ADD CONSTRAINT VDITORCAMENTOPK PRIMARY KEY (CODORC, CODITORC, TIPOORC, CODFILIAL, CODEMP);
ALTER TABLE VDITREGRACOMIS ADD CONSTRAINT VDITREGRACOMISPK PRIMARY KEY (CODREGRCOMIS, SEQITRC, CODFILIAL, CODEMP);
ALTER TABLE VDITROMANEIO ADD CONSTRAINT VDITROMANEIO PRIMARY KEY (CODITROMA, CODROMA, CODFILIAL, CODEMP);
ALTER TABLE VDITVENDA ADD CONSTRAINT VDITVENDAPK PRIMARY KEY (CODVENDA, CODITVENDA, TIPOVENDA, CODFILIAL, CODEMP);
ALTER TABLE VDKIT ADD CONSTRAINT VDKITPK PRIMARY KEY (CODKIT, CODFILIAL, CODEMP);
ALTER TABLE VDOBSCLI ADD CONSTRAINT VDOBSCLIPK PRIMARY KEY (CODCLI, SEQOBSCLI, CODFILIAL, CODEMP);
ALTER TABLE VDORCAMENTO ADD CONSTRAINT VDORCAMENTOPK PRIMARY KEY (CODORC, TIPOORC, CODFILIAL, CODEMP);
ALTER TABLE VDPRAZOENT ADD CONSTRAINT VDPRAZOENTPK PRIMARY KEY (CODPE, CODFILIAL, CODEMP);
ALTER TABLE VDPRECOPROD ADD CONSTRAINT VDPRECOPRODPK PRIMARY KEY (CODPRECOPROD, CODPROD, CODFILIAL, CODEMP);
ALTER TABLE VDREGRACOMIS ADD CONSTRAINT VDREGRACOMISPK PRIMARY KEY (CODREGRCOMIS, CODFILIAL, CODEMP);
ALTER TABLE VDROMANEIO ADD CONSTRAINT VDROMANEIOPK PRIMARY KEY (CODROMA, CODFILIAL, CODEMP);
ALTER TABLE VDSETOR ADD CONSTRAINT VDSETORPK PRIMARY KEY (CODSETOR, CODFILIAL, CODEMP);
ALTER TABLE VDSTATUSORC ADD CONSTRAINT VDSTATUSORCPK PRIMARY KEY (CODORC, TIPOORC, CODFILIAL, CODEMP, CODITTB, CODTB, CODFILIALTB, CODEMPTB);
ALTER TABLE VDTABPRECO ADD CONSTRAINT VDTABPRECOPK PRIMARY KEY (CODTAB, CODFILIAL, CODEMP);
ALTER TABLE VDTEF ADD CONSTRAINT VDTEFPK PRIMARY KEY (CODVENDA, NSUTEF, TIPOVENDA, CODFILIAL, CODEMP)
USING INDEX PK_VDTEF;
ALTER TABLE VDTIPOCLI ADD CONSTRAINT VDTIPOCLIPK PRIMARY KEY (CODTIPOCLI, CODFILIAL, CODEMP);
ALTER TABLE VDTIPOVEND ADD CONSTRAINT VDTIPOVENDPK PRIMARY KEY (CODTIPOVEND, CODFILIAL, CODEMP);
ALTER TABLE VDTRANSP ADD CONSTRAINT VDTRANSPPK PRIMARY KEY (CODTRAN, CODFILIAL, CODEMP);
ALTER TABLE VDVENDA ADD CONSTRAINT VDVENDAPK PRIMARY KEY (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP);
ALTER TABLE VDVENDACOMIS ADD CONSTRAINT VDVENDACOMISPK PRIMARY KEY (CODVENDA, TIPOVENDA, SEQVC, CODFILIAL, CODEMP);
ALTER TABLE VDVENDAORC ADD CONSTRAINT VDVENDAORCPK PRIMARY KEY (CODVENDA, CODITVENDA, TIPOVENDA, CODFILIAL, CODEMP, CODORC, CODITORC, TIPOORC, CODFILIALOR, CODEMPOR);
ALTER TABLE VDVENDEDOR ADD CONSTRAINT VDVENDEDORPK PRIMARY KEY (CODVEND, CODFILIAL, CODEMP);


/******************************************************************************/
/*                                Foreign Keys                                */
/******************************************************************************/

ALTER TABLE ATATENDENTE ADD CONSTRAINT ATATENDENTEFKSGFIL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE ATATENDENTE ADD CONSTRAINT ATATENDENTEFKSGUSU FOREIGN KEY (IDUSU, CODFILIALUS, CODEMPUS) REFERENCES SGUSUARIO (IDUSU, CODFILIAL, CODEMP);
ALTER TABLE ATATENDENTE ADD CONSTRAINT ATATENDENTEFKVDVEN FOREIGN KEY (CODVEND, CODFILIALVE, CODEMPVE) REFERENCES VDVENDEDOR (CODVEND, CODFILIAL, CODEMP);
ALTER TABLE ATATENDIMENTO ADD CONSTRAINT ATATENDIMENTOFKATA FOREIGN KEY (CODATEND, CODFILIALAE, CODEMPAE) REFERENCES ATATENDENTE (CODATEND, CODFILIAL, CODEMP);
ALTER TABLE ATATENDIMENTO ADD CONSTRAINT ATATENDIMENTOFKATC FOREIGN KEY (CODCONV, CODFILIALCV, CODEMPCV) REFERENCES ATCONVENIADO (CODCONV, CODFILIAL, CODEMP);
ALTER TABLE ATATENDIMENTO ADD CONSTRAINT ATATENDIMENTOFKATT FOREIGN KEY (CODTPATENDO, CODFILIALTO, CODEMPTO) REFERENCES ATTIPOATENDO (CODTPATENDO, CODFILIAL, CODEMP);
ALTER TABLE ATATENDIMENTO ADD CONSTRAINT ATATENDIMENTOFKSET FOREIGN KEY (CODSETAT, CODFILIALSA, CODEMPSA) REFERENCES ATSETOR (CODSETAT, CODFILIAL, CODEMP);
ALTER TABLE ATATENDIMENTO ADD CONSTRAINT ATATENDIMENTOFKSGF FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE ATATENDIMENTO ADD CONSTRAINT ATATENDIMENTOFKSGU FOREIGN KEY (IDUSU, CODFILIALUS, CODEMPUS) REFERENCES SGUSUARIO (IDUSU, CODFILIAL, CODEMP);
ALTER TABLE ATATENDIMENTO ADD CONSTRAINT ATATENDIMENTOFKVDCLI FOREIGN KEY (CODCLI, CODFILIALCL, CODEMPCL) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);
ALTER TABLE ATATENDIMENTOORC ADD CONSTRAINT ATATENDIMENORFKATA FOREIGN KEY (CODATENDO, CODFILIAL, CODEMP) REFERENCES ATATENDIMENTO (CODATENDO, CODFILIAL, CODEMP);
ALTER TABLE ATATENDIMENTOORC ADD CONSTRAINT ATATENDIMENORFKVDO FOREIGN KEY (CODORC, TIPOORC, CODFILIALOC, CODEMPOC) REFERENCES VDORCAMENTO (CODORC, TIPOORC, CODFILIAL, CODEMP);
ALTER TABLE ATATRIBUICAO ADD CONSTRAINT ATATRIBUICAOFKSGFI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE ATCONVATRIB ADD CONSTRAINT ATCONVATRIBFKATATR FOREIGN KEY (CODATRIB, CODFILIALAB, CODEMPAB) REFERENCES ATATRIBUICAO (CODATRIB, CODFILIAL, CODEMP);
ALTER TABLE ATCONVATRIB ADD CONSTRAINT ATCONVATRIBFKATCON FOREIGN KEY (CODCONV, CODFILIAL, CODEMP) REFERENCES ATCONVENIADO (CODCONV, CODFILIAL, CODEMP);
ALTER TABLE ATCONVATRIBTB ADD CONSTRAINT ATCONVATRIBTBFKATC FOREIGN KEY (CODCONV, SEQCONVATRIB, CODFILIAL, CODEMP) REFERENCES ATCONVATRIB (CODCONV, SEQCONVATRIB, CODFILIAL, CODEMP);
ALTER TABLE ATCONVATRIBTB ADD CONSTRAINT ATCONVATRIBTBFKSGI FOREIGN KEY (CODITTB, CODTB, CODFILIALTB, CODEMPTB) REFERENCES SGITTABELA (CODITTB, CODTB, CODFILIAL, CODEMP);
ALTER TABLE ATCONVENIADO ADD CONSTRAINT ATCONVENIADOFKATEN FOREIGN KEY (CODENC, CODFILIALEC, CODEMPEC) REFERENCES ATENCAMINHADOR (CODENC, CODFILIAL, CODEMP);
ALTER TABLE ATCONVENIADO ADD CONSTRAINT ATCONVENIADOFKATTI FOREIGN KEY (CODTPCONV, CODFILIALTC, CODEMPTC) REFERENCES ATTIPOCONV (CODTPCONV, CODFILIAL, CODEMP);
ALTER TABLE ATCONVENIADO ADD CONSTRAINT ATCONVENIADOFKRHFU FOREIGN KEY (CODFUNC, CODFILIALFC, CODEMPFC) REFERENCES RHFUNCAO (CODFUNC, CODFILIAL, CODEMP);
ALTER TABLE ATCONVENIADO ADD CONSTRAINT ATCONVENIADOFKSGFI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE ATCONVENIADO ADD CONSTRAINT ATCONVENIADOFKSGGR FOREIGN KEY (CODGRI, CODFILIALGI, CODEMPGI) REFERENCES SGGRAUINST (CODGRI, CODFILIAL, CODEMP);
ALTER TABLE ATENCAMINHADOR ADD CONSTRAINT ATENCAMINHADORFKSG FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE ATSETOR ADD CONSTRAINT ATSETORFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE ATSETORATENDENTE ADD CONSTRAINT ATSETORATENDFKATAT FOREIGN KEY (CODATEND, CODFILIALAE, CODEMPAE) REFERENCES ATATENDENTE (CODATEND, CODFILIAL, CODEMP);
ALTER TABLE ATSETORATENDENTE ADD CONSTRAINT ATSETORATENDFKATSE FOREIGN KEY (CODSETAT, CODFILIAL, CODEMP) REFERENCES ATSETOR (CODSETAT, CODFILIAL, CODEMP);
ALTER TABLE ATTIPOATEND ADD CONSTRAINT ATTIPOATENDFKSGFIL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE ATTIPOATENDO ADD CONSTRAINT ATTIPOATENDOFKSGFI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE ATTIPOATENDO ADD CONSTRAINT ATTIPOATENDOFLUXO FOREIGN KEY (CODFLUXO, CODFILIALFX, CODEMPFX) REFERENCES SGFLUXO (CODFLUXO, CODFILIAL, CODEMP);
ALTER TABLE ATTIPOATENDOSETOR ADD CONSTRAINT ATTIPOATDOSETFKATS FOREIGN KEY (CODSETAT, CODFILIALST, CODEMPST) REFERENCES ATSETOR (CODSETAT, CODFILIAL, CODEMP);
ALTER TABLE ATTIPOATENDOSETOR ADD CONSTRAINT ATTIPOATDOSETFKATT FOREIGN KEY (CODTPATENDO, CODFILIAL, CODEMP) REFERENCES ATTIPOATENDO (CODTPATENDO, CODFILIAL, CODEMP);
ALTER TABLE ATTIPOCONV ADD CONSTRAINT ATTIPOCONVFKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE CPCOMPRA ADD CONSTRAINT CPCOMPRAFKCPFORNEC FOREIGN KEY (CODFOR, CODFILIALFR, CODEMPFR) REFERENCES CPFORNECED (CODFOR, CODFILIAL, CODEMP);
ALTER TABLE CPCOMPRA ADD CONSTRAINT CPCOMPRAFKCPSOLICI FOREIGN KEY (CODSOL, CODFILIALSOL, CODEMPSOL) REFERENCES CPSOLICITACAO (CODSOL, CODFILIAL, CODEMP);
ALTER TABLE CPCOMPRA ADD CONSTRAINT CPCOMPRAFKEQTIPOMO FOREIGN KEY (CODTIPOMOV, CODFILIALTM, CODEMPTM) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);
ALTER TABLE CPCOMPRA ADD CONSTRAINT CPCOMPRAFKFNBANCO FOREIGN KEY (CODBANCO, CODFILIALBO, CODEMPBO) REFERENCES FNBANCO (CODBANCO, CODFILIAL, CODEMP);
ALTER TABLE CPCOMPRA ADD CONSTRAINT CPCOMPRAFKFNPLANOP FOREIGN KEY (CODPLANOPAG, CODFILIALPG, CODEMPPG) REFERENCES FNPLANOPAG (CODPLANOPAG, CODFILIAL, CODEMP);
ALTER TABLE CPCOMPRA ADD CONSTRAINT CPCOMPRAFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE CPCOMPRA ADD CONSTRAINT CPCOMPRAFKVDTRANS FOREIGN KEY (CODTRAN, CODFILIALTN, CODEMPTN) REFERENCES VDTRANSP (CODTRAN, CODFILIAL, CODEMP);
ALTER TABLE CPCOMPRAVENDA ADD CONSTRAINT CPCOMPRAVENDAFKCPI FOREIGN KEY (CODITCOMPRA, CODCOMPRA, CODFILIAL, CODEMP) REFERENCES CPITCOMPRA (CODITCOMPRA, CODCOMPRA, CODFILIAL, CODEMP);
ALTER TABLE CPCOMPRAVENDA ADD CONSTRAINT CPCOMPRAVENDAFKVDI FOREIGN KEY (CODVENDA, CODITVENDA, TIPOVENDA, CODFILIALVD, CODEMPVD) REFERENCES VDITVENDA (CODVENDA, CODITVENDA, TIPOVENDA, CODFILIAL, CODEMP);
ALTER TABLE CPEQUIVCFOP ADD CONSTRAINT CPEQUIVCFOPFKLFNAN FOREIGN KEY (CODNATND, CODFILIALND, CODEMPND) REFERENCES LFNATOPER (CODNAT, CODFILIAL, CODEMP);
ALTER TABLE CPEQUIVCFOP ADD CONSTRAINT CPEQUIVCFOPFKLFNAT FOREIGN KEY (CODNAT, CODFILIAL, CODEMP) REFERENCES LFNATOPER (CODNAT, CODFILIAL, CODEMP);
ALTER TABLE CPFORNECED ADD CONSTRAINT CPFORNECEDFKCPTIPO FOREIGN KEY (CODTIPOFOR, CODFILIALTF, CODEMPTF) REFERENCES CPTIPOFOR (CODTIPOFOR, CODFILIAL, CODEMP);
ALTER TABLE CPFORNECED ADD CONSTRAINT CPFORNECEDFKFNBANC FOREIGN KEY (CODBANCO, CODFILIALBO, CODEMPBO) REFERENCES FNBANCO (CODBANCO, CODFILIAL, CODEMP);
ALTER TABLE CPFORNECED ADD CONSTRAINT CPFORNECEDFKFNHIST FOREIGN KEY (CODHIST, CODFILIALHP, CODEMPHP) REFERENCES FNHISTPAD (CODHIST, CODFILIAL, CODEMP);
ALTER TABLE CPFORNECED ADD CONSTRAINT CPFORNECEDFKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE CPFORNECED ADD CONSTRAINT CPFORNECEDFKSGMUNIC FOREIGN KEY (CODMUNIC, SIGLAUF, CODPAIS) REFERENCES SGMUNICIPIO (CODMUNIC, SIGLAUF, CODPAIS);
ALTER TABLE CPITCOMPRA ADD CONSTRAINT CPITCOMPRAFKCPCOMP FOREIGN KEY (CODCOMPRA, CODFILIAL, CODEMP) REFERENCES CPCOMPRA (CODCOMPRA, CODFILIAL, CODEMP);
ALTER TABLE CPITCOMPRA ADD CONSTRAINT CPITCOMPRAFKEQALMO FOREIGN KEY (CODALMOX, CODFILIALAX, CODEMPAX) REFERENCES EQALMOX (CODALMOX, CODFILIAL, CODEMP);
ALTER TABLE CPITCOMPRA ADD CONSTRAINT CPITCOMPRAFKEQLOTE FOREIGN KEY (CODLOTE, CODPROD, CODFILIALLE, CODEMPLE) REFERENCES EQLOTE (CODLOTE, CODPROD, CODFILIAL, CODEMP);
ALTER TABLE CPITCOMPRA ADD CONSTRAINT CPITCOMPRAFKEQPROD FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);
ALTER TABLE CPITCOMPRA ADD CONSTRAINT CPITCOMPRAFKLFNATO FOREIGN KEY (CODNAT, CODFILIALNT, CODEMPNT) REFERENCES LFNATOPER (CODNAT, CODFILIAL, CODEMP);
ALTER TABLE CPITSOLICITACAO ADD CONSTRAINT CPITSOLICITFKCPSOL FOREIGN KEY (CODSOL, CODFILIAL, CODEMP) REFERENCES CPSOLICITACAO (CODSOL, CODFILIAL, CODEMP);
ALTER TABLE CPITSOLICITACAO ADD CONSTRAINT CPITSOLICITFKEQALM FOREIGN KEY (CODALMOX, CODFILIALAM, CODEMPAM) REFERENCES EQALMOX (CODALMOX, CODFILIAL, CODEMP);
ALTER TABLE CPITSOLICITACAO ADD CONSTRAINT CPITSOLICITFKEQPRO FOREIGN KEY (CODPROD, CODFILIAL, CODEMP) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);
ALTER TABLE CPITSUMSOL ADD CONSTRAINT CPITSUMSOLFKCPITSO FOREIGN KEY (CODSOL, CODITSOL, CODFILIALSC, CODEMPSC) REFERENCES CPITSOLICITACAO (CODSOL, CODITSOL, CODFILIAL, CODEMP);
ALTER TABLE CPPRODFOR ADD CONSTRAINT CPPRODFORFKCPFORNE FOREIGN KEY (CODFOR, CODFILIAL, CODEMP) REFERENCES CPFORNECED (CODFOR, CODFILIAL, CODEMP);
ALTER TABLE CPPRODFOR ADD CONSTRAINT CPPRODFORFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE CPRATEIO ADD CONSTRAINT CPRATEIOFKCPCOMPRA FOREIGN KEY (CODCOMPRA, CODFILIAL, CODEMP) REFERENCES CPCOMPRA (CODCOMPRA, CODFILIAL, CODEMP);
ALTER TABLE CPRATEIO ADD CONSTRAINT CPRATEIOFKFNCC FOREIGN KEY (CODCC, ANOCC, CODFILIALCC, CODEMPCC) REFERENCES FNCC (CODCC, ANOCC, CODFILIAL, CODEMP);
ALTER TABLE CPRATEIO ADD CONSTRAINT CPRATEIOFKFNPLANEJ FOREIGN KEY (CODPLAN, CODFILIALFN, CODEMPFN) REFERENCES FNPLANEJAMENTO (CODPLAN, CODFILIAL, CODEMP);
ALTER TABLE CPSOLICITACAO ADD CONSTRAINT CPSOLICITACAOFKFNC FOREIGN KEY (CODCC, ANOCC, CODFILIALCC, CODEMPCC) REFERENCES FNCC (CODCC, ANOCC, CODFILIAL, CODEMP);
ALTER TABLE CPSOLICITACAO ADD CONSTRAINT CPSOLICITACAOFKSGF FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE CPSOLICITACAO ADD CONSTRAINT CPSOLICITACAOFKSGU FOREIGN KEY (IDUSU, CODFILIALUU, CODEMPUU) REFERENCES SGUSUARIO (IDUSU, CODFILIAL, CODEMP);
ALTER TABLE CPSUMSOL ADD CONSTRAINT CPSUMSOLFKEQPRODUT FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);
ALTER TABLE CPTABFOR ADD CONSTRAINT CPTABFORFKCPFORNEC FOREIGN KEY (CODFOR, CODFILIAL, CODEMP) REFERENCES CPFORNECED (CODFOR, CODFILIAL, CODEMP);
ALTER TABLE CPTABFOR ADD CONSTRAINT CPTABFORFKEQPRODUT FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);
ALTER TABLE CPTIPOFOR ADD CONSTRAINT CPTIPOFORFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE EQALMOX ADD CONSTRAINT EQALMOXFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE EQALMOXFILIAL ADD CONSTRAINT EQALMOXFILIALFKEQA FOREIGN KEY (CODALMOX, CODFILIAL, CODEMP) REFERENCES EQALMOX (CODALMOX, CODFILIAL, CODEMP);
ALTER TABLE EQALMOXFILIAL ADD CONSTRAINT EQALMOXFILIALFKSGF FOREIGN KEY (CODFILIALAF, CODEMPAF) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE EQCLIFOR ADD CONSTRAINT EQCLIFORFKVDCLIENT FOREIGN KEY (CODCLI, CODFILIAL, CODEMP) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);
ALTER TABLE EQCLIFOR ADD CONSTRAINT EQCLIFORFKVDFORNEC FOREIGN KEY (CODFOR, CODFILIALFR, CODEMPFR) REFERENCES CPFORNECED (CODFOR, CODFILIAL, CODEMP);
ALTER TABLE EQCODALTPROD ADD CONSTRAINT EQCODALTPRODFKEQPR FOREIGN KEY (CODPROD, CODFILIAL, CODEMP) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);
ALTER TABLE EQFATCONV ADD CONSTRAINT EQFATCONVFKEQPRODU FOREIGN KEY (CODPROD, CODFILIAL, CODEMP) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);
ALTER TABLE EQFATCONV ADD CONSTRAINT EQFATCONVFKEQUNIDA FOREIGN KEY (CODUNID, CODFILIAL, CODEMP) REFERENCES EQUNIDADE (CODUNID, CODFILIAL, CODEMP);
ALTER TABLE EQFATCONV ADD CONSTRAINT EQFATCONVFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE EQGRUPO ADD CONSTRAINT EQGRUPOFKEQGRUPO FOREIGN KEY (CODSUBGRUP, CODFILIAL, CODEMP) REFERENCES EQGRUPO (CODGRUP, CODFILIAL, CODEMP);
ALTER TABLE EQGRUPO ADD CONSTRAINT EQGRUPOFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE EQGUIATRAF ADD CONSTRAINT EQGUIATRAFFKCPCOMP FOREIGN KEY (CODCOMPRA, CODFILIAL, CODEMP) REFERENCES CPCOMPRA (CODCOMPRA, CODFILIAL, CODEMP);
ALTER TABLE EQINVPROD ADD CONSTRAINT EQINVPRODFKEQALMOX FOREIGN KEY (CODALMOX, CODFILIALAX, CODEMPAX) REFERENCES EQALMOX (CODALMOX, CODFILIAL, CODEMP);
ALTER TABLE EQINVPROD ADD CONSTRAINT EQINVPRODFKEQLOTE FOREIGN KEY (CODLOTE, CODPROD, CODFILIALLE, CODEMPLE) REFERENCES EQLOTE (CODLOTE, CODPROD, CODFILIAL, CODEMP);
ALTER TABLE EQINVPROD ADD CONSTRAINT EQINVPRODFKEQPRODU FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);
ALTER TABLE EQINVPROD ADD CONSTRAINT EQINVPRODFKEQTIPOM FOREIGN KEY (CODTIPOMOV, CODFILIALTM, CODEMPTM) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);
ALTER TABLE EQINVPROD ADD CONSTRAINT EQINVPRODFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE EQITMODGRADE ADD CONSTRAINT EGITMODGRADEFKEQMO FOREIGN KEY (CODMODG, CODFILIAL, CODEMP) REFERENCES EQMODGRADE (CODMODG, CODFILIAL, CODEMP);
ALTER TABLE EQITMODGRADE ADD CONSTRAINT EGITMODGRADEFKEQVA FOREIGN KEY (CODVARG, CODFILIAL, CODEMP) REFERENCES EQVARGRADE (CODVARG, CODFILIAL, CODEMP);
ALTER TABLE EQITRMA ADD CONSTRAINT EQITRMAFKEQALMOX FOREIGN KEY (CODALMOX, CODFILIALAX, CODEMPAX) REFERENCES EQALMOX (CODALMOX, CODFILIAL, CODEMP);
ALTER TABLE EQITRMA ADD CONSTRAINT EQITRMAFKEQLOTE FOREIGN KEY (CODLOTE, CODPROD, CODFILIALLE, CODEMPLE) REFERENCES EQLOTE (CODLOTE, CODPROD, CODFILIAL, CODEMP);
ALTER TABLE EQITRMA ADD CONSTRAINT EQITRMAFKEQPRODUTO FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);
ALTER TABLE EQITRMA ADD CONSTRAINT EQITRMAFKEQRMA FOREIGN KEY (CODRMA, CODFILIAL, CODEMP) REFERENCES EQRMA (CODRMA, CODFILIAL, CODEMP);
ALTER TABLE EQITSIMILAR ADD CONSTRAINT EQITSIMILARFKEQPRO FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);
ALTER TABLE EQITSIMILAR ADD CONSTRAINT EQITSIMILARFKEQSIM FOREIGN KEY (CODSIM, CODFILIAL, CODEMP) REFERENCES EQSIMILAR (CODSIM, CODFILIAL, CODEMP);
ALTER TABLE EQLANCTOEXP ADD CONSTRAINT EQLANCTOEXPFKEQTIP FOREIGN KEY (CODTIPOEXP, CODFILIALTE, CODEMPTE) REFERENCES EQTIPOEXP (CODTIPOEXP, CODFILIAL, CODEMP);
ALTER TABLE EQLANCTOEXP ADD CONSTRAINT EQLANCTOEXPFKSGFIL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE EQLANCTOEXP ADD CONSTRAINT EQLANCTOEXPFKVDCLI FOREIGN KEY (CODCLI, CODFILIALCL, CODEMPCL) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);
ALTER TABLE EQLOTE ADD CONSTRAINT EQLOTEFKEQPRODUTO FOREIGN KEY (CODPROD, CODFILIAL, CODEMP) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);
ALTER TABLE EQLOTE ADD CONSTRAINT EQLOTEFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE EQMARCA ADD CONSTRAINT EQMARCAFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE EQMODGRADE ADD CONSTRAINT EQMODGRADEFKEQPROD FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);
ALTER TABLE EQMODGRADE ADD CONSTRAINT EQMODGRADEFKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE EQMOVEXP ADD CONSTRAINT EQMOVEXPFKEQTIPOEX FOREIGN KEY (CODTIPOEXP, CODFILIALTE, CODEMPTE) REFERENCES EQTIPOEXP (CODTIPOEXP, CODFILIAL, CODEMP);
ALTER TABLE EQMOVEXP ADD CONSTRAINT EQMOVEXPFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE EQMOVEXP ADD CONSTRAINT EQMOVEXPFKVDCLIENT FOREIGN KEY (CODCLI, CODFILIALCL, CODEMPCL) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);
ALTER TABLE EQMOVPROD ADD CONSTRAINT EQMOVPRODFKCPITCOM FOREIGN KEY (CODITCOMPRA, CODCOMPRA, CODFILIALCP, CODEMPCP) REFERENCES CPITCOMPRA (CODITCOMPRA, CODCOMPRA, CODFILIAL, CODEMP);
ALTER TABLE EQMOVPROD ADD CONSTRAINT EQMOVPRODFKEQALMOX FOREIGN KEY (CODALMOX, CODFILIALAX, CODEMPAX) REFERENCES EQALMOX (CODALMOX, CODFILIAL, CODEMP);
ALTER TABLE EQMOVPROD ADD CONSTRAINT EQMOVPRODFKEQINVPR FOREIGN KEY (CODINVPROD, CODFILIALIV, CODEMPIV) REFERENCES EQINVPROD (CODINVPROD, CODFILIAL, CODEMP);
ALTER TABLE EQMOVPROD ADD CONSTRAINT EQMOVPRODFKEQITRMA FOREIGN KEY (CODRMA, CODITRMA, CODFILIALRM, CODEMPRM) REFERENCES EQITRMA (CODRMA, CODITRMA, CODFILIAL, CODEMP);
ALTER TABLE EQMOVPROD ADD CONSTRAINT EQMOVPRODFKEQLOTE FOREIGN KEY (CODLOTE, CODPROD, CODFILIALLE, CODEMPLE) REFERENCES EQLOTE (CODLOTE, CODPROD, CODFILIAL, CODEMP);
ALTER TABLE EQMOVPROD ADD CONSTRAINT EQMOVPRODFKEQOP FOREIGN KEY (CODOP, SEQOP, CODFILIALOP, CODEMPOP) REFERENCES PPOP (CODOP, SEQOP, CODFILIAL, CODEMP);
ALTER TABLE EQMOVPROD ADD CONSTRAINT EQMOVPRODFKEQPRODU FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);
ALTER TABLE EQMOVPROD ADD CONSTRAINT EQMOVPRODFKEQTIPOM FOREIGN KEY (CODTIPOMOV, CODFILIALTM, CODEMPTM) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);
ALTER TABLE EQMOVPROD ADD CONSTRAINT EQMOVPRODFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE EQMOVPROD ADD CONSTRAINT EQMOVPRODFKVDITVEN FOREIGN KEY (CODVENDA, CODITVENDA, TIPOVENDA, CODFILIALVD, CODEMPVD) REFERENCES VDITVENDA (CODVENDA, CODITVENDA, TIPOVENDA, CODFILIAL, CODEMP);
ALTER TABLE EQPRODACESSO ADD CONSTRAINT EQPRODACESSOFKFNCC FOREIGN KEY (CODCC, ANOCC, CODFILIALCC, CODEMPCC) REFERENCES FNCC (CODCC, ANOCC, CODFILIAL, CODEMP);
ALTER TABLE EQPRODACESSO ADD CONSTRAINT EQPRODACESSOFKPVCA FOREIGN KEY (CODCAIXA, CODFILIALCX, CODEMPCX) REFERENCES PVCAIXA (CODCAIXA, CODFILIAL, CODEMP);
ALTER TABLE EQPRODPLAN ADD CONSTRAINT EQPRODPLANFKEQPROD FOREIGN KEY (CODPROD, CODFILIAL, CODEMP) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);
ALTER TABLE EQPRODPLAN ADD CONSTRAINT EQPRODPLANFKFNCC FOREIGN KEY (CODCC, ANOCC, CODFILIALCC, CODEMPCC) REFERENCES FNCC (CODCC, ANOCC, CODFILIAL, CODEMP);
ALTER TABLE EQPRODPLAN ADD CONSTRAINT EQPRODPLANFKFNPLAN FOREIGN KEY (CODPLAN, CODFILIALPN, CODEMPPN) REFERENCES FNPLANEJAMENTO (CODPLAN, CODFILIAL, CODEMP);
ALTER TABLE EQPRODUTO ADD CONSTRAINT EQPRODUTOFKEQALMOX FOREIGN KEY (CODALMOX, CODFILIALAX, CODEMPAX) REFERENCES EQALMOX (CODALMOX, CODFILIAL, CODEMP);
ALTER TABLE EQPRODUTO ADD CONSTRAINT EQPRODUTOFKEQGRUPO FOREIGN KEY (CODGRUP, CODFILIALGP, CODEMPGP) REFERENCES EQGRUPO (CODGRUP, CODFILIAL, CODEMP);
ALTER TABLE EQPRODUTO ADD CONSTRAINT EQPRODUTOFKEQMARCA FOREIGN KEY (CODMARCA, CODFILIALMC, CODEMPMC) REFERENCES EQMARCA (CODMARCA, CODFILIAL, CODEMP);
ALTER TABLE EQPRODUTO ADD CONSTRAINT EQPRODUTOFKEQUNIDA FOREIGN KEY (CODUNID, CODFILIALUD, CODEMPUD) REFERENCES EQUNIDADE (CODUNID, CODFILIAL, CODEMP);
ALTER TABLE EQPRODUTO ADD CONSTRAINT EQPRODUTOFKFNMOEDA FOREIGN KEY (CODMOEDA, CODFILIALMA, CODEMPMA) REFERENCES FNMOEDA (CODMOEDA, CODFILIAL, CODEMP);
ALTER TABLE EQPRODUTO ADD CONSTRAINT EQPRODUTOFKLFCLFIS FOREIGN KEY (CODFISC, CODFILIALFC, CODEMPFC) REFERENCES LFCLFISCAL (CODFISC, CODFILIAL, CODEMP);
ALTER TABLE EQPRODUTO ADD CONSTRAINT EQPRODUTOFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE EQPRODUTO ADD CONSTRAINT EQPRODUTOFKVDPRAZO FOREIGN KEY (CODPE, CODFILIALPE, CODEMPPE) REFERENCES VDPRAZOENT (CODPE, CODFILIAL, CODEMP);
ALTER TABLE EQRMA ADD CONSTRAINT EQRMAFKEQTIPOMOV FOREIGN KEY (CODTIPOMOV, CODFILIALTM, CODEMPTM) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);
ALTER TABLE EQRMA ADD CONSTRAINT EQRMAFKFNCC FOREIGN KEY (CODCC, ANOCC, CODFILIALCC, CODEMPCC) REFERENCES FNCC (CODCC, ANOCC, CODFILIAL, CODEMP);
ALTER TABLE EQRMA ADD CONSTRAINT EQRMAFKPPOPFASE FOREIGN KEY (CODOP, SEQOP, SEQOF, CODFILIALOF, CODEMPOF) REFERENCES PPOPFASE (CODOP, SEQOP, SEQOF, CODFILIAL, CODEMP);
ALTER TABLE EQRMA ADD CONSTRAINT EQRMAFKSGUSUARIO FOREIGN KEY (IDUSU, CODFILIALUU, CODEMPUU) REFERENCES SGUSUARIO (IDUSU, CODFILIAL, CODEMP);
ALTER TABLE EQRMA ADD CONSTRAINT EQRMAFKSGUSUARIOAP FOREIGN KEY (IDUSUAPROV, CODFILIALUA, CODEMPUA) REFERENCES SGUSUARIO (IDUSU, CODFILIAL, CODEMP);
ALTER TABLE EQRMA ADD CONSTRAINT EQRMAFKSGUSUARIOEX FOREIGN KEY (IDUSUEXP, CODFILIALUE, CODEMPUE) REFERENCES SGUSUARIO (IDUSU, CODFILIAL, CODEMP);
ALTER TABLE EQRMAAL ADD CONSTRAINT EQRMAALFKEQRMA FOREIGN KEY (CODRMA, CODFILIAL, CODEMP) REFERENCES EQRMA (CODRMA, CODFILIAL, CODEMP);
ALTER TABLE EQRMAAL ADD CONSTRAINT EQRMAALFKSGUSUARIO FOREIGN KEY (IDUSU, CODFILIALUU, CODEMPUU) REFERENCES SGUSUARIO (IDUSU, CODFILIAL, CODEMP);
ALTER TABLE EQSALDOLOTE ADD CONSTRAINT EQSALDOLOTEFKEQALM FOREIGN KEY (CODALMOX, CODFILIALAX, CODEMPAX) REFERENCES EQALMOX (CODALMOX, CODFILIAL, CODEMP);
ALTER TABLE EQSALDOLOTE ADD CONSTRAINT EQSALDOLOTEFKEQLOT FOREIGN KEY (CODLOTE, CODPROD, CODFILIAL, CODEMP) REFERENCES EQLOTE (CODLOTE, CODPROD, CODFILIAL, CODEMP);
ALTER TABLE EQSALDOPROD ADD CONSTRAINT EQSOLDOPRODFKEQALM FOREIGN KEY (CODALMOX, CODFILIALAX, CODEMPAX) REFERENCES EQALMOX (CODALMOX, CODFILIAL, CODEMP);
ALTER TABLE EQSALDOPROD ADD CONSTRAINT EQSOLDOPRODFKEQPRO FOREIGN KEY (CODPROD, CODFILIAL, CODEMP) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);
ALTER TABLE EQTIPOEXP ADD CONSTRAINT EQTIPOEXPFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE EQTIPOMOV ADD CONSTRAINT EQTIPOMOVFKEQTIPOM FOREIGN KEY (CODTIPOMOVTM, CODFILIALTM, CODEMPTM) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);
ALTER TABLE EQTIPOMOV ADD CONSTRAINT EQTIPOMOVFKLFMODNO FOREIGN KEY (CODMODNOTA, CODFILIALMN, CODEMPMN) REFERENCES LFMODNOTA (CODMODNOTA, CODFILIAL, CODEMP);
ALTER TABLE EQTIPOMOV ADD CONSTRAINT EQTIPOMOVFKLFSERIE FOREIGN KEY (SERIE, CODFILIALSE, CODEMPSE) REFERENCES LFSERIE (SERIE, CODFILIAL, CODEMP);
ALTER TABLE EQTIPOMOV ADD CONSTRAINT EQTIPOMOVFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE EQTIPOMOV ADD CONSTRAINT EQTIPOMOVFKVDREGRA FOREIGN KEY (CODREGRCOMIS, CODFILIALRC, CODEMPRC) REFERENCES VDREGRACOMIS (CODREGRCOMIS, CODFILIAL, CODEMP);
ALTER TABLE EQTIPOMOV ADD CONSTRAINT EQTIPOMOVFKVDTABPR FOREIGN KEY (CODTAB, CODFILIALTB, CODEMPTB) REFERENCES VDTABPRECO (CODTAB, CODFILIAL, CODEMP);
ALTER TABLE EQTIPOMOV ADD CONSTRAINT EQTIPOMOVFKVDTRANS FOREIGN KEY (CODTRAN, CODFILIALTN, CODEMPTN) REFERENCES VDTRANSP (CODTRAN, CODFILIAL, CODEMP);
ALTER TABLE EQTIPOMOVUSU ADD CONSTRAINT EQTIPOMOVUSUFKEQTI FOREIGN KEY (CODTIPOMOV, CODFILIAL, CODEMP) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);
ALTER TABLE EQTIPOMOVUSU ADD CONSTRAINT EQTIPOMOVUSUFKSGUS FOREIGN KEY (IDUSU, CODFILIALUS, CODEMPUS) REFERENCES SGUSUARIO (IDUSU, CODFILIAL, CODEMP);
ALTER TABLE EQUNIDADE ADD CONSTRAINT EQUNIDADEFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE EQVARGRADE ADD CONSTRAINT EQVARGRADEFKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE FNBANCO ADD CONSTRAINT FNBANCOFKFNMODBOLE FOREIGN KEY (CODMODBOL, CODFILIALMB, CODEMPMB) REFERENCES FNMODBOLETO (CODMODBOL, CODFILIAL, CODEMP);
ALTER TABLE FNBANCO ADD CONSTRAINT FNBANCOFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE FNCARTCOB ADD CONSTRAINT FNCARTCOBFKFNBANCO FOREIGN KEY (CODBANCO, CODFILIALBO, CODEMPBO) REFERENCES FNBANCO (CODBANCO, CODFILIAL, CODEMP);
ALTER TABLE FNCC ADD CONSTRAINT FNCCFKFNCC FOREIGN KEY (CODSUBCC, ANOSCC, CODFILIAL, CODEMP) REFERENCES FNCC (CODCC, ANOCC, CODFILIAL, CODEMP);
ALTER TABLE FNCC ADD CONSTRAINT FNCCFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE FNCONTA ADD CONSTRAINT FNCONTAFKFNBANCO FOREIGN KEY (CODBANCO, CODFILIALBO, CODEMPBO) REFERENCES FNBANCO (CODBANCO, CODFILIAL, CODEMP);
ALTER TABLE FNCONTA ADD CONSTRAINT FNCONTAFKFNHISTPAD FOREIGN KEY (CODHIST, CODFILIALHP, CODEMPHP) REFERENCES FNHISTPAD (CODHIST, CODFILIAL, CODEMP);
ALTER TABLE FNCONTA ADD CONSTRAINT FNCONTAFKFNMOEDA FOREIGN KEY (CODMOEDA, CODFILIALMA, CODEMPMA) REFERENCES FNMOEDA (CODMOEDA, CODFILIAL, CODEMP);
ALTER TABLE FNCONTA ADD CONSTRAINT FNCONTAFKFNPLANEJA FOREIGN KEY (CODPLAN, CODFILIALPN, CODEMPPN) REFERENCES FNPLANEJAMENTO (CODPLAN, CODFILIAL, CODEMP);
ALTER TABLE FNCONTA ADD CONSTRAINT FNCONTAFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE FNCONTAUSU ADD CONSTRAINT FNCONTAUSUFKFNCONT FOREIGN KEY (NUMCONTA, CODFILIAL, CODEMP) REFERENCES FNCONTA (NUMCONTA, CODFILIAL, CODEMP);
ALTER TABLE FNCONTAUSU ADD CONSTRAINT FNCONTAUSUFKSGUSUA FOREIGN KEY (IDUSU, CODFILIALUS, CODEMPUS) REFERENCES SGUSUARIO (IDUSU, CODFILIAL, CODEMP);
ALTER TABLE FNCOTMOEDA ADD CONSTRAINT FNCOTMOEDAFKFNMOED FOREIGN KEY (CODMOEDA, CODFILIAL, CODEMP) REFERENCES FNMOEDA (CODMOEDA, CODFILIAL, CODEMP);
ALTER TABLE FNCOTMOEDA ADD CONSTRAINT FNCOTMOEDAFKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE FNFBNCLI ADD CONSTRAINT FNFBNCLIFKFNCONTA FOREIGN KEY (NUMCONTA, CODFILIALCA, CODEMPCA) REFERENCES FNCONTA (NUMCONTA, CODFILIAL, CODEMP);
ALTER TABLE FNFBNCLI ADD CONSTRAINT FNFBNCLIFKFNPLANEJ FOREIGN KEY (CODPLAN, CODFILIALPN, CODEMPPN) REFERENCES FNPLANEJAMENTO (CODPLAN, CODFILIAL, CODEMP);
ALTER TABLE FNFBNCLI ADD CONSTRAINT FNFBNCLIFKSGITPREF FOREIGN KEY (CODBANCO, TIPOFEBRABAN, CODFILIALBO, CODEMPBO, CODFILIALPF, CODEMPPF) REFERENCES SGITPREFERE6 (CODBANCO, TIPOFEBRABAN, CODFILIALBO, CODEMPBO, CODFILIAL, CODEMP);
ALTER TABLE FNFBNCLI ADD CONSTRAINT FNFBNCLIFKVDCLIENT FOREIGN KEY (CODCLI, CODFILIAL, CODEMP) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);
ALTER TABLE FNFBNCODRET ADD CONSTRAINT FNFBNCODRETFKSGITP FOREIGN KEY (CODBANCO, TIPOFEBRABAN, CODFILIALBO, CODEMPBO, CODFILIAL, CODEMP) REFERENCES SGITPREFERE6 (CODBANCO, TIPOFEBRABAN, CODFILIALBO, CODEMPBO, CODFILIAL, CODEMP);
ALTER TABLE FNFBNREC ADD CONSTRAINT FNFBNRECFKFNITREC FOREIGN KEY (NPARCITREC, CODREC, CODFILIAL, CODEMP) REFERENCES FNITRECEBER (NPARCITREC, CODREC, CODFILIAL, CODEMP) ON DELETE CASCADE;
ALTER TABLE FNFBNREC ADD CONSTRAINT FNFBNRECFKSGITPREF FOREIGN KEY (CODBANCO, TIPOFEBRABAN, CODFILIALBO, CODEMPBO, CODFILIALPF, CODEMPPF) REFERENCES SGITPREFERE6 (CODBANCO, TIPOFEBRABAN, CODFILIALBO, CODEMPBO, CODFILIAL, CODEMP);
ALTER TABLE FNITMODBOLETO ADD CONSTRAINT FNITMODBOLETOFKCAR FOREIGN KEY (CODCARTCOB, CODFILIALCB, CODEMPCB, CODBANCO, CODFILIALBO, CODEMPBO) REFERENCES FNCARTCOB (CODCARTCOB, CODFILIAL, CODEMP, CODBANCO, CODFILIALBO, CODEMPBO);
ALTER TABLE FNITMODBOLETO ADD CONSTRAINT FNITMODBOLETOFKMOD FOREIGN KEY (CODMODBOL, CODFILIAL, CODEMP) REFERENCES FNMODBOLETO (CODMODBOL, CODFILIAL, CODEMP);
ALTER TABLE FNITPAGAR ADD CONSTRAINT FNITPAGARFKFNCONTA FOREIGN KEY (NUMCONTA, CODFILIALCA, CODEMPCA) REFERENCES FNCONTA (NUMCONTA, CODFILIAL, CODEMP);
ALTER TABLE FNITPAGAR ADD CONSTRAINT FNITPAGARFKFNPAGAR FOREIGN KEY (CODPAG, CODFILIAL, CODEMP) REFERENCES FNPAGAR (CODPAG, CODFILIAL, CODEMP);
ALTER TABLE FNITPAGAR ADD CONSTRAINT FNITPAGARFKFNPLANE FOREIGN KEY (CODPLAN, CODFILIALPN, CODEMPPN) REFERENCES FNPLANEJAMENTO (CODPLAN, CODFILIAL, CODEMP);
ALTER TABLE FNITPAGAR ADD CONSTRAINT FNITPAGARFKFNTPCOB FOREIGN KEY (CODTIPOCOB, CODFILIALTC, CODEMPTC) REFERENCES FNTIPOCOB (CODTIPOCOB, CODFILIAL, CODEMP);
ALTER TABLE FNITRECEBER ADD CONSTRAINT FNITRECEBERFKCARTC FOREIGN KEY (CODCARTCOB, CODFILIALCB, CODEMPCB, CODBANCO, CODFILIALBO, CODEMPBO) REFERENCES FNCARTCOB (CODCARTCOB, CODFILIAL, CODEMP, CODBANCO, CODFILIALBO, CODEMPBO);
ALTER TABLE FNITRECEBER ADD CONSTRAINT FNITRECEBERFKFNBAN FOREIGN KEY (CODBANCO, CODFILIALBO, CODEMPBO) REFERENCES FNBANCO (CODBANCO, CODFILIAL, CODEMP);
ALTER TABLE FNITRECEBER ADD CONSTRAINT FNITRECEBERFKFNCON FOREIGN KEY (NUMCONTA, CODFILIALCA, CODEMPCA) REFERENCES FNCONTA (NUMCONTA, CODFILIAL, CODEMP);
ALTER TABLE FNITRECEBER ADD CONSTRAINT FNITRECEBERFKFNPLA FOREIGN KEY (CODPLAN, CODFILIALPN, CODEMPPN) REFERENCES FNPLANEJAMENTO (CODPLAN, CODFILIAL, CODEMP);
ALTER TABLE FNITRECEBER ADD CONSTRAINT FNITRECEBERFKFNREC FOREIGN KEY (CODREC, CODFILIAL, CODEMP) REFERENCES FNRECEBER (CODREC, CODFILIAL, CODEMP);
ALTER TABLE FNITRECEBER ADD CONSTRAINT FNITRECEBERFKFNTIP FOREIGN KEY (CODTIPOCOB, CODFILIALTC, CODEMPTC) REFERENCES FNTIPOCOB (CODTIPOCOB, CODFILIAL, CODEMP);
ALTER TABLE FNITTBJUROS ADD CONSTRAINT FNITTBJUROSFKFNTBJ FOREIGN KEY (CODTBJ, CODFILIAL, CODEMP) REFERENCES FNTBJUROS (CODTBJ, CODFILIAL, CODEMP);
ALTER TABLE FNLANCA ADD CONSTRAINT FNLANCAFKCPFORNECE FOREIGN KEY (CODFOR, CODFILIALFR, CODEMPFR) REFERENCES CPFORNECED (CODFOR, CODFILIAL, CODEMP);
ALTER TABLE FNLANCA ADD CONSTRAINT FNLANCAFKFNITPAGAR FOREIGN KEY (NPARCPAG, CODPAG, CODFILIALPG, CODEMPPG) REFERENCES FNITPAGAR (NPARCPAG, CODPAG, CODFILIAL, CODEMP);
ALTER TABLE FNLANCA ADD CONSTRAINT FNLANCAFKFNITRECEB FOREIGN KEY (NPARCITREC, CODREC, CODFILIALRC, CODEMPRC) REFERENCES FNITRECEBER (NPARCITREC, CODREC, CODFILIAL, CODEMP);
ALTER TABLE FNLANCA ADD CONSTRAINT FNLANCAFKFNPAGTOCO FOREIGN KEY (CODPCOMI, CODFILIALCI, CODEMPCI) REFERENCES FNPAGTOCOMI (CODPCOMI, CODFILIAL, CODEMP);
ALTER TABLE FNLANCA ADD CONSTRAINT FNLANCAFKFNPLANEJA FOREIGN KEY (CODPLAN, CODFILIALPN, CODEMPPN) REFERENCES FNPLANEJAMENTO (CODPLAN, CODFILIAL, CODEMP);
ALTER TABLE FNLANCA ADD CONSTRAINT FNLANCAFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE FNLANCA ADD CONSTRAINT FNLANCAFKVDCLIENTE FOREIGN KEY (CODCLI, CODFILIALCL, CODEMPCL) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);
ALTER TABLE FNLANCA ADD CONSTRAINT FNLANCAFKVDCOMISSA FOREIGN KEY (CODCOMI, CODFILIAL, CODEMP) REFERENCES VDCOMISSAO (CODCOMI, CODFILIAL, CODEMP);
ALTER TABLE FNLIBCRED ADD CONSTRAINT FNLIBCREDFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE FNLIBCRED ADD CONSTRAINT FNLIBCREDFKSGUSUAR FOREIGN KEY (IDUSU, CODFILIALUS, CODEMPUS) REFERENCES SGUSUARIO (IDUSU, CODFILIAL, CODEMP);
ALTER TABLE FNLIBCRED ADD CONSTRAINT FNLIBCREDFKVDCLIEN FOREIGN KEY (CODCLI, CODFILIALCL, CODEMPCL) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);
ALTER TABLE FNLIBCRED ADD CONSTRAINT VDLIBCREDFKVDVENDA FOREIGN KEY (CODVENDA, TIPOVENDA, CODFILIALVD, CODEMPVD) REFERENCES VDVENDA (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP);
ALTER TABLE FNMODBOLETO ADD CONSTRAINT FNMODBOLETOFKFNCON FOREIGN KEY (NUMCONTA, CODFILIALCC, CODEMPCC) REFERENCES FNCONTA (NUMCONTA, CODFILIAL, CODEMP);
ALTER TABLE FNMOEDA ADD CONSTRAINT FNMOEDAFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE FNPAGAR ADD CONSTRAINT FNPAGARFKCPCOMPRA FOREIGN KEY (CODCOMPRA, CODFILIALCP, CODEMPCP) REFERENCES CPCOMPRA (CODCOMPRA, CODFILIAL, CODEMP);
ALTER TABLE FNPAGAR ADD CONSTRAINT FNPAGARFKCPFORNECE FOREIGN KEY (CODFOR, CODFILIALFR, CODEMPFR) REFERENCES CPFORNECED (CODFOR, CODFILIAL, CODEMP);
ALTER TABLE FNPAGAR ADD CONSTRAINT FNPAGARFKFNBANCO FOREIGN KEY (CODBANCO, CODFILIALBO, CODEMPBO) REFERENCES FNBANCO (CODBANCO, CODFILIAL, CODEMP);
ALTER TABLE FNPAGAR ADD CONSTRAINT FNPAGARFKFNPLANOPA FOREIGN KEY (CODPLANOPAG, CODFILIALPG, CODEMPPG) REFERENCES FNPLANOPAG (CODPLANOPAG, CODFILIAL, CODEMP);
ALTER TABLE FNPAGAR ADD CONSTRAINT FNPAGARFKFNTIPOC FOREIGN KEY (CODTIPOCOB, CODFILIALTC, CODEMPTC) REFERENCES FNTIPOCOB (CODTIPOCOB, CODFILIAL, CODEMP);
ALTER TABLE FNPAGAR ADD CONSTRAINT FNPAGARFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE FNPAGTOCOMI ADD CONSTRAINT FNPAGTOCOMIFKFNCON FOREIGN KEY (NUMCONTA, CODFILIAL, CODEMP) REFERENCES FNCONTA (NUMCONTA, CODFILIAL, CODEMP);
ALTER TABLE FNPAGTOCOMI ADD CONSTRAINT FNPAGTOCOMIFKFNPLA FOREIGN KEY (CODPLAN, CODFILIALPN, CODEMPPN) REFERENCES FNPLANEJAMENTO (CODPLAN, CODFILIAL, CODEMP);
ALTER TABLE FNPAGTOCOMI ADD CONSTRAINT FNPAGTOCOMIFKSGFIL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE FNPARCPAG ADD CONSTRAINT FNPARCPAGFKFNPLANO FOREIGN KEY (CODPLANOPAG, CODFILIAL, CODEMP) REFERENCES FNPLANOPAG (CODPLANOPAG, CODFILIAL, CODEMP);
ALTER TABLE FNPLANEJAMENTO ADD CONSTRAINT FNPLANEJAMFKFNHIST FOREIGN KEY (CODHIST, CODFILIALHP, CODEMPHP) REFERENCES FNHISTPAD (CODHIST, CODFILIAL, CODEMP);
ALTER TABLE FNPLANEJAMENTO ADD CONSTRAINT FNPLANEJAMFKFNPLAN FOREIGN KEY (CODSUBPLAN, CODFILIAL, CODEMP) REFERENCES FNPLANEJAMENTO (CODPLAN, CODFILIAL, CODEMP);
ALTER TABLE FNPLANEJAMENTO ADD CONSTRAINT FNPLANEJAMFKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE FNPLANOPAG ADD CONSTRAINT FNPLANOPAGFKFNCC FOREIGN KEY (CODCC, ANOCC, CODFILIALCC, CODEMPCC) REFERENCES FNCC (CODCC, ANOCC, CODFILIAL, CODEMP);
ALTER TABLE FNPLANOPAG ADD CONSTRAINT FNPLANOPAGFKFNCONT FOREIGN KEY (NUMCONTA, CODFILIALCA, CODEMPCA) REFERENCES FNCONTA (NUMCONTA, CODFILIAL, CODEMP);
ALTER TABLE FNPLANOPAG ADD CONSTRAINT FNPLANOPAGFKFNPLAN FOREIGN KEY (CODPLAN, CODFILIALPN, CODEMPPN) REFERENCES FNPLANEJAMENTO (CODPLAN, CODFILIAL, CODEMP);
ALTER TABLE FNPLANOPAG ADD CONSTRAINT FNPLANOPAGFKFNTBJU FOREIGN KEY (CODTBJ, CODFILIALTBJ, CODEMPTBJ) REFERENCES FNTBJUROS (CODTBJ, CODFILIAL, CODEMP);
ALTER TABLE FNPLANOPAG ADD CONSTRAINT FNPLANOPAGFKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE FNRECEBER ADD CONSTRAINT FNRECEBERFKFNBANCO FOREIGN KEY (CODBANCO, CODFILIALBO, CODEMPBO) REFERENCES FNBANCO (CODBANCO, CODFILIAL, CODEMP);
ALTER TABLE FNRECEBER ADD CONSTRAINT FNRECEBERFKFNCARTC FOREIGN KEY (CODCARTCOB, CODFILIALCB, CODEMPCB, CODBANCO, CODFILIALBO, CODEMPBO) REFERENCES FNCARTCOB (CODCARTCOB, CODFILIAL, CODEMP, CODBANCO, CODFILIALBO, CODEMPBO);
ALTER TABLE FNRECEBER ADD CONSTRAINT FNRECEBERFKFNPLANO FOREIGN KEY (CODPLANOPAG, CODFILIALPG, CODEMPPG) REFERENCES FNPLANOPAG (CODPLANOPAG, CODFILIAL, CODEMP);
ALTER TABLE FNRECEBER ADD CONSTRAINT FNRECEBERFKFNTIPOC FOREIGN KEY (CODTIPOCOB, CODFILIALTC, CODEMPTC) REFERENCES FNTIPOCOB (CODTIPOCOB, CODFILIAL, CODEMP);
ALTER TABLE FNRECEBER ADD CONSTRAINT FNRECEBERFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE FNRECEBER ADD CONSTRAINT FNRECEBERFKVDCLIEN FOREIGN KEY (CODCLI, CODFILIALCL, CODEMPCL) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);
ALTER TABLE FNRECEBER ADD CONSTRAINT FNRECEBERFKVDVENDA FOREIGN KEY (CODVENDA, TIPOVENDA, CODFILIALVA, CODEMPVA) REFERENCES VDVENDA (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP);
ALTER TABLE FNRECEBER ADD CONSTRAINT FNRECEBERFKVDVENDE FOREIGN KEY (CODVEND, CODFILIALVD, CODEMPVD) REFERENCES VDVENDEDOR (CODVEND, CODFILIAL, CODEMP);
ALTER TABLE FNRESTRICAO ADD CONSTRAINT FNRESTRICAOFKFNTIP FOREIGN KEY (CODTPRESTR, CODFILIAL, CODEMP) REFERENCES FNTIPORESTR (CODTPRESTR, CODFILIAL, CODEMP);
ALTER TABLE FNRESTRICAO ADD CONSTRAINT FNRESTRICAOFKVDCLI FOREIGN KEY (CODCLI, CODFILIAL, CODEMP) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);
ALTER TABLE FNSALDOLANCA ADD CONSTRAINT FNSALDOLANCAFKFNPL FOREIGN KEY (CODPLAN, CODFILIALPN, CODEMPPN) REFERENCES FNPLANEJAMENTO (CODPLAN, CODFILIAL, CODEMP);
ALTER TABLE FNSALDOLANCA ADD CONSTRAINT FNSALDOLANCAFKSGFI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE FNSUBLANCA ADD CONSTRAINT FNSUBLANCAFKCPFORN FOREIGN KEY (CODFOR, CODFILIALFR, CODEMPFR) REFERENCES CPFORNECED (CODFOR, CODFILIAL, CODEMP);
ALTER TABLE FNSUBLANCA ADD CONSTRAINT FNSUBLANCAFKFNCC FOREIGN KEY (CODCC, ANOCC, CODFILIALCC, CODEMPCC) REFERENCES FNCC (CODCC, ANOCC, CODFILIAL, CODEMP);
ALTER TABLE FNSUBLANCA ADD CONSTRAINT FNSUBLANCAFKFNLANC FOREIGN KEY (CODLANCA, CODFILIAL, CODEMP) REFERENCES FNLANCA (CODLANCA, CODFILIAL, CODEMP);
ALTER TABLE FNSUBLANCA ADD CONSTRAINT FNSUBLANCAFKFNPLAN FOREIGN KEY (CODPLAN, CODFILIALPN, CODEMPPN) REFERENCES FNPLANEJAMENTO (CODPLAN, CODFILIAL, CODEMP);
ALTER TABLE FNSUBLANCA ADD CONSTRAINT FNSUBLANCAFKVDCLIE FOREIGN KEY (CODCLI, CODFILIALCL, CODEMPCL) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);
ALTER TABLE FNTBJUROS ADD CONSTRAINT FNTBJUROSFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE FNTIPOCOB ADD CONSTRAINT FNTIPOCOBFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE LFCLFISCAL ADD CONSTRAINT LFCLFISCALFKLFMENS FOREIGN KEY (CODMENS, CODFILIALME, CODEMPME) REFERENCES LFMENSAGEM (CODMENS, CODFILIAL, CODEMP);
ALTER TABLE LFCLFISCAL ADD CONSTRAINT LFCLFISCALFKLFREGR FOREIGN KEY (CODREGRA, CODFILIALRA, CODEMPRA) REFERENCES LFREGRAFISCAL (CODREGRA, CODFILIAL, CODEMP);
ALTER TABLE LFCLFISCAL ADD CONSTRAINT LFCLFISCALFKLFTRAT FOREIGN KEY (CODTRATTRIB, CODFILIALTT, CODEMPTT) REFERENCES LFTRATTRIB (CODTRATTRIB, CODFILIAL, CODEMP);
ALTER TABLE LFCLFISCAL ADD CONSTRAINT LFCLFISCALFKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE LFITCLFISCAL ADD CONSTRAINT LFITCLFISCALFKEQTIPOMOV FOREIGN KEY (CODTIPOMOV, CODFILIALTM, CODEMPTM) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);
ALTER TABLE LFITCLFISCAL ADD CONSTRAINT LFITCLFISCALFKLFCL FOREIGN KEY (CODFISC, CODFILIAL, CODEMP) REFERENCES LFCLFISCAL (CODFISC, CODFILIAL, CODEMP);
ALTER TABLE LFITCLFISCAL ADD CONSTRAINT LFITCLFISCALFKLFME FOREIGN KEY (CODMENS, CODFILIALME, CODEMPME) REFERENCES LFMENSAGEM (CODMENS, CODFILIAL, CODEMP);
ALTER TABLE LFITCLFISCAL ADD CONSTRAINT LFITCLFISCALFKLFTI FOREIGN KEY (CODFISCCLI, CODFILIALFC, CODEMPFC) REFERENCES LFTIPOFISCCLI (CODFISCCLI, CODFILIAL, CODEMP);
ALTER TABLE LFITCLFISCAL ADD CONSTRAINT LFITCLFISCALFKLFTR FOREIGN KEY (CODTRATTRIB, CODFILIALTT, CODEMPTT) REFERENCES LFTRATTRIB (CODTRATTRIB, CODFILIAL, CODEMP);
ALTER TABLE LFITNATOPER ADD CONSTRAINT LFITNATOPERFKLFTAB FOREIGN KEY (UFTI, CODFILIALTI, CODEMPTI) REFERENCES LFTABICMS (UFTI, CODFILIAL, CODEMP);
ALTER TABLE LFITREGRAFISCAL ADD CONSTRAINT LFITREGRAFISFKEQTI FOREIGN KEY (CODTIPOMOV, CODFILIALTM, CODEMPTM) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP)
  USING INDEX LFITREGRAFISCALFKEQTIPOMOV;
ALTER TABLE LFITREGRAFISCAL ADD CONSTRAINT LFITREGRAFISFKLFNA FOREIGN KEY (CODNAT, CODFILIAL, CODEMP) REFERENCES LFNATOPER (CODNAT, CODFILIAL, CODEMP)
  USING INDEX LFITREGRAFISCALFKLFNATOPER;
ALTER TABLE LFITREGRAFISCAL ADD CONSTRAINT LFITREGRAFISFKLFRE FOREIGN KEY (CODREGRA, CODFILIAL, CODEMP) REFERENCES LFREGRAFISCAL (CODREGRA, CODFILIAL, CODEMP)
  USING INDEX LFITREGRAFISCALFKLFREGRAFISCAL;
ALTER TABLE LFLIVROFISCAL ADD CONSTRAINT LFLIVROFISCALFKLFN FOREIGN KEY (CODNAT, CODFILIALNT, CODEMPNT) REFERENCES LFNATOPER (CODNAT, CODFILIAL, CODEMP);
ALTER TABLE LFLIVROFISCAL ADD CONSTRAINT LFLIVROFISCALFKSGF FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE LFMODNOTA ADD CONSTRAINT LFMODNOTAFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE LFNATOPER ADD CONSTRAINT LFNATOPERFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE LFREGRAFISCAL ADD CONSTRAINT LFREGRAFISCALFKSGF FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE LFSERIE ADD CONSTRAINT LFSERIEFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE LFTRATTRIB ADD CONSTRAINT LFTRATTRIBFKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE PPDISTRIB ADD CONSTRAINT PPDISTRIBFKPPESTFA FOREIGN KEY (CODPROD, SEQEST, SEQEF, CODFILIAL, CODEMP, CODFASE, CODFILIALFS, CODEMPFS) REFERENCES PPESTRUFASE (CODPROD, SEQEST, SEQEF, CODFILIAL, CODEMP, CODFASE, CODFILIALFS, CODEMPFS)
  USING INDEX PPDISTRIBFKPPESTRUFASE;
ALTER TABLE PPDISTRIB ADD CONSTRAINT PPDISTRIBFKPPESTRU FOREIGN KEY (CODPRODDE, SEQESTDE, CODFILIALDE, CODEMPDE) REFERENCES PPESTRUTURA (CODPROD, SEQEST, CODFILIAL, CODEMP)
  USING INDEX PPDISTRIBFKPPESTRUTURA;
ALTER TABLE PPESTRUANALISE ADD CONSTRAINT PPESTRUANALISEFKESTRUFASE FOREIGN KEY (CODPROD, SEQEST, SEQEF, CODFILIAL, CODEMP, CODFASE, CODFILIALFS, CODEMPFS) REFERENCES PPESTRUFASE (CODPROD, SEQEST, SEQEF, CODFILIAL, CODEMP, CODFASE, CODFILIALFS, CODEMPFS);
ALTER TABLE PPESTRUANALISE ADD CONSTRAINT PPESTRUANALISEFKTIPOANALISE FOREIGN KEY (CODTPANALISE, CODFILIALTA, CODEMPTA) REFERENCES PPTIPOANALISE (CODTPANALISE, CODFILIAL, CODEMP);
ALTER TABLE PPESTRUFASE ADD CONSTRAINT PPESTRUFASEFKPPEST FOREIGN KEY (CODPROD, SEQEST, CODFILIAL, CODEMP) REFERENCES PPESTRUTURA (CODPROD, SEQEST, CODFILIAL, CODEMP);
ALTER TABLE PPESTRUFASE ADD CONSTRAINT PPESTRUFASEFKPPFAS FOREIGN KEY (CODFASE, CODFILIALFS, CODEMPFS) REFERENCES PPFASE (CODFASE, CODFILIAL, CODEMP);
ALTER TABLE PPESTRUFASE ADD CONSTRAINT PPESTRUFASEFKPPTIP FOREIGN KEY (CODTPREC, CODFILIALTR, CODEMPTR) REFERENCES PPTIPOREC (CODTPREC, CODFILIAL, CODEMP);
ALTER TABLE PPESTRUFASE ADD CONSTRAINT PPESTRUFASEFKSGFIL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE PPESTRUTURA ADD CONSTRAINT PPESTRUTURAFKEQMOD FOREIGN KEY (CODMODLOTE, CODFILIALML, CODEMPML) REFERENCES EQMODLOTE (CODMODLOTE, CODFILIAL, CODEMP);
ALTER TABLE PPESTRUTURA ADD CONSTRAINT PPESTRUTURAFKEQPRO FOREIGN KEY (CODPROD, CODFILIAL, CODEMP) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);
ALTER TABLE PPFASE ADD CONSTRAINT PPFASEFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE PPFOTOMTAN ADD CONSTRAINT VDFOTOMTANFKPPMETODOAN FOREIGN KEY (CODMTANALISE, CODFILIAL, CODEMP) REFERENCES PPMETODOANALISE (CODMTANALISE, CODFILIAL, CODEMP);
ALTER TABLE PPITESTRUTURA ADD CONSTRAINT PPITESTRUTURAFKEQP FOREIGN KEY (CODPRODPD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);
ALTER TABLE PPITESTRUTURA ADD CONSTRAINT PPITESTRUTURAFKPPE FOREIGN KEY (CODPROD, SEQEST, SEQEF, CODFILIAL, CODEMP, CODFASE, CODFILIALFS, CODEMPFS) REFERENCES PPESTRUFASE (CODPROD, SEQEST, SEQEF, CODFILIAL, CODEMP, CODFASE, CODFILIALFS, CODEMPFS);
ALTER TABLE PPITOP ADD CONSTRAINT PPITOPFKEQLOTE FOREIGN KEY (CODLOTE, CODPROD, CODFILIALLE, CODEMPLE) REFERENCES EQLOTE (CODLOTE, CODPROD, CODFILIAL, CODEMP);
ALTER TABLE PPITOP ADD CONSTRAINT PPITOPFKEQPRODUTO FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);
ALTER TABLE PPITOP ADD CONSTRAINT PPITOPFKPPFASE FOREIGN KEY (CODFASE, CODFILIALFS, CODEMPFS) REFERENCES PPFASE (CODFASE, CODFILIAL, CODEMP);
ALTER TABLE PPITOP ADD CONSTRAINT PPITOPFKPPOP FOREIGN KEY (CODOP, SEQOP, CODFILIAL, CODEMP) REFERENCES PPOP (CODOP, SEQOP, CODFILIAL, CODEMP);
ALTER TABLE PPITOP ADD CONSTRAINT PPOPFKPPOPACAOCORRET FOREIGN KEY (CODOP, SEQOP, SEQAC, CODFILIAL, CODEMP) REFERENCES PPOPACAOCORRET (CODOP, SEQOP, SEQAC, CODFILIAL, CODEMP);
ALTER TABLE PPITRETCP ADD CONSTRAINT PPITRETCPFKEQPRODUTO FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);
ALTER TABLE PPITRETCP ADD CONSTRAINT PPITRETCPFKPPRETCP FOREIGN KEY (CODOP, SEQOP, CODFILIAL, CODEMP) REFERENCES PPRETCP (CODOP, SEQOP, CODFILIAL, CODEMP);
ALTER TABLE PPOP ADD CONSTRAINT PPOPFKEQALMOX FOREIGN KEY (CODALMOX, CODFILIALAX, CODEMPAX) REFERENCES EQALMOX (CODALMOX, CODFILIAL, CODEMP);
ALTER TABLE PPOP ADD CONSTRAINT PPOPFKEQLOTE FOREIGN KEY (CODLOTE, CODPROD, CODFILIALLE, CODEMPLE) REFERENCES EQLOTE (CODLOTE, CODPROD, CODFILIAL, CODEMP);
ALTER TABLE PPOP ADD CONSTRAINT PPOPFKEQTIPOMOV FOREIGN KEY (CODTIPOMOV, CODFILIALTM, CODEMPTM) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);
ALTER TABLE PPOP ADD CONSTRAINT PPOPFKPPESTRUTURA FOREIGN KEY (CODPROD, SEQEST, CODFILIALPD, CODEMPPD) REFERENCES PPESTRUTURA (CODPROD, SEQEST, CODFILIAL, CODEMP);
ALTER TABLE PPOP ADD CONSTRAINT PPOPFKPPOP FOREIGN KEY (CODOPM, SEQOPM, CODFILIALOPM, CODEMPOPM) REFERENCES PPOP (CODOP, SEQOP, CODFILIAL, CODEMP);
ALTER TABLE PPOPCQ ADD CONSTRAINT PPOPCQFKESTRUANALISE FOREIGN KEY (CODESTANALISE, CODFILIALEA, CODEMPEA) REFERENCES PPESTRUANALISE (CODESTANALISE, CODFILIAL, CODEMP);
ALTER TABLE PPOPCQ ADD CONSTRAINT PPOPCQFKPPOP FOREIGN KEY (CODOP, SEQOP, CODFILIAL, CODEMP) REFERENCES PPOP (CODOP, SEQOP, CODFILIAL, CODEMP);
ALTER TABLE PPOPCQ ADD CONSTRAINT PPOPCQFKPPOPACAOCORRET FOREIGN KEY (CODOP, SEQOP, SEQAC, CODFILIAL, CODEMP) REFERENCES PPOPACAOCORRET (CODOP, SEQOP, SEQAC, CODFILIAL, CODEMP);
ALTER TABLE PPOPFASE ADD CONSTRAINT PPOPFASEFKPPFASE FOREIGN KEY (CODFASE, CODFILIALFS, CODEMPFS) REFERENCES PPFASE (CODFASE, CODFILIAL, CODEMP);
ALTER TABLE PPOPFASE ADD CONSTRAINT PPOPFASEFKPPOP FOREIGN KEY (CODOP, SEQOP, CODFILIAL, CODEMP) REFERENCES PPOP (CODOP, SEQOP, CODFILIAL, CODEMP);
ALTER TABLE PPOPFASE ADD CONSTRAINT PPOPFASEFKPPRECURS FOREIGN KEY (CODRECP, CODFILIALRP, CODEMPRP) REFERENCES PPRECURSO (CODRECP, CODFILIAL, CODEMP);
ALTER TABLE PPOPFASE ADD CONSTRAINT PPOPFASEFKPPTIPORE FOREIGN KEY (CODTPREC, CODFILIALTR, CODEMPTR) REFERENCES PPTIPOREC (CODTPREC, CODFILIAL, CODEMP);
ALTER TABLE PPRECURSO ADD CONSTRAINT PPRECURSOFKPPTIPOR FOREIGN KEY (CODTPREC, CODFILIALTR, CODEMPTR) REFERENCES PPTIPOREC (CODTPREC, CODFILIAL, CODEMP);
ALTER TABLE PPRECURSO ADD CONSTRAINT PPRECURSOFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE PPRETCP ADD CONSTRAINT PPRETCPFKPPOP FOREIGN KEY (CODOP, SEQOP, CODFILIAL, CODEMP) REFERENCES PPOP (CODOP, SEQOP, CODFILIAL, CODEMP);
ALTER TABLE PPTIPOANALISE ADD CONSTRAINT PPTIPOANALISEFKEQUNIDA FOREIGN KEY (CODUNID, CODFILIALUD, CODEMPUD) REFERENCES EQUNIDADE (CODUNID, CODFILIAL, CODEMP);
ALTER TABLE PPTIPOANALISE ADD CONSTRAINT PPTIPOANALISEFKMTANALI FOREIGN KEY (CODMTANALISE, CODFILIALMA, CODEMPMA) REFERENCES PPMETODOANALISE (CODMTANALISE, CODFILIAL, CODEMP);
ALTER TABLE PPTIPOREC ADD CONSTRAINT PPTIPORECFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE PVCAIXA ADD CONSTRAINT PVCAIXAFKSGESTACAO FOREIGN KEY (CODEST, CODFILIALET, CODEMPET) REFERENCES SGESTACAO (CODEST, CODFILIAL, CODEMP);
ALTER TABLE PVCAIXAIMP ADD CONSTRAINT PVCAIXAIMPFKPVCAIX FOREIGN KEY (CODCAIXA, CODFILIAL, CODEMP) REFERENCES PVCAIXA (CODCAIXA, CODFILIAL, CODEMP);
ALTER TABLE PVCAIXAIMP ADD CONSTRAINT PVCAIXAIMPFKSGIMPR FOREIGN KEY (CODIMP, CODFILIAL, CODEMP) REFERENCES SGIMPRESSORA (CODIMP, CODFILIAL, CODEMP);
ALTER TABLE PVMOVCAIXA ADD CONSTRAINT PVMOVCAIXAFKSGUSUA FOREIGN KEY (IDUSU, CODFILIALUS, CODEMPUS) REFERENCES SGUSUARIO (IDUSU, CODFILIAL, CODEMP);
ALTER TABLE PVSEQUENCIA ADD CONSTRAINT PVSEQUENCIAFKPVCAI FOREIGN KEY (CODCAIXA, CODFILIAL, CODEMP) REFERENCES PVCAIXA (CODCAIXA, CODFILIAL, CODEMP);
ALTER TABLE RHAREA ADD CONSTRAINT RHAREAFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE RHCANDIDATO ADD CONSTRAINT RHCANDIDATOFKESTCIVIL FOREIGN KEY (CODESTCIVIL, CODFILIALES, CODEMPES) REFERENCES SGESTCIVIL (CODESTCIVIL, CODFILIAL, CODEMP)
  USING INDEX RHCANDIDATOFKSGESTCIVIL;
ALTER TABLE RHCANDIDATO ADD CONSTRAINT RHCANDIDATOFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE RHCANDIDATOCARAC ADD CONSTRAINT RHCANDCAFKRHCAND FOREIGN KEY (CODCAND, CODFILIAL, CODEMP) REFERENCES RHCANDIDATO (CODCAND, CODFILIAL, CODEMP);
ALTER TABLE RHCANDIDATOCARAC ADD CONSTRAINT RHCANDFKRHCARACFK FOREIGN KEY (CODCARAC, CODFILIALCT, CODEMPCT) REFERENCES RHCARACTERISTICA (CODCARAC, CODFILIAL, CODEMP);
ALTER TABLE RHCANDIDATOCURSO ADD CONSTRAINT RHCANDCURSOFKRHCAND FOREIGN KEY (CODCAND, CODFILIAL, CODEMP) REFERENCES RHCANDIDATO (CODCAND, CODFILIAL, CODEMP);
ALTER TABLE RHCANDIDATOCURSO ADD CONSTRAINT RHCANDCURSOFKRHCURSO FOREIGN KEY (CODCURSO, CODFILIALCS, CODEMPCS) REFERENCES RHCURSO (CODCURSO, CODFILIAL, CODEMP);
ALTER TABLE RHCANDIDATOFUNC ADD CONSTRAINT RHCANDFUNCFKRHCAND FOREIGN KEY (CODCAND, CODFILIAL, CODEMP) REFERENCES RHCANDIDATO (CODCAND, CODFILIAL, CODEMP);
ALTER TABLE RHCANDIDATOFUNC ADD CONSTRAINT RHCANDFUNCFKRHFUNC FOREIGN KEY (CODFUNC, CODFILIALFC, CODEMPFC) REFERENCES RHFUNCAO (CODFUNC, CODFILIAL, CODEMP);
ALTER TABLE RHCANDIDATOSTATUS ADD CONSTRAINT RHCANDIDATOSTATUSFKRHCAND FOREIGN KEY (CODCAND, CODFILIAL, CODEMP) REFERENCES RHCANDIDATO (CODCAND, CODFILIAL, CODEMP);
ALTER TABLE RHCANDIDATOSTATUS ADD CONSTRAINT RHCANDIDATOSTATUSFKRHVAGA FOREIGN KEY (CODVAGA, CODFILIAL, CODEMP) REFERENCES RHVAGA (CODVAGA, CODFILIAL, CODEMP);
ALTER TABLE RHCARACTERISTICA ADD CONSTRAINT ATCARACTERFKSGFI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE RHCURSO ADD CONSTRAINT RHCURSOFKRHAREA FOREIGN KEY (CODAREA, CODFILIALAR, CODEMPAR) REFERENCES RHAREA (CODAREA, CODFILIAL, CODEMP);
ALTER TABLE RHCURSO ADD CONSTRAINT RHCURSOFKRHNIVELC FOREIGN KEY (CODNIVELCURSO, CODFILIALNC, CODEMPNC) REFERENCES RHNIVELCURSO (CODNIVELCURSO, CODFILIAL, CODEMP);
ALTER TABLE RHCURSO ADD CONSTRAINT RHCURSOFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE RHEMPREGADO ADD CONSTRAINT RHEMPREGADOFKRHDEP FOREIGN KEY (CODDEP, CODFILIALDP, CODEMPDP) REFERENCES RHDEPTO (CODDEP, CODFILIAL, CODEMP);
ALTER TABLE RHEMPREGADO ADD CONSTRAINT RHEMPREGADOFKRHFUN FOREIGN KEY (CODFUNC, CODFILIALFO, CODEMPFO) REFERENCES RHFUNCAO (CODFUNC, CODFILIAL, CODEMP);
ALTER TABLE RHEMPREGADO ADD CONSTRAINT RHEMPREGADOFKRHTUR FOREIGN KEY (CODTURNO, CODFILIALTO, CODEMPTO) REFERENCES RHTURNO (CODTURNO, CODFILIAL, CODEMP);
ALTER TABLE RHEMPREGADO ADD CONSTRAINT RHEMPREGADOSALFKRHEMPR FOREIGN KEY (MATEMPR, CODFILIAL, CODEMPDP) REFERENCES RHEMPREGADO (MATEMPR, CODFILIAL, CODEMP);
ALTER TABLE RHEMPREGADOBENEF ADD CONSTRAINT RHEMPREGBENEFFKRHBENEF FOREIGN KEY (CODBENEF, CODFILIALBN, CODEMPBN) REFERENCES RHBENEFICIO (CODBENEF, CODFILIAL, CODEMP);
ALTER TABLE RHEMPREGADOBENEF ADD CONSTRAINT RHEMPREGBENEFFKRHEMPR FOREIGN KEY (MATEMPR, CODFILIAL, CODEMP) REFERENCES RHEMPREGADO (MATEMPR, CODFILIAL, CODEMP);
ALTER TABLE RHEMPREGADOR ADD CONSTRAINT RHEMPREGADORFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE RHNIVELCURSO ADD CONSTRAINT RHNIVELCURSOFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE RHPONTO ADD CONSTRAINT RHPONTOFKRHEMPR FOREIGN KEY (MATEMPR, CODFILIAL, CODEMP) REFERENCES RHEMPREGADO (MATEMPR, CODFILIAL, CODEMP);
ALTER TABLE RHVAGA ADD CONSTRAINT RHVAGAFKEMPR FOREIGN KEY (CODEMPR, CODFILIALEM, CODEMPEM) REFERENCES RHEMPREGADOR (CODEMPR, CODFILIAL, CODEMP);
ALTER TABLE RHVAGA ADD CONSTRAINT RHVAGAFKRHFUNC FOREIGN KEY (CODFUNC, CODFILIALFC, CODEMPFC) REFERENCES RHFUNCAO (CODFUNC, CODFILIAL, CODEMP);
ALTER TABLE RHVAGA ADD CONSTRAINT RHVAGAFKRHTURNO FOREIGN KEY (CODTURNO, CODFILIALTN, CODEMPTN) REFERENCES RHTURNO (CODTURNO, CODFILIAL, CODEMP);
ALTER TABLE RHVAGACANDIDATO ADD CONSTRAINT RHVAGACANDFKRHCAND FOREIGN KEY (CODCAND, CODFILIALCA, CODEMPCA) REFERENCES RHCANDIDATO (CODCAND, CODFILIAL, CODEMP);
ALTER TABLE RHVAGACANDIDATO ADD CONSTRAINT RHVAGACANDFKRHVAGA FOREIGN KEY (CODVAGA, CODFILIAL, CODEMP) REFERENCES RHVAGA (CODVAGA, CODFILIAL, CODEMP);
ALTER TABLE RHVAGACARACQUALI ADD CONSTRAINT RHVAGACTRQUALIFKRHCARAC FOREIGN KEY (CODCARAC, CODFILIALCT, CODEMPCT) REFERENCES RHCARACTERISTICA (CODCARAC, CODFILIAL, CODEMP);
ALTER TABLE RHVAGACARACQUALI ADD CONSTRAINT RHVAGACTRQUALIFKRHVAGA FOREIGN KEY (CODVAGA, CODFILIAL, CODEMP) REFERENCES RHVAGA (CODVAGA, CODFILIAL, CODEMP);
ALTER TABLE RHVAGACARACREST ADD CONSTRAINT RHVAGACTRESTFKRHCARAC FOREIGN KEY (CODCARAC, CODFILIALCT, CODEMPCT) REFERENCES RHCARACTERISTICA (CODCARAC, CODFILIAL, CODEMP);
ALTER TABLE RHVAGACARACREST ADD CONSTRAINT RHVAGACTRESTFKRHVAGA FOREIGN KEY (CODVAGA, CODFILIAL, CODEMP) REFERENCES RHVAGA (CODVAGA, CODFILIAL, CODEMP);
ALTER TABLE RHVAGACURSO ADD CONSTRAINT RHVAGACURFKRHCURSO FOREIGN KEY (CODCURSO, CODFILIALCS, CODEMPCS) REFERENCES RHCURSO (CODCURSO, CODFILIAL, CODEMP);
ALTER TABLE RHVAGACURSO ADD CONSTRAINT RHVAGACURFKRHVAGA FOREIGN KEY (CODVAGA, CODFILIAL, CODEMP) REFERENCES RHVAGA (CODVAGA, CODFILIAL, CODEMP);
ALTER TABLE RHVAGASTATUS ADD CONSTRAINT RHVAGASTATUSFKRHVAGA FOREIGN KEY (CODVAGA, CODFILIAL, CODEMP) REFERENCES RHVAGA (CODVAGA, CODFILIAL, CODEMP);
ALTER TABLE SGACESSOEU ADD CONSTRAINT SGACESSOEUFKSGFILI FOREIGN KEY (CODFILIALFL, CODEMPFL) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE SGACESSOEU ADD CONSTRAINT SGACESSOEUFKSGUSUA FOREIGN KEY (IDUSU, CODFILIAL, CODEMP) REFERENCES SGUSUARIO (IDUSU, CODFILIAL, CODEMP);
ALTER TABLE SGACESSOMG ADD CONSTRAINT SGACESSOMGFKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE SGACESSOMU ADD CONSTRAINT SGACESSOMUFKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE SGAGENDA ADD CONSTRAINT SGAGENDAFKSGAGENTE FOREIGN KEY (CODAGEEMIT, TIPOAGEEMIT, CODFILIALAE, CODEMPAE) REFERENCES SGAGENTE (CODAGE, TIPOAGE, CODFILIAL, CODEMP);
ALTER TABLE SGATRIBUICAO ADD CONSTRAINT SGATRIBUICAOFKSGFI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE SGATRIBUSU ADD CONSTRAINT SGATRIBUSUFKSGATRI FOREIGN KEY (IDATRIB, CODFILIAL, CODEMP) REFERENCES SGATRIBUICAO (IDATRIB, CODFILIAL, CODEMP);
ALTER TABLE SGATRIBUSU ADD CONSTRAINT SGATRIBUSUSGUSUARI FOREIGN KEY (IDUSU, CODFILIALUU, CODEMPUU) REFERENCES SGUSUARIO (IDUSU, CODFILIAL, CODEMP);
ALTER TABLE SGCONEXAO ADD CONSTRAINT SGCONEXAOFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE SGCONEXAO ADD CONSTRAINT SGCONEXAOFKSGUSUAR FOREIGN KEY (IDUSU, CODFILIAL, CODEMP) REFERENCES SGUSUARIO (IDUSU, CODFILIAL, CODEMP);
ALTER TABLE SGEMPRESA ADD CONSTRAINT SGEMPRESAFKSGMUNIC FOREIGN KEY (CODMUNIC, SIGLAUF, CODPAIS) REFERENCES SGMUNICIPIO (CODMUNIC, SIGLAUF, CODPAIS);
ALTER TABLE SGEQVCLIFOR ADD CONSTRAINT SGEQVCLIFORFKCPFOR FOREIGN KEY (CODFOR, CODFILIALFR, CODEMPFR) REFERENCES CPFORNECED (CODFOR, CODFILIAL, CODEMP);
ALTER TABLE SGEQVCLIFOR ADD CONSTRAINT SGEQVCLIFORFKVDCLI FOREIGN KEY (CODCLI, CODFILIALCL, CODEMPCL) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);
ALTER TABLE SGESTACAOIMP ADD CONSTRAINT SGESTACAOIMPFKSGES FOREIGN KEY (CODEST, CODFILIAL, CODEMP) REFERENCES SGESTACAO (CODEST, CODFILIAL, CODEMP);
ALTER TABLE SGESTACAOIMP ADD CONSTRAINT SGESTACAOIMPFKSGIM FOREIGN KEY (CODIMP, CODFILIALIP, CODEMPIP) REFERENCES SGIMPRESSORA (CODIMP, CODFILIAL, CODEMP);
ALTER TABLE SGESTACAOIMP ADD CONSTRAINT SGESTACAOIMPFKSGPA FOREIGN KEY (CODPAPEL, CODFILIAL, CODEMP) REFERENCES SGPAPEL (CODPAPEL, CODFILIAL, CODEMP);
ALTER TABLE SGESTCIVIL ADD CONSTRAINT SGESTCIVILFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE SGFILIAL ADD CONSTRAINT SGFILIALFKSGMUNIC FOREIGN KEY (CODMUNIC, SIGLAUF, CODPAIS) REFERENCES SGMUNICIPIO (CODMUNIC, SIGLAUF, CODPAIS);
ALTER TABLE SGGRAUINST ADD CONSTRAINT SGGRAUINSTFKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE SGGRPUSU ADD CONSTRAINT SGGRPUSUFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE SGIMPRESSORA ADD CONSTRAINT SGIMPRESSORAFKSGFI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE SGITFLUXO ADD CONSTRAINT SGITFLUXOFKSGFLUXO FOREIGN KEY (CODFLUXO, CODFILIAL, CODEMP) REFERENCES SGFLUXO (CODFLUXO, CODFILIAL, CODEMP);
ALTER TABLE SGITFLUXO ADD CONSTRAINT SGITFLUXOFKSGPROCE FOREIGN KEY (CODPROC, CODFILIALPC, CODEMPPC) REFERENCES SGPROCESSO (CODPROC, CODFILIAL, CODEMP);
ALTER TABLE SGITPREFERE6 ADD CONSTRAINT SGITPREFERE6FKFNBA FOREIGN KEY (CODBANCO, CODFILIALBO, CODEMPBO) REFERENCES FNBANCO (CODBANCO, CODFILIAL, CODEMP);
ALTER TABLE SGITPREFERE6 ADD CONSTRAINT SGITPREFERE6FKFNCO FOREIGN KEY (NUMCONTA, CODFILIALCA, CODEMPCA) REFERENCES FNCONTA (NUMCONTA, CODFILIAL, CODEMP);
ALTER TABLE SGITPREFERE6 ADD CONSTRAINT SGITPREFERE6FKSGPR FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGPREFERE6 (CODFILIAL, CODEMP);
ALTER TABLE SGITPROCESSO ADD CONSTRAINT SGITPROCESSOFKSGPR FOREIGN KEY (CODPROC, CODFILIAL, CODEMP) REFERENCES SGPROCESSO (CODPROC, CODFILIAL, CODEMP);
ALTER TABLE SGITTABELA ADD CONSTRAINT SGITTABELAFKSGTABE FOREIGN KEY (CODTB, CODFILIAL, CODEMP) REFERENCES SGTABELA (CODTB, CODFILIAL, CODEMP);
ALTER TABLE SGLOG ADD CONSTRAINT SGLOGFKPVCAIXA FOREIGN KEY (CODCAIXA, CODFILIALCX, CODEMPCX) REFERENCES PVCAIXA (CODCAIXA, CODFILIAL, CODEMP);
ALTER TABLE SGLOG ADD CONSTRAINT SGLOGFKSGUSUARIO FOREIGN KEY (IDUSU, CODFILIALUS, CODEMPUS) REFERENCES SGUSUARIO (IDUSU, CODFILIAL, CODEMP);
ALTER TABLE SGMENU ADD CONSTRAINT SGMENUFKSGMODULO FOREIGN KEY (CODMODU, CODSIS) REFERENCES SGMODULO (CODMODU, CODSIS);
ALTER TABLE SGMENUOBJ ADD CONSTRAINT SGMENUOBJFKSGMENU FOREIGN KEY (CODMENU, CODMODU, CODSIS) REFERENCES SGMENU (CODMENU, CODMODU, CODSIS);
ALTER TABLE SGMENUOBJ ADD CONSTRAINT SGMENUOBJFKSGOBJET FOREIGN KEY (IDOBJ, CODEMP) REFERENCES SGOBJETO (IDOBJ, CODEMP);
ALTER TABLE SGMODETIQUETA ADD CONSTRAINT SGMODETIQUETAFKSGP FOREIGN KEY (CODPAPEL, CODFILIALPL, CODEMPPL) REFERENCES SGPAPEL (CODPAPEL, CODFILIAL, CODEMP);
ALTER TABLE SGMUNICIPIO ADD CONSTRAINT SGMUNICIPIOFKSGUF FOREIGN KEY (SIGLAUF, CODPAIS) REFERENCES SGUF (SIGLAUF, CODPAIS);
ALTER TABLE SGOBJETO ADD CONSTRAINT SGOBJETOFKSGEMPRES FOREIGN KEY (CODEMP) REFERENCES SGEMPRESA (CODEMP);
ALTER TABLE SGOBJETOTB ADD CONSTRAINT SGOBJETOTBFKSGOBJE FOREIGN KEY (IDOBJ, CODEMP) REFERENCES SGOBJETO (IDOBJ, CODEMP);
ALTER TABLE SGOBJETOTB ADD CONSTRAINT SGOBJETOTBFKSGTABE FOREIGN KEY (CODTB, CODFILIALTB, CODEMPTB) REFERENCES SGTABELA (CODTB, CODFILIAL, CODEMP);
ALTER TABLE SGPAPEL ADD CONSTRAINT SGPAPELFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FK2EQTIP FOREIGN KEY (CODTIPOMOV2, CODFILIALT2, CODEMPT2) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FK3EQTIP FOREIGN KEY (CODTIPOMOV3, CODFILIALT3, CODEMPT3) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FK4EQTIP FOREIGN KEY (CODTIPOMOV4, CODFILIALT4, CODEMPT4) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FK5EQTIP FOREIGN KEY (CODTIPOMOV5, CODFILIALT5, CODEMPT5) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FK6EQTIP FOREIGN KEY (CODTIPOMOV6, CODFILIALT6, CODEMPT6) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FK8EQTIP FOREIGN KEY (CODTIPOMOV8, CODFILIALT8, CODEMPT8) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKCPFORN FOREIGN KEY (CODFOR, CODFILIALFR, CODEMPFR) REFERENCES CPFORNECED (CODFOR, CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKCPTIPO FOREIGN KEY (CODTIPOFOR, CODFILIALTF, CODEMPTF) REFERENCES CPTIPOFOR (CODTIPOFOR, CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKEQGRUP FOREIGN KEY (CODGRUP, CODFILIALGP, CODEMPGP) REFERENCES EQGRUPO (CODGRUP, CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKEQMARC FOREIGN KEY (CODMARCA, CODFILIALMC, CODEMPMC) REFERENCES EQMARCA (CODMARCA, CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKEQTIPO FOREIGN KEY (CODTIPOMOV, CODFILIALTM, CODEMPTM) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKFNHISTP FOREIGN KEY (CODHISTPAG, CODFILIALHISTPAG, CODEMPHISTPAG) REFERENCES FNHISTPAD (CODHIST, CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKFNHISTR FOREIGN KEY (CODHISTREC, CODFILIALHISTREC, CODEMPHISTREC) REFERENCES FNHISTPAD (CODHIST, CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKFNMOED FOREIGN KEY (CODMOEDA, CODFILIALMO, CODEMPMO) REFERENCES FNMOEDA (CODMOEDA, CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKFNPLAN FOREIGN KEY (CODPLANOPAG, CODFILIALPG, CODEMPPG) REFERENCES FNPLANOPAG (CODPLANOPAG, CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKFNTBJU FOREIGN KEY (CODTBJ, CODFILIALTJ, CODEMPTJ) REFERENCES FNTBJUROS (CODTBJ, CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKLFMENS FOREIGN KEY (CODMENSORC, CODFILIALMENSORC, CODEMPMENSORC) REFERENCES LFMENSAGEM (CODMENS, CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKVDCLAS FOREIGN KEY (CODCLASCLI, CODFILIALCE, CODEMPCE) REFERENCES VDCLASCLI (CODCLASCLI, CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKVDTABP FOREIGN KEY (CODTAB, CODFILIALTB, CODEMPTB) REFERENCES VDTABPRECO (CODTAB, CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKVDTIPC FOREIGN KEY (CODTIPOCLI, CODFILIALTC, CODEMPTC) REFERENCES VDTIPOCLI (CODTIPOCLI, CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKVDTRAN FOREIGN KEY (CODTRAN, CODFILIALTN, CODEMPTN) REFERENCES VDTRANSP (CODTRAN, CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE2 ADD CONSTRAINT SGPREFERE2FK2ATTIP FOREIGN KEY (CODTPATENDO2, CODFILIALT2, CODEMPT2) REFERENCES ATTIPOATENDO (CODTPATENDO, CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE2 ADD CONSTRAINT SGPREFERE2FK3ATTIP FOREIGN KEY (CODTPATENDO3, CODFILIALT3, CODEMPT3) REFERENCES ATTIPOATENDO (CODTPATENDO, CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE2 ADD CONSTRAINT SGPREFERE2FKATATEN FOREIGN KEY (CODATEND, CODFILIALAE, CODEMPAE) REFERENCES ATATENDENTE (CODATEND, CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE2 ADD CONSTRAINT SGPREFERE2FKATTIPO FOREIGN KEY (CODTPATENDO, CODFILIALTO, CODEMPTO) REFERENCES ATTIPOATENDO (CODTPATENDO, CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE2 ADD CONSTRAINT SGPREFERE2FKSGITT2 FOREIGN KEY (CODITTBV, CODTBV, CODFILIALTV, CODEMPTV) REFERENCES SGITTABELA (CODITTB, CODTB, CODFILIAL, CODEMP)
  USING INDEX SGPREFERE2FKSGITTABELA02;
ALTER TABLE SGPREFERE2 ADD CONSTRAINT SGPREFERE2FKSGITTA FOREIGN KEY (CODITTBA, CODTBA, CODFILIALTA, CODEMPTA) REFERENCES SGITTABELA (CODITTB, CODTB, CODFILIAL, CODEMP)
  USING INDEX SGPREFERE2FKSGITTABELA;
ALTER TABLE SGPREFERE2 ADD CONSTRAINT SGPREFERE2FKVDCLAS FOREIGN KEY (CODCLASCLI, CODFILIALCI, CODEMPCI) REFERENCES VDCLASCLI (CODCLASCLI, CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE2 ADD CONSTRAINT SGPREFERE2FKVDTIPO FOREIGN KEY (CODTIPOCLI, CODFILIALTI, CODEMPTI) REFERENCES VDTIPOCLI (CODTIPOCLI, CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE2 ADD CONSTRAINT SGPREFERE2FKVDVEND FOREIGN KEY (CODVEND, CODFILIALVD, CODEMPVD) REFERENCES VDVENDEDOR (CODVEND, CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE3 ADD CONSTRAINT SGPREFERE3FKTKATIVCE FOREIGN KEY (CODATIVCE, CODFILIALCE, CODEMPCE) REFERENCES TKATIVIDADE (CODATIV, CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE3 ADD CONSTRAINT SGPREFERE3FKTKATIVTE FOREIGN KEY (CODATIVTE, CODFILIALTE, CODEMPTE) REFERENCES TKATIVIDADE (CODATIV, CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE4 ADD CONSTRAINT SGPREFERE4FKEQPROD FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE4 ADD CONSTRAINT SGPREFERE4FKEQTIPO FOREIGN KEY (CODTIPOMOV, CODFILIALTM, CODEMPTM) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE4 ADD CONSTRAINT SGPREFERE4FKPLANOP FOREIGN KEY (CODPLANOPAG, CODFILIALPP, CODEMPPP) REFERENCES FNPLANOPAG (CODPLANOPAG, CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE4 ADD CONSTRAINT SGPREFERE4FKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE4 ADD CONSTRAINT SGPREFERE4FKVDCLIE FOREIGN KEY (CODCLI, CODFILIALCL, CODEMPCL) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE5 ADD CONSTRAINT SGPREFERE5FKEQTIPO FOREIGN KEY (CODTIPOMOV, CODFILIALTM, CODEMPTM) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);
ALTER TABLE SGPREFERE5 ADD CONSTRAINT SGPREFERE5FKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE SGSEQUENCIA ADD CONSTRAINT SGSEQUENCIAFKSGFIL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE SGTABELA ADD CONSTRAINT SGTABELAFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE SGTRATARET ADD CONSTRAINT SGTRATARETFKSGITP2 FOREIGN KEY (CODPROCGT, SEQITPROCGT, CODFILIALGT, CODEMPGT) REFERENCES SGITPROCESSO (CODPROC, SEQITPROC, CODFILIAL, CODEMP)
  USING INDEX SGTRATARETFKSGITPROCESSO2;
ALTER TABLE SGTRATARET ADD CONSTRAINT SGTRATARETFKSGITPR FOREIGN KEY (CODPROC, SEQITPROC, CODFILIAL, CODEMP) REFERENCES SGITPROCESSO (CODPROC, SEQITPROC, CODFILIAL, CODEMP)
  USING INDEX SGTRATARETFKSGITPROCESSO;
ALTER TABLE SGUF ADD CONSTRAINT SGUFFKSGPAIS FOREIGN KEY (CODPAIS) REFERENCES SGPAIS (CODPAIS);
ALTER TABLE SGUSUARIO ADD CONSTRAINT SGUSUARIOFKEQALMOX FOREIGN KEY (CODALMOX, CODFILIALAM, CODEMPAM) REFERENCES EQALMOX (CODALMOX, CODFILIAL, CODEMP);
ALTER TABLE SGUSUARIO ADD CONSTRAINT SGUSUARIOFKFNCC FOREIGN KEY (CODCC, ANOCC, CODFILIALCC, CODEMPCC) REFERENCES FNCC (CODCC, ANOCC, CODFILIAL, CODEMP);
ALTER TABLE SGUSUARIO ADD CONSTRAINT SGUSUARIOFKSGAGENT FOREIGN KEY (CODAGE, TIPOAGE, CODFILIALAE, CODEMPAE) REFERENCES SGAGENTE (CODAGE, TIPOAGE, CODFILIAL, CODEMP);
ALTER TABLE SGUSUARIO ADD CONSTRAINT SGUSUARIOFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE SGUSUARIO ADD CONSTRAINT SGUSUARIOFKSGGRPUS FOREIGN KEY (IDGRPUSU, CODFILIALIG, CODEMPIG) REFERENCES SGGRPUSU (IDGRPUSU, CODFILIAL, CODEMP);
ALTER TABLE SVAVALIACAO ADD CONSTRAINT SVAVALIACAOFKEQPRO FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);
ALTER TABLE SVAVALIACAO ADD CONSTRAINT SVAVALIACAOFKSVITO FOREIGN KEY (CODOS, CODITOS, CODFILIAL, CODEMP) REFERENCES SVITOS (CODOS, CODITOS, CODFILIAL, CODEMP);
ALTER TABLE SVEXECUCAO ADD CONSTRAINT SVEXECUCAOFKEQPROD FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);
ALTER TABLE SVEXECUCAO ADD CONSTRAINT SVEXECUCAOFKSVITOS FOREIGN KEY (CODOS, CODITOS, CODFILIAL, CODEMP) REFERENCES SVITOS (CODOS, CODITOS, CODFILIAL, CODEMP);
ALTER TABLE SVITOS ADD CONSTRAINT SVITOSFKEQPRODUTO FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);
ALTER TABLE SVITOS ADD CONSTRAINT SVITOSFKSVOS FOREIGN KEY (CODOS, CODFILIAL, CODEMP) REFERENCES SVOS (CODOS, CODFILIAL, CODEMP);
ALTER TABLE SVOS ADD CONSTRAINT SVOSFKSVCONVENIADO FOREIGN KEY (CODCONV, CODFILIALCV, CODEMPCV) REFERENCES ATCONVENIADO (CODCONV, CODFILIAL, CODEMP);
ALTER TABLE SVOS ADD CONSTRAINT SVOSFKVDCLIENTE FOREIGN KEY (CODCLI, CODFILIALCL, CODEMPCL) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);
ALTER TABLE TKCAMPANHACTO ADD CONSTRAINT TKCAMPANHACTOFKTKCAMP FOREIGN KEY (CODCAMP, CODFILIAL, CODEMP) REFERENCES TKCAMPANHA (CODCAMP, CODFILIAL, CODEMP);
ALTER TABLE TKCAMPANHACTO ADD CONSTRAINT TKCAMPANHACTOFKTKCTO FOREIGN KEY (CODCTO, CODFILIALCO, CODEMPCO) REFERENCES TKCONTATO (CODCTO, CODFILIAL, CODEMP);
ALTER TABLE TKCAMPANHAEMAIL ADD CONSTRAINT TKCAMPANHAEMAILFKTKCAMP FOREIGN KEY (CODCAMP, CODFILIAL, CODEMP) REFERENCES TKCAMPANHA (CODCAMP, CODFILIAL, CODEMP);
ALTER TABLE TKCAMPANHAEMAIL ADD CONSTRAINT TKCAMPANHAEMAILFKTKCTO FOREIGN KEY (CODEMAIL, CODFILIALEM, CODEMPEM) REFERENCES TKEMAIL (CODEMAIL, CODFILIAL, CODEMP);
ALTER TABLE TKCONTATO ADD CONSTRAINT TKCONTATOFKORIGCONT FOREIGN KEY (CODORIGCONT, CODFILIALOC, CODEMPOC) REFERENCES TKORIGCONT (CODORIGCONT, CODFILIAL, CODEMP);
ALTER TABLE TKCONTATO ADD CONSTRAINT TKCONTATOFKSETORCT FOREIGN KEY (CODSETORCTO, CODFILIALSO, CODEMPSO) REFERENCES TKSETORCTO (CODSETORCTO, CODFILIAL, CODEMP);
ALTER TABLE TKCONTATO ADD CONSTRAINT TKCONTATOFKSGMUNIC FOREIGN KEY (CODMUNIC, SIGLAUF, CODPAIS) REFERENCES SGMUNICIPIO (CODMUNIC, SIGLAUF, CODPAIS);
ALTER TABLE TKCONTATO ADD CONSTRAINT TKCONTATOFKTKTIPOI FOREIGN KEY (CODTPIMP, CODFILIALTI, CODEMPTI) REFERENCES TKTIPOIMP (CODTPIMP, CODFILIAL, CODEMP);
ALTER TABLE TKCONTATO ADD CONSTRAINT TKCONTATOFKVDSETOR FOREIGN KEY (CODSETOR, CODFILIALSR, CODEMPSR) REFERENCES VDSETOR (CODSETOR, CODFILIAL, CODEMP);
ALTER TABLE TKCONTATO ADD CONSTRAINT TKCONTATOFKVDTIPOC FOREIGN KEY (CODTIPOCLI, CODFILIALTC, CODEMPTC) REFERENCES VDTIPOCLI (CODTIPOCLI, CODFILIAL, CODEMP);
ALTER TABLE TKCONTATO ADD CONSTRAINT TKCONTATOFKVDVENDE FOREIGN KEY (CODVEND, CODFILIALVD, CODEMPVD) REFERENCES VDVENDEDOR (CODVEND, CODFILIAL, CODEMP);
ALTER TABLE TKCTOATIV ADD CONSTRAINT TKCTOATIVFKTKATIVI FOREIGN KEY (CODATIV, CODFILIALAV, CODEMPAV) REFERENCES TKATIVIDADE (CODATIV, CODFILIAL, CODEMP);
ALTER TABLE TKCTOATIV ADD CONSTRAINT TKCTOATIVFKTKCONTA FOREIGN KEY (CODCTO, CODFILIAL, CODEMP) REFERENCES TKCONTATO (CODCTO, CODFILIAL, CODEMP);
ALTER TABLE TKCTOGRPINT ADD CONSTRAINT TKCTOGRPINTFKEQGRUPO FOREIGN KEY (CODGRUP, CODFILIALGP, CODEMPGP) REFERENCES EQGRUPO (CODGRUP, CODFILIAL, CODEMP);
ALTER TABLE TKCTOGRPINT ADD CONSTRAINT TKCTOGRPINTFKTKCTO FOREIGN KEY (CODCTO, CODFILIAL, CODEMP) REFERENCES TKCONTATO (CODCTO, CODFILIAL, CODEMP);
ALTER TABLE TKEMAIL ADD CONSTRAINT TKEMAILFKTKCONFEMAIL FOREIGN KEY (CODCONFEMAIL, CODFILIALCM, CODEMPCM) REFERENCES TKCONFEMAIL (CODCONFEMAIL, CODFILIAL, CODEMP);
ALTER TABLE TKHISTORICO ADD CONSTRAINT TKHISTORICOFKATATE FOREIGN KEY (CODATEND, CODFILIALAE, CODEMPAE) REFERENCES ATATENDENTE (CODATEND, CODFILIAL, CODEMP);
ALTER TABLE TKHISTORICO ADD CONSTRAINT TKHISTORICOFKTKCON FOREIGN KEY (CODCTO, CODFILIALCO, CODEMPCO) REFERENCES TKCONTATO (CODCTO, CODFILIAL, CODEMP);
ALTER TABLE TKHISTORICO ADD CONSTRAINT TKHISTORICOFKTKSITCAMP FOREIGN KEY (CODCAMP, CODFILIALCA, CODEMPCA, CODCTO, CODFILIALCO, CODEMPCO, SEQSITCAMP) REFERENCES TKSITCAMP (CODCAMP, CODFILIAL, CODEMP, CODCTO, CODFILIALCO, CODEMPCO, SEQSITCAMP);
ALTER TABLE TKHISTORICO ADD CONSTRAINT TKHISTORICOFKVDCLI FOREIGN KEY (CODCLI, CODFILIALCL, CODEMPCL) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);
ALTER TABLE TKORIGCONT ADD CONSTRAINT TKORIGCONTFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE TKSITCAMP ADD CONSTRAINT TKSITCAMPFKTKCAMP FOREIGN KEY (CODCAMP, CODFILIAL, CODEMP) REFERENCES TKCAMPANHA (CODCAMP, CODFILIAL, CODEMP);
ALTER TABLE TKSITCAMP ADD CONSTRAINT TKSITCAMPFKTKCTO FOREIGN KEY (CODCTO, CODFILIALCO, CODEMPCO) REFERENCES TKCONTATO (CODCTO, CODFILIAL, CODEMP);
ALTER TABLE VDAUXVENDA ADD CONSTRAINT VDAUXVENDAFKVDVEND FOREIGN KEY (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP) REFERENCES VDVENDA (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP);
ALTER TABLE VDCLASCLI ADD CONSTRAINT VDCLASCLIFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE VDCLIAUTP ADD CONSTRAINT VDCLIAUTPFKVDCLIEN FOREIGN KEY (CODCLI, CODFILIAL, CODEMP) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);
ALTER TABLE VDCLICOMPL ADD CONSTRAINT VDCLICOMPLFKVDCLIE FOREIGN KEY (CODCLI, CODFILIAL, CODEMP) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);
ALTER TABLE VDCLICONTAS ADD CONSTRAINT VDCLICONTASFKVDBAN FOREIGN KEY (CODBANCO, CODFILIALBC, CODEMPBC) REFERENCES FNBANCO (CODBANCO, CODFILIAL, CODEMP);
ALTER TABLE VDCLICONTAS ADD CONSTRAINT VDCLICONTASFKVDCLI FOREIGN KEY (CODCLI, CODFILIAL, CODEMP) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);
ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTEFKFNBANCO FOREIGN KEY (CODBANCO, CODFILIALBO, CODEMPBO) REFERENCES FNBANCO (CODBANCO, CODFILIAL, CODEMP);
ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTEFKFNCARTC FOREIGN KEY (CODCARTCOB, CODFILIALCB, CODEMPCB, CODBANCO, CODFILIALBO, CODEMPBO) REFERENCES FNCARTCOB (CODCARTCOB, CODFILIAL, CODEMP, CODBANCO, CODFILIALBO, CODEMPBO);
ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTEFKFNHISTP FOREIGN KEY (CODHIST, CODFILIALHP, CODEMPHP) REFERENCES FNHISTPAD (CODHIST, CODFILIAL, CODEMP);
ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTEFKFNPLANO FOREIGN KEY (CODPLANOPAG, CODFILIALPG, CODEMPPG) REFERENCES FNPLANOPAG (CODPLANOPAG, CODFILIAL, CODEMP);
ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTEFKFNTIPOB FOREIGN KEY (CODTIPOCOB, CODFILIALTC, CODEMPTC) REFERENCES FNTIPOCOB (CODTIPOCOB, CODFILIAL, CODEMP)
  USING INDEX VDCLIENTEFKFNTIPOCOB;
ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTEFKFNTIPOD FOREIGN KEY (CODTPCRED, CODFILIALTR, CODEMPTR) REFERENCES FNTIPOCRED (CODTPCRED, CODFILIAL, CODEMP)
  USING INDEX VDCLIENTEFKFNTIPOCRED;
ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTEFKLFTIPOF FOREIGN KEY (CODFISCCLI, CODFILIALFC, CODEMPFC) REFERENCES LFTIPOFISCCLI (CODFISCCLI, CODFILIAL, CODEMP);
ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTEFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTEFKSGITTAB FOREIGN KEY (CODITTBEC, CODTBEC, CODFILIALEC, CODEMPEC) REFERENCES SGITTABELA (CODITTB, CODTB, CODFILIAL, CODEMP);
ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTEFKSGMUNIC FOREIGN KEY (CODMUNIC, SIGLAUF, CODPAIS) REFERENCES SGMUNICIPIO (CODMUNIC, SIGLAUF, CODPAIS);
ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTEFKSGMUNICCOB FOREIGN KEY (CODMUNICCOB, SIGLAUFCOB, CODPAISCOB) REFERENCES SGMUNICIPIO (CODMUNIC, SIGLAUF, CODPAIS);
ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTEFKSGMUNICENT FOREIGN KEY (CODMUNICENT, SIGLAUFENT, CODPAISENT) REFERENCES SGMUNICIPIO (CODMUNIC, SIGLAUF, CODPAIS);
ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTEFKVDCLASC FOREIGN KEY (CODCLASCLI, CODFILIALCC, CODEMPCC) REFERENCES VDCLASCLI (CODCLASCLI, CODFILIAL, CODEMP);
ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTEFKVDSETOR FOREIGN KEY (CODSETOR, CODFILIALSR, CODEMPSR) REFERENCES VDSETOR (CODSETOR, CODFILIAL, CODEMP);
ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTEFKVDTIPOC FOREIGN KEY (CODTIPOCLI, CODFILIALTI, CODEMPTI) REFERENCES VDTIPOCLI (CODTIPOCLI, CODFILIAL, CODEMP);
ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTEFKVDTRANS FOREIGN KEY (CODTRAN, CODFILIALTN, CODEMPTN) REFERENCES VDTRANSP (CODTRAN, CODFILIAL, CODEMP);
ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTEFKVDVENDE FOREIGN KEY (CODVEND, CODFILIALVD, CODEMPVD) REFERENCES VDVENDEDOR (CODVEND, CODFILIAL, CODEMP);
ALTER TABLE VDCLIENTEFOR ADD CONSTRAINT VDCLIENTEFORFKCPFO FOREIGN KEY (CODFOR, CODFILIALFR, CODEMPFR) REFERENCES CPFORNECED (CODFOR, CODFILIAL, CODEMP);
ALTER TABLE VDCLIIMOV ADD CONSTRAINT VDCLIIMOVFKVDCLIEN FOREIGN KEY (CODCLI, CODFILIAL, CODEMP) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);
ALTER TABLE VDCLIMETAVEND ADD CONSTRAINT VDCLIMETAVENDFKVDC FOREIGN KEY (CODCLI, CODFILIAL, CODEMP) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);
ALTER TABLE VDCLIREFC ADD CONSTRAINT VDCLIREFCFKVDCLIEN FOREIGN KEY (CODCLI, CODFILIAL, CODEMP) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);
ALTER TABLE VDCLIREFP ADD CONSTRAINT VDCLIREFPFKVDCLIEN FOREIGN KEY (CODCLI, CODFILIAL, CODEMP) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);
ALTER TABLE VDCLISOCIOS ADD CONSTRAINT VDCLISOCIOSFKVDCLI FOREIGN KEY (CODCLI, CODFILIAL, CODEMP) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);
ALTER TABLE VDCLITERRA ADD CONSTRAINT VDCLITERRAFKVDCLIE FOREIGN KEY (CODCLI, CODFILIAL, CODEMP) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);
ALTER TABLE VDCLIVEIC ADD CONSTRAINT VDCLIVEICFKVDCLIEN FOREIGN KEY (CODCLI, CODFILIAL, CODEMP) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);
ALTER TABLE VDCOMISSAO ADD CONSTRAINT VDCOMISFKVDVENDEDO FOREIGN KEY (CODVEND, CODFILIALVD, CODEMPVD) REFERENCES VDVENDEDOR (CODVEND, CODFILIAL, CODEMP);
ALTER TABLE VDCOMISSAO ADD CONSTRAINT VDCOMISSAOFKFNITRE FOREIGN KEY (NPARCITREC, CODREC, CODFILIALRC, CODEMP) REFERENCES FNITRECEBER (NPARCITREC, CODREC, CODFILIAL, CODEMP);
ALTER TABLE VDCOMISSAO ADD CONSTRAINT VDCOMISSAOFKFNPAGT FOREIGN KEY (CODPCOMI, CODFILIALCI, CODEMP) REFERENCES FNPAGTOCOMI (CODPCOMI, CODFILIAL, CODEMP);
ALTER TABLE VDCOMISSAO ADD CONSTRAINT VDCOMISSAOFKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE VDCONTRATO ADD CONSTRAINT VDCONTRATOFKVDCLIENTE FOREIGN KEY (CODCLI, CODFILIALCL, CODEMPCL) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);
ALTER TABLE VDFOTOPROD ADD CONSTRAINT VDFOTOPRODFKEQPROD FOREIGN KEY (CODPROD, CODFILIAL, CODEMP) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);
ALTER TABLE VDFRETEVD ADD CONSTRAINT VDFRETEVDFKVDTRANS FOREIGN KEY (CODTRAN, CODFILIALTN, CODEMPTN) REFERENCES VDTRANSP (CODTRAN, CODFILIAL, CODEMP);
ALTER TABLE VDFRETEVD ADD CONSTRAINT VDFRETEVDFKVDVENDA FOREIGN KEY (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP) REFERENCES VDVENDA (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP);
ALTER TABLE VDITCONTRATO ADD CONSTRAINT VDITCONTRATOFKEQPRODU FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);
ALTER TABLE VDITKIT ADD CONSTRAINT VDITKITFKEQPRODUTO FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);
ALTER TABLE VDITKIT ADD CONSTRAINT VDITKITFKVDKIT FOREIGN KEY (CODKIT, CODFILIAL, CODEMP) REFERENCES VDKIT (CODKIT, CODFILIAL, CODEMP);
ALTER TABLE VDITORCAMENTO ADD CONSTRAINT VDITORCAMENTOFKEQA FOREIGN KEY (CODALMOX, CODFILIALAX, CODEMPAX) REFERENCES EQALMOX (CODALMOX, CODFILIAL, CODEMP);
ALTER TABLE VDITORCAMENTO ADD CONSTRAINT VDITORCAMENTOFKEQL FOREIGN KEY (CODLOTE, CODPROD, CODFILIALLE, CODEMPLE) REFERENCES EQLOTE (CODLOTE, CODPROD, CODFILIAL, CODEMP);
ALTER TABLE VDITORCAMENTO ADD CONSTRAINT VDITORCAMENTOFKEQP FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);
ALTER TABLE VDITORCAMENTO ADD CONSTRAINT VDITORCAMENTOFKSGL FOREIGN KEY (CODLOG, CODFILIALLG, CODEMPLG) REFERENCES SGLOG (CODLOG, CODFILIAL, CODEMP);
ALTER TABLE VDITORCAMENTO ADD CONSTRAINT VDITORCAMENTOFKVDO FOREIGN KEY (CODORC, TIPOORC, CODFILIAL, CODEMP) REFERENCES VDORCAMENTO (CODORC, TIPOORC, CODFILIAL, CODEMP);
ALTER TABLE VDITORCAMENTO ADD CONSTRAINT VDITORCAMENTOFKVDP FOREIGN KEY (CODPE, CODFILIALPE, CODEMPPE) REFERENCES VDPRAZOENT (CODPE, CODFILIAL, CODEMP);
ALTER TABLE VDITREGRACOMIS ADD CONSTRAINT VDITREGRACOMISFKRE FOREIGN KEY (CODREGRCOMIS, CODFILIAL, CODEMP) REFERENCES VDREGRACOMIS (CODREGRCOMIS, CODFILIAL, CODEMP);
ALTER TABLE VDITREGRACOMIS ADD CONSTRAINT VDITREGRACOMISFKTV FOREIGN KEY (CODTIPOVEND, CODFILIALTV, CODEMPTV) REFERENCES VDTIPOVEND (CODTIPOVEND, CODFILIAL, CODEMP);
ALTER TABLE VDITROMANEIO ADD CONSTRAINT VDITROMANEIOFKVDRO FOREIGN KEY (CODROMA, CODFILIAL, CODEMP) REFERENCES VDROMANEIO (CODROMA, CODFILIAL, CODEMP);
ALTER TABLE VDITROMANEIO ADD CONSTRAINT VDITROMANEIOFKVDVE FOREIGN KEY (CODVENDA, TIPOVENDA, CODFILIALVA, CODEMPVA) REFERENCES VDVENDA (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP);
ALTER TABLE VDITVENDA ADD CONSTRAINT VDITVENDAFKATCONVE FOREIGN KEY (CODCONV, CODFILIALCV, CODEMPCV) REFERENCES ATCONVENIADO (CODCONV, CODFILIAL, CODEMP);
ALTER TABLE VDITVENDA ADD CONSTRAINT VDITVENDAFKEQALMOX FOREIGN KEY (CODALMOX, CODFILIALAX, CODEMPAX) REFERENCES EQALMOX (CODALMOX, CODFILIAL, CODEMP);
ALTER TABLE VDITVENDA ADD CONSTRAINT VDITVENDAFKEQLOTE FOREIGN KEY (CODLOTE, CODPROD, CODFILIALLE, CODEMPLE) REFERENCES EQLOTE (CODLOTE, CODPROD, CODFILIAL, CODEMP);
ALTER TABLE VDITVENDA ADD CONSTRAINT VDITVENDAFKEQPRODU FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);
ALTER TABLE VDITVENDA ADD CONSTRAINT VDITVENDAFKLFMENSA FOREIGN KEY (CODMENS, CODFILIALME, CODEMPME) REFERENCES LFMENSAGEM (CODMENS, CODFILIAL, CODEMP);
ALTER TABLE VDITVENDA ADD CONSTRAINT VDITVENDAFKLFNATOP FOREIGN KEY (CODNAT, CODFILIALNT, CODEMPNT) REFERENCES LFNATOPER (CODNAT, CODFILIAL, CODEMP);
ALTER TABLE VDITVENDA ADD CONSTRAINT VDITVENDAFKLFTRATT FOREIGN KEY (CODTRATTRIB, CODFILIALTT, CODEMPTT) REFERENCES LFTRATTRIB (CODTRATTRIB, CODFILIAL, CODEMP);
ALTER TABLE VDITVENDA ADD CONSTRAINT VDITVENDAFKSGLOG FOREIGN KEY (CODLOG, CODFILIALLG, CODEMPLG) REFERENCES SGLOG (CODLOG, CODFILIAL, CODEMP);
ALTER TABLE VDITVENDA ADD CONSTRAINT VDITVENDAFKVDPRAZO FOREIGN KEY (CODPE, CODFILIALPE, CODEMPPE) REFERENCES VDPRAZOENT (CODPE, CODFILIAL, CODEMP);
ALTER TABLE VDITVENDA ADD CONSTRAINT VDITVENDAFKVDVENDA FOREIGN KEY (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP) REFERENCES VDVENDA (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP);
ALTER TABLE VDKIT ADD CONSTRAINT VDKITFKEQPRODUTO FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);
ALTER TABLE VDOBSCLI ADD CONSTRAINT VDOBSCLIFKVDCLIENT FOREIGN KEY (CODCLI, CODFILIAL, CODEMP) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);
ALTER TABLE VDORCAMENTO ADD CONSTRAINT VDORCAMENTOFKATATE FOREIGN KEY (CODATEND, CODFILIALAE, CODEMPAE) REFERENCES ATATENDENTE (CODATEND, CODFILIAL, CODEMP);
ALTER TABLE VDORCAMENTO ADD CONSTRAINT VDORCAMENTOFKATCON FOREIGN KEY (CODCONV, CODFILIALCV, CODEMPCV) REFERENCES ATCONVENIADO (CODCONV, CODFILIAL, CODEMP);
ALTER TABLE VDORCAMENTO ADD CONSTRAINT VDORCAMENTOFKATTIP FOREIGN KEY (CODTPCONV, CODFILIALTC, CODEMPTC) REFERENCES ATTIPOCONV (CODTPCONV, CODFILIAL, CODEMP);
ALTER TABLE VDORCAMENTO ADD CONSTRAINT VDORCAMENTOFKFNPLA FOREIGN KEY (CODPLANOPAG, CODFILIALPG, CODEMPPG) REFERENCES FNPLANOPAG (CODPLANOPAG, CODFILIAL, CODEMP);
ALTER TABLE VDORCAMENTO ADD CONSTRAINT VDORCAMENTOFKVDCLC FOREIGN KEY (CODCLCOMIS, CODFILIALCM, CODEMPCM) REFERENCES VDCLCOMIS (CODCLCOMIS, CODFILIAL, CODEMP);
ALTER TABLE VDORCAMENTO ADD CONSTRAINT VDORCAMENTOFKVDCLI FOREIGN KEY (CODCLI, CODFILIALCL, CODEMPCL) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);
ALTER TABLE VDORCAMENTO ADD CONSTRAINT VDORCAMENTOFKVDVEN FOREIGN KEY (CODVEND, CODFILIALVD, CODEMPVD) REFERENCES VDVENDEDOR (CODVEND, CODFILIAL, CODEMP);
ALTER TABLE VDPRECOPROD ADD CONSTRAINT VDPRECOPRODFKEQPRO FOREIGN KEY (CODPROD, CODFILIAL, CODEMP) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);
ALTER TABLE VDPRECOPROD ADD CONSTRAINT VDPRECOPRODFKFNPLA FOREIGN KEY (CODPLANOPAG, CODFILIALPG, CODEMPPG) REFERENCES FNPLANOPAG (CODPLANOPAG, CODFILIAL, CODEMP);
ALTER TABLE VDPRECOPROD ADD CONSTRAINT VDPRECOPRODFKVDCLA FOREIGN KEY (CODCLASCLI, CODFILIALCC, CODEMPCC) REFERENCES VDCLASCLI (CODCLASCLI, CODFILIAL, CODEMP);
ALTER TABLE VDPRECOPROD ADD CONSTRAINT VDPRECOPRODFKVDTAB FOREIGN KEY (CODTAB, CODFILIALTB, CODEMPTB) REFERENCES VDTABPRECO (CODTAB, CODFILIAL, CODEMP);
ALTER TABLE VDROMANEIO ADD CONSTRAINT VDROMANEIOFKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE VDSETOR ADD CONSTRAINT VDSETORFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE VDSTATUSORC ADD CONSTRAINT VDSTATUSORCFKSGITT FOREIGN KEY (CODITTB, CODTB, CODFILIALTB, CODEMPTB) REFERENCES SGITTABELA (CODITTB, CODTB, CODFILIAL, CODEMP);
ALTER TABLE VDSTATUSORC ADD CONSTRAINT VDSTATUSORCFKVDORC FOREIGN KEY (CODORC, TIPOORC, CODFILIAL, CODEMP) REFERENCES VDORCAMENTO (CODORC, TIPOORC, CODFILIAL, CODEMP);
ALTER TABLE VDTABPRECO ADD CONSTRAINT VDTABPRECOFKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE VDTEF ADD CONSTRAINT VDTEFFKVDVENDA FOREIGN KEY (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP) REFERENCES VDVENDA (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP);
ALTER TABLE VDTIPOCLI ADD CONSTRAINT VDTIPOCLIFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE VDTRANSP ADD CONSTRAINT VDTRANSPFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE VDTRANSP ADD CONSTRAINT VDTRANSPFKSGMUNIC FOREIGN KEY (CODMUNIC, SIGLAUF, CODPAIS) REFERENCES SGMUNICIPIO (CODMUNIC, SIGLAUF, CODPAIS);
ALTER TABLE VDVENDA ADD CONSTRAINT VDVENDAFKCARTCOB FOREIGN KEY (CODCARTCOB, CODFILIALCB, CODEMPCB, CODBANCO, CODFILIALBO, CODEMPBO) REFERENCES FNCARTCOB (CODCARTCOB, CODFILIAL, CODEMP, CODBANCO, CODFILIALBO, CODEMPBO);
ALTER TABLE VDVENDA ADD CONSTRAINT VDVENDAFKEQTIPOMOV FOREIGN KEY (CODTIPOMOV, CODFILIALTM, CODEMPTM) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);
ALTER TABLE VDVENDA ADD CONSTRAINT VDVENDAFKFNBANCO FOREIGN KEY (CODBANCO, CODFILIALBO, CODEMPBO) REFERENCES FNBANCO (CODBANCO, CODFILIAL, CODEMP);
ALTER TABLE VDVENDA ADD CONSTRAINT VDVENDAFKFNPLANOPA FOREIGN KEY (CODPLANOPAG, CODFILIALPG, CODEMPPG) REFERENCES FNPLANOPAG (CODPLANOPAG, CODFILIAL, CODEMP);
ALTER TABLE VDVENDA ADD CONSTRAINT VDVENDAFKFNTIPOCOB FOREIGN KEY (CODTIPOCOB, CODFILIALTC, CODEMPTC) REFERENCES FNTIPOCOB (CODTIPOCOB, CODFILIAL, CODEMP);
ALTER TABLE VDVENDA ADD CONSTRAINT VDVENDAFKLFSERIE FOREIGN KEY (SERIE, CODFILIALSE, CODEMPSE) REFERENCES LFSERIE (SERIE, CODFILIAL, CODEMP);
ALTER TABLE VDVENDA ADD CONSTRAINT VDVENDAFKPVCAIXA FOREIGN KEY (CODCAIXA, CODFILIALCX, CODEMPCX) REFERENCES PVCAIXA (CODCAIXA, CODFILIAL, CODEMP);
ALTER TABLE VDVENDA ADD CONSTRAINT VDVENDAFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE VDVENDA ADD CONSTRAINT VDVENDAFKVDCLCOMIS FOREIGN KEY (CODCLCOMIS, CODFILIALCM, CODEMPCM) REFERENCES VDCLCOMIS (CODCLCOMIS, CODFILIAL, CODEMP);
ALTER TABLE VDVENDA ADD CONSTRAINT VDVENDAFKVDCLIENTE FOREIGN KEY (CODCLI, CODFILIALCL, CODEMPCL) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);
ALTER TABLE VDVENDA ADD CONSTRAINT VDVENDAFKVDVENDEDO FOREIGN KEY (CODVEND, CODFILIALVD, CODEMPVD) REFERENCES VDVENDEDOR (CODVEND, CODFILIAL, CODEMP);
ALTER TABLE VDVENDACOMIS ADD CONSTRAINT VDVENDACOMISFKVDIT FOREIGN KEY (CODREGRCOMIS, SEQITRC, CODFILIALRC, CODEMPRC) REFERENCES VDITREGRACOMIS (CODREGRCOMIS, SEQITRC, CODFILIAL, CODEMP);
ALTER TABLE VDVENDACOMIS ADD CONSTRAINT VDVENDACOMISFKVEDA FOREIGN KEY (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP) REFERENCES VDVENDA (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP);
ALTER TABLE VDVENDACOMIS ADD CONSTRAINT VDVENDACOMISFKVEDO FOREIGN KEY (CODVEND, CODFILIALVD, CODEMPVD) REFERENCES VDVENDEDOR (CODVEND, CODFILIAL, CODEMP);
ALTER TABLE VDVENDAORC ADD CONSTRAINT VDVENDAORCFKVDITVE FOREIGN KEY (CODVENDA, CODITVENDA, TIPOVENDA, CODFILIAL, CODEMP) REFERENCES VDITVENDA (CODVENDA, CODITVENDA, TIPOVENDA, CODFILIAL, CODEMP);
ALTER TABLE VDVENDAORC ADD CONSTRAINT VDVENDAORCFKVDORCA FOREIGN KEY (CODORC, CODITORC, TIPOORC, CODFILIALOR, CODEMPOR) REFERENCES VDITORCAMENTO (CODORC, CODITORC, TIPOORC, CODFILIAL, CODEMP);
ALTER TABLE VDVENDEDOR ADD CONSTRAINT VDVENDEDORFKFNPLAN FOREIGN KEY (CODPLAN, CODFILIALPN, CODEMPPN) REFERENCES FNPLANEJAMENTO (CODPLAN, CODFILIAL, CODEMP);
ALTER TABLE VDVENDEDOR ADD CONSTRAINT VDVENDEDORFKRHFUNC FOREIGN KEY (CODFUNC, CODFILIALFU, CODEMPFU) REFERENCES RHFUNCAO (CODFUNC, CODFILIAL, CODEMP);
ALTER TABLE VDVENDEDOR ADD CONSTRAINT VDVENDEDORFKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);
ALTER TABLE VDVENDEDOR ADD CONSTRAINT VDVENDEDORFKVDCLCO FOREIGN KEY (CODCLCOMIS, CODFILIALCM, CODEMPCM) REFERENCES VDCLCOMIS (CODCLCOMIS, CODFILIAL, CODEMP);
ALTER TABLE VDVENDEDOR ADD CONSTRAINT VDVENDEDORFKVDSETO FOREIGN KEY (CODSETOR, CODFILIALSE, CODEMPSE) REFERENCES VDSETOR (CODSETOR, CODFILIAL, CODEMP);
ALTER TABLE VDVENDEDOR ADD CONSTRAINT VDVENDEDORFKVDTIPO FOREIGN KEY (CODTIPOVEND, CODFILIALTV, CODEMPTV) REFERENCES VDTIPOVEND (CODTIPOVEND, CODFILIAL, CODEMP);


/******************************************************************************/
/*                                  Indices                                   */
/******************************************************************************/

CREATE INDEX ATCONVENIADOIDX01 ON ATCONVENIADO (ICARDCONV, NRVIACONV);
CREATE INDEX CPFORNECEDIDX01 ON CPFORNECED (RAZFOR);
CREATE INDEX CPPRODFORIDX01 ON CPPRODFOR (REFPRODFOR, CODFILIAL, CODEMP);
CREATE INDEX CPTIPOFORICX01 ON CPTIPOFOR (DESCTIPOFOR);
CREATE INDEX EQETIQPRODIDX01 ON EQETIQPROD (NRCONEXAO, CODPROD);
CREATE INDEX EQMOVPRODIDX01 ON EQMOVPROD (CODLOTE, CODPROD);
CREATE UNIQUE INDEX EQPRODUTOIDX01 ON EQPRODUTO (REFPROD, CODEMP, CODFILIAL);
CREATE INDEX EQPRODUTOIDX02 ON EQPRODUTO (DESCPROD);
CREATE INDEX EQUNIDADEIDX01 ON EQUNIDADE (DESCUNID);
CREATE INDEX FNBANCOIDX01 ON FNBANCO (NOMEBANCO);
CREATE INDEX FNCCIDX01 ON FNCC (DESCCC);
CREATE INDEX FNCCIDX02 ON FNCC (CODREDCC, CODEMP, CODFILIAL);
CREATE INDEX FNLANCADATA ON FNLANCA (DATALANCA, CODREC);
CREATE INDEX FNLANCAIDX01 ON FNLANCA (DATALANCA, CODFILIAL, CODEMP);
CREATE INDEX FNPLANEJAMENTOIDX01 ON FNPLANEJAMENTO (DESCPLAN);
CREATE INDEX FNPLANOPAGIDX01 ON FNPLANOPAG (DESCPLANOPAG);
CREATE INDEX FNRECEBERDATAREC ON FNRECEBER (DATAREC);
CREATE INDEX FNSUBLANCAIDX01 ON FNSUBLANCA (DATASUBLANCA, CODSUBLANCA, CODLANCA, CODFILIAL, CODEMP);
CREATE INDEX FNTIPOCOBIDX01 ON FNTIPOCOB (DESCTIPOCOB);
CREATE INDEX PPOPDTEMITOP ON PPOP (DTEMITOP);
CREATE INDEX PPOPDTFABROP ON PPOP (DTFABROP);
CREATE INDEX RHEMPREGADORIDX01 ON RHEMPREGADOR (NOMEEMPR);
CREATE INDEX SGLOGIDX01 ON SGLOG (DATALOG);
CREATE INDEX SGLOGIDX02 ON SGLOG (TIPOLOG);
CREATE INDEX SGMUNICIPIOIDXNOME ON SGMUNICIPIO (NOMEMUNIC);
CREATE UNIQUE INDEX TKCONFEMAILIDX1 ON TKCONFEMAIL (EMAILREMET);
CREATE INDEX VDCLIENTEIDX01 ON VDCLIENTE (NOMECLI);
CREATE INDEX VDCLIENTEIDX02 ON VDCLIENTE (RAZCLI);
CREATE INDEX VDCOMISSAOIDX01 ON VDCOMISSAO (CODREC, NPARCITREC);
CREATE INDEX VDETIQCLIIDX01 ON VDETIQCLI (CODCLI, NRCONEXAO);
CREATE INDEX VDITORCAMENTOIDXSTITORC ON VDITORCAMENTO (STATUSITORC);
CREATE INDEX VDITORCAMENTOVENCAUT ON VDITORCAMENTO (VENCAUTORIZORC);
CREATE INDEX VDORCAMENTOIDXSTORC ON VDORCAMENTO (STATUSORC);
CREATE INDEX VDSETORIDX01 ON VDSETOR (DESCSETOR);
CREATE INDEX VDTIPOCLIIDX01 ON VDTIPOCLI (DESCTIPOCLI);
CREATE INDEX VDTRANSPIDX01 ON VDTRANSP (RAZTRAN);
CREATE INDEX VDVENDAIDX01 ON VDVENDA (DTEMITVENDA);
CREATE INDEX VDVENDAIDX02 ON VDVENDA (DTSAIDAVENDA);
CREATE INDEX VDVENDEDORIDX01 ON VDVENDEDOR (NOMEVEND);


/******************************************************************************/
/*                                  Triggers                                  */
/******************************************************************************/


SET TERM ^ ;



/******************************************************************************/
/*                            Triggers for tables                             */
/******************************************************************************/



/* Trigger: ATAGENDATGBU */
CREATE TRIGGER ATAGENDATGBU FOR ATAGENDA
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: ATATENDENTETGBU */
CREATE TRIGGER ATATENDENTETGBU FOR ATATENDENTE
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: ATATENDIMENTOORCTGBU */
CREATE TRIGGER ATATENDIMENTOORCTGBU FOR ATATENDIMENTOORC
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: ATATENDIMENTOTGBI */
CREATE TRIGGER ATATENDIMENTOTGBI FOR ATATENDIMENTO
ACTIVE BEFORE INSERT POSITION 0
AS
declare variable icodempcl integer;
declare variable icodfilialcl smallint;
declare variable icodcli integer;
begin
    if (new.codatend is not null) then
    begin
        select co.codempcl,co.codfilialcl,co.codcli
            from atconveniado co
            where co.codemp=new.codempcv and co.codfilial=new.codfilialcv and co.codconv=new.codconv
        into :icodempcl, :icodfilialcl, :icodcli;

        if(:icodcli is not null) then
        begin
           new.codempcl=:icodempcl;
           new.codfilialcl=:icodfilialcl;
           new.codcli=:icodcli;
        end
    end
end
^

/* Trigger: ATATENDIMENTTGBU */
CREATE TRIGGER ATATENDIMENTTGBU FOR ATATENDIMENTO
ACTIVE BEFORE UPDATE POSITION 0
as
begin
   new.DTALT=cast('now' AS DATE );
   new.IDUSUALT=USER;
   new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: ATATRIBUICAOTGBU */
CREATE TRIGGER ATATRIBUICAOTGBU FOR ATATRIBUICAO
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: ATCONVATRIBTBTGBU */
CREATE TRIGGER ATCONVATRIBTBTGBU FOR ATCONVATRIBTB
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: ATCONVATRIBTGBU */
CREATE TRIGGER ATCONVATRIBTGBU FOR ATCONVATRIB
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: ATCONVENIADOTGAI */
CREATE TRIGGER ATCONVENIADOTGAI FOR ATCONVENIADO
ACTIVE AFTER INSERT POSITION 0
as
declare variable ICODATEND INTEGER;
declare variable ICODATENDO INTEGER;
declare variable ICODSETOR INTEGER;
DECLARE VARIABLE IFILIALATEND INTEGER;
DECLARE VARIABLE IFILIALPREF INTEGER;
DECLARE VARIABLE IFILIALUSU INTEGER;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'ATATENDENTE') INTO IFILIALATEND;
  SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'SGPREFERE2') INTO IFILIALPREF;
  SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'SGUSUARIO') INTO IFILIALUSU;
  SELECT CODATEND FROM ATATENDENTE
    WHERE CODEMP=new.CODEMP AND CODFILIAL=:IFILIALATEND
    AND IDUSU=LOWER(USER) AND CODEMPUS=new.CODEMP AND CODFILIALUS=:IFILIALUSU
    INTO ICODATEND;
  SELECT CODSETAT,CODTPATENDO2 FROM SGPREFERE2
    WHERE CODEMP=new.CODEMP AND CODFILIAL=:IFILIALPREF
    INTO ICODSETOR,ICODATENDO;
  EXECUTE PROCEDURE ATADICATENDIMENTOSP(
    new.CODCONV,:ICODATENDO,:ICODATEND,
    ICODSETOR,NULL,new.CODEMP,:IFILIALUSU,new.CODCONV
  );
end
^

/* Trigger: ATCONVENIADOTGBI */
CREATE TRIGGER ATCONVENIADOTGBI FOR ATCONVENIADO
ACTIVE BEFORE INSERT POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  /* Trigger Text */
end
^

/* Trigger: ATCONVENIADOTGBU */
CREATE TRIGGER ATCONVENIADOTGBU FOR ATCONVENIADO
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: ATENCAMINHADORTGBU */
CREATE TRIGGER ATENCAMINHADORTGBU FOR ATENCAMINHADOR
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: ATSETORATENDENTETGBU */
CREATE TRIGGER ATSETORATENDENTETGBU FOR ATSETORATENDENTE
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: ATSETORTGBU */
CREATE TRIGGER ATSETORTGBU FOR ATSETOR
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: ATTIPOATENDOSETORTGBU */
CREATE TRIGGER ATTIPOATENDOSETORTGBU FOR ATTIPOATENDOSETOR
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: ATTIPOATENDOTGBU */
CREATE TRIGGER ATTIPOATENDOTGBU FOR ATTIPOATENDO
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: ATTIPOATENDTGBU */
CREATE TRIGGER ATTIPOATENDTGBU FOR ATTIPOATEND
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: ATTIPOCONVTGBU */
CREATE TRIGGER ATTIPOCONVTGBU FOR ATTIPOCONV
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: CPCOMPRATGAU */
CREATE TRIGGER CPCOMPRATGAU FOR CPCOMPRA
ACTIVE AFTER UPDATE POSITION 0
AS
  DECLARE VARIABLE iCodPag INTEGER;
  DECLARE VARIABLE dVLR NUMERIC(15, 5);
  DECLARE VARIABLE IFILIALPAG INTEGER;
  DECLARE VARIABLE TIPOMOV CHAR(2);        
  DECLARE VARIABLE ICODITEM SMALLINT;
  DECLARE VARIABLE VLRITEM NUMERIC(15, 5);  
  DECLARE VARIABLE QTDITEM NUMERIC(15, 5);
  DECLARE VARIABLE PERCITFRETE NUMERIC(15, 5);
  DECLARE VARIABLE VLRITFRETE NUMERIC(15, 5);
BEGIN
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT IS NOT NULL) )) ) THEN
  BEGIN
      SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'FNPAGAR') INTO IFILIALPAG;
      SELECT CODPAG FROM FNPAGAR WHERE CODCOMPRA=new.CODCOMPRA
             AND CODEMP=new.CODEMP AND CODFILIAL = :IFILIALPAG INTO iCodPag;
      SELECT TIPOMOV FROM EQTIPOMOV WHERE CODTIPOMOV=new.CODTIPOMOV
             AND CODEMP=new.CODEMPTM AND CODFILIAL=new.CODFILIALTM INTO TIPOMOV;
      IF ((NOT TIPOMOV IN ('DV','TR')) AND (
         (iCodPag IS NULL) OR (
         (new.CODPLANOPAG != old.CODPLANOPAG) OR
         (new.CODFOR != old.CODFOR) OR
         (new.VLRLIQCOMPRA != old.VLRLIQCOMPRA) OR
         (new.DTENTCOMPRA != old.DTENTCOMPRA) OR
         (new.DOCCOMPRA != old.DOCCOMPRA) OR
         (new.CODBANCO != old.CODBANCO)))) THEN
      BEGIN
        dVLR = new.VLRLIQCOMPRA;
        IF ((new.STATUSCOMPRA IN ('P2','C2')) AND (old.STATUSCOMPRA IN ('P1','C1'))) THEN
        BEGIN
          DELETE FROM FNPAGAR WHERE CODCOMPRA=old.CODCOMPRA AND CODEMP=old.CODEMP AND CODFILIAL=:IFILIALPAG;
          IF (dVlr > 0) THEN
            EXECUTE PROCEDURE FNADICPAGARSP01(new.CODCOMPRA,new.CODEMPPG,new.CODFILIALPG,new.CODPLANOPAG,new.CODEMPFR,new.CODFILIALFR,new.CODFOR,:dVLR,new.DTENTCOMPRA,new.DOCCOMPRA,new.CODEMPBO,new.CODFILIALBO,new.CODBANCO,new.FLAG,new.CODEMP,new.CODFILIAL);
        END
        ELSE IF ((new.STATUSCOMPRA IN ('P2','C2')) AND (old.STATUSCOMPRA IN ('P2','C2'))) THEN
        BEGIN
          DELETE FROM FNPAGAR WHERE CODCOMPRA=old.CODCOMPRA AND CODEMP=old.CODEMP AND CODFILIAL = old.CODFILIAL;
          IF (dVlr > 0) THEN
            EXECUTE PROCEDURE FNADICPAGARSP01(new.CODCOMPRA,new.CODEMPPG,new.CODFILIALPG,new.CODPLANOPAG,new.CODEMPFR,new.CODFILIALFR,new.CODFOR,:dVLR,new.DTENTCOMPRA,new.DOCCOMPRA,new.CODEMPBO,new.CODFILIALBO,new.CODBANCO,new.FLAG,new.CODEMP,new.CODFILIAL);
        END
        ELSE IF ((new.STATUSCOMPRA IN ('P3','C3')) AND (old.STATUSCOMPRA IN ('P3','C3'))) THEN
        BEGIN
          DELETE FROM FNPAGAR WHERE CODCOMPRA=old.CODCOMPRA AND CODEMP=old.CODEMP AND CODFILIAL = :IFILIALPAG;
          IF (dVlr > 0) THEN
            EXECUTE PROCEDURE FNADICPAGARSP01(new.CODCOMPRA,new.CODEMPPG,new.CODFILIALPG,new.CODPLANOPAG,new.CODEMPFR,new.CODFILIALFR,new.CODFOR,:dVLR,new.DTENTCOMPRA,new.DOCCOMPRA,new.CODEMPBO,new.CODFILIALBO,new.CODBANCO,new.FLAG,new.CODEMP,new.CODFILIAL);
        END
      END
    /**
     Movimento do estoque
    **/
    /* Avisa os itens que a data de saida foi alterada */
      IF ( (new.DTENTCOMPRA != old.DTENTCOMPRA) OR
           (new.DOCCOMPRA != old.DOCCOMPRA) OR
           (new.CODTIPOMOV != old.CODTIPOMOV) )  THEN
        UPDATE CPITCOMPRA SET CODITCOMPRA=CODITCOMPRA WHERE
             CODCOMPRA = old.CODCOMPRA AND CODEMP=old.CODEMP AND CODFILIAL=old.CODFILIAL;

      IF ( (new.VLRFRETECOMPRA > 0) AND ( NOT new.VLRFRETECOMPRA = old.VLRFRETECOMPRA)  ) THEN
      BEGIN
          FOR SELECT IT.CODITCOMPRA, IT.VLRLIQITCOMPRA, IT.QTDITCOMPRA FROM CPITCOMPRA IT
              WHERE IT.CODEMP=new.CODEMP AND IT.CODFILIAL=new.CODFILIAL AND IT.CODCOMPRA=new.CODCOMPRA
              INTO :ICODITEM, :VLRITEM, :QTDITEM
              DO
              BEGIN
                  PERCITFRETE = :VLRITEM / (new.VLRLIQCOMPRA / 100);
                  VLRITFRETE =  (:PERCITFRETE * (new.VLRFRETECOMPRA / 100)) / COALESCE(:QTDITEM, 1);
                  UPDATE CPITCOMPRA CIT SET VLRFRETEITCOMPRA=:VLRITFRETE
                      WHERE CIT.CODEMP=new.CODEMP AND CIT.CODFILIAL=new.CODFILIAL
                      AND CIT.CODCOMPRA=new.CODCOMPRA AND CIT.CODITCOMPRA=:ICODITEM;
              END
        END
          IF ((substr(new.STATUSCOMPRA,1,1)='X') AND (substr(old.STATUSCOMPRA,1,1) IN ('P','C'))) THEN
          BEGIN
              UPDATE CPITCOMPRA SET QTDITCOMPRA=0 WHERE CODCOMPRA=new.CODCOMPRA AND CODEMP=new.CODEMP
              AND CODFILIAL=new.CODFILIAL;
              DELETE FROM FNPAGAR WHERE CODCOMPRA=new.CODCOMPRA AND CODEMP=new.CODEMP
              AND CODFILIAL=new.CODFILIAL;
          END
    END
END
^

/* Trigger: CPCOMPRATGBD */
CREATE TRIGGER CPCOMPRATGBD FOR CPCOMPRA
ACTIVE BEFORE DELETE POSITION 0
AS
begin
  /* Trigger text */
  if ( old.BLOQCOMPRA IS NOT NULL AND old.BLOQCOMPRA='S'  ) then
      EXCEPTION CPCOMPRAEX04 'ESTA COMPRA ESTÁ BLOQUEADA!!!';
end
^

/* Trigger: CPCOMPRATGBI */
CREATE TRIGGER CPCOMPRATGBI FOR CPCOMPRA
ACTIVE BEFORE INSERT POSITION 0
AS
  DECLARE VARIABLE IFILIALTIPOMOV INTEGER;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'EQTIPOMOV') INTO IFILIALTIPOMOV;
  SELECT T.FISCALTIPOMOV FROM EQTIPOMOV T WHERE T.CODTIPOMOV=new.CODTIPOMOV
         AND T.CODEMP=new.CODEMP AND T.CODFILIAL=:IFILIALTIPOMOV INTO new.FLAG;
  IF ( new.FLAG <> 'S') THEN
  BEGIN
    new.FLAG = 'N';
  END
  new.STATUSCOMPRA = 'P1';
  IF (new.VLRPRODCOMPRA IS NULL) THEN new.VLRPRODCOMPRA = 0;
  IF (new.VLRDESCCOMPRA IS NULL) THEN new.VLRDESCCOMPRA = 0;
  IF (new.VLRDESCITCOMPRA IS NULL) THEN new.VLRDESCITCOMPRA = 0;
  IF (new.VLRCOMPRA IS NULL) THEN new.VLRCOMPRA = 0;
  IF (new.VLRBASEICMSCOMPRA IS NULL) THEN new.VLRBASEICMSCOMPRA = 0;
  IF (new.VLRICMSCOMPRA IS NULL) THEN new.VLRICMSCOMPRA = 0;
  IF (new.VLRISENTASCOMPRA IS NULL) THEN new.VLRISENTASCOMPRA = 0;
  IF (new.VLROUTRASCOMPRA IS NULL) THEN new.VLROUTRASCOMPRA = 0;
  IF (new.VLRBASEIPICOMPRA IS NULL) THEN new.VLRBASEIPICOMPRA = 0;
  IF (new.VLRIPICOMPRA IS NULL) THEN new.VLRIPICOMPRA = 0;
  IF (new.VLRLIQCOMPRA IS NULL) THEN new.VLRLIQCOMPRA = 0;
  IF (new.VLRFRETECOMPRA IS NULL) THEN new.VLRFRETECOMPRA = 0;
  IF (new.VLRADICCOMPRA IS NULL) THEN new.VLRADICCOMPRA = 0;
END
^

/* Trigger: CPCOMPRATGBU */
CREATE TRIGGER CPCOMPRATGBU FOR CPCOMPRA
ACTIVE BEFORE UPDATE POSITION 0
AS
  DECLARE VARIABLE dVlrPagar NUMERIC(15, 5);
  DECLARE VARIABLE sStatusPag CHAR(2);
  DECLARE VARIABLE IFILIALTIPOMOV INTEGER;
  DECLARE VARIABLE IFILIALPAG INTEGER;
  DECLARE VARIABLE CSEQNFTIPOMOV CHAR(1);
BEGIN
  IF (new.EMMANUT IS NULL) THEN
     new.EMMANUT='N';
  if (new.BLOQCOMPRA IS NULL) then
     new.BLOQCOMPRA='N';
  if ( ( (old.BLOQCOMPRA IS  NULL) OR (old.BLOQCOMPRA='N') ) AND (new.BLOQCOMPRA='S') )  then
  begin
      new.DTALT=cast('now' AS DATE);
      new.IDUSUALT=user;
      new.HALT=cast('now' AS TIME);
  end
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
  BEGIN
      if ( (old.BLOQCOMPRA IS NOT NULL AND old.BLOQCOMPRA='S') or (new.BLOQCOMPRA='S') ) then
         EXCEPTION CPCOMPRAEX04 'ESTA COMPRA ESTÁ BLOQUEADA!!!';
      new.DTALT=cast('now' AS DATE);
      new.IDUSUALT=USER;
      new.HALT = cast('now' AS TIME);
      SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'EQTIPOMOV') INTO IFILIALTIPOMOV;
      SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'FNPAGAR') INTO IFILIALPAG;
      SELECT T.FISCALTIPOMOV, T.SEQNFTIPOMOV FROM EQTIPOMOV T WHERE T.CODTIPOMOV=new.CODTIPOMOV
             AND T.CODEMP=new.CODEMP AND T.CODFILIAL = :IFILIALTIPOMOV INTO new.FLAG, :CSEQNFTIPOMOV;
      IF (old.IMPNOTACOMPRA IS NULL) THEN
         new.IMPNOTACOMPRA = 'N';
      IF ( (CSEQNFTIPOMOV IS NOT NULL) AND (CSEQNFTIPOMOV='S') ) THEN
      BEGIN
         IF  (new.IMPNOTACOMPRA='N') THEN
         BEGIN
            SELECT DOC FROM LFNOVODOCSP(new.Serie,new.CODEMP,new.CODFILIAL) INTO new.DocCompra;
            new.IMPNOTACOMPRA = 'S';
         END
         ELSE IF (old.DOCCOMPRA != new.DOCCOMPRA) THEN
         BEGIN
            new.DOCCOMPRA = old.DOCCOMPRA;
         END
      END

      IF ( new.FLAG <> 'S') THEN
      BEGIN
        new.FLAG = 'N';
      END
      IF (new.VLRDESCCOMPRA IS NULL) THEN
        new.VLRDESCCOMPRA = 0;
      IF (new.VLRADICCOMPRA IS NULL) THEN
        new.VLRADICCOMPRA = 0;
      IF (new.VLRFRETECOMPRA IS NULL) THEN
        new.VLRFRETECOMPRA = 0;
      IF (old.STATUSCOMPRA = 'P1')  THEN
      BEGIN
        IF (new.STATUSCOMPRA = 'C1') THEN
        BEGIN
          new.STATUSCOMPRA = 'C2';
        END
      END
      ELSE IF ((old.STATUSCOMPRA IN ('P4','C4')) AND (new.STATUSCOMPRA IN ('P4','C4'))) THEN
      BEGIN
        EXCEPTION CPCOMPRAEX03;
      END
      ELSE IF ((old.STATUSCOMPRA IN ('P2','C2')) AND (new.STATUSCOMPRA IN ('P3','C3'))) THEN
      BEGIN
        SELECT STATUSPAG,VLRPARCPAG FROM FNPAGAR WHERE CODCOMPRA=new.CODCOMPRA
             AND CODEMP=new.CODEMP AND CODFILIAL = :IFILIALPAG INTO :sStatusPag,:dVlrPagar;
        IF ((sStatusPag = 'PD') AND (new.VLRLIQCOMPRA != :dVlrPagar)) THEN
          EXCEPTION CPCOMPRAEX04;
      END
       IF ((substr(old.STATUSCOMPRA,1,1) IN ('P','C')) AND (substr(new.STATUSCOMPRA,1,1)='X')) THEN
      BEGIN
           new.vlrdescitcompra = 0;
           new.vlrprodcompra = 0;
           new.vlrbaseicmscompra = 0;
           new.vlricmscompra = 0;
           new.vlrisentascompra = 0;
           new.vlroutrascompra = 0;
           new.vlrbaseipicompra = 0;
           new.vlripicompra = 0;
           new.vlrliqcompra = 0;
           new.vlripicompra = 0;
      END
  END
END
^

/* Trigger: CPCOTACAOSTSOL */
CREATE TRIGGER CPCOTACAOSTSOL FOR CPCOTACAO
ACTIVE AFTER INSERT OR UPDATE OR DELETE POSITION 1
AS
DECLARE VARIABLE NUMITENS INTEGER;
DECLARE VARIABLE NUMITENSAF INTEGER;
DECLARE VARIABLE NUMITENSAP INTEGER;
DECLARE VARIABLE NUMITENSNA INTEGER;
DECLARE VARIABLE NUMITENSAT INTEGER;
DECLARE VARIABLE NUMITENSEF INTEGER;
DECLARE VARIABLE NUMITENSCA INTEGER;
begin
  if (old.sititsol!='AF') then
  begin
      select count(1) from cpcotacao where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and coditsol = new.coditsol into :numitens;
      select count(1) from cpcotacao where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and coditsol = new.coditsol and sitcompitsol='EF' into :numitensef;
      select count(1) from cpcotacao where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and coditsol = new.coditsol and new.sititsol='CA' into :numitensca;
      if (:numitens=:numitensef) then
      begin
        update cpitsolicitacao set sititsol='EF' where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and coditsol = new.coditsol and sititsol!='EF';
      end
      else if (:numitens=:numitensca) then
      begin
        update cpitsolicitacao set sititsol='CA' where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and coditsol = new.coditsol and sititsol!='CA';
      end
      if (new.qtdaprovcot!=old.qtdaprovcot) then
      begin
          if (new.qtdaprovcot>0) then
          begin
              update cpitsolicitacao set sititsol='EA' where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and coditsol = new.coditsol and sititsol='PE';
              select count(1) from cpcotacao where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and coditsol = new.coditsol and sitaprovitsol='AP' into :numitensap;
              select count(1) from cpcotacao where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and coditsol = new.coditsol and sitaprovitsol='NA' into :numitensna;
              select count(1) from cpcotacao where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and coditsol = new.coditsol and sitaprovitsol='AT' into :numitensat;
              if(:numitens!=:numitensaf) then
              begin
                if(:numitens=:numitensat) then
                begin
                   update cpitsolicitacao set sitcompitsol='CT' where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and coditsol = new.coditsol and sitcompitsol!='CT';
                end
                else if((:numitensap>0) or (:numitensna>0)) then
                begin
                   update cpitsolicitacao set sitcompitsol='CP' where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and coditsol = new.coditsol and sitcompitsol!='CP';
                end
                if(:numitens=:numitensna) then
                begin
                   update cpitsolicitacao set sitcompitsol='NA' where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and coditsol = new.coditsol and sitcompitsol!='NA';
                end
              end
          end
      end
  end
  else if (old.sititsol!='EF') then
  begin
      select count(1) from cpcotacao where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and coditsol = new.coditsol into :numitens;
      select count(1) from cpcotacao where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and coditsol = new.coditsol and sititsol='EF' into :numitensef;
      if (:numitens=:numitensef) then
      begin
        update cpitsolicitacao set sititsol='EF' where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and coditsol = new.coditsol and sititsol!='EF';
      end
  end
  SELECT sititsol FROM cpitsolicitacao
      WHERE CODEMP=new.codemp AND CODFILIAL=new.codfilial and coditsol=new.coditsol and codsol=new.codsol
      INTO new.sititsol;
end
^

/* Trigger: CPCOTACAOTGBD */
CREATE TRIGGER CPCOTACAOTGBD FOR CPCOTACAO
ACTIVE BEFORE DELETE POSITION 0
AS
declare variable sUsuarioCN char(8);
declare variable sUsuarioRM char(8);
begin

   if(old.sititsol<>'PE') then
   begin
      exception eqitrma01;
   end

   select idusus from sgretinfousu(USER) into :sUsuarioCN;
   select rm.idusucot from cpcotacao rm where rm.codemp=old.codemp and rm.codfilial=old.codfilial and rm.codsol=old.codsol into :sUsuarioRM;
   if(:sUsuarioCN<>:sUsuarioRM)then
   begin
      exception eqitrma02;
   end
end
^

/* Trigger: CPCOTACAOTGBI */
CREATE TRIGGER CPCOTACAOTGBI FOR CPCOTACAO
ACTIVE BEFORE INSERT POSITION 0
AS
begin
  SELECT sititsol FROM cpitsolicitacao
      WHERE CODEMP=new.codemp AND CODFILIAL=new.codfilial and coditsol=new.coditsol and codsol=new.codsol
      INTO new.sititsol;
end
^

/* Trigger: CPCOTACAOTGBU */
CREATE TRIGGER CPCOTACAOTGBU FOR CPCOTACAO
ACTIVE BEFORE UPDATE POSITION 0
AS
     declare variable sRefProd Char(13);
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: CPCOTTGBIBU */
CREATE TRIGGER CPCOTTGBIBU FOR CPCOTACAO
ACTIVE BEFORE INSERT OR UPDATE POSITION 8
AS
  declare variable statusitem char(2);
begin
  if (old.sititsol!='AF') then
  begin
      if (new.qtdaprovcot!=old.qtdaprovcot or (NEW.sitaprovitsol='AT') ) then
      begin
          if ((new.sitaprovitsol='AT') and (new.qtdaprovcot=0) and (old.sitaprovitsol!='AT')) then
          begin
            new.qtdaprovcot=new.qtdcot;
          end
          if (new.qtdaprovcot>0) then
          begin
            if (new.qtdaprovcot<new.qtdcot) then
            begin
                statusitem = 'AP';
            end
            else
            begin
                statusitem = 'AT';
            end
          new.sitaprovitsol=:statusitem;
          if(new.sititsol='PE') then
          begin
              new.sititsol='EA';
          end
        end
      end
  end
  if(new.sititsol='CA') then
  begin
    new.qtdaprovcot=0;
    new.sitaprovitsol='NA';
  end

end
^

/* Trigger: CPEQUIVCFOPTGBU */
CREATE TRIGGER CPEQUIVCFOPTGBU FOR CPEQUIVCFOP
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: CPFORNECEDTGBI */
CREATE TRIGGER CPFORNECEDTGBI FOR CPFORNECED
ACTIVE BEFORE INSERT POSITION 0
AS
    declare variable nomemunicfor CHAR(30);
begin

    /*Atualização do campo cidade e estado (temporário para retro-compatibilidade)*/

    if(new.codmunic is not null) then
    begin
        select substr(mun.nomemunic,1,30) from sgmunicipio mun
            where mun.codpais=new.codpais and mun.siglauf=new.siglauf and mun.codmunic=new.codmunic
                into :nomemunicfor;
        if (nomemunicfor is not null) then new.cidfor = nomemunicfor;
    end

    if(new.siglauf is not null) then
    begin
        new.uffor=new.siglauf;
    end

    /* Fim da atualização do campo cidade e estado*/

end
^

/* Trigger: CPFORNECEDTGBU */
CREATE TRIGGER CPFORNECEDTGBU FOR CPFORNECED
ACTIVE BEFORE UPDATE POSITION 0
as
  declare variable nomemunicfor CHAR(30);
begin
    new.DTALT=cast('now' AS DATE);
    new.IDUSUALT=USER;
    new.HALT = cast('now' AS TIME);

    /*Atualização do campo cidade e estado (temporário para retro-compatibilidade)*/

    if(old.codmunic != new.codmunic) then
    begin
        select substr(mun.nomemunic,1,30) from sgmunicipio mun
            where mun.codpais=new.codpais and mun.siglauf=new.siglauf and mun.codmunic=new.codmunic
                into :nomemunicfor;
        if (nomemunicfor is not null) then new.cidfor = nomemunicfor;
    end

    if(new.siglauf is not null) then
    begin
        new.uffor=new.siglauf;
    end

    /* Fim da atualização do campo cidade */

end
^

/* Trigger: CPITCOMPRATGAD */
CREATE TRIGGER CPITCOMPRATGAD FOR CPITCOMPRA
ACTIVE AFTER DELETE POSITION 0
AS
  DECLARE VARIABLE DDTCOMPRA DATE;
  DECLARE VARIABLE CFLAG CHAR(1);
  DECLARE VARIABLE IDOCCOMPRA INTEGER;
  DECLARE VARIABLE ICODEMPTM INTEGER;
  DECLARE VARIABLE SCODFILIALTM SMALLINT;
  DECLARE VARIABLE ICODTIPOMOV INTEGER;
BEGIN
  IF ( not ( (old.EMMANUT='S') and (old.EMMANUT IS NOT NULL) ) ) THEN
  BEGIN
      UPDATE CPCOMPRA SET VLRDESCITCOMPRA = VLRDESCITCOMPRA -old.VLRDESCITCOMPRA,
             VLRPRODCOMPRA = VLRPRODCOMPRA - old.VLRPRODITCOMPRA,
             VLRBASEICMSCOMPRA = VLRBASEICMSCOMPRA - old.VLRBASEICMSITCOMPRA,
             VLRICMSCOMPRA = VLRICMSCOMPRA -old.VLRICMSITCOMPRA,
             VLRISENTASCOMPRA = VLRISENTASCOMPRA - old.VLRISENTASITCOMPRA,
             VLROUTRASCOMPRA = VLROUTRASCOMPRA - old.VLROUTRASITCOMPRA,
             VLRBASEIPICOMPRA = VLRBASEIPICOMPRA - old.VLRBASEIPIITCOMPRA,
             VLRIPICOMPRA = VLRIPICOMPRA - old.VLRIPIITCOMPRA,
             VLRLIQCOMPRA = VLRLIQCOMPRA - old.VLRLIQITCOMPRA
             WHERE CODCOMPRA=old.CODCOMPRA
             AND CODEMP=old.CODEMP AND CODFILIAL=old.CODFILIAL;
      SELECT C.DTENTCOMPRA,C.FLAG,C.DOCCOMPRA,
          C.CODEMPTM, C.CODFILIALTM, C.CODTIPOMOV
       FROM CPCOMPRA C WHERE C.CODCOMPRA = old.CODCOMPRA
          AND C.CODEMP=old.CODEMP AND C.CODFILIAL = old.CODFILIAL
      INTO :DDTCOMPRA, :CFLAG, :IDOCCOMPRA, :ICODEMPTM, :SCODFILIALTM, :ICODTIPOMOV;
      EXECUTE PROCEDURE EQMOVPRODIUDSP('D', old.CODEMPPD, old.CODFILIALPD,
         old.CODPROD, old.CODEMPLE, old.CODFILIALLE, old.CODLOTE,
         :ICODEMPTM, :SCODFILIALTM, :ICODTIPOMOV, null, null, null,
         old.CODEMP, old.CODFILIAL, old.CODCOMPRA, old.CODITCOMPRA,
         null, null, null, null, null, null, null, null, null,null,null,null,
         null,old.CODEMPNT, old.CODFILIALNT, old.CODNAT, :DDTCOMPRA,
         :IDOCCOMPRA, :CFLAG, old.QTDITCOMPRA, old.CUSTOITCOMPRA,
         old.CODEMPAX, old.CODFILIALAX, old.CODALMOX);
  END
END
^

/* Trigger: CPITCOMPRATGAI */
CREATE TRIGGER CPITCOMPRATGAI FOR CPITCOMPRA
ACTIVE AFTER INSERT POSITION 0
AS
DECLARE VARIABLE DDTCOMPRA DATE;
DECLARE VARIABLE CFLAG CHAR(1);
DECLARE VARIABLE IDOCCOMPRA INTEGER;
DECLARE VARIABLE ICODEMPTM INTEGER;
DECLARE VARIABLE SCODFILIALTM SMALLINT;
DECLARE VARIABLE ICODTIPOMOV INTEGER;
BEGIN
  SELECT C.DTENTCOMPRA,C.FLAG,C.DOCCOMPRA,
      C.CODEMPTM, C.CODFILIALTM, C.CODTIPOMOV
   FROM CPCOMPRA C WHERE C.CODCOMPRA = new.CODCOMPRA
      AND C.CODEMP=new.CODEMP AND C.CODFILIAL = new.CODFILIAL
  INTO :DDTCOMPRA, :CFLAG, :IDOCCOMPRA, :ICODEMPTM, :SCODFILIALTM, :ICODTIPOMOV;
  EXECUTE PROCEDURE EQMOVPRODIUDSP('I', new.CODEMPPD, new.CODFILIALPD,
     new.CODPROD, new.CODEMPLE, new.CODFILIALLE, new.CODLOTE,
     :ICODEMPTM, :SCODFILIALTM, :ICODTIPOMOV, null, null, null,
     new.CODEMP, new.CODFILIAL, new.CODCOMPRA, new.CODITCOMPRA,
     null, null, null, null, null, null, null, null, null,null,null,null,null,
     new.CODEMPNT, new.CODFILIALNT, new.CODNAT, :DDTCOMPRA,
     :IDOCCOMPRA, :CFLAG, new.QTDITCOMPRA, new.CUSTOITCOMPRA,
     new.CODEMPAX, new.CODFILIALAX, new.CODALMOX);
END
^

/* Trigger: CPITCOMPRATGAU */
CREATE TRIGGER CPITCOMPRATGAU FOR CPITCOMPRA
ACTIVE AFTER UPDATE POSITION 0
AS
  DECLARE VARIABLE DDTCOMPRA DATE;
  DECLARE VARIABLE CFLAG CHAR(1);
  DECLARE VARIABLE IDOCCOMPRA INTEGER;
  DECLARE VARIABLE ICODEMPTM INTEGER;
  DECLARE VARIABLE SCODFILIALTM SMALLINT;
  DECLARE VARIABLE ICODTIPOMOV INTEGER;
BEGIN
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT IS NOT NULL) ) ) ) THEN
  BEGIN
      UPDATE CPCOMPRA SET VLRDESCITCOMPRA = VLRDESCITCOMPRA -old.VLRDESCITCOMPRA + new.VLRDESCITCOMPRA,
          VLRPRODCOMPRA = VLRPRODCOMPRA - old.VLRPRODITCOMPRA + new.VLRPRODITCOMPRA,
          VLRBASEICMSCOMPRA = VLRBASEICMSCOMPRA - old.VLRBASEICMSITCOMPRA + new.VLRBASEICMSITCOMPRA,
          VLRICMSCOMPRA = VLRICMSCOMPRA -old.VLRICMSITCOMPRA + new.VLRICMSITCOMPRA,
          VLRISENTASCOMPRA = VLRISENTASCOMPRA - old.VLRISENTASITCOMPRA + new.VLRISENTASITCOMPRA,
          VLROUTRASCOMPRA = VLROUTRASCOMPRA - old.VLROUTRASITCOMPRA + new.VLROUTRASITCOMPRA,
          VLRBASEIPICOMPRA = VLRBASEIPICOMPRA - old.VLRBASEIPIITCOMPRA + new.VLRBASEIPIITCOMPRA,
          VLRIPICOMPRA = VLRIPICOMPRA - old.VLRIPIITCOMPRA + new.VLRIPIITCOMPRA,
          VLRLIQCOMPRA = VLRLIQCOMPRA - old.VLRLIQITCOMPRA + new.VLRLIQITCOMPRA
          WHERE CODCOMPRA=new.CODCOMPRA
          AND CODEMP=new.CODEMP AND CODFILIAL=new.CODFILIAL;
      SELECT C.DTENTCOMPRA,C.FLAG,C.DOCCOMPRA,
          C.CODEMPTM, C.CODFILIALTM, C.CODTIPOMOV
       FROM CPCOMPRA C WHERE C.CODCOMPRA = new.CODCOMPRA
          AND C.CODEMP=new.CODEMP AND C.CODFILIAL = new.CODFILIAL
      INTO :DDTCOMPRA, :CFLAG, :IDOCCOMPRA, :ICODEMPTM, :SCODFILIALTM, :ICODTIPOMOV;
      EXECUTE PROCEDURE EQMOVPRODIUDSP('U', new.CODEMPPD, new.CODFILIALPD,
         new.CODPROD, new.CODEMPLE, new.CODFILIALLE, new.CODLOTE,
         :ICODEMPTM, :SCODFILIALTM, :ICODTIPOMOV, null, null, null,
         new.CODEMP, new.CODFILIAL, new.CODCOMPRA, new.CODITCOMPRA,
         null, null, null, null, null, null, null, null, null,null,null,null,null,
         new.CODEMPNT, new.CODFILIALNT, new.CODNAT, :DDTCOMPRA,
         :IDOCCOMPRA, :CFLAG, new.QTDITCOMPRA, new.CUSTOITCOMPRA,
         new.CODEMPAX, new.CODFILIALAX, new.CODALMOX);
  END
END
^

/* Trigger: CPITCOMPRATGBI */
CREATE TRIGGER CPITCOMPRATGBI FOR CPITCOMPRA
ACTIVE BEFORE INSERT POSITION 0
AS
DECLARE VARIABLE sTipoFisc CHAR(2);
DECLARE VARIABLE sRefProd CHAR(13);
DECLARE VARIABLE sCustoSICMS CHAR(1);    
DECLARE VARIABLE habCustoCompra CHAR(1);
BEGIN
  SELECT REFPROD FROM EQPRODUTO WHERE CODPROD=new.CODPROD
         AND CODEMP=new.CODEMPPD AND CODFILIAL = new.CODFILIALPD INTO sRefProd;
  IF (new.REFPROD IS NULL) THEN new.REFPROD = sRefProd;
  IF (new.VLRDESCITCOMPRA IS NULL) THEN new.VLRDESCITCOMPRA = 0;
  IF (new.VLRBASEICMSITCOMPRA IS NULL) THEN new.VLRBASEICMSITCOMPRA = 0;
  IF (new.VLRICMSITCOMPRA IS NULL) THEN new.VLRICMSITCOMPRA = 0;
  IF (new.VLRBASEIPIITCOMPRA IS NULL) THEN new.VLRBASEIPIITCOMPRA = 0;
  IF (new.VLRIPIITCOMPRA IS NULL) THEN new.VLRIPIITCOMPRA = 0;
  IF (new.VLRLIQITCOMPRA IS NULL) THEN new.VLRLIQITCOMPRA = 0;
  IF (new.VLRADICITCOMPRA IS NULL) THEN new.VLRADICITCOMPRA = 0;
  IF (new.VLRFRETEITCOMPRA IS NULL) THEN new.VLRFRETEITCOMPRA = 0;
  SELECT F.TIPOFISC FROM LFCLFISCAL F, EQPRODUTO P WHERE P.CODPROD=new.CODPROD AND
    F.CODFISC = P.CODFISC AND F.CODEMP=P.CODEMP AND F.CODFILIAL=P.CODFILIAL
         AND P.CODEMP=new.CODEMPPD AND P.CODFILIAL = new.CODFILIALPD INTO :sTipoFisc;
  IF (new.CODALMOX IS NULL) THEN
       SELECT CODEMPAX,CODFILIALAX,CODALMOX FROM EQPRODUTO WHERE
          CODEMP=new.CODEMPPD AND CODFILIAL=new.CODFILIALPD AND
          CODPROD=new.CODPROD
       INTO new.CODEMPAX, new.CODFILIALAX,new.CODALMOX;

/*
  IF (sTipoFisc = 'II') THEN
  BEGIN
    new.VLRISENTASITCOMPRA = new.VLRLIQITCOMPRA;
    new.VLRBASEICMSITCOMPRA = 0;
    new.PERCICMSITCOMPRA = 0;
    new.VLRICMSITCOMPRA = 0;
    new.VLROUTRASITCOMPRA = 0;
  END
  ELSE IF (sTipoFisc = 'FF') THEN
  BEGIN
    new.VLROUTRASITCOMPRA = new.VLRLIQITCOMPRA;
    new.VLRBASEICMSITCOMPRA = 0;
    new.PERCICMSITCOMPRA = 0;
    new.VLRICMSITCOMPRA = 0;
    new.VLRISENTASITCOMPRA = 0;
  END
  ELSE IF (sTipoFisc = 'NN') THEN
  BEGIN
    new.VLROUTRASITCOMPRA = new.VLRLIQITCOMPRA;
    new.VLRBASEICMSITCOMPRA = 0;
    new.PERCICMSITCOMPRA = 0;
    new.VLRICMSITCOMPRA = 0;
    new.VLRISENTASITCOMPRA = 0;
  END
  ELSE IF (sTipoFisc = 'TT') THEN
  BEGIN
    new.VLROUTRASITCOMPRA = 0;
    new.VLRISENTASITCOMPRA = 0;
  END
*/
  SELECT P.CUSTOCOMPRA FROM SGPREFERE1 P
    WHERE P.CODEMP=new.CODEMP AND P.CODFILIAL=new.CODFILIAL INTO habCustoCompra;
  IF (('N' = habCustoCompra) OR (new.CUSTOITCOMPRA IS NULL)) THEN
  BEGIN
    SELECT NVLRCUSTO FROM CPCOMPRASP01(new.CODEMP, new.CODFILIAL, new.QTDITCOMPRA,
       new.VLRLIQITCOMPRA, new.VLRICMSITCOMPRA) INTO new.CUSTOITCOMPRA;
  END
  UPDATE CPCOMPRA SET VLRDESCITCOMPRA = VLRDESCITCOMPRA + new.VLRDESCITCOMPRA,
         VLRPRODCOMPRA = VLRPRODCOMPRA + new.VLRPRODITCOMPRA,
         VLRBASEICMSCOMPRA = VLRBASEICMSCOMPRA + new.VLRBASEICMSITCOMPRA,
         VLRICMSCOMPRA = VLRICMSCOMPRA + new.VLRICMSITCOMPRA,
         VLRISENTASCOMPRA = VLRISENTASCOMPRA + new.VLRISENTASITCOMPRA,
         VLROUTRASCOMPRA = VLROUTRASCOMPRA + new.VLROUTRASITCOMPRA,
         VLRBASEIPICOMPRA = VLRBASEIPICOMPRA + new.VLRBASEIPIITCOMPRA,
         VLRIPICOMPRA = VLRIPICOMPRA + new.VLRIPIITCOMPRA,
         VLRLIQCOMPRA = VLRLIQCOMPRA + new.VLRLIQITCOMPRA
         WHERE CODCOMPRA=new.CODCOMPRA
         AND CODEMP=new.CODEMP AND CODFILIAL=new.CODFILIAL;
END
^

/* Trigger: CPITCOMPRATGBU */
CREATE TRIGGER CPITCOMPRATGBU FOR CPITCOMPRA
ACTIVE BEFORE UPDATE POSITION 0
AS
     DECLARE VARIABLE sTipoFisc CHAR(2);
     DECLARE VARIABLE sRefProd CHAR(13);
     DECLARE VARIABLE sAdicFrete CHAR(1);
     DECLARE VARIABLE VLRIT NUMERIC(15, 5);          
     DECLARE VARIABLE habCustoCompra CHAR(1);
begin
  IF ( new.EMMANUT IS NULL) THEN
      new.EMMANUT='N';
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT IS NOT NULL) )) ) THEN
  BEGIN
      new.DTALT = cast('today' AS DATE);
      new.IDUSUALT = USER;
      new.HALT = cast('now' AS TIME);
      IF (new.CODPROD != old.CODPROD) THEN
        EXCEPTION CPITCOMPRAEX01;
      IF (new.CODLOTE != old.CODLOTE) THEN
        EXCEPTION CPITCOMPRAEX02;

      IF (new.CODALMOX IS NULL) THEN
         SELECT CODEMPAX,CODFILIALAX,CODALMOX FROM EQPRODUTO WHERE
          CODEMP=new.CODEMPPD AND CODFILIAL=new.CODFILIALPD AND
          CODPROD=new.CODPROD
         INTO new.CODEMPAX, new.CODFILIALAX,new.CODALMOX;

      IF (old.CODALMOX IS NOT NULL) THEN
      BEGIN
         IF (old.CODALMOX!=new.CODALMOX) THEN
            EXCEPTION EQALMOX01;
      END

      VLRIT = new.VLRLIQITCOMPRA;

      SELECT F.TIPOFISC FROM LFCLFISCAL F, EQPRODUTO P WHERE P.CODPROD=new.CODPROD
             AND F.CODFISC = P.CODFISC AND F.CODEMP = P.CODEMP AND F.CODFILIAL = P.CODFILIAL
             AND P.CODEMP = new.CODEMPPD AND P.CODFILIAL = new.CODFILIALPD INTO :sTipoFisc;

      SELECT REFPROD FROM EQPRODUTO WHERE CODPROD=new.CODPROD
             AND CODEMP=new.CODEMPPD AND CODFILIAL = new.CODFILIALPD INTO sRefProd;  

      SELECT ADICFRETECOMPRA FROM CPCOMPRA WHERE CODEMP=new.CODEMP AND CODFILIAL=new.CODFILIAL
             AND CODCOMPRA=new.CODCOMPRA INTO :SADICFRETE;
                 
      IF (:SADICFRETE = 'S') THEN
      BEGIN
          VLRIT = new.VLRLIQITCOMPRA + new.VLRFRETEITCOMPRA;
      END


      SELECT P.CUSTOCOMPRA FROM SGPREFERE1 P
        WHERE P.CODEMP=new.CODEMP AND P.CODFILIAL=new.CODFILIAL INTO habCustoCompra;
      IF (('N' = habCustoCompra) OR (new.CUSTOITCOMPRA IS NULL)) THEN
      BEGIN
        SELECT NVLRCUSTO FROM CPCOMPRASP01(new.CODEMP, new.CODFILIAL, new.QTDITCOMPRA,
          new.VLRLIQITCOMPRA, new.VLRICMSITCOMPRA) INTO new.CUSTOITCOMPRA;
      END

      IF (new.REFPROD IS NULL) THEN new.REFPROD = sRefProd;

      IF (:SADICFRETE = 'S') THEN
      BEGIN
          new.custoitcompra = new.custoitcompra + new.vlrfreteitcompra;
      END

    /*
      IF (sTipoFisc = 'II') THEN
      BEGIN
        new.VLRISENTASITCOMPRA = new.VLRLIQITCOMPRA;
        new.VLROUTRASITCOMPRA = 0;
      END
      ELSE IF (sTipoFisc = 'FF') THEN
      BEGIN
        new.VLROUTRASITCOMPRA = new.VLRLIQITCOMPRA;
        new.VLRISENTASITCOMPRA = 0;
      END
      ELSE IF (sTipoFisc = 'NN') THEN
      BEGIN
        new.VLROUTRASITCOMPRA = new.VLRLIQITCOMPRA;
        new.VLRISENTASITCOMPRA = 0;
      END
      ELSE IF (sTipoFisc = 'TT') THEN
      BEGIN
        new.VLROUTRASITCOMPRA = 0;
        new.VLRISENTASITCOMPRA = 0;
      END
    */
  END
end
^

/* Trigger: CPITSOLICITACAOTGBI */
CREATE TRIGGER CPITSOLICITACAOTGBI FOR CPITSOLICITACAO
ACTIVE BEFORE INSERT POSITION 0
AS
begin
  IF (new.REFPROD IS NULL) THEN
       SELECT REFPROD FROM EQPRODUTO WHERE CODPROD=new.CODPROD
            AND CODEMP=new.CODEMPPD AND CODFILIAL = new.CODFILIALPD INTO new.REFPROD;
end
^

/* Trigger: CPITSOLICITACAOTGBU */
CREATE TRIGGER CPITSOLICITACAOTGBU FOR CPITSOLICITACAO
ACTIVE BEFORE UPDATE POSITION 0
AS
     declare variable sRefProd Char(13);
     DECLARE VARIABLE ICODEMPUSU INT;
     declare variable ICODFILIALUSU smallint;
     declare variable IDUSU char(8);
begin
  /*#IBA#new.DTALT = cast('today' AS DATE);
  new.IDUSUALT = USER;
  new.HALT = cast('now' AS TIME);#IBA#*/
  IF (new.CODPROD != old.CODPROD) THEN
     EXCEPTION CPITSOLICITACAOEX01;
  IF (new.REFPROD IS NULL) THEN
  BEGIN
       SELECT REFPROD FROM EQPRODUTO WHERE CODPROD=new.CODPROD
            AND CODEMP=new.CODEMPPD AND CODFILIAL = new.CODFILIALPD INTO sRefProd;
       new.REFPROD = sRefProd;
  END

  if((new.idusuaprovitsol is null) and (new.sititsol!=old.sititsol) and ((new.sititsol= 'AP') or (new.sititsol= 'AT') )) then
  begin
    SELECT CODEMPUSU,CODFILIALUSU,IDUSUS FROM sgretinfousu(USER) into :ICODEMPUSU,:ICODFILIALUSU,:IDUSU;
    new.codempua = :ICODEMPUSU;
    new.codfilialua = :ICODFILIALUSU;
    new.idusuaprovitsol = :IDUSU;
    new.dtaprovitsol = cast('now' AS DATE);
  end
end
^

/* Trigger: CPITSOLSTSOL */
CREATE TRIGGER CPITSOLSTSOL FOR CPITSOLICITACAO
ACTIVE AFTER INSERT OR UPDATE OR DELETE POSITION 1
AS
  declare variable numitens int;
  declare variable numitensaf int;
  declare variable numitensap int;
  declare variable numitensna int;
  declare variable numitensat int;
  declare variable numitensef int;
  declare variable numitensca int;
  declare variable numitensep int;
  declare variable numitensne int;
  declare variable numitenset int;

begin
  if (old.sititsol!='AF') then
  begin
      select count(1) from cpitsolicitacao where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol into :numitens;
      select count(1) from cpitsolicitacao where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and sititsol='AF' into :numitensaf;
      select count(1) from cpitsolicitacao where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and sititsol='EF' into :numitensef;
      select count(1) from cpitsolicitacao where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and sititsol='CA' into :numitensca;
      if(:numitens=:numitensaf) then
      begin
        update cpsolicitacao set sitsol='AF' where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and sitsol!='AF';
      end
      else if (:numitens=:numitensef) then
      begin
        update cpsolicitacao set sitsol='EF' where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and sitsol!='EF';
      end
      else if (:numitens=:numitensca) then
      begin
        update cpsolicitacao set sitsol='CA' where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and sitsol!='CA';
      end
      if (new.qtdaprovitsol!=old.qtdaprovitsol) then
      begin
          if (new.qtdaprovitsol>0) then
          begin
              update cpsolicitacao set sitsol='EA' where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and sitsol='PE';
              select count(1) from cpitsolicitacao where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and sitaprovitsol='AP' into :numitensap;
              select count(1) from cpitsolicitacao where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and sitaprovitsol='NA' into :numitensna;
              select count(1) from cpitsolicitacao where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and sitaprovitsol='AT' into :numitensat;
              if(:numitens!=:numitensaf) then
              begin
                if(:numitens=:numitensat) then
                begin
                   update cpsolicitacao set sitsol='AT' where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and sitsol!='AT';
                end
                else if((:numitensap>0) or (:numitensna>0)) then
                begin
                   update cpsolicitacao set sitsol='AP' where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and sitsol!='AP';
                end
                if(:numitens=:numitensna) then
                begin
                   update cpsolicitacao set sitsol='NA' where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol  and sitsol!='NA';
                end
              end
          end
      end
  end
  else if (old.sititsol!='EF') then
  begin
      select count(1) from cpitsolicitacao where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol into :numitens;
      select count(1) from cpitsolicitacao where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and sititsol='EF' into :numitensef;
      if (:numitens=:numitensef) then
      begin
        update cpsolicitacao set sitsol='EF' where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and sitsol!='EF';
      end
  end
    if(new.sititsol='EF')  then
    begin
      update cpcotacao set sititsol = 'EF' where codemp=new.codemp and codfilial=new.codfilial and codsol=new.codsol and coditsol=new.coditsol and sititsol!='EF';
    end
    if(new.sititsol='ET')  then
    begin
      update cpcotacao set sititsol = 'ET' where codemp=new.codemp and codfilial=new.codfilial and codsol=new.codsol and coditsol=new.coditsol and sitcompitsol!='ET';
    end
end
^

/* Trigger: CPITSOLTGBD */
CREATE TRIGGER CPITSOLTGBD FOR CPITSOLICITACAO
ACTIVE BEFORE DELETE POSITION 0
AS
declare variable sUsuarioCN char(8);
declare variable sUsuarioRM char(8);
begin

   if(old.sititsol<>'PE') then
   begin
      exception eqitrma01;
   end

   select idusus from sgretinfousu(USER) into :sUsuarioCN;
   select rm.idusu from cpsolicitacao rm where rm.codemp=old.codemp and rm.codfilial=old.codfilial and rm.codsol=old.codsol into :sUsuarioRM;
   if(:sUsuarioCN<>:sUsuarioRM)then
   begin
      exception eqitrma02;
   end
end
^

/* Trigger: CPITSOLTGBI */
CREATE TRIGGER CPITSOLTGBI FOR CPITSOLICITACAO
ACTIVE BEFORE INSERT POSITION 0
AS
begin
  IF (new.CODALMOX IS NULL) THEN
       SELECT CODEMPAX,CODFILIALAX,CODALMOX FROM EQPRODUTO WHERE
          CODEMP=new.CODEMPPD AND CODFILIAL=new.CODFILIALPD AND CODPROD=new.CODPROD
       INTO new.codempam, new.codfilialam,new.codalmox;
  if (new.qtdaprovitsol>new.qtditsol) then
     exception cpitsolicitacao;
end
^

/* Trigger: CPITSOLTGBIBU */
CREATE TRIGGER CPITSOLTGBIBU FOR CPITSOLICITACAO
ACTIVE BEFORE INSERT OR UPDATE POSITION 8
AS
  declare variable statusitem char(2);
begin
  if (old.sititsol!='AF') then
  begin
      if (new.qtdaprovitsol!=old.qtdaprovitsol or (NEW.sitaprovitsol='AT') ) then
      begin
          if ((new.sitaprovitsol='AT') and (new.qtdaprovitsol=0) and (old.sitaprovitsol!='AT')) then
          begin
            new.qtdaprovitsol=new.qtditsol;
          end
          if (new.qtdaprovitsol>0) then
          begin
            if (new.qtdaprovitsol<new.qtditsol) then
            begin
                statusitem = 'AP';
            end
            else
            begin
                statusitem = 'AT';
            end
          new.sitaprovitsol=:statusitem;
          if(new.sititsol='PE') then
          begin
              new.sititsol='EA';
          end
        end
      end
  end
  if(new.sititsol='CA') then
  begin
    new.qtdaprovitsol=0;
    new.sitaprovitsol='NA';
  end

end
^

/* Trigger: CPITSOLTGBU */
CREATE TRIGGER CPITSOLTGBU FOR CPITSOLICITACAO
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  IF (new.CODALMOX IS NULL) THEN
       SELECT CODEMPAX,CODFILIALAX,CODALMOX FROM EQPRODUTO WHERE
          CODEMP=new.CODEMPPD AND CODFILIAL=new.CODFILIALPD AND
          CODPROD=new.CODPROD
       INTO new.codempam, new.codfilialam,new.CODALMOX;

  IF (old.CODALMOX IS NOT NULL) THEN
  BEGIN
     IF (old.CODALMOX!=new.CODALMOX) THEN
         EXCEPTION EQALMOX01;
  END


  /* Trigger Text */
end
^

/* Trigger: CPITSUMSOLTGBI */
CREATE TRIGGER CPITSUMSOLTGBI FOR CPITSUMSOL
ACTIVE BEFORE INSERT POSITION 0
AS
begin
  new.dtins=cast('now' AS DATE);
  new.idusuins=USER;
  new.hins = cast('now' AS TIME);
END
^

/* Trigger: CPITSUMSOLTGBU */
CREATE TRIGGER CPITSUMSOLTGBU FOR CPITSUMSOL
ACTIVE BEFORE UPDATE POSITION 0
AS
     declare variable sRefProd Char(13);
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: CPPRODFORTGBU */
CREATE TRIGGER CPPRODFORTGBU FOR CPPRODFOR
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: CPRATEIOTGBU */
CREATE TRIGGER CPRATEIOTGBU FOR CPRATEIO
ACTIVE BEFORE UPDATE POSITION 0
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: CPSOLICITACAOTGAI */
CREATE TRIGGER CPSOLICITACAOTGAI FOR CPSOLICITACAO
ACTIVE AFTER INSERT POSITION 0
AS
begin
    new.DTINS=cast('now' AS DATE);
    new.IDUSUINS=user;
    new.HINS=cast('now' AS TIME);
end
^

/* Trigger: CPSOLICITACAOTGAU */
CREATE TRIGGER CPSOLICITACAOTGAU FOR CPSOLICITACAO
ACTIVE AFTER UPDATE POSITION 0
AS
begin
    new.DTALT=cast('now' AS DATE);
    new.IDUSUALT=user;
    new.HALT=cast('now' AS TIME);
    if(new.sitsol='AF')  then
    begin
      update cpitsolicitacao set sititsol = 'AF' where codemp=new.codemp and codfilial=new.codfilial and codsol=new.codsol and sititsol!='AF';
    end
    else if (new.sitsol='CA')  then
    begin
      update cpitsolicitacao set sititsol = 'CA' where codemp=new.codemp and codfilial=new.codfilial and codsol=new.codsol and sititsol!='CA';
    end
    else if(new.sitsol='AT')  then
    begin
      update cpitsolicitacao set sitaprovitsol = 'AT' where codemp=new.codemp and codfilial=new.codfilial and codsol=new.codsol and sitaprovitsol!='AT';
    end
    if(new.sitsol='EF')  then
    begin
      update cpitsolicitacao it set sititsol = 'EF' where codemp=new.codemp and codfilial=new.codfilial and codsol=new.codsol and sititsol!='EF';
    end
    if(new.sitsol='ET')  then
    begin
      update cpitsolicitacao set sitcompitsol = 'ET' where codemp=new.codemp and codfilial=new.codfilial and codsol=new.codsol and sitcompitsol!='ET';
    end
    if(new.sitsol='CT')  then
    begin
      update cpcotacao set sititsol = 'AT' where codemp=new.codemp and codfilial=new.codfilial and codsol=new.codsol and sititsol!='AT';
    end
    if(new.sitsol='CF')  then
    begin
      update cpcotacao set sitcompitsol = 'EF' where codemp=new.codemp and codfilial=new.codfilial and codsol=new.codsol and sitcompitsol!='EF';
    end
end
^

/* Trigger: CPSOLICITACAOTGBU */
CREATE TRIGGER CPSOLICITACAOTGBU FOR CPSOLICITACAO
ACTIVE BEFORE UPDATE POSITION 1
as
  DECLARE VARIABLE ICODEMPUSU INT;
  declare variable ICODFILIALUSU smallint;
  declare variable IDUSU char(8);
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);

  if((new.idusuaprov is null) and (new.sitsol!=old.sitsol) and ((new.sitsol= 'AP') or (new.sitsol= 'AT') )) then
  begin
    SELECT CODEMPUSU,CODFILIALUSU,IDUSUS FROM sgretinfousu(USER) into :ICODEMPUSU,:ICODFILIALUSU,:IDUSU;
    new.codempua = :ICODEMPUSU;
    new.codfilialua = :ICODFILIALUSU;
    new.idusuaprov = :IDUSU;
    new.dtaaprovsol = cast('now' AS DATE);
  end
end
^

/* Trigger: CPSUMSOLTGBI */
CREATE TRIGGER CPSUMSOLTGBI FOR CPSUMSOL
ACTIVE BEFORE INSERT POSITION 0
AS
begin
  new.dtins=cast('now' AS DATE);
  new.idusuins=USER;
  new.hins = cast('now' AS TIME);

 IF (new.REFPROD IS NULL) THEN
       SELECT REFPROD FROM EQPRODUTO WHERE CODPROD=new.CODPROD
            AND CODEMP=new.CODEMPPD AND CODFILIAL = new.CODFILIALPD INTO new.REFPROD;
END
^

/* Trigger: CPSUMSOLTGBU */
CREATE TRIGGER CPSUMSOLTGBU FOR CPSUMSOL
ACTIVE BEFORE UPDATE POSITION 0
AS
     declare variable sRefProd Char(13);
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);

  IF (new.CODPROD != old.CODPROD) THEN
     EXCEPTION CPITSOLICITACAOEX01;
  IF (new.REFPROD IS NULL) THEN
  BEGIN
       SELECT REFPROD FROM EQPRODUTO WHERE CODPROD=new.CODPROD
            AND CODEMP=new.CODEMPPD AND CODFILIAL = new.CODFILIALPD INTO sRefProd;
       new.REFPROD = sRefProd;
  END
end
^

/* Trigger: CPTABFORTGBU */
CREATE TRIGGER CPTABFORTGBU FOR CPTABFOR
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: CPTIPOFORTGBU */
CREATE TRIGGER CPTIPOFORTGBU FOR CPTIPOFOR
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: EQALMOXTGBU */
CREATE TRIGGER EQALMOXTGBU FOR EQALMOX
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT=cast('now'AS TIME);
end
^

/* Trigger: EQCLIFORTGBU */
CREATE TRIGGER EQCLIFORTGBU FOR EQCLIFOR
ACTIVE BEFORE UPDATE POSITION 0
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: EQCODALTPRODBI */
CREATE TRIGGER EQCODALTPRODBI FOR EQCODALTPROD
ACTIVE BEFORE INSERT POSITION 0
AS
begin
  SELECT REFPROD FROM EQPRODUTO WHERE CODEMP=new.CODEMP and CODFILIAL=new.CODFILIAL
     AND CODPROD=new.CODPROD INTO new.REFPROD;
end
^

/* Trigger: EQCODALTPRODBU */
CREATE TRIGGER EQCODALTPRODBU FOR EQCODALTPROD
ACTIVE BEFORE UPDATE POSITION 0
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  SELECT REFPROD FROM EQPRODUTO WHERE CODEMP=new.CODEMP and CODFILIAL=new.CODFILIAL
     AND CODPROD=new.CODPROD INTO new.REFPROD;
end
^

/* Trigger: EQFATCONVTGBU */
CREATE TRIGGER EQFATCONVTGBU FOR EQFATCONV
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: EQGRUPOTGBU */
CREATE TRIGGER EQGRUPOTGBU FOR EQGRUPO
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  if (new.ESTNEGGRUP IS NULL) then
     new.ESTNEGGRUP = 'N';
  if (new.ESTLOTNEGGRUP IS NULL) then
     new.ESTLOTNEGGRUP = 'N';
  if ( (old.ESTNEGGRUP IS NULL) OR (old.ESTNEGGRUP!=new.ESTNEGGRUP) ) then
     UPDATE EQGRUPO SET ESTNEGGRUP=new.ESTNEGGRUP
         WHERE CODEMP=new.CODEMP AND CODFILIAL=new.CODFILIAL AND
           CODGRUP!=new.CODGRUP AND CODGRUP LIKE RTRIM(new.CODGRUP)||'%';
  if ( (old.ESTLOTNEGGRUP IS NULL) OR (old.ESTLOTNEGGRUP!=new.ESTLOTNEGGRUP) ) then
     UPDATE EQGRUPO SET ESTLOTNEGGRUP=new.ESTLOTNEGGRUP
         WHERE CODEMP=new.CODEMP AND CODFILIAL=new.CODFILIAL AND
           CODGRUP!=new.CODGRUP AND CODGRUP LIKE RTRIM(new.CODGRUP)||'%';
  /* Trigger Text */
end
^

/* Trigger: EQGUIATRAFTGBU */
CREATE TRIGGER EQGUIATRAFTGBU FOR EQGUIATRAF
ACTIVE BEFORE UPDATE POSITION 0
AS
begin
   new.DTALT=cast('now' AS DATE);
    new.IDUSUALT=USER;
    new.HALT = cast('now' AS TIME);
end
^

/* Trigger: EQINVPRODTGAD */
CREATE TRIGGER EQINVPRODTGAD FOR EQINVPROD
ACTIVE AFTER DELETE POSITION 0
AS
begin
  /* Apos a exclusão do inventário */
  EXECUTE PROCEDURE EQMOVPRODIUDSP('D', old.CODEMPPD, old.CODFILIALPD,
     old.CODPROD, old.CODEMPLE, old.CODFILIALLE, old.CODLOTE,
     old.CODEMPTM, old.CODFILIALTM, old.CODTIPOMOV, old.CODEMP,
     old.CODFILIAL, old.CODINVPROD, null, null, null, null,null,
     null, null, null, null, null, null, null, null, null, null, null,
     null,null,null,
     null, old.DATAINVP, old.CODINVPROD, 'S', old.QTDINVP, old.PRECOINVP,
     old.CODEMPAX, old.CODFILIALAX, old.CODALMOX);
end
^

/* Trigger: EQINVPRODTGAI */
CREATE TRIGGER EQINVPRODTGAI FOR EQINVPROD
ACTIVE AFTER INSERT POSITION 0
AS
BEGIN
  EXECUTE PROCEDURE EQMOVPRODIUDSP('I', new.CODEMPPD, new.CODFILIALPD,
     new.CODPROD, new.CODEMPLE, new.CODFILIALLE, new.CODLOTE,
     new.CODEMPTM, new.CODFILIALTM, new.CODTIPOMOV, new.CODEMP,
     new.CODFILIAL, new.CODINVPROD,  null, null, null, null,
     null, null, null, null, null, null, null, null, null,null,
     null,null,null,
     null, null, null, new.DATAINVP, new.CODINVPROD, 'S',
     new.QTDINVP, new.PRECOINVP,
     new.CODEMPAX, new.CODFILIALAX, new.CODALMOX);
END
^

/* Trigger: EQINVPRODTGAU */
CREATE TRIGGER EQINVPRODTGAU FOR EQINVPROD
ACTIVE AFTER UPDATE POSITION 0
AS
BEGIN
  EXECUTE PROCEDURE EQMOVPRODIUDSP('U', new.CODEMPPD, new.CODFILIALPD,
     new.CODPROD, new.CODEMPLE, new.CODFILIALLE, new.CODLOTE,
     new.CODEMPTM, new.CODFILIALTM, new.CODTIPOMOV, new.CODEMP,
     new.CODFILIAL, new.CODINVPROD,  null, null, null, null,
     null, null, null, null, null, null, null, null, null,null,null,null,
     null, null, null, null, new.DATAINVP, new.CODINVPROD, 'S',
     new.QTDINVP, new.PRECOINVP,
     new.CODEMPAX, new.CODFILIALAX, new.CODALMOX);
END
^

/* Trigger: EQINVPRODTGBI */
CREATE TRIGGER EQINVPRODTGBI FOR EQINVPROD
ACTIVE BEFORE INSERT POSITION 0
AS
  DECLARE VARIABLE CLOTEPROD CHAR;
BEGIN
  new.DTINS=cast('now' AS DATE);
  new.IDUSUINS=USER;
  new.HINS = cast('now' AS TIME);
  SELECT CLOTEPROD FROM EQPRODUTO WHERE CODPROD=new.CODPROD
    AND CODEMP=new.CODEMPPD AND CODFILIAL=new.CODFILIALPD INTO CLOTEPROD;
  IF (CLOTEPROD = 'S' AND new.CODLOTE IS NULL) THEN
    EXCEPTION EQINVPRODEX05;
  if (new.SLDATUALINVP is null) then new.SLDATUALINVP = 0;
  if (new.SLDDIGINVP is null) then new.SLDDIGINVP = 0;
/*  new.QTDINVP = new.SLDATUALINVP - new.SLDDIGINVP; */
  SELECT REFPROD FROM EQPRODUTO WHERE CODPROD=new.CODPROD
         AND CODEMP=new.CODEMPPD AND CODFILIAL = new.CODFILIALPD INTO new.REFPROD;
END
^

/* Trigger: EQINVPRODTGBU */
CREATE TRIGGER EQINVPRODTGBU FOR EQINVPROD
ACTIVE BEFORE UPDATE POSITION 0
AS
  DECLARE VARIABLE CLOTEPROD CHAR;
BEGIN
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  SELECT CLOTEPROD FROM EQPRODUTO WHERE CODPROD=new.CODPROD
    AND CODEMP=new.CODEMPPD AND CODFILIAL=new.CODFILIALPD INTO CLOTEPROD;
  IF (new.CODPROD != old.CODPROD) THEN
    EXCEPTION EQINVPRODEX01;
  IF (new.CODLOTE != old.CODLOTE) THEN
    EXCEPTION EQINVPRODEX02;
  IF (new.DATAINVP != old.DATAINVP) THEN
    EXCEPTION EQINVPRODEX03;
  IF (new.CODALMOX != old.CODALMOX) THEN
    EXCEPTION EQINVPRODEX04;
  IF (CLOTEPROD = 'S' AND new.CODLOTE IS NULL) THEN
    EXCEPTION EQINVPRODEX05;
END
^

/* Trigger: EQITMODGRADETGBU */
CREATE TRIGGER EQITMODGRADETGBU FOR EQITMODGRADE
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: EQITRMASTRMA */
CREATE TRIGGER EQITRMASTRMA FOR EQITRMA
ACTIVE AFTER INSERT OR UPDATE OR DELETE POSITION 1
AS
  declare variable numitens int;
  declare variable numitensaf int;
  declare variable numitensap int;
  declare variable numitensna int;
  declare variable numitensat int;
  declare variable numitensef int;
  declare variable numitensca int;
  declare variable numitensep int;
  declare variable numitensne int;
  declare variable numitenset int;

begin
  if (old.sititrma!='AF') then
  begin
      select count(1) from eqitrma where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma into :numitens;
      select count(1) from eqitrma where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sititrma='AF' into :numitensaf;
      select count(1) from eqitrma where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sititrma='EF' into :numitensef;
      select count(1) from eqitrma where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sititrma='CA' into :numitensca;
      if(:numitens=:numitensaf) then
      begin
        update eqrma set sitrma='AF' where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sitrma!='AF';
      end
      else if (:numitens=:numitensef) then
      begin
        update eqrma set sitrma='EF' where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sitrma!='EF';
      end
      else if (:numitens=:numitensca) then
      begin
        update eqrma set sitrma='CA' where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sitrma!='CA';
      end
      if (new.qtdaprovitrma!=old.qtdaprovitrma) then
      begin
          if (new.qtdaprovitrma>0) then
          begin
              update eqrma set sitrma='EA' where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sitrma='PE';
              select count(1) from eqitrma where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sitaprovitrma='AP' into :numitensap;
              select count(1) from eqitrma where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sitaprovitrma='NA' into :numitensna;
              select count(1) from eqitrma where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sitaprovitrma='AT' into :numitensat;
              if(:numitens!=:numitensaf) then
              begin
                if(:numitens=:numitensat) then
                begin
                   update eqrma set sitaprovrma='AT' where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sitaprovrma!='AT';
                end
                else if((:numitensap>0) or (:numitensna>0)) then
                begin
                   update eqrma set sitaprovrma='AP' where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sitaprovrma!='AP';
                end
                if(:numitens=:numitensna) then
                begin
                   update eqrma set sitaprovrma='NA' where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma  and sitaprovrma!='NA';
                end
              end
          end
      end
  end
  else if (old.sititrma!='EF') then
  begin
      select count(1) from eqitrma where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma into :numitens;
      select count(1) from eqitrma where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sititrma='EF' into :numitensef;
      if (:numitens=:numitensef) then
      begin
        update eqrma set sitrma='EF' where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sitrma!='EF';
      end
      if (new.qtdexpitrma!=old.qtdexpitrma) then
      begin
          if (new.qtdexpitrma>0) then
          begin
              select count(1) from eqitrma where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sitexpitrma='EP' into :numitensep;
              select count(1) from eqitrma where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sitexpitrma='NE' into :numitensne;
              select count(1) from eqitrma where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sitexpitrma='ET' into :numitenset;
              if(:numitens!=:numitensef) then
              begin
                if(:numitens=:numitenset) then
                begin
                   update eqrma set sitexprma='ET' where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sitexprma!='ET';
                end
                else if((:numitensep>0) or (:numitensne>0)) then
                begin
                   update eqrma set sitexprma='EP' where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sitexprma!='EP';
                end
                if(:numitens=:numitensne) then
                begin
                   update eqrma set sitaprovrma='NE' where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma  and sitexprma!='NE';
                end
              end
          end
      end
  end

end
^

/* Trigger: EQITRMATGAD */
CREATE TRIGGER EQITRMATGAD FOR EQITRMA
ACTIVE AFTER DELETE POSITION 0
AS
  DECLARE VARIABLE DDTRMA DATE;
  DECLARE VARIABLE ICODEMPTM INT;
  DECLARE VARIABLE ICODFILIALTM SMALLINT;
  declare VARIABLE ICODTIPOMOV INT ;

  begin
      SELECT R.DTAREQRMA,R.codemptm,R.codfilialtm,R.codtipomov
        FROM EQRMA R
        WHERE R.CODRMA = OLD.CODRMA AND R.CODEMP=OLD.CODEMP AND R.CODFILIAL = OLD.CODFILIAL
        INTO :DDTRMA,:ICODEMPTM,:ICODFILIALTM,:ICODTIPOMOV;

      EXECUTE PROCEDURE EQMOVPRODIUDSP('D',OLD.CODEMPPD, OLD.CODFILIALPD, OLD.CODPROD,
        OLD.CODEMPLE, OLD.CODFILIALLE, OLD.codlote, :ICODEMPTM,
        :ICODFILIALTM, :ICODTIPOMOV, null, null, null ,null, null,
        null, null, null, null, null, null,
        null, OLD.CODEMP, OLD.CODFILIAL, OLD.codrma, OLD.coditrma, null, null, null,
        null,null,null,null, :DDTRMA, OLD.codrma, 'N', OLD.qtdexpitrma, OLD.precoitrma,
        OLD.CODEMPAX, OLD.CODFILIALAX, OLD.CODALMOX);
end
^

/* Trigger: EQITRMATGAI */
CREATE TRIGGER EQITRMATGAI FOR EQITRMA
ACTIVE AFTER INSERT POSITION 0
AS
    declare variable DDTRMA date;
    declare variable ICODEMPTM int;
    declare variable ICODFILIALTM smallint;
    declare variable ICODTIPOMOV int;
    declare variable ICODOP int;
    declare variable QTD decimal(15,5);
    declare variable CBAIXARMAAPROV char(1);

    begin

        select r.dtareqrma,r.codemptm,r.codfilialtm,r.codtipomov,r.codop
            from eqrma r
                where r.codrma=new.codrma and r.codemp=new.codemp and r.codfilial=new.codfilial
        into :DDTRMA,:ICODEMPTM,:ICODFILIALTM,:ICODTIPOMOV,:ICODOP;

        select baixarmaaprov from sgprefere5
            where codemp=new.codemp and codfilial=new.codfilial
        into :CBAIXARMAAPROV;

        if(:CBAIXARMAAPROV='S' AND :ICODOP IS NOT NULL) THEN
        begin
            QTD = new.qtdaprovitrma;
        end
        else
            QTD = new.qtdexpitrma;

        execute procedure eqmovprodiudsp('I',new.CODEMPPD, new.CODFILIALPD, new.CODPROD,
            new.CODEMPLE, new.CODFILIALLE, new.codlote, :ICODEMPTM,:ICODFILIALTM,:ICODTIPOMOV,
            null, null, null ,null, null, null, null, null, null, null, null, null, new.CODEMP,
            new.CODFILIAL, new.codrma, new.coditrma, null, null, null, null,null,null,null,
            :DDTRMA, new.codrma, 'N', :QTD, new.precoitrma, new.CODEMPAX,
            new.CODFILIALAX, new.CODALMOX);
end
^

/* Trigger: EQITRMATGAIAU */
CREATE TRIGGER EQITRMATGAIAU FOR EQITRMA
ACTIVE AFTER INSERT OR UPDATE POSITION 2
AS
declare variable icodemptm int;
declare variable icodfilialtm smallint;
declare variable icodtipomov integer;
begin
  if(new.sititrma='EF') then
  begin
    select tm.codemptm,tm.codfilialtm,tm.codtipomovtm from eqtipomov tm, eqrma rm
       where tm.codemp=rm.codemptm and tm.codfilial=rm.codfilialtm and tm.codtipomov=rm.codtipomov
       and rm.codemp=new.codemp and rm.codfilial=new.codfilial and codrma=new.codrma
       into :icodemptm,:icodfilialtm,:icodtipomov;
    if((:icodemptm is not null) and (:icodfilialtm is not null) and (:icodtipomov is not null)) then
    begin
       update eqrma set codemptm=:icodemptm, codfilialtm=:icodfilialtm, codtipomov=:icodtipomov where
       codemp=new.codemp and codfilial=new.codfilial and codrma=new.codrma;
    end
  end
end
^

/* Trigger: EQITRMATGAU */
CREATE TRIGGER EQITRMATGAU FOR EQITRMA
ACTIVE AFTER UPDATE POSITION 0
AS
  DECLARE VARIABLE DDTRMA DATE;
  DECLARE VARIABLE ICODEMPTM INT;
  DECLARE VARIABLE ICODFILIALTM SMALLINT;
  declare VARIABLE ICODTIPOMOV INT ;

  begin
      new.DTALT=cast('now' AS DATE);
      new.IDUSUALT=user;
      new.HALT=cast('now' AS TIME);
      SELECT R.DTAREQRMA,R.codemptm,R.codfilialtm,R.codtipomov
        FROM EQRMA R
        WHERE R.CODRMA = new.CODRMA AND R.CODEMP=new.CODEMP AND R.CODFILIAL = new.CODFILIAL
        INTO :DDTRMA,:ICODEMPTM,:ICODFILIALTM,:ICODTIPOMOV;

      EXECUTE PROCEDURE EQMOVPRODIUDSP('U',new.CODEMPPD, new.CODFILIALPD, new.CODPROD,
        new.CODEMPLE, new.CODFILIALLE, new.codlote, :ICODEMPTM,
        :ICODFILIALTM, :ICODTIPOMOV, null, null, null ,null, null,
        null, null, null, null, null, null,
        null, new.CODEMP, new.CODFILIAL, new.codrma, new.coditrma, null, null,
        null,null,null,null,null, :DDTRMA, new.codrma, 'N', new.qtdexpitrma, new.precoitrma,
        new.CODEMPAX, new.CODFILIALAX, new.CODALMOX);
end
^

/* Trigger: EQITRMATGBD */
CREATE TRIGGER EQITRMATGBD FOR EQITRMA
ACTIVE BEFORE DELETE POSITION 0
AS
declare variable sUsuarioCN char(8);
declare variable sUsuarioRM char(8);
declare variable apagarmaop char(1);
declare variable icodfilialpref smallint;
declare variable icodop integer;
begin

   if(old.sititrma<>'PE') then
   begin
      exception eqitrma01;
   end

   select icodfilial from sgretfilial(old.codemp,'SGPREFERE5') into :icodfilialpref;

   select idusus from sgretinfousu(USER)
      into :sUsuarioCN;

   select rm.idusu,rm.codop from eqrma rm
      where rm.codemp=old.codemp and rm.codfilial=old.codfilial and rm.codrma=old.codrma
      into :sUsuarioRM, :icodop;

   select p.apagarmaop from sgprefere5 p
      where p.codemp=old.codemp and p.codfilial=:icodfilialpref
      into :apagarmaop;

   if(:icodop is null) then
   begin
       if(:sUsuarioCN<>:sUsuarioRM)then
       begin
          exception eqitrma02;
       end
   end
   else
   begin
      if(:apagarmaop='N' and :sUsuarioCN<>:sUsuarioRM) then
       begin
          exception eqitrma02;
       end
   end

end
^

/* Trigger: EQITRMATGBI */
CREATE TRIGGER EQITRMATGBI FOR EQITRMA
ACTIVE BEFORE INSERT POSITION 0
AS
begin
  IF (new.CODALMOX IS NULL) THEN
       SELECT CODEMPAX,CODFILIALAX,CODALMOX FROM EQPRODUTO WHERE
          CODEMP=new.CODEMPPD AND CODFILIAL=new.CODFILIALPD AND CODPROD=new.CODPROD
       INTO new.CODEMPAX, new.CODFILIALAX,new.CODALMOX;
  if (new.QTDAPROVITRMA>new.QTDITRMA) then
     exception eqitrma;
end
^

/* Trigger: EQITRMATGBIBU */
CREATE TRIGGER EQITRMATGBIBU FOR EQITRMA
ACTIVE BEFORE INSERT OR UPDATE POSITION 8
AS
  declare variable statusitem char(2);
begin
  if (old.sititrma!='AF') then
  begin
      if (new.qtdaprovitrma!=old.qtdaprovitrma or (NEW.sitaprovitrma='AT') ) then
      begin
          if ((new.sitaprovitrma='AT') and (new.qtdaprovitrma=0) and (old.sitaprovitrma!='AT')) then
          begin
            new.qtdaprovitrma=new.qtditrma;
          end
          if (new.qtdaprovitrma>0) then
          begin
            if (new.qtdaprovitrma<new.qtditrma) then
            begin
                statusitem = 'AP';
            end
            else
            begin
                statusitem = 'AT';
            end
          new.sitaprovitrma=:statusitem;
          if(new.sititrma='PE') then
          begin
              new.sititrma='EA';
          end
        end
      end
  end
  else if (old.sititrma!='EF') then
  begin
      if (new.qtdexpitrma!=old.qtdexpitrma or (NEW.sitexpitrma='ET') ) then
      begin
          if ((new.sitexpitrma='ET') and (new.qtdexpitrma=0) and (old.sitexpitrma!='ET')) then
          begin
            new.qtdexpitrma=new.qtdaprovitrma;
          end
          if (new.qtdexpitrma>0) then
          begin
            if (new.qtdexpitrma<new.qtdaprovitrma) then
            begin
                statusitem = 'EP';
            end
            else
            begin
                statusitem = 'ET';
            end
          new.sitexpitrma=:statusitem;
        end
      end
  end
  if(new.sititrma='CA') then
  begin
    new.qtdaprovitrma=0;
    new.sitaprovitrma='NA';
  end

end
^

/* Trigger: EQITRMATGBU */
CREATE TRIGGER EQITRMATGBU FOR EQITRMA
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  IF (new.CODALMOX IS NULL) THEN
       SELECT CODEMPAX,CODFILIALAX,CODALMOX FROM EQPRODUTO WHERE
          CODEMP=new.CODEMPPD AND CODFILIAL=new.CODFILIALPD AND
          CODPROD=new.CODPROD
       INTO new.CODEMPAX, new.CODFILIALAX,new.CODALMOX;

  IF (old.CODALMOX IS NOT NULL) THEN
  BEGIN
     IF (old.CODALMOX!=new.CODALMOX) THEN
         EXCEPTION EQALMOX01;
  END


  /* Trigger Text */
end
^

/* Trigger: EQITSIMILARBI */
CREATE TRIGGER EQITSIMILARBI FOR EQITSIMILAR
ACTIVE BEFORE INSERT POSITION 0
AS
 declare variable ICODPROD INTEGER;
begin
  SELECT CODPROD FROM EQITSIMILAR ITS
     WHERE ITS.CODEMPPD=new.CODEMPPD AND ITS.CODFILIALPD=new.CODFILIALPD AND
       ITS.CODPROD=new.CODPROD AND ITS.CODSIM != new.CODSIM
       INTO :ICODPROD;
  if (ICODPROD IS NOT NULL) then
     exception EQSIMILAREX01;
  SELECT REFPROD FROM EQPRODUTO WHERE CODEMP=new.CODEMPPD and CODFILIAL=new.CODFILIALPD
     AND CODPROD=new.CODPROD INTO new.REFPROD;

end
^

/* Trigger: EQITSIMILARBU */
CREATE TRIGGER EQITSIMILARBU FOR EQITSIMILAR
ACTIVE BEFORE UPDATE POSITION 0
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  SELECT REFPROD FROM EQPRODUTO WHERE CODEMP=new.CODEMPPD and CODFILIAL=new.CODFILIALPD
     AND CODPROD=new.CODPROD INTO new.REFPROD;
end
^

/* Trigger: EQLANCTOEXPTGBU */
CREATE TRIGGER EQLANCTOEXPTGBU FOR EQLANCTOEXP
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: EQLOTETGBI */
CREATE TRIGGER EQLOTETGBI FOR EQLOTE
ACTIVE BEFORE INSERT POSITION 0
as
begin
  if (new.SLDLOTE is null) then
     new.SLDLOTE = 0;
  if (new.SLDRESLOTE is null) then
     new.SLDRESLOTE = 0;
  if (new.SLDCONSIGLOTE is null) then
     new.SLDCONSIGLOTE = 0;
  new.SLDLIQLOTE = new.SLDLOTE-new.SLDRESLOTE-new.SLDCONSIGLOTE;
end
^

/* Trigger: EQLOTETGBU */
CREATE TRIGGER EQLOTETGBU FOR EQLOTE
ACTIVE BEFORE UPDATE POSITION 0
as
  DECLARE VARIABLE ICODFILIAL INTEGER;
  DECLARE VARIABLE CESTLOTNEG CHAR(1);
  DECLARE VARIABLE CESTNEGGRUP CHAR(1);
  DECLARE VARIABLE CESTLOTNEGGRUP CHAR(1);
begin
  SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'SGPREFERE1') INTO :iCodFilial;
  SELECT ESTLOTNEG,ESTNEGGRUP FROM SGPREFERE1 WHERE CODEMP=new.CODEMP AND CODFILIAL=:iCodFilial
     INTO :cEstLotNeg, :cEstNegGrup;
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  if (new.SLDLOTE is null) then
     new.SLDLOTE = 0;
  if (new.SLDRESLOTE is null) then
     new.SLDRESLOTE = 0;
  if (new.SLDCONSIGLOTE is null) then
     new.SLDCONSIGLOTE = 0;
  new.SLDLIQLOTE = new.SLDLOTE-new.SLDRESLOTE-new.SLDCONSIGLOTE;
  if (cEstNegGrup is null) then
      cEstNegGrup ='N';
  if (cEstLotNeg Is null) then
      cEstLotNeg = 'N';

  if ( new.SLDLOTE < 0) then
  begin
     if (cEstNegGrup = 'S') then
     begin
        SELECT G.ESTLOTNEGGRUP FROM EQGRUPO G, EQPRODUTO P
          WHERE P.CODEMP=new.CODEMP AND P.CODFILIAL=new.CODFILIAL AND
            P.CODPROD=new.CODPROD AND G.CODEMP=P.CODEMPGP AND
            G.CODFILIAL=P.CODFILIALGP AND G.CODGRUP=P.CODGRUP
          INTO :cEstLotNegGrup;
        if (cEstLotNegGrup is null) then
           cEstLotNegGrup = 'N';
        if (cEstLotNegGrup='N') then
           EXCEPTION EQLOTEEX01 'O LOTE '||rtrim(new.CODLOTE)||
              ' NÃO POSSUI SALDO P/COMPL. A OPERAÇÃO';
     end
     else if (cEstLotNeg='N') then
           EXCEPTION EQLOTEEX01 'O LOTE '||rtrim(new.CODLOTE)||
              ' NÃO POSSUI SALDO P/COMPL. A OPERAÇÃO';
  end
end
^

/* Trigger: EQMARCATGBU */
CREATE TRIGGER EQMARCATGBU FOR EQMARCA
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: EQMODGRADETGBU */
CREATE TRIGGER EQMODGRADETGBU FOR EQMODGRADE
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: EQMOVEXPTGBU */
CREATE TRIGGER EQMOVEXPTGBU FOR EQMOVEXP
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: EQMOVPRODTGAD */
CREATE TRIGGER EQMOVPRODTGAD FOR EQMOVPROD
ACTIVE AFTER DELETE POSITION 0
AS
  DECLARE VARIABLE SOPERADOR SMALLINT;
BEGIN
  IF (old.ESTOQMOVPROD = 'S') THEN
  BEGIN
      IF (old.TIPOMOVPROD = 'S') THEN
        SOPERADOR = -1;
      ELSE
        SOPERADOR = 1;
      EXECUTE PROCEDURE EQMOVPRODATEQSP(old.CODEMPPD, old.CODFILIALPD, old.CODPROD,
        old.CODEMPLE, old.CODFILIALLE, old.CODLOTE,
        old.CODEMPLE, old.CODFILIALLE, old.CODLOTE,
        :SOPERADOR, old.QTDMOVPROD, 0,
        old.CODEMPAX, old.CODFILIALAX, old.CODALMOX,
        old.CODEMPAX, old.CODFILIALAX, old.CODALMOX);
   END
 /* EXECUTE PROCEDURE EQMOVPRODATCUSTSP(old.CODEMPPD, old.CODFILIALPD, old.CODPROD, SOPERADOR); */
END
^

/* Trigger: EQMOVPRODTGAI */
CREATE TRIGGER EQMOVPRODTGAI FOR EQMOVPROD
ACTIVE AFTER INSERT POSITION 0
AS
DECLARE VARIABLE SOPERADOR SMALLINT;
BEGIN
  IF (new.ESTOQMOVPROD='S') THEN
  BEGIN
      IF (new.TIPOMOVPROD = 'S') THEN
         SOPERADOR = -1;
      ELSE
         SOPERADOR = 1;
      EXECUTE PROCEDURE EQMOVPRODATEQSP(new.CODEMPPD, new.CODFILIALPD, new.CODPROD,
        null, null, null,
        new.CODEMPLE, new.CODFILIALLE, new.CODLOTE,
        :SOPERADOR, 0, new.QTDMOVPROD,
        null, null, null,
        new.CODEMPAX, new.CODFILIALAX, new.CODALMOX);
  END
END
^

/* Trigger: EQMOVPRODTGAU */
CREATE TRIGGER EQMOVPRODTGAU FOR EQMOVPROD
ACTIVE AFTER UPDATE POSITION 0
AS
DECLARE VARIABLE SOPERADOR SMALLINT;
DECLARE VARIABLE NQTDMOVPRODOLD NUMERIC(15, 5);
DECLARE VARIABLE NQTDMOVPRODNEW NUMERIC(15, 5);
BEGIN
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT IS NOT NULL) ) ) ) THEN
  BEGIN

      IF ( ( old.ESTOQMOVPROD='S' ) OR (new.ESTOQMOVPROD='S') ) THEN
      BEGIN
          NQTDMOVPRODOLD = old.QTDMOVPROD;
          NQTDMOVPRODNEW = new.QTDMOVPROD;
          IF (new.TIPOMOVPROD = 'S') THEN /* Se for saída tem que diminuir do estoque */
            SOPERADOR = -1;
          ELSE
            SOPERADOR = 1;
          /* Caso o flag de controle de estoque tenha mudado */
          IF ( (old.ESTOQMOVPROD='S') AND (new.ESTOQMOVPROD='N') ) THEN
              NQTDMOVPRODNEW = 0;
          ELSE IF ( (old.ESTOQMOVPROD='N') AND (new.ESTOQMOVPROD='S') ) THEN
              NQTDMOVPRODOLD = 0;
          EXECUTE PROCEDURE EQMOVPRODATEQSP(new.CODEMPPD, new.CODFILIALPD, new.CODPROD,
            old.CODEMPLE, old.CODFILIALLE, old.CODLOTE,
            new.CODEMPLE, new.CODFILIALLE, new.CODLOTE,
            :SOPERADOR, NQTDMOVPRODOLD, NQTDMOVPRODNEW,
            old.CODEMPAX, old.CODFILIALAX, old.CODALMOX,
            new.CODEMPAX, new.CODFILIALAX, new.CODALMOX);
      END
   END
END
^

/* Trigger: EQMOVPRODTGBU */
CREATE TRIGGER EQMOVPRODTGBU FOR EQMOVPROD
ACTIVE BEFORE UPDATE POSITION 0
AS
BEGIN
  IF ( new.EMMANUT IS NULL) THEN
      new.EMMANUT='N';
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT IS NOT NULL) )) ) THEN
  BEGIN
     new.DTALT=cast('now' AS DATE);
     new.IDUSUALT=USER;
     new.HALT = cast('now' AS TIME);
  END
END
^

/* Trigger: EQPRODACESSOTGBU */
CREATE TRIGGER EQPRODACESSOTGBU FOR EQPRODACESSO
ACTIVE BEFORE UPDATE POSITION 0
AS
begin
  new.IDUSUALT=USER;
  new.DTALT=cast('now' AS DATE);
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: EQPRODPLANBU */
CREATE TRIGGER EQPRODPLANBU FOR EQPRODPLAN
ACTIVE BEFORE UPDATE POSITION 0
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);

end
^

/* Trigger: EQPRODUTOTGBI */
CREATE TRIGGER EQPRODUTOTGBI FOR EQPRODUTO
ACTIVE BEFORE INSERT POSITION 0
as
begin
  if (new.SLDPROD is null) then
     new.SLDPROD = 0;
  if (new.SLDRESPROD is null) then
     new.SLDRESPROD = 0;
  if (new.SLDCONSIGPROD is null) then
     new.SLDCONSIGPROD = 0;
  new.SLDLIQPROD = new.SLDPROD-new.SLDRESPROD-new.SLDCONSIGPROD;
end
^

/* Trigger: EQPRODUTOTGBU */
CREATE TRIGGER EQPRODUTOTGBU FOR EQPRODUTO
ACTIVE BEFORE UPDATE POSITION 0
as
  DECLARE VARIABLE ICODFILIAL INTEGER;
  DECLARE VARIABLE CESTNEG CHAR(1);
  DECLARE VARIABLE CESTNEGGRUPPREF CHAR(1);
  DECLARE VARIABLE CESTNEGGRUP CHAR(1);
  DECLARE VARIABLE ICODPROD INTEGER;
begin
  SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'SGPREFERE1') INTO :iCodFilial;
  SELECT ESTNEG, ESTNEGGRUP FROM SGPREFERE1
     WHERE CODEMP=new.CODEMP AND CODFILIAL=:iCodFilial
     INTO :cEstNeg, :cEstNegGrupPref;
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  if (new.SLDPROD is null) then
     new.SLDPROD = 0;
  if (new.SLDRESPROD is null) then
     new.SLDRESPROD = 0;
  if (new.SLDCONSIGPROD is null) then
     new.SLDCONSIGPROD = 0;
  new.SLDLIQPROD = new.SLDPROD-new.SLDRESPROD-new.SLDCONSIGPROD;
  if (cEstNeg Is null) then
      cEstNeg = 'N';
  if (cEstNegGrupPref is null) then
      cEstNegGrupPref = 'N';
  if ((new.SLDPROD < 0) AND (new.TIPOPROD='P') ) THEN
  begin
    if (cEstNegGrupPref = 'S') then
    begin
       SELECT ESTNEGGRUP FROM EQGRUPO
         WHERE CODEMP=new.CODEMPGP AND CODFILIAL=new.CODFILIALGP AND
            CODGRUP=new.CODGRUP INTO :CESTNEGGRUP;
       if (cEstNegGrup is null) then
          cEstNegGrup = 'N';
       if (cEstNegGrup='N') then
          EXCEPTION EQPRODUTOEX01 'O PROD. '||rtrim(cast(new.CODPROD as char(10)))
            ||'-'||substring(new.DESCPROD from 1 for 20)||
          ' NÃO POSSUI SALDO P/COMPL. A OPERAÇÃO';
    end
    else if (cEstNeg='N') then
          EXCEPTION EQPRODUTOEX01 'O PROD. '||rtrim(cast(new.CODPROD as char(10)))
            ||'-'||substring(new.DESCPROD from 1 for 20)||
          ' NÃO POSSUI SALDO P/COMPL. A OPERAÇÃO';
  end
  if ( new.REFPROD != old.REFPROD ) then
  begin
     SELECT FIRST 1 CODPROD FROM EQMOVPROD WHERE CODEMPPD=new.CODEMP AND
        CODFILIALPD=new.CODFILIAL AND CODPROD=new.CODPROD
          INTO :ICODPROD;
     if ( (ICODPROD IS NOT NULL) AND (ICODPROD=new.CODPROD) ) then
        EXCEPTION EQPRODUTOEX01 'REFERÊNCIA NÃO PODE SER ALTERADA. PRODUTO POSSUI MOVIMENTO!';
     else
        UPDATE EQCODALTPROD SET REFPROD=new.REFPROD WHERE CODEMP=new.CODEMP AND
          CODFILIAL=new.CODFILIAL AND CODPROD=new.CODPROD;
  end
end
^

/* Trigger: EQRMATGAI */
CREATE TRIGGER EQRMATGAI FOR EQRMA
ACTIVE AFTER INSERT POSITION 0
AS
begin
    new.DTINS=cast('now' AS DATE);
    new.IDUSUINS=user;
    new.HINS=cast('now' AS TIME);
end
^

/* Trigger: EQRMATGAU */
CREATE TRIGGER EQRMATGAU FOR EQRMA
ACTIVE AFTER UPDATE POSITION 0
AS
begin
    new.DTALT=cast('now' AS DATE);
    new.IDUSUALT=user;
    new.HALT=cast('now' AS TIME);
    if(new.sitrma='AF')  then
    begin
      update eqitrma set sititrma = 'AF' where codemp=new.codemp and codfilial=new.codfilial and codrma=new.codrma and sititrma!='AF';
    end
    else if (new.sitrma='CA')  then
    begin
      update eqitrma set sititrma = 'CA' where codemp=new.codemp and codfilial=new.codfilial and codrma=new.codrma and sititrma!='CA';
    end
    else if(new.sitaprovrma='AT')  then
    begin
      update eqitrma set sitaprovitrma = 'AT' where codemp=new.codemp and codfilial=new.codfilial and codrma=new.codrma and sitaprovitrma!='AT';
    end
    if(new.sitrma='EF')  then
    begin
      update eqitrma it set sititrma = 'EF',precoitrma=(select custompmprod from eqproduto where codemp=it.codemppd and codfilial=it.codfilialpd and codprod=it.codprod) where codemp=new.codemp and codfilial=new.codfilial and codrma=new.codrma and sititrma!='EF';
    end
    if(new.sitexprma='ET')  then
    begin
      update eqitrma set sitexpitrma = 'ET' where codemp=new.codemp and codfilial=new.codfilial and codrma=new.codrma and sitexpitrma!='ET';
    end
    if(new.codtipomov!=old.codtipomov) then
    begin
        update eqitrma it set precoitrma=(select custompmprod from eqproduto where codemp=it.codemppd and codfilial=it.codfilialpd and codprod=it.codprod)
            where codemp=new.codemp and codfilial=new.codfilial and codrma=new.codrma;
    end
end
^

/* Trigger: EQRMATGBU */
CREATE TRIGGER EQRMATGBU FOR EQRMA
ACTIVE BEFORE UPDATE POSITION 0
as
  DECLARE VARIABLE ICODEMPUSU INT;
  declare variable ICODFILIALUSU smallint;
  declare variable IDUSU char(8);
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  if((new.idusuaprov is null) and (new.sitaprovrma!=old.sitaprovrma)) then
  begin
    SELECT CODEMPUSU,CODFILIALUSU,IDUSUS FROM sgretinfousu(USER) into :ICODEMPUSU,:ICODFILIALUSU,:IDUSU;
    new.codempua = :ICODEMPUSU;
    new.codfilialua = :ICODFILIALUSU;
    new.idusuaprov = :IDUSU;
    new.dtaaprovrma = cast('now' AS DATE);
  end
  if((new.idusuexp is null) and (new.sitexprma!=old.sitexprma)) then
  begin
    SELECT CODEMPUSU,CODFILIALUSU,IDUSUS FROM sgretinfousu(USER) into :ICODEMPUSU,:ICODFILIALUSU,:IDUSU;
    new.codempue = :ICODEMPUSU;
    new.codfilialue = :ICODFILIALUSU;
    new.idusuexp = :IDUSU;
    new.dtaexprma = cast('now' AS DATE);
  end
end
^

/* Trigger: EQSALDOLOTETGBI */
CREATE TRIGGER EQSALDOLOTETGBI FOR EQSALDOLOTE
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
  if (new.SLDLOTE is null) then
     new.SLDLOTE = 0;
  if (new.SLDRESLOTE is null) then
     new.SLDRESLOTE = 0;
  if (new.SLDCONSIGLOTE is null) then
     new.SLDCONSIGLOTE = 0;
  new.SLDLIQLOTE = new.SLDLOTE-new.SLDRESLOTE-new.SLDCONSIGLOTE;
END
^

/* Trigger: EQSALDOLOTETGBU */
CREATE TRIGGER EQSALDOLOTETGBU FOR EQSALDOLOTE
ACTIVE BEFORE UPDATE POSITION 0
AS
BEGIN
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  if (new.SLDLOTE is null) then
     new.SLDLOTE = 0;
  if (new.SLDRESLOTE is null) then
     new.SLDRESLOTE = 0;
  if (new.SLDCONSIGLOTE is null) then
     new.SLDCONSIGLOTE = 0;
  new.SLDLIQLOTE = new.SLDLOTE-new.SLDRESLOTE-new.SLDCONSIGLOTE;
END
^

/* Trigger: EQSALDOPRODTGBI */
CREATE TRIGGER EQSALDOPRODTGBI FOR EQSALDOPROD
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
  if (new.SLDPROD is null) then
     new.SLDPROD = 0;
  if (new.SLDRESPROD is null) then
     new.SLDRESPROD = 0;
  if (new.SLDCONSIGPROD is null) then
     new.SLDCONSIGPROD = 0;
  new.SLDLIQPROD = new.SLDPROD-new.SLDRESPROD-new.SLDCONSIGPROD;
END
^

/* Trigger: EQSALDOPRODTGBU */
CREATE TRIGGER EQSALDOPRODTGBU FOR EQSALDOPROD
ACTIVE BEFORE UPDATE POSITION 0
AS
BEGIN
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  if (new.SLDPROD is null) then
     new.SLDPROD = 0;
  if (new.SLDRESPROD is null) then
     new.SLDRESPROD = 0;
  if (new.SLDCONSIGPROD is null) then
     new.SLDCONSIGPROD = 0;
  new.SLDLIQPROD = new.SLDPROD-new.SLDRESPROD-new.SLDCONSIGPROD;
END
^

/* Trigger: EQTIPOEXPTGBU */
CREATE TRIGGER EQTIPOEXPTGBU FOR EQTIPOEXP
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: EQTIPOMOVTGBI */
CREATE TRIGGER EQTIPOMOVTGBI FOR EQTIPOMOV
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
  IF ( (new.TIPOMOV='IV') AND (new.ESTIPOMOV!='I') ) THEN
     EXCEPTION EQTIPOMOVEX01 'FLUXO INCOMPATÍVEL COM O TIPO DE MOVIMENTO';
  ELSE IF (new.ESTIPOMOV = 'E') THEN
  BEGIN
    IF (new.CODTAB IS NOT NULL) THEN
    BEGIN
      EXCEPTION EQTIPOMOVEX01;
    END
  END
  ELSE
  BEGIN
    IF (new.CODTAB IS NULL) THEN
    BEGIN
      EXCEPTION EQTIPOMOVEX02;
    END
  END
END
^

/* Trigger: EQTIPOMOVTGBU */
CREATE TRIGGER EQTIPOMOVTGBU FOR EQTIPOMOV
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT = cast('now' AS DATE);
  new.IDUSUALT = USER;
  new.HALT = cast('now' AS TIME);
  IF ( (new.TIPOMOV='IV') AND (new.ESTIPOMOV!='I') ) THEN
     EXCEPTION EQTIPOMOVEX01 'FLUXO INCOMPATÍVEL COM O TIPO DE MOVIMENTO';
  ELSE IF (new.ESTIPOMOV = 'E') THEN
  BEGIN
    IF (new.CODTAB IS NOT NULL) THEN
    BEGIN
      EXCEPTION EQTIPOMOVEX01;
    END
  END
  ELSE
  BEGIN
    IF (new.CODTAB IS NULL) THEN
    BEGIN
      EXCEPTION EQTIPOMOVEX02;
    END
  END
  IF (old.ESTOQTIPOMOV != new.ESTOQTIPOMOV) THEN
  BEGIN
    IF ((EXISTS (SELECT CODVENDA FROM VDVENDA WHERE CODTIPOMOV=new.CODTIPOMOV
      AND CODEMPTM=new.CODEMP AND CODFILIALTM=new.CODFILIAL)) OR
        (EXISTS (SELECT CODCOMPRA FROM CPCOMPRA WHERE CODTIPOMOV=new.CODTIPOMOV
      AND CODEMPTM=new.CODEMP AND CODFILIALTM=new.CODFILIAL))) THEN
    BEGIN
      EXCEPTION EQTIPOMOVEX01 'JA EXISTE MOVIMENTOS PARA ESTE TIPO DE MOVIMENTO!';
    END
  END
end
^

/* Trigger: EQUNIDADETGBU */
CREATE TRIGGER EQUNIDADETGBU FOR EQUNIDADE
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: EQVARGRADETGBU */
CREATE TRIGGER EQVARGRADETGBU FOR EQVARGRADE
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: FNBANCOTGBU */
CREATE TRIGGER FNBANCOTGBU FOR FNBANCO
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: FNCCTGBI */
CREATE TRIGGER FNCCTGBI FOR FNCC
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
   IF (new.NIVELCC=10) THEN
   BEGIN
     SELECT ISEQ FROM SPGERANUM(new.CODEMP,new.CODFILIAL,'CC') INTO new.CODREDCC;
   END
END
^

/* Trigger: FNCCTGBU */
CREATE TRIGGER FNCCTGBU FOR FNCC
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: FNCONTATGBU */
CREATE TRIGGER FNCONTATGBU FOR FNCONTA
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: FNCOTMOEDATGBU */
CREATE TRIGGER FNCOTMOEDATGBU FOR FNCOTMOEDA
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: FNFBNCODRETTGBU */
CREATE TRIGGER FNFBNCODRETTGBU FOR FNFBNCODRET
ACTIVE BEFORE UPDATE POSITION 0
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: FNHISTPADTGBU */
CREATE TRIGGER FNHISTPADTGBU FOR FNHISTPAD
ACTIVE BEFORE UPDATE POSITION 0
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: FNITPAGARTGAD */
CREATE TRIGGER FNITPAGARTGAD FOR FNITPAGAR
ACTIVE AFTER DELETE POSITION 0
AS
BEGIN
  UPDATE FNPAGAR SET VLRPAG = VLRPAG - old.VLRITPAG,
         VLRDESCPAG = VLRDESCPAG - old.VLRDESCITPAG,
         VLRMULTAPAG = VLRMULTAPAG  - old.VLRMULTAITPAG,
         VLRJUROSPAG = VLRJUROSPAG - old.VLRJUROSITPAG,
         VLRDEVPAG = VLRDEVPAG - old.VLRDEVITPAG,
         VLRADICPAG = VLRADICPAG - old.VLRADICITPAG,
         VLRPAGOPAG = VLRPAGOPAG - old.VLRPAGOITPAG,
         VLRPARCPAG = VLRPARCPAG - old.VLRPARCITPAG,
         VLRAPAGPAG = VLRAPAGPAG - old.VLRAPAGITPAG
         WHERE CODPAG=old.CODPAG
         AND CODEMP=old.CODEMP AND CODFILIAL=old.CODFILIAL;
END
^

/* Trigger: FNITPAGARTGAU */
CREATE TRIGGER FNITPAGARTGAU FOR FNITPAGAR
ACTIVE AFTER UPDATE POSITION 0
AS

BEGIN

  UPDATE FNPAGAR SET VLRPAG = VLRPAG - old.VLRITPAG + new.VLRITPAG,
      VLRDESCPAG = VLRDESCPAG - old.VLRDESCITPAG + new.VLRDESCITPAG,
      VLRMULTAPAG = VLRMULTAPAG - old.VLRMULTAITPAG + new.VLRMULTAITPAG,
      VLRJUROSPAG = VLRJUROSPAG - old.VLRJUROSITPAG + new.VLRJUROSITPAG,
      VLRDEVPAG = VLRDEVPAG - old.VLRDEVITPAG + new.VLRDEVITPAG,
      VLRADICPAG = VLRADICPAG - old.VLRADICITPAG + new.VLRADICITPAG,
      VLRPARCPAG = VLRPARCPAG - old.VLRPARCITPAG + new.VLRPARCITPAG,
      VLRPAGOPAG = VLRPAGOPAG - old.VLRPAGOITPAG + new.VLRPAGOITPAG,
      VLRAPAGPAG = VLRAPAGPAG - old.VLRAPAGITPAG + new.VLRAPAGITPAG
      WHERE CODPAG=new.CODPAG
           AND CODEMP=new.CODEMP AND CODFILIAL=new.CODFILIAL;
END
^

/* Trigger: FNITPAGARTGBD */
CREATE TRIGGER FNITPAGARTGBD FOR FNITPAGAR
ACTIVE BEFORE DELETE POSITION 0
AS
BEGIN
  IF (old.STATUSITPAG = 'PP') THEN
    EXCEPTION FNPAGAREX01;
END
^

/* Trigger: FNITPAGARTGBU */
CREATE TRIGGER FNITPAGARTGBU FOR FNITPAGAR
ACTIVE BEFORE UPDATE POSITION 0
AS
  DECLARE VARIABLE IFILIALPAG INTEGER;
  DECLARE VARIABLE ICODFOR INTEGER;
  DECLARE VARIABLE ICODEMPFR INTEGER;
  DECLARE VARIABLE ICODFILIALFR INTEGER;
BEGIN
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'FNPAGAR') INTO IFILIALPAG;
  IF ((old.STATUSITPAG IN ('PP','PL') )  AND (new.STATUSITPAG='P1') ) THEN
  BEGIN
    DELETE FROM FNLANCA WHERE CODPAG=new.CODPAG AND NPARCPAG=new.NPARCPAG
           AND CODEMPPG=new.CODEMP AND CODFILIALPG = new.CODFILIAL
           AND CODEMP=new.CODEMP AND CODFILIAL=:IFILIALPAG;
    new.VLRPAGOITPAG = 0;
    new.DTPAGOITPAG = NULL;
  END

  new.VLRITPAG = new.VLRPARCITPAG - new.VLRDESCITPAG - new.VLRDEVITPAG + new.VLRJUROSITPAG +
  new.VLRMULTAITPAG + new.VLRADICITPAG;
  new.VLRAPAGITPAG = new.VLRITPAG - new.VLRPAGOITPAG;
  
  if (new.VLRAPAGITPAG < 0) then /* se o valor a pagar for maior que zero */
    new.VLRAPAGITPAG = 0;  /* então valor a pagar será zero */
  if ( (new.VLRAPAGITPAG=0) AND (new.VLRITPAG>0) ) then /* se o valor a pagar for igual a zero e existir valor na parcela*/
    new.STATUSITPAG = 'PP';  /* então o status será PP(pagamento completo) */
  else if ( (new.VLRPAGOITPAG>0) AND (new.VLRITPAG>0) ) then /* caso contrário e o valor pago maior que zero e existir valor na parcela*/
    new.STATUSITPAG = 'PL'; /*  então o status será PL(pagamento parcial) */

  /* faz o lançamento */
  SELECT CODFOR,CODEMPFR,CODFILIALFR FROM FNPAGAR WHERE CODEMP=new.CODEMP AND CODFILIAL=new.CODFILIAL AND CODPAG=new.CODPAG
    INTO ICODFOR,ICODEMPFR,ICODFILIALFR;
  IF ((old.STATUSITPAG='P1' AND new.STATUSITPAG in ('PP','PL'))
        OR (old.STATUSITPAG in ('PP','PL') AND new.STATUSITPAG in ('PP','PL') AND
        new.VLRPAGOITPAG > 0))THEN
  BEGIN
    EXECUTE PROCEDURE FNADICLANCASP02(new.CodPag,new.NParcPag,new.NumConta,new.CODEMPCA,new.CODFILIALCA,:ICODFOR,:ICODEMPFR,:ICODFILIALFR,
                           new.CodPlan,new.CODEMPPN,new.CODFILIALPN,new.AnoCC,new.CodCC,new.CODEMPCC,new.CODFILIALCC,
                           new.DtPagoItPag,new.DocLancaItPag,new.ObsItPag,new.VlrPagoItPag,new.CODEMP,new.CODFILIAL);

    /* Altera o valor pago e o valor a pagar */
    new.VLRPAGOITPAG = new.VLRPAGOITPAG + old.VLRPAGOITPAG;
    new.VLRAPAGITPAG = new.VLRITPAG - new.VLRPAGOITPAG;

    if (new.VLRAPAGITPAG < 0) then /* se o valor a pagar for maior que zero */
      new.VLRAPAGITPAG = 0;  /* então valor a pagar será zero */
    if (new.VLRAPAGITPAG=0) then /* se o valor a pagar for igual a zero */
      new.STATUSITPAG = 'PP';  /* então o status será PP(pagamento completo) */
    else if (new.VLRPAGOITPAG>0) then /* caso contrário e o valor pago maior que zero */
      new.STATUSITPAG = 'PL'; /*  então o status será PL(pagamento parcial) */

  END
  ELSE IF ((old.STATUSITPAG='PP') AND (new.STATUSITPAG='PP')) THEN
  BEGIN
     EXCEPTION FNPAGAREX01;
  END

END
^

/* Trigger: FNITRECEBERTGAI */
CREATE TRIGGER FNITRECEBERTGAI FOR FNITRECEBER
ACTIVE AFTER INSERT POSITION 0
AS
BEGIN
  EXECUTE PROCEDURE vdgeracomissaosp(new.CODEMP, new.CODFILIAL, new.CODREC, new.NPARCITREC,
    new.VLRCOMIITREC, new.DTVENCITREC);
END
^

/* Trigger: FNITRECEBERTGAU */
CREATE TRIGGER FNITRECEBERTGAU FOR FNITRECEBER
ACTIVE AFTER UPDATE POSITION 0
AS
DECLARE VARIABLE ICODCLI INTEGER;
DECLARE VARIABLE ICODEMPCL INTEGER;
DECLARE VARIABLE ICODFILIALCL INTEGER;
BEGIN
  IF ((old.STATUSITREC='R1' AND new.STATUSITREC in ('RP','RL'))
     OR (old.STATUSITREC in ('RP','RL') AND new.STATUSITREC in ('RP','RL') AND new.VLRPAGOITREC > 0)) THEN
  BEGIN
     SELECT CODCLI,CODEMPCL,CODFILIALCL FROM FNRECEBER WHERE CODEMP=new.CODEMP AND
        CODFILIAL=new.CODFILIAL AND CODREC=new.CODREC
        INTO ICODCLI,ICODEMPCL,ICODFILIALCL;
     IF ((new.VLRPAGOITREC-old.VLRPAGOITREC) > 0) THEN
     BEGIN
        EXECUTE PROCEDURE FNADICLANCASP01(new.CodRec,new.NParcItRec,new.PDVITREC,new.NumConta,new.CODEMPCA,new.CODFILIALCA,:ICODCLI,:ICODEMPCL,:ICODFILIALCL,
                           new.CodPlan,new.CODEMPPN,new.CODFILIALPN,new.ANOCC,new.CODCC,new.CODEMPCC,new.CODFILIALCC,new.DtPagoItRec,new.DocLancaItRec,
                           SUBSTRING(new.ObsItRec FROM 1 FOR 50),new.VlrPagoItRec-old.VlrPagoItRec,new.CODEMP,new.CODFILIAL);
     END
     IF (new.STATUSITREC = 'RP') THEN
     BEGIN
         UPDATE VDCOMISSAO SET STATUSCOMI='C2'
            WHERE CODREC=old.CODREC
            AND CODEMPRC=old.CODEMP
            AND CODFILIALRC=old.CODFILIAL
            AND NPARCITREC=old.NPARCITREC
            AND NOT STATUSCOMI IN ('CP','C2')
            AND CODEMP=old.CODEMP;
     END
  END
  ELSE IF (old.VLRCOMIITREC != new.VLRCOMIITREC) THEN
  BEGIN
     EXECUTE PROCEDURE vdgeracomissaosp(new.CODEMP, new.CODFILIAL, new.CODREC,
        new.NPARCITREC, new.VLRCOMIITREC, new.DTVENCITREC);
  END
  IF ( (new.ALTUSUITREC='S') AND ( (old.VLRITREC!=new.VLRITREC) OR
       (old.VLRDESCITREC!=new.VLRDESCITREC) OR (old.VLRMULTAITREC!=new.VLRMULTAITREC) OR
       (old.VLRJUROSITREC!=new.VLRJUROSITREC) OR (old.VLRPARCITREC!=new.VLRPARCITREC) OR
       (old.VLRPAGOITREC!=new.VLRPAGOITREC) OR (old.VLRAPAGITREC!=new.VLRAPAGITREC) ) ) THEN
     UPDATE FNRECEBER SET VLRREC = VLRREC - old.VLRITREC + new.VLRITREC,
         VLRDESCREC = VLRDESCREC - old.VLRDESCITREC + new.VLRDESCITREC,
         VLRMULTAREC = VLRMULTAREC - old.VLRMULTAITREC + new.VLRMULTAITREC,
         VLRJUROSREC = VLRJUROSREC - old.VLRJUROSITREC + new.VLRJUROSITREC,
         VLRDEVREC = VLRDEVREC - old.VLRDEVITREC + new.VLRDEVITREC,
         VLRPARCREC = VLRPARCREC - old.VLRPARCITREC + new.VLRPARCITREC,
         VLRPAGOREC = VLRPAGOREC - old.VLRPAGOITREC + new.VLRPAGOITREC,
         VLRAPAGREC = VLRAPAGREC - old.VLRAPAGITREC + new.VLRAPAGITREC,
         ALTUSUREC = 'S' WHERE CODREC=new.CODREC
        AND CODEMP=new.CODEMP AND CODFILIAL=new.CODFILIAL;
END
^

/* Trigger: FNITRECEBERTGBD */
CREATE TRIGGER FNITRECEBERTGBD FOR FNITRECEBER
ACTIVE BEFORE DELETE POSITION 0
AS
DECLARE VARIABLE IFILIALCOMI INTEGER;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(old.CODEMP,'VDCOMISSAO') INTO IFILIALCOMI;
  IF (old.STATUSITREC not in ('RP','RL') ) THEN
    DELETE FROM VDCOMISSAO WHERE CODREC=old.CODREC AND NPARCITREC=old.NPARCITREC
           AND CODEMP=old.CODEMP AND CODFILIAL = :IFILIALCOMI;
  ELSE
    EXCEPTION FNITRECEBEREX01;
END
^

/* Trigger: FNITRECEBERTGBI */
CREATE TRIGGER FNITRECEBERTGBI FOR FNITRECEBER
ACTIVE BEFORE INSERT POSITION 0
AS
begin
  if (new.vlrparcitrec is null) then
     new.vlrparcitrec = 0;
  if (new.vlrdescitrec is null) then
     new.vlrdescitrec = 0;
  if (new.vlrjurositrec is null) then
     new.vlrjurositrec = 0;
  if (new.vlrmultaitrec is null) then
     new.vlrmultaitrec = 0;
  new.vlritrec = new.vlrparcitrec - new.vlrdescitrec - new.vlrdevitrec + new.vlrjurositrec + new.vlrmultaitrec;
  new.vlrapagitrec = new.vlritrec - new.vlrpagoitrec;
  if (new.vlrapagitrec<0) then
      new.vlrapagitrec = 0;
end
^

/* Trigger: FNITRECEBERTGBU */
CREATE TRIGGER FNITRECEBERTGBU FOR FNITRECEBER
ACTIVE BEFORE UPDATE POSITION 0
AS
DECLARE VARIABLE SCODFILIALCI SMALLINT;
DECLARE VARIABLE SCODFILIALLC SMALLINT;
DECLARE VARIABLE SCODFILIALPF SMALLINT;
DECLARE VARIABLE CCOMISPDUPL CHAR(1);
DECLARE VARIABLE NVLRPARCREC NUMERIC(15, 5);
DECLARE VARIABLE NVLRCOMIREC NUMERIC(15, 5);  
DECLARE VARIABLE ESTITRECALTDTVENC CHAR(1);    
DECLARE VARIABLE AUTOBAIXAPARC CHAR(1);
BEGIN
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  IF ( new.ALTUSUITREC IS NULL ) THEN /* Para não permitir flag de usuário nulo */
     new.ALTUSUITREC = 'S';
  IF ( (old.STATUSITREC IN ('RP','RL') )  AND (new.STATUSITREC='R1') ) THEN
  BEGIN
    SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'FNCOMISSAO') INTO :SCODFILIALCI;
    SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'FNLANCA') INTO :SCODFILIALLC;
    UPDATE VDCOMISSAO SET STATUSCOMI='C1'
           WHERE CODREC=new.CODREC AND NPARCITREC=new.NPARCITREC
           AND CODEMPRC = new.CODEMP AND CODFILIALRC=new.CODFILIAL
           AND CODEMP=new.CODEMP AND CODFILIAL=:SCODFILIALCI
           AND STATUSCOMI NOT IN ('CE') AND TIPOCOMI='R';
    DELETE FROM FNLANCA WHERE CODREC=new.CODREC AND NPARCITREC=new.NPARCITREC
           AND CODEMPRC= new.CODEMP AND CODFILIALRC=new.CODFILIAL
           AND CODEMP=new.CODEMP AND CODFILIAL = :SCODFILIALLC;
    new.VLRPAGOITREC = 0;
  END

  SELECT ESTITRECALTDTVENC FROM SGPREFERE1 WHERE CODEMP=new.CODEMP AND CODFILIAL=new.CODFILIAL INTO :ESTITRECALTDTVENC;
  SELECT ITPP.AUTOBAIXAPARC FROM FNPARCPAG ITPP, FNRECEBER R
    WHERE ITPP.CODEMP=R.CODFILIALPG AND ITPP.CODFILIAL=R.CODFILIALPG AND ITPP.CODPLANOPAG=R.CODPLANOPAG AND
      ITPP.NROPARCPAG=new.NPARCITREC AND
       R.CODEMP=new.CODEMP AND R.CODFILIAL=new.CODFILIAL AND R.CODREC=new.CODREC
    INTO :AUTOBAIXAPARC;

  IF ((ESTITRECALTDTVENC='S') AND
      (AUTOBAIXAPARC='S') AND
      (old.DTVENCITREC<>new.DTVENCITREC)) THEN
  BEGIN
    SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'FNCOMISSAO') INTO :SCODFILIALCI;
    SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'FNLANCA') INTO :SCODFILIALLC;
    UPDATE VDCOMISSAO SET STATUSCOMI='C1'
           WHERE CODREC=new.CODREC AND NPARCITREC=new.NPARCITREC
           AND CODEMPRC = new.CODEMP AND CODFILIALRC=new.CODFILIAL
           AND CODEMP=new.CODEMP AND CODFILIAL=:SCODFILIALCI
           AND STATUSCOMI NOT IN ('CE') AND TIPOCOMI='R';
    DELETE FROM FNLANCA WHERE CODREC=new.CODREC AND NPARCITREC=new.NPARCITREC
           AND CODEMPRC= new.CODEMP AND CODFILIALRC=new.CODFILIAL
           AND CODEMP=new.CODEMP AND CODFILIAL = :SCODFILIALLC;
    new.STATUSITREC = 'RL';
    new.VLRPAGOITREC = 0;
  END

  new.VLRITREC = new.VLRPARCITREC - new.VLRDESCITREC - new.VLRDEVITREC + new.VLRJUROSITREC + new.VLRMULTAITREC;
  new.VLRAPAGITREC = new.VLRITREC - new.VLRPAGOITREC;
  if (new.VLRAPAGITREC < 0) then /* se o valor a pagar for maior que zero */
    new.VLRAPAGITREC = 0;  /* então valor a pagar será zero */
  if (new.VLRAPAGITREC=0) then /* se o valor a pagar for igual a zero */
    new.STATUSITREC = 'RP';  /* então o status será RP(pagamento completo) */
  else if (new.VLRPAGOITREC>0) then /* caso contrário e o valor pago maior que zero */
    new.STATUSITREC = 'RL'; /*  então o status será RL(pagamento parcial) */
  /*
    Esta seção é destinada e ajustar as comissões conforme os valores de parcelas
    caso o preferências esteja ajustado para isso.
  */
  IF ( (new.VLRPARCITREC!=old.VLRPARCITREC) AND (new.VLRPARCITREC!=0) ) THEN
  BEGIN
     SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'SGPREFERE1') INTO :SCODFILIALPF;
     SELECT P1.COMISPDUPL  FROM SGPREFERE1 P1
         WHERE P1.CODEMP=new.CODEMP AND P1.CODFILIAL=:SCODFILIALPF INTO :CCOMISPDUPL;
     IF (CCOMISPDUPL='S') THEN
     BEGIN
        SELECT V.VLRLIQVENDA, R.VLRCOMIREC FROM FNRECEBER R, VDVENDA V
          WHERE R.CODEMP=new.CODEMP AND R.CODFILIAL=new.CODFILIAL AND
              R.CODREC=new.CODREC AND V.CODEMP=R.CODEMPVA AND V.CODFILIAL=R.CODFILIALVA AND
              V.TIPOVENDA=R.TIPOVENDA AND V.CODVENDA=R.CODVENDA INTO :NVLRPARCREC, :NVLRCOMIREC;
        IF (NVLRPARCREC!=0) THEN
          new.VLRCOMIITREC = cast( new.VLRPARCITREC * :NVLRCOMIREC / :NVLRPARCREC as NUMERIC(15, 5) );
     END
  END
  IF ((old.IMPRECIBOITREC='N') AND (new.IMPRECIBOITREC='S') AND (new.RECIBOITREC IS NULL)) THEN
  BEGIN
     SELECT ISEQ FROM SPGERANUM(new.CODEMP,new.CODFILIAL,'RB') INTO new.RECIBOITREC;
  END
END
^

/* Trigger: FNITTBJUROSTGBU */
CREATE TRIGGER FNITTBJUROSTGBU FOR FNITTBJUROS
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: FNLANCATGAI */
CREATE TRIGGER FNLANCATGAI FOR FNLANCA
ACTIVE AFTER INSERT POSITION 0
AS
DECLARE VARIABLE IFILIALPLAN INTEGER;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'FNPLANEJAMENTO') INTO IFILIALPLAN;
  INSERT INTO FNSUBLANCA (CODEMP,CODFILIAL,CODLANCA,CODSUBLANCA,CODEMPPN,CODFILIALPN,CODPLAN,DTPREVSUBLANCA,DATASUBLANCA,VLRSUBLANCA,ORIGSUBLANCA,FLAG)
                       VALUES (new.CODEMP,new.CODFILIAL,new.CODLANCA,0,new.CODEMP,:IFILIALPLAN,new.CODPLAN,new.DTPREVLANCA,new.DATALANCA,new.VLRLANCA,'S',new.FLAG);
END
^

/* Trigger: FNLANCATGAU */
CREATE TRIGGER FNLANCATGAU FOR FNLANCA
ACTIVE AFTER UPDATE POSITION 0
AS
BEGIN
  UPDATE FNSUBLANCA SET DTPREVSUBLANCA=new.DTPREVLANCA,
         DATASUBLANCA=new.DATALANCA,VLRSUBLANCA=new.VLRLANCA,FLAG=new.FLAG
         WHERE CODLANCA=old.CODLANCA AND CODSUBLANCA=0
         AND CODEMP=old.CODEMP AND CODFILIAL=old.CODFILIAL;
END
^

/* Trigger: FNLANCATGBD */
CREATE TRIGGER FNLANCATGBD FOR FNLANCA
ACTIVE BEFORE DELETE POSITION 0
AS
BEGIN
  DELETE FROM FNSUBLANCA WHERE CODLANCA=old.CODLANCA
         AND CODEMP=old.CODEMP AND CODFILIAL = old.CODFILIAL;
END
^

/* Trigger: FNLANCATGBI */
CREATE TRIGGER FNLANCATGBI FOR FNLANCA
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
  new.STATUSLANCA = 'L1';
  IF (new.HISTLANCA IS NULL) THEN
    new.HISTLANCA = new.HISTBLANCA;
  IF (new.DTPREVLANCA IS NULL) THEN
    new.DTPREVLANCA = new.DATALANCA;
END
^

/* Trigger: FNLANCATGBU */
CREATE TRIGGER FNLANCATGBU FOR FNLANCA
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: FNLIBCREDTGBI */
CREATE TRIGGER FNLIBCREDTGBI FOR FNLIBCRED
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'SGUSUARIO') INTO new.CODFILIALUS;
  new.CODEMPUS = new.CODEMP;
  new.IDUSU=lower(USER);
END
^

/* Trigger: FNLIBCREDTGBU */
CREATE TRIGGER FNLIBCREDTGBU FOR FNLIBCRED
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: FNMODBOLETOTGBU */
CREATE TRIGGER FNMODBOLETOTGBU FOR FNMODBOLETO
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: FNMOEDATGBU */
CREATE TRIGGER FNMOEDATGBU FOR FNMOEDA
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: FNPAGARTGAI */
CREATE TRIGGER FNPAGARTGAI FOR FNPAGAR
ACTIVE AFTER INSERT POSITION 0
AS
DECLARE VARIABLE dVlrPAG NUMERIC(15, 5);
DECLARE VARIABLE dPercPag NUMERIC(11,6);
DECLARE VARIABLE dResto NUMERIC(15, 5);
DECLARE VARIABLE iNumParc INTEGER;
DECLARE VARIABLE iDiasPag INTEGER;
DECLARE VARIABLE i INTEGER;
DECLARE VARIABLE IFILIALPP INTEGER;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'FNPLANOPAG') INTO IFILIALPP;
  IF (new.VLRPAG IS NULL) THEN new.VLRPAG = 0;
  IF (new.VLRDESCPAG IS NULL) THEN new.VLRDESCPAG = 0;
  IF (new.VLRJUROSPAG IS NULL) THEN new.VLRJUROSPAG = 0;
  IF (new.VLRMULTAPAG IS NULL) THEN new.VLRMULTAPAG = 0;
  IF (new.VLRPARCPAG IS NULL) THEN new.VLRPARCPAG = 0;
  IF (new.VLRAPAGPAG IS NULL) THEN new.VLRAPAGPAG = 0;
  IF (new.VLRPAGOPAG IS NULL) THEN new.VLRPAGOPAG = 0;
  i = 0;
  dResto = new.VLRPAG;
  SELECT PARCPLANOPAG FROM FNPLANOPAG WHERE CODPLANOPAG=new.CODPLANOPAG
         AND CODEMP=new.CODEMP AND CODFILIAL = :IFILIALPP INTO :iNumParc;
  FOR SELECT PERCPAG,DIASPAG FROM FNPARCPAG WHERE CODPLANOPAG=new.CODPLANOPAG
             AND CODEMP=new.CODEMP AND CODFILIAL = :IFILIALPP ORDER BY DIASPAG
             INTO :dPercPag,:iDiasPag
             DO
  BEGIN
    i = i+1;
    dVlrPAG = cast(cast(new.VLRPAG*dPercPag as NUMERIC(15, 5))/100 AS NUMERIC(15, 5));
    dResto = dResto-dVlrPAG;
    IF (i = iNumParc) THEN
    BEGIN
      dVlrPAG=dVlrPAG+dResto;
    END
    INSERT INTO FNITPAGAR (CODEMP,CODFILIAL,CODPAG,NPARCPAG,VLRITPAG,VLRDESCITPAG,VLRMULTAITPAG,
                           VLRJUROSITPAG,VLRPARCITPAG,VLRPAGOITPAG,VLRAPAGITPAG,
                           DTITPAG,DTVENCITPAG,STATUSITPAG,VLRADICITPAG,FLAG,OBSITPAG,
                           CODEMPTC,CODFILIALTC,CODTIPOCOB) VALUES
                           (new.CODEMP,new.CODFILIAL,new.CODPAG,:i,:dVlrPAG,0,0,0,:dVlrPAG,0,:dVlrPAG,
                            new.DATAPAG,new.DATAPAG+:iDiasPag,'P1',new.VLRADICPAG,new.FLAG,new.OBSPAG,
                            new.CODEMPTC,new.CODFILIALTC,new.CODTIPOCOB);
  END
  new.NROPARCPAG = :i;
END
^

/* Trigger: FNPAGARTGBD */
CREATE TRIGGER FNPAGARTGBD FOR FNPAGAR
ACTIVE BEFORE DELETE POSITION 0
AS
BEGIN
  DELETE FROM FNITPAGAR WHERE CODPAG = old.CODPAG
         AND CODEMP=old.CODEMP AND CODFILIAL = old.CODFILIAL;
END
^

/* Trigger: FNPAGARTGBI */
CREATE TRIGGER FNPAGARTGBI FOR FNPAGAR
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
  IF (new.VLRDESCPAG IS NULL) THEN new.VLRDESCPAG = 0;
  IF (new.VLRJUROSPAG IS NULL) THEN new.VLRJUROSPAG = 0;
  IF (new.VLRMULTAPAG IS NULL) THEN new.VLRMULTAPAG = 0;
  IF (new.VLRPARCPAG IS NULL) THEN new.VLRPARCPAG = 0;
  IF (new.VLRPAGOPAG IS NULL) THEN new.VLRPAGOPAG = 0;
  IF (new.STATUSPAG IS NULL) THEN new.STATUSPAG = 'P1';
  new.VLRPAG = new.VLRPARCPAG - new.VLRDESCPAG - new.VLRDEVPAG + new.VLRJUROSPAG + new.VLRADICPAG +
  new.VLRMULTAPAG;
  new.VLRAPAGPAG = new.VLRPAG - new.VLRPAGOPAG;
END
^

/* Trigger: FNPAGARTGBU */
CREATE TRIGGER FNPAGARTGBU FOR FNPAGAR
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: FNPAGTOCOMITGAI */
CREATE TRIGGER FNPAGTOCOMITGAI FOR FNPAGTOCOMI
ACTIVE AFTER INSERT POSITION 0
AS
  DECLARE VARIABLE iCodLanca INTEGER;
  DECLARE VARIABLE sCodPlanConta CHAR(13);
  DECLARE VARIABLE iPlanEmp INTEGER;
  DECLARE VARIABLE iPlanFilial INTEGER;
  DECLARE VARIABLE IFILIALLANCA INTEGER;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'FNLANCA') INTO IFILIALLANCA;
  SELECT CODPLAN,CODEMP,CODFILIAL FROM FNCONTA WHERE NUMCONTA=new.NUMCONTA
         AND CODEMP=new.CODEMPCA AND CODFILIAL = new.CODFILIALCA INTO :sCodPlanConta,:iPlanEmp,:iPlanFilial;
  SELECT ISEQ FROM SPGERANUM(new.CODEMP,new.CODFILIAL,'LA') INTO :iCodLanca;
  INSERT INTO FNLANCA (CODEMP,CODFILIAL,CODLANCA,CODEMPCI,CODFILIALCI,CODPCOMI,CODEMPPN,CODFILIALPN,CODPLAN,DATALANCA,DOCLANCA,
                     HISTBLANCA,DTPREVLANCA,VLRLANCA,FLAG)
            VALUES (new.CODEMP,new.CODFILIAL,:iCodLanca,new.CODEMP,new.CODFILIAL,new.CODPCOMI,:iPlanEmp,:iPlanFilial,:sCodPlanConta,new.DATAPCOMI,
                   new.DOCPCOMI,new.OBSPCOMI,new.DATAPCOMI,0,new.FLAG);
  INSERT INTO FNSUBLANCA (CODEMP,CODFILIAL,CODLANCA,CODSUBLANCA,CODEMPPN,CODFILIALPN,CODPLAN,ORIGSUBLANCA,DATASUBLANCA,DTPREVSUBLANCA,VLRSUBLANCA,FLAG)
            VALUES (new.CODEMP,new.CODFILIAL,:iCodLanca,1,new.CODEMPPN,new.CODFILIALPN,new.CODPLAN,'S',new.DATAPCOMI,new.DATAPCOMI,new.VLRPCOMI,new.FLAG);
END
^

/* Trigger: FNPAGTOCOMITGBD */
CREATE TRIGGER FNPAGTOCOMITGBD FOR FNPAGTOCOMI
ACTIVE BEFORE DELETE POSITION 0
AS
DECLARE VARIABLE IFILIALLANCA INTEGER;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(old.CODEMP,'FNLANCA') INTO IFILIALLANCA;
  DELETE FROM FNLANCA WHERE CODPCOMI=old.codpcomi
         AND CODEMPCI=old.CODEMP AND CODFILIALCI=old.CODFILIAL
         AND CODEMP=old.CODEMP AND CODFILIAL=:IFILIALLANCA;
END
^

/* Trigger: FNPAGTOCOMITGBU */
CREATE TRIGGER FNPAGTOCOMITGBU FOR FNPAGTOCOMI
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: FNPARCPAGTGBU */
CREATE TRIGGER FNPARCPAGTGBU FOR FNPARCPAG
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: FNPLANEJAMENTOTGBI */
CREATE TRIGGER FNPLANEJAMENTOTGBI FOR FNPLANEJAMENTO
ACTIVE BEFORE INSERT POSITION 0
AS
DECLARE VARIABLE iCodredplan Integer;
BEGIN
   IF (new.NIVELPLAN=6) THEN
   BEGIN
     iCodredplan = 0;
     SELECT MAX(CODREDPLAN) FROM FNPLANEJAMENTO WHERE CODEMP=new.CODEMP
            AND CODFILIAL = new.CODFILIAL INTO :iCodredplan;
     new.CODREDPLAN = iCodredplan + 1;
   END
END
^

/* Trigger: FNPLANEJAMENTOTGBU */
CREATE TRIGGER FNPLANEJAMENTOTGBU FOR FNPLANEJAMENTO
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: FNPLANOPAGTGAI */
CREATE TRIGGER FNPLANOPAGTGAI FOR FNPLANOPAG
ACTIVE AFTER INSERT POSITION 0
AS
DECLARE VARIABLE i Integer;
DECLARE VARIABLE iDias Integer;
DECLARE VARIABLE dPerc NUMERIC(10,6);
DECLARE VARIABLE dTotPerc NUMERIC(10,6);
BEGIN
   IF (new.PARCPLANOPAG>0) THEN
   BEGIN
     i = 1;
     dTotPerc = 0;
     dPerc = 100.000000/new.PARCPLANOPAG;
     WHILE (i<=new.PARCPLANOPAG) DO
     BEGIN
        iDias = (i-1)*30;
        IF (i = new.PARCPLANOPAG) THEN
          dPerc = 100.000000-dTotPerc;
        INSERT INTO FNPARCPAG (CODEMP,CODFILIAL,CODPLANOPAG,NROPARCPAG,PERCPAG,DIASPAG)
               VALUES (new.CODEMP,new.CODFILIAL,new.CODPLANOPAG,:i,:dPerc,:iDias);
        dTotPerc = dTotPerc + dPerc;
        i = i + 1;
     END
   END
END
^

/* Trigger: FNPLANOPAGTGBD */
CREATE TRIGGER FNPLANOPAGTGBD FOR FNPLANOPAG
ACTIVE BEFORE DELETE POSITION 0
AS
BEGIN
  DELETE FROM FNPARCPAG WHERE CODPLANOPAG=old.CODPLANOPAG
         AND CODEMP=old.CODEMP AND CODFILIAL = old.CODFILIAL;
END
^

/* Trigger: FNPLANOPAGTGBU */
CREATE TRIGGER FNPLANOPAGTGBU FOR FNPLANOPAG
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: FNRECEBERRGBD */
CREATE TRIGGER FNRECEBERRGBD FOR FNRECEBER
ACTIVE BEFORE DELETE POSITION 0
AS
BEGIN
    DELETE FROM FNITRECEBER WHERE CODREC = old.CODREC
         AND CODEMP=old.CODEMP AND CODFILIAL = old.CODFILIAL;
END
^

/* Trigger: FNRECEBERTGAI */
CREATE TRIGGER FNRECEBERTGAI FOR FNRECEBER
ACTIVE AFTER INSERT POSITION 0
AS
  DECLARE VARIABLE NPARCREC INTEGER;
  DECLARE VARIABLE CODFILIALPP SMALLINT;
  DECLARE VARIABLE NUMCONTA CHAR(10);
  DECLARE VARIABLE CODFILIALCA SMALLINT;
  DECLARE VARIABLE CODPLAN CHAR(13);
  DECLARE VARIABLE CODFILIALPN SMALLINT;
  DECLARE VARIABLE CODCC CHAR(19);
  DECLARE VARIABLE ANOCC SMALLINT;
  DECLARE VARIABLE CODFILIALCC SMALLINT;
  DECLARE VARIABLE CODFILIALIR SMALLINT;
  DECLARE VARIABLE CODFILIALCL SMALLINT;
  DECLARE VARIABLE ATIVOCLI CHAR(1);
  DECLARE VARIABLE NUMRESTR INTEGER;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(NEW.CODEMP,'VDCLIENTE') INTO CODFILIALCL;
  SELECT C.ATIVOCLI  FROM VDCLIENTE C WHERE C.CODEMP=NEW.CODEMP AND
     C.CODFILIAL=:CODFILIALCL AND C.CODCLI=NEW.CODCLI INTO :ATIVOCLI;
  IF (ATIVOCLI<>'S') THEN
  BEGIN
     EXCEPTION FNRECEBEREX01;
  END
  SELECT COUNT(*) FROM FNRESTRICAO R, FNTIPORESTR TR
    WHERE R.CODEMP=NEW.CODEMP AND R.CODFILIAL=:CODFILIALCL AND
      R.CODCLI=NEW.CODCLI AND R.SITRESTR IN ('I') AND
      TR.CODEMP=R.CODEMPTR AND TR.CODFILIAL=R.CODFILIALTR AND
      TR.CODTPRESTR=R.CODTPRESTR AND TR.BLOQTPRESTR='S'
      INTO :NUMRESTR;
  IF ( (NUMRESTR IS NOT NULL) AND (NUMRESTR>0) ) THEN
  BEGIN
     IF (NUMRESTR=1) THEN
     BEGIN
        EXCEPTION FNRECEBEREX02 'Cliente possui '||RTRIM(CAST(NUMRESTR AS CHAR(10)))||' restrição!';
     END
     ELSE
     BEGIN
        EXCEPTION FNRECEBEREX02 'Cliente possui '||RTRIM(CAST(NUMRESTR AS CHAR(10)))||' restrições!';
     END
  END
  SELECT ICODFILIAL FROM SGRETFILIAL(NEW.CODEMP,'FNPLANOPAG') INTO CODFILIALPP;
  SELECT ICODFILIAL FROM SGRETFILIAL(NEW.CODEMP,'FNPLANEJAMENTO') INTO CODFILIALPN;
  SELECT ICODFILIAL FROM SGRETFILIAL(NEW.CODEMP,'FNCENTROCUSTO') INTO CODFILIALCC;
  SELECT ICODFILIAL FROM SGRETFILIAL(NEW.CODEMP,'FNITRECEBER') INTO CODFILIALIR;
  SELECT I FROM fngeraitrecebersp01('S',new.CODEMP,
    new.CODFILIAL, new.CODREC, new.CODEMPPG, new.CODFILIALPG, new.CODPLANOPAG,
    new.VLRREC, new.DATAREC, new.FLAG, new.CODEMPBO, new.CODFILIALBO,
    new.CODBANCO, new.CODEMPTC, new.CODFILIALTC, new.CODTIPOCOB,
    new.CODEMPCB, new.CODFILIALCB, new.CODCARTCOB,
    new.VLRCOMIREC, new.OBSREC) INTO new.NROPARCREC;

/* Se a parcela do plano de pagamento tiver marcado para autobaixa, então é realizada a baixa automática. */
  FOR SELECT PP.NUMCONTA,PP.CODFILIALCA,PP.CODPLAN,PP.CODFILIALPN,PP.CODCC,PP.ANOCC,PP.CODFILIALCC,PC.NROPARCPAG
      FROM FNPARCPAG PC, FNPLANOPAG PP
      WHERE
        PP.CODEMP=NEW.CODEMP AND PP.CODFILIAL=:CODFILIALPP AND PP.CODPLANOPAG=NEW.CODPLANOPAG AND
        PC.CODEMP=PP.CODEMP AND PC.CODFILIAL=PP.CODFILIAL AND PC.CODPLANOPAG=PP.CODPLANOPAG AND
        PC.AUTOBAIXAPARC='S'
      INTO NUMCONTA,CODFILIALCA,CODPLAN,CODFILIALPN,CODCC,ANOCC,CODFILIALCC,NPARCREC
  DO
  BEGIN
    UPDATE FNITRECEBER SET
      NUMCONTA=:NUMCONTA,
      CODEMPCA=NEW.CODEMP,
      CODFILIALCA=:CODFILIALCA,
      CODPLAN=:CODPLAN,
      CODEMPPN=NEW.CODEMP,
      CODFILIALPN=:CODFILIALPN,
      ANOCC=:ANOCC,
      CODCC=:CODCC,
      CODEMPCC=NEW.CODEMP,
      CODFILIALCC=:CODFILIALCC,
      DOCLANCAITREC='AUTO',
      DTPAGOITREC=NEW.DATAREC,
      VLRPAGOITREC=VLRPARCITREC,
      VLRDESCITREC=0,
      VLRJUROSITREC=0,
      OBSITREC='BAIXA AUTOMÁTICA',
      STATUSITREC='RP'
      WHERE CODREC=NEW.CODREC AND CODEMP=NEW.CODEMP AND CODFILIAL=:CODFILIALIR AND
      NPARCITREC=:NPARCREC;
  END
END
^

/* Trigger: FNRECEBERTGAU */
CREATE TRIGGER FNRECEBERTGAU FOR FNRECEBER
ACTIVE AFTER UPDATE POSITION 0
AS
  DECLARE VARIABLE INPARCOLD INTEGER;
  DECLARE VARIABLE INPARCNEW INTEGER;
  DECLARE VARIABLE CALTVLR CHAR(1);
BEGIN
  IF ( ((old.CODPLANOPAG<>new.CODPLANOPAG) OR
       (old.FLAG<>new.FLAG) OR
       (old.VLRREC<>new.VLRREC) OR
       (old.DATAREC<>new.DATAREC)) AND
       (new.ALTUSUREC != 'S') ) THEN
  BEGIN

    IF (old.CODPLANOPAG<>new.CODPLANOPAG) THEN
    BEGIN
       SELECT PP.PARCPLANOPAG FROM FNPLANOPAG PP WHERE CODEMP=old.CODEMPPG and
           PP.CODFILIAL=old.CODFILIALPG AND
           PP.CODPLANOPAG=old.CODPLANOPAG INTO :INPARCOLD;
       SELECT PP.PARCPLANOPAG FROM FNPLANOPAG PP WHERE CODEMP=new.CODEMPPG and
           PP.CODFILIAL=new.CODFILIALPG AND
           PP.CODPLANOPAG=new.CODPLANOPAG INTO :INPARCNEW;
       IF (INPARCNEW != INPARCOLD) THEN
           DELETE FROM FNITRECEBER WHERE CODREC=new.CODREC
           AND CODEMP=new.CODEMP AND CODFILIAL = new.CODFILIAL;
    END
    IF (new.VLRREC!=old.VLRREC) THEN
       CALTVLR = 'S';
    ELSE
       CALTVLR = 'N';
    SELECT I FROM fngeraitrecebersp01(:CALTVLR,  new.CODEMP,
       new.CODFILIAL, new.CODREC, new.CODEMPPG, new.CODFILIALPG, new.CODPLANOPAG,
       new.VLRREC, new.DATAREC, new.FLAG, new.CODEMPBO, new.CODFILIALBO,
       new.CODBANCO, new.CODEMPTC, new.CODFILIALTC, new.CODTIPOCOB,
       new.CODEMPCB, new.CODFILIALCB, new.CODCARTCOB,
       new.VLRCOMIREC, new.OBSREC)
       INTO new.NROPARCREC;
  END
/* Atualiza os itens para eles atualizarem a comissao de forma distribuida. */
  IF (old.VLRCOMIREC != new.VLRCOMIREC) THEN
    EXECUTE PROCEDURE FNITRECEBERSP01(new.CODEMP,new.CODFILIAL,new.CODREC,
       new.VLRPARCREC,new.VLRCOMIREC,new.NROPARCREC,'N');
/*  ELSE IF (old.ALTUSUREC = 'S' AND old.ALTUSUREC='N') THEN
    EXECUTE PROCEDURE FNITRECEBERSP01(new.CODEMP,new.CODFILIAL,new.CODREC,
       new.VLRPARCREC,new.VLRCOMIREC,new.NROPARCREC);*/
END
^

/* Trigger: FNRECEBERTGBI */
CREATE TRIGGER FNRECEBERTGBI FOR FNRECEBER
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
  new.DTINS=cast('now' AS DATE);
  new.IDUSUINS=USER;
  new.HINS = cast('now' AS TIME);
  IF (new.VLRREC IS NULL) THEN new.VLRREC = 0;
  IF (new.VLRDESCREC IS NULL) THEN new.VLRDESCREC = 0;
  IF (new.VLRJUROSREC IS NULL) THEN new.VLRJUROSREC = 0;
  IF (new.VLRMULTAREC IS NULL) THEN new.VLRMULTAREC = 0;
  IF (new.VLRPARCREC IS NULL) THEN new.VLRPARCREC = 0;
  IF (new.VLRAPAGREC IS NULL) THEN new.VLRAPAGREC = 0;
  IF (new.VLRPAGOREC IS NULL) THEN new.VLRPAGOREC = 0;
END
^

/* Trigger: FNRECEBERTGBU */
CREATE TRIGGER FNRECEBERTGBU FOR FNRECEBER
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: FNRESTRICAOTGBU */
CREATE TRIGGER FNRESTRICAOTGBU FOR FNRESTRICAO
ACTIVE BEFORE UPDATE POSITION 0
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  IF (new.DTCANCRESTR IS NOT NULL) THEN
  BEGIN
     new.SITRESTR = 'C';
  END
end
^

/* Trigger: FNSALDOLANCATGBI */
CREATE TRIGGER FNSALDOLANCATGBI FOR FNSALDOLANCA
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
  if (new.SALDOSL is null) then
     new.SALDOSL = 0;
  if (new.PREVSL is null) then
     new.PREVSL = 0;
END
^

/* Trigger: FNSALDOLANCATGBU */
CREATE TRIGGER FNSALDOLANCATGBU FOR FNSALDOLANCA
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: FNSUBLANCATGAD */
CREATE TRIGGER FNSUBLANCATGAD FOR FNSUBLANCA
ACTIVE AFTER DELETE POSITION 0
AS
DECLARE VARIABLE dDataSl DATE;
DECLARE VARIABLE dSaldoSl NUMERIC(15, 5);
DECLARE VARIABLE sCodplan CHAR(13);
DECLARE VARIABLE dSaldoAnt NUMERIC(15, 5);
DECLARE VARIABLE IFILIALSALDO INTEGER;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(old.CODEMPPN,'FNSALDOLANCA') INTO IFILIALSALDO;
   SELECT CODPLAN,DATASL,SALDOSL FROM FNSALDOLANCA WHERE CODPLAN=old.CODPLAN
          AND DATASL=old.DATASUBLANCA AND CODEMP=old.CODEMP AND CODFILIAL=:IFILIALSALDO
          INTO :sCodplan,:dDataSl,:dSaldoSl;
   IF (:sCodplan IS NULL ) THEN
   BEGIN
      SELECT SALDOSL FROM FNSALDOLANCA SL1 WHERE SL1.CODPLAN=old.CODPLAN
             AND SL1.DATASL=(
                            SELECT MAX(SL2.DATASL) FROM FNSALDOLANCA SL2 WHERE
                                   SL2.CODPLAN=SL1.CODPLAN AND SL2.DATASL<old.DATASUBLANCA
                                   AND SL2.CODEMP=old.CODEMP AND SL2.CODFILIAL=:IFILIALSALDO
                            )
             AND SL1.CODEMP=old.CODEMP AND SL1.CODFILIAL=:IFILIALSALDO INTO :dSaldoAnt;
      IF (:dSaldoAnt IS NULL) THEN
         dSaldoAnt = 0;
      INSERT INTO FNSALDOLANCA (CODEMP,CODFILIAL,CODEMPPN,CODFILIALPN,CODPLAN,DATASL,SALDOSL)
             VALUES (old.CODEMPPN,old.CODFILIALPN,old.CODEMPPN,old.CODFILIALPN,old.CODPLAN,old.DATASUBLANCA,:dSaldoAnt);
      UPDATE FNSALDOLANCA SET SALDOSL = SALDOSL - old.VLRSUBLANCA
             WHERE CODPLAN=old.CODPLAN AND DATASL>old.DATASUBLANCA
             AND CODEMP=old.CODEMP AND CODFILIAL=:IFILIALSALDO;
   END
   ELSE
   BEGIN
      UPDATE FNSALDOLANCA SET SALDOSL = SALDOSL - old.VLRSUBLANCA
             WHERE CODPLAN=old.CODPLAN AND DATASL>=old.DATASUBLANCA
             AND CODEMP=old.CODEMP AND CODFILIAL=:IFILIALSALDO;
   END
END
^

/* Trigger: FNSUBLANCATGAI */
CREATE TRIGGER FNSUBLANCATGAI FOR FNSUBLANCA
ACTIVE AFTER INSERT POSITION 0
AS
DECLARE VARIABLE dDataSl DATE;
DECLARE VARIABLE dSaldoSl NUMERIC(15, 5);
DECLARE VARIABLE sCodplan CHAR(13);
DECLARE VARIABLE dSaldoAnt NUMERIC(15, 5);
DECLARE VARIABLE IFILIALSALDO INTEGER;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'FNSALDOLANCA') INTO IFILIALSALDO;
   SELECT CODPLAN,DATASL,SALDOSL FROM FNSALDOLANCA WHERE CODPLAN=new.CODPLAN
          AND DATASL=new.DATASUBLANCA AND CODEMP=new.CODEMP AND CODFILIAL = :IFILIALSALDO
          INTO :sCodplan,:dDataSl,:dSaldoSl;
   IF (:sCodplan IS NULL ) THEN
   BEGIN
      SELECT SALDOSL FROM FNSALDOLANCA SL1 WHERE SL1.CODPLAN=new.CODPLAN
             AND SL1.DATASL=(
                            SELECT MAX(SL2.DATASL) FROM FNSALDOLANCA SL2 WHERE
                                   SL2.CODPLAN=SL1.CODPLAN AND SL2.DATASL<new.DATASUBLANCA
                                   AND SL2.CODEMP=new.CODEMP AND SL2.CODFILIAL=:IFILIALSALDO
                            )
              AND SL1.CODEMP=new.CODEMP AND SL1.CODFILIAL = :IFILIALSALDO INTO :dSaldoAnt;
      IF (:dSaldoAnt IS NULL) THEN
         dSaldoAnt = 0;
      INSERT INTO FNSALDOLANCA (CODEMP,CODFILIAL,CODPLAN,CODEMPPN,CODFILIALPN,DATASL,SALDOSL)
             VALUES (new.CODEMPPN,:IFILIALSALDO,new.CODPLAN,new.CODEMPPN,new.CODFILIALPN,new.DATASUBLANCA,:dSaldoAnt+new.VLRSUBLANCA);
      UPDATE FNSALDOLANCA SET SALDOSL = SALDOSL + new.VLRSUBLANCA
             WHERE CODPLAN=new.CODPLAN AND DATASL>new.DATASUBLANCA
             AND CODEMP=new.CODEMP AND CODFILIAL=:IFILIALSALDO;
   END
   ELSE
   BEGIN
      UPDATE FNSALDOLANCA SET SALDOSL = SALDOSL + new.VLRSUBLANCA
             WHERE CODPLAN=new.CODPLAN AND DATASL>=new.DATASUBLANCA
             AND CODEMP=new.CODEMP AND CODFILIAL=:IFILIALSALDO;
   END
END
^

/* Trigger: FNSUBLANCATGAU */
CREATE TRIGGER FNSUBLANCATGAU FOR FNSUBLANCA
ACTIVE AFTER UPDATE POSITION 0
AS
DECLARE VARIABLE dDataSl DATE;
DECLARE VARIABLE dSaldoSl NUMERIC(15, 5);
DECLARE VARIABLE sCodplan CHAR(13);
DECLARE VARIABLE dSaldoAnt NUMERIC(15, 5);
DECLARE VARIABLE IFILIALSALDO INTEGER;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'FNSALDOLANCA') INTO IFILIALSALDO;
   IF ( (old.DATASUBLANCA <> new.DATASUBLANCA) OR (old.VLRSUBLANCA<>new.VLRSUBLANCA) ) THEN
   BEGIN
/*Verifica se já existe saldo no dia da nova data:*/
     SELECT CODPLAN,DATASL,SALDOSL FROM FNSALDOLANCA WHERE CODPLAN=new.CODPLAN
            AND DATASL=new.DATASUBLANCA AND CODEMP=new.CODEMPPN AND CODFILIAL=:IFILIALSALDO
            INTO :sCodplan,:dDataSl,:dSaldoSl;
/*Se não existir, cria um saldo para o nova data:*/
     IF (sCodplan IS NULL ) THEN
     BEGIN
/*Pega o ultimo saldo anterior a data do lançamento:*/
        SELECT SALDOSL FROM FNSALDOLANCA SL1 WHERE SL1.CODPLAN=new.CODPLAN
               AND SL1.DATASL=(
                              SELECT MAX(SL2.DATASL) FROM FNSALDOLANCA SL2 WHERE
                                     SL2.CODPLAN=SL1.CODPLAN AND SL2.DATASL<new.DATASUBLANCA
                                     AND SL2.CODEMP=new.CODEMPPN AND SL2.CODFILIAL=:IFILIALSALDO
                              )
               AND SL1.CODEMP=new.CODEMPPN AND SL1.CODFILIAL=:IFILIALSALDO INTO :dSaldoAnt;
/*Cria um saldo para este dia e atualiza saldos possíveis que tiverem na frente:*/
        IF (:dSaldoAnt IS NULL) THEN
           dSaldoAnt = 0;
        INSERT INTO FNSALDOLANCA (CODEMP,CODFILIAL,CODPLAN,CODEMPPN,CODFILIALPN,DATASL,SALDOSL)
               VALUES (new.CODEMP,:IFILIALSALDO,new.CODPLAN,new.CODEMPPN,new.CODFILIALPN,new.DATASUBLANCA,:dSaldoAnt + new.VLRSUBLANCA);
        UPDATE FNSALDOLANCA SET SALDOSL = SALDOSL + new.VLRSUBLANCA
               WHERE CODPLAN=new.CODPLAN AND DATASL>new.DATASUBLANCA
               AND CODEMP=new.CODEMP AND CODFILIAL=:IFILIALSALDO;
     END
/*Caso contrário só atualiza o saldo:*/
     ELSE
     BEGIN
        UPDATE FNSALDOLANCA SET SALDOSL = SALDOSL + new.VLRSUBLANCA
               WHERE CODPLAN=new.CODPLAN AND DATASL>=new.DATASUBLANCA
               AND CODEMP=new.CODEMP AND CODFILIAL=:IFILIALSALDO;
     END
   END
END
^

/* Trigger: FNSUBLANCATGBD */
CREATE TRIGGER FNSUBLANCATGBD FOR FNSUBLANCA
ACTIVE BEFORE DELETE POSITION 0
AS
BEGIN
  IF (old.CODSUBLANCA > 0) THEN
    UPDATE FNLANCA SET VLRLANCA = VLRLANCA - (old.VLRSUBLANCA*-1) WHERE
      CODEMP=old.CODEMP AND CODFILIAL=old.CODFILIAL AND
      CODLANCA=old.CODLANCA;
END
^

/* Trigger: FNSUBLANCATGBI */
CREATE TRIGGER FNSUBLANCATGBI FOR FNSUBLANCA
ACTIVE BEFORE INSERT POSITION 0
AS
  DECLARE VARIABLE sEhTransf CHAR(1);
  DECLARE VARIABLE sTipoPlan CHAR(1);
  DECLARE VARIABLE dDataLanca DATE;
  DECLARE VARIABLE dDtPrevLanca DATE;
  DECLARE VARIABLE sHistSubLanc VARCHAR(100);
BEGIN
  /*IF ( new.VLRSUBLANCA = 0 ) THEN
     EXCEPTION FNSUBLANCAEX04;         */
  SELECT HISTBLANCA FROM FNLANCA WHERE CODLANCA = new.CODLANCA
     AND CODEMP=new.CODEMP AND CODFILIAL = new.CODFILIAL INTO sHistSubLanc;
  IF (new.HISTSUBLANCA IS NULL) THEN
      new.HISTSUBLANCA = sHistSubLanc;
  IF (new.CODSUBLANCA IS NULL) THEN
    SELECT MAX(CODSUBLANCA) FROM FNSUBLANCA WHERE CODLANCA = new.CODLANCA
           AND CODEMP=new.CODEMP AND CODFILIAL = new.CODFILIAL INTO new.CODSUBLANCA;
  new.STATUSSUBLANCA = 'S1';
  SELECT TRANSFLANCA,DATALANCA,DTPREVLANCA FROM FNLANCA WHERE CODLANCA = new.CODLANCA
         AND CODEMP=new.CODEMP AND CODFILIAL = new.CODFILIAL INTO sEhTransf,dDataLanca,dDtPrevLanca;
  SELECT TIPOPLAN FROM FNPLANEJAMENTO WHERE CODPLAN = new.CODPLAN
         AND CODEMP=new.CODEMPPN AND CODFILIAL = new.CODFILIALPN INTO sTipoPlan;
  new.DATASUBLANCA = dDataLanca;
  IF (new.CODSUBLANCA > 0) THEN
  BEGIN
    new.ORIGSUBLANCA = 'N';
  END
  new.STATUSSUBLANCA = 'S1';
  new.DTPREVSUBLANCA = dDtPrevLanca;
  IF (sEhTransf = 'S') THEN
  BEGIN
   IF (new.CODSUBLANCA = 2) THEN
     EXCEPTION FNSUBLANCAEX01;
   ELSE IF (sTipoPlan IN ('D','R')) THEN
     EXCEPTION FNSUBLANCAEX02;
  END
  ELSE
    IF ((new.CODSUBLANCA != 0) AND (sTipoPlan IN ('C','B'))) THEN
      EXCEPTION FNSUBLANCAEX03;
  UPDATE FNLANCA SET STATUSLANCA = 'L2', VLRLANCA=(VLRLANCA-new.VLRSUBLANCA)
         WHERE CODLANCA = new.CODLANCA AND CODEMP=new.CODEMP AND CODFILIAL=new.CODFILIAL;
END
^

/* Trigger: FNSUBLANCATGBU */
CREATE TRIGGER FNSUBLANCATGBU FOR FNSUBLANCA
ACTIVE BEFORE UPDATE POSITION 0
AS
  DECLARE VARIABLE sEhTransf CHAR(1);
  DECLARE VARIABLE sTipoPlan CHAR(1);
  DECLARE VARIABLE IFILIALSALDO INTEGER;
BEGIN
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /*IF ( new.VLRSUBLANCA = 0 ) THEN
     EXCEPTION FNSUBLANCAEX04;   */
  SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'FNSALDOLANCA') INTO IFILIALSALDO;
  SELECT TIPOPLAN FROM FNPLANEJAMENTO WHERE CODPLAN = new.CODPLAN
         AND CODEMP=new.CODEMPPN AND CODFILIAL = new.CODFILIALPN INTO sTipoPlan;
  SELECT TRANSFLANCA FROM FNLANCA WHERE CODLANCA = new.CODLANCA
         AND CODEMP=new.CODEMP AND CODFILIAL = new.CODFILIAL INTO sEhTransf;
  IF (sEhTransf = 'S') THEN
  BEGIN
      IF (new.CODSUBLANCA = 2) THEN
     EXCEPTION FNSUBLANCAEX01;
   ELSE IF (sTipoPlan IN ('D','R')) THEN
     EXCEPTION FNSUBLANCAEX02;
  END
  ELSE
    IF ((new.CODSUBLANCA != 0) AND (sTipoPlan IN ('C','B'))) THEN
      EXCEPTION FNSUBLANCAEX03;
  IF ((new.CODSUBLANCA != 0) AND (old.VLRSUBLANCA <> new.VLRSUBLANCA)) THEN
    UPDATE FNLANCA SET VLRLANCA = ((VLRLANCA+old.VLRSUBLANCA)-new.VLRSUBLANCA)
           WHERE CODLANCA = new.CODLANCA AND CODEMP=new.CODEMP AND CODFILIAL=new.CODFILIAL;
  IF ( (old.DATASUBLANCA <> new.DATASUBLANCA) OR (old.VLRSUBLANCA<>new.VLRSUBLANCA) OR (old.CODPLAN<>new.CODPLAN) ) THEN
    UPDATE FNSALDOLANCA SET SALDOSL = SALDOSL - old.VLRSUBLANCA
           WHERE CODPLAN=old.CODPLAN AND DATASL>=old.DATASUBLANCA
           AND CODEMP=old.CODEMP AND CODFILIAL=:IFILIALSALDO;
END
^

/* Trigger: FNTBJUROSTGBU */
CREATE TRIGGER FNTBJUROSTGBU FOR FNTBJUROS
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: FNTIPOCOBTGBU */
CREATE TRIGGER FNTIPOCOBTGBU FOR FNTIPOCOB
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: FNTIPOCREDTGBU */
CREATE TRIGGER FNTIPOCREDTGBU FOR FNTIPOCRED
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: FNTIPORESTRTGBU */
CREATE TRIGGER FNTIPORESTRTGBU FOR FNTIPORESTR
ACTIVE BEFORE UPDATE POSITION 0
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: LFCLFISCALTGBU */
CREATE TRIGGER LFCLFISCALTGBU FOR LFCLFISCAL
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: LFITCLFISCALTGBU */
CREATE TRIGGER LFITCLFISCALTGBU FOR LFITCLFISCAL
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: LFITNATOPERTGBU */
CREATE TRIGGER LFITNATOPERTGBU FOR LFITNATOPER
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: LFITREGRAFISCALTGBU */
CREATE TRIGGER LFITREGRAFISCALTGBU FOR LFITREGRAFISCAL
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: LFLIVROFISCALTGBU */
CREATE TRIGGER LFLIVROFISCALTGBU FOR LFLIVROFISCAL
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end
^

/* Trigger: LFMENSAGEMTGBU */
CREATE TRIGGER LFMENSAGEMTGBU FOR LFMENSAGEM
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: LFMODNOTATGBU */
CREATE TRIGGER LFMODNOTATGBU FOR LFMODNOTA
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: LFNATOPERTGBU */
CREATE TRIGGER LFNATOPERTGBU FOR LFNATOPER
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: LFREGRAFISCALTGBU */
CREATE TRIGGER LFREGRAFISCALTGBU FOR LFREGRAFISCAL
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: LFSERIETGBI */
CREATE TRIGGER LFSERIETGBI FOR LFSERIE
ACTIVE BEFORE INSERT POSITION 0
AS
begin
   if (new.DOCSERIE IS NULL) then
      new.DOCSERIE = 1;
end
^

/* Trigger: LFSERIETGBU */
CREATE TRIGGER LFSERIETGBU FOR LFSERIE
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: LFTABICMSTGBU */
CREATE TRIGGER LFTABICMSTGBU FOR LFTABICMS
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: LFTIPOFISCCLITGBU */
CREATE TRIGGER LFTIPOFISCCLITGBU FOR LFTIPOFISCCLI
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: LFTRATTRIBTGBU */
CREATE TRIGGER LFTRATTRIBTGBU FOR LFTRATTRIB
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: PPESTRUANALISETGBU */
CREATE TRIGGER PPESTRUANALISETGBU FOR PPESTRUANALISE
ACTIVE BEFORE UPDATE POSITION 0
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: PPESTRUFASETGAD */
CREATE TRIGGER PPESTRUFASETGAD FOR PPESTRUFASE
ACTIVE AFTER DELETE POSITION 0
AS
declare variable iSeqEf smallint;
begin
  IF(old.finalizaop = 'S') then
  begin
    for select max(seqef) from ppestrufase ef where ef.codemp=old.codemp and
        ef.codfilial=old.codfilial and ef.codprod = old.codprod and
        ef.seqest = old.seqest into :iSeqEf do
        begin
            update ppestrutura et set et.ativoest='N' where et.codemp=old.codemp and
                et.codfilial = old.codfilial and et.codprod=old.codprod and
                et.seqest = old.seqest;
        end
  end
end
^

/* Trigger: PPESTRUFASETGBIBU */
CREATE TRIGGER PPESTRUFASETGBIBU FOR PPESTRUFASE
ACTIVE BEFORE INSERT OR UPDATE POSITION 1
AS
declare variable iFinaliza smallint;
begin
  if (NEW.finalizaop='S') then
  BEGIN
    SELECT COUNT(1) FROM PPESTRUFASE EF
        WHERE EF.CODEMP=NEW.CODEMP AND EF.CODFILIAL=NEW.CODFILIAL AND
              EF.CODPROD = NEW.codprod AND
              EF.SEQEST = NEW.SEQEST AND EF.FINALIZAOP='S' into :iFinaliza;
        if(:iFinaliza>0) then
        begin
           exception ppestrufase01;
        end
  END
end
^

/* Trigger: PPESTRUFASETGBU */
CREATE TRIGGER PPESTRUFASETGBU FOR PPESTRUFASE
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: PPESTRUTURATGBIBU */
CREATE TRIGGER PPESTRUTURATGBIBU FOR PPESTRUTURA
ACTIVE BEFORE INSERT OR UPDATE POSITION 0
AS
declare variable iFinaliza smallint;
begin
  if (new.REFPROD IS NULL) then
    SELECT REFPROD FROM EQPRODUTO WHERE CODPROD=new.CODPROD
         AND CODEMP=new.CODEMP AND CODFILIAL = new.CODFILIAL INTO new.REFPROD;
  IF(NEW.ativoest='S' AND NEW.ativoest!=OLD.ativoest) THEN
  BEGIN
    select count(1) from ppestrufase ef
        where ef.codemp=new.codemp and ef.codfilial=new.codfilial and
        ef.codprod=new.codprod and ef.seqest=new.seqest and ef.finalizaop='S'
        into :iFinaliza;
    if ((:iFinaliza is null) or (:iFinaliza<1) ) then
    begin
      exception ppestruturaex01;
    end
  END
end
^

/* Trigger: PPESTRUTURATGBU */
CREATE TRIGGER PPESTRUTURATGBU FOR PPESTRUTURA
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: PPFASETGBU */
CREATE TRIGGER PPFASETGBU FOR PPFASE
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: PPFOTOMTANTGBU */
CREATE TRIGGER PPFOTOMTANTGBU FOR PPFOTOMTAN
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: PPITESTRUTURATGBI */
CREATE TRIGGER PPITESTRUTURATGBI FOR PPITESTRUTURA
ACTIVE BEFORE INSERT POSITION 0
as
begin
  new.DTINS=cast('now' AS DATE);
  new.idusuins=USER;
  new.hins = cast('now' AS TIME);
  if (new.REFPROD IS NULL) then
    SELECT REFPROD FROM EQPRODUTO WHERE CODPROD=new.CODPROD
         AND CODEMP=new.CODEMP AND CODFILIAL = new.CODFILIAL INTO new.REFPROD;
end
^

/* Trigger: PPITESTRUTURATGBU */
CREATE TRIGGER PPITESTRUTURATGBU FOR PPITESTRUTURA
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  if (new.REFPROD IS NULL) then
    SELECT REFPROD FROM EQPRODUTO WHERE CODPROD=new.CODPROD
         AND CODEMP=new.CODEMP AND CODFILIAL = new.CODFILIAL INTO new.REFPROD;
end
^

/* Trigger: PPITOPTGAU */
CREATE TRIGGER PPITOPTGAU FOR PPITOP
ACTIVE AFTER UPDATE POSITION 0
AS
begin
  if(new.qtdcopiaitop is not null) then
  begin
    if( (new.qtdcopiaitop>0) and (old.qtdcopiaitop is null) ) then
    begin
        insert into ppitop (codemp,codfilial,codop,seqop,seqitop,
                            codemppd, codfilialpd,codprod,refprod,
                            qtditop, codempfs,codfilialfs, codfase,
                            codemple,codfilialle,codlote,gerarma,SEQITOPCP)
                           values
                           (new.codemp,new.codfilial,new.codop,new.seqop,
                            (select (max(op.seqitop)+1) from ppitop op
                               where op.codemp=new.codemp and op.codfilial=new.codfilial and
                               op.codop=new.codop and op.seqop=new.seqop),
                            new.codemppd,new.codfilialpd,new.codprod,new.refprod,
                            new.qtdcopiaitop,new.codempfs,new.codfilialfs,new.codfase,
                            new.codemple, new.codfilialle,new.codloterat,new.gerarma,new.seqitop);
    end
  end
end
^

/* Trigger: PPITOPTGBI */
CREATE TRIGGER PPITOPTGBI FOR PPITOP
ACTIVE BEFORE INSERT POSITION 0
AS
begin
   SELECT REFPROD FROM EQPRODUTO WHERE CODEMP=new.CODEMPPD AND
    CODFILIAL=new.CODFILIALPD AND CODPROD=new.CODPROD INTO new.REFPROD;
end
^

/* Trigger: PPITOPTGBI02 */
CREATE TRIGGER PPITOPTGBI02 FOR PPITOP
ACTIVE BEFORE INSERT POSITION 0
AS
   DECLARE VARIABLE CSALDO CHAR(1);
BEGIN
   IF (new.SEQOP=0) THEN
     CSALDO = 'S';
   ELSE
   BEGIN
     FOR SELECT OP.CODEMPLE, OP.CODFILIALLE, OP.CODLOTE
        FROM PPOP OP, PPOP OD
        WHERE
          OD.CODEMP=new.CODEMP AND OD.CODFILIAL=new.CODFILIAL AND
          OD.CODOP=new.CODOP AND OD.SEQOP=new.SEQOP AND
          OP.CODEMP=OD.CODEMPOPM AND OP.CODFILIAL=OD.CODFILIALOPM AND
          OP.CODOP=OD.CODOPM AND OP.SEQOP=OD.SEQOPM AND
          OP.CODEMPPD=new.CODEMPPD AND OP.CODFILIALPD=new.CODFILIALPD AND OP.CODPROD=new.CODPROD
        INTO new.CODEMPLE, new.CODFILIALLE, new.CODLOTE DO
        BEGIN
          CSALDO='N';
        END
   END
   IF (((CSALDO='S') OR (CSALDO IS NULL)) AND (new.CODLOTE IS NULL)) THEN
   BEGIN
     SELECT FIRST 1 L.CODEMP, L.CODFILIAL, L.CODLOTE
        FROM EQLOTE L
        WHERE L.CODPROD=NEW.codprod AND L.CODFILIAL=NEW.codfilialpd AND L.SLDLIQLOTE>0
        AND L.CODEMP=NEW.codemppd  AND L.VENCTOLOTE>=cast('today' as date)
        ORDER BY L.VENCTOLOTE, L.CODLOTE
        INTO new.CODEMPLE, new.CODFILIALLE, new.CODLOTE;
   END
END
^

/* Trigger: PPITOPTGBU */
CREATE TRIGGER PPITOPTGBU FOR PPITOP
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  SELECT REFPROD FROM EQPRODUTO WHERE CODEMP=new.CODEMPPD AND
    CODFILIAL=new.CODFILIALPD AND CODPROD=new.CODPROD INTO new.REFPROD;
end
^

/* Trigger: PPITRETCPTGBU */
CREATE TRIGGER PPITRETCPTGBU FOR PPITRETCP
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: PPMETODOANALISETGBU */
CREATE TRIGGER PPMETODOANALISETGBU FOR PPMETODOANALISE
ACTIVE BEFORE UPDATE POSITION 0
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: PPOPACAOCORRETTGBU */
CREATE TRIGGER PPOPACAOCORRETTGBU FOR PPOPACAOCORRET
ACTIVE BEFORE UPDATE POSITION 0
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: PPOPCQTGAU */
CREATE TRIGGER PPOPCQTGAU FOR PPOPCQ
ACTIVE AFTER UPDATE POSITION 0
AS
begin
    if (new.seqac is not null and new.seqac<>old.seqac) then
    begin
        new.status = 'CO';
    end
end
^

/* Trigger: PPOPCQTGBU */
CREATE TRIGGER PPOPCQTGBU FOR PPOPCQ
ACTIVE BEFORE UPDATE POSITION 0
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: PPOPFASETGAI */
CREATE TRIGGER PPOPFASETGAI FOR PPOPFASE
ACTIVE AFTER INSERT POSITION 0
AS
declare variable ctipofase char(2);
declare variable imesesdesccp smallint;
declare variable ddtdescarte date;
declare variable ddtvalidop date;
declare variable icodempest integer;
declare variable icodfilialest smallint;
declare variable icodprodest integer;
declare variable iseqest smallint;
declare variable icodemppd integer;
declare variable icodfilialpd smallint;
declare variable icodprodpd integer;
declare variable icoditretcp smallint;
declare variable iqtd decimal(15,5);

begin
  select tipofase from ppfase where codemp=new.codempfs and codfilial=new.codfilialfs and codfase=new.codfase
      into :ctipofase;

  if(ctipofase='CQ') then
  begin

    select max(sg.mesesdesccp) from sgprefere5 sg where codemp=new.codemp and codfilial=new.codfilial
      into :imesesdesccp;

    select op.codemppd, op.codfilialpd, op.codprod, op.seqest, op.dtvalidpdop
        from ppop op
            where op.codemp = new.codemp and op.codfilial=new.codfilial and op.codop=new.codop
                and op.seqop=new.seqop
        into :icodempest,:icodfilialest,:icodprodest,:iseqest,:ddtvalidop;

    ddtdescarte = cast(addmonth(:ddtvalidop,:imesesdesccp) as date);

    insert into ppretcp (codemp,codfilial,codop,seqop,dtdescarte)
        values(new.codemp,new.codfilial, new.codop,new.seqop,:ddtdescarte);

    for select it.codemppd,it.codfilialpd,it.codprodpd,it.seqitest,it.qtditest
        from ppitestrutura it
            where it.codemp = :icodempest and it.codfilial=:icodfilialest and it.codprod=:icodprodest
                and it.seqest = :iseqest and it.codempfs=new.codempfs and it.codfilialfs=new.codfilialfs
                and it.codfase = new.codfase
        into :icodemppd,:icodfilialpd,:icodprodpd,:icoditretcp,:iqtd do
        begin
            insert into ppitretcp (codemp,codfilial,codop,seqop,coditretcp,codemppd,codfilialpd,codprod,qtditret)
            values(new.codemp,new.codfilial,new.codop,new.seqop, :icoditretcp,:icodemppd,:icodfilialpd,:icodprodpd,:iqtd);
        end
  end
  end
^

/* Trigger: PPOPFASETGBU0 */
CREATE TRIGGER PPOPFASETGBU0 FOR PPOPFASE
ACTIVE BEFORE UPDATE POSITION 0
as
declare variable finaliza char(2);
declare variable qtdpe smallint;
declare variable icodemptm int;
declare variable icodfilialtm smallint;
declare variable icodtipomov integer;

begin

    new.DTALT=cast('now' AS DATE);
    new.IDUSUALT=USER;
    new.HALT = cast('now' AS TIME);

    if ((new.sitfs!='FN') and (new.datafimprodfs is not null)) then
    begin

        new.sitfs = 'FN';

        select ef.finalizaop
            from ppestrufase ef, ppopfase pf, ppop op
            where
                ef.codemp = op.codemppd and ef.codfilial = op.codfilialpd
                and ef.codprod = op.codprod and ef.seqest = op.seqest
                and ef.codempfs = pf.codempfs and ef.codfilialfs = pf.codfilialfs
                and ef.codfase = pf.codfase and pf.codemp = op.codemp
                and pf.codfilial = op.codfilial and pf.codop = op.codop
                and pf.seqop = op.seqop and pf.seqof = new.seqof
                and op.codemp=new.codemp and op.codfilial=new.codfilial
                and op.codop=new.codop and op.seqop=new.seqop and ef.seqef = pf.seqof
             into :finaliza;

        if (:finaliza='S') then
            begin
                select count(1)
                    from ppopfase pf
                    where pf.codemp = new.codemp and pf.codfilial=new.codfilial
                        and pf.codop=new.codop and pf.seqop=new.seqop and pf.sitfs<>'FN'
                into :qtdpe;

                if(:qtdpe>1) then
                begin
                    exception ppopfase 'O processo não poderá ser concluído, pois existem fases pendentes!';
                end
                else
                begin
                    update ppop set sitop = 'FN'
                        where codemp = new.codemp and codfilial = new.codfilial
                            and codop = new.codop and seqop = new.seqop;
                end
            end
        end
end
^

/* Trigger: PPOPTGAD */
CREATE TRIGGER PPOPTGAD FOR PPOP
ACTIVE AFTER DELETE POSITION 0
AS
declare variable preco decimal;
begin
  select sum(pd.custompmprod) from ppitop it, eqproduto pd where it.codemp=old.codemp and it.codfilial=it.codfilial and
    it.codop=old.codop and it.seqop=old.seqop and
    pd.codemp=it.codemppd and pd.codfilial=it.codfilialpd and pd.codprod=it.codprod into :preco;

   EXECUTE PROCEDURE EQMOVPRODIUDSP('D',old.CODEMPPD, old.CODFILIALPD, old.CODPROD,
        old.CODEMPLE, old.CODFILIALLE, old.codlote, old.codemptm,
        old.codfilialtm, old.codtipomov, null, null, null ,null, null,
        null, null, null, null, null, null,
        null, null, null, null, null, old.codemp, old.codfilial, old.codop, old.seqop,
        null, null, null,
        old.dtfabrop, old.codop, 'N', old.qtdfinalprodop,:preco,
        old.codempax, old.codfilialax, old.codalmox );

   if (old.CODOPM is not null) then
      EXECUTE PROCEDURE PPATUDISTOPSP(old.CODEMPOPM, old.CODFILIALOPM, old.CODOPM,
        old.SEQOPM, old.QTDDISTIOP, 0);

end
^

/* Trigger: PPOPTGAI */
CREATE TRIGGER PPOPTGAI FOR PPOP
ACTIVE AFTER INSERT POSITION 0
as
declare variable preco numeric;
declare variable qtdest numeric;
begin
   EXECUTE PROCEDURE PPITOPSP01(new.CODEMP, new.CODFILIAL, new.CODOP, new.SEQOP);

   EXECUTE PROCEDURE ppgeraopcq (new.CODEMP, new.CODFILIAL, new.CODOP, new.SEQOP);

   select sum(pd.custompmprod) from ppitop it, eqproduto pd where it.codemp=new.codemp and
   it.codfilial=it.codfilial and it.codop=new.codop and it.seqop=new.seqop and
   pd.codemp=it.codemppd and pd.codfilial=it.codfilialpd and
   pd.codprod=it.codprod into :preco;

   select pe.qtdest from ppestrutura pe
      where pe.codemp=new.codemppd and pe.codfilial=new.codfilialpd and
      pe.codprod=new.codprod and pe.seqest=new.seqest into :qtdest;

   EXECUTE PROCEDURE EQMOVPRODIUDSP('I',new.CODEMPPD, new.CODFILIALPD, new.CODPROD,
        new.CODEMPLE, new.CODFILIALLE, new.codlote, new.codemptm,
        new.codfilialtm, new.codtipomov, null, null, null ,null, null,
        null, null, null, null, null, null,
        null, null, null, null, null,new.codemp, new.codfilial,new.codop, new.seqop,
        null, null,  null, new.dtfabrop, new.codop,
        'N',new.qtdfinalprodop,cast(:preco as numeric(15,5)),
        NEW.codempax, NEW.codfilialax, NEW.codalmox );
   if (new.CODOPM is not null) then
      EXECUTE PROCEDURE PPATUDISTOPSP(new.CODEMPOPM, new.CODFILIALOPM, new.CODOPM,
        new.SEQOPM, 0, new.QTDDISTIOP);
end
^

/* Trigger: PPOPTGAU */
CREATE TRIGGER PPOPTGAU FOR PPOP
ACTIVE AFTER UPDATE POSITION 0
as
declare variable preco decimal;
declare variable qtdest decimal;
declare variable icodemprma integer;
declare variable icodfilialrma smallint;
declare variable icodrma integer;
begin

    /*Cancelamento de O.P */
    
    if(old.sitop!='CA' and new.sitop = 'CA') then
    begin

        /* Cancelamento de movimentação de estoque */

        execute procedure eqmovprodiudsp('D',new.codemppd, new.codfilialpd, new.codprod,
                new.CODEMPLE, new.CODFILIALLE, new.codlote, new.codemptm,
                new.codfilialtm, new.codtipomov, null, null, null ,null, null,
                null, null, null, null, null, null,null, null, null, null, null,
                new.codemp, new.codfilial,new.codop,new.seqop, null, null, null,
                new.dtfabrop, new.codop, null, new.qtdfinalprodop,:preco,
                new.codempax, new.codfilialax, new.codalmox );

        /* Cancelamento de RMA */

        for select rma.codemp, rma.codfilial, rma.codrma
                from eqrma rma
                where rma.codempof=new.codemp and rma.codfilialof=new.codfilial
                    and rma.codop=new.codop and rma.seqop=new.seqop
            into :icodemprma, :icodfilialrma, :icodrma
            do
            begin
                update eqitrma itr set itr.sititrma='PE'
                    where itr.codemp=:icodemprma and itr.codfilial=:icodfilialrma and itr.codrma=:icodrma;

                delete from eqitrma itr
                    where itr.codemp=:icodemprma and itr.codfilial=:icodfilialrma and itr.codrma=:icodrma;

            end

        delete from eqrma rma
            where rma.codemp=:icodemprma and rma.codfilial=:icodfilialrma and rma.codrma=:icodrma;

        if(new.seqop>0) then
        begin
            update ppop set qtddistpop = qtddistpop - new.qtddistiop
            where codemp=new.codemp and codfilial=new.codfilial and
            codop=new.codop and seqop=0 ;
        end

    end

    /* Outras ações */

    else
    begin
        if (old.qtdprevprodop <> new.qtdprevprodop ) then
        begin
            delete from ppitop
                where codemp=new.codemp AND codfilial=new.codfilial
                    and codop=new.codop and seqop=new.seqop;

            delete from PPOPFASE
                where codemp=new.codemp and codfilial=new.codfilial
                    and codop=new.codop and seqop=new.seqop;

            execute procedure ppitopsp01(new.codemp, new.codfilial, new.codop, new.seqop);
        end

        select sum(pd.custompmprod) from ppitop it, eqproduto pd
            where it.codemp=new.codemp and it.codfilial=it.codfilial
                and it.codop=new.codop and it.seqop=new.seqop
                and pd.codemp=it.codemppd and pd.codfilial=it.codfilialpd
                and pd.codprod=it.codprod
        into :preco;

        select pe.qtdest from ppestrutura pe
            where pe.codemp=new.codemppd and pe.codfilial=new.codfilialpd
                and pe.codprod=new.codprod and pe.seqest=new.seqest
        into :qtdest;

        if( (old.qtdfinalprodop <> new.qtdfinalprodop) and (new.qtdfinalprodop>0) ) then
        begin
            execute procedure eqmovprodiudsp('U',new.codemppd, new.codfilialpd, new.codprod,
                new.CODEMPLE, new.CODFILIALLE, new.codlote, new.codemptm,
                new.codfilialtm, new.codtipomov, null, null, null ,null, null,
                null, null, null, null, null, null,null, null, null, null, null,
                new.codemp, new.codfilial,new.codop,new.seqop, null, null, null,
                new.dtfabrop, new.codop, 'N', new.qtdfinalprodop,:preco,
                new.codempax, new.codfilialax, new.codalmox );

            execute procedure ppitopsp02(new.codemp, new.codfilial, new.codop, new.seqop);
        end
        if (new.CODOPM is not null) then
            execute procedure ppatudistopsp(new.codempopm, new.codfilialopm, new.codopm,
                new.seqopm, old.qtddistiop, new.qtddistiop);

    end

end
^

/* Trigger: PPOPTGBI */
CREATE TRIGGER PPOPTGBI FOR PPOP
ACTIVE BEFORE INSERT POSITION 0
as
begin
   SELECT REFPROD FROM EQPRODUTO WHERE CODEMP=new.CODEMP AND
    CODFILIAL=new.CODFILIAL AND CODPROD=new.CODPROD INTO new.REFPROD;
end
^

/* Trigger: PPOPTGBU */
CREATE TRIGGER PPOPTGBU FOR PPOP
ACTIVE BEFORE UPDATE POSITION 0
as
begin
    new.DTALT=cast('now' AS DATE);
    new.IDUSUALT=USER;
    new.HALT = cast('now' AS TIME);
    SELECT REFPROD FROM EQPRODUTO WHERE CODEMP=new.CODEMP AND
    CODFILIAL=new.CODFILIAL AND CODPROD=new.CODPROD INTO new.REFPROD;

    if(new.qtdfinalprodop>0 and new.qtdfinalprodop<>old.qtdfinalprodop) then
        begin
            select coalesce(tm.codemptm,tm.codemp),coalesce(tm.codfilialtm,tm.codfilial),coalesce(tm.codtipomovtm,tm.codtipomov)
                from eqtipomov tm, ppop op
                    where tm.codemp=op.codemptm and tm.codfilial=op.codfilialtm and tm.codtipomov=op.codtipomov
                        and op.codemp=new.codemp and op.codfilial=new.codfilial and op.codop=new.codop
                        and op.seqop=new.seqop
                into new.codemptm,new.codfilialtm,new.codtipomov;
            new.sitop='FN';
        end

     if(new.sitop='CA' and old.sitop<>'CA') then
        begin
            new.idusucanc=USER;
            new.dtcanc=cast('now' AS DATE);
            new.hcanc = cast('now' AS TIME);
        end

end
^

/* Trigger: PPRECURSOTGBU */
CREATE TRIGGER PPRECURSOTGBU FOR PPRECURSO
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: PPRETCPTGBU */
CREATE TRIGGER PPRETCPTGBU FOR PPRETCP
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: PPTIPOANALISETGBU */
CREATE TRIGGER PPTIPOANALISETGBU FOR PPTIPOANALISE
ACTIVE BEFORE UPDATE POSITION 0
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: PPTIPORECTGBU */
CREATE TRIGGER PPTIPORECTGBU FOR PPTIPOREC
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: PVCAIXAIMPTGBU */
CREATE TRIGGER PVCAIXAIMPTGBU FOR PVCAIXAIMP
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: PVCAIXATGBU */
CREATE TRIGGER PVCAIXATGBU FOR PVCAIXA
ACTIVE BEFORE UPDATE POSITION 0
as
  DECLARE VARIABLE ICOUNTSEQ INTEGER;
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT=cast('now' AS TIME);
  
  IF ((old.SEQINI<>new.SEQINI) or (old.SEQMAX<>new.SEQMAX) ) THEN
  BEGIN
     SELECT COUNT(SEQCAIXA) FROM PVSEQUENCIA
        WHERE CODEMP=new.CODEMP AND CODFILIAL=new.CODFILIAL
        AND CODCAIXA=new.CODCAIXA
        INTO :ICOUNTSEQ;
     IF (:ICOUNTSEQ > 0) THEN
        EXCEPTION PVSEQCAIXA01 'JÁ EXISTEM VENDAS DENTRO DESTA FAIXA DE VENDA';
  END

  EXECUTE PROCEDURE PVVALIDFAIXACAIXASP(new.CODEMP, new.CODFILIAL, new.CODCAIXA, new.SEQINI, new.SEQMAX);

end
^

/* Trigger: PVLEITURAXTGBU */
CREATE TRIGGER PVLEITURAXTGBU FOR PVLEITURAX
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: PVMOVCAIXATGBI */
CREATE TRIGGER PVMOVCAIXATGBI FOR PVMOVCAIXA
ACTIVE BEFORE INSERT POSITION 0
as
declare variable iMov INTEGER;
declare variable dSaldo NUMERIC(15, 5);
begin
  if (new.vlrsldmov is NULL) then
  BEGIN
    SELECT MAX(NROMOV) FROM PVMOVCAIXA WHERE CODEMP=new.CODEMP
      AND CODFILIAL=new.CODFILIAL AND CODCAIXA=new.CODCAIXA
      AND DTAMOV=new.DTAMOV INTO iMov;
    SELECT coalesce(vlrsldmov,0) FROM PVMOVCAIXA WHERE CODEMP=new.CODEMP
      AND CODFILIAL=new.CODFILIAL AND CODCAIXA=new.CODCAIXA
      AND DTAMOV=new.DTAMOV AND NROMOV=:iMov INTO dSaldo;
    new.vlrsldmov = dSaldo + new.vlrmov;
  END
end
^

/* Trigger: PVSEQMOVCAIXATGBU */
CREATE TRIGGER PVSEQMOVCAIXATGBU FOR PVSEQMOVCAIXA
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: RHBENEFICIOTGBU */
CREATE TRIGGER RHBENEFICIOTGBU FOR RHBENEFICIO
ACTIVE BEFORE UPDATE POSITION 0
AS
begin
   new.DTALT=cast('now' AS DATE);
    new.IDUSUALT=USER;
    new.HALT = cast('now' AS TIME);
end
^

/* Trigger: RHCANDIDATOTGAI */
CREATE TRIGGER RHCANDIDATOTGAI FOR RHCANDIDATO
ACTIVE AFTER INSERT POSITION 0
AS
begin
  INSERT INTO RHCANDIDATOSTATUS (CODEMP,CODFILIAL,CODCAND,STCAND,DTSTATUS,SQSTCAND)
  VALUES(NEW.codemp, NEW.codfilial, NEW.codcand, NEW.stcand ,NEW.dtultst,
  coalesce((SELECT max(SQSTCAND) FROM RHCANDIDATOSTATUS where CODEMP = NEW.codemp
  AND CODFILIAL = NEW.CODFILIAL AND CODCAND = NEW.CODCAND),0) + 1 );
end
^

/* Trigger: RHCANDIDATOTGAU01 */
CREATE TRIGGER RHCANDIDATOTGAU01 FOR RHCANDIDATO
ACTIVE AFTER UPDATE POSITION 0
AS
begin
  if(new.stcand<>old.stcand) then
  begin
    insert into rhcandidatostatus (CODEMP,CODFILIAL,CODCAND,SQSTCAND,DTSTATUS,STCAND)
             VALUES (new.CODEMP,new.codfilial,new.codcand,
             (select coalesce(max(sqstcand),0) + 1 from rhcandidatostatus 
              where codemp=new.codemp and codfilial=new.codfilial
              and codcand=new.codcand)
             ,cast('now' AS DATE ),new.stcand);
  end
end
^

/* Trigger: RHCANDIDATOTGBD */
CREATE TRIGGER RHCANDIDATOTGBD FOR RHCANDIDATO
ACTIVE BEFORE DELETE POSITION 0
AS
begin
  delete from rhcandidatostatus r where r.codemp=old.codemp and r.codfilial=old.codfilial
  and r.codcand=old.codcand;
end
^

/* Trigger: RHCARACTERISTICATGBU */
CREATE TRIGGER RHCARACTERISTICATGBU FOR RHCARACTERISTICA
ACTIVE AFTER INSERT POSITION 0
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: RHEMPREGADOBENEFTGBU */
CREATE TRIGGER RHEMPREGADOBENEFTGBU FOR RHEMPREGADOBENEF
ACTIVE BEFORE UPDATE POSITION 0
AS
begin
   new.DTALT=cast('now' AS DATE);
    new.IDUSUALT=USER;
    new.HALT = cast('now' AS TIME);
end
^

/* Trigger: RHEMPREGADOSALTGBU */
CREATE TRIGGER RHEMPREGADOSALTGBU FOR RHEMPREGADOSAL
ACTIVE BEFORE UPDATE POSITION 0
AS
begin
   new.DTALT=cast('now' AS DATE);
    new.IDUSUALT=USER;
    new.HALT = cast('now' AS TIME);
end
^

/* Trigger: RHEMPREGADOTGAI */
CREATE TRIGGER RHEMPREGADOTGAI FOR RHEMPREGADO
ACTIVE AFTER INSERT POSITION 0
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: RHVAGACANDIDATOTGAU */
CREATE TRIGGER RHVAGACANDIDATOTGAU FOR RHVAGACANDIDATO
ACTIVE AFTER UPDATE POSITION 0
AS
begin
    update RHCANDIDATO set STCAND=NEW.stvagacand WHERE
    CODEMP=NEW.codempca AND CODFILIAL=NEW.codfilialca AND
    CODCAND=NEW.codcand;

    insert into RHCANDIDATOSTATUS (CODEMP,CODFILIAL,CODCAND,STCAND,SQSTCAND,CODEMPVG,CODFILIALVG,CODVAGA)
      VALUES(NEW.codemp, NEW.codfilial, NEW.codcand, NEW.stvagacand ,
      coalesce((SELECT max(SQSTCAND) FROM RHCANDIDATOSTATUS where CODEMP = NEW.codemp
      AND CODFILIAL = NEW.CODFILIAL AND CODCAND = NEW.CODCAND),0) + 1 ,NEW.codemp,NEW.codfilial,NEW.codvaga);
end
^

/* Trigger: RHVAGACANDIDATOTGBI */
CREATE TRIGGER RHVAGACANDIDATOTGBI FOR RHVAGACANDIDATO
ACTIVE AFTER INSERT POSITION 0
AS
begin
    update RHCANDIDATO set STCAND=NEW.stvagacand WHERE
    CODEMP=NEW.codempca AND CODFILIAL=NEW.codfilialca AND
    CODCAND=NEW.codcand;

    insert into RHCANDIDATOSTATUS (CODEMP,CODFILIAL,CODCAND,STCAND,SQSTCAND,CODEMPVG,CODFILIALVG,CODVAGA)
      VALUES(NEW.codemp, NEW.codfilial, NEW.codcand, NEW.stvagacand ,
      coalesce((SELECT max(SQSTCAND) FROM RHCANDIDATOSTATUS where CODEMP = NEW.codemp
      AND CODFILIAL = NEW.CODFILIAL AND CODCAND = NEW.CODCAND),0) + 1 ,NEW.codemp,NEW.codfilial,NEW.codvaga);
end
^

/* Trigger: RHVAGATGAI */
CREATE TRIGGER RHVAGATGAI FOR RHVAGA
ACTIVE AFTER INSERT POSITION 0
AS
begin
  INSERT INTO RHVAGASTATUS (CODEMP,CODFILIAL,CODVAGA,STVAGA,DTSTATUS,SQSTVAGA)
  VALUES(NEW.codemp, NEW.codfilial, NEW.codvaga, NEW.stvaga ,NEW.dtultst,
  coalesce((SELECT MAX(SQSTVAGA) FROM RHVAGASTATUS where CODEMP = NEW.codemp
  AND CODFILIAL = NEW.CODFILIAL AND CODVAGA = NEW.CODVAGA),0) + 1 );
end
^

/* Trigger: RHVAGATGAU */
CREATE TRIGGER RHVAGATGAU FOR RHVAGA
ACTIVE AFTER UPDATE POSITION 0
AS
begin
    IF(OLD.stvaga!=NEW.stvaga) THEN
    BEGIN
      INSERT INTO RHVAGASTATUS (CODEMP,CODFILIAL,CODVAGA,STVAGA,DTSTATUS,SQSTVAGA)
      VALUES(NEW.codemp, NEW.codfilial, NEW.codvaga, NEW.stvaga ,NEW.dtultst,
      coalesce((SELECT MAX(SQSTVAGA) FROM RHVAGASTATUS where CODEMP = NEW.codemp
      AND CODFILIAL = NEW.CODFILIAL AND CODVAGA = NEW.CODVAGA),0) + 1 );
    END
end
^

/* Trigger: RHVAGATGBD */
CREATE TRIGGER RHVAGATGBD FOR RHVAGA
ACTIVE BEFORE DELETE POSITION 0
AS
begin
  delete from rhvagastatus r where r.codemp=old.codemp and r.codfilial=old.codfilial
  and r.codvaga=old.codvaga;
end
^

/* Trigger: RHVAGATGBU */
CREATE TRIGGER RHVAGATGBU FOR RHVAGA
ACTIVE BEFORE UPDATE POSITION 0
AS Declare variable I integer;
BEGIN I = 0; END
^

/* Trigger: SGACESSOEUTGBU */
CREATE TRIGGER SGACESSOEUTGBU FOR SGACESSOEU
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGACESSOMGTGBU */
CREATE TRIGGER SGACESSOMGTGBU FOR SGACESSOMG
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGAGENTETGBU */
CREATE TRIGGER SGAGENTETGBU FOR SGAGENTE
ACTIVE BEFORE UPDATE POSITION 0
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGATRIBUICAOTGBU */
CREATE TRIGGER SGATRIBUICAOTGBU FOR SGATRIBUICAO
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGATRIBUSUTGBU */
CREATE TRIGGER SGATRIBUSUTGBU FOR SGATRIBUSU
ACTIVE BEFORE UPDATE POSITION 0
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGEMPRESATGBU */
CREATE TRIGGER SGEMPRESATGBU FOR SGEMPRESA
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGEQVCLIFORTGBU0 */
CREATE TRIGGER SGEQVCLIFORTGBU0 FOR SGEQVCLIFOR
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT=cast('now' AS TIME);
end
^

/* Trigger: SGESTACAOIMPTGBU */
CREATE TRIGGER SGESTACAOIMPTGBU FOR SGESTACAOIMP
ACTIVE BEFORE UPDATE POSITION 0
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGESTACAOTGBU */
CREATE TRIGGER SGESTACAOTGBU FOR SGESTACAO
ACTIVE BEFORE UPDATE POSITION 0
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGFERIADOBTGU */
CREATE TRIGGER SGFERIADOBTGU FOR SGFERIADO
ACTIVE BEFORE UPDATE POSITION 0
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGFILIALTGBU */
CREATE TRIGGER SGFILIALTGBU FOR SGFILIAL
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGFLUXOTGBU */
CREATE TRIGGER SGFLUXOTGBU FOR SGFLUXO
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGGATILHOTGBU */
CREATE TRIGGER SGGATILHOTGBU FOR SGGATILHO
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGGRAUINSTTGBU */
CREATE TRIGGER SGGRAUINSTTGBU FOR SGGRAUINST
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGGRPUSUTGBU */
CREATE TRIGGER SGGRPUSUTGBU FOR SGGRPUSU
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGIMPRESSORATGBU */
CREATE TRIGGER SGIMPRESSORATGBU FOR SGIMPRESSORA
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGITFLUXOTGBU */
CREATE TRIGGER SGITFLUXOTGBU FOR SGITFLUXO
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGITPREFERE6TGBU */
CREATE TRIGGER SGITPREFERE6TGBU FOR SGITPREFERE6
ACTIVE BEFORE UPDATE POSITION 0
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGITPROCESSOTGBU */
CREATE TRIGGER SGITPROCESSOTGBU FOR SGITPROCESSO
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGITTABELATGBU */
CREATE TRIGGER SGITTABELATGBU FOR SGITTABELA
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGMENUOBJTGBU */
CREATE TRIGGER SGMENUOBJTGBU FOR SGMENUOBJ
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGMENUTGBI */
CREATE TRIGGER SGMENUTGBI FOR SGMENU
ACTIVE BEFORE INSERT POSITION 0
AS
begin
  if (new.CODSIS=1) then
  begin
     if (new.NOMEMENU is null) then
        new.NOMEMENU = new.DESCMENU;
     if (new.ACAOMENU is null) then
        new.ACAOMENU = cast(new.CODMENU as CHAR(30));
  end 
end
^

/* Trigger: SGMENUTGBU */
CREATE TRIGGER SGMENUTGBU FOR SGMENU
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGMODETIQUETATGBU */
CREATE TRIGGER SGMODETIQUETATGBU FOR SGMODETIQUETA
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGMODULOTGBU */
CREATE TRIGGER SGMODULOTGBU FOR SGMODULO
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGOBJETOTBTGBU */
CREATE TRIGGER SGOBJETOTBTGBU FOR SGOBJETOTB
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGOBJETOTGBU */
CREATE TRIGGER SGOBJETOTGBU FOR SGOBJETO
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGPAPELTGBU */
CREATE TRIGGER SGPAPELTGBU FOR SGPAPEL
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGPREFERE1TGAU */
CREATE TRIGGER SGPREFERE1TGAU FOR SGPREFERE1
ACTIVE AFTER UPDATE POSITION 0
AS
    declare variable scodfilialtm smallint;
begin
    /*Limpa flag de multiplos comissionados nos tipos de movimento.*/

    select rf.icodfilial from sgretfilial(new.codemp, 'EQTIPOMOV') rf
        into :scodfilialtm;

    if(old.multicomis = 'S' and new.multicomis = 'N') then
    begin
        update eqtipomov set mcomistipomov = 'N'
            where codemp=new.codemp and codfilial=:scodfilialtm
            and mcomistipomov='S';
    end
end
^

/* Trigger: SGPREFERE1TGBU */
CREATE TRIGGER SGPREFERE1TGBU FOR SGPREFERE1
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGPREFERE2TGBU */
CREATE TRIGGER SGPREFERE2TGBU FOR SGPREFERE2
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGPREFERE3TGBU */
CREATE TRIGGER SGPREFERE3TGBU FOR SGPREFERE3
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGPREFERE4TGBU */
CREATE TRIGGER SGPREFERE4TGBU FOR SGPREFERE4
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGPREFERE5_BU0 */
CREATE TRIGGER SGPREFERE5_BU0 FOR SGPREFERE5
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGPREFERE6TGBU */
CREATE TRIGGER SGPREFERE6TGBU FOR SGPREFERE6
ACTIVE BEFORE UPDATE POSITION 0
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGPROCESSOTGBU */
CREATE TRIGGER SGPROCESSOTGBU FOR SGPROCESSO
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGSEQUENCIATGBU */
CREATE TRIGGER SGSEQUENCIATGBU FOR SGSEQUENCIA
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGSISTEMATGBU */
CREATE TRIGGER SGSISTEMATGBU FOR SGSISTEMA
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGTABELATGBU */
CREATE TRIGGER SGTABELATGBU FOR SGTABELA
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGTAREFATGBU */
CREATE TRIGGER SGTAREFATGBU FOR SGTAREFA
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGTRATARETAI */
CREATE TRIGGER SGTRATARETAI FOR SGTRATARET
ACTIVE AFTER INSERT POSITION 0
as
begin
  IF (new.CODPROCGT IS NULL AND NOT new.SEQITPROCGT IS NULL) THEN
    new.CODPROCGT = new.CODPROC;
end
^

/* Trigger: SGTRATARETTGBU */
CREATE TRIGGER SGTRATARETTGBU FOR SGTRATARET
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: SGUSUARIOTGBD */
CREATE TRIGGER SGUSUARIOTGBD FOR SGUSUARIO
ACTIVE BEFORE DELETE POSITION 0
AS
  DECLARE VARIABLE CODAGE INTEGER;
begin
  SELECT CODAGE FROM SGAGENTEUIDSP('D', old.CODEMP, old.TIPOAGE, old.CODAGE, old.NOMEUSU)
     INTO :CODAGE;
end
^

/* Trigger: SGUSUARIOTGBI */
CREATE TRIGGER SGUSUARIOTGBI FOR SGUSUARIO
ACTIVE BEFORE INSERT POSITION 0
AS
begin
   SELECT CODEMP, CODFILIAL, TIPOAGE, CODAGE
      FROM SGAGENTEUIDSP('I',new.CODEMP, 'SGUSU', null, new.NOMEUSU)
        INTO new.CODEMPAE, new.CODFILIALAE, new.TIPOAGE, new.CODAGE;
end
^

/* Trigger: SGUSUARIOTGBU */
CREATE TRIGGER SGUSUARIOTGBU FOR SGUSUARIO
ACTIVE BEFORE UPDATE POSITION 0
AS
  DECLARE VARIABLE CUID CHAR(1);
/*  declare variable CTEMP CHAR(256); */
begin
   IF (new.CODAGE IS NULL) THEN
      CUID = 'I';
   else
      CUID = 'U';
  /* CTEMP = printlog('CUID: '||:CUID);
   CTEMP = printlog('codemp: '||NEW.CODEMP);
   CTEMP = printlog('codfilial: '||NEW.CODFILIAL);
   CTEMP = printlog('CODAGE: '||NEW.CODAGE);
   */
   SELECT CODEMP, CODFILIAL, TIPOAGE, CODAGE
      FROM SGAGENTEUIDSP(:CUID,new.CODEMP, 'SGUSU', new.CODAGE, new.NOMEUSU)
        INTO new.CODEMPAE, new.CODFILIALAE, new.TIPOAGE, new.CODAGE;
   /*CTEMP = printlog('CUID: '||:CUID);
   CTEMP = printlog('codemp: '||NEW.CODEMP);
   CTEMP = printlog('codfilial: '||NEW.CODFILIAL);
   CTEMP = printlog('CODAGE: '||NEW.CODAGE);
   */
end
^

/* Trigger: SGVARIAVELTGBU */
CREATE TRIGGER SGVARIAVELTGBU FOR SGVARIAVEL
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT=cast('now'AS TIME);
end
^

/* Trigger: TKATIVIDADETGBU */
CREATE TRIGGER TKATIVIDADETGBU FOR TKATIVIDADE
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: TKCAMPANHATGBU */
CREATE TRIGGER TKCAMPANHATGBU FOR TKCAMPANHA
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: TKCONFEMAILTGBU */
CREATE TRIGGER TKCONFEMAILTGBU FOR TKCONFEMAIL
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: TKCONTATOTGBI */
CREATE TRIGGER TKCONTATOTGBI FOR TKCONTATO
ACTIVE BEFORE INSERT POSITION 0
AS
    declare variable nomemuniccto CHAR(30);
begin

    /*Atualização do campo cidade e estado (temporário para retro-compatibilidade)*/

    if(new.codmunic is not null) then
    begin
        select substr(mun.nomemunic,1,30) from sgmunicipio mun
            where mun.codpais=new.codpais and mun.siglauf=new.siglauf and mun.codmunic=new.codmunic
                into :nomemuniccto;
        if (nomemuniccto is not null) then new.cidcto = nomemuniccto;
    end

    if(new.siglauf is not null) then
    begin
        new.ufcto=new.siglauf;
    end

    /* Fim da atualização do campo cidade e estado*/

end
^

/* Trigger: TKCONTATOTGBU */
CREATE TRIGGER TKCONTATOTGBU FOR TKCONTATO
ACTIVE BEFORE UPDATE POSITION 0
as
  declare variable nomemuniccto CHAR(30);
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);

   /*Atualização do campo cidade e estado (temporário para retro-compatibilidade)*/

    if(old.codmunic != new.codmunic) then
    begin
        select substr(mun.nomemunic,1,30) from sgmunicipio mun
            where mun.codpais=new.codpais and mun.siglauf=new.siglauf and mun.codmunic=new.codmunic
                into :nomemuniccto;
        if (nomemuniccto is not null) then new.cidcto = nomemuniccto;
    end

    if(new.siglauf is not null) then
    begin
        new.ufcto=new.siglauf;
    end

    /* Fim da atualização do campo cidade */

end
^

/* Trigger: TKCTOATIVTGBU */
CREATE TRIGGER TKCTOATIVTGBU FOR TKCTOATIV
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: TKCTOGRPINTTGBU */
CREATE TRIGGER TKCTOGRPINTTGBU FOR TKCTOGRPINT
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: TKEMAILTGBU */
CREATE TRIGGER TKEMAILTGBU FOR TKEMAIL
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: TKHISTORICOTGBU */
CREATE TRIGGER TKHISTORICOTGBU FOR TKHISTORICO
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: TKORIGCONTTGBU */
CREATE TRIGGER TKORIGCONTTGBU FOR TKORIGCONT
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);

end
^

/* Trigger: TKSETORCTOTGBU */
CREATE TRIGGER TKSETORCTOTGBU FOR TKSETORCTO
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: TKTIPOIMPTGBU */
CREATE TRIGGER TKTIPOIMPTGBU FOR TKTIPOIMP
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: VDAUXVENDATGBU */
CREATE TRIGGER VDAUXVENDATGBU FOR VDAUXVENDA
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: VDCLASCLITGBU */
CREATE TRIGGER VDCLASCLITGBU FOR VDCLASCLI
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: VDCLCOMISTGBI */
CREATE TRIGGER VDCLCOMISTGBI FOR VDCLCOMIS
ACTIVE BEFORE INSERT POSITION 0
AS
begin
  if ( (new.percfatclcomis+new.percpgtoclcomis) != 100.00) then
  begin
     exception VDCLCOMISEX01;
  end
  /* Trigger text */
end
^

/* Trigger: VDCLCOMISTGBU */
CREATE TRIGGER VDCLCOMISTGBU FOR VDCLCOMIS
ACTIVE BEFORE UPDATE POSITION 0
AS
begin
  if ( (new.percfatclcomis+new.percpgtoclcomis) != 100.00) then
  begin
     exception VDCLCOMISEX01;
  end
end
^

/* Trigger: VDCLIENTEFORTGBU */
CREATE TRIGGER VDCLIENTEFORTGBU FOR VDCLIENTEFOR
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: VDCLIENTETGBI */
CREATE TRIGGER VDCLIENTETGBI FOR VDCLIENTE
ACTIVE BEFORE INSERT POSITION 0
as
    declare variable nomemuniccli CHAR(30);
    declare variable nomemunicent CHAR(30);
    declare variable nomemuniccob CHAR(30);
begin

    if (new.codpesq is null) then
    begin
        new.codemppq = new.codemp;
        new.codfilialpq = new.codfilial;
        new.codpesq = new.codcli;
    end

    /*Atualização do campo cidade e estado (temporário para retro-compatibilidade)*/

    if(new.codmunic is not null) then
    begin
        select substr(mun.nomemunic,1,30) from sgmunicipio mun
            where mun.codpais=new.codpais and mun.siglauf=new.siglauf and mun.codmunic=new.codmunic
                into :nomemuniccli;
        if (nomemuniccli is not null) then new.cidcli = nomemuniccli;
    end

    if(new.siglauf is not null) then
    begin
        new.ufcli=new.siglauf;
    end

    if(new.codmunicent is not null) then
    begin
        select substr(mun.nomemunic,1,30) from sgmunicipio mun
            where mun.codpais=new.codpaisent and mun.siglauf=new.siglaufent and mun.codmunic=new.codmunicent
                into :nomemunicent;

        if (nomemunicent is not null) then new.cident = nomemunicent;
    end

    if(new.siglaufent is not null) then
    begin
        new.ufent=new.siglaufent;
    end

    if(new.codmuniccob is not null) then
    begin
        select substr(mun.nomemunic,1,30) from sgmunicipio mun
            where mun.codpais=new.codpaiscob and mun.siglauf=new.siglaufcob and mun.codmunic=new.codmuniccob
                into :nomemuniccob;

        if (nomemuniccob is not null) then new.cidcob = nomemuniccob;
    end

    if(new.siglaufcob is not null) then
    begin
        new.ufcob=new.siglaufcob;
    end

    /* Fim da atualização do campo cidade e estado*/

end
^

/* Trigger: VDCLIENTETGBU */
CREATE TRIGGER VDCLIENTETGBU FOR VDCLIENTE
ACTIVE BEFORE UPDATE POSITION 0
as
    declare variable nomemuniccli CHAR(30);
    declare variable nomemunicent CHAR(30);
    declare variable nomemuniccob CHAR(30);
begin
    new.DTALT=cast('now' AS DATE);
    new.IDUSUALT=user;
    new.HALT = cast('now' AS TIME);

    if (new.codpesq is null) then
    begin
        new.codemppq = new.codemp;
        new.codfilialpq = new.codfilial;
        new.codpesq = new.codcli;
    end

    /*Atualização do campo cidade e estado (temporário para retro-compatibilidade)*/

    if ( ((old.codmunic is null) and (new.codmunic is not null)) or
         (old.codmunic<>new.codmunic) ) then
    begin
        select substr(mun.nomemunic,1,30) from sgmunicipio mun
            where mun.codpais=new.codpais and mun.siglauf=new.siglauf and mun.codmunic=new.codmunic
                into :nomemuniccli;
        if (nomemuniccli is not null) then new.cidcli = nomemuniccli;
    end

    if(new.siglauf is not null) then
    begin
        new.ufcli=new.siglauf;
    end

    if(old.codmunicent != new.codmunicent) then
    begin
        select substr(mun.nomemunic,1,30) from sgmunicipio mun
            where mun.codpais=new.codpaisent and mun.siglauf=new.siglaufent and mun.codmunic=new.codmunicent
                into :nomemunicent;

        if (nomemunicent is not null) then new.cident = nomemunicent;
    end

    if(new.siglaufent is not null) then
    begin
        new.ufent=new.siglaufent;
    end

    if(old.codmuniccob != new.codmuniccob) then
    begin
        select substr(mun.nomemunic,1,30) from sgmunicipio mun
            where mun.codpais=new.codpaiscob and mun.siglauf=new.siglaufcob and mun.codmunic=new.codmuniccob
                into :nomemuniccob;

        if (nomemuniccob is not null) then new.cidcob = nomemuniccob;
    end

    if(new.siglaufcob is not null) then
    begin
        new.ufcob=new.siglaufcob;
    end

    /* Fim da atualização do campo cidade */

end
^

/* Trigger: VDCOMISSAOTGBD */
CREATE TRIGGER VDCOMISSAOTGBD FOR VDCOMISSAO
ACTIVE BEFORE DELETE POSITION 0
AS
BEGIN
  IF (old.STATUSCOMI = 'CP') THEN
    EXCEPTION VDCOMISSAOEX01;
END
^

/* Trigger: VDCOMISSAOTGBI */
CREATE TRIGGER VDCOMISSAOTGBI FOR VDCOMISSAO
ACTIVE BEFORE INSERT POSITION 0
AS
begin
  new.DTINS = cast('now' AS DATE);
  new.IDUSUINS=USER;
  new.HINS = cast('now' AS TIME);
  new.VLRAPAGCOMI = new.VLRCOMI - new.VLRPAGOCOMI;
end
^

/* Trigger: VDCOMISSAOTGBU */
CREATE TRIGGER VDCOMISSAOTGBU FOR VDCOMISSAO
ACTIVE BEFORE UPDATE POSITION 0
AS
BEGIN
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  IF ( OLD.STATUSCOMI = 'CP' AND NEW.STATUSCOMI = 'C1' ) then
    EXCEPTION VDCOMISSAOEX01;
  ELSE if ( OLD.STATUSCOMI='CP' AND NEW.STATUSCOMI='CP' AND OLD.VLRCOMI!=NEW.VLRCOMI ) then
    EXCEPTION VDCOMISSAOEX01;
  ELSE IF ( OLD.STATUSCOMI = 'C1' AND NEW.STATUSCOMI = 'CP' ) then
    EXCEPTION VDCOMISSAOEX02;
  ELSE IF ( OLD.STATUSCOMI = 'CP' AND NEW.STATUSCOMI = 'CD' ) THEN /* Estorno de comissões */
  BEGIN
     new.STATUSCOMI ='C2';
     new.CODEMPCI = null;
     new.CODFILIALCI = null;
     new.CODPCOMI = null;
     new.VLRPAGOCOMI = 0;
  END
  IF ( new.VLRCOMI IS NULL) THEN
    new.VLRCOMI = 0;
  IF ( new.VLRPAGOCOMI IS NULL ) THEN
    new.VLRPAGOCOMI = 0;
  new.VLRAPAGCOMI = new.VLRCOMI - new.VLRPAGOCOMI;
END
^

/* Trigger: VDCONTRATOTGBU */
CREATE TRIGGER VDCONTRATOTGBU FOR VDCONTRATO
ACTIVE BEFORE UPDATE POSITION 0
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: VDFOTOPRODTGBU */
CREATE TRIGGER VDFOTOPRODTGBU FOR VDFOTOPROD
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: VDFRETEVDTGAI */
CREATE TRIGGER VDFRETEVDTGAI FOR VDFRETEVD
ACTIVE BEFORE INSERT POSITION 0
AS 
DECLARE VARIABLE VLRLIQVENDA NUMERIC(9,2);
BEGIN
  SELECT VLRLIQVENDA FROM VDVENDA WHERE TIPOVENDA=new.TIPOVENDA AND CODVENDA=new.CODVENDA AND
    CODEMP=new.CODEMP AND CODFILIAL=new.CODFILIAL INTO VLRLIQVENDA;
  IF (NOT VLRLIQVENDA IS NULL AND VLRLIQVENDA > 0 AND NOT new.PERCVENDAFRETEVD > 0) THEN
    new.PERCVENDAFRETEVD = (new.VLRFRETEVD/:VLRLIQVENDA)*100;
END
^

/* Trigger: VDFRETEVDTGBU */
CREATE TRIGGER VDFRETEVDTGBU FOR VDFRETEVD
ACTIVE BEFORE UPDATE POSITION 0
AS
DECLARE VARIABLE VLRLIQVENDA NUMERIC(9,2);
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  SELECT VLRLIQVENDA FROM VDVENDA WHERE TIPOVENDA=new.TIPOVENDA AND CODVENDA=new.CODVENDA AND
    CODEMP=new.CODEMP AND CODFILIAL=new.CODFILIAL INTO VLRLIQVENDA;
  IF (NOT VLRLIQVENDA IS NULL AND VLRLIQVENDA > 0) THEN
    new.PERCVENDAFRETEVD = (new.VLRFRETEVD/:VLRLIQVENDA)*100;
END
^

/* Trigger: VDITKITTGBI */
CREATE TRIGGER VDITKITTGBI FOR VDITKIT
ACTIVE BEFORE INSERT POSITION 0
AS
begin
  /* Trigger text */
  new.DTINS=cast('now' AS DATE);
  new.IDUSUINS=USER;
  new.HINS = cast('now' AS TIME);
  SELECT REFPROD FROM EQREFPRODSP(new.CODEMP, new.CODFILIAL, new.CODPROD) INTO new.REFPROD;
end
^

/* Trigger: VDITKITTGBU */
CREATE TRIGGER VDITKITTGBU FOR VDITKIT
ACTIVE BEFORE UPDATE POSITION 0
AS
begin
  /* Trigger text */
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  SELECT REFPROD FROM EQREFPRODSP(new.CODEMP, new.CODFILIAL, new.CODPROD) INTO new.REFPROD;
end
^

/* Trigger: VDITORCAMENTOTGAD */
CREATE TRIGGER VDITORCAMENTOTGAD FOR VDITORCAMENTO
ACTIVE AFTER DELETE POSITION 0
AS
BEGIN
  IF ( not ( (old.EMMANUT='S') and (old.EMMANUT IS NOT NULL) ) ) THEN
  BEGIN

    UPDATE VDORCAMENTO SET VLRDESCITORC = VLRDESCITORC -old.VLRDESCITORC,
         VLRPRODORC = VLRPRODORC - old.VLRPRODITORC,
         VLRLIQORC = VLRLIQORC - old.VLRLIQITORC
         WHERE CODORC=old.CODORC AND TIPOORC='O' AND
         CODEMP=old.CODEMP AND CODFILIAL=old.CODFILIAL;
  END
END
^

/* Trigger: VDITORCAMENTOTGAU */
CREATE TRIGGER VDITORCAMENTOTGAU FOR VDITORCAMENTO
ACTIVE AFTER UPDATE POSITION 0
AS
BEGIN
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT IS NOT NULL) ) ) ) THEN
  BEGIN

     UPDATE VDORCAMENTO SET VLRDESCITORC = VLRDESCITORC -old.VLRDESCITORC + new.VLRDESCITORC,
           VLRPRODORC = VLRPRODORC - old.VLRPRODITORC + new.VLRPRODITORC,
           VLRLIQORC = VLRLIQORC - old.VLRLIQITORC + new.VLRLIQITORC
           WHERE CODORC=new.CODORC AND TIPOORC='O'
           AND CODEMP=new.CODEMP AND CODFILIAL=new.CODFILIAL;
  END
END
^

/* Trigger: VDITORCAMENTOTGBI */
CREATE TRIGGER VDITORCAMENTOTGBI FOR VDITORCAMENTO
ACTIVE BEFORE INSERT POSITION 0
AS
  DECLARE VARIABLE sRefProd CHAR(13);
BEGIN
  IF (new.VLRDESCITORC IS NULL) THEN new.VLRDESCITORC = 0;
  IF (new.VLRLIQITORC IS NULL) THEN new.VLRLIQITORC = 0;
  IF (new.VLRLIQITORC = 0) THEN
      new.VLRLIQITORC = (new.QTDITORC * new.PRECOITORC) - new.VLRDESCITORC;
  new.TIPOORC = 'O';
  SELECT P.REFPROD FROM EQPRODUTO P
         WHERE P.CODPROD=new.CODPROD AND P.CODEMP=new.CODEMPPD
         AND P.CODFILIAL = new.CODFILIALPD
         INTO sRefProd;
  IF (new.REFPROD IS NULL) THEN new.REFPROD = sRefProd;
  UPDATE VDORCAMENTO SET VLRDESCITORC = VLRDESCITORC + new.VLRDESCITORC,
         VLRPRODORC = VLRPRODORC + new.VLRPRODITORC,
         VLRLIQORC = VLRLIQORC + new.VLRLIQITORC
         WHERE CODORC=new.CODORC AND TIPOORC=new.TIPOORC
         AND CODEMP=new.CODEMP AND CODFILIAL=new.CODFILIAL;
END
^

/* Trigger: VDITORCAMENTOTGBU */
CREATE TRIGGER VDITORCAMENTOTGBU FOR VDITORCAMENTO
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  IF ( new.EMMANUT IS NULL) THEN
      new.EMMANUT='N';
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT IS NOT NULL) )) ) THEN
  BEGIN

    new.DTALT=cast('now' AS DATE);
    new.IDUSUALT=USER;
    new.HALT = cast('now' AS TIME);
    IF (new.VLRPRODITORC IS NULL) THEN new.VLRPRODITORC = 0;
    IF (new.VLRDESCITORC IS NULL) THEN new.VLRDESCITORC = 0;
    IF (new.VLRLIQITORC IS NULL) THEN new.VLRLIQITORC = 0;
  END

end
^

/* Trigger: VDITROMANEIOTGBU */
CREATE TRIGGER VDITROMANEIOTGBU FOR VDITROMANEIO
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: VDITVENDATGAD */
CREATE TRIGGER VDITVENDATGAD FOR VDITVENDA
ACTIVE AFTER DELETE POSITION 0
AS
  DECLARE VARIABLE DDTVENDA DATE;
  DECLARE VARIABLE CFLAG CHAR(1);
  DECLARE VARIABLE IDOCVENDA INTEGER;
  DECLARE VARIABLE ICODEMPTM INTEGER;
  DECLARE VARIABLE SCODFILIALTM SMALLINT;
  DECLARE VARIABLE ICODTIPOMOV INTEGER;
BEGIN
  IF ( not ( (old.EMMANUT='S') and (old.EMMANUT IS NOT NULL) ) ) THEN
  BEGIN
      UPDATE VDVENDA SET
         VLRPRODVENDA = VLRPRODVENDA - old.VLRPRODITVENDA,
         VLRBASEICMSVENDA = VLRBASEICMSVENDA - old.VLRBASEICMSITVENDA,
         VLRICMSVENDA = VLRICMSVENDA -old.VLRICMSITVENDA,
         VLRISENTASVENDA = VLRISENTASVENDA - old.VLRISENTASITVENDA,
         VLROUTRASVENDA = VLROUTRASVENDA - old.VLROUTRASITVENDA,
         VLRBASEIPIVENDA = VLRBASEIPIVENDA - old.VLRBASEIPIITVENDA,
         VLRIPIVENDA = VLRIPIVENDA - old.VLRIPIITVENDA,
         VLRLIQVENDA = VLRLIQVENDA - old.VLRLIQITVENDA,
         VLRCOMISVENDA = VLRCOMISVENDA - old.VLRCOMISITVENDA,
         VLRBASEISSVENDA = VLRBASEISSVENDA - old.VLRBASEISSITVENDA,
         VLRISSVENDA = VLRISSVENDA - old.VLRISSITVENDA,
         VLRDESCITVENDA = VLRDESCITVENDA - old.VLRDESCITVENDA
         WHERE CODVENDA=old.CODVENDA AND TIPOVENDA=old.TIPOVENDA AND
         CODEMP=old.CODEMP AND CODFILIAL=old.CODFILIAL;
      SELECT V.DTEMITVENDA, V.FLAG, V.DOCVENDA,
          V.CODEMPTM, V.CODFILIALTM, V.CODTIPOMOV
       FROM VDVENDA V  WHERE V.CODVENDA = old.CODVENDA AND
          V.CODEMP=old.CODEMP AND V.CODFILIAL = old.CODFILIAL AND
          V.TIPOVENDA=old.TIPOVENDA
      INTO :DDTVENDA, :CFLAG, :IDOCVENDA, :ICODEMPTM, :SCODFILIALTM, :ICODTIPOMOV;
      EXECUTE PROCEDURE EQMOVPRODIUDSP('D', old.CODEMPPD, old.CODFILIALPD,
         old.CODPROD, old.CODEMPLE, old.CODFILIALLE, old.CODLOTE,
         :ICODEMPTM, :SCODFILIALTM, :ICODTIPOMOV, null, null, null,
         null, null, null, null,
         old.CODEMP, old.CODFILIAL, old.TIPOVENDA, old.CODVENDA, old.CODITVENDA,
          null, null, null, null,null,null, null, null,
         old.CODEMPNT, old.CODFILIALNT, old.CODNAT, :DDTVENDA,
         :IDOCVENDA, :CFLAG, old.QTDITVENDA, old.PRECOITVENDA,
         old.CODEMPAX, old.CODFILIALAX, old.CODALMOX);
  END
END
^

/* Trigger: VDITVENDATGAI */
CREATE TRIGGER VDITVENDATGAI FOR VDITVENDA
ACTIVE AFTER INSERT POSITION 0
AS
  DECLARE VARIABLE DDTVENDA DATE;
  DECLARE VARIABLE CFLAG CHAR(1);
  DECLARE VARIABLE CFISCALTIPOMOV CHAR(1);
  DECLARE VARIABLE IDOCVENDA INTEGER;
  DECLARE VARIABLE ICODEMPTM INTEGER;
  DECLARE VARIABLE SCODFILIALTM SMALLINT;
  DECLARE VARIABLE ICODTIPOMOV INTEGER;
  DECLARE VARIABLE NPRECO NUMERIC(15, 5);
BEGIN
  SELECT VD.DTEMITVENDA, VD.FLAG, VD.DOCVENDA,
      VD.CODEMPTM, VD.CODFILIALTM, VD.CODTIPOMOV, TM.FISCALTIPOMOV
    FROM EQTIPOMOV TM, VDVENDA VD WHERE
      TM.CODTIPOMOV=VD.CODTIPOMOV AND TM.CODFILIAL=VD.CODFILIALTM AND TM.CODEMP=VD.CODEMPTM
      AND VD.TIPOVENDA=new.TIPOVENDA AND VD.CODVENDA=new.CODVENDA AND VD.CODFILIAL=new.CODFILIAL
      AND VD.CODEMP=new.CODEMP
    INTO :DDTVENDA, :CFLAG, :IDOCVENDA, :ICODEMPTM,
      :SCODFILIALTM, :ICODTIPOMOV,:CFISCALTIPOMOV;
  IF (CFISCALTIPOMOV = 'S') THEN
  BEGIN
    IF (new.CODTRATTRIB IS NULL) THEN
      SELECT CF.ORIGFISC,CF.CODEMPTT,CF.CODFILIALTT,CF.CODTRATTRIB FROM
        LFCLFISCAL CF, EQPRODUTO P WHERE P.CODEMP=new.CODEMPPD AND
        P.CODFILIAL=new.CODFILIALPD AND P.CODPROD=new.CODPROD AND
        CF.CODEMP = P.CODEMPFC AND CF.CODFILIAL=P.CODFILIALFC AND
        CF.CODFISC=P.CODFISC INTO new.ORIGFISC,new.CODEMPTT,new.CODFILIALTT,new.CODTRATTRIB;
  END
  IF (new.QTDITVENDA != 0 ) THEN
     NPRECO = new.VLRLIQITVENDA/new.QTDITVENDA;
  ELSE
     NPRECO = new.PRECOITVENDA;
  EXECUTE PROCEDURE EQMOVPRODIUDSP('I', new.CODEMPPD, new.CODFILIALPD, new.CODPROD,
       new.CODEMPLE, new.CODFILIALLE, new.CODLOTE, :ICODEMPTM, :SCODFILIALTM,
       :ICODTIPOMOV, null, null, null, null, null, null, null,
       new.CODEMP, new.CODFILIAL, new.TIPOVENDA, new.CODVENDA, new.CODITVENDA,
       null, null, null, null,null,null,null, null,
       new.CODEMPNT, new.CODFILIALNT, new.CODNAT,
       :DDTVENDA, :IDOCVENDA, :CFLAG, new.QTDITVENDA, :NPRECO,
       new.CODEMPAX, new.CODFILIALAX, new.CODALMOX);
END
^

/* Trigger: VDITVENDATGAU */
CREATE TRIGGER VDITVENDATGAU FOR VDITVENDA
ACTIVE AFTER UPDATE POSITION 0
AS
  DECLARE VARIABLE DDTVENDA DATE;
  DECLARE VARIABLE CFLAG CHAR(1);
  DECLARE VARIABLE IDOCVENDA INTEGER;
  DECLARE VARIABLE ICODEMPTM INTEGER;
  DECLARE VARIABLE SCODFILIALTM SMALLINT;
  DECLARE VARIABLE ICODTIPOMOV INTEGER;
  DECLARE VARIABLE CSTATUS CHAR(2);
  DECLARE VARIABLE CTIPOPROD CHAR(1);
  DECLARE VARIABLE NPRECO NUMERIC(15, 5);
BEGIN
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT IS NOT NULL) ) ) ) THEN
  BEGIN
      IF (NOT new.CODMENS = old.CODMENS) THEN
      BEGIN
        SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'LFMENSAGEM') INTO new.CODFILIALME;
        new.CODEMPME = new.CODEMP;
      END
      SELECT VD.DTEMITVENDA,VD.DOCVENDA,VD.STATUSVENDA,VD.FLAG,
             VD.CODEMPTM, VD.CODFILIALTM, VD.CODTIPOMOV
        FROM VDVENDA VD
        WHERE VD.CODVENDA = new.CODVENDA AND VD.TIPOVENDA = new.TIPOVENDA
            AND VD.CODEMP=new.CODEMP AND VD.CODFILIAL = new.CODFILIAL
        INTO :DDTVENDA, :IDOCVENDA, :CSTATUS, :CFLAG, :ICODEMPTM,
          :SCODFILIALTM, :ICODTIPOMOV;
      SELECT TIPOPROD FROM EQPRODUTO WHERE CODPROD=old.CODPROD
             AND CODEMP=old.CODEMPPD AND CODFILIAL = old.CODFILIALPD
         INTO CTIPOPROD;
      if (substr(:CSTATUS,1,1)!='C') then
      BEGIN
        UPDATE VDVENDA SET VLRDESCITVENDA = VLRDESCITVENDA -old.VLRDESCITVENDA + new.VLRDESCITVENDA,
               VLRPRODVENDA = VLRPRODVENDA - old.VLRPRODITVENDA + new.VLRPRODITVENDA,
               VLRBASEICMSVENDA = VLRBASEICMSVENDA - old.VLRBASEICMSITVENDA + new.VLRBASEICMSITVENDA,
               VLRICMSVENDA = VLRICMSVENDA -old.VLRICMSITVENDA + new.VLRICMSITVENDA,
               VLRISENTASVENDA = VLRISENTASVENDA - old.VLRISENTASITVENDA + new.VLRISENTASITVENDA,
               VLROUTRASVENDA = VLROUTRASVENDA - old.VLROUTRASITVENDA + new.VLROUTRASITVENDA,
               VLRBASEIPIVENDA = VLRBASEIPIVENDA - old.VLRBASEIPIITVENDA + new.VLRBASEIPIITVENDA,
               VLRIPIVENDA = VLRIPIVENDA - old.VLRIPIITVENDA + new.VLRIPIITVENDA,
               VLRLIQVENDA = VLRLIQVENDA - old.VLRLIQITVENDA + new.VLRLIQITVENDA,
               VLRCOMISVENDA = VLRCOMISVENDA - old.VLRCOMISITVENDA + new.VLRCOMISITVENDA,
               VLRBASEISSVENDA = VLRBASEISSVENDA - old.VLRBASEISSITVENDA + new.VLRBASEISSITVENDA,
               VLRISSVENDA = VLRISSVENDA - old.VLRISSITVENDA + new.VLRISSITVENDA
               WHERE CODVENDA=new.CODVENDA AND TIPOVENDA=new.TIPOVENDA
               AND CODEMP=new.CODEMP AND CODFILIAL=new.CODFILIAL;
        IF (SUBSTR(CSTATUS,1,1) = 'P') THEN
          CSTATUS = 'PV';
        ELSE IF (SUBSTR(CSTATUS,1,1) = 'V') THEN
          CSTATUS = 'VD';
      END
      IF (new.QTDITVENDA = 0) THEN
         NPRECO = new.PRECOITVENDA;
      ELSE
         NPRECO = new.VLRLIQITVENDA/new.QTDITVENDA;
      EXECUTE PROCEDURE EQMOVPRODIUDSP('U',new.CODEMPPD, new.CODFILIALPD, new.CODPROD,
        new.CODEMPLE, new.CODFILIALLE, new.CODLOTE, :ICODEMPTM,
        :SCODFILIALTM, :ICODTIPOMOV, null, null, null ,null, null,
        null, null, new.CODEMP, new.CODFILIAL, new.TIPOVENDA, new.CODVENDA,
        new.CODITVENDA, null, null, null, null,null,null,null, null,
        new.CODEMPNT, new.CODFILIALNT,
        new.CODNAT, :DDTVENDA, :IDOCVENDA, :CFLAG, new.QTDITVENDA, :NPRECO,
        new.CODEMPAX, new.CODFILIALAX, new.CODALMOX);
   END
END
^

/* Trigger: VDITVENDATGBD */
CREATE TRIGGER VDITVENDATGBD FOR VDITVENDA
ACTIVE BEFORE DELETE POSITION 0
AS
begin
  DELETE FROM VDVENDAORC WHERE CODEMP=old.CODEMP AND CODFILIAL=old.CODFILIAL
    AND TIPOVENDA=old.TIPOVENDA AND CODVENDA=old.CODVENDA AND CODITVENDA=old.CODITVENDA;
end
^

/* Trigger: VDITVENDATGBI */
CREATE TRIGGER VDITVENDATGBI FOR VDITVENDA
ACTIVE BEFORE INSERT POSITION 0
AS
  DECLARE VARIABLE sRefProd CHAR(13);
  DECLARE VARIABLE sTipoProd CHAR(1);
  DECLARE VARIABLE IFILIALPREF INTEGER;

BEGIN
  select ICODFILIAL from sgretfilial(new.codemp,'SGPREFERE1') into ifilialpref;

  IF (new.VLRDESCITVENDA IS NULL) THEN new.VLRDESCITVENDA = 0;
  IF (new.VLRBASEICMSITVENDA IS NULL) THEN new.VLRBASEICMSITVENDA = 0;
  IF (new.VLRICMSITVENDA IS NULL) THEN new.VLRICMSITVENDA = 0;
  IF (new.VLRBASEIPIITVENDA IS NULL) THEN new.VLRBASEIPIITVENDA = 0;
  IF (new.VLRIPIITVENDA IS NULL) THEN new.VLRIPIITVENDA = 0;
  IF (new.VLRLIQITVENDA IS NULL) THEN new.VLRLIQITVENDA = 0;
  IF (new.VLRCOMISITVENDA IS NULL) THEN new.VLRCOMISITVENDA = 0;
  IF (new.VLRADICITVENDA IS NULL) THEN new.VLRADICITVENDA = 0;
  IF (new.VLRISSITVENDA IS NULL) THEN new.VLRISSITVENDA = 0;
  IF (new.VLRFRETEITVENDA IS NULL) THEN new.VLRFRETEITVENDA = 0;
  IF (new.TIPOVENDA IS NULL) THEN new.TIPOVENDA = 'V';

  IF (new.VLRLIQITVENDA = 0) THEN
      new.VLRLIQITVENDA = (new.QTDITVENDA * new.PRECOITVENDA) +
         new.VLRADICITVENDA + new.VLRFRETEITVENDA - new.VLRDESCITVENDA;

  IF (new.CODALMOX IS NULL) THEN
       SELECT CODEMPAX,CODFILIALAX,CODALMOX FROM EQPRODUTO WHERE
          CODEMP=new.CODEMPPD AND CODFILIAL=new.CODFILIALPD AND
          CODPROD=new.CODPROD
       INTO new.CODEMPAX, new.CODFILIALAX,new.CODALMOX;
  IF (NOT new.CODMENS IS NULL) THEN
    SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'LFMENSAGEM') INTO new.CODFILIALME;
     new.CODEMPME = new.CODEMP;
  SELECT P.REFPROD,P.TIPOPROD FROM LFCLFISCAL F, EQPRODUTO P
         WHERE P.CODPROD=new.CODPROD AND F.CODFISC = P.CODFISC
         AND F.CODEMP = P.CODEMPFC AND F.CODFILIAL = P.CODFILIALFC
         AND P.CODEMP=new.CODEMPPD AND P.CODFILIAL = new.CODFILIALPD
         INTO sRefProd,sTipoProd;
  IF (new.REFPROD IS NULL) THEN new.REFPROD = sRefProd;
  IF (sTipoProd = 'S') THEN
  BEGIN
    SELECT PERCISSEMP FROM SGEMPRESA WHERE
      CODEMP=new.CODEMP INTO new.PERCISSITVENDA;
    IF (new.PERCISSITVENDA != 0) THEN
    BEGIN
      new.VLRBASEISSITVENDA = new.VLRLIQITVENDA;
      new.VLRISSITVENDA = new.VLRBASEISSITVENDA*(new.PERCISSITVENDA/100);
    END
  END
  ELSE
    new.VLRBASEISSITVENDA = 0;
  IF (new.TIPOFISC = 'II') THEN
  BEGIN
    new.VLRISENTASITVENDA = new.VLRLIQITVENDA;
    new.VLRBASEICMSITVENDA = 0;
    new.PERCICMSITVENDA = 0;
    new.VLRICMSITVENDA = 0;
    new.VLROUTRASITVENDA = 0;
  END
  ELSE IF (new.TIPOFISC = 'FF') THEN
  BEGIN
    new.VLROUTRASITVENDA = new.VLRLIQITVENDA;
    new.VLRBASEICMSITVENDA = 0;
    new.PERCICMSITVENDA = 0;
    new.VLRICMSITVENDA = 0;
    new.VLRISENTASITVENDA = 0;
  END
  ELSE IF (new.TIPOFISC = 'NN') THEN
  BEGIN
    new.VLROUTRASITVENDA = new.VLRLIQITVENDA;
    new.VLRBASEICMSITVENDA = 0;
    new.PERCICMSITVENDA = 0;
    new.VLRICMSITVENDA = 0;
    new.VLRISENTASITVENDA = 0;
  END
  ELSE IF (new.TIPOFISC = 'TT') THEN
  BEGIN
    new.VLROUTRASITVENDA = 0;
    new.VLRISENTASITVENDA = 0;
  END
  UPDATE VDVENDA SET VLRDESCITVENDA = VLRDESCITVENDA + new.VLRDESCITVENDA,
         VLRPRODVENDA = VLRPRODVENDA + new.VLRPRODITVENDA,
         VLRBASEICMSVENDA = VLRBASEICMSVENDA + new.VLRBASEICMSITVENDA,
         VLRICMSVENDA = VLRICMSVENDA + new.VLRICMSITVENDA,
         VLRISENTASVENDA = VLRISENTASVENDA + new.VLRISENTASITVENDA,
         VLROUTRASVENDA = VLROUTRASVENDA + new.VLROUTRASITVENDA,
         VLRBASEIPIVENDA = VLRBASEIPIVENDA + new.VLRBASEIPIITVENDA,
         VLRIPIVENDA = VLRIPIVENDA + new.VLRIPIITVENDA,
         VLRLIQVENDA = VLRLIQVENDA + new.VLRLIQITVENDA,
         VLRBASEISSVENDA = VLRBASEISSVENDA + new.VLRBASEISSITVENDA,
         VLRISSVENDA = VLRISSVENDA + new.VLRISSITVENDA,
         VLRCOMISVENDA = VLRCOMISVENDA + new.VLRCOMISITVENDA
         WHERE CODVENDA=new.CODVENDA AND TIPOVENDA=new.TIPOVENDA
         AND CODEMP=new.CODEMP AND CODFILIAL=new.CODFILIAL;
END
^

/* Trigger: VDITVENDATGBU */
CREATE TRIGGER VDITVENDATGBU FOR VDITVENDA
ACTIVE BEFORE UPDATE POSITION 0
AS
  DECLARE VARIABLE sTipoFisc CHAR(2);
  DECLARE VARIABLE sRefProd CHAR(13);
  DECLARE VARIABLE sTipoProd CHAR(1);
  declare variable iCodFilialPref SMALLINT;
  DECLARE VARIABLE NTMP NUMERIC(15, 5);
BEGIN
  IF ( new.EMMANUT IS NULL) THEN
      new.EMMANUT='N';
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT IS NOT NULL) )) ) THEN
  BEGIN
      new.DTALT=cast('now' AS DATE);
      new.IDUSUALT=USER;
      new.HALT = cast('now' AS TIME);
      SELECT ICODFILIAL FROM sgretfilial(new.CODEMP, 'SGPREFERE1') INTO :iCodFilialPref;
      IF (new.CODPROD != old.CODPROD) THEN
        EXCEPTION VDITVENDAEX01;
      IF (new.CODLOTE != old.CODLOTE) THEN
        EXCEPTION VDITVENDAEX02;

      IF (new.CODALMOX IS NULL) THEN
         SELECT CODEMPAX,CODFILIALAX,CODALMOX FROM EQPRODUTO WHERE
          CODEMP=new.CODEMPPD AND CODFILIAL=new.CODFILIALPD AND
          CODPROD=new.CODPROD
         INTO new.CODEMPAX, new.CODFILIALAX,new.CODALMOX;

      IF (old.CODALMOX IS NOT NULL) THEN
      BEGIN
         IF (old.CODALMOX!=new.CODALMOX) THEN
            EXCEPTION EQALMOX01;
      END
      SELECT REFPROD FROM EQPRODUTO WHERE CODPROD=new.CODPROD
             AND CODEMP=new.CODEMPPD AND CODFILIAL = new.codfilialpd INTO sRefProd;
      IF (new.REFPROD IS NULL) THEN new.REFPROD = sRefProd;
      SELECT F.TIPOFISC,P.TIPOPROD FROM LFCLFISCAL F, EQPRODUTO P WHERE P.CODPROD=new.CODPROD
             AND F.CODFISC = P.CODFISC AND F.CODEMP=new.codemp AND F.CODFILIAL = P.CODFILIALFC
             AND P.CODEMP=new.CODEMP AND P.CODFILIAL = new.codfilialpd
             INTO :sTipoFisc,:sTipoProd;

      IF ( (new.CANCITVENDA is not null) AND (new.CANCITVENDA = 'S') ) THEN
      BEGIN
          new.QTDITVENDA = 0;
          new.VLRLIQITVENDA = 0;
          new.VLRPRODITVENDA = 0;
          new.VLRBASEICMSITVENDA = 0;
          new.VLRBASEIPIITVENDA = 0;
          new.VLRDESCITVENDA = 0;
      END

    /****
      Desconto:
    ****/
      IF ( (new.VLRLIQITVENDA = 0) AND ( (new.CANCITVENDA IS NULL) OR (new.CANCITVENDA!='S') ) ) THEN
          new.VLRLIQITVENDA = (new.QTDITVENDA * new.PRECOITVENDA) +
             new.VLRADICITVENDA + new.VLRFRETEITVENDA - new.VLRDESCITVENDA;
      ELSE IF (new.VLRDESCITVENDA > 0 AND new.QTDITVENDA > 0) THEN
      BEGIN
        NTMP = new.VLRLIQITVENDA/new.QTDITVENDA;
        NTMP = NTMP * new.QTDITVENDA;
        new.VLRDESCITVENDA = new.VLRDESCITVENDA + (new.VLRLIQITVENDA-NTMP);
/*        new.VLRLIQITVENDA = new.VLRLIQITVENDA - old.VLRDESCITVENDA + new.VLRDESCITVENDA;*/

        /* Refazendo a comissão do ítem */
        new.vlrcomisitvenda = (new.perccomisitvenda * new.vlrliqitvenda )  / 100;

      END
      IF (sTipoProd = 'S') THEN
      BEGIN
        SELECT PERCISSEMP FROM SGEMPRESA WHERE CODEMP=new.CODEMP INTO new.PERCISSITVENDA;
        IF (new.PERCISSITVENDA != 0) THEN
        BEGIN
          new.VLRBASEISSITVENDA = new.VLRLIQITVENDA;
          new.VLRISSITVENDA = new.VLRBASEISSITVENDA*(new.PERCISSITVENDA/100);
        END
      END
      ELSE
        new.VLRBASEISSITVENDA = 0;
      IF (sTipoFisc = 'II') THEN
      BEGIN
        new.VLRISENTASITVENDA = new.VLRLIQITVENDA;
        new.VLRBASEICMSITVENDA = 0;
        new.PERCICMSITVENDA = 0;
        new.VLRICMSITVENDA = 0;
        new.VLROUTRASITVENDA = 0;
      END
      ELSE IF (sTipoFisc = 'FF') THEN
      BEGIN
        new.VLROUTRASITVENDA = new.VLRLIQITVENDA;
        new.VLRBASEICMSITVENDA = 0;
        new.PERCICMSITVENDA = 0;
        new.VLRICMSITVENDA = 0;
        new.VLRISENTASITVENDA = 0;
      END
      ELSE IF (sTipoFisc = 'NN') THEN
      BEGIN
        new.VLROUTRASITVENDA = new.VLRLIQITVENDA;
        new.VLRBASEICMSITVENDA = 0;
        new.PERCICMSITVENDA = 0;
        new.VLRICMSITVENDA = 0;
        new.VLRISENTASITVENDA = 0;
      END
      ELSE IF (sTipoFisc = 'TT') THEN
      BEGIN
        new.VLROUTRASITVENDA = 0;
        new.VLRISENTASITVENDA = 0;
      END
   END
END
^

/* Trigger: VDKITTGBI */
CREATE TRIGGER VDKITTGBI FOR VDKIT
ACTIVE BEFORE INSERT POSITION 0
AS
begin
  new.DTINS=cast('now' AS DATE);
  new.IDUSUINS=USER;
  new.HINS = cast('now' AS TIME);
  SELECT REFPROD FROM EQREFPRODSP(new.CODEMP, new.CODFILIAL, new.CODPROD) INTO new.REFPROD;
  /* Trigger text */
end
^

/* Trigger: VDKITTGBU */
CREATE TRIGGER VDKITTGBU FOR VDKIT
ACTIVE BEFORE UPDATE POSITION 0
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  SELECT REFPROD FROM EQREFPRODSP(new.CODEMP, new.CODFILIAL, new.CODPROD) INTO new.REFPROD;
  /* Trigger text */
end
^

/* Trigger: VDORCAMENTOTGAI */
CREATE TRIGGER VDORCAMENTOTGAI FOR VDORCAMENTO
ACTIVE AFTER INSERT POSITION 0
AS
DECLARE VARIABLE iCodFilialTb SMALLINT;
DECLARE VARIABLE iCodFilialSt SMALLINT;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'VDSTATUSORC') INTO :iCodFilialSt;
  SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'SGTABELA') INTO :iCodFilialTb;
  INSERT INTO VDSTATUSORC (CODEMP,CODFILIAL,TIPOORC,CODORC,CODEMPTB,CODFILIALTB,CODTB,CODITTB,MOTIVOSTORC)
     SELECT new.CODEMP, new.CODFILIAL, new.TIPOORC, new.CODORC, new.CODEMP,
         :iCodFilialTb, OTB.CODTB, ITB.CODITTB,'SITUAÇÃO INICIAL'
      FROM SGOBJETOTB OTB,SGITTABELA ITB WHERE OTB.CODEMP=new.CODEMP AND OTB.CODFILIALTB=:iCodFilialTb AND
        OTB.IDOBJ='VDSTATUSORC' AND ITB.CODEMP=new.CODEMP AND ITB.CODFILIAL=OTB.CODFILIALTB AND
        ITB.CODTB=OTB.CODTB AND ITB.PADRAOITTB='S';
END
^

/* Trigger: VDORCAMENTOTGBD */
CREATE TRIGGER VDORCAMENTOTGBD FOR VDORCAMENTO
ACTIVE BEFORE DELETE POSITION 0
as
begin
  DELETE FROM atatendimentoorc WHERE CODORC=old.CODORC
    AND CODFILIAL=old.CODFILIAL AND CODEMP=old.CODEMP;
end
^

/* Trigger: VDORCAMENTOTGBI */
CREATE TRIGGER VDORCAMENTOTGBI FOR VDORCAMENTO
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
  IF (new.VLRPRODORC IS NULL) THEN new.VLRPRODORC = 0;
  IF (new.VLRDESCORC IS NULL) THEN new.VLRDESCORC = 0;
  IF (new.VLRADICORC IS NULL) THEN new.VLRADICORC = 0;
  IF (new.VLRDESCITORC IS NULL) THEN new.VLRDESCITORC = 0;
  IF (new.VLRLIQORC IS NULL) THEN new.VLRLIQORC = 0;
  IF (new.CODCONV IS NOT NULL AND new.CODCLI IS NULL) THEN
  BEGIN
       SELECT CODCLI,CODEMPCL,CODFILIALCL,CODTPCONV,CODFILIALTC,CODEMPTC FROM ATCONVENIADO
          WHERE CODEMP=new.CODEMPCV AND CODFILIAL=new.CODFILIALCV
          AND CODCONV=new.CODCONV INTO new.CODCLI,new.CODEMPCL,new.CODFILIALCL,
          new.CODTPCONV,new.CODFILIALTC,new.CODEMPTC;
  END
  EXECUTE PROCEDURE VDCLIENTEATIVOSP(new.CODEMPCL, new.CODFILIALCL, new.CODCLI);
END
^

/* Trigger: VDORCAMENTOTGBU */
CREATE TRIGGER VDORCAMENTOTGBU FOR VDORCAMENTO
ACTIVE BEFORE UPDATE POSITION 0
AS
DECLARE VARIABLE ICODATENDO INTEGER;
DECLARE VARIABLE ICODSETOR INTEGER;
DECLARE VARIABLE IFILIALPREF INTEGER;
DECLARE VARIABLE IFILIALUSU INTEGER;
BEGIN
  if (new.EMMANUT is null) then
     new.EMMANUT = 'N';
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
  begin
      new.DTALT=cast('now' AS DATE);
      new.IDUSUALT=USER;
      new.HALT = cast('now' AS TIME);
      SELECT CODCLI,CODEMPCL,CODFILIALCL,CODTPCONV,CODFILIALTC,CODEMPTC FROM ATCONVENIADO
            WHERE CODEMP=new.CODEMPCV AND CODFILIAL=new.CODFILIALCV
            AND CODCONV=new.CODCONV INTO new.CODCLI,new.CODEMPCL,new.CODFILIALCL,
            new.CODTPCONV,new.CODFILIALTC,new.CODEMPTC;
      IF (NOT new.CODCONV = old.CODCONV) THEN
      BEGIN
        SELECT CODCLI,CODEMPCL,CODFILIALCL FROM ATCONVENIADO
          WHERE CODEMP=new.CODEMPCV AND CODFILIAL=new.CODFILIALCV
           AND CODCONV=new.CODCONV INTO new.CODCLI,new.CODEMPCL,new.CODFILIALCL;
      END
      IF (old.STATUSORC = 'OA' AND new.STATUSORC = 'OC') THEN
      BEGIN
        SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'SGPREFERE2') INTO IFILIALPREF;
        SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'SGUSUARIO') INTO IFILIALUSU;
        SELECT CODSETAT2,CODTPATENDO3 FROM SGPREFERE2
          WHERE CODEMP=new.CODEMP AND CODFILIAL=:IFILIALPREF
          INTO ICODSETOR,ICODATENDO;
        EXECUTE PROCEDURE ATADICATENDIMENTOSP(
          new.CODCONV,:ICODATENDO,new.CODATEND,
          ICODSETOR,NULL,new.CODEMP,:IFILIALUSU,new.CODORC
        );
      END

      EXECUTE PROCEDURE VDCLIENTEATIVOSP(new.CODEMPCL, new.CODFILIALCL, new.CODCLI);

      IF (new.VLRDESCORC IS NULL) THEN
        new.VLRDESCORC = 0;

      new.VLRDESCORC = new.VLRDESCORC - old.VLRDESCITORC;
      new.VLRDESCORC = new.VLRDESCORC + new.VLRDESCITORC;

      new.VLRLIQORC = new.VLRPRODORC - new.VLRDESCORC + new.VLRADICORC;
  END
END
^

/* Trigger: VDPRECOPRODTGBU */
CREATE TRIGGER VDPRECOPRODTGBU FOR VDPRECOPROD
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: VDREGRACOMISTGBU */
CREATE TRIGGER VDREGRACOMISTGBU FOR VDREGRACOMIS
ACTIVE BEFORE UPDATE POSITION 0
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: VDROMANEIOTGBU */
CREATE TRIGGER VDROMANEIOTGBU FOR VDROMANEIO
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: VDSETORTGBU */
CREATE TRIGGER VDSETORTGBU FOR VDSETOR
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: VDSTATUSORCTGBU */
CREATE TRIGGER VDSTATUSORCTGBU FOR VDSTATUSORC
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: VDTABPRECOTGBU */
CREATE TRIGGER VDTABPRECOTGBU FOR VDTABPRECO
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: VDTIPOCLITGBU */
CREATE TRIGGER VDTIPOCLITGBU FOR VDTIPOCLI
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: VDTIPOVENDTGBU */
CREATE TRIGGER VDTIPOVENDTGBU FOR VDTIPOVEND
ACTIVE BEFORE UPDATE POSITION 0
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end
^

/* Trigger: VDTRANSPTGBI */
CREATE TRIGGER VDTRANSPTGBI FOR VDTRANSP
ACTIVE BEFORE INSERT POSITION 0
AS
    declare variable nomemunictran CHAR(30);
begin

    /*Atualização do campo cidade e estado (temporário para retro-compatibilidade)*/

    if(new.codmunic is not null) then
    begin
        select substr(mun.nomemunic,1,30) from sgmunicipio mun
            where mun.codpais=new.codpais and mun.siglauf=new.siglauf and mun.codmunic=new.codmunic
                into :nomemunictran;
        if (nomemunictran is not null) then new.cidtran = nomemunictran;
    end

    if(new.siglauf is not null) then
    begin
        new.uftran=new.siglauf;
    end

    /* Fim da atualização do campo cidade e estado*/

end
^

/* Trigger: VDTRANSPTGBU */
CREATE TRIGGER VDTRANSPTGBU FOR VDTRANSP
ACTIVE BEFORE UPDATE POSITION 0
as
    declare variable nomemunictran CHAR(30);
begin
    new.DTALT=cast('now' AS DATE);
    new.IDUSUALT=USER;
    new.HALT = cast('now' AS TIME);

    /*Atualização do campo cidade e estado (temporário para retro-compatibilidade)*/

    if(old.codmunic != new.codmunic) then
    begin
        select substr(mun.nomemunic,1,30) from sgmunicipio mun
            where mun.codpais=new.codpais and mun.siglauf=new.siglauf and mun.codmunic=new.codmunic
                into :nomemunictran;
        if (nomemunictran is not null) then new.cidtran = nomemunictran;
    end

    if(new.siglauf is not null) then
    begin
        new.uftran=new.siglauf;
    end

    /* Fim da atualização do campo cidade */


end
^

/* Trigger: VDVENDAORCTGAD */
CREATE TRIGGER VDVENDAORCTGAD FOR VDVENDAORC
ACTIVE AFTER DELETE POSITION 0
AS
begin
  UPDATE VDITORCAMENTO SET EMITITORC='N'
    WHERE CODEMP=old.CODEMPOR AND CODFILIAL=old.CODFILIALOR AND
       TIPOORC=old.TIPOORC AND CODORC=old.CODORC AND CODITORC=old.CODITORC;
  UPDATE VDORCAMENTO SET STATUSORC='OL'
    WHERE CODEMP=old.CODEMPOR AND CODFILIAL=old.CODFILIALOR AND
       TIPOORC=old.TIPOORC AND CODORC=old.CODORC;
end
^

/* Trigger: VDVENDATGAI */
CREATE TRIGGER VDVENDATGAI FOR VDVENDA
ACTIVE AFTER INSERT POSITION 0
AS
begin
    insert into vdvendacomis
    (codemp,codfilial,codvenda,tipovenda,seqvc,
    codemprc, codfilialrc, codregrcomis, seqitrc,
    percvc)
    select vd.codemp, vd.codfilial, vd.codvenda,vd.tipovenda,irc.seqitrc,
        irc.codemp,irc.codfilial,irc.codregrcomis,irc.seqitrc,irc.perccomisitrc
        from
            vdvenda vd, eqtipomov tm, vditregracomis irc
        where
            tm.codemp=vd.codemptm and tm.codfilial=vd.codfilialtm and tm.codtipomov=vd.codtipomov
            and irc.codemp=tm.codemprc and irc.codfilial=tm.codfilialrc and irc.codregrcomis=tm.codregrcomis
            and vd.codemp=NEW.codemp and vd.codfilial=NEW.codfilial and vd.codvenda=NEW.codvenda
            and vd.tipovenda=NEW.tipovenda;
end
^

/* Trigger: VDVENDATGAU */
CREATE TRIGGER VDVENDATGAU FOR VDVENDA
ACTIVE AFTER UPDATE POSITION 0
AS
  DECLARE VARIABLE ICODREC INTEGER;
  DECLARE VARIABLE UFCLI CHAR(2);
  DECLARE VARIABLE UFFLAG CHAR;
  DECLARE VARIABLE ICODFILIAL SMALLINT;
  DECLARE VARIABLE SCODFILIALRC SMALLINT;
  DECLARE VARIABLE ICODITVENDA INTEGER;
  DECLARE VARIABLE ICODEMPPD INTEGER;
  DECLARE VARIABLE ICODFILIALPD SMALLINT;
  DECLARE VARIABLE ICODPROD INTEGER;
  DECLARE VARIABLE PERCRED NUMERIC(9,2);
  DECLARE VARIABLE PERCIT NUMERIC(9,2);
  DECLARE VARIABLE PERCICMSITVENDA NUMERIC(9,2);
  DECLARE VARIABLE PERCDESCITVENDA NUMERIC(9,2);
  DECLARE VARIABLE PERCIPIITVENDA NUMERIC(9,2);
  DECLARE VARIABLE TIPOFISC CHAR(2);
  DECLARE VARIABLE VLRDESCITVENDA NUMERIC(15, 5);
  DECLARE VARIABLE VLRBASEIPIITVENDA NUMERIC(15, 5);
  DECLARE VARIABLE VLRBASEICMSITVENDA NUMERIC(15, 5);
  DECLARE VARIABLE VLRIPIITVENDA NUMERIC(15, 5);
  DECLARE VARIABLE VLRPRODITVENDA NUMERIC(15, 5);
  DECLARE VARIABLE VLRLIQITVENDA NUMERIC(15, 5);
  DECLARE VARIABLE VLRICMSITVENDA NUMERIC(15, 5);
  DECLARE VARIABLE TIPOMOV CHAR(2);
  DECLARE VARIABLE VLRMFINTIPOMOV CHAR(1);
  DECLARE VARIABLE VLRTMP NUMERIC(15, 5);
  DECLARE VARIABLE QTDITVENDA NUMERIC(9,2);
  DECLARE VARIABLE NVLRPARCREC NUMERIC(15, 5);
  DECLARE VARIABLE NVLRCOMIREC NUMERIC(15, 5);
  DECLARE VARIABLE SNROPARCREC SMALLINT;
BEGIN
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT IS NOT NULL) )) ) THEN
  BEGIN
    /**
      ITVENDA
    **/
      SELECT CODFILIALSEL FROM SGCONEXAO WHERE NRCONEXAO=CURRENT_CONNECTION AND
          CONECTADO > 0 INTO ICODFILIAL;
    /*Informações fiscais.:*/
      SELECT C.UFCLI FROM VDCLIENTE C WHERE C.CODCLI=new.CODCLI AND
        C.CODFILIAL=new.CODFILIALCL AND C.CODEMP=new.CODEMPCL INTO UFCLI;
      UFFLAG = 'N';
      SELECT 'S' FROM SGFILIAL WHERE CODEMP=new.CODEMP
        AND CODFILIAL=:ICODFILIAL AND UFFILIAL=:UFCLI INTO UFFLAG;
      IF (NOT new.VLRDESCVENDA = old.VLRDESCVENDA) THEN
      BEGIN
    /* Distribuindo o desconto: */
        FOR SELECT CODITVENDA,CODEMPPD,CODFILIALPD,CODPROD,PERCDESCITVENDA,PERCICMSITVENDA,
          VLRDESCITVENDA,VLRLIQITVENDA,VLRPRODITVENDA,QTDITVENDA FROM VDITVENDA WHERE CODEMP=new.CODEMP AND
          CODFILIAL=new.CODFILIAL AND CODVENDA=new.CODVENDA AND TIPOVENDA=new.tipovenda INTO ICODITVENDA,ICODEMPPD,ICODFILIALPD,ICODPROD,
          PERCDESCITVENDA,PERCICMSITVENDA,VLRDESCITVENDA,VLRLIQITVENDA,VLRPRODITVENDA,QTDITVENDA DO
        BEGIN
    /* Calculo do item.: */
          PERCIT = 0;
          IF (new.VLRPRODVENDA > 0 AND NOT new.VLRDESCITVENDA > 0 AND new.VLRDESCVENDA > 0) THEN
          BEGIN
            PERCIT = (100*VLRPRODITVENDA) / new.VLRPRODVENDA;
            VLRDESCITVENDA = (new.VLRDESCVENDA  * PERCIT) / 100;
          END
    /*Busca informações fiscais.:*/
          SELECT FIRST 1 C.REDFISC,C.ALIQIPIFISC,C.TIPOFISC
            FROM EQPRODUTO P, LFCLFISCAL C, LFITREGRAFISCAL R WHERE
            P.CODPROD = :ICODPROD AND P.CODFILIAL = :ICODFILIALPD AND
            P.CODEMP = :ICODEMPPD AND C.CODFISC = P.CODFISC AND C.CODFILIAL = P.CODFILIALFC AND
            C.CODEMP = P.CODEMPFC AND R.CODREGRA = C.CODREGRA AND R.CODFILIAL = C.CODFILIALRA AND
            R.CODEMP = C.CODEMPRA AND R.CVITRF = 'V' AND R.NOUFITRF=:UFFLAG INTO
            PERCRED,PERCIPIITVENDA,TIPOFISC;
          IF (PERCRED IS NULL) THEN
            PERCRED = 0;
          IF (PERCIPIITVENDA IS NULL) THEN
            PERCIPIITVENDA = 0;
          IF (PERCICMSITVENDA IS NULL) THEN
            PERCICMSITVENDA = 0;
          VLRLIQITVENDA = VLRPRODITVENDA - VLRDESCITVENDA;
          VLRBASEIPIITVENDA = 0;
          VLRBASEICMSITVENDA = 0;
          VLRICMSITVENDA = 0;
          VLRIPIITVENDA = 0;
          IF (QTDITVENDA > 0) THEN
          BEGIN
            VLRTMP = VLRLIQITVENDA/QTDITVENDA;
            VLRDESCITVENDA = VLRPRODITVENDA - (VLRTMP*QTDITVENDA);
            VLRLIQITVENDA = VLRPRODITVENDA - VLRDESCITVENDA;
          END
          IF ( TIPOFISC = 'II') THEN
          BEGIN
            PERCICMSITVENDA = 0;
            VLRICMSITVENDA = 0;
            VLRBASEICMSITVENDA = 0;
            PERCIPIITVENDA = 0;
            VLRIPIITVENDA = 0;
            VLRBASEIPIITVENDA = 0;
          END
          ELSE IF ( TIPOFISC = 'FF') THEN
          BEGIN
            PERCICMSITVENDA = 0;
            VLRICMSITVENDA = 0;
            VLRBASEICMSITVENDA = 0;
            PERCIPIITVENDA = 0;
            VLRIPIITVENDA = 0;
            VLRBASEIPIITVENDA = 0;
          END
          ELSE IF ( TIPOFISC = 'NN') THEN
          BEGIN
            PERCICMSITVENDA = 0;
            VLRICMSITVENDA = 0;
            VLRBASEICMSITVENDA = 0;
            PERCIPIITVENDA = 0;
            VLRIPIITVENDA = 0;
            VLRBASEIPIITVENDA = 0;
          END
          ELSE IF ( TIPOFISC = 'TT') THEN
          BEGIN
            VLRBASEICMSITVENDA = VLRLIQITVENDA - (VLRPRODITVENDA*(PERCRED/100));
            VLRBASEIPIITVENDA = VLRLIQITVENDA;
            VLRICMSITVENDA = VLRBASEICMSITVENDA*(PERCICMSITVENDA/100);
            VLRIPIITVENDA = VLRBASEIPIITVENDA*(PERCIPIITVENDA/100);
          END
          UPDATE VDITVENDA SET
              VLRBASEICMSITVENDA = :VLRBASEICMSITVENDA,
              VLRBASEIPIITVENDA = :VLRBASEIPIITVENDA,
              VLRICMSITVENDA = :VLRICMSITVENDA,
              VLRIPIITVENDA = :VLRIPIITVENDA,
              VLRDESCITVENDA = :VLRDESCITVENDA,
              VLRLIQITVENDA = :VLRLIQITVENDA
          WHERE
              CODEMP=new.CODEMP AND
              CODFILIAL=new.CODFILIAL AND
              CODVENDA=new.CODVENDA AND
              CODITVENDA=:ICODITVENDA and
              TIPOVENDA=NEW.tipovenda;
        END
      END
    /**
      Financeiro:
    **/
      SELECT TIPOMOV, VLRMFINTIPOMOV FROM EQTIPOMOV WHERE CODTIPOMOV=new.CODTIPOMOV
             AND CODEMP=new.CODEMPTM AND CODFILIAL=new.CODFILIALTM INTO TIPOMOV, VLRMFINTIPOMOV;
      SELECT CODREC FROM FNRECEBER WHERE CODVENDA=new.CODVENDA AND TIPOVENDA=new.TIPOVENDA
             AND CODEMP=new.CODEMP AND CODFILIALVA=new.CODFILIAL INTO iCodRec;
      IF ((NOT TIPOMOV IN ('DV','TR')) AND
         ((iCodRec IS NULL) OR (
         (new.CODPLANOPAG != old.CODPLANOPAG) OR
         (new.CODCLI != old.CODCLI) OR
         (new.CODVEND != old.CODVEND) OR
         (new.VLRLIQVENDA != old.VLRLIQVENDA) OR
         (new.DTEMITVENDA != old.DTEMITVENDA) OR
         (new.DOCVENDA != old.DOCVENDA) OR
         (new.CODBANCO != old.CODBANCO)))) THEN
      BEGIN
        IF ((SUBSTR(old.STATUSVENDA,1,1) = 'P') AND (SUBSTR(new.STATUSVENDA,1,1) = 'V' ) or (not new.VLRCOMISVENDA=old.VLRCOMISVENDA ) ) THEN
        BEGIN
           IF (new.VLRLIQVENDA > 0) THEN
               EXECUTE PROCEDURE FNADICRECEBERSP01(
                   new.TIPOVENDA, new.CODVENDA,
                   new.CODEMPTC, new.CODFILIALTC, new.CODTIPOCOB,
                   new.CODEMPPG,new.CODFILIALPG,new.CODPLANOPAG,
                   new.CODEMPCL,new.CODFILIALCL,new.CODCLI,
                   new.CODEMPVD,new.CODFILIALVD,new.CODVEND,
                   new.VLRLIQVENDA,new.DTSAIDAVENDA,new.VLRCOMISVENDA,new.DOCVENDA,
                   new.CODEMPBO,new.CODFILIALBO,new.CODBANCO,
                   new.CODEMP,new.CODFILIAL,
                   new.CODEMPCB, new.CODFILIALCB, new.CODCARTCOB, new.FLAG);
           ELSE
               DELETE FROM FNRECEBER WHERE CODVENDA = new.CODVENDA AND TIPOVENDA=new.TIPOVENDA AND
                   CODEMP=new.CODEMP AND CODFILIALVA = new.CODFILIAL;
        END
        IF ((new.STATUSVENDA IN ('P2','V2')) AND (old.STATUSVENDA IN ('P1','V1'))) THEN
        BEGIN
           IF (new.VLRLIQVENDA > 0) THEN
               EXECUTE PROCEDURE FNADICRECEBERSP01(
                   new.TIPOVENDA, new.CODVENDA,
                   new.CODEMPTC, new.CODFILIALTC, new.CODTIPOCOB,
                   new.CODEMPPG,new.CODFILIALPG,new.CODPLANOPAG,
                   new.CODEMPCL,new.CODFILIALCL,new.CODCLI,
                   new.CODEMPVD,new.CODFILIALVD,new.CODVEND,
                   new.VLRLIQVENDA,new.DTSAIDAVENDA,new.VLRCOMISVENDA,new.DOCVENDA,
                   new.CODEMPBO,new.CODFILIALBO,new.CODBANCO,
                   new.CODEMP,new.CODFILIAL,
                   new.CODEMPCB, new.CODFILIALCB, new.CODCARTCOB, new.FLAG);
           ELSE
               DELETE FROM FNRECEBER WHERE CODVENDA = new.CODVENDA AND TIPOVENDA=new.TIPOVENDA AND
                   CODEMP=new.CODEMP AND CODFILIALVA = new.CODFILIAL;
        END
        ELSE IF ((new.STATUSVENDA IN ('P2','V2')) AND (old.STATUSVENDA IN ('P2','V2'))) THEN
        BEGIN
           IF (new.VLRLIQVENDA > 0) THEN
               EXECUTE PROCEDURE FNADICRECEBERSP01(
                   new.TIPOVENDA, new.CODVENDA,
                   new.CODEMPTC, new.CODFILIALTC, new.CODTIPOCOB,
                   new.CODEMPPG,new.CODFILIALPG,new.CODPLANOPAG,
                   new.CODEMPCL,new.CODFILIALCL,new.CODCLI,
                   new.CODEMPVD,new.CODFILIALVD,new.CODVEND,
                   new.VLRLIQVENDA,new.DTSAIDAVENDA,new.VLRCOMISVENDA,new.DOCVENDA,
                   new.CODEMPBO,new.CODFILIALBO,new.CODBANCO,
                   new.CODEMP,new.CODFILIAL,
                   new.CODEMPCB, new.CODFILIALCB, new.CODCARTCOB, new.FLAG);
           ELSE
               DELETE FROM FNRECEBER WHERE CODVENDA = new.CODVENDA AND TIPOVENDA=new.TIPOVENDA AND
                   CODEMP=new.CODEMP AND CODFILIALVA = new.CODFILIAL;
        END
        ELSE IF ((new.STATUSVENDA IN ('P3','V3')) AND (old.STATUSVENDA IN ('P3','V3'))) THEN
        BEGIN
           IF (new.VLRLIQVENDA > 0) THEN
               EXECUTE PROCEDURE FNADICRECEBERSP01(
                   new.TIPOVENDA, new.CODVENDA,
                   new.CODEMPTC, new.CODFILIALTC, new.CODTIPOCOB,
                   new.CODEMPPG,new.CODFILIALPG,new.CODPLANOPAG,
                   new.CODEMPCL,new.CODFILIALCL,new.CODCLI,
                   new.CODEMPVD,new.CODFILIALVD,new.CODVEND,
                   new.VLRLIQVENDA,new.DTSAIDAVENDA,new.VLRCOMISVENDA,new.DOCVENDA,
                   new.CODEMPBO,new.CODFILIALBO,new.CODBANCO,
                   new.CODEMP,new.CODFILIAL,
                   new.CODEMPCB, new.CODFILIALCB, new.CODCARTCOB,
                   new.FLAG);
           ELSE
               DELETE FROM FNRECEBER WHERE CODVENDA = new.CODVENDA AND TIPOVENDA=new.TIPOVENDA AND
                   CODEMP=new.CODEMP AND CODFILIALVA = new.CODFILIAL;
        END
      END
      IF (old.VLRCOMISVENDA != new.VLRCOMISVENDA) THEN
      BEGIN
          UPDATE FNRECEBER SET VLRCOMIREC=new.VLRCOMISVENDA
          WHERE CODVENDA=new.CODVENDA AND TIPOVENDA=NEW.tipovenda AND CODEMPVD=new.CODEMP AND
                CODFILIALVD=new.CODFILIAL;
      END
      ELSE IF (old.CODCLCOMIS != new.CODCLCOMIS) THEN
      BEGIN
          SELECT R.CODFILIAL,R.CODREC,R.VLRPARCREC,R.VLRCOMIREC,R.NROPARCREC
              FROM FNRECEBER R
              WHERE R.CODVENDA=new.CODVENDA AND R.TIPOVENDA=new.TIPOVENDA
              AND R.CODEMPVA=new.CODEMP AND R.CODFILIALVA=new.CODFILIAL
              INTO :SCODFILIALRC, :ICODREC, :NVLRPARCREC, :NVLRCOMIREC, :SNROPARCREC;
          EXECUTE PROCEDURE FNITRECEBERSP01(new.CODEMP,:SCODFILIALRC,:ICODREC,
                :NVLRPARCREC,:NVLRCOMIREC,:SNROPARCREC,'S');
      END
      /**
        Testa valor das parcelas x valor da venda
      **/
      IF ((old.STATUSVENDA IN ('P2','V2')) AND (new.STATUSVENDA IN ('P3','V3')) AND (VLRMFINTIPOMOV<>'S') ) THEN
      BEGIN
        SELECT VLRPARCREC FROM FNRECEBER
            WHERE CODVENDA=new.CODVENDA AND TIPOVENDA=new.TIPOVENDA
            AND CODEMPVA=new.CODEMP AND CODFILIALVA = new.CODFILIAL INTO :nVlrParcRec;
        IF (new.VLRLIQVENDA != :nVlrParcRec) THEN
            EXCEPTION VDVENDAEX06;
      END
    /**
     Movimento do estoque
    **/
    /* Avisa os itens que a data de saida foi alterada */
      IF ( (new.DTSAIDAVENDA != old.DTSAIDAVENDA) OR
           (new.CODTIPOMOV!=old.CODTIPOMOV) OR
           ( new.DOCVENDA != old.DOCVENDA )  ) THEN
        UPDATE VDITVENDA SET CODITVENDA=CODITVENDA WHERE
             CODVENDA = old.CODVENDA AND TIPOVENDA = old.TIPOVENDA
             AND CODEMP=old.CODEMP AND CODFILIAL=old.CODFILIAL;
      ELSE IF ((substr(new.STATUSVENDA,1,1)='C') AND (substr(old.STATUSVENDA,1,1) IN ('P','V'))) THEN
      BEGIN
        UPDATE VDITVENDA SET QTDITVENDA=0 WHERE CODVENDA=new.CODVENDA AND TIPOVENDA=new.TIPOVENDA AND
           CODEMP=new.CODEMP AND CODFILIAL=new.CODFILIAL;
        DELETE FROM FNRECEBER WHERE CODVENDA=new.CODVENDA AND TIPOVENDA=new.TIPOVENDA AND
           CODEMP=new.CODEMP AND CODFILIALVA=new.CODFILIAL;
        DELETE FROM VDVENDAORC WHERE CODEMP=new.CODEMP AND CODFILIAL=new.CODFILIAL AND
           CODVENDA=new.CODVENDA AND TIPOVENDA=new.TIPOVENDA;
      END
   END
END
^

/* Trigger: VDVENDATGBD */
CREATE TRIGGER VDVENDATGBD FOR VDVENDA
ACTIVE BEFORE DELETE POSITION 0
AS
BEGIN
  IF ( not ( ( old.EMMANUT='S') and (old.EMMANUT IS NOT NULL) ) ) THEN
  BEGIN
      if ( (old.BLOQVENDA IS NOT NULL) AND (old.BLOQVENDA='S') ) then
         EXCEPTION VDVENDAEX05 'ESTA VENDA ESTÁ BLOQUEADA!!!';
      DELETE FROM VDFRETEVD WHERE CODVENDA=old.CODVENDA  AND TIPOVENDA=old.TIPOVENDA
             AND CODEMP=old.CODEMP AND CODFILIAL = old.CODFILIAL;
  END
END
^

/* Trigger: VDVENDATGBI */
CREATE TRIGGER VDVENDATGBI FOR VDVENDA
ACTIVE BEFORE INSERT POSITION 0
AS
  DECLARE VARIABLE sTipoMov CHAR(2);
BEGIN
  EXECUTE PROCEDURE VDCLIENTEATIVOSP(new.CODEMPCL, new.CODFILIALCL, new.CODCLI);
/*  EXECUTE PROCEDURE FNLIBCREDSP(new.CODVENDA,new.CODCLI,new.CODEMPCL,new.CODFILIALCL,null); */
  IF (new.VLRPRODVENDA IS NULL) THEN new.VLRPRODVENDA = 0;
  IF (new.VLRDESCVENDA IS NULL) THEN new.VLRDESCVENDA = 0;
  IF (new.VLRDESCITVENDA IS NULL) THEN new.VLRDESCITVENDA = 0;
  IF (new.VLRVENDA IS NULL) THEN new.VLRVENDA = 0;
  IF (new.VLRBASEICMSVENDA IS NULL) THEN new.VLRBASEICMSVENDA = 0;
  IF (new.VLRICMSVENDA IS NULL) THEN new.VLRICMSVENDA = 0;
  IF (new.VLRPISVENDA IS NULL) THEN new.VLRPISVENDA = 0;
  IF (new.VLRCOFINSVENDA IS NULL) THEN new.VLRCOFINSVENDA = 0;
  IF (new.VLRIRVENDA IS NULL) THEN new.VLRIRVENDA = 0;
  IF (new.VLRCSOCIALVENDA IS NULL) THEN new.VLRCSOCIALVENDA = 0;
  IF (new.VLRISENTASVENDA IS NULL) THEN new.VLRISENTASVENDA = 0;
  IF (new.VLROUTRASVENDA IS NULL) THEN new.VLROUTRASVENDA = 0;
  IF (new.VLRBASEIPIVENDA IS NULL) THEN new.VLRBASEIPIVENDA = 0;
  IF (new.VLRIPIVENDA IS NULL) THEN new.VLRIPIVENDA = 0;
  IF (new.VLRLIQVENDA IS NULL) THEN new.VLRLIQVENDA = 0;
  IF (new.VLRCOMISVENDA IS NULL) THEN new.VLRCOMISVENDA = 0;
  IF (new.VLRFRETEVENDA IS NULL) THEN new.VLRFRETEVENDA = 0;
  IF (new.VLRADICVENDA IS NULL) THEN new.VLRADICVENDA = 0;
  IF (new.TIPOVENDA IS NULL) THEN new.TIPOVENDA = 'V';
  IF (new.VLRBASEISSVENDA IS NULL) THEN new.VLRBASEISSVENDA = 0;
  IF (new.VLRISSVENDA IS NULL) THEN new.VLRISSVENDA = 0;
  IF (new.VLRPISVENDA IS NULL) THEN new.VLRPISVENDA = 0;
  IF (new.VLRCOFINSVENDA IS NULL) THEN new.VLRCOFINSVENDA = 0;
  IF (new.VLRIRVENDA IS NULL) THEN new.VLRIRVENDA = 0;
  IF (new.VLRCSOCIALVENDA IS NULL) THEN new.VLRCSOCIALVENDA = 0;

  IF (new.CODCAIXA IS NULL) THEN
    SELECT CODTERM FROM SGRETCAIXA INTO new.CODCAIXA;
  SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'PVCAIXA') INTO new.CODFILIALCX;
  new.CODEMPCX = new.CODEMP;
  IF (NOT new.tipovenda = 'E') THEN -- Se for ECF não precisa buscar o DOC, porque o DOC é o numero do cupom.
      SELECT DOC FROM LFNOVODOCSP(new.Serie,new.CODEMP,new.CODFILIAL) INTO new.DocVenda;
  SELECT TIPOMOV,FISCALTIPOMOV FROM EQTIPOMOV WHERE CODTIPOMOV=new.CODTIPOMOV
         AND CODEMP=new.CODEMP AND CODFILIAL = new.CODFILIALTM INTO sTipoMov,new.FLAG;
  IF ( new.FLAG <> 'S') THEN
  BEGIN
     new.FLAG = 'N';
  END
  if ((new.STATUSVENDA is null) OR (RTRIM(new.STATUSVENDA) = '*')) then
  BEGIN
     IF (sTipoMov = 'VD') THEN new.STATUSVENDA = 'V1';
     ELSE new.STATUSVENDA = 'P1';
  END
END
^

/* Trigger: VDVENDATGBU */
CREATE TRIGGER VDVENDATGBU FOR VDVENDA
ACTIVE BEFORE UPDATE POSITION 0
AS
  DECLARE VARIABLE ICODFILIAL INTEGER;
  DECLARE VARIABLE ICODITVENDA INTEGER;
  DECLARE VARIABLE iCodTipoMov INTEGER;
  DECLARE VARIABLE sSerie CHAR(4);
  DECLARE VARIABLE iCodFilialPref smallint;
  DECLARE VARIABLE dDesc NUMERIC(15, 5);
  DECLARE VARIABLE PERCPISFILIAL NUMERIC(9,2);
  DECLARE VARIABLE PERCCOFINSFILIAL NUMERIC(9,2);
  DECLARE VARIABLE PERCIRFILIAL NUMERIC(9,2);
  DECLARE VARIABLE PERCCSOCIALFILIAL NUMERIC(9,2);
  DECLARE VARIABLE VLRPRODITVENDA NUMERIC(15, 5);
  DECLARE VARIABLE QTDITVENDA NUMERIC(9,2);
  DECLARE VARIABLE VLRCOMISITVENDA NUMERIC(15, 5);
  DECLARE VARIABLE VLRDESCITVENDA NUMERIC(15, 5);
  DECLARE VARIABLE PERCCOMISITVENDA NUMERIC(9,2);
  DECLARE VARIABLE SIMPLESFILIAL CHAR(1);
  DECLARE VARIABLE SIMPLESCLI CHAR(1);
  DECLARE VARIABLE PESSOACLI CHAR(1);          
  DECLARE VARIABLE NVLRFRETE NUMERIC(15,5);
  DECLARE VARIABLE CADICFRETEVD CHAR(1);
  DECLARE VARIABLE PERCIT NUMERIC(9,2);

BEGIN
  IF (new.EMMANUT IS NULL) THEN
     new.EMMANUT='N';
  if (new.BLOQVENDA IS NULL) then
     new.BLOQVENDA='N';
  if ( ( (old.BLOQVENDA IS  NULL) OR (old.BLOQVENDA='N') ) AND (new.BLOQVENDA='S') )  then
  begin
      new.DTALT=cast('now' AS DATE);
      new.IDUSUALT=user;
      new.HALT=cast('now' AS TIME);
  end
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
  BEGIN
      EXECUTE PROCEDURE VDCLIENTEATIVOSP(new.CODEMPCL, new.CODFILIALCL, new.CODCLI);
      if ( (old.BLOQVENDA IS NOT NULL AND old.BLOQVENDA='S') or (new.BLOQVENDA='S') ) then
         EXCEPTION VDVENDAEX05 'ESTA VENDA ESTÁ BLOQUEADA!!!';
      new.DTALT=cast('now' AS DATE);
      new.IDUSUALT=user;
      new.HALT=cast('now' AS TIME);
      SELECT CODFILIALSEL FROM SGCONEXAO WHERE NRCONEXAO=CURRENT_CONNECTION AND
          CONECTADO > 0 INTO ICODFILIAL;

/*        EXECUTE PROCEDURE FNLIBCREDSP(new.CODVENDA,new.CODCLI,new.CODEMPCL,new.CODFILIALCL,new.VLRLIQVENDA);*/

      SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP, 'SGPREFERE1') INTO iCodFilialPref;
      IF (substr(old.STATUSVENDA,1,1) = 'C') THEN
        EXCEPTION VDVENDAEX05;
      IF (substr(old.STATUSVENDA,1,1) = 'D') THEN
        EXCEPTION VDVENDAEX05 'ESTA VENDA FOI DEVOLVIDA!';
      IF ((SUBSTR(old.STATUSVENDA,1,1) = 'P') AND (SUBSTR(new.STATUSVENDA,1,1) = 'V' ) AND new.IMPNOTAVENDA = 'N') THEN
      BEGIN
        SELECT T2.CODTIPOMOV, T2.SERIE FROM EQTIPOMOV T2, EQTIPOMOV T WHERE T2.CODEMP=T.CODEMPTM
               AND T2.CODFILIAL=T.CODFILIALTM AND T2.CODTIPOMOV = T.CODTIPOMOVTM
               AND T.CODEMP=new.CODEMPTM AND T.CODFILIAL=new.CODFILIALTM AND T.CODTIPOMOV=new.CODTIPOMOV
               INTO :iCodTipoMov, :sSerie;
        IF (iCodTipoMov IS NULL) THEN
          SELECT T.CODTIPOMOV, T.SERIE FROM SGPREFERE1 P, EQTIPOMOV T WHERE P.CODEMPTM=T.CODEMP AND
                 P.CODFILIALTM=T.CODFILIAL AND P.CODTIPOMOV = T.CODTIPOMOV
                 AND P.CODEMP=new.CODEMP AND P.CODFILIAL = :iCodFilialPref INTO :iCodTipoMov, :sSerie;
        new.CODTIPOMOV = :iCodTipoMov;
        new.SERIE = :sSerie;
        IF ( ( not (old.IMPNOTAVENDA = 'S') ) AND ( not (new.IMPNOTAVENDA = 'S') ) ) THEN
        BEGIN
            SELECT DOC FROM LFNOVODOCSP(new.Serie,new.CODEMP,new.CODFILIAL) INTO new.DocVenda;
            new.IMPNOTAVENDA = 'S';
        END
      END
      SELECT FISCALTIPOMOV FROM EQTIPOMOV WHERE CODTIPOMOV=new.CODTIPOMOV
             AND CODEMP=new.CODEMP AND CODFILIAL = new.codfilialtm INTO new.FLAG;
      IF (new.FLAG<>'S') THEN
        new.FLAG = 'N';
      SELECT VLRFRETEVD, ADICFRETEVD FROM VDFRETEVD WHERE CODVENDA=old.CODVENDA AND TIPOVENDA=old.TIPOVENDA AND ADICFRETEVD = 'S'
             AND CODEMP=old.CODEMP AND CODFILIAL = old.codfilial INTO new.VLRFRETEVENDA, :CADICFRETEVD;
      IF (new.VLRDESCVENDA IS NULL) THEN
        new.VLRDESCVENDA = 0;
      IF (new.VLRDESCITVENDA IS NULL) THEN
        new.VLRDESCITVENDA = 0;
      IF (new.VLRADICVENDA IS NULL) THEN
        new.VLRADICVENDA = 0;
      IF (new.VLRFRETEVENDA IS NULL) THEN
        new.VLRFRETEVENDA = 0;
      IF (new.VLRPRODVENDA IS NULL) THEN
        new.VLRPRODVENDA = 0;
      IF (new.VLRIPIVENDA IS NULL) THEN
        new.VLRIPIVENDA = 0;
      IF (new.VLRBASEICMSVENDA IS NULL) THEN
        new.VLRBASEICMSVENDA = 0;
      IF (new.VLRDESCITVENDA > 0) THEN
        dDesc = new.VLRDESCITVENDA;
      ELSE
        dDesc = new.VLRDESCVENDA;
      SELECT C.SIMPLESCLI,C.PESSOACLI FROM VDCLIENTE C WHERE C.CODCLI=new.CODCLI AND
        C.CODFILIAL=new.CODFILIALCL AND C.CODEMP=new.CODEMPCL INTO SIMPLESCLI,PESSOACLI;
      SELECT SIMPLESFILIAL,PERCPISFILIAL,PERCCOFINSFILIAL,PERCIRFILIAL,PERCCSOCIALFILIAL
        FROM SGFILIAL WHERE CODEMP=new.CODEMP AND CODFILIAL=:ICODFILIAL
        INTO SIMPLESFILIAL,PERCPISFILIAL,PERCCOFINSFILIAL,PERCIRFILIAL,PERCCSOCIALFILIAL;
      IF (SIMPLESFILIAL = 'N') THEN
      BEGIN
        new.VLRPISVENDA = (new.VLRBASEISSVENDA/100)*PERCPISFILIAL;
        new.VLRCOFINSVENDA = (new.VLRBASEISSVENDA/100)*PERCCOFINSFILIAL;
        new.VLRIRVENDA = (new.VLRBASEISSVENDA/100)*PERCIRFILIAL;
        new.VLRCSOCIALVENDA = (new.VLRBASEISSVENDA/100)*PERCCSOCIALFILIAL;
      END
      ELSE
      BEGIN
        new.VLRPISVENDA = 0;
        new.VLRCOFINSVENDA = 0;
        new.VLRIRVENDA = 0;
        new.VLRCSOCIALVENDA = 0;
      END
      if (CADICFRETEVD = 'S') then
         NVLRFRETE = new.VLRFRETEVENDA;
      else
         NVLRFRETE = 0;

      new.VLRLIQVENDA = coalesce(new.VLRPRODVENDA,0) -
                        coalesce(dDesc,0) +
                        coalesce(new.VLRADICVENDA,0) +
                        coalesce(:NVLRFRETE,0) +
                        coalesce(new.VLRIPIVENDA,0);

      if (SIMPLESCLI = 'N' AND PESSOACLI = 'J') then
      begin
        new.VLRLIQVENDA =
             cast(
                (coalesce(new.VLRLIQVENDA,0)) -
                (case when new.calcpisvenda='S' then coalesce(new.vlrpisvenda,0) else 0 end) -
                (case when new.calccofinsvenda='S' then coalesce(new.vlrcofinsvenda,0) else 0 end) -
                (case when new.calcirvenda='S' then coalesce(new.vlrirvenda,0) else 0 end) -
                (case when new.calccsocialvenda='S' then coalesce(new.vlrcsocialvenda,0) else 0 end)
            as numeric(15, 5));
      end

      IF ((substr(old.STATUSVENDA,1,1) IN ('P','V')) AND (substr(new.STATUSVENDA,1,1)='C')) THEN
      BEGIN
          new.VLRDESCITVENDA = 0;
          new.VLRPRODVENDA = 0;
          new.VLRBASEICMSVENDA = 0;
          new.VLRICMSVENDA = 0;
          new.VLRISENTASVENDA = 0;
          new.VLROUTRASVENDA = 0;
          new.VLRBASEIPIVENDA = 0;
          new.VLRIPIVENDA = 0;
          new.VLRLIQVENDA = 0;
          new.VLRCOMISVENDA = 0;
          new.VLRISSVENDA = 0;
          new.VLRBASEISSVENDA = 0;
          new.vlrpisvenda = 0;
          new.vlrcofinsvenda = 0;
          new.vlrirvenda = 0;
          new.vlrcsocialvenda =0;
      END
    /**
       COMISSAO
    **/
      IF ((NOT NEW.VLRCOMISVENDA IS NULL) AND
          (NEW.VLRLIQVENDA > 0) AND
          ((NOT NEW.VLRDESCVENDA = OLD.VLRDESCVENDA) OR (NOT NEW.PERCMCOMISVENDA = OLD.PERCMCOMISVENDA))) then
      BEGIN
        /* Distribuindo a comissao: */
        FOR SELECT CODITVENDA,VLRPRODITVENDA,QTDITVENDA,VLRCOMISITVENDA,vlrdescitvenda,iv.perccomisitvenda
            FROM VDITVENDA IV
            WHERE CODEMP=new.CODEMP AND CODFILIAL=new.CODFILIAL AND CODVENDA=new.CODVENDA and tipovenda=new.tipovenda
            INTO ICODITVENDA,VLRPRODITVENDA,QTDITVENDA,VLRCOMISITVENDA,VLRDESCITVENDA,PERCCOMISITVENDA DO
        BEGIN
          /* Calculo do item.: */
          /* INCLUIDO PARA DISTRIBUIR A COMISSAO MENOS O DESCONTO PROPORCIONALMENTE*/
          PERCIT = 0;
          IF (new.VLRPRODVENDA > 0 AND NOT new.VLRDESCITVENDA > 0 AND new.VLRDESCVENDA > 0) THEN
          BEGIN
            PERCIT = (100*VLRPRODITVENDA) / new.VLRPRODVENDA;
            VLRDESCITVENDA = (new.VLRDESCVENDA  * PERCIT) / 100;
          END
          IF (new.VLRPRODVENDA > 0 AND new.PERCMCOMISVENDA > 0) THEN
          BEGIN
            PERCCOMISITVENDA = new.PERCMCOMISVENDA;
            /* Retira.. */
            new.VLRCOMISVENDA = new.VLRCOMISVENDA - VLRCOMISITVENDA;
            /* Atualiza.. */
            VLRCOMISITVENDA = ((VLRPRODITVENDA - VLRDESCITVENDA) * PERCCOMISITVENDA) / 100;
            /* Adiciona.. */
            new.VLRCOMISVENDA = new.VLRCOMISVENDA + VLRCOMISITVENDA;
          END
          UPDATE VDITVENDA SET VLRCOMISITVENDA=:VLRCOMISITVENDA,PERCCOMISITVENDA=:PERCCOMISITVENDA
          WHERE CODITVENDA=:ICODITVENDA AND CODVENDA=new.CODVENDA AND TIPOVENDA=new.TIPOVENDA AND CODEMP=new.CODEMP AND CODFILIAL=new.CODFILIAL;
        END
      END
      /* Calcula o percentual medio da comissao */
      ELSE IF (new.PERCMCOMISVENDA = old.PERCMCOMISVENDA AND new.VLRLIQVENDA > 0) THEN
          new.PERCMCOMISVENDA = (new.VLRCOMISVENDA/new.VLRLIQVENDA)*100.000;

      IF (new.STATUSVENDA = 'V4') THEN
      BEGIN
        new.IMPNOTAVENDA = 'S';
        new.STATUSVENDA = 'V3';
      END
      IF ((new.IMPNOTAVENDA = 'S') AND (old.IMPNOTAVENDA = 'S')) THEN
      BEGIN
        new.DOCVENDA = old.DOCVENDA;
      END
  END
END
^

/* Trigger: VDVENDEDORTGBU */
CREATE TRIGGER VDVENDEDORTGBU FOR VDVENDEDOR
ACTIVE BEFORE UPDATE POSITION 0
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT=cast('now'AS TIME);
end
^

SET TERM ; ^



/******************************************************************************/
/*                             Stored Procedures                              */
/******************************************************************************/


SET TERM ^ ;

ALTER PROCEDURE ARREDDOUBLE (
    DEVALOR DOUBLE PRECISION,
    ICASASDEC INTEGER)
RETURNS (
    DERETORNO DOUBLE PRECISION)
AS
DECLARE VARIABLE I INTEGER;
DECLARE VARIABLE J INTEGER;
begin
  /* Procedure Text */
  I=1;
  J=1;
  WHILE (:J<=:iCasasDec) DO
  BEGIN
     I = I * 10;
     J=J+1;
  END
  deRetorno = floor(deValor * i + 0.5) / i;
  suspend;
end^


ALTER PROCEDURE ATADICATENDIMENTOCLISP (
    ICODTIPOATENDO INTEGER,
    ICODATEND INTEGER,
    ICODSETOR INTEGER,
    ICODEMP INTEGER,
    ICODFILIAL INTEGER,
    IDOC INTEGER,
    DATAATENDO DATE,
    DATAATENDOFIN DATE,
    HORAATENDO TIME,
    HORAATENDOFIN TIME,
    OBSATENDO VARCHAR(1000),
    CODEMPCL INTEGER,
    CODFILIALCL SMALLINT,
    CODCLI INTEGER)
AS
DECLARE VARIABLE ICODATENDO INTEGER;
DECLARE VARIABLE IFILIALATENDO INTEGER;
DECLARE VARIABLE IFILIALTIPOATENDO INTEGER;
DECLARE VARIABLE IFILIALATEND INTEGER;
DECLARE VARIABLE IFILIALSETOR INTEGER;
DECLARE VARIABLE IFILIALPREF INTEGER;
DECLARE VARIABLE IFILIALVEND INTEGER;
DECLARE VARIABLE IFILIALORC INTEGER;
DECLARE VARIABLE ICODTPATENDOLEV INTEGER; /* TIPO DE ATENDIMENTO PARA LEVANTAMENTOS */
DECLARE VARIABLE ICODORC INTEGER;
DECLARE VARIABLE ICODCLI INTEGER;
DECLARE VARIABLE ICODVEND INTEGER;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'ATATENDIMENTO') INTO IFILIALATENDO;
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'ATTIPOATENDO') INTO IFILIALTIPOATENDO;
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'ATATENDENTE') INTO IFILIALATEND;
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'ATSETOR') INTO IFILIALSETOR;
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'VDORCAMENTO') INTO IFILIALORC;
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'SGPREFERE2') INTO IFILIALPREF;
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'VDVENDEDOR') INTO IFILIALVEND;
  SELECT ISEQ FROM SPGERANUM(:ICODEMP,:IFILIALATENDO,'AT') INTO ICODATENDO;
  SELECT CODTPATENDO FROM SGPREFERE2 WHERE CODEMP=:ICODEMP AND CODFILIAL=:IFILIALPREF INTO ICODTPATENDOLEV;
/*teste*/
  INSERT INTO ATATENDIMENTO (
    CODEMP,CODFILIAL,CODATENDO,CODEMPTO,
    CODFILIALTO,CODTPATENDO,CODEMPAE,
    CODFILIALAE,CODATEND,CODEMPSA,CODFILIALSA,
    CODSETAT,STATUSATENDO,IDUSU,CODEMPUS,CODFILIALUS,DOCATENDO, DATAATENDO,
    DATAATENDOFIN, HORAATENDO, HORAATENDOFIN, OBSATENDO, CODEMPCL, CODFILIALCL, CODCLI )

  VALUES
  (
    :ICODEMP,:IFILIALATENDO,:ICODATENDO,:ICODEMP,
    :IFILIALTIPOATENDO,:ICODTIPOATENDO,:ICODEMP,
    :IFILIALATEND,:ICODATEND,:ICODEMP,:IFILIALSETOR,
    :ICODSETOR,'AA',lower(USER),:ICODEMP,:ICODFILIAL,:IDOC,
    :DATAATENDO,:DATAATENDOFIN,:HORAATENDO,:HORAATENDOFIN,:OBSATENDO,:CODEMPCL,
    :CODFILIALCL,:CODCLI
  );


END^


ALTER PROCEDURE ATADICATENDIMENTOSP (
    ICODCONV INTEGER,
    ICODTIPOATENDO INTEGER,
    ICODATEND INTEGER,
    ICODSETOR INTEGER,
    VOBSATENDO VARCHAR(10000),
    ICODEMP INTEGER,
    ICODFILIAL INTEGER,
    IDOC INTEGER)
AS
DECLARE VARIABLE ICODATENDO INTEGER;
DECLARE VARIABLE IFILIALATENDO INTEGER;
DECLARE VARIABLE IFILIALCONV INTEGER;
DECLARE VARIABLE IFILIALTIPOATENDO INTEGER;
DECLARE VARIABLE IFILIALATEND INTEGER;
DECLARE VARIABLE IFILIALSETOR INTEGER;
DECLARE VARIABLE IFILIALPREF INTEGER;
DECLARE VARIABLE IFILIALVEND INTEGER;
DECLARE VARIABLE IFILIALORC INTEGER;
DECLARE VARIABLE ICODTPATENDOLEV INTEGER; /*TIPO DE ATENDIMENTO PARA LEVANTAMENTOS*/
DECLARE VARIABLE ICODORC INTEGER;
DECLARE VARIABLE ICODCLI INTEGER;
DECLARE VARIABLE ICODVEND INTEGER;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'ATATENDIMENTO') INTO IFILIALATENDO;
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'ATCONVENIADO') INTO IFILIALCONV;
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'ATTIPOATENDO') INTO IFILIALTIPOATENDO;
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'ATATENDENTE') INTO IFILIALATEND;
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'ATSETOR') INTO IFILIALSETOR;
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'VDORCAMENTO') INTO IFILIALORC;
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'SGPREFERE2') INTO IFILIALPREF;
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'VDVENDEDOR') INTO IFILIALVEND;
  SELECT ISEQ FROM SPGERANUM(:ICODEMP,:IFILIALATENDO,'AT') INTO ICODATENDO;
  SELECT CODTPATENDO FROM SGPREFERE2 WHERE CODEMP=:ICODEMP AND CODFILIAL=:IFILIALPREF INTO ICODTPATENDOLEV;
  INSERT INTO ATATENDIMENTO (
    CODEMP,CODFILIAL,CODATENDO,CODCONV,
    CODEMPCV,CODFILIALCV,CODEMPTO,
    CODFILIALTO,CODTPATENDO,CODEMPAE,
    CODFILIALAE,CODATEND,CODEMPSA,CODFILIALSA,
    CODSETAT,STATUSATENDO,OBSATENDO,IDUSU,CODEMPUS,CODFILIALUS,DOCATENDO)
  VALUES
  (
    :ICODEMP,:IFILIALATENDO,:ICODATENDO,:ICODCONV,
    :ICODEMP,:IFILIALCONV,:ICODEMP,
    :IFILIALTIPOATENDO,:ICODTIPOATENDO,:ICODEMP,
    :IFILIALATEND,:ICODATEND,:ICODEMP,:IFILIALSETOR,
    :ICODSETOR,'AA',:VOBSATENDO,lower(USER),:ICODEMP,:ICODFILIAL,:IDOC
  );
/*  SELECT CODORC FROM ATATENDIMENTOORC WHERE CODEMP=:ICODEMP
    AND CODFILIAL=:IFILIALORC AND CODORC=:IDOC INTO ICODORC;*/
  IF (ICODTIPOATENDO = ICODTPATENDOLEV/* AND ICODORC IS NULL*/) THEN
  BEGIN
    SELECT ISEQ FROM SPGERANUM(:ICODEMP,:IFILIALORC,'OC') INTO ICODORC;
    SELECT CODFILIALVD,CODVEND FROM SGPREFERE2 WHERE
      CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL INTO IFILIALVEND,ICODVEND;
    INSERT INTO VDORCAMENTO (CODEMP,CODFILIAL,TIPOORC,CODORC,CODEMPCV,CODFILIALCV,CODCONV,
        DTORC,DTVENCORC,STATUSORC,CODEMPVD,CODFILIALVD,CODVEND)
      VALUES
      (
        :ICODEMP,:IFILIALORC,'O',:ICODORC,:ICODEMP,:IFILIALCONV,:ICODCONV,
        CAST ('today' AS DATE),CAST ('today' AS DATE),'OA',:ICODEMP,:IFILIALVEND,:ICODVEND
      );


    INSERT INTO ATATENDIMENTOORC (CODEMP,CODFILIAL,CODATENDO,CODEMPOC,CODFILIALOC,TIPOORC,CODORC)
      VALUES
        (:ICODEMP,:IFILIALORC,:ICODATENDO,:ICODEMP,:IFILIALORC,'O',:ICODORC);

    UPDATE ATATENDIMENTO SET DOCATENDO = :IDOC WHERE
      CODEMP=:ICODEMP AND CODFILIAL=:IFILIALATENDO AND CODATENDO=:ICODATENDO;
  END

END^


ALTER PROCEDURE ATBUSCAPRECOSP (
    ICODPROD INTEGER,
    ICODCONV INTEGER,
    ICODEMPCV INTEGER,
    ICODFILIALCV SMALLINT,
    ICODPLANOPAG INTEGER,
    ICODEMPPG INTEGER,
    ICODFILIALPG SMALLINT,
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT)
RETURNS (
    PRECO NUMERIC(15,5))
AS
DECLARE VARIABLE iCodTipoMov INTEGER;
  DECLARE VARIABLE iCodEmpTM INTEGER;
  DECLARE VARIABLE iCodFilialTM INTEGER;
  DECLARE VARIABLE iCodCli INTEGER;
  DECLARE VARIABLE iCodEmpCli INTEGER;
  DECLARE VARIABLE iCodFilialCli INTEGER;
BEGIN
  SELECT CODTIPOMOV2,CODEMPT2,CODFILIALT2 FROM SGPREFERE1 WHERE CODEMP=:ICODEMP
         AND CODFILIAL=:ICODFILIAL INTO iCodTipoMov,iCodEmpTM,iCodFilialTM;
  SELECT CODCLI,CODEMPCL,CODFILIALCL FROM ATCONVENIADO WHERE CODCONV=:ICODCONV
         AND CODEMP=:ICODEMPCV AND CODFILIAL=:ICODFILIALCV INTO iCodCli,iCodEmpCli,iCodFilialCli;

  SELECT PRECO FROM VDBUSCAPRECOSP(:ICODPROD,:iCodCli,:iCodEmpCli,:iCodFilialCli,:ICODPLANOPAG,:ICODEMPPG,
    :ICODFILIALPG,:iCodTipoMov,:iCodEmpTM,:iCodFilialTM,:ICODEMP,:ICODFILIAL) INTO PRECO;

  SUSPEND;
END^


ALTER PROCEDURE CPADICFORSP (
    CODEMP INTEGER,
    CODFILIAL INTEGER,
    CODFILIALCL INTEGER,
    CODCLI INTEGER)
RETURNS (
    CODFOR INTEGER)
AS
DECLARE VARIABLE CODTIPOFOR INTEGER;
DECLARE VARIABLE CODFILIALTF INTEGER;
DECLARE VARIABLE CODFILIALFR INTEGER;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(:CODEMP,'CPFORNECED') INTO CODFILIALFR;
  SELECT P.CODTIPOFOR,P.CODFILIALTF FROM SGPREFERE1 P WHERE P.CODEMP=:CODEMP
    AND P.CODFILIAL=:CODFILIAL INTO CODTIPOFOR,CODFILIALTF;
  SELECT MAX(CODFOR)+1 FROM CPFORNECED WHERE CODEMP=:CODEMP
    AND CODFILIAL=:CODFILIALFR INTO CODFOR;
  INSERT INTO CPFORNECED (CODEMP,CODFILIAL,CODFOR,RAZFOR,CODEMPTF,CODFILIALTF,
                        CODTIPOFOR,CODEMPBO,CODFILIALBO,CODBANCO,NOMEFOR,
                        DATAFOR,ATIVOFOR,PESSOAFOR,CNPJFOR,CPFFOR,INSCFOR,
                        RGFOR,ENDFOR,NUMFOR,COMPLFOR,BAIRFOR,CEPFOR,CIDFOR,
                        UFFOR,CONTFOR,FONEFOR,FAXFOR,AGENCIAFOR,CONTAFOR,
                        EMAILFOR,OBSFOR,CELFOR,CLIFOR)
                 SELECT :CODEMP,:CODFILIALFR,:CODFOR,RAZCLI,:CODEMP,:CODFILIALTF,
                        :CODTIPOFOR,NULL,NULL,NULL,NOMECLI,
                        DATACLI,ATIVOCLI,PESSOACLI,CNPJCLI,CPFCLI,INSCCLI,
                        RGCLI,ENDCLI,NUMCLI,COMPLCLI,BAIRCLI,CEPCLI,CIDCLI,
                        UFCLI,CONTCLI,FONECLI,FAXCLI,NULL,NULL,
                        EMAILCLI,OBSCLI,CELCLI,'C' FROM VDCLIENTE WHERE
                        CODCLI=:CODCLI AND CODFILIAL=:CODFILIALCL AND
                        CODEMP=:CODEMP;
  SUSPEND;
END^


ALTER PROCEDURE CPBLOQCOMPRASP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODCOMPRA INTEGER,
    CBLOQCOMPRA CHAR(1))
AS
begin
  /* Stored procedure de bloqueio e desbloqueio de venda*/
  UPDATE CPCOMPRA SET EMMANUT='S', BLOQCOMPRA=:CBLOQCOMPRA WHERE CODEMP=:ICODEMP AND
     CODFILIAL=:SCODFILIAL AND CODCOMPRA=:ICODCOMPRA;
  UPDATE CPCOMPRA SET EMMANUT='N' WHERE CODEMP=:ICODEMP AND
     CODFILIAL=:SCODFILIAL AND CODCOMPRA=:ICODCOMPRA;
  suspend;
end^


ALTER PROCEDURE CPCOMPRASP01 (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    NQTD NUMERIC(15,5),
    NVLRTOT NUMERIC(15,5),
    NVLRICMS NUMERIC(15,5))
RETURNS (
    NVLRCUSTO NUMERIC(15,5))
AS
DECLARE VARIABLE ICASASDEC INTEGER;
DECLARE VARIABLE CCUSTOSICMS CHAR(1);
begin
  /* Procedure Text */
  if (NQTD!=0) then
  begin
    SELECT CUSTOSICMS,CASASDECFIN FROM SGPREFERE1 WHERE CODEMP=:iCodEmp
       AND CODFILIAL=:sCodFilial INTO :cCustoSICMS, :iCasasDec;
    if (iCasasDec is null) then
       iCasasDec = 2;
    if (cCustoSICMS IS NULL) then
       cCustoSICMS = 'N';
    if (cCustoSICMS='S') then
    begin
       select deRetorno
         from arredDouble( (:NVLRTOT - :NVLRICMS) / :NQTD , :ICASASDEC  )
         into :NVLRCUSTO;
    end
    else
    begin
       select deRetorno
         from arredDouble( :NVLRTOT / :NQTD , :ICASASDEC )
         into :NVLRCUSTO;
    end
  end
  else
  begin
    NVLRCUSTO = 0;
  end
  suspend;
end^


ALTER PROCEDURE CPGERAENTRADASP (
    CODEMP INTEGER,
    CODFILIAL INTEGER,
    CODFILIALVD INTEGER,
    TIPOVENDA CHAR(1),
    CODVENDA INTEGER,
    CITEM CHAR(1))
RETURNS (
    CODCOMPRA INTEGER)
AS
DECLARE VARIABLE STATUSVENDA CHAR(2);
DECLARE VARIABLE CODCLI INTEGER;
DECLARE VARIABLE CODFILIALCL INTEGER;
DECLARE VARIABLE CODFILIALCP INTEGER;
DECLARE VARIABLE CODTIPOMOV INTEGER;
DECLARE VARIABLE CODFILIALTM INTEGER;
DECLARE VARIABLE SERIE INTEGER;
DECLARE VARIABLE CODFILIALSE INTEGER;
DECLARE VARIABLE DOC INTEGER;
DECLARE VARIABLE CODFOR INTEGER;
DECLARE VARIABLE CODFILIALFR INTEGER;
DECLARE VARIABLE CODITVENDA INTEGER;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(:CODEMP,'CPFORNECED') INTO CODFILIALFR;
  SELECT ICODFILIAL FROM SGRETFILIAL(:CODEMP,'CPCOMPRA') INTO CODFILIALCP;
  SELECT ICODFILIAL FROM SGRETFILIAL(:CODEMP,'VDCLINTE') INTO CODFILIALCL;

  SELECT ISEQ FROM SPGERANUM(:CODEMP,:CODFILIAL,'CP') INTO CODCOMPRA;

  SELECT CODCLI,CODFILIALCL,STATUSVENDA FROM VDVENDA WHERE CODVENDA=:CODVENDA AND TIPOVENDA=:TIPOVENDA
    AND CODEMP=:CODEMP AND CODFILIAL=:CODFILIAL INTO CODCLI,CODFILIALCL,STATUSVENDA;
  IF (SUBSTRING (STATUSVENDA FROM 1 FOR 1) = 'C') THEN
    EXCEPTION VDVENDAEX05;
  
  SELECT CODFOR FROM CPADICFORSP(:CODEMP,:CODFILIAL,:CODFILIALCL,:CODCLI) INTO CODFOR;

  SELECT P.CODTIPOMOV5,P.CODFILIALT5,
    T.SERIE,T.CODFILIALSE FROM SGPREFERE1 P, EQTIPOMOV T WHERE P.CODEMP=:CODEMP
    AND P.CODFILIAL=:CODFILIAL AND T.CODTIPOMOV=P.CODTIPOMOV5 AND
    T.CODEMP=P.CODEMPT5 AND T.CODFILIAL=P.CODFILIALT5
    INTO CODTIPOMOV,CODFILIALTM,SERIE,CODFILIALSE;

  SELECT * FROM LFNOVODOCSP(:SERIE,:CODEMP,:CODFILIALSE) INTO DOC;

  INSERT INTO CPCOMPRA (CODEMP,CODFILIAL,CODCOMPRA,CODEMPPG,CODFILIALPG,CODPLANOPAG,
                        CODEMPFR,CODFILIALFR,CODFOR,CODEMPSE,CODFILIALSE,SERIE,
                        CODEMPTM,CODFILIALTM,CODTIPOMOV,DOCCOMPRA,DTENTCOMPRA,DTEMITCOMPRA)
                 SELECT :CODEMP,:CODFILIAL,:CODCOMPRA,CODEMPPG,CODFILIALPG,CODPLANOPAG,
                        :CODEMP,:CODFILIALFR,:CODFOR,:CODEMP,:CODFILIALSE,:SERIE,
                        CODEMP,:CODFILIALTM,:CODTIPOMOV,:DOC,DTSAIDAVENDA,DTEMITVENDA FROM
                        VDVENDA WHERE CODEMP=:CODEMP AND CODFILIAL=:CODFILIALVD AND
                        CODVENDA=:CODVENDA AND TIPOVENDA=:TIPOVENDA;
  IF (CITEM = 'S') THEN
    EXECUTE PROCEDURE CPGERAITENTRADASP(:CODEMP,:CODFILIALCP,:CODCOMPRA,:CODFILIALVD,:TIPOVENDA,:CODVENDA,NULL,NULL);
    
  UPDATE VDVENDA SET STATUSVENDA='DV' WHERE TIPOVENDA=:TIPOVENDA AND CODVENDA=:CODVENDA
    AND CODEMP=:CODEMP AND CODFILIAL=:CODFILIALVD;
  
  SUSPEND;
END^


ALTER PROCEDURE CPGERAITENTRADASP (
    CODEMP INTEGER,
    CODFILIAL INTEGER,
    CODCOMPRA INTEGER,
    CODFILIALVD INTEGER,
    TIPOVENDA CHAR(1),
    CODVENDA INTEGER,
    CODITVENDA INTEGER,
    QTDIT INTEGER)
AS
DECLARE VARIABLE CODITCOMPRA INTEGER;
DECLARE VARIABLE CODFILIALTM INTEGER;
DECLARE VARIABLE CODTIPOMOV INTEGER;
DECLARE VARIABLE CODFILIALFR INTEGER;
DECLARE VARIABLE CODFOR INTEGER;
DECLARE VARIABLE CODNAT CHAR(4);
DECLARE VARIABLE CODFILIALNT INTEGER;
DECLARE VARIABLE PERCICMSITCOMPRA NUMERIC(9,2);
DECLARE VARIABLE CODFILIALPD INTEGER;
DECLARE VARIABLE CODPROD INTEGER;
DECLARE VARIABLE CODFILIALLE INTEGER;
DECLARE VARIABLE CODLOTE VARCHAR(20);
DECLARE VARIABLE QTDITVENDA NUMERIC(18,3);
DECLARE VARIABLE QTDDEVITVENDA NUMERIC(18,3);
DECLARE VARIABLE PRECOITVENDA NUMERIC(18,3);
DECLARE VARIABLE PERCDESCITVENDA NUMERIC(9,2);
DECLARE VARIABLE VLRDESCITVENDA NUMERIC(18,3);
DECLARE VARIABLE PERCICMSITVENDA NUMERIC(9,2);
DECLARE VARIABLE VLRBASEICMSITVENDA NUMERIC(18,3);
DECLARE VARIABLE VLRICMSITVENDA NUMERIC(18,3);
DECLARE VARIABLE PERCIPIITVENDA NUMERIC(9,2);
DECLARE VARIABLE VLRBASEIPIITVENDA NUMERIC(18,3);
DECLARE VARIABLE VLRIPIITVENDA NUMERIC(18,3);
DECLARE VARIABLE VLRLIQITVENDA NUMERIC(18,3);
DECLARE VARIABLE VLRADICITVENDA NUMERIC(18,3);
DECLARE VARIABLE VLRFRETEITVENDA NUMERIC(18,3);
DECLARE VARIABLE VLRISENTASITVENDA NUMERIC(18,3);
DECLARE VARIABLE VLROUTRASITVENDA NUMERIC(18,3);
DECLARE VARIABLE VLRPRODITVENDA NUMERIC(18,3);
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(:CODEMP,'LFNATOPER') INTO CODFILIALNT;
  SELECT CODFOR,CODFILIALFR,CODTIPOMOV,CODFILIALTM FROM CPCOMPRA WHERE CODCOMPRA=:CODCOMPRA
    AND CODEMP=:CODEMP AND CODFILIAL=:CODFILIAL INTO
    :CODFOR,:CODFILIALFR,:CODTIPOMOV,:CODFILIALTM;
  FOR SELECT CODITVENDA,CODFILIALPD,CODPROD,CODFILIALLE,CODLOTE,
             QTDITVENDA,PRECOITVENDA,PERCDESCITVENDA,VLRDESCITVENDA,PERCICMSITVENDA,
             VLRBASEICMSITVENDA,VLRICMSITVENDA,PERCIPIITVENDA,VLRBASEIPIITVENDA,
             VLRIPIITVENDA,VLRLIQITVENDA,VLRADICITVENDA,VLRFRETEITVENDA,VLRISENTASITVENDA,
             VLROUTRASITVENDA,VLRPRODITVENDA,VLRPRODITVENDA FROM VDITVENDA WHERE
             CODEMP=:CODEMP AND CODFILIAL=:CODFILIALVD AND CODVENDA=:CODVENDA AND TIPOVENDA=:TIPOVENDA AND
             (:CODITVENDA IS NULL OR CODITVENDA=:CODITVENDA)
             ORDER BY CODITVENDA INTO CODITCOMPRA,CODFILIALPD,CODPROD,CODFILIALLE,CODLOTE,
             QTDITVENDA,PRECOITVENDA,PERCDESCITVENDA,VLRDESCITVENDA,PERCICMSITVENDA,
             VLRBASEICMSITVENDA,VLRICMSITVENDA,PERCIPIITVENDA,VLRBASEIPIITVENDA,
             VLRIPIITVENDA,VLRLIQITVENDA,VLRADICITVENDA,VLRFRETEITVENDA,VLRISENTASITVENDA,
             VLROUTRASITVENDA,VLRPRODITVENDA,VLRPRODITVENDA DO
  BEGIN
      IF (QTDIT IS NULL) THEN
        QTDIT = QTDITVENDA;
      SELECT SUM(QTDDEV) FROM CPCOMPRAVENDA WHERE TIPOVENDA=:TIPOVENDA
        AND CODVENDA=:CODVENDA AND CODITVENDA=:CODITVENDA
        AND CODEMP=:CODEMP AND CODFILIAL=:CODFILIAL INTO QTDDEVITVENDA;
      IF (QTDIT > QTDITVENDA OR QTDIT+QTDDEVITVENDA > QTDITVENDA) THEN
        EXCEPTION VDVENDAEX01 'O ITEM: '||CAST(CODITVENDA AS CHAR(3))||' DO PEDIDO: '||
          CAST(CODVENDA AS CHAR(6))||' JA FOI DEVOLVIDO!';
        
      SELECT CODNAT FROM LFBUSCANATSP (:CODFILIAL,:CODEMP,:CODFILIALPD,:CODPROD,NULL,NULL,NULL,
                                   :CODEMP,:CODFILIALFR,:CODFOR,:CODFILIALTM,:CODTIPOMOV) INTO CODNAT;
      INSERT INTO CPITCOMPRA (CODEMP,CODFILIAL,CODCOMPRA,CODITCOMPRA,CODEMPPD,CODFILIALPD,CODPROD,
                              CODEMPLE,CODFILIALLE,CODLOTE,CODEMPNT,CODFILIALNT,CODNAT,QTDITCOMPRA,
                              PRECOITCOMPRA,PERCDESCITCOMPRA,VLRDESCITCOMPRA,PERCICMSITCOMPRA,
                              VLRBASEICMSITCOMPRA,VLRICMSITCOMPRA,PERCIPIITCOMPRA,VLRBASEIPIITCOMPRA,
                              VLRIPIITCOMPRA,VLRLIQITCOMPRA,VLRADICITCOMPRA,VLRFRETEITCOMPRA,
                              VLRISENTASITCOMPRA,VLROUTRASITCOMPRA,VLRPRODITCOMPRA,CUSTOITCOMPRA)
                       VALUES (:CODEMP,:CODFILIAL,:CODCOMPRA,:CODITCOMPRA,:CODEMP,:CODFILIALPD,:CODPROD,
                              :CODEMP,:CODFILIALLE,:CODLOTE,:CODEMP,:CODFILIALNT,:CODNAT,:QTDIT,
                              :PRECOITVENDA,:PERCDESCITVENDA,:VLRDESCITVENDA,:PERCICMSITVENDA,
                              :VLRBASEICMSITVENDA,:VLRICMSITVENDA,:PERCIPIITVENDA,:VLRBASEIPIITVENDA,
                              :VLRIPIITVENDA,:VLRLIQITVENDA,:VLRADICITVENDA,:VLRFRETEITVENDA,
                              :VLRISENTASITVENDA,:VLROUTRASITVENDA,:VLRPRODITVENDA,:VLRPRODITVENDA);

      INSERT INTO CPCOMPRAVENDA(CODEMP,CODFILIAL,CODCOMPRA,CODITCOMPRA,CODEMPVD,
                                CODFILIALVD,TIPOVENDA,CODVENDA,CODITVENDA,QTDDEV)
                       VALUES (:CODEMP,:CODFILIAL,:CODCOMPRA,:CODITCOMPRA,:CODEMP,
                               :CODFILIALVD,:TIPOVENDA,:CODVENDA,:CODITCOMPRA,:QTDIT);
  END
  SUSPEND;
END^


ALTER PROCEDURE EQACERTACUSTORMASP
AS
DECLARE VARIABLE ICODRMA INTEGER;
DECLARE VARIABLE ICODFILIAL INTEGER;
DECLARE VARIABLE CUSTODATA NUMERIC(15,2);
DECLARE VARIABLE ICODITRMA INTEGER;
DECLARE VARIABLE ICODEMP INTEGER;
begin
   for select vw.codemp,vw.codfilial,vw.codrma, vw.coditrma, vw.custodata
   from vwtmpcustoitrma vw INTO ICODEMP,ICODFILIAL,ICODRMA,ICODITRMA,CUSTODATA
   do
   begin
      update eqitrma itr set itr.precoitrma=:CUSTODATA
      where itr.codemp=:ICODEMP AND itr.codfilial = :ICODFILIAL
      and itr.codrma = :ICODRMA and itr.coditrma=:ICODITRMA;
   END
  suspend;
end^


ALTER PROCEDURE EQADICPRODUTOSP (
    ICODPROD INTEGER,
    SDESCPROD CHAR(50),
    SDESCAUXPROD CHAR(40),
    SREFPROD CHAR(13),
    SCODFABPROD CHAR(13),
    SCODBARPROD CHAR(13),
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT)
AS
DECLARE VARIABLE ICODNOVO INTEGER;
DECLARE VARIABLE CODALMOX INTEGER;
DECLARE VARIABLE CODEMPAX INTEGER;
DECLARE VARIABLE CODFILIALAX INTEGER;
DECLARE VARIABLE CODMOEDA CHAR(4);
DECLARE VARIABLE CODEMPMA INTEGER;
DECLARE VARIABLE CODFILIALMA INTEGER;
DECLARE VARIABLE CODUNID VARCHAR(20);
DECLARE VARIABLE CODEMPUD INTEGER;
DECLARE VARIABLE CODFILIALUD INTEGER;
DECLARE VARIABLE CODFISC CHAR(10);
DECLARE VARIABLE CODEMPFC INTEGER;
DECLARE VARIABLE CODFILIALFC INTEGER;
DECLARE VARIABLE CODMARCA CHAR(6);
DECLARE VARIABLE CODEMPMC INTEGER;
DECLARE VARIABLE CODFILIALMC INTEGER;
DECLARE VARIABLE CODGRUP CHAR(10);
DECLARE VARIABLE CODEMPGP INTEGER;
DECLARE VARIABLE CODFILIALGP INTEGER;
DECLARE VARIABLE TIPOPROD CHAR(1);
DECLARE VARIABLE CVPROD CHAR(1);
DECLARE VARIABLE CLOTEPROD CHAR(1);
DECLARE VARIABLE COMISPROD NUMERIC(6,2);
DECLARE VARIABLE PESOLIQPROD NUMERIC(10,2);
DECLARE VARIABLE PESOBRUTPROD NUMERIC(10,2);
DECLARE VARIABLE QTDMINPROD NUMERIC(15,5);
DECLARE VARIABLE QTDMAXPROD NUMERIC(15,5);
DECLARE VARIABLE PRECOBASEPROD NUMERIC(15,5);
BEGIN
  BEGIN
    BEGIN
      iCodnovo = CAST(SREFPROD AS INTEGER);
/*Se não conseguir converter para int causa uma excessão e entra neste bloco: */
      WHEN ANY DO
      BEGIN
        SELECT MAX(CODPROD) FROM EQPRODUTO
           WHERE CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL INTO :iCodnovo;
        iCodnovo = iCodnovo + 1;
      END
    END
    SELECT CODALMOX,CODEMPAX,CODFILIALAX,CODMOEDA,CODEMPMA,CODFILIALMA,CODUNID,CODEMPUD,CODFILIALUD,CODFISC,CODEMPFC,CODFILIALFC,CODMARCA,CODEMPMC,CODFILIALMC,CODGRUP,CODEMPGP,CODFILIALGP,TIPOPROD,
           CVPROD,CLOTEPROD,COMISPROD,PESOLIQPROD,PESOBRUTPROD,QTDMINPROD,
           QTDMAXPROD,PRECOBASEPROD FROM EQPRODUTO WHERE CODPROD=:iCodprod
           AND CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL
           INTO
           :CODALMOX,:CODEMPAX,:CODFILIALAX,:CODMOEDA,:CODEMPMA,:CODFILIALMA,:CODUNID,:CODEMPUD,:CODFILIALUD,:CODFISC,:CODEMPFC,:CODFILIALFC,:CODMARCA,:CODEMPMC,:CODFILIALMC,:CODGRUP,:CODEMPGP,:CODFILIALGP,:TIPOPROD,
           :CVPROD,:CLOTEPROD,:COMISPROD,:PESOLIQPROD,:PESOBRUTPROD,:QTDMINPROD,
           :QTDMAXPROD,:PRECOBASEPROD;
    INSERT INTO EQPRODUTO (CODEMP,CODFILIAL,CODPROD,REFPROD,CODALMOX,CODEMPAX,CODFILIALAX,CODMOEDA,CODEMPMA,CODFILIALMA,CODUNID,CODEMPUD,CODFILIALUD,CODFISC,CODEMPFC,CODFILIALFC,CODMARCA,CODEMPMC,CODFILIALMC,
           CODGRUP,CODEMPGP,CODFILIALGP,TIPOPROD,CVPROD,DESCPROD,DESCAUXPROD,CLOTEPROD,CODBARPROD,CODFABPROD,
           COMISPROD,PESOLIQPROD,PESOBRUTPROD,QTDMINPROD,QTDMAXPROD,PRECOBASEPROD)
           VALUES (
                  :ICODEMP,:ICODFILIAL,:iCodnovo,:sRefProd,:CODALMOX,:CODEMPAX,:CODFILIALAX,:CODMOEDA,:CODEMPMA,:CODFILIALMA,:CODUNID,:CODEMPUD,:CODFILIALUD,:CODFISC,:CODEMPFC,:CODFILIALFC,:CODMARCA,:CODEMPMC,:CODFILIALMC,
                  :CODGRUP,:CODEMPGP,:CODFILIALGP,:TIPOPROD,:CVPROD,:sDescprod,:sDescAuxprod,:CLOTEPROD,:sCodbarprod,:sCodfabprod,
                  :COMISPROD,:PESOLIQPROD,:PESOBRUTPROD,:QTDMINPROD,:QTDMAXPROD,:PRECOBASEPROD
           );
    INSERT INTO VDPRECOPROD (CODEMP,CODFILIAL,CODPROD,CODPRECOPROD,CODCLASCLI,CODEMPCC,CODFILIALCC,CODTAB,CODEMPTB,CODFILIALTB,CODPLANOPAG,CODEMPPG,CODFILIALPG,PRECOPROD)
           SELECT :ICODEMP,:ICODFILIAL,:iCodnovo,CODPRECOPROD,CODCLASCLI,CODEMPCC,CODFILIALCC,
                  CODTAB,CODEMPTB,CODFILIALTB,CODPLANOPAG,CODEMPPG,CODFILIALPG,PRECOPROD FROM VDPRECOPROD WHERE CODPROD=:iCodprod
                  AND CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL;
  END
  SUSPEND;
END^


ALTER PROCEDURE EQBUSCASIMILARSP (
    CODEMP INTEGER,
    CODFILIAL CHAR(8),
    IPROD INTEGER,
    SREFPROD CHAR(13))
RETURNS (
    SRET CHAR(13),
    IRET INTEGER,
    CORIG CHAR(1),
    ICODFOR INTEGER,
    SRAZFOR CHAR(50),
    NPRECO NUMERIC(15,5),
    SSIM CHAR(18),
    SSIMMASTER CHAR(18))
AS
DECLARE VARIABLE SFK CHAR(21);
DECLARE VARIABLE SBUSCA CHAR(21);
BEGIN
/*  IF (IPROD IS NULL) THEN
  BEGIN
    SELECT CODPROD FROM EQPRODUTO WHERE CODEMP=:CODEMP
      AND CODFILIAL=:CODFILIAL AND REFPROD=:SREFPROD
      INTO IPROD;
    SBUSCA = CAST(SREFPROD AS CHAR(21));
  END
  ELSE
  BEGIN
    SBUSCA = CAST(IPROD AS VARCHAR(21));
  END
  FOR SELECT 'S',S.REFPRODSIM,S.REFPRODSIMFK,CAST(NULL AS INTEGER),
    CAST(NULL AS CHAR(50)),CAST(NULL AS NUMERIC(15, 5)),
    S.CODPROD,(SELECT P.REFPROD FROM EQPRODUTO P WHERE P.CODPROD=S.CODPROD
    AND P.CODEMP=S.CODEMP AND P.CODFILIAL=S.CODFILIAL)
    FROM EQSIMILAR S WHERE
    (S.CODPROD = :IPROD OR S.REFPRODSIM = :SBUSCA)
    AND S.CODEMP=:CODEMP AND S.CODFILIAL=:CODFILIAL INTO
    CORIG,SSIM,SFK,ICODFOR,SRAZFOR,NPRECO,IRET,SRET DO
  BEGIN
    SSIMMASTER = SSIM;
    SUSPEND;
    FOR SELECT 'K',S.REFPRODSIM,S.REFPRODSIMFK,CAST(NULL AS INTEGER),
      CAST(NULL AS CHAR(50)),CAST(NULL AS NUMERIC(15, 5)),
      S.CODPROD,(SELECT P.REFPROD FROM EQPRODUTO P WHERE P.CODPROD=S.CODPROD
      AND P.CODEMP=S.CODEMP AND P.CODFILIAL=S.CODFILIAL)
      FROM EQSIMILAR S WHERE
      (S.REFPRODSIMFK = :SFK OR S.CODPROD=:IRET) AND NOT S.REFPRODSIM=:SSIMMASTER
      AND S.CODEMP=:CODEMP AND S.CODFILIAL=:CODFILIAL INTO
      CORIG,SSIM,SFK,ICODFOR,SRAZFOR,NPRECO,IRET,SRET DO
    BEGIN
      SUSPEND;
    END
  END

  FOR SELECT 'C',C.REFPRODFOR,C.CODFOR,F.RAZFOR,CAST(NULL AS NUMERIC(15, 5)),
    P.CODPROD,(SELECT P.REFPROD FROM EQPRODUTO P WHERE P.CODPROD=C.CODPROD
    AND P.CODEMP=C.CODEMP AND P.CODFILIAL=C.CODFILIAL)
    FROM CPPRODFOR C, EQPRODUTO P, CPFORNECED F
    WHERE (C.CODPROD = :IPROD OR C.REFPRODFOR = :SBUSCA)
    AND C.CODEMP=:CODEMP AND C.CODFILIAL=:CODFILIAL AND P.CODEMP=C.CODEMP
    AND P.CODFILIAL=C.CODFILIAL AND P.CODPROD=C.CODPROD
    AND F.CODEMP=C.CODEMP AND F.CODFILIAL=C.CODFILIAL
    AND F.CODFOR=C.CODFOR
    UNION
    SELECT 'T',T.REFPRODTFOR,T.CODFOR,F.RAZFOR,T.PRECOPRODTFOR,
    (SELECT P.CODPROD FROM EQPRODUTO P WHERE P.CODEMP=T.CODEMPPD
    AND P.CODFILIAL=T.CODFILIALPD AND P.CODPROD=T.CODPROD),
    (SELECT P.REFPROD FROM EQPRODUTO P WHERE P.CODPROD=T.CODPROD
    AND P.CODEMP=T.CODEMP AND P.CODFILIAL=T.CODFILIAL)
    FROM CPTABFOR T, CPFORNECED F
    WHERE T.REFPRODTFOR = :SBUSCA AND T.CODEMP=:CODEMP
    AND T.CODFILIAL=:CODFILIAL AND F.CODEMP=T.CODEMP
    AND F.CODFILIAL=T.CODFILIAL AND F.CODFOR=T.CODFOR INTO
    CORIG,SSIM,ICODFOR,SRAZFOR,NPRECO,SRET,IRET DO
  BEGIN
    SUSPEND;
  END */
END^


ALTER PROCEDURE EQCALCPEPSSP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODPROD INTEGER,
    NSLDPROD NUMERIC(15,5),
    DTESTOQ DATE,
    ICODEMPAX INTEGER,
    SCODFILIALAX SMALLINT,
    ICODALMOX INTEGER)
RETURNS (
    NCUSTOPEPS NUMERIC(15,5))
AS
DECLARE VARIABLE DTTEMP DATE;
DECLARE VARIABLE NCUSTO NUMERIC(15,5);
DECLARE VARIABLE NQTD NUMERIC(15,5);
DECLARE VARIABLE NRESTO NUMERIC(15,5);
DECLARE VARIABLE NCUSTOTOT NUMERIC(15,5);
DECLARE VARIABLE NSLDTMP NUMERIC(15,5);
begin
  /* Procedure que retorna o cálculo do custo peps */
  NCUSTO = 0;
  NCUSTOTOT = 0;
  NRESTO = 0;
  NCUSTOPEPS = 0;
  IF ( (NSLDPROD IS NOT NULL) AND (NSLDPROD != 0) ) THEN
  BEGIN
      NSLDTMP = NSLDPROD;
      FOR SELECT MP.DTMOVPROD,MP.QTDMOVPROD,MP.PRECOMOVPROD
        FROM EQMOVPROD MP, EQTIPOMOV TM
         WHERE MP.CODEMPPD=:ICODEMP AND MP.CODFILIALPD=:SCODFILIAL AND MP.CODPROD=:ICODPROD AND
           MP.CODEMPTM=TM.CODEMP AND MP.CODFILIALTM=TM.CODFILIAL AND MP.CODTIPOMOV=TM.CODTIPOMOV AND
           MP.TIPOMOVPROD IN ('E','I') AND TM.TIPOMOV IN ('IV','CP','PC') AND
           MP.DTMOVPROD<=:DTESTOQ  AND
           ( (:ICODALMOX IS NULL) OR
             (MP.CODEMPAX=:ICODEMPAX AND MP.CODFILIALAX=:SCODFILIALAX AND
             MP.CODALMOX=:ICODALMOX)
           )
         ORDER BY MP.DTMOVPROD DESC, MP.CODMOVPROD DESC
         INTO :DTTEMP,:NQTD,:NCUSTO DO
      BEGIN
         IF (NQTD IS NULL) THEN
            NQTD = 0;
         IF ( (NCUSTO IS NULL) ) THEN
            NCUSTO = 0;
         NRESTO = NSLDTMP - NQTD;
         IF (NRESTO<=0) THEN
         BEGIN
           NCUSTOTOT = NCUSTOTOT + (NCUSTO * (NQTD+NRESTO) );
           BREAK;
         END
         ELSE
         BEGIN
           NCUSTOTOT = NCUSTOTOT + (NCUSTO * NQTD);
           NSLDTMP = NSLDTMP - NQTD;
         END
      END
      NCUSTOPEPS = NCUSTOTOT / NSLDPROD;
  END
  suspend;
end^


ALTER PROCEDURE EQCOPIAPROD (
    ICODPROD INTEGER,
    ICODEMP INTEGER,
    ICODFILIAL INTEGER)
RETURNS (
    ICOD INTEGER)
AS
DECLARE VARIABLE INOVOCOD INTEGER;
BEGIN
  SELECT MAX(CODPROD)+1 FROM EQPRODUTO
    WHERE CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL INTO INOVOCOD;
  INSERT INTO EQPRODUTO
      (CODPROD,CODEMP,CODFILIAL,DESCPROD,REFPROD,CODEMPAX,
      CODFILIALAX,CODALMOX,CODEMPMA,CODFILIALMA,CODMOEDA,CODEMPUD,
      CODFILIALUD,CODUNID,CODEMPFC,CODFILIALFC,CODFISC,CODEMPMC,
      CODFILIALMC,CODMARCA,DESCAUXPROD,TIPOPROD,CVPROD,CODEMPGP,
      CODFILIALGP,CODGRUP,CODBARPROD,CLOTEPROD,CODFABPROD,
      COMISPROD,PESOLIQPROD,PESOBRUTPROD,QTDMINPROD,QTDMAXPROD,
      PRECOBASEPROD,ATIVOPROD,DESCCOMPPROD)
    SELECT :INOVOCOD,:ICODEMP,:ICODFILIAL,DESCPROD,:INOVOCOD,CODEMPAX,
      CODFILIALAX,CODALMOX,CODEMPMA,CODFILIALMA,CODMOEDA,CODEMPUD,
      CODFILIALUD,CODUNID,CODEMPFC,CODFILIALFC,CODFISC,CODEMPMC,
      CODFILIALMC,CODMARCA,DESCAUXPROD,TIPOPROD,CVPROD,CODEMPGP,
      CODFILIALGP,CODGRUP,CODBARPROD,CLOTEPROD,CODFABPROD,COMISPROD,
      PESOLIQPROD,PESOBRUTPROD,QTDMINPROD,QTDMAXPROD,PRECOBASEPROD,
      ATIVOPROD,DESCCOMPPROD FROM
      EQPRODUTO WHERE CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL AND
      CODPROD=:ICODPROD;

    INSERT INTO VDPRECOPROD (CODEMP,CODFILIAL,CODPROD,CODPRECOPROD,
        CODEMPTB,CODFILIALTB,CODTAB,CODEMPCC,CODFILIALCC,CODCLASCLI,
        CODEMPPG,CODFILIALPG,CODPLANOPAG,PRECOPROD)
      SELECT CODEMP,CODFILIAL,:INOVOCOD,CODPRECOPROD,
        CODEMPTB,CODFILIALTB,CODTAB,CODEMPCC,CODFILIALCC,CODCLASCLI,
        CODEMPPG,CODFILIALPG,CODPLANOPAG,PRECOPROD FROM VDPRECOPROD
        WHERE CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL AND
          CODPROD=:ICODPROD;

    INSERT INTO EQFATCONV (CODEMP,CODFILIAL,CODPROD,CODUNID,FATCONV)
      SELECT CODEMP,CODFILIAL,:INOVOCOD,CODUNID,FATCONV FROM EQFATCONV
        WHERE CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL AND CODPROD=:ICODPROD;

    INSERT INTO CPPRODFOR (CODEMP,CODFILIAL,CODPROD,CODFOR,REFPRODFOR)
      SELECT CODEMP,CODFILIAL,:INOVOCOD,CODFOR,REFPRODFOR FROM CPPRODFOR
        WHERE CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL AND CODPROD=:ICODPROD;
        
    /* se for outro produto o lote provavelmente será outro também */
    /*INSERT INTO EQLOTE (CODEMP,CODFILIAL,CODPROD,CODLOTE,VENCTOLOTE,
        SLDLOTE,SLDRESLOTE,SLDCONSIGLOTE,SLDLIQLOTE,DINILOTE)
      SELECT CODEMP,CODFILIAL,:INOVOCOD,CODLOTE,VENCTOLOTE,
        SLDLOTE,SLDRESLOTE,SLDCONSIGLOTE,SLDLIQLOTE,DINILOTE FROM EQLOTE
        WHERE CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL AND CODPROD=:ICODPROD;*/
        
    INSERT INTO VDFOTOPROD (CODEMP,CODFILIAL,CODPROD,CODFOTOPROD,DESCFOTOPROD,
        TIPOFOTOPROD,LARGFOTOPROD,ALTFOTOPROD,FOTOPROD)
      SELECT CODEMP,CODFILIAL,:INOVOCOD,CODFOTOPROD,DESCFOTOPROD,
        TIPOFOTOPROD,LARGFOTOPROD,ALTFOTOPROD,FOTOPROD FROM VDFOTOPROD
        WHERE CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL AND CODPROD=:ICODPROD;
   ICOD = INOVOCOD;
   SUSPEND;
END^


ALTER PROCEDURE EQCUSTOPRODSP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODPROD INTEGER,
    DTESTOQ DATE,
    CTIPOCUSTO CHAR(1),
    ICODEMPAX INTEGER,
    SCODFILIALAX SMALLINT,
    ICODALMOX INTEGER,
    CCOMSALDO CHAR(10))
RETURNS (
    SLDPROD NUMERIC(15,5),
    CUSTOUNIT NUMERIC(15,5),
    CUSTOTOT NUMERIC(15,5))
AS
DECLARE VARIABLE PRECOBASE NUMERIC(15,5);
DECLARE VARIABLE CUSTOMPM NUMERIC(15,5);
begin
  /* Retorna o custo unitário do produto */
  IF (CTIPOCUSTO IS NULL) then
     CTIPOCUSTO = 'P';

  SELECT P.PRECOBASEPROD,
     (SELECT FIRST 1 M.SLDMOVPROD
     FROM EQMOVPROD M
     WHERE M.CODEMPPD=P.CODEMP AND
           M.CODFILIAL=P.CODFILIAL AND
           M.CODPROD=P.CODPROD AND
           M.DTMOVPROD<=:DTESTOQ
     ORDER BY P.CODPROD, M.DTMOVPROD DESC , M.CODMOVPROD DESC
     ) ,
     (SELECT FIRST 1 M.CUSTOMPMMOVPROD
     FROM EQMOVPROD M
     WHERE M.CODEMPPD=P.CODEMP AND
           M.CODFILIAL=P.CODFILIAL AND
           M.CODPROD=P.CODPROD AND
           M.DTMOVPROD<=:DTESTOQ
     ORDER BY P.CODPROD, M.DTMOVPROD DESC , M.CODMOVPROD DESC
     )
   FROM EQPRODUTO P
   WHERE P.CODEMP = :ICODEMP AND P.CODFILIAL = :SCODFILIAL AND
      P.CODPROD=:ICODPROD
   INTO :PRECOBASE, :SLDPROD, :CUSTOMPM;

  CUSTOUNIT = 0;
  CUSTOTOT = 0;
  IF (SLDPROD IS NULL) THEN
        SLDPROD = 0;
  IF ( (SLDPROD!=0) OR (CCOMSALDO!='S') ) THEN
  BEGIN
      IF (CTIPOCUSTO='P') THEN
      BEGIN
         SELECT NCUSTOPEPS FROM EQCALCPEPSSP(:ICODEMP,:SCODFILIAL,:ICODPROD,
            :SLDPROD,:DTESTOQ, :ICODEMPAX, :SCODFILIALAX, :ICODALMOX)
            INTO :CUSTOUNIT;
         IF (CUSTOUNIT!=0) THEN
            CUSTOTOT = CUSTOUNIT*SLDPROD;
      END
      ELSE IF (CTIPOCUSTO='M') THEN
      BEGIN
         CUSTOUNIT = CUSTOMPM;
         IF (CUSTOUNIT IS NULL) THEN
            CUSTOUNIT = 0;
          CUSTOTOT = CUSTOUNIT*SLDPROD;
      END
      ELSE IF (CTIPOCUSTO='B') THEN
      BEGIN
         CUSTOUNIT = PRECOBASE;
         IF (CUSTOUNIT IS NULL) THEN
            CUSTOUNIT = 0;
          CUSTOTOT = CUSTOUNIT*SLDPROD;
      END
  END
  SUSPEND;
end^


ALTER PROCEDURE EQGERARMASP (
    CODEMPOP INTEGER,
    CODFILIALOP INTEGER,
    CODOP INTEGER,
    SEQOP SMALLINT)
AS
declare variable seqof smallint;
declare variable idusu1 char(8);
declare variable seqitop integer;
declare variable coditrma integer;
declare variable refprod char(13);
declare variable codrma integer;
declare variable codtipomov1 integer;
declare variable codccusu1 char(19);
declare variable codfilialccusu1 smallint;
declare variable codfilialpd smallint;
declare variable codfilialtm1 smallint;
declare variable codprod integer;
declare variable codfilialle smallint;
declare variable custompmit numeric(15,5);
declare variable codlote varchar(20);
declare variable codalmox integer;
declare variable qtd numeric(15,2);
declare variable codfilialax smallint;
declare variable codfilialusu1 smallint;
declare variable anoccusu1 smallint;
declare variable statusaprovrmager char(2) = 'PE';
declare variable statusrmager char(2);
declare variable codfilialfase smallint;
declare variable qtdaprov numeric(15,5) = 0;
declare variable codfase integer;
begin
  select codfilialusu,codfilialccusu,codccusu,anoccusu,idusus
         from sgretinfousu(user) into
         :CODFILIALUSU1,:CODFILIALCCUSU1,:CODCCUSU1,:ANOCCUSU1,:IDUSU1;
  select codfilialt8,codtipomov8 from sgprefere1
  where codemp=:CODEMPOP and codfilial=
  (select icodfilial from sgretfilial(:CODEMPOP, 'SGPREFERE1'))
  into :CODFILIALTM1,:CODTIPOMOV1;

  select coalesce(SITRMAOP,'PE') from sgprefere5 where codemp=:CODEMPOP and
  codfilial=(select icodfilial from sgretfilial(:CODEMPOP,'SGPREFERE5'))
   into :STATUSRMAGER;

  QTDAPROV = 0;
  STATUSAPROVRMAGER = 'PE';

  for select codfilialfs,codfase,seqof from ppopfase opf
      where opf.codemp=:CODEMPOP and opf.codfilial=:CODFILIALOP and
      opf.codop=:CODOP and  opf.seqop=:SEQOP and
      (select count(1) from ppitop it
      where it.codemp=:CODEMPOP and it.codfilial=:CODFILIALOP and
      it.codempfs=opf.codempfs and it.codfilialfs=opf.codfilialfs and
      it.codfase=opf.codfase and it.gerarma='S' and
      it.codop=:CODOP and it.seqop=:SEQOP) > 0
      into :codfilialfase,:codfase,:SEQOF do
  begin
  select coalesce((max(codrma)+1),1) from
     eqrma where codemp=:CODEMPOP and codfilial=:CODFILIALOP into :CODRMA;

  insert into eqrma (codemp,codfilial,codrma,
                     codempuu,codfilialuu,idusu,
                     codempua,codfilialua,idusuaprov,
                     codempue,codfilialue,idusuexp,
                     codemptm,codfilialtm,codtipomov,
                     codempcc,codfilialcc,anocc,codcc,
                     dtareqrma,dtaaprovrma,dtaexprma,
                     sitrma,sitaprovrma,sitexprma,
                     codempof,codfilialof,codop,seqop,seqof,
                     motivorma)
                     values
                     (:CODEMPOP,(SELECT ICODFILIAL FROM sgretfilial(:CODEMPOP,'EQRMA')),:CODRMA,
                      :CODEMPOP, :CODFILIALUSU1,:IDUSU1,
                      null,null,null,
                      null,null,null,
                      :CODEMPOP,(SELECT ICODFILIAL FROM sgretfilial(:CODEMPOP,'EQTIPOMOV')),
                      :CODTIPOMOV1,
                      :CODEMPOP,:CODFILIALCCUSU1,:ANOCCUSU1,:CODCCUSU1,
                      cast('now' AS DATE),null,null,
                      :STATUSRMAGER,:STATUSAPROVRMAGER,'PE',
                      :CODEMPOP,:CODFILIALOP,:CODOP,:SEQOP,:SEQOF,
                      'REQUISIÇÃO GERADA PARA ATENDIMENTO À OP:'||:CODOP||' SEQ:'||:SEQOP||' - FASE:'||:CODFASE
                     );
    for select it.seqitop,it.codfilialpd,it.codprod,it.refprod,it.qtditop-coalesce(it.qtdcopiaitop,0),it.codfilialle,it.codlote,
        (SELECT coalesce(CUSTOMPMPROD,0) FROM EQPRODUTO WHERE CODEMP=it.codemppd and
        codfilial=it.codfilialpd and codprod=it.codprod),
        (SELECT CODFILIALAX FROM EQPRODUTO WHERE CODEMP=it.codemppd and
        codfilial=it.codfilialpd and codprod=it.codprod),
        (SELECT CODALMOX FROM EQPRODUTO WHERE CODEMP=it.codemppd and
        codfilial=it.codfilialpd and codprod=it.codprod)
        from ppitop it, eqproduto pd
        where
            pd.codemp=it.codemppd and pd.codfilial=it.codfilialpd and pd.codprod=it.codprod
            and it.codemp=:CODEMPOP and it.codfilial=:CODFILIALOP
            and it.codop=:CODOP and it.seqop=:SEQOP and it.codempfs=:CODEMPOP
            and it.codfilialfs=:CODFILIALFASE
            and it.codfase = :CODFASE and it.gerarma='S'
            and (('S'=(select ratauto from sgprefere5 where codemp=it.codemp and codfilial=it.codfilial))
            and (it.qtditop-coalesce(it.qtdcopiaitop, 0))<=(SELECT L.SLDLOTE FROM EQLOTE L
                                                            WHERE L.CODEMP=it.codemple AND L.CODFILIAL=it.codfilialle AND
                                                            L.CODPROD=it.codprod AND L.CODLOTE=it.codlote)
            or pd.cloteprod = 'N'
                                                            )
            into :SEQITOP, :CODFILIALPD,:CODPROD,:REFPROD,:QTD,
            :CODFILIALLE,:CODLOTE,:CUSTOMPMIT,:CODFILIALAX,:CODALMOX  DO
    begin
       select coalesce((max(coditrma)+1),1) from eqitrma
       where codemp=:CODEMPOP and codfilial=:CODFILIALOP and
       codrma=:CODRMA into :coditrma;

       if(:STATUSRMAGER='AF')then
       begin
         STATUSAPROVRMAGER = 'AT';
         QTDAPROV = :QTD;
       end

       insert into eqitrma (CODEMP,CODFILIAL,CODRMA,CODITRMA,
                            CODEMPPD,CODFILIALPD,CODPROD,REFPROD,
                            QTDITRMA,QTDAPROVITRMA,QTDEXPITRMA,PRECOITRMA,
                            CODEMPLE,CODFILIALLE,CODLOTE,
                            CODEMPAX,CODFILIALAX,CODALMOX,
                            SITITRMA,SITAPROVITRMA,SITEXPITRMA
                            )
                            values
                            (:CODEMPOP,(SELECT ICODFILIAL FROM sgretfilial(:CODEMPOP,'EQITRMA')),:CODRMA,
                            :coditrma,
                            :CODEMPOP,(SELECT ICODFILIAL FROM sgretfilial(:CODEMPOP,'EQPRODUTO')),
                            :CODPROD,:REFPROD,:QTD,:QTDAPROV,0,:CUSTOMPMIT,:CODEMPOP,(SELECT ICODFILIAL FROM sgretfilial(:CODEMPOP,'EQLOTE')),:CODLOTE,
                            :CODEMPOP,:CODFILIALAX,:CODALMOX,
                            :STATUSRMAGER,:STATUSAPROVRMAGER,'PE'
                            );

        update ppitop it set it.gerarma='N' where it.CODEMP=:CODEMPOP AND
            it.CODFILIAL=:CODFILIALOP AND
            it.codop=:CODOP and it.seqop=:SEQOP and it.seqitop=:seqitop;

   end
  end
  suspend;
end^


ALTER PROCEDURE EQMOVPRODATEQSP (
    ICODEMPPD INTEGER,
    SCODFILIALPD SMALLINT,
    ICODPROD INTEGER,
    ICODEMPLEOLD INTEGER,
    SCODFILIALLEOLD SMALLINT,
    CCODLOTEOLD VARCHAR(20),
    ICODEMPLENEW INTEGER,
    SCODFILIALLENEW SMALLINT,
    CCODLOTENEW VARCHAR(20),
    SOPERADOR SMALLINT,
    NQTDMOVPRODOLD NUMERIC(15,5),
    NQTDMOVPRODNEW NUMERIC(15,5),
    ICODEMPAXOLD INTEGER,
    SCODFILIALAXOLD SMALLINT,
    ICODALMOXOLD INTEGER,
    ICODEMPAXNEW INTEGER,
    SCODFILIALAXNEW SMALLINT,
    ICODALMOXNEW INTEGER)
AS
DECLARE VARIABLE CCLOTEPROD CHAR(1);
DECLARE VARIABLE ICODALMOX INTEGER;
DECLARE VARIABLE ICODEMPAX INTEGER;
DECLARE VARIABLE SCODFILIALAX SMALLINT;
begin
  /* Procedure de atualização do estoque */
  UPDATE EQPRODUTO SET SLDPROD = SLDPROD+((:NQTDMOVPRODNEW-:NQTDMOVPRODOLD)*:SOPERADOR)
            WHERE CODPROD=:ICODPROD AND CODEMP=:ICODEMPPD AND CODFILIAL=:SCODFILIALPD;

  SELECT CLOTEPROD, CODALMOX,CODEMPAX,CODFILIALAX FROM EQPRODUTO
     WHERE CODPROD = :ICODPROD AND CODEMP=:ICODEMPPD AND CODFILIAL = :SCODFILIALPD
      INTO :CCLOTEPROD, :ICODALMOX, :ICODEMPAX, :SCODFILIALAX;

  EXECUTE PROCEDURE EQSALDOPRODATEQSP(:ICODEMPPD, :SCODFILIALPD, :ICODPROD, :SOPERADOR,
   :NQTDMOVPRODOLD, :NQTDMOVPRODNEW, :ICODEMPAXOLD, :SCODFILIALAXOLD, :ICODALMOXOLD,
   :ICODEMPAXNEW, :SCODFILIALAXNEW, :ICODALMOXNEW);

  IF (CCLOTEPROD = 'S') THEN
  BEGIN
    IF (CCODLOTENEW IS NULL) THEN
    BEGIN
      EXCEPTION EQPRODUTOEX01 'ESTE MOVIMENTO PRECISA DE UM LOTE!';
    END
    ELSE
    BEGIN
       EXECUTE PROCEDURE EQSALDOLOTEATEQSP(:ICODEMPLEOLD, :SCODFILIALLEOLD, :ICODPROD, :CCODLOTEOLD,
          :ICODEMPLENEW, :SCODFILIALLENEW, :CCODLOTENEW, :SOPERADOR, :NQTDMOVPRODOLD, :NQTDMOVPRODNEW,
          :ICODEMPAXOLD, :SCODFILIALAXOLD, :ICODALMOXOLD, :ICODEMPAXNEW, :SCODFILIALAXNEW, :ICODALMOXNEW);
    END
  END

  suspend;
end^


ALTER PROCEDURE EQMOVPRODCKCPSP (
    ICODEMPPD INTEGER,
    SCODFILIALPD SMALLINT,
    ICODPROD INTEGER,
    ICODCOMPRA INTEGER,
    ICODINVPROD INTEGER,
    DDTMOVPROD DATE,
    NQTDMOVPROD NUMERIC(15,5),
    NCUSTOMPMMOVPROD NUMERIC(15,5))
RETURNS (
    DDTULTCPPROD DATE,
    NQTDULTCPPROD NUMERIC(15,5),
    DDTMPMPROD DATE,
    NCUSTOMPMPROD NUMERIC(15,5))
AS
begin
  /* Procedure para checar data da última compra */
  NCUSTOMPMPROD = 0;
  if (NCUSTOMPMMOVPROD IS NULL) then
     NCUSTOMPMMOVPROD = 0;
  if ( (ICODINVPROD IS NOT NULL) OR (ICODCOMPRA IS NOT NULL) ) then
  begin
     SELECT DTULTCPPROD,QTDULTCPPROD,DTMPMPROD, CUSTOMPMPROD FROM EQPRODUTO WHERE CODPROD=:ICODPROD
          AND CODEMP=:ICODEMPPD AND CODFILIAL = :SCODFILIALPD
          INTO :DDTULTCPPROD, :NQTDULTCPPROD, :DDTMPMPROD, :NCUSTOMPMPROD;
      if (NQTDULTCPPROD IS NULL) then
         NQTDULTCPPROD = 0;
      if (NCUSTOMPMPROD IS NULL) then
         NCUSTOMPMPROD = 0;
      if ( ICODCOMPRA IS NOT NULL ) then
      begin
         if ( (DDTMOVPROD>DDTULTCPPROD) OR (DDTULTCPPROD IS NULL) ) then
         begin
             DDTULTCPPROD = DDTMOVPROD;
             NQTDULTCPPROD = NQTDMOVPROD;
         end
      end
      if ( ( ICODINVPROD IS NOT NULL) OR (ICODCOMPRA IS NOT NULL) ) then
      begin
         if ( (DDTMOVPROD>=DDTMPMPROD OR DDTMPMPROD IS NULL) AND
              (NCUSTOMPMMOVPROD>0)  ) then
         begin
            DDTMPMPROD = DDTMOVPROD;
            NCUSTOMPMPROD = NCUSTOMPMMOVPROD;
         end
      end
  end


  suspend;
end^


ALTER PROCEDURE EQMOVPRODCKTMSP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODTIPOMOV INTEGER)
RETURNS (
    CESTIPOMOV CHAR(1),
    SOPERADOR SMALLINT)
AS
DECLARE VARIABLE CESTOQTIPOMOV CHAR(1);
begin
  /* Verifique se é para contar estoque */
  SELECT TM.ESTIPOMOV, TM.ESTOQTIPOMOV FROM EQTIPOMOV TM WHERE TM.CODEMP=:ICODEMP AND
     TM.CODFILIAL = :SCODFILIAL AND TM.CODTIPOMOV = :ICODTIPOMOV
     INTO :CESTIPOMOV, :CESTOQTIPOMOV;
  SOPERADOR = 0;
  if (CESTOQTIPOMOV='S') then
  begin
     if (CESTIPOMOV='S') then
        SOPERADOR = -1;
     else
        SOPERADOR = 1;
  end
  suspend;
end^


ALTER PROCEDURE EQMOVPRODCKUTMSP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODTIPOMOV INTEGER,
    ICODEMPOLD INTEGER,
    SCODFILIALOLD SMALLINT,
    ICODTIPOMOVOLD INTEGER)
RETURNS (
    CALTTM CHAR(1))
AS
DECLARE VARIABLE CESTIPOMOV CHAR(1);
DECLARE VARIABLE CESTOQTIPOMOV CHAR(1);
DECLARE VARIABLE CESTIPOMOVOLD CHAR(1);
DECLARE VARIABLE CESTOQTIPOMOVOLD CHAR(1);
begin
  /* Verifica se há alteração no tipo de movimento para reprocessamento de estoque */
  CALTTM = 'N';
  SELECT TM.ESTIPOMOV, TM.ESTOQTIPOMOV FROM EQTIPOMOV TM
     WHERE TM.CODEMP=:ICODEMP AND TM.CODFILIAL=:SCODFILIAL
      AND TM.CODTIPOMOV=:ICODTIPOMOV
     INTO :CESTIPOMOV, :CESTOQTIPOMOV;

  SELECT TM.ESTIPOMOV, TM.ESTOQTIPOMOV FROM EQTIPOMOV TM
     WHERE TM.CODEMP=:ICODEMPOLD AND TM.CODFILIAL=:SCODFILIALOLD
      AND TM.CODTIPOMOV=:ICODTIPOMOVOLD
     INTO :CESTIPOMOVOLD, :CESTOQTIPOMOVOLD;

  if ( (CESTIPOMOV!=CESTIPOMOVOLD) OR (CESTOQTIPOMOV!=CESTOQTIPOMOVOLD) OR
       (CESTIPOMOVOLD IS NULL) OR (CESTOQTIPOMOVOLD IS NULL)  ) then
     CALTTM = 'S';
  suspend;
end^


ALTER PROCEDURE EQMOVPRODCSLDSP (
    ICODEMPTM INTEGER,
    SCODFILIALTM SMALLINT,
    ICODTIPOMOV INTEGER,
    NQTDMOVPROD NUMERIC(15,5),
    NPRECOMOVPROD NUMERIC(15,5),
    NCUSTOMPMMOVPROD NUMERIC(15,5),
    NSLDMOVPROD NUMERIC(15,5))
RETURNS (
    NCUSTOMPM NUMERIC(15,5),
    NSALDO NUMERIC(15,5),
    CESTOQMOVPROD CHAR(1),
    CTIPOMOVPROD CHAR(1),
    SOPERADOR SMALLINT)
AS
begin
  /* Procedure que retorna o cálculo de custo e saldo */
  NCUSTOMPM = 0;
  NSALDO = 0;
  SELECT CESTIPOMOV, SOPERADOR
     FROM EQMOVPRODCKTMSP( :ICODEMPTM, :SCODFILIALTM, :ICODTIPOMOV)
     INTO :CTIPOMOVPROD, :SOPERADOR;
  if (SOPERADOR=0) then
  begin
     CESTOQMOVPROD = 'N';
     NSALDO = NSLDMOVPROD;
  end
  else
  begin  /* verifica se é para controlar estoque */
     CESTOQMOVPROD = 'S';
     NSALDO = NSLDMOVPROD + CAST ( (NQTDMOVPROD * SOPERADOR) AS NUMERIC(15, 5) );
  end
  if ( (NSALDO > NSLDMOVPROD) AND (NSALDO > 0) ) then
  begin
    if ( (NSLDMOVPROD * NCUSTOMPMMOVPROD)  <= 0) then
       NCUSTOMPM = NPRECOMOVPROD;
    else
       NCUSTOMPM = ( (NSLDMOVPROD * NCUSTOMPMMOVPROD) +
           (NQTDMOVPROD * NPRECOMOVPROD) ) / NSALDO ;
  end
  else
      NCUSTOMPM = NCUSTOMPMMOVPROD;

  suspend;
end^


ALTER PROCEDURE EQMOVPRODDSP (
    ICODEMPPD INTEGER,
    SCODFILIALPD SMALLINT,
    ICODPROD INTEGER,
    ICODEMPIV INTEGER,
    SCODFILIALIV SMALLINT,
    ICODINVPROD INTEGER,
    ICODEMPCP INTEGER,
    SCODFILIALCP SMALLINT,
    ICODCOMPRA INTEGER,
    SCODITCOMPRA SMALLINT,
    ICODEMPVD INTEGER,
    SCODFILIALVD SMALLINT,
    CTIPOVENDA CHAR(1),
    ICODVENDA INTEGER,
    SCODITVENDA SMALLINT,
    ICODEMPRM INTEGER,
    SCODFILIALRM SMALLINT,
    ICODRMA INTEGER,
    SCODITRMA SMALLINT,
    ICODEMPOP INTEGER,
    SCODFILIALOP SMALLINT,
    ICODOP INTEGER,
    SSEQOP SMALLINT,
    DDTMOVPROD DATE,
    ICODEMPAX INTEGER,
    SCODFILIALAX SMALLINT,
    ICODALMOX INTEGER,
    CMULTIALMOX CHAR(1))
AS
DECLARE VARIABLE ICODEMP INTEGER;
DECLARE VARIABLE SCODFILIAL SMALLINT;
DECLARE VARIABLE ICODMOVPROD INTEGER;
DECLARE VARIABLE NSLDMOVPROD NUMERIC(15,5);
DECLARE VARIABLE NCUSTOMPMMOVPROD NUMERIC(15,5);
DECLARE VARIABLE NSLDMOVPRODAX NUMERIC(15,5);
DECLARE VARIABLE NCUSTOMPMMOVPRODAX NUMERIC(15,5);
begin
  /* Procedure de deleção da tabela eqmovprod */
  SELECT ICODEMP, SCODFILIAL, ICODMOVPROD FROM EQMOVPRODRETCODSP(:ICODEMPIV, :SCODFILIALIV, :ICODINVPROD, :ICODEMPCP,
    :SCODFILIALCP, :ICODCOMPRA, :SCODITCOMPRA, :ICODEMPVD, :SCODFILIALVD,
    :CTIPOVENDA, :ICODVENDA, :SCODITVENDA, :ICODEMPRM, :SCODFILIALRM, :ICODRMA,
    :SCODITRMA, :ICODEMPOP,  :SCODFILIALOP,  :ICODOP, :SSEQOP) INTO :ICODEMP, :SCODFILIAL, :ICODMOVPROD;

  SELECT NSALDO, NCUSTOMPM, NSALDOAX, NCUSTOMPMAX FROM EQMOVPRODSLDSP(:ICODEMP, :SCODFILIAL, :ICODMOVPROD,
   :ICODEMPPD, :SCODFILIALPD, :ICODPROD, :DDTMOVPROD, 0, 0,
   :ICODEMPAX, :SCODFILIALAX, :ICODALMOX, :CMULTIALMOX)
     INTO :NSLDMOVPROD, :NCUSTOMPMMOVPROD, :NSLDMOVPRODAX, :NCUSTOMPMMOVPRODAX  ;

  /* DELETAR EQMOVPROD */
  DELETE FROM EQMOVPROD WHERE CODEMP=:ICODEMP AND CODFILIAL=:SCODFILIAL
    AND CODMOVPROD=:ICODMOVPROD;

  /* REPROCESSAR ESTOQUE */
  SELECT NSLDPRC, NCUSTOMPMPRC, NSLDPRCAX, NCUSTOMPMPRCAX
    FROM EQMOVPRODPRCSLDSP( :SCODFILIAL, :ICODMOVPROD, :ICODEMPPD,
      :SCODFILIALPD, :ICODPROD, :DDTMOVPROD, null, :NSLDMOVPROD, :NCUSTOMPMMOVPROD,
      :NSLDMOVPRODAX, :NCUSTOMPMMOVPRODAX, :ICODEMPAX, :SCODFILIALAX, :ICODALMOX,
      :CMULTIALMOX)
    INTO :NSLDMOVPROD, :NCUSTOMPMMOVPROD, :NSLDMOVPRODAX, :NCUSTOMPMMOVPRODAX;

  /* ATUALIZA CUSTO NO CADASTRO DE PRODUTOS
   OPERADOR 1 PARA EFETUAR A ATUALIZAÇÃO SEMPRE
  EXECUTE PROCEDURE EQMOVPRODATCUSTSP( 1, :ICODEMP, :SCODFILIAL,
   :ICODMOVPROD,  :SCODFILIALPD, :ICODPROD, :DDTMOVPROD, 0);
   */

  suspend;
end^


ALTER PROCEDURE EQMOVPRODISP (
    ICODEMPPD INTEGER,
    SCODFILIALPD SMALLINT,
    ICODPROD INTEGER,
    ICODEMPLE INTEGER,
    SCODFILIALLE SMALLINT,
    CCODLOTE VARCHAR(20),
    ICODEMPTM INTEGER,
    SCODFILIALTM SMALLINT,
    ICODTIPOMOV INTEGER,
    ICODEMPIV INTEGER,
    SCODFILIALIV SMALLINT,
    ICODINVPROD INTEGER,
    ICODEMPCP INTEGER,
    SCODFILIALCP SMALLINT,
    ICODCOMPRA INTEGER,
    SCODITCOMPRA SMALLINT,
    ICODEMPVD INTEGER,
    SCODFILIALVD SMALLINT,
    CTIPOVENDA CHAR(1),
    ICODVENDA INTEGER,
    SCODITVENDA SMALLINT,
    ICODEMPRM INTEGER,
    SCODFILIALRM SMALLINT,
    ICODRMA INTEGER,
    SCODITRMA SMALLINT,
    ICODEMPOP INTEGER,
    SCODFILIALOP SMALLINT,
    ICODOP INTEGER,
    SSEQOP SMALLINT,
    ICODEMPNT INTEGER,
    SCODFILIALNT SMALLINT,
    CCODNAT CHAR(4),
    DDTMOVPROD DATE,
    IDOCMOVPROD INTEGER,
    CFLAG CHAR(1),
    NQTDMOVPROD NUMERIC(15,5),
    NPRECOMOVPROD NUMERIC(15,5),
    ICODEMPAX INTEGER,
    SCODFILIALAX SMALLINT,
    ICODALMOX INTEGER,
    CMULTIALMOX CHAR(1))
AS
DECLARE VARIABLE SCODFILIAL SMALLINT;
DECLARE VARIABLE ICODMOVPROD INTEGER;
DECLARE VARIABLE CESTOQMOVPROD CHAR(1);
DECLARE VARIABLE CTIPOMOVPROD CHAR(1);
DECLARE VARIABLE NSLDMOVPROD NUMERIC(15,5);
DECLARE VARIABLE NCUSTOMPMMOVPROD NUMERIC(15,5);
DECLARE VARIABLE SOPERADOR SMALLINT;
DECLARE VARIABLE NSLDMOVPRODAX NUMERIC(15,5);
DECLARE VARIABLE NCUSTOMPMMOVPRODAX NUMERIC(15,5);
begin
  /* Procedure de inserção na tabela eqmovprod */

  SELECT NSALDO, NCUSTOMPM, NSALDOAX, NCUSTOMPMAX FROM EQMOVPRODSLDSP(null, null, null, :ICODEMPPD,
     :SCODFILIALPD, :ICODPROD, :DDTMOVPROD, :NPRECOMOVPROD, :NPRECOMOVPROD,
     :ICODEMPAX, :SCODFILIALAX, :ICODALMOX, :CMULTIALMOX )
     INTO :NSLDMOVPROD, :NCUSTOMPMMOVPROD, :NSLDMOVPRODAX, :NCUSTOMPMMOVPRODAX ;

  /* Verifica se haverá mudança de saldo*/
  SELECT NSALDO, NCUSTOMPM, CESTOQMOVPROD, CTIPOMOVPROD, SOPERADOR FROM EQMOVPRODCSLDSP(:ICODEMPTM, :SCODFILIALTM,
      :ICODTIPOMOV, :NQTDMOVPROD, :NPRECOMOVPROD, :NCUSTOMPMMOVPROD, :NSLDMOVPROD)
      INTO :NSLDMOVPROD, :NCUSTOMPMMOVPROD, :CESTOQMOVPROD, :CTIPOMOVPROD, :SOPERADOR;

  if (CMULTIALMOX='N') then
  begin
     NSLDMOVPRODAX = NSLDMOVPROD;
     NCUSTOMPMMOVPRODAX = NCUSTOMPMMOVPROD;
  end
  else
  begin
      SELECT NSALDO, NCUSTOMPM FROM EQMOVPRODCSLDSP(:ICODEMPTM, :SCODFILIALTM,
          :ICODTIPOMOV, :NQTDMOVPROD, :NPRECOMOVPROD, :NCUSTOMPMMOVPRODAX, :NSLDMOVPRODAX)
        INTO :NSLDMOVPRODAX, :NCUSTOMPMMOVPRODAX;
  end

  SELECT SCODFILIAL, ICODMOVPROD FROM EQMOVPRODSEQSP(:ICODEMPPD)
     INTO :SCODFILIAL, :ICODMOVPROD;  /* encontra o próximo código e a filial*/

   INSERT INTO EQMOVPROD ( CODEMP, CODFILIAL, CODMOVPROD,
      CODEMPPD, CODFILIALPD , CODPROD , CODEMPLE ,
      CODFILIALLE , CODLOTE , CODEMPTM, CODFILIALTM,
      CODTIPOMOV, CODEMPIV , CODFILIALIV , CODINVPROD ,
      CODEMPCP , CODFILIALCP , CODCOMPRA , CODITCOMPRA , CODEMPVD ,
      CODFILIALVD , TIPOVENDA , CODVENDA , CODITVENDA , CODEMPRM ,
      CODFILIALRM , CODRMA , CODITRMA ,
      CODEMPOP, CODFILIALOP, CODOP, SEQOP,
      CODEMPNT , CODFILIALNT ,
      CODNAT , DTMOVPROD , DOCMOVPROD , FLAG , QTDMOVPROD ,
      PRECOMOVPROD, ESTOQMOVPROD, TIPOMOVPROD, SLDMOVPROD, CUSTOMPMMOVPROD,
      SLDMOVPRODAX, CUSTOMPMMOVPRODAX, CODEMPAX, CODFILIALAX, CODALMOX )
   VALUES ( :ICODEMPPD, :SCODFILIAL, :ICODMOVPROD,
    :ICODEMPPD , :SCODFILIALPD , :ICODPROD , :ICODEMPLE ,
    :SCODFILIALLE , :CCODLOTE , :ICODEMPTM, :SCODFILIALTM,
    :ICODTIPOMOV, :ICODEMPIV , :SCODFILIALIV ,
    :ICODINVPROD , :ICODEMPCP , :SCODFILIALCP , :ICODCOMPRA ,
    :SCODITCOMPRA , :ICODEMPVD , :SCODFILIALVD , :CTIPOVENDA ,
    :ICODVENDA , :SCODITVENDA , :ICODEMPRM , :SCODFILIALRM ,
    :ICODRMA , :SCODITRMA , :ICODEMPOP, :SCODFILIALOP, :ICODOP, :SSEQOP,
    :ICODEMPNT , :SCODFILIALNT , :CCODNAT ,
    :DDTMOVPROD , :IDOCMOVPROD , :CFLAG , :NQTDMOVPROD ,
    :NPRECOMOVPROD, :CESTOQMOVPROD, :CTIPOMOVPROD, :NSLDMOVPROD, :NCUSTOMPMMOVPROD,
    :NSLDMOVPRODAX,  :NCUSTOMPMMOVPRODAX, :ICODEMPAX, :SCODFILIALAX, :ICODALMOX );

  /* REPROCESSAR ESTOQUE */

  SELECT NSLDPRC, NCUSTOMPMPRC, NSLDPRCAX, NCUSTOMPMPRCAX
    FROM EQMOVPRODPRCSLDSP( :SCODFILIAL, :ICODMOVPROD, :ICODEMPPD,
     :SCODFILIALPD, :ICODPROD, :DDTMOVPROD, null, :NSLDMOVPROD, :NCUSTOMPMMOVPROD,
     :NSLDMOVPRODAX, :NCUSTOMPMMOVPRODAX, :ICODEMPAX, :SCODFILIALAX, :ICODALMOX,
     :CMULTIALMOX)
    INTO :NSLDMOVPROD, :NCUSTOMPMMOVPROD, :NSLDMOVPRODAX, :NCUSTOMPMMOVPRODAX ;

 /* ATUALIZA O CUSTO NO CADASTRO DE PRODUTOS
   EXECUTE PROCEDURE EQMOVPRODATCUSTSP(:SOPERADOR, :ICODEMPPD, :SCODFILIAL,
    :ICODMOVPROD, :SCODFILIALPD, :ICODPROD, :DDTMOVPROD, :NCUSTOMPMMOVPROD); 
 */


  suspend;
end^


ALTER PROCEDURE EQMOVPRODIUDSP (
    CIUD CHAR(1),
    ICODEMPPD INTEGER,
    SCODFILIALPD SMALLINT,
    ICODPROD INTEGER,
    ICODEMPLE INTEGER,
    SCODFILIALLE SMALLINT,
    CCODLOTE VARCHAR(20),
    ICODEMPTM INTEGER,
    SCODFILIALTM SMALLINT,
    ICODTIPOMOV INTEGER,
    ICODEMPIV INTEGER,
    SCODFILIALIV SMALLINT,
    ICODINVPROD INTEGER,
    ICODEMPCP INTEGER,
    SCODFILIALCP SMALLINT,
    ICODCOMPRA INTEGER,
    SCODITCOMPRA SMALLINT,
    ICODEMPVD INTEGER,
    SCODFILIALVD SMALLINT,
    CTIPOVENDA CHAR(1),
    ICODVENDA INTEGER,
    SCODITVENDA SMALLINT,
    ICODEMPRM INTEGER,
    SCODFILIALRM SMALLINT,
    ICODRMA INTEGER,
    SCODITRMA SMALLINT,
    ICODEMPOP INTEGER,
    SCODFILIALOP SMALLINT,
    ICODOP INTEGER,
    SSEQOP SMALLINT,
    ICODEMPNT INTEGER,
    SCODFILIALNT SMALLINT,
    CCODNAT CHAR(4),
    DDTMOVPROD DATE,
    IDOCMOVPROD INTEGER,
    CFLAG CHAR(1),
    NQTDMOVPROD NUMERIC(15,5),
    NPRECOMOVPROD NUMERIC(15,5),
    ICODEMPAX INTEGER,
    SCODFILIALAX SMALLINT,
    ICODALMOX INTEGER)
AS
DECLARE VARIABLE CMULTIALMOX CHAR(1);
begin
  /* Procedure que controle INSERT, UPDATE E DELETE da tabela eqmovprod */

  /* Linha incluida para passar como parâmetro se é multi almoxarifado
      Como o objetivo de evitar I/O
  */
  SELECT CMULTIALMOX FROM SGRETMULTIALMOXSP(:ICODEMPPD) INTO :CMULTIALMOX;

  if (CIUD='I') then /* SE FOR INSERT */
     execute procedure EQMOVPRODISP( ICODEMPPD, SCODFILIALPD, ICODPROD,
         ICODEMPLE, SCODFILIALLE, CCODLOTE, ICODEMPTM, SCODFILIALTM, ICODTIPOMOV,
         ICODEMPIV, SCODFILIALIV, ICODINVPROD, ICODEMPCP, SCODFILIALCP, ICODCOMPRA,
         SCODITCOMPRA, ICODEMPVD, SCODFILIALVD, CTIPOVENDA, ICODVENDA, SCODITVENDA,
         ICODEMPRM, SCODFILIALRM, ICODRMA, SCODITRMA,
         ICODEMPOP, SCODFILIALOP, ICODOP, SSEQOP,
         ICODEMPNT, SCODFILIALNT,
         CCODNAT, DDTMOVPROD, IDOCMOVPROD, CFLAG, NQTDMOVPROD, NPRECOMOVPROD,
         ICODEMPAX, SCODFILIALAX, ICODALMOX, CMULTIALMOX);
  else if (CIUD='U') then
     execute procedure EQMOVPRODUSP( ICODEMPPD, SCODFILIALPD, ICODPROD,
         ICODEMPLE, SCODFILIALLE, CCODLOTE, ICODEMPTM, SCODFILIALTM, ICODTIPOMOV,
         ICODEMPIV, SCODFILIALIV, ICODINVPROD, ICODEMPCP, SCODFILIALCP, ICODCOMPRA,
         SCODITCOMPRA, ICODEMPVD, SCODFILIALVD, CTIPOVENDA, ICODVENDA, SCODITVENDA,
         ICODEMPRM, SCODFILIALRM, ICODRMA, SCODITRMA,
         ICODEMPOP, SCODFILIALOP, ICODOP, SSEQOP,
         ICODEMPNT, SCODFILIALNT,
         CCODNAT, DDTMOVPROD, IDOCMOVPROD, CFLAG, NQTDMOVPROD, NPRECOMOVPROD,
         ICODEMPAX, SCODFILIALAX, ICODALMOX, CMULTIALMOX);
  else if (CIUD='D') then
     execute procedure EQMOVPRODDSP( ICODEMPPD, SCODFILIALPD, ICODPROD, ICODEMPIV,
         SCODFILIALIV, ICODINVPROD, ICODEMPCP, SCODFILIALCP, ICODCOMPRA, SCODITCOMPRA,
         ICODEMPVD, SCODFILIALVD, CTIPOVENDA, ICODVENDA, SCODITVENDA,
         ICODEMPRM, SCODFILIALRM, ICODRMA, SCODITRMA,
         ICODEMPOP, SCODFILIALOP, ICODOP, SSEQOP,
         DDTMOVPROD, ICODEMPAX, SCODFILIALAX, ICODALMOX, CMULTIALMOX );
  suspend;
end^


ALTER PROCEDURE EQMOVPRODPRCSLDSP (
    SCODFILIAL SMALLINT,
    ICODMOVPROD INTEGER,
    ICODEMPPD INTEGER,
    SCODFILIALPD SMALLINT,
    ICODPROD INTEGER,
    DDTMOVPROD DATE,
    DDTMOVPRODPRC DATE,
    NSLDMOVPROD NUMERIC(15,5),
    NCUSTOMPMMOVPROD NUMERIC(15,5),
    NSLDMOVPRODAX NUMERIC(15,5),
    NCUSTOMPMMOVPRODAX NUMERIC(15,5),
    ICODEMPAX INTEGER,
    SCODFILIALAX SMALLINT,
    ICODALMOX INTEGER,
    CMULTIALMOX CHAR(1))
RETURNS (
    NSLDPRC NUMERIC(15,5),
    NCUSTOMPMPRC NUMERIC(15,5),
    NSLDPRCAX NUMERIC(15,5),
    NCUSTOMPMPRCAX NUMERIC(15,5))
AS
DECLARE VARIABLE ICODEMPTM INTEGER;
DECLARE VARIABLE SCODFILIALTM SMALLINT;
DECLARE VARIABLE ICODTIPOMOV INTEGER;
DECLARE VARIABLE NQTDMOVPROD NUMERIC(15,5);
DECLARE VARIABLE NPRECOMOVPROD NUMERIC(15,5);
DECLARE VARIABLE ICODMOVPRODPRC INTEGER;
DECLARE VARIABLE CESTOQMOVPROD CHAR(1);
DECLARE VARIABLE ICODEMPAXPRC INTEGER;
DECLARE VARIABLE SCODFILIALAXPRC SMALLINT;
DECLARE VARIABLE ICODALMOXPRC INTEGER;
begin
  /* Procedure de processamento de estoque */
  FOR SELECT MP.CODEMPTM, MP.CODFILIALTM, MP.CODTIPOMOV ,
    MP.QTDMOVPROD, MP.PRECOMOVPROD , MP.CODMOVPROD,
    MP.CODEMPAX, MP.CODFILIALAX, MP.CODALMOX
    FROM EQMOVPROD MP
    WHERE MP.CODEMPPD=:ICODEMPPD AND MP.CODFILIALPD=:SCODFILIALPD AND
       MP.CODPROD=:ICODPROD AND MP.CODEMP=:ICODEMPPD AND MP.CODFILIAL=:SCODFILIAL AND
       ( (MP.DTMOVPROD = :DDTMOVPROD AND MP.CODMOVPROD > :ICODMOVPROD) OR
         (MP.DTMOVPROD>:DDTMOVPROD) ) AND  /* ALTEREI AQUI */
       ( (:DDTMOVPRODPRC IS NULL /* AND MP.CODMOVPROD!=:ICODMOVPROD */) OR
         (MP.DTMOVPROD = :DDTMOVPRODPRC AND MP.CODMOVPROD < :ICODMOVPROD) OR
         (MP.DTMOVPROD < :DDTMOVPRODPRC) )
    ORDER BY MP.DTMOVPROD, MP.CODMOVPROD
    INTO :ICODEMPTM, :SCODFILIALTM, :ICODTIPOMOV,
     :NQTDMOVPROD, :NPRECOMOVPROD, :ICODMOVPRODPRC,
     :ICODEMPAXPRC, :SCODFILIALAXPRC, :ICODALMOXPRC DO
  BEGIN
      SELECT NSALDO, NCUSTOMPM, CESTOQMOVPROD FROM EQMOVPRODCSLDSP(:ICODEMPTM, :SCODFILIALTM,
        :ICODTIPOMOV, :NQTDMOVPROD, :NPRECOMOVPROD, :NCUSTOMPMMOVPROD, :NSLDMOVPROD)
      INTO :NSLDMOVPROD, :NCUSTOMPMMOVPROD, :CESTOQMOVPROD;
      if (CMULTIALMOX='N') then /* Se não for multi almoxarifado*/
      begin
         NSLDMOVPRODAX = NSLDMOVPROD;
         NCUSTOMPMMOVPRODAX = NCUSTOMPMMOVPROD;
         UPDATE EQMOVPROD SET SLDMOVPROD=:NSLDMOVPROD, CUSTOMPMMOVPROD=:NCUSTOMPMMOVPROD,
            SLDMOVPRODAX=:NSLDMOVPRODAX, CUSTOMPMMOVPRODAX=:NCUSTOMPMMOVPRODAX,
            ESTOQMOVPROD=:CESTOQMOVPROD
            WHERE CODEMP=:ICODEMPPD AND CODFILIAL=:SCODFILIAL AND CODMOVPROD=:ICODMOVPRODPRC;
      end
      else if (ICODEMPAX=ICODEMPAXPRC AND SCODFILIALAX=SCODFILIALAXPRC AND
          ICODALMOX=ICODALMOXPRC) then
          /* Se for multi almoxarifado e o código do almoxarifado for o mesmo*/
      begin
        SELECT NSALDO, NCUSTOMPM FROM EQMOVPRODCSLDSP(:ICODEMPTM, :SCODFILIALTM,
            :ICODTIPOMOV, :NQTDMOVPROD, :NPRECOMOVPROD, :NCUSTOMPMMOVPRODAX, :NSLDMOVPRODAX)
            INTO :NSLDMOVPRODAX, :NCUSTOMPMMOVPRODAX;
        UPDATE EQMOVPROD SET SLDMOVPROD=:NSLDMOVPROD, CUSTOMPMMOVPROD=:NCUSTOMPMMOVPROD,
            SLDMOVPRODAX=:NSLDMOVPRODAX, CUSTOMPMMOVPRODAX=:NCUSTOMPMMOVPRODAX,
            ESTOQMOVPROD=:CESTOQMOVPROD
            WHERE CODEMP=:ICODEMPPD AND CODFILIAL=:SCODFILIAL AND CODMOVPROD=:ICODMOVPRODPRC;
      end
      else /* Se for multi almoxarifado não atualiza almoxarifado diferente */
      begin
        UPDATE EQMOVPROD SET SLDMOVPROD=:NSLDMOVPROD, CUSTOMPMMOVPROD=:NCUSTOMPMMOVPROD,
            ESTOQMOVPROD=:CESTOQMOVPROD
            WHERE CODEMP=:ICODEMPPD AND CODFILIAL=:SCODFILIAL AND CODMOVPROD=:ICODMOVPRODPRC;
      end
      NSLDPRC = NSLDMOVPROD;
      NCUSTOMPMPRC = NCUSTOMPMMOVPROD;
      NSLDPRCAX = NSLDMOVPRODAX;
      NCUSTOMPMPRCAX = NCUSTOMPMMOVPRODAX;
  END
  suspend;
end^


ALTER PROCEDURE EQMOVPRODRETCODSP (
    ICODEMPIV INTEGER,
    SCODFILIALIV SMALLINT,
    ICODINVPROD INTEGER,
    ICODEMPCP INTEGER,
    SCODFILIALCP SMALLINT,
    ICODCOMPRA INTEGER,
    SCODITCOMPRA SMALLINT,
    ICODEMPVD INTEGER,
    SCODFILIALVD SMALLINT,
    CTIPOVENDA CHAR(1),
    ICODVENDA INTEGER,
    SCODITVENDA SMALLINT,
    ICODEMPRM INTEGER,
    SCODFILIALRM SMALLINT,
    ICODRMA INTEGER,
    SCODITRMA SMALLINT,
    ICODEMPOP INTEGER,
    SCODFILIALOP SMALLINT,
    ICODOP INTEGER,
    SSEQOP SMALLINT)
RETURNS (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODMOVPROD INTEGER)
AS
begin
  /* Retorna o código do movimento de estoque */
  if (ICODINVPROD IS NOT NULL) then
     SELECT MP.CODEMP, MP.CODFILIAL, MP.CODMOVPROD FROM EQMOVPROD MP
       WHERE MP.CODEMPIV=:ICODEMPIV AND MP.CODFILIALIV=:SCODFILIALIV
         AND MP.CODINVPROD=:ICODINVPROD
       INTO  :ICODEMP, :SCODFILIAL, :ICODMOVPROD;
  else if (ICODCOMPRA IS NOT NULL) then
     SELECT MP.CODEMP, MP.CODFILIAL, MP.CODMOVPROD FROM EQMOVPROD MP
       WHERE MP.CODEMPCP=:ICODEMPCP AND MP.CODFILIALCP=:SCODFILIALCP
         AND MP.CODCOMPRA=:ICODCOMPRA AND MP.CODITCOMPRA=:SCODITCOMPRA
       INTO  :ICODEMP, :SCODFILIAL, :ICODMOVPROD;
  else if (ICODVENDA IS NOT NULL) then
     SELECT MP.CODEMP, MP.CODFILIAL, MP.CODMOVPROD FROM EQMOVPROD MP
       WHERE MP.CODEMPVD=:ICODEMPVD AND MP.CODFILIALVD=:SCODFILIALVD
         AND MP.TIPOVENDA=:CTIPOVENDA AND MP.CODVENDA=:ICODVENDA
         AND MP.CODITVENDA=:SCODITVENDA
       INTO  :ICODEMP, :SCODFILIAL, :ICODMOVPROD;
  else if (ICODRMA IS NOT NULL) then
     SELECT MP.CODEMP, MP.CODFILIAL, MP.CODMOVPROD FROM EQMOVPROD MP
       WHERE MP.CODEMPRM=:ICODEMPRM AND MP.CODFILIALRM=:SCODFILIALRM
         AND MP.CODRMA=:ICODRMA AND MP.CODITRMA=:SCODITRMA
       INTO  :ICODEMP, :SCODFILIAL, :ICODMOVPROD;
  else if (ICODOP IS NOT NULL) then
     SELECT MP.CODEMP, MP.CODFILIAL, MP.CODMOVPROD FROM EQMOVPROD MP
       WHERE MP.CODEMPOP=:ICODEMPOP AND MP.CODFILIALOP=:SCODFILIALOP
         AND MP.CODOP=:ICODOP AND MP.SEQOP=:SSEQOP
       INTO  :ICODEMP, :SCODFILIAL, :ICODMOVPROD;



  suspend;
end^


ALTER PROCEDURE EQMOVPRODSEQSP (
    ICODEMP INTEGER)
RETURNS (
    SCODFILIAL SMALLINT,
    ICODMOVPROD INTEGER)
AS
begin
  /* Busca o código sequencial da tabela eqmovprod */
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP, 'EQMOVPROD') INTO :SCODFILIAL ;
  SELECT ISEQ FROM SPGERANUM(:ICODEMP, :SCODFILIAL, 'MP' ) INTO :ICODMOVPROD ;
  suspend;
end^


ALTER PROCEDURE EQMOVPRODSLDSP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODMOVPROD INTEGER,
    ICODEMPPD INTEGER,
    SCODFILIALPD SMALLINT,
    ICODPROD INTEGER,
    DDTMOVPROD DATE,
    NCUSTOMPMMOVPROD NUMERIC(15,5),
    NCUSTOMPMMOVPRODAX NUMERIC(15,5),
    ICODEMPAX INTEGER,
    SCODFILIALAX SMALLINT,
    ICODALMOX INTEGER,
    CMULTIALMOX CHAR(1))
RETURNS (
    NSALDO NUMERIC(15,5),
    NCUSTOMPM NUMERIC(15,5),
    ICODMOVPRODSLD INTEGER,
    NSALDOAX NUMERIC(15,5),
    NCUSTOMPMAX NUMERIC(15,5),
    ICODMOVPRODSLDAX INTEGER)
AS
begin
  /* Procedure que busca saldo e custo médio */
  NSALDO = 0;
  NCUSTOMPM = 0;
  if (NCUSTOMPMMOVPROD IS NULL) then
     NCUSTOMPMMOVPROD = 0;
  if (ICODMOVPROD IS NULL) then
     SELECT FIRST 1 M.SLDMOVPROD, M.CUSTOMPMMOVPROD, M.CODMOVPROD
        FROM EQMOVPROD M
        WHERE M.CODEMPPD = :ICODEMPPD AND
          M.CODFILIALPD = :SCODFILIALPD AND
          M.CODPROD = :ICODPROD AND
          M.DTMOVPROD <= :DDTMOVPROD
        ORDER BY M.DTMOVPROD DESC, M.CODMOVPROD DESC
        INTO :NSALDO, :NCUSTOMPM, :ICODMOVPRODSLD;
   else
     SELECT FIRST 1 M.SLDMOVPROD, M.CUSTOMPMMOVPROD, M.CODMOVPROD
        FROM EQMOVPROD M
        WHERE M.CODEMP = :ICODEMP AND
          M.CODFILIAL = :SCODFILIAL AND
          M.CODEMPPD = :ICODEMPPD AND
          M.CODFILIALPD = :SCODFILIALPD AND
          M.CODPROD = :ICODPROD AND
          ( (M.DTMOVPROD = :DDTMOVPROD AND M.CODMOVPROD < :ICODMOVPROD ) OR
            (M.DTMOVPROD < :DDTMOVPROD ) )
        ORDER BY M.DTMOVPROD DESC, M.CODMOVPROD DESC
        INTO :NSALDO, :NCUSTOMPM, :ICODMOVPRODSLD;
  if (NSALDO IS NULL) then
     NSALDO = 0;
  if (NCUSTOMPM IS NULL) then
     NCUSTOMPM = NCUSTOMPMMOVPROD;

  if (CMULTIALMOX='N') then
  begin
      NSALDOAX = NSALDO;
      NCUSTOMPMAX = NCUSTOMPM;
      ICODMOVPRODSLDAX = ICODMOVPRODSLD;
  end
  else
  begin
      NSALDOAX = 0;
      NCUSTOMPMAX = 0;
      if (NCUSTOMPMMOVPRODAX IS NULL) then
         NCUSTOMPMMOVPRODAX = 0;
      if (ICODMOVPROD IS NULL) then
         SELECT FIRST 1 M.SLDMOVPRODAX, M.CUSTOMPMMOVPROD, M.CODMOVPROD
            FROM EQMOVPROD M
            WHERE M.CODEMPPD = :ICODEMPPD AND
              M.CODFILIALPD = :SCODFILIALPD AND
              M.CODPROD = :ICODPROD AND
              M.DTMOVPROD <= :DDTMOVPROD AND
              M.CODEMPAX = :ICODEMPAX AND
              M.CODFILIALAX = :SCODFILIALAX AND
              M.CODALMOX= :ICODALMOX
            ORDER BY M.DTMOVPROD DESC, M.CODMOVPROD DESC
            INTO :NSALDOAX, :NCUSTOMPMAX, :ICODMOVPRODSLDAX;
       else
         SELECT FIRST 1 M.SLDMOVPRODAX, M.CUSTOMPMMOVPROD, M.CODMOVPROD
            FROM EQMOVPROD M
            WHERE M.CODEMP = :ICODEMP AND
              M.CODFILIAL = :SCODFILIAL AND
              M.CODEMPPD = :ICODEMPPD AND
              M.CODFILIALPD = :SCODFILIALPD AND
              M.CODPROD = :ICODPROD AND
              M.CODEMPAX = :ICODEMPAX AND
              M.CODFILIALAX = :SCODFILIALAX AND
              M.CODALMOX = :ICODALMOX AND
              ( (M.DTMOVPROD = :DDTMOVPROD AND M.CODMOVPROD < :ICODMOVPROD ) OR
                (M.DTMOVPROD < :DDTMOVPROD ) )
            ORDER BY M.DTMOVPROD DESC, M.CODMOVPROD DESC
            INTO :NSALDOAX, :NCUSTOMPMAX, :ICODMOVPRODSLDAX;
      if (NSALDOAX IS NULL) then
         NSALDOAX = 0;
      if (NCUSTOMPMAX IS NULL) then
         NCUSTOMPMAX = NCUSTOMPMMOVPROD;
  end
  suspend;
end^


ALTER PROCEDURE EQMOVPRODUSP (
    ICODEMPPD INTEGER,
    SCODFILIALPD SMALLINT,
    ICODPROD INTEGER,
    ICODEMPLE INTEGER,
    SCODFILIALLE SMALLINT,
    CCODLOTE VARCHAR(20),
    ICODEMPTM INTEGER,
    SCODFILIALTM SMALLINT,
    ICODTIPOMOV INTEGER,
    ICODEMPIV INTEGER,
    SCODFILIALIV SMALLINT,
    ICODINVPROD INTEGER,
    ICODEMPCP INTEGER,
    SCODFILIALCP SMALLINT,
    ICODCOMPRA INTEGER,
    SCODITCOMPRA SMALLINT,
    ICODEMPVD INTEGER,
    SCODFILIALVD SMALLINT,
    CTIPOVENDA CHAR(1),
    ICODVENDA INTEGER,
    SCODITVENDA SMALLINT,
    ICODEMPRM INTEGER,
    SCODFILIALRM SMALLINT,
    ICODRMA INTEGER,
    SCODITRMA SMALLINT,
    ICODEMPOP INTEGER,
    SCODFILIALOP SMALLINT,
    ICODOP INTEGER,
    SSEQOP SMALLINT,
    ICODEMPNT INTEGER,
    SCODFILIALNT SMALLINT,
    CCODNAT CHAR(4),
    DDTMOVPROD DATE,
    IDOCMOVPROD INTEGER,
    CFLAG CHAR(1),
    NQTDMOVPROD NUMERIC(15,5),
    NPRECOMOVPROD NUMERIC(15,5),
    ICODEMPAX INTEGER,
    SCODFILIALAX SMALLINT,
    ICODALMOX INTEGER,
    CMULTIALMOX CHAR(1))
AS
DECLARE VARIABLE ICODEMP INTEGER;
DECLARE VARIABLE SCODFILIAL SMALLINT;
DECLARE VARIABLE ICODMOVPROD INTEGER;
DECLARE VARIABLE NSLDPRC NUMERIC(15,5);
DECLARE VARIABLE NCUSTOMPMPRC NUMERIC(15,5);
DECLARE VARIABLE NSLDPRCAX NUMERIC(15,5);
DECLARE VARIABLE NCUSTOMPMPRCAX NUMERIC(15,5);
DECLARE VARIABLE NSLDLC NUMERIC(15,5);
DECLARE VARIABLE NCUSTOMPMLC NUMERIC(15,5);
DECLARE VARIABLE NSLDLCAX NUMERIC(15,5);
DECLARE VARIABLE NCUSTOMPMLCAX NUMERIC(15,5);
DECLARE VARIABLE DDTMOVPRODOLD DATE;
DECLARE VARIABLE NPRECOMOVPRODOLD NUMERIC(15,5);
DECLARE VARIABLE NQTDMOVPRODOLD NUMERIC(15,5);
DECLARE VARIABLE ICODEMPTMOLD INTEGER;
DECLARE VARIABLE SCODFILIALTMOLD SMALLINT;
DECLARE VARIABLE ICODTIPOMOVOLD INTEGER;
DECLARE VARIABLE CALTTM CHAR(1);
DECLARE VARIABLE DDTPRC DATE;
DECLARE VARIABLE DDTPRCATE DATE;
DECLARE VARIABLE CESTOQMOVPROD CHAR(1);
DECLARE VARIABLE SOPERADOR SMALLINT;
begin
  /* Procedure de atualização da tabela eqmovprod */

  DDTPRCATE = NULL; /* Até onde deve ser processando o estoque */

  SOPERADOR = 0; /* Põe o status do operador em modo zero */

 /* localiza movprod */

  SELECT ICODEMP, SCODFILIAL, ICODMOVPROD
    FROM EQMOVPRODRETCODSP(:ICODEMPIV, :SCODFILIALIV, :ICODINVPROD, :ICODEMPCP,
      :SCODFILIALCP, :ICODCOMPRA, :SCODITCOMPRA, :ICODEMPVD, :SCODFILIALVD,
      :CTIPOVENDA, :ICODVENDA, :SCODITVENDA, :ICODEMPRM, :SCODFILIALRM,
      :ICODRMA, :SCODITRMA, :ICODEMPOP, :SCODFILIALOP, :ICODOP, :SSEQOP)
    INTO :ICODEMP, :SCODFILIAL, :ICODMOVPROD;

/*  CTEMP = printlog('movprod atual: '||cast(:Icodmovprod as char(10))); */
/*  traz valores antigos
*/
  SELECT MP.CODEMPTM, MP.CODFILIALTM, MP.CODTIPOMOV, MP.DTMOVPROD,
       MP.PRECOMOVPROD, MP.QTDMOVPROD  FROM EQMOVPROD MP
     WHERE MP.CODEMP=:ICODEMP AND MP.CODFILIAL=:SCODFILIAL AND MP.CODMOVPROD=:ICODMOVPROD
     INTO :ICODEMPTMOLD, :SCODFILIALTMOLD, :ICODTIPOMOVOLD, :DDTMOVPRODOLD,
       :NPRECOMOVPRODOLD, :NQTDMOVPRODOLD;

   /* abaixo verificação se a alteração de tipo de movimento mexe no estoque */
   SELECT CALTTM FROM EQMOVPRODCKUTMSP(:ICODEMPTM, :SCODFILIALTM, :ICODTIPOMOV,
      :ICODEMPTMOLD, :SCODFILIALTMOLD, :ICODTIPOMOVOLD) INTO :CALTTM;

/*  CTEMP = printlog('DDTMOVPROD: '||cast(:DDTMOVPROD as char(10))); */
/*   CTEMP = printlog('DDTMOVPRODOLD: '||cast(:DDTMOVPRODOLD as char(10))); */



   /* verifica se há relevância para reprocessamento */
   if ( (DDTMOVPROD!=DDTMOVPRODOLD) OR (CALTTM='S') OR
        (NPRECOMOVPROD!=NPRECOMOVPRODOLD) OR (NQTDMOVPROD!=NQTDMOVPRODOLD) ) then
   begin
      if ( DDTMOVPRODOLD IS NULL) then
         DDTMOVPRODOLD = DDTMOVPROD; /* garantir que a data antiga não e nula; */
      /* verifica qual data é menor para reprocessamento */
      if ( DDTMOVPROD<=DDTMOVPRODOLD ) then
      begin
          DDTPRC = DDTMOVPROD;
          if (DDTMOVPROD=DDTMOVPRODOLD) then
             DDTPRCATE = null;
          else
             DDTPRCATE = DDTMOVPRODOLD;

          /* CTEMP = printlog('ESTA ENTRANDO AQUI. DDTPRC: '||cast(:DDTPRC as char(10))); */
/*          verifica lançamento anterior e traz custo e saldo */
          SELECT NSALDO, NCUSTOMPM, NSALDOAX, NCUSTOMPMAX
             FROM EQMOVPRODSLDSP(:ICODEMP, :SCODFILIAL, :ICODMOVPROD, :ICODEMPPD,
             :SCODFILIALPD, :ICODPROD, :DDTPRC, :NPRECOMOVPROD, :NPRECOMOVPROD,
             :ICODEMPAX, :SCODFILIALAX, :ICODALMOX, :CMULTIALMOX)
             INTO :NSLDPRC, :NCUSTOMPMPRC, :NSLDPRCAX, :NCUSTOMPMPRCAX ;

         /* CTEMP = printlog('LANCAMENTO ANTERIOR SALDO E CUSTO: '||cast(:NSLDPRC as char(15))||':'||cast(:NPRECOMOVPROD as char(15))); */

          /* verifica se havera mudança de saldo */
          SELECT NSALDO, NCUSTOMPM, CESTOQMOVPROD, SOPERADOR
              FROM EQMOVPRODCSLDSP(:ICODEMPTM, :SCODFILIALTM,
              :ICODTIPOMOV, :NQTDMOVPROD, :NPRECOMOVPROD, :NCUSTOMPMPRC, :NSLDPRC)
              INTO :NSLDPRC, :NCUSTOMPMPRC, :CESTOQMOVPROD, :SOPERADOR;
          if (CMULTIALMOX='N') then
          begin
              NSLDPRCAX = NSLDPRC;
              NCUSTOMPMPRCAX = NCUSTOMPMPRC;
          end
          else
          begin
          SELECT NSALDO, NCUSTOMPM
              FROM EQMOVPRODCSLDSP(:ICODEMPTM, :SCODFILIALTM,
              :ICODTIPOMOV, :NQTDMOVPROD, :NPRECOMOVPROD, :NCUSTOMPMPRCAX, :NSLDPRCAX)
              INTO :NSLDPRCAX, :NCUSTOMPMPRCAX;
          end
          NCUSTOMPMLC = NCUSTOMPMPRC;
          NSLDLC = NSLDPRC;
          NCUSTOMPMLCAX = NCUSTOMPMPRCAX;
          NSLDLCAX = NSLDPRCAX;
      end
      else
      begin
          /* CTEMP = printlog('O OLD É MENOR'); */

          DDTPRC = DDTMOVPRODOLD;
          DDTPRCATE = DDTMOVPROD;
          /* verifica lançamento anterior e traz custo e saldo */
          SELECT NSALDO, NCUSTOMPM, NSALDOAX, NCUSTOMPMAX
             FROM EQMOVPRODSLDSP(:ICODEMP, :SCODFILIAL, :ICODMOVPROD, :ICODEMPPD,
             :SCODFILIALPD, :ICODPROD, :DDTPRC, 0, 0,
             :ICODEMPAX, :SCODFILIALAX, :ICODALMOX, :CMULTIALMOX)
             INTO :NSLDPRC, :NCUSTOMPMPRC, :NSLDPRCAX, :NCUSTOMPMPRCAX ;

          /* verifica lançamento anterior e traz custo e saldo */
          SELECT NSALDO, NCUSTOMPM, NSALDOAX, NCUSTOMPMAX
             FROM EQMOVPRODSLDSP(:ICODEMP, :SCODFILIAL, :ICODMOVPROD, :ICODEMPPD,
             :SCODFILIALPD, :ICODPROD, :DDTMOVPROD, :NCUSTOMPMLC, :NCUSTOMPMLCAX,
             :ICODEMPAX, :SCODFILIALAX, :ICODALMOX, :CMULTIALMOX)
             INTO :NSLDLC, :NCUSTOMPMLC, :NSLDLCAX, :NCUSTOMPMLCAX ;

          /* verifica se havera mudança de saldo */
          SELECT NSALDO, NCUSTOMPM, CESTOQMOVPROD
              FROM EQMOVPRODCSLDSP(:ICODEMPTM, :SCODFILIALTM,
              :ICODTIPOMOV, (:NQTDMOVPROD-:NQTDMOVPRODOLD), :NPRECOMOVPROD,
              :NCUSTOMPMLC, :NSLDLC)
              INTO :NSLDLC, :NCUSTOMPMLC, :CESTOQMOVPROD;
          if (CMULTIALMOX='N') then
          begin
             NSLDLCAX = NSLDLC;
             NCUSTOMPMLCAX = NCUSTOMPMLC;
          end
          else
          begin
              SELECT NSALDO, NCUSTOMPM
                  FROM EQMOVPRODCSLDSP(:ICODEMPTM, :SCODFILIALTM,
                  :ICODTIPOMOV, (:NQTDMOVPROD-:NQTDMOVPRODOLD), :NPRECOMOVPROD,
                  :NCUSTOMPMLCAX, :NSLDLCAX)
                  INTO :NSLDLCAX, :NCUSTOMPMLCAX;
          end

      end

      /* REPROCESSAR ESTOQUE */

       SELECT NSLDPRC, NCUSTOMPMPRC, NSLDPRCAX, NCUSTOMPMPRCAX
        FROM EQMOVPRODPRCSLDSP( :SCODFILIAL, :ICODMOVPROD, :ICODEMPPD,
          :SCODFILIALPD, :ICODPROD, :DDTPRC, :DDTPRCATE, :NSLDPRC,
          :NCUSTOMPMPRC, :NSLDPRCAX, :NCUSTOMPMPRCAX,
          :ICODEMPAX, :SCODFILIALAX, :ICODALMOX, :CMULTIALMOX)
        INTO :NSLDPRC, :NCUSTOMPMPRC, :NSLDPRCAX, :NCUSTOMPMPRCAX;

/* caso a data seja igual deverá reprocessar datas posteriores */
/*      if (DDTMOVPROD=DDTMOVPRODOLD) then
      begin
          DDTPRC = DDTMOVPROD+1;
          DDTPRCATE = null;
          SELECT NSLDPRC, NCUSTOMPMPRC, NSLDPRCAX, NCUSTOMPMPRCAX
          FROM EQMOVPRODPRCSLDSP( :SCODFILIAL, :ICODMOVPROD, :ICODEMPPD,
            :SCODFILIALPD, :ICODPROD, :DDTPRC, :DDTPRCATE, :NSLDPRC,
            :NCUSTOMPMPRC, :NSLDPRCAX, :NCUSTOMPMPRCAX,
            :ICODEMPAX, :SCODFILIALAX, :ICODALMOX, :CMULTIALMOX)
          INTO :NSLDPRC, :NCUSTOMPMPRC, :NSLDPRCAX, :NCUSTOMPMPRCAX;
      end*/

      /* ATUALIZA CUSTO NO CADASTRO DE PRODUTOS */

    /*  EXECUTE PROCEDURE EQMOVPRODATCUSTSP( :SOPERADOR, :ICODEMP, :SCODFILIAL, */
      /*   :ICODMOVPROD, :SCODFILIALPD, :ICODPROD, :DDTMOVPROD, :NCUSTOMPMLC); */

       /* faz update  (Obs. o update tem que ser a última tarefa por questões de
           índice */

      /*CTEMP = printlog('VAI FAZER O UPDATE: '||CAST(DDTMOVPROD AS CHAR(10)));*/

      UPDATE EQMOVPROD SET DTMOVPROD=:DDTMOVPROD,
         QTDMOVPROD=:NQTDMOVPROD, PRECOMOVPROD=:NPRECOMOVPROD,
         SLDMOVPROD=:NSLDLC, CUSTOMPMMOVPROD=:NCUSTOMPMLC,
         SLDMOVPRODAX=:NSLDLCAX, CUSTOMPMMOVPRODAX=:NCUSTOMPMLCAX,
         FLAG=:CFLAG, CODEMPNT=:ICODEMPNT, CODFILIALNT=:SCODFILIALNT,
         CODNAT=:CCODNAT, DOCMOVPROD=:IDOCMOVPROD, CODEMPTM=:ICODEMPTM,
         CODFILIALTM=:SCODFILIALTM, CODTIPOMOV=:ICODTIPOMOV, CODEMPLE=:ICODEMPLE,
         CODFILIALLE=:SCODFILIALLE, CODLOTE=:CCODLOTE, ESTOQMOVPROD=:CESTOQMOVPROD ,
         CODEMPAX=:ICODEMPAX, CODFILIALAX=:SCODFILIALAX, CODALMOX=:ICODALMOX
        WHERE CODEMP=:ICODEMP AND CODFILIAL=:SCODFILIAL AND CODMOVPROD=:ICODMOVPROD;

   end
   else /*  caso não tenha nenhuma alteração relevânte para processamento */
      UPDATE EQMOVPROD SET FLAG=:CFLAG, CODEMPNT=:ICODEMPNT, CODFILIALNT=:SCODFILIALNT,
         CODNAT=:CCODNAT, DOCMOVPROD=:IDOCMOVPROD, CODEMPTM=:ICODEMPTM,
         CODFILIALTM=:SCODFILIALTM, CODTIPOMOV=:ICODTIPOMOV, CODEMPLE=:ICODEMPLE,
         CODFILIALLE=:SCODFILIALLE, CODLOTE=:CCODLOTE,
         CODEMPAX=:ICODEMPAX, CODFILIALAX=:SCODFILIALAX, CODALMOX=:ICODALMOX
        WHERE CODEMP=:ICODEMP AND CODFILIAL=:SCODFILIAL AND CODMOVPROD=:ICODMOVPROD;
   suspend;
end^


ALTER PROCEDURE EQPRODUTOSP01 (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODPROD INTEGER,
    ICODEMPAX INTEGER,
    SCODFILIALAX SMALLINT,
    ICODALMOX INTEGER)
RETURNS (
    NSALDO NUMERIC(15,5),
    NSALDOAX NUMERIC(15,5),
    NCUSTOMPM NUMERIC(15,5),
    NCUSTOPEPS NUMERIC(15,5),
    NCUSTOMPMAX NUMERIC(15,5),
    NCUSTOPEPSAX NUMERIC(15,5))
AS
DECLARE VARIABLE DDTMOVPROD DATE;
DECLARE VARIABLE DDTMOVPRODAX DATE;
begin
  /* Procedure que retorna saldos e custos para a tela de cadastro de produtos */
  SELECT FIRST 1 MP.DTMOVPROD, MP.SLDMOVPROD , MP.CUSTOMPMMOVPROD
    FROM EQMOVPROD MP
    WHERE MP.CODEMPPD=:ICODEMP AND MP.CODFILIALPD=:SCODFILIAL AND MP.CODPROD=:ICODPROD
    ORDER BY MP.DTMOVPROD DESC, MP.CODMOVPROD DESC
    INTO :DDTMOVPROD, :NSALDO, :NCUSTOMPM;

  SELECT FIRST 1 MP.DTMOVPROD, MP.SLDMOVPRODAX, MP.CUSTOMPMMOVPRODAX
    FROM EQMOVPROD MP
    WHERE MP.CODEMPPD=:ICODEMP AND MP.CODFILIALPD=:SCODFILIAL AND MP.CODPROD=:ICODPROD
    ORDER BY MP.DTMOVPROD DESC, MP.CODMOVPROD DESC
    INTO :DDTMOVPRODAX, :NSALDOAX, :NCUSTOMPMAX;

  SELECT P.NCUSTOPEPS  FROM EQCALCPEPSSP(:ICODEMP, :SCODFILIAL,
     :ICODPROD, :NSALDO, :DDTMOVPROD, null, null,
     null ) P INTO :NCUSTOPEPS;

  SELECT P.NCUSTOPEPS  FROM EQCALCPEPSSP(:ICODEMP, :SCODFILIAL,
     :ICODPROD, :NSALDO, :DDTMOVPRODAX, :ICODEMPAX, :SCODFILIALAX,
     :ICODALMOX ) P INTO :NCUSTOPEPSAX;

  suspend;
end^


ALTER PROCEDURE EQREFPRODSP (
    CODEMP INTEGER,
    CODFILIAL SMALLINT,
    CODPROD INTEGER)
RETURNS (
    REFPROD CHAR(13))
AS
begin
  /* Procedure Text */
  SELECT REFPROD FROM EQPRODUTO WHERE CODPROD=:CODPROD AND
     CODEMP=:CODEMP AND CODFILIAL=:CODFILIAL INTO :REFPROD;
  suspend;
end^


ALTER PROCEDURE EQRELDEMANDASP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    SCODFILIALPD SMALLINT,
    DDTINI DATE,
    DDTFIM DATE)
RETURNS (
    CODMARCA CHAR(6),
    CODGRUP CHAR(14),
    CODPROD INTEGER,
    REFPROD CHAR(13),
    DESCPROD CHAR(50),
    DESCGRUP CHAR(50),
    SLDINI NUMERIC(15,5),
    VLRCOMPRAS NUMERIC(15,5),
    VLRDEVENT NUMERIC(15,5),
    VLROUTENT NUMERIC(15,5),
    VLRVENDAS NUMERIC(15,5),
    VLRDEVSAI NUMERIC(15,5),
    VLROUTSAI NUMERIC(15,5),
    SLDFIM NUMERIC(15,5))
AS
begin
  /* Stored procedure de relatório de demanda */
  FOR SELECT P.CODMARCA, P.CODGRUP,P.CODPROD,
     P.REFPROD, P.DESCPROD,G.DESCGRUP,
     (SELECT FIRST 1 SLDMOVPROD FROM EQMOVPROD MP
      WHERE MP.CODEMP=:ICODEMP AND MP.CODFILIAL=:SCODFILIAL AND
         MP.CODEMPPD=P.CODEMP AND MP.CODFILIALPD=P.CODFILIAL AND
         MP.CODPROD=P.CODPROD AND MP.DTMOVPROD<:DDTINI
         ORDER BY MP.DTMOVPROD DESC, MP.CODMOVPROD DESC ) SLDINI,
     (SELECT SUM(MP.QTDMOVPROD)
         FROM EQMOVPROD MP, EQTIPOMOV TM
         WHERE TM.CODEMP=MP.CODEMPTM AND TM.CODFILIAL=MP.CODFILIALTM AND
           TM.CODTIPOMOV=MP.CODTIPOMOV AND MP.CODPROD=P.CODPROD AND
           MP.CODEMPPD=P.CODEMP AND MP.CODFILIALPD=P.CODFILIAL AND
           MP.DTMOVPROD BETWEEN :DDTINI AND :DDTFIM AND MP.ESTOQMOVPROD='S' AND
           TM.TIPOMOV IN ('CP','PC') AND TM.ESTIPOMOV = 'E') VLRCOMPRAS,
     (SELECT SUM(MP.QTDMOVPROD)
         FROM EQMOVPROD MP, EQTIPOMOV TM
         WHERE TM.CODEMP=MP.CODEMPTM AND TM.CODFILIAL=MP.CODFILIALTM AND
           TM.CODTIPOMOV=MP.CODTIPOMOV AND MP.CODPROD=P.CODPROD AND
           MP.CODEMPPD=P.CODEMP AND MP.CODFILIALPD=P.CODFILIAL AND
           MP.DTMOVPROD BETWEEN :DDTINI AND :DDTFIM AND MP.ESTOQMOVPROD='S' AND
           TM.TIPOMOV ='DV' AND TM.ESTIPOMOV = 'E') VLRDEVENT,
     (SELECT SUM(MP.QTDMOVPROD)
         FROM EQMOVPROD MP , EQTIPOMOV TM
         WHERE TM.CODEMP=MP.CODEMPTM AND TM.CODFILIAL=MP.CODFILIALTM AND
           TM.CODTIPOMOV=MP.CODTIPOMOV AND MP.CODPROD=P.CODPROD AND
           MP.CODEMPPD=P.CODEMP AND MP.CODFILIALPD=P.CODFILIAL AND
           MP.DTMOVPROD BETWEEN :DDTINI AND :DDTFIM AND MP.ESTOQMOVPROD='S' AND
           TM.TIPOMOV NOT IN ('CP','PC','DV') AND TM.ESTIPOMOV IN ('E','I')) VLROUTENT,
     (SELECT SUM(MP.QTDMOVPROD)
         FROM EQMOVPROD MP, EQTIPOMOV TM
         WHERE TM.CODEMP=MP.CODEMPTM AND TM.CODFILIAL=MP.CODFILIALTM AND
           TM.CODTIPOMOV=MP.CODTIPOMOV AND MP.CODPROD=P.CODPROD AND
           MP.CODEMPPD=P.CODEMP AND MP.CODFILIALPD=P.CODFILIAL AND
           MP.DTMOVPROD BETWEEN :DDTINI AND :DDTFIM AND MP.ESTOQMOVPROD='S' AND
           TM.TIPOMOV IN ('VD','PV') AND TM.ESTIPOMOV = 'S') VLRVENDAS,
     (SELECT SUM(MP.QTDMOVPROD)
         FROM EQMOVPROD MP, EQTIPOMOV TM
         WHERE TM.CODEMP=MP.CODEMPTM AND TM.CODFILIAL=MP.CODFILIALTM AND
           TM.CODTIPOMOV=MP.CODTIPOMOV AND MP.CODPROD=P.CODPROD AND
           MP.CODEMPPD=P.CODEMP AND MP.CODFILIALPD=P.CODFILIAL AND
           MP.DTMOVPROD BETWEEN :DDTINI AND :DDTFIM AND MP.ESTOQMOVPROD='S' AND
           TM.TIPOMOV ='DV' AND TM.ESTIPOMOV = 'S') VLRDEVSAI,
     (SELECT SUM(MP.QTDMOVPROD)
        FROM EQMOVPROD MP, EQTIPOMOV TM
         WHERE TM.CODEMP=MP.CODEMPTM AND TM.CODFILIAL=MP.CODFILIALTM AND
           TM.CODTIPOMOV=MP.CODTIPOMOV AND MP.CODPROD=P.CODPROD AND
           MP.CODEMPPD=P.CODEMP AND MP.CODFILIALPD=P.CODFILIAL AND
           MP.DTMOVPROD BETWEEN :DDTINI AND :DDTFIM AND MP.ESTOQMOVPROD='S' AND
           TM.TIPOMOV NOT IN ('VD','PV','DV') AND TM.ESTIPOMOV = 'S') VLROUTSAI
     FROM EQPRODUTO P, EQGRUPO G
         WHERE G.CODGRUP=P.CODGRUP AND G.CODEMP=P.CODEMPGP AND
           G.CODFILIAL=P.CODFILIALGP AND P.CODEMP=:ICODEMP AND
           P.CODFILIAL=:SCODFILIALPD AND P.ATIVOPROD='S'
     INTO :CODMARCA, :CODGRUP, :CODPROD, :REFPROD, :DESCPROD, :DESCGRUP,
        :SLDINI, :VLRCOMPRAS, :VLRDEVENT,  :VLROUTENT,
         :VLRVENDAS, :VLRDEVSAI, :VLROUTSAI DO
     BEGIN
        if (SLDINI IS NULL) then
           SLDINI = 0;
        if (VLROUTSAI IS NULL) then
           VLROUTSAI = 0;
        if (VLROUTENT IS NULL) then
           VLROUTENT = 0;
        if (VLRDEVSAI IS NULL) then
           VLRDEVSAI = 0;
        if (VLRDEVENT IS NULL) then
           VLRDEVENT = 0;
        if (VLRCOMPRAS IS NULL) then
           VLRCOMPRAS = 0;
        if (VLRVENDAS IS NULL) then
           VLRVENDAS = 0;
        SLDFIM = SLDINI + VLRCOMPRAS + VLRDEVENT + VLROUTENT -
           VLRVENDAS - VLRDEVSAI - VLROUTSAI;
        suspend;
     END
end^


ALTER PROCEDURE EQRELINVPRODSP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    CTIPOCUSTO CHAR(1),
    ICODEMPGP INTEGER,
    SCODFILIALGP SMALLINT,
    CCODGRUP CHAR(14),
    DDTESTOQ DATE,
    ICODEMPAX INTEGER,
    SCODFILIALAX SMALLINT,
    ICODALMOX INTEGER)
RETURNS (
    CODPROD INTEGER,
    REFPROD CHAR(13),
    DESCPROD CHAR(50),
    CODGRUP CHAR(14),
    SALDO NUMERIC(15,5),
    CUSTO NUMERIC(15,5),
    VLRESTOQ NUMERIC(15,5))
AS
DECLARE VARIABLE CMULTIALMOX CHAR(1);
DECLARE VARIABLE NCUSTOMPM NUMERIC(15,5);
begin
  /* Relatório de estoque */
  SELECT CMULTIALMOX FROM SGRETMULTIALMOXSP(:ICODEMP) INTO :CMULTIALMOX;

  if (CCODGRUP IS NOT NULL) then
  begin
     CCODGRUP = rtrim(CCODGRUP);
     if (strlen(CCODGRUP)<14) then
        CCODGRUP = CCODGRUP || '%';
  end
  FOR SELECT P.CODPROD, P.REFPROD, P.DESCPROD, P.CODGRUP
    FROM EQPRODUTO P
    WHERE P.CODEMP=:ICODEMP AND P.CODFILIAL=:SCODFILIAL AND
          ( ( :CCODGRUP IS NULL ) OR
            (P.CODGRUP LIKE :CCODGRUP AND P.CODEMPGP=:ICODEMPGP AND
             P.CODFILIALGP=:SCODFILIALGP) )
    INTO :CODPROD, :REFPROD, :DESCPROD, :CODGRUP DO
  BEGIN
     SELECT NSALDO, NCUSTOMPM FROM EQMOVPRODSLDSP(null, null, null, :ICODEMP,
        :SCODFILIAL, :CODPROD, :DDTESTOQ, 0, 0,
        :ICODEMPAX, :SCODFILIALAX, :ICODALMOX, :CMULTIALMOX)
       INTO :SALDO, :NCUSTOMPM;
     if (CTIPOCUSTO='M') then
        CUSTO = NCUSTOMPM;
     else
        SELECT NCUSTOPEPS FROM EQCALCPEPSSP(:ICODEMP, :SCODFILIAL, :CODPROD,
          :SALDO, :DDTESTOQ, :ICODEMPAX, :SCODFILIALAX, :ICODALMOX)
        INTO :CUSTO;
     VLRESTOQ = CUSTO * SALDO;
     SUSPEND;
  END
end^


ALTER PROCEDURE EQRELPEPSSP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    DTESTOQ DATE,
    ICODEMPMC INTEGER,
    SCODFILIALMC SMALLINT,
    CCODMARCA CHAR(6),
    ICODEMPGP INTEGER,
    SCODFILIALGP SMALLINT,
    CCODGRUP CHAR(14),
    CTIPOCUSTO CHAR(1),
    ICODEMPAX INTEGER,
    SCODFILIALAX SMALLINT,
    ICODALMOX INTEGER)
RETURNS (
    CODPROD INTEGER,
    REFPROD CHAR(13),
    DESCPROD CHAR(50),
    SLDPROD NUMERIC(15,5),
    CUSTOUNIT NUMERIC(15,5),
    CUSTOTOT NUMERIC(15,5),
    CODBARPROD CHAR(13),
    CODFABPROD CHAR(13))
AS
begin
  /* Procedure Text */
  IF (ICODEMPGP IS NOT NULL) THEN
  BEGIN
    IF (STRLEN(RTRIM(CCODGRUP))<14) THEN
       CCODGRUP = RTRIM(CCODGRUP)||'%';
  END
  IF (CTIPOCUSTO IS NULL) then
     CTIPOCUSTO = 'P';

  FOR SELECT P.CODPROD,P.REFPROD,P.DESCPROD, P.CODBARPROD, P.CODFABPROD
   FROM EQPRODUTO P
   WHERE P.CODEMP = :ICODEMP AND P.CODFILIAL = :SCODFILIAL AND
   ( (:ICODEMPMC IS NULL) OR (P.CODEMPMC=:ICODEMPMC AND P.CODFILIALMC=:SCODFILIALMC AND
      P.CODMARCA=:CCODMARCA) ) AND
   ((:ICODEMPGP IS NULL) OR (P.CODEMPGP=:ICODEMPGP AND P.CODFILIALGP=:SCODFILIALGP AND
      P.CODGRUP LIKE :CCODGRUP) )
   INTO :CODPROD, :REFPROD, :DESCPROD, :CODBARPROD, :CODFABPROD  DO
  BEGIN
     SELECT SLDPROD, CUSTOUNIT, CUSTOTOT FROM EQCUSTOPRODSP(:ICODEMP,
        :SCODFILIAL, :CODPROD, :DTESTOQ, :CTIPOCUSTO, :ICODEMPAX,
        :SCODFILIALAX, :ICODALMOX, 'S')
       INTO :SLDPROD, :CUSTOUNIT, :CUSTOTOT;
     SUSPEND;
  END
end^


ALTER PROCEDURE EQSALDOLOTEATEQSP (
    ICODEMPLEOLD INTEGER,
    SCODFILIALLEOLD SMALLINT,
    ICODPROD INTEGER,
    CCODLOTEOLD VARCHAR(20),
    ICODEMPLENEW INTEGER,
    SCODFILIALLENEW SMALLINT,
    CCODLOTENEW VARCHAR(20),
    SOPERADOR SMALLINT,
    NQTDMOVPRODOLD NUMERIC(15,5),
    NQTDMOVPRODNEW NUMERIC(15,5),
    ICODEMPAXOLD INTEGER,
    SCODFILIALAXOLD SMALLINT,
    ICODALMOXOLD INTEGER,
    ICODEMPAXNEW INTEGER,
    SCODFILIALAXNEW SMALLINT,
    ICODALMOXNEW INTEGER)
AS
DECLARE VARIABLE ICODPRODSLD INTEGER;
begin
  /* Procedure de atualização do estoque  na tabela de saldos de lotes por almoxarifado*/

  SELECT CODPROD FROM EQSALDOLOTE
     WHERE CODEMP=:ICODEMPLENEW AND CODFILIAL=:SCODFILIALLENEW AND CODPROD=:ICODPROD AND
        CODLOTE=:CCODLOTENEW AND CODEMPAX=:ICODEMPAXNEW AND 
        CODFILIALAX=:SCODFILIALAXNEW AND CODALMOX=:ICODALMOXNEW
     INTO :ICODPRODSLD;
  IF (ICODPRODSLD IS NULL) THEN
  BEGIN
     INSERT INTO EQSALDOLOTE (CODEMP, CODFILIAL, CODPROD, CODLOTE, CODEMPAX, CODFILIALAX, CODALMOX)
       VALUES (:ICODEMPLENEW, :SCODFILIALLENEW, :ICODPROD, :CCODLOTENEW, :ICODEMPAXNEW, :SCODFILIALAXNEW,
         :ICODALMOXNEW);
     NQTDMOVPRODOLD = 0;
  END

  IF ( (ICODALMOXOLD IS NULL) OR (CCODLOTEOLD IS NULL) ) THEN
    NQTDMOVPRODOLD = 0;
  ELSE IF ( (ICODEMPAXOLD!=ICODEMPAXNEW) OR (SCODFILIALAXOLD!=SCODFILIALAXNEW) OR
            (ICODALMOXOLD!=ICODALMOXNEW) OR (CCODLOTEOLD!=CCODLOTENEW) OR
            (ICODEMPLEOLD!=ICODEMPLENEW) OR (SCODFILIALLEOLD!=SCODFILIALLENEW) ) THEN
  BEGIN
      IF ((CCODLOTEOLD!=CCODLOTENEW) OR (ICODEMPLEOLD!=ICODEMPLENEW) OR
          (SCODFILIALLEOLD!=SCODFILIALLENEW) ) THEN
      BEGIN
         UPDATE EQLOTE SET SLDLOTE = SLDLOTE+((0-:NQTDMOVPRODOLD)*:SOPERADOR)
            WHERE CODLOTE=:CCODLOTEOLD AND CODPROD=:ICODPROD
            AND CODEMP=:ICODEMPLEOLD AND CODFILIAL=:SCODFILIALLEOLD;
      END
      UPDATE EQSALDOLOTE SET SLDLOTE = SLDLOTE+((0-:NQTDMOVPRODOLD)*:SOPERADOR)
         WHERE CODPROD=:ICODPROD AND CODLOTE=:CCODLOTEOLD AND CODALMOX = :ICODALMOXOLD
           AND CODEMPAX = :ICODEMPAXOLD AND CODFILIALAX = :SCODFILIALAXOLD
           AND CODEMP=:ICODEMPLEOLD AND CODFILIAL=:SCODFILIALLEOLD; 
      NQTDMOVPRODOLD=0;
  END
  UPDATE EQLOTE SET SLDLOTE = SLDLOTE+((:NQTDMOVPRODNEW-:NQTDMOVPRODOLD)*:SOPERADOR)
        WHERE CODLOTE=:CCODLOTENEW AND CODPROD=:ICODPROD
         AND CODEMP=:ICODEMPLENEW AND CODFILIAL=:SCODFILIALLENEW;
  UPDATE EQSALDOLOTE SET SLDLOTE = SLDLOTE+((:NQTDMOVPRODNEW-:NQTDMOVPRODOLD)*:SOPERADOR)
         WHERE CODPROD=:ICODPROD AND CODLOTE=:CCODLOTENEW AND CODALMOX = :ICODALMOXNEW
           AND CODEMPAX = :ICODEMPAXNEW AND CODFILIALAX = :SCODFILIALAXNEW
           AND CODEMP=:ICODEMPLENEW AND CODFILIAL=:SCODFILIALLENEW;
  suspend;
end^


ALTER PROCEDURE EQSALDOPRODATEQSP (
    ICODEMPPD INTEGER,
    SCODFILIALPD SMALLINT,
    ICODPROD INTEGER,
    SOPERADOR SMALLINT,
    NQTDMOVPRODOLD NUMERIC(15,5),
    NQTDMOVPRODNEW NUMERIC(15,5),
    ICODEMPAXOLD INTEGER,
    SCODFILIALAXOLD SMALLINT,
    ICODALMOXOLD INTEGER,
    ICODEMPAXNEW INTEGER,
    SCODFILIALAXNEW SMALLINT,
    ICODALMOXNEW INTEGER)
AS
DECLARE VARIABLE ICODPRODSLD INTEGER;
begin
  /* Procedure de atualização do estoque  na tabela de saldos por almoxarifado*/
  SELECT CODPROD FROM EQSALDOPROD
     WHERE CODEMP=:ICODEMPPD AND CODFILIAL=:SCODFILIALPD AND CODPROD=:ICODPROD AND
        CODEMPAX=:ICODEMPAXNEW AND CODFILIALAX=:SCODFILIALAXNEW AND CODALMOX=:ICODALMOXNEW
     INTO :ICODPRODSLD;
  IF (ICODPRODSLD IS NULL) THEN
  BEGIN
     INSERT INTO EQSALDOPROD (CODEMP, CODFILIAL, CODPROD, CODEMPAX, CODFILIALAX, CODALMOX)
       VALUES (:ICODEMPPD, :SCODFILIALPD, :ICODPROD, :ICODEMPAXNEW, :SCODFILIALAXNEW,
         :ICODALMOXNEW);
     NQTDMOVPRODOLD = 0;
  END

  IF (ICODALMOXOLD IS NULL) THEN
    NQTDMOVPRODOLD = 0;
  ELSE IF ( (ICODEMPAXOLD!=ICODEMPAXNEW) OR (SCODFILIALAXOLD!=SCODFILIALAXNEW) OR
            (ICODALMOXOLD!=ICODALMOXNEW) ) THEN
  BEGIN
      UPDATE EQSALDOPROD SET SLDPROD = SLDPROD+((0-:NQTDMOVPRODOLD)*:SOPERADOR)
         WHERE CODPROD=:ICODPROD AND CODALMOX = :ICODALMOXOLD
           AND CODEMPAX = :ICODEMPAXOLD AND CODFILIALAX = :SCODFILIALAXOLD
           AND CODEMP=:ICODEMPPD AND CODFILIAL=:SCODFILIALPD;
      NQTDMOVPRODOLD=0;
  END
  UPDATE EQSALDOPROD SET SLDPROD = SLDPROD+((:NQTDMOVPRODNEW-:NQTDMOVPRODOLD)*:SOPERADOR)
         WHERE CODPROD=:ICODPROD AND CODALMOX = :ICODALMOXNEW
           AND CODEMPAX = :ICODEMPAXNEW AND CODFILIALAX = :SCODFILIALAXNEW
           AND CODEMP=:ICODEMPPD AND CODFILIAL=:SCODFILIALPD;
  suspend;
end^


ALTER PROCEDURE FNADICITRECEBERSP01 (
    CALTVLR CHAR(1),
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODREC INTEGER,
    INPARCITREC INTEGER,
    NVLRDESCITREC NUMERIC(15,5),
    NVLRMULTAITREC NUMERIC(15,5),
    NVLRJUROSITREC NUMERIC(15,5),
    NVLRPARCITREC NUMERIC(15,5),
    NVLRPAGOITREC NUMERIC(15,5),
    DDTITREC DATE,
    DDTVENCITREC DATE,
    CSTATUSITREC CHAR(2),
    CFLAG CHAR(1),
    ICODEMPBO INTEGER,
    SCODFILIALBO SMALLINT,
    CCODBANCO CHAR(3),
    ICODEMPTC INTEGER,
    SCODFILIALTC SMALLINT,
    ICODTIPOCOB INTEGER,
    ICODEMPCB INTEGER,
    SCODFILIALCB SMALLINT,
    CODCARTCOB CHAR(2),
    NVLRCOMIITREC NUMERIC(15,5),
    OBSITREC VARCHAR(250))
AS
DECLARE VARIABLE INPARCITRECOLD INTEGER;
begin
   SELECT IR.NPARCITREC FROM FNITRECEBER IR WHERE IR.CODEMP=:ICODEMP AND
     IR.CODFILIAL=:SCODFILIAL AND IR.CODREC=:ICODREC AND
     IR.NPARCITREC=:INPARCITREC INTO :INPARCITRECOLD;

   IF (INPARCITRECOLD IS NULL) THEN
     /* Faz inserção na tabela de parcelas do contas a receber */
       INSERT INTO FNITRECEBER (CODEMP,CODFILIAL,CODREC,NPARCITREC,VLRDESCITREC,VLRMULTAITREC,
              VLRJUROSITREC,VLRPARCITREC,VLRPAGOITREC,DTITREC,DTVENCITREC,
              STATUSITREC,FLAG,CODEMPBO,CODFILIALBO,CODBANCO,
              CODEMPTC, CODFILIALTC, CODTIPOCOB,
              CODEMPCB, CODFILIALCB, CODCARTCOB, VLRCOMIITREC, OBSITREC)
              VALUES
             (:ICODEMP,:SCODFILIAL,:ICODREC,:INPARCITREC,:NVLRDESCITREC,:NVLRMULTAITREC,
             :NVLRJUROSITREC,:NVLRPARCITREC,:NVLRPAGOITREC, :DDTITREC,:DDTVENCITREC,
             :CSTATUSITREC,:CFLAG,:ICODEMPBO,:SCODFILIALBO,:CCODBANCO,
             :ICODEMPTC, :SCODFILIALTC, :ICODTIPOCOB,
             :ICODEMPCB, :SCODFILIALCB, :CODCARTCOB, :NVLRCOMIITREC, :OBSITREC);
   ELSE
   BEGIN
       SELECT VLRDESCITREC, VLRMULTAITREC, VLRJUROSITREC, VLRPAGOITREC, STATUSITREC
       FROM FNITRECEBER
       WHERE CODEMP=:ICODEMP AND CODFILIAL=:SCODFILIAL AND CODREC=:ICODREC AND
            NPARCITREC=:INPARCITREC
       INTO :NVLRDESCITREC, :NVLRMULTAITREC, :NVLRJUROSITREC, :NVLRPAGOITREC, :CSTATUSITREC;

       IF (CALTVLR='S') THEN /* Flag que indica se é para mudar os valores do contas areceber */
       BEGIN

           UPDATE FNITRECEBER SET ALTUSUITREC='N',VLRDESCITREC=:NVLRDESCITREC,VLRMULTAITREC=:NVLRMULTAITREC,
                  VLRJUROSITREC=:NVLRJUROSITREC,VLRPARCITREC=:NVLRPARCITREC,
                  VLRPAGOITREC=:NVLRPAGOITREC,DTITREC=:DDTITREC,STATUSITREC=:CSTATUSITREC,
                  FLAG=:CFLAG,CODEMPBO=:ICODEMPBO,CODFILIALBO=:SCODFILIALBO,
                  CODBANCO=:CCODBANCO,CODEMPTC=:ICODEMPTC, CODFILIALTC=:SCODFILIALTC, 
                  CODTIPOCOB=:ICODTIPOCOB,
                  CODEMPCB=:ICODEMPCB, CODFILIALCB=:SCODFILIALCB, CODCARTCOB=:CODCARTCOB,
                  VLRCOMIITREC=:NVLRCOMIITREC
            WHERE CODEMP=:ICODEMP AND CODFILIAL=:SCODFILIAL AND CODREC=:ICODREC AND
                NPARCITREC=:INPARCITREC;
       END
       ELSE
           UPDATE FNITRECEBER SET ALTUSUITREC='N',DTITREC=:DDTITREC,
                  STATUSITREC=:CSTATUSITREC, FLAG=:CFLAG,CODEMPBO=:ICODEMPBO,
                  CODFILIALBO=:SCODFILIALBO,CODBANCO=:CCODBANCO,CODEMPTC=:ICODEMPTC,
                  CODFILIALTC=:SCODFILIALTC, CODTIPOCOB=:ICODTIPOCOB,
                  CODEMPCB=:ICODEMPCB, CODFILIALCB=:SCODFILIALCB, CODCARTCOB=:CODCARTCOB,
                  VLRCOMIITREC=:NVLRCOMIITREC
            WHERE CODEMP=:ICODEMP AND CODFILIAL=:SCODFILIAL AND CODREC=:ICODREC AND
                NPARCITREC=:INPARCITREC;
  END
  suspend;
end^


ALTER PROCEDURE FNADICLANCASP01 (
    ICODREC INTEGER,
    INPARCITREC INTEGER,
    PDVITREC CHAR(1),
    SNUMCONTA CHAR(10),
    ICODEMPCA INTEGER,
    ICODFILIALCA INTEGER,
    ICODCLI INTEGER,
    ICODEMPCL INTEGER,
    ICODFILIALCL INTEGER,
    SCODPLAN CHAR(13),
    ICODEMPPN INTEGER,
    ICODFILIALPN INTEGER,
    IANOCC INTEGER,
    SCODCC CHAR(19),
    ICODEMPCC INTEGER,
    ICODFILIALCC INTEGER,
    DDTPAGOITREC DATE,
    SDOCLANCAITREC CHAR(10),
    SOBSITREC CHAR(50),
    DVLRPAGOITREC NUMERIC(18,2),
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT)
AS
DECLARE VARIABLE ICODLANCA INTEGER;
DECLARE VARIABLE SCODPLANCONTA CHAR(13);
DECLARE VARIABLE ICODEMPPCONTA INTEGER;
DECLARE VARIABLE ICODFILIALPCONTA INTEGER;
DECLARE VARIABLE CFLAG CHAR(1);
DECLARE VARIABLE IFILIALLANCA INTEGER;
DECLARE VARIABLE TIPOLANCA CHAR(1);
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'FNLANCA') INTO IFILIALLANCA;
  SELECT CODPLAN,CODEMPPN,CODFILIALPN FROM FNCONTA WHERE NUMCONTA = :SNUMCONTA
         AND CODEMP=:ICODEMPCA AND CODFILIAL=:ICODFILIALCA INTO :sCodPlanConta,:iCodEmpPConta,:iCodFilialPConta;
  SELECT ISEQ FROM SPGERANUM(:ICODEMP,:IFILIALLANCA,'LA') INTO ICODLANCA;
  SELECT FLAG FROM FNRECEBER WHERE CODREC=:ICODREC
         AND CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL INTO :cFlag;

  IF (ICODCLI IS NULL) THEN
    TIPOLANCA = 'A';
  ELSE
    TIPOLANCA = 'C';

  INSERT INTO FNLANCA (TIPOLANCA,CODEMP,CODFILIAL,CODLANCA,CODEMPRC,CODFILIALRC,CODREC,NPARCITREC,CODEMPPN,CODFILIALPN,
                       CODPLAN,DATALANCA,DOCLANCA,HISTBLANCA,DTPREVLANCA,VLRLANCA,FLAG,CODEMPCL,CODFILIALCL,CODCLI,PDVITREC)
         VALUES (
                 :TIPOLANCA,:ICODEMP,:IFILIALLANCA,:iCodLanca,:ICODEMP,:ICODFILIAL,:ICODREC,:iNParcItRec,:iCodEmpPConta,:iCodFilialPConta,
                 :sCodPlanConta,:dDtPagoItRec,:sDocLancaItRec,:sObsItRec,:dDtPagoItRec,0,:cFlag,:ICODEMPCL,:ICODFILIALCL,:ICODCLI,:PDVITREC
          );
  INSERT INTO FNSUBLANCA (CODEMP,CODFILIAL,CODLANCA,CODSUBLANCA,CODEMPCL,CODFILIALCL,CODCLI,CODEMPPN,CODFILIALPN,CODPLAN,CODEMPCC,
                          CODFILIALCC,ANOCC,CODCC,ORIGSUBLANCA,DATASUBLANCA,DTPREVSUBLANCA,VLRSUBLANCA,FLAG)
         VALUES (
                :ICODEMP,:IFILIALLANCA,:iCodLanca,1,:ICODEMPCL,:ICODFILIALCL,:ICODCLI,:ICODEMPPN,:ICODFILIALPN,:SCODPLAN,:ICODEMPCC,
                :ICODFILIALCC,:IANOCC,:SCODCC,'S',:dDtPagoItRec,:dDtPagoItRec,:dVlrPagoItRec*-1,:cFlag
         );
END^


ALTER PROCEDURE FNADICLANCASP02 (
    ICODPAG INTEGER,
    INPARCPAG INTEGER,
    SNUMCONTA CHAR(10),
    ICODEMPCA INTEGER,
    ICODFILIALCA INTEGER,
    ICODFOR INTEGER,
    ICODEMPFR INTEGER,
    ICODFILIALFR INTEGER,
    SCODPLAN CHAR(13),
    ICODEMPPN INTEGER,
    ICODFILIALPN INTEGER,
    IANOCC INTEGER,
    SCODCC CHAR(19),
    ICODEMPCC INTEGER,
    ICODFILIALCC INTEGER,
    DDTPAGOITPAG DATE,
    SDOCLANCAITPAG CHAR(10),
    SOBSITPAG CHAR(50),
    DVLRPAGOITPAG NUMERIC(15,5),
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT)
AS
DECLARE VARIABLE ICODLANCA INTEGER;
DECLARE VARIABLE SCODPLANCONTA CHAR(13);
DECLARE VARIABLE ICODEMPPCONTA INTEGER;
DECLARE VARIABLE ICODFILIALPCONTA INTEGER;
DECLARE VARIABLE CFLAG CHAR(1);
DECLARE VARIABLE IFILIALLANCA INTEGER;
DECLARE VARIABLE TIPOLANCA CHAR(1);
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'FNLANCA') INTO IFILIALLANCA;
  SELECT CODPLAN,CODEMP,CODFILIAL FROM FNCONTA WHERE NUMCONTA=:sNumConta
         AND CODEMP=:ICODEMPCA AND CODFILIAL=:ICODFILIALCA INTO :sCodPlanConta,:iCodEmpPConta,:iCodFilialPConta;
  SELECT ISEQ FROM SPGERANUM(:iCODEMP,:IFILIALLANCA,'LA') INTO :iCodLanca;
  SELECT FLAG FROM FNPAGAR WHERE CODPAG=:iCodPag
         AND CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL INTO :cFlag;

  IF (ICODFOR IS NULL) THEN
    TIPOLANCA = 'A';
  ELSE
    TIPOLANCA = 'F';

  INSERT INTO FNLANCA (TIPOLANCA,CODEMP,CODFILIAL,CODLANCA,CODEMPPG,CODFILIALPG,CODPAG,
         NPARCPAG,CODEMPPN,CODFILIALPN,CODPLAN,DATALANCA,DOCLANCA,
         HISTBLANCA,DTPREVLANCA,VLRLANCA,FLAG, CODEMPFR, CODFILIALFR, CODFOR)
         VALUES (
                :TIPOLANCA,:ICODEMP,:IFILIALLANCA,:iCodLanca,:ICODEMP,:ICODFILIAL,:iCodPag,
                :iNParcPag,:iCodEmpPConta,:iCodFilialPConta,:sCodPlanConta,:dDtPagoItPag,:sDocLancaItPag,
                :sObsItPag,:dDtPagoItPag,0,:cFlag, :ICODEMPFR, :ICODFILIALFR, :ICODFOR
         );
  INSERT INTO FNSUBLANCA (CODEMP,CODFILIAL,CODLANCA,CODSUBLANCA,CODEMPFR,CODFILIALFR,CODFOR,CODEMPPN,CODFILIALPN,CODPLAN,CODEMPCC,CODFILIALCC,ANOCC,CODCC,ORIGSUBLANCA,DATASUBLANCA,DTPREVSUBLANCA,VLRSUBLANCA,FLAG)
         VALUES (:ICODEMP,:IFILIALLANCA,:iCodLanca,1,:ICODEMPFR,:ICODFILIALFR,:ICODFOR,:ICODEMPPN,:ICODFILIALPN,:sCodplan,:ICODEMPCC,:ICODFILIALCC,:IANOCC,:SCODCC,'E',:dDtPagoItPag,:dDtPagoItPag,:dVlrPagoItPag,:cFlag);
END^


ALTER PROCEDURE FNADICPAGARSP01 (
    CODCOMPRA INTEGER,
    ICODEMPPG INTEGER,
    ICODFILIALPG SMALLINT,
    CODPLANOPAG INTEGER,
    ICODEMPFR INTEGER,
    ICODFILIALFR SMALLINT,
    CODFOR INTEGER,
    VLRLIQCOMPRA NUMERIC(18,2),
    DTSAIDACOMPRA DATE,
    DOCCOMPRA INTEGER,
    ICODEMPBO INTEGER,
    ICODFILIALBO SMALLINT,
    CODBANCO CHAR(3),
    FLAG CHAR(1),
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT)
AS
DECLARE VARIABLE ICODPAGAR INTEGER;
  DECLARE VARIABLE IFILIALPAGAR INTEGER;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'FNPAGAR') INTO IFILIALPAGAR;
  SELECT ISEQ FROM SPGERANUM(:ICODEMP,:IFILIALPAGAR,'PA') INTO ICODPAGAR;
  INSERT INTO FNPAGAR (CODEMP,CODFILIAL,CODPAG,CODPLANOPAG,CODEMPPG,CODFILIALPG,CODFOR,CODEMPFR,CODFILIALFR,CODCOMPRA,CODEMPCP,CODFILIALCP,VLRPAG,
                      VLRDESCPAG,VLRMULTAPAG,VLRJUROSPAG,VLRPARCPAG,VLRPAGOPAG,
                      VLRAPAGPAG,DATAPAG,STATUSPAG,DOCPAG,CODBANCO,CODEMPBO,CODFILIALBO,FLAG)
                      VALUES (
                             :ICODEMP,:IFILIALPAGAR,:ICODPAGAR,:CodPlanoPag,:ICODEMPPG,:ICODFILIALPG,:CodFor,:ICODEMPFR,:ICODFILIALFR,:CodCompra,:ICODEMP,:ICODFILIAL,:VlrLiqCompra,
                             0,0,0,:VlrLiqCompra,0,:VlrLiqCompra,:dtSaidaCompra,'P1',:DocCompra,
                             :CodBanco,:ICODEMPBO,:ICODFILIALBO,:FLAG
                      );
END^


ALTER PROCEDURE FNADICRECEBERSP01 (
    CTIPOVENDA CHAR(1),
    ICODVENDA INTEGER,
    ICODEMPTC INTEGER,
    ICODFILIALTC INTEGER,
    CODTIPOCOB INTEGER,
    ICODEMPPG INTEGER,
    ICODFILIALPG SMALLINT,
    CODPLANOPAG INTEGER,
    ICODEMPCL INTEGER,
    ICODFILIALCL SMALLINT,
    CODCLI INTEGER,
    ICODEMPVD INTEGER,
    ICODFILIALVD SMALLINT,
    CODVEND INTEGER,
    VLRLIQVENDA NUMERIC(15,5),
    DTSAIDAVENDA DATE,
    VLRCOMISVENDA NUMERIC(15,5),
    DOCVENDA INTEGER,
    ICODEMPBO INTEGER,
    ICODFILIALBO SMALLINT,
    CODBANCO CHAR(3),
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT,
    CODEMPCB INTEGER,
    CODFILIALCB SMALLINT,
    CODCARTCOB CHAR(2),
    FLAG CHAR(1))
AS
declare variable icodrec integer;
declare variable scodfilialrc smallint;
declare variable iparcplanopag integer;
BEGIN
  SELECT R.CODREC,R.CODFILIAL FROM FNRECEBER R
     WHERE R.CODEMPVA=:ICODEMP AND R.CODFILIALVA=:ICODFILIAL AND
       R.TIPOVENDA=:CTIPOVENDA AND R.CODVENDA=:ICODVENDA
     INTO :ICODREC,:SCODFILIALRC;
  SELECT PARCPLANOPAG FROM FNPLANOPAG WHERE CODEMP=:ICODEMPPG AND
     CODFILIAL=:ICODFILIALPG AND CODPLANOPAG=:CODPLANOPAG
     INTO :IPARCPLANOPAG;

  IF ( (ICODREC IS NULL) AND (IPARCPLANOPAG>0) ) THEN
  BEGIN
     SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'FNRECEBER') INTO SCODFILIALRC;
     SELECT ISEQ FROM SPGERANUM(:ICODEMP,:SCODFILIALRC,'RC') INTO :ICODREC;

     INSERT INTO FNRECEBER (CODEMP,CODFILIAL,CODREC, CODTIPOCOB, CODEMPTC, CODFILIALTC,
              CODPLANOPAG,CODEMPPG,CODFILIALPG,CODCLI,
              CODEMPCL,CODFILIALCL,CODVEND,CODEMPVD,CODFILIALVD,TIPOVENDA,CODVENDA,
              CODEMPVA,CODFILIALVA,VLRREC,
              VLRDESCREC,VLRMULTAREC,VLRJUROSREC,VLRPARCREC,VLRPAGOREC,
              VLRAPAGREC,DATAREC,STATUSREC,VLRCOMIREC,DOCREC,CODBANCO,CODEMPBO,CODFILIALBO,
              CODEMPCB, CODFILIALCB, CODCARTCOB, FLAG)
              VALUES (
                     :ICODEMP,:SCODFILIALRC,:ICODREC, :CODTIPOCOB, :ICODEMPTC, :ICODFILIALTC,
                     :CodPlanoPag,:ICODEMPPG,:ICODFILIALPG,:CodCli,
                     :ICODEMPCL,:ICODFILIALCL,:CodVend,:ICODEMPVD,:ICODFILIALVD,:CTIPOVENDA,:ICodVenda,
                     :ICODEMP,:ICODFILIAL,:VlrLiqVenda,
                     0,0,0,:VlrLiqVenda,0,:VlrLiqVenda,:dtSaidaVenda,'R1',
                     :VlrComisVenda,:DocVenda,:CodBanco,:ICODEMPBO,:ICODFILIALBO,
                     :CODEMPCB, :CODFILIALCB, :CODCARTCOB, :FLAG
              );
  END
  ELSE IF (ICODREC IS NOT NULL) THEN
  BEGIN
    IF (IPARCPLANOPAG>0) THEN
    BEGIN
        UPDATE FNRECEBER SET ALTUSUREC='N',
              CODTIPOCOB=:CODTIPOCOB,CODEMPTC=:ICODEMPTC, CODFILIALTC=:ICODFILIALTC,
              CODPLANOPAG=:CodPlanoPag,CODEMPPG=:ICODEMPPG,CODFILIALPG=:ICODFILIALPG,
              CODCLI=:CodCli, CODEMPCL=:ICODEMPCL,CODFILIALCL=:ICODFILIALCL,
              CODVEND=:CodVend,CODEMPVD=:ICODEMPVD,CODFILIALVD=:ICODFILIALVD,
              VLRREC=:VlrLiqVenda,VLRDESCREC=0,VLRMULTAREC=0,VLRJUROSREC=0,
              VLRPARCREC=:VlrLiqVenda,VLRPAGOREC=0,VLRAPAGREC=:VlrLiqVenda,
              DATAREC=:dtSaidaVenda,VLRCOMIREC=:VlrComisVenda,
              /* STATUSREC='R1' */
              DOCREC=:DocVenda,CODBANCO=:CodBanco,CODEMPBO=:ICODEMPBO,
              CODFILIALBO=:ICODFILIALBO,
              CODEMPCB=:CODEMPCB, CODFILIALCB=:CODFILIALCB, CODCARTCOB=:CODCARTCOB, FLAG=:FLAG
             WHERE CODREC=:ICODREC AND CODEMP=:ICODEMP AND CODFILIAL=:SCODFILIALRC;
        UPDATE FNITRECEBER SET ALTUSUITREC='S' /* Atualiza os itens de contas a */
        /* receber para ajustar automaticamente os valores no cabeçalho */
             WHERE CODREC=:ICODREC AND CODEMP=:ICODEMP AND CODFILIAL=:SCODFILIALRC;
     END
     ELSE
     BEGIN
         DELETE FROM FNRECEBER WHERE CODREC=:ICODREC AND CODEMP=:ICODEMP AND
            CODFILIAL=:SCODFILIALRC;
     END
   END

END^


ALTER PROCEDURE FNCHECAPGTOSP (
    ICODCLI INTEGER,
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT)
RETURNS (
    SRETORNO CHAR(1))
AS
DECLARE VARIABLE iLinhas INTEGER;
DECLARE VARIABLE IFILIALRECEBER INTEGER;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'FNRECEBER') INTO IFILIALRECEBER;
  SELECT COUNT(*) FROM FNITRECEBER IT WHERE CODREC
         IN (
            SELECT CODREC FROM FNRECEBER REC WHERE REC.CODCLI = :iCodCli
                   AND REC.CODEMPCL=:ICODEMP AND REC.CODFILIALCL=:ICODFILIAL
                   AND REC.CODREC = IT.CODREC
                   AND CODEMP=IT.CODEMP AND CODFILIAL=IT.CODFILIAL
         )
         AND STATUSITREC != 'RP'
         AND IT.CODEMP=:ICODEMP AND IT.CODFILIAL=:IFILIALRECEBER INTO iLinhas;
  IF (iLinhas > 0) THEN
    sRetorno = 'N';
  ELSE
    sRetorno = 'S';
  SUSPEND;
END^


ALTER PROCEDURE FNDELETARECEBERSP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    CTIPOVENDA CHAR(1),
    ICODVENDA INTEGER)
RETURNS (
    SDELETADO SMALLINT)
AS
DECLARE VARIABLE ICONTADOR INTEGER;
begin
  /* Procedure Text */
  SELECT COUNT(*) FROM FNRECEBER R, FNLANCA L
    WHERE R.CODVENDA=:ICODVENDA AND R.TIPOVENDA=:CTIPOVENDA AND
     R.CODEMPVA=:ICODEMP AND R.CODFILIALVA=:SCODFILIAL AND
     L.CODEMPRC=R.CODEMP AND L.CODFILIALRC=R.CODFILIAL AND
     L.CODREC=R.CODREC
    INTO :ICONTADOR;
  IF (ICONTADOR IS NULL) THEN
     ICONTADOR = 0;
  IF (ICONTADOR=0) THEN
  BEGIN
     SDELETADO = 1;
     DELETE FROM FNRECEBER WHERE CODVENDA=:ICODVENDA AND TIPOVENDA=:CTIPOVENDA AND
       CODEMPVA=:ICODEMP AND CODFILIALVA=:SCODFILIAL;
  END
  ELSE
  BEGIN
     SDELETADO = 0;
  END
  suspend;
end^


ALTER PROCEDURE FNGERAITRECEBERSP01 (
    CALTVLR CHAR(1),
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODREC INTEGER,
    ICODEMPPG INTEGER,
    SCODFILIALPG SMALLINT,
    ICODPLANOPAG INTEGER,
    NVLRREC NUMERIC(15,5),
    DDATAREC DATE,
    CFLAG CHAR(1),
    ICODEMPBO INTEGER,
    SCODFILIALBO SMALLINT,
    CCODBANCO CHAR(3),
    ICODEMPTC INTEGER,
    SCODFILIALTC SMALLINT,
    ICODTIPOCOB INTEGER,
    ICODEMPCB INTEGER,
    SCODFILIALCB SMALLINT,
    CODCARTCOB CHAR(2),
    NVLRCOMIREC NUMERIC(15,5),
    OBSREC VARCHAR(250))
RETURNS (
    I INTEGER)
AS
declare variable nperc numeric(10,6);
declare variable npercpag numeric(10,6);
declare variable nresto numeric(15,5);
declare variable inumparc integer;
declare variable idiaspag integer;
declare variable nrestocomi numeric(15,5);
declare variable nvlrcomiitrec numeric(15,5);
declare variable nvlritrec numeric(15,5);
declare variable regrvcto char(1);
declare variable rvsab char(1);
declare variable rvdom char(1);
declare variable rvfer char(1);
declare variable dtvencto date;
declare variable rvdia char(1);
declare variable dtbase date;
declare variable diavcto smallint;
begin
  /* Procedure Text */
  i = 0;
  nPerc = 100.000000;
  nResto = nVLRREC;
  nRestoComi = nVLRCOMIREC;
  DTBASE = DDATAREC;

  SELECT PARCPLANOPAG, REGRVCTOPLANOPAG, RVSABPLANOPAG, RVDOMPLANOPAG,
     RVFERPLANOPAG, RVDIAPLANOPAG, DIAVCTOPLANOPAG
    FROM FNPLANOPAG WHERE CODPLANOPAG=:iCODPLANOPAG
         AND CODEMP=:iCODEMPPG AND CODFILIAL = :sCODFILIALPG
         INTO :iNumParc, :REGRVCTO, :RVSAB, :RVDOM, :RVFER, :RVDIA, :DIAVCTO;
  FOR SELECT PERCPAG,DIASPAG FROM FNPARCPAG WHERE CODPLANOPAG=:iCODPLANOPAG
             AND CODEMP=:iCODEMPPG AND CODFILIAL = :sCODFILIALPG ORDER BY DIASPAG
             INTO :nPercPag,:iDiasPag DO
  BEGIN
    i = i+1;
    select v.deretorno
        from arreddouble(cast(:nVLRREC*:nPercPag as NUMERIC(15, 5))/:nPerc,2 ) v
       into :nVlrItRec;
    nResto = nResto-nVlrItRec;
    IF (i = iNumParc) THEN
    BEGIN
      nVlrItRec=nVlrItRec+nResto;
    END
    select v.deretorno from
       arreddouble(cast(:nVlrComiRec*:nPercPag as NUMERIC(15, 5))/:nPerc,2) v
       into :nVlrComiItRec;
    nRestoComi = nRestoComi-nVlrComiItRec;
    if (i = iNumParc) then
    begin
      nVlrComiItRec = nVlrComiItRec+nRestoComi;
    end

    SELECT C.DTVENCRET FROM SGCALCVENCSP(:ICODEMP, :DTBASE, :dDATAREC+:iDiasPag, :REGRVCTO,
       :RVSAB, :RVDOM, :RVFER, :RVDIA, :DIAVCTO, :IDIASPAG ) C INTO :DTVENCTO;

    DTBASE = DTVENCTO;

    EXECUTE PROCEDURE fnadicitrecebersp01 (:cALTVLR, :iCODEMP,:sCODFILIAL,:iCODREC,:i,0,0,0,:nVlrItRec,0,
                            :dDATAREC,:DTVENCTO,'R1',:cFLAG,:iCODEMPBO,:sCODFILIALBO,
                            :cCODBANCO, :iCODEMPTC, :sCODFILIALTC, :iCODTIPOCOB,
                            :ICODEMPCB, :SCODFILIALCB, :CODCARTCOB, :NVLRCOMIITREC, :OBSREC);
  END
  suspend;
end^


ALTER PROCEDURE FNITRECEBERSP01 (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODREC INTEGER,
    NVLRPARCREC NUMERIC(15,5),
    NVLRCOMIREC NUMERIC(15,5),
    INROPARCREC INTEGER,
    CCLASCOMIS CHAR(1))
AS
DECLARE VARIABLE INPARCITREC INTEGER;
DECLARE VARIABLE NVLRPARCITREC NUMERIC(15,5);
DECLARE VARIABLE NPERC NUMERIC(10,6);
DECLARE VARIABLE NVLRCOMIITREC NUMERIC(15,5);
DECLARE VARIABLE NRESTO NUMERIC(15,5);
DECLARE VARIABLE DVENCITREC DATE;
begin
  /* Procedure que atualiza a comissão na tabela ITRECEBER */
  nResto = nVlrComiRec;
  FOR SELECT NPARCITREC,VLRPARCITREC,DTVENCITREC FROM FNITRECEBER WHERE CODEMP=:iCodEmp AND
          CODFILIAL=:sCodFilial AND CODREC=:iCodRec
          ORDER BY NPARCITREC
          INTO :iNParcItRec , :nVlrParcItRec, :dVencItRec DO
  BEGIN
     nPerc = nVlrParcItRec/nVlrParcRec;
     nVlrComiItRec = cast( (nVlrComiRec * nPerc) as NUMERIC(15, 5) );
     nResto = nResto - nVlrComiItRec;
     IF (iNParcItRec=iNroParcRec) THEN
     BEGIN
        nVlrComiItRec = nVlrComiItRec + nResto;
     END
     UPDATE FNITRECEBER SET VLRCOMIITREC=:nVlrComiItRec WHERE CODEMP=:iCodEmp AND
          CODFILIAL=:sCodFilial AND CODREC=:iCodRec AND NPARCITREC=:iNParcItRec;
     IF (CCLASCOMIS='S') THEN
        EXECUTE PROCEDURE vdgeracomissaosp(:iCodEmp, :sCodFilial, :iCodRec,
           :iNParcItRec, :nVlrComiItRec, :dVencItRec);
  END
  suspend;
end^


ALTER PROCEDURE FNLIBCREDSP (
    CODEMPVD INTEGER,
    CODFILIALVD INTEGER,
    TIPOVENDA CHAR(1),
    CODVENDA INTEGER,
    CODCLI INTEGER,
    CODEMPCL INTEGER,
    CODFILIALCL INTEGER,
    VLRVENDA NUMERIC(15,5),
    VLRADIC NUMERIC(15,2),
    CODITEM INTEGER)
AS
declare variable prefcred char(1);
declare variable codfilial integer;
declare variable vlrcredito numeric(15,5);
declare variable ecf char(1);
declare variable vlraberto numeric(15,5);
declare variable agrup char(1);
declare variable codempclip integer;
declare variable codfilialclip smallint;
declare variable codclip integer;
declare variable vlrdif numeric(15,2);
declare variable vlrautorizado numeric(15,2);
declare variable vlrpedidoant numeric(15,2);
declare variable vlrautorizadotot numeric(15,2);
begin
    select icodfilial from sgretfilial(:codempcl,'FNLIBCRED') into codfilial;
    select prefcred,lcredglobal from sgprefere1 where codemp=:codempcl and codfilial=:codfilial into prefcred, agrup;

    select first 1 cx.ecfcaixa from pvcaixa cx, sgconexao con, sgestacao est
        where est.codemp=con.codemp and est.codfilial=con.codfilial
            and est.codest=con.codterm AND cx.codfilialet=est.codfilial
            and cx.codempet=est.codemp AND cx.codest=est.codest
            and con.nrconexao=current_connection and conectado > 0
    into ecf;

    if (prefcred = 'N' or ecf='S') then /* Não verificar */
        exit;
    else if (prefcred = 'L') then /*Liberar se não ultrapassar o crédito pré aprovado */
        begin

             if( :coditem is not null and :vlradic is not null  ) then
             begin
                select vi.vlrproditvenda from vditvenda vi where vi.codemp=:codempvd
                and vi.codfilial=:codfilialvd and vi.codvenda=:codvenda
                and vi.tipovenda=:tipovenda and vi.coditvenda=:coditem into :vlrdif;
             end

            vlrvenda = coalesce(vlrvenda,0) + ( coalesce(vlradic,0) - coalesce(:vlrdif,0) );

            /* busca informações do cliente principal */
            select cli.codemppq, cli.codfilialpq, cli.codpesq
                from vdcliente cli
                where cli.codemp=:codempcl and cli.codfilial=:codfilialcl and cli.codcli=:codcli
            into codempclip, codfilialclip, codclip;

            if(agrup = 'S') then /* Verifica se deve agrupar despesas dos sub-clientes */
            begin
                /* BUSCA DE VALORES EM ABERTO */
                select coalesce(sum( (coalesce(it.vlrparcitrec,0)) - (coalesce(it.vlrpagoitrec,0)) ),0)
                    from fnreceber r, vdvenda v,fnitreceber it, vdcliente cl
                    where cl.codemppq=:codempclip and cl.codfilialpq=:codfilialclip and cl.codpesq=:codclip
                        and r.codempcl=cl.codemp and r.codfilialcl=cl.codfilial and r.codcli=cl.codcli
                        and (r.codempvd!=:codempvd or r.codfilialvd!=:codfilialvd or R.codvenda!=:codvenda or R.tipovenda!=:tipovenda) /* não deve contar com a venda atual */
                        and v.codemp=r.codempvd and v.codfilial=v.codfilialvd and v.codvenda=r.codvenda and v.tipovenda=r.tipovenda
                        and it.codemp=r.codemp and it.codfilial=r.codfilial and it.codrec=r.codrec and it.statusitrec not in ('RP')
                into vlraberto;

                /* BUSCA VALOR AUTORIZADO/LIBERADO */
                vlrautorizadotot = 0;
                for select lc.vlrautorizlcred,lc.vlrvendacred
                    from fnlibcred lc
                    where lc.codemp=:codempvd and lc.codfilial=:codfilialvd
                        and lc.codfilialvd=:codfilialvd and lc.codempcl=:codempcl
                        and lc.codfilialcl=:codfilialcl and lc.tipovenda=:tipovenda
                        and lc.codvenda=:codvenda and lc.dtavctolcred >= cast('today' as date)
                into :vlrautorizado, :vlrpedidoant do
                begin
                    vlrautorizadotot = :vlrautorizadotot + :vlrautorizado;
                end

                /* BUSCA DE LIMITE */
                select sum(coalesce(tc.vlrtpcred,0))
                    from fntipocred tc, vdcliente cl
                    where cl.codemppq=:codempclip and cl.codfilial=:codfilialcl and cl.codpesq=:codclip
                        and tc.codtpcred=cl.codtpcred and tc.codemp=cl.codemptr and tc.codfilial=cl.codfilialtr
                        and cast('today' as date) <= cl.dtvenctotr
                into vlrcredito;

                /* VALOR DO CREDITO É A SOMA DO CREDITO PRÉ-FIXADO + O VALOR LIBERADO PARA O PEDIDO*/
                vlrcredito = vlrcredito + vlrautorizadotot;

            end
            else /* Caso não deva agrupar as despesas dos sub-clientes */
            begin

                /* BUSCA DE VALORES EM ABERTO */

                select coalesce(sum( (coalesce(it.vlrparcitrec,0)) - (coalesce(it.vlrpagoitrec,0)) ),0)
                    from fnreceber r, vdvenda v,fnitreceber it, vdcliente cl
                    where cl.codemp=:codempvd and cl.codfilial=:codfilialvd and cl.codcli=:codcli
                        and r.codempcl=cl.codemp and r.codfilialcl=cl.codfilial and r.codcli=cl.codcli
                        and (r.codempvd!=:codempvd or r.codfilialvd!=:codfilialvd or R.codvenda!=:codvenda or R.tipovenda!=:tipovenda) /* não deve contar com a venda atual */
                        and v.codemp=r.codempvd and v.codfilial=v.codfilialvd and v.codvenda=r.codvenda and v.tipovenda=r.tipovenda
                        and it.codemp=r.codemp and it.codfilial=r.codfilial and it.codrec=r.codrec and it.statusitrec not in ('RP')
                into vlraberto;

                /* BUSCA VALOR AUTORIZADO/LIBERADO */
                vlrautorizadotot = 0;
                for select lc.vlrautorizlcred,lc.vlrvendacred
                    from fnlibcred lc
                    where lc.codemp=:codempvd and lc.codfilial=:codfilialvd
                        and lc.codfilialvd=:codfilialvd and lc.codempcl=:codempcl
                        and lc.codfilialcl=:codfilialcl and lc.tipovenda=:tipovenda
                        and lc.codvenda=:codvenda and lc.dtavctolcred >= cast('today' as date)
                into :vlrautorizado, :vlrpedidoant do
                begin
                    vlrautorizadotot = :vlrautorizadotot + :vlrautorizado;
                end

                /* BUSCA DE LIMITE */
                select coalesce(tc.vlrtpcred,0)
                    from fntipocred tc, vdcliente cl
                    where cl.codcli=:codcli and cl.codemp=:codempcl
                        and cl.codfilial=:codfilialcl AND tc.codtpcred=cl.codtpcred
                        and tc.codemp=cl.codemptr and tc.codfilial=cl.codfilialtr
                        and cast('today' as date) <= cl.dtvenctotr
                into vlrcredito;
                
                /* VALOR DO CREDITO É A SOMA DO CREDITO PRÉ-FIXADO + O VALOR LIBERADO PARA O PEDIDO*/
                vlrcredito = vlrcredito + vlrautorizadotot;

            end

            /* CASO JÁ EXISTA UM VALOR AUTORIZADO E O VALOR DO PEDIDO NÃO AUMENTOU, NÃO DEVE BLOQUEAR A VENDA*/
            if(vlrautorizadotot>0 and vlrpedidoant>=vlrvenda) then
            begin
                exit;
            end
            else if (vlrcredito > 0) then
                begin
                    if ( (vlrvenda + vlraberto ) <= vlrcredito) then
                        exit;
                    else
                        exception vdvendaex04 'VENDA:' || cast(vlrvenda as char(15)) || 'AB.: ' || cast(vlraberto as char(15)) || 'CRED.:' || cast(vlrcredito as char(15));
                        /*Valor pre-aprovado insuficiente*/
                end
        end
    suspend;
end^


ALTER PROCEDURE FNSALDOPLANSP (
    ICODEMPPN INTEGER,
    ICODFILIALPN INTEGER,
    SCODPLANANT CHAR(13),
    DDATAANT DATE,
    DVLRANT NUMERIC(15,5),
    SCODPLANATU CHAR(13),
    DDATAATU DATE,
    DVLRATU NUMERIC(15,5))
RETURNS (
    SRETORNO CHAR(1))
AS
DECLARE VARIABLE sCodPlan CHAR(13);
  DECLARE VARIABLE dDataSl DATE;
  DECLARE VARIABLE dTmp DATE;
  DECLARE VARIABLE dSaldoSl NUMERIC(15, 5);
  DECLARE VARIABLE dSaldoSlAnt NUMERIC(15, 5);
  DECLARE VARIABLE IFILIALSALDO INTEGER;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMPPN,'FNSALDOLANCA') INTO IFILIALSALDO;
  IF (dVlrAnt IS NULL) THEN
     dVlrAnt = 0;
  IF (dVlrAtu IS NULL) THEN
     dVlrAtu = 0;
  IF ((sCodPlanAnt IS NOT NULL) AND (rtrim(sCodPlanAnt) != '')) THEN
  BEGIN
    SELECT CODPLAN,DATASL,SALDOSL FROM FNSALDOLANCA WHERE CODPLAN=:sCodPlanAnt
           AND DATASL =: dDataAnt AND CODEMP=:ICODEMPPN AND CODFILIAL=:IFILIALSALDO
           AND CODEMP=:ICODEMPPN AND CODFILIAL=:ICODFILIALPN INTO sCodPlan,dDataSl,dSaldoSl;
    IF ((sCodPlan = sCodPlanAnt) AND (dDataSl = dDataAnt)) THEN
    BEGIN
      UPDATE FNSALDOLANCA SET SALDOSL =:dSaldoSl-:dVlrAnt WHERE CODPLAN=:sCodPlanAnt
             AND DATASL =:dDataAnt AND CODEMP=:ICODEMPPN AND CODFILIAL=:IFILIALSALDO
             AND CODEMP=:ICODEMPPN AND CODFILIAL=:ICODFILIALPN;
      FOR SELECT DATASL,SALDOSL FROM FNSALDOLANCA WHERE CODPLAN=:sCodplanAnt
          AND DATASL >:dDataAnt AND CODEMP=:ICODEMPPN AND CODFILIAL=:IFILIALSALDO
          AND CODEMP=:ICODEMPPN AND CODFILIAL=:ICODFILIALPN INTO :dTmp,:dSaldoSlAnt DO
      BEGIN
         if (:dSaldoSlAnt IS NULL) THEN
            dSaldoSlAnt = 0;
         UPDATE FNSALDOLANCA SET SALDOSL = :dSaldoSlAnt-:dVlrAnt WHERE CODPLAN=:sCodplanAnt
                AND DATASL =:dTmp AND CODEMP=:ICODEMPPN AND CODFILIAL=:IFILIALSALDO
                AND CODEMP=:ICODEMPPN AND CODFILIAL=:ICODFILIALPN;
        SUSPEND;
      END
    END
    ELSE
    BEGIN
      SELECT SALDOSL FROM FNSALDOLANCA WHERE CODPLAN=:sCodPlanAnt
             AND DATASL<:dDataAnt AND CODEMP=:ICODEMPPN AND CODFILIAL=:IFILIALSALDO
             AND CODEMP=:ICODEMPPN AND CODFILIAL=:ICODFILIALPN INTO dSaldoSlAnt;
      IF (dSaldoSlAnt IS NULL) THEN
          dSaldoSlAnt = 0;
      INSERT INTO FNSALDOLANCA (CODEMP,CODFILIAL,CODPLAN,CODFILIALPN,CODEMPPN,DATASL,PREVSL,SALDOSL)
             VALUES (
                    :ICODEMPPN,:IFILIALSALDO,:sCodPlanAnt,:ICODEMPPN,:ICODFILIALPN,:dDataAnt,0,:dSaldoSlAnt-:dVlrAnt
             );
      FOR SELECT DATASL,SALDOSL FROM FNSALDOLANCA WHERE CODPLAN=:sCodplanAnt
                 AND DATASL >:dDataAnt AND CODEMP=:ICODEMPPN AND CODFILIAL=:IFILIALSALDO
                 AND CODEMP=:ICODEMPPN AND CODFILIAL=:ICODFILIALPN INTO :dTmp,:dSaldoSlAnt DO
      BEGIN
        if (:dSaldoSlAnt IS NULL) THEN
           dSaldoSlAnt = 0;
        UPDATE FNSALDOLANCA SET SALDOSL = :dSaldoSlAnt-:dVlrAnt WHERE CODPLAN=:sCodplanAnt
               AND DATASL =:dTmp AND CODEMP=:ICODEMPPN AND CODFILIAL=:IFILIALSALDO
               AND CODEMP=:ICODEMPPN AND CODFILIAL=:ICODFILIALPN;
        SUSPEND;
      END
    END
  END
  IF ( (sCodPlanAtu IS NOT NULL) AND (rtrim(sCodPlanAtu) != '')) THEN
  BEGIN
    SELECT CODPLAN,DATASL,SALDOSL FROM FNSALDOLANCA WHERE CODPLAN=:sCodPlanAtu
           AND DATASL =: dDataAtu AND CODEMP=:ICODEMPPN AND CODFILIAL=:IFILIALSALDO
  AND CODEMP=:ICODEMPPN AND CODFILIAL=:ICODFILIALPN INTO sCodPlan,dDataSl,dSaldoSl;
    IF ((sCodPlan = sCodPlanAtu) AND (dDataSl = dDataAtu)) THEN
    BEGIN
      UPDATE FNSALDOLANCA SET SALDOSL =:dSaldoSl+:dVlrAtu WHERE CODPLAN=:sCodPlanAtu
             AND DATASL =:dDataAtu AND CODEMP=:ICODEMPPN AND CODFILIAL=:IFILIALSALDO
             AND CODEMP=:ICODEMPPN AND CODFILIAL=:ICODFILIALPN;
      FOR SELECT DATASL,SALDOSL FROM FNSALDOLANCA WHERE CODPLAN=:sCodplanAtu
                 AND DATASL >:dDataAtu AND CODEMP=:ICODEMPPN AND CODFILIAL=:IFILIALSALDO
                 AND CODEMP=:ICODEMPPN AND CODFILIAL=:ICODFILIALPN INTO :dTmp,:dSaldoSlAnt DO
      BEGIN
        if (:dSaldoSlAnt IS NULL) THEN
           dSaldoSlAnt = 0;
        UPDATE FNSALDOLANCA SET SALDOSL = :dSaldoSlAnt+:dVlrAtu WHERE CODPLAN=:sCodplanAtu
               AND DATASL =:dTmp AND CODEMP=:ICODEMPPN AND CODFILIAL=:IFILIALSALDO
               AND CODEMP=:ICODEMPPN AND CODFILIAL=:ICODFILIALPN;
        SUSPEND;
      END
    END
    ELSE
    BEGIN
      SELECT SALDOSL FROM FNSALDOLANCA WHERE CODPLAN=:sCodPlanAtu
             AND DATASL<:dDataAtu AND CODEMP=:ICODEMPPN AND CODFILIAL=:IFILIALSALDO
             AND CODEMP=:ICODEMPPN AND CODFILIAL=:ICODFILIALPN INTO dSaldoSlAnt;
      IF (dSaldoSlAnt IS NULL) THEN
          dSaldoSlAnt = 0;
      INSERT INTO FNSALDOLANCA (CODEMP,CODFILIAL,CODPLAN,CODEMPPN,CODFILIALPN,DATASL,PREVSL,SALDOSL)
             VALUES (
                    :ICODEMPPN,:IFILIALSALDO,:sCodPlanAtu,:ICODEMPPN,:ICODFILIALPN,:dDataAtu,0,:dSaldoSlAnt+:dVlrAtu
             );
      FOR SELECT DATASL,SALDOSL FROM FNSALDOLANCA WHERE CODPLAN=:sCodplanAtu
                 AND DATASL >:dDataAtu AND CODEMP=:ICODEMPPN AND CODFILIAL=:IFILIALSALDO
                 AND CODEMP=:ICODEMPPN AND CODFILIAL=:ICODFILIALPN INTO :dTmp,:dSaldoSlAnt DO
      BEGIN
        if (:dSaldoSlAnt IS NULL) THEN
           dSaldoSlAnt = 0;
        UPDATE FNSALDOLANCA SET SALDOSL = :dSaldoSlAnt+:dVlrAtu WHERE CODPLAN=:sCodplanAtu
               AND DATASL =:dTmp AND CODEMP=:ICODEMPPN AND CODFILIAL=:IFILIALSALDO
               AND CODEMP=:ICODEMPPN AND CODFILIAL=:ICODFILIALPN;
        SUSPEND;
      END
    END
  END
  SUSPEND;
END^


ALTER PROCEDURE GERAVISITASSP (
    NUMVISITAS INTEGER,
    TIPOVISITA CHAR(10),
    CODATEND INTEGER,
    CODFILIALATEND INTEGER,
    CODEMPATEND INTEGER,
    CODCLI INTEGER,
    CODFILIALCLI INTEGER,
    CODEMPCLI INTEGER,
    DATA DATE)
AS
begin
INSERT INTO tkhistorico (CODEMP,CODFILIAL,CODHISTTK,DESCHISTTK,SITHISTTK,DATAHISTTK,HORAHISTTK,CODEMPCL,CODFILIALCL,CODCLI,CODEMPAE,CODFILIALAE,CODATEND,TIPOHISTTK)
VALUES(4,1,coalesce((SELECT MAX(CODHISTTK) from tkhistorico)+1,1),'VISITA','EF',:DATA,(CAST('now' AS TIME)),:CODEMPCLI,:CODFILIALCLI,:CODCLI,:CODEMPATEND,:CODFILIALATEND,:CODATEND,:TIPOVISITA);
suspend;
end^


ALTER PROCEDURE LFBUSCAFISCALSP (
    FILIALATUAL INTEGER,
    CODEMP INTEGER,
    CODFILIAL INTEGER,
    CODPROD INTEGER,
    CODEMPCL INTEGER,
    CODFILIALCL INTEGER,
    CODCLI INTEGER,
    CODEMPTM INTEGER,
    CODFILIALTM SMALLINT,
    CODTIPOMOV INTEGER)
RETURNS (
    ORIGFISC CHAR(1),
    CODTRATTRIB CHAR(2),
    REDFISC NUMERIC(9,2),
    TIPOFISC CHAR(2),
    CODMENS INTEGER,
    ALIQFISC NUMERIC(9,2),
    ALIQIPIFISC NUMERIC(9,2),
    TPREDICMSFISC CHAR(1))
AS
declare variable noestcli char(1);
declare variable codfisccli integer;
declare variable codempfc integer;
declare variable codfilialfc integer;
declare variable ufcliente char(2);
declare variable ibgecli char(1);
declare variable uffilial char(2);
begin

    select coalesce(p1.usaibgecli,'N') from sgprefere1 p1 into :ibgecli;

    /*Caso utilize o cadastro do IBGE para Estados e municipios*/
    if(ibgecli='S') then
    begin
        select siglauf,codempfc,codfilialfc,codfisccli
        from vdcliente
        where codemp=:codempcl and codfilial=:codfilialcl and codcli=:codcli
        into ufcliente,codempfc,codfilialfc,codfisccli;
    end
    /*Caso não utilize o cadastro do IBGE para Estados e municipios*/
    else
    begin
        select ufcli,codempfc,codfilialfc,codfisccli
        from vdcliente
        where codemp=:codempcl and codfilial=:codfilialcl and codcli=:codcli
        into ufcliente,codempfc,codfilialfc,codfisccli;
    end
    /*Busca o estado da Filial*/
    select siglauf from sgfilial where codemp=:codemp and codfilial=:codfilial
    into uffilial;

    /*Compara estado da filial com estado do cliente*/
    if(uffilial=ufcliente) then
    begin
        NOESTCLI='S';
    end
    else
    begin
        NOESTCLI='N';
    end

    /*Primeira busca, mais específica para o tipo fiscal do cliente*/
    for select it.origfisc,it.codtrattrib,it.redfisc,it.aliqfisc,it.tipofisc,it.codmens,it.aliqipifisc,it.tpredicmsfisc
        from lfitclfiscal it, eqproduto p
        where p.codprod=:codprod and p.codfilial=:codfilial and p.codemp=:codemp and it.codemp=p.codempfc
            and it.codfilial=p.codfilialfc and it.codfisc=p.codfisc and it.noufitfisc=:noestcli
            and (((it.codtipomov=:codtipomov and it.codemptm=:codemptm and it.codfilial=:codfilialtm) or (it.codtipomov is null))
            and   (it.codfisccli=:codfisccli and it.codempfc=:codempfc and it.codfilialfc=:codfilialfc))
        order by it.coditfisc
    into origfisc,codtrattrib,redfisc,aliqfisc,tipofisc,codmens,aliqipifisc,tpredicmsfisc do
    begin
        suspend;
        exit;
    end

/*Segunda busca, mais genérica, pega exceções sem tipo de movimento e tipo fiscal do cliente,
  só é executada quando a SELECT acima não retornar nenhum valor. */
  FOR SELECT IT.ORIGFISC,IT.CODTRATTRIB,IT.REDFISC,IT.ALIQFISC,
    IT.TIPOFISC,IT.CODMENS,IT.ALIQIPIFISC, IT.TPREDICMSFISC
  FROM LFITCLFISCAL IT, EQPRODUTO P WHERE P.CODPROD=:CODPROD
  AND P.CODFILIAL=:CODFILIAL AND P.CODEMP=:CODEMP
  AND IT.CODEMP=P.CODEMPFC AND IT.CODFILIAL=P.CODFILIALFC
  AND IT.CODFISC=P.CODFISC AND IT.NOUFITFISC=:NOESTCLI
  AND ((IT.CODTIPOMOV=:CODTIPOMOV AND IT.CODEMPTM=:CODEMPTM AND IT.CODFILIAL=:CODFILIALTM) OR
       (IT.CODFISCCLI=:CODFISCCLI AND IT.CODEMPFC=:CODEMPFC AND IT.CODFILIALFC=:CODFILIALFC) OR
       (IT.CODFISCCLI IS NULL AND IT.CODTIPOMOV IS NULL))
  ORDER BY IT.CODITFISC
 INTO ORIGFISC,CODTRATTRIB,REDFISC,ALIQFISC,TIPOFISC,CODMENS, ALIQIPIFISC, TPREDICMSFISC DO
 BEGIN
/*   EXCEPTION VDVENDAEX01; */
   SUSPEND;
   EXIT;
 END

/*Terceira busca, mais genérica, sem filtros por tipo de movimento e tipo fiscal.
  só é executada quando as SELECTS acima não retornarem nenhum valor.*/

 SELECT F.ORIGFISC,F.CODTRATTRIB,F.REDFISC,F.ALIQFISC,F.TIPOFISC, F.ALIQIPIFISC, F.TPREDICMSFISC
  FROM LFCLFISCAL F, EQPRODUTO P WHERE P.CODPROD=:CODPROD
  AND P.CODFILIAL=:CODFILIAL AND P.CODEMP=:CODEMP
  AND F.CODEMP=P.CODEMPFC AND F.CODFILIAL=P.CODFILIALFC AND F.CODFISC=P.CODFISC
 INTO ORIGFISC,CODTRATTRIB,REDFISC,ALIQFISC,TIPOFISC, ALIQIPIFISC, TPREDICMSFISC;
 SUSPEND;
END^


ALTER PROCEDURE LFBUSCAICMSSP (
    CODNAT CHAR(4),
    ESTCLI CHAR(2),
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT)
RETURNS (
    PERCICMS NUMERIC(9,2))
AS
DECLARE VARIABLE EstEmp CHAR(2);
BEGIN
  SELECT UFFILIAL FROM SGFILIAL WHERE CODEMP=:ICODEMP
    AND CODFILIAL=:ICODFILIAL INTO :EstEmp;
  IF (EstCli = EstEmp) then
    SELECT ALIQENAT FROM LFNATOPER WHERE CODNAT=:CodNat
           AND CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL INTO :PercICMS;
  ELSE
  BEGIN
    SELECT TI.ALIQTI FROM LFTABICMS TI, LFITNATOPER INO WHERE
      TI.CODEMP = INO.CODEMPTI AND TI.CODFILIAL=INO.CODFILIALTI
      AND TI.UFTI = INO.UFTI AND INO.CODEMP=:ICODEMP AND
      INO.CODFILIAL=:ICODFILIAL AND INO.CODNAT=:CodNat AND
      INO.UFTI=:EstCli INTO :PercICMS;
    IF (PercICMS IS NULL) THEN
      SELECT ALIQFNAT FROM LFNATOPER WHERE CODNAT=:CodNat
        AND CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL INTO :PercICMS;
  END
  SUSPEND;
END^


ALTER PROCEDURE LFBUSCANATSP (
    FILIALATUAL INTEGER,
    CODEMP INTEGER,
    CODFILIAL INTEGER,
    CODPROD INTEGER,
    CODEMPCL INTEGER,
    CODFILIALCL INTEGER,
    CODCLI INTEGER,
    CODEMPFR INTEGER,
    CODFILIALFR INTEGER,
    CODFOR INTEGER,
    CODFILIALTM SMALLINT,
    CODTIPOMOV INTEGER)
RETURNS (
    CODNAT CHAR(4))
AS
declare variable noest char(1);
declare variable cv char(1);
declare variable itmp integer;
BEGIN
 IF (CODFOR IS NULL) THEN
 BEGIN
  SELECT COUNT(F.SIGLAUF) FROM SGFILIAL F, VDCLIENTE C
   WHERE F.CODEMP=:CODEMP AND F.CODFILIAL=:FILIALATUAL
   AND C.CODCLI=:CODCLI AND C.CODEMP=:CODEMPCL
   AND C.CODFILIAL=:CODFILIALCL AND F.SIGLAUF=C.UFCLI INTO ITMP;
  CV = 'V';
 END
 ELSE
 BEGIN
  SELECT COUNT(F.SIGLAUF) FROM SGFILIAL F, CPFORNECED FO
   WHERE F.CODEMP=:CODEMP AND F.CODFILIAL=:FILIALATUAL
   AND FO.CODFOR=:CODFOR AND FO.CODEMP=:CODEMPFR
   AND FO.CODFILIAL=:CODFILIALFR AND F.SIGLAUF=FO.UFFOR INTO ITMP;
  CV = 'C';
 END

 IF (ITMP > 0) THEN
  NOEST='S';
 ELSE
  NOEST='N';

 SELECT FIRST 1 R.CODNAT FROM EQPRODUTO P, LFITREGRAFISCAL R, LFCLFISCAL C WHERE
   P.CODPROD=:CODPROD AND P.CODFILIAL=:CODFILIAL AND P.CODEMP=:CODEMP
   AND C.CODFISC = P.CODFISC AND C.CODFILIAL = P.CODFILIALFC
   AND C.CODEMP = P.CODEMPFC AND R.CODREGRA = C.CODREGRA
   AND R.CODFILIAL = C.CODFILIALRA AND R.CODEMP = C.CODEMPRA
   AND R.CODEMPTM=:CODEMP AND R.CODFILIALTM=:CODFILIALTM AND
   R.CODTIPOMOV=:CODTIPOMOV AND R.CVITRF=:CV AND NOUFITRF=:NOEST
 INTO CODNAT;
 IF (CODNAT IS NULL) THEN
 BEGIN
   SELECT FIRST 1 R.CODNAT FROM EQPRODUTO P, LFITREGRAFISCAL R, LFCLFISCAL C WHERE
     P.CODPROD=:CODPROD AND P.CODFILIAL=:CODFILIAL AND P.CODEMP=:CODEMP
     AND C.CODFISC = P.CODFISC AND C.CODFILIAL = P.CODFILIALFC
     AND C.CODEMP = P.CODEMPFC AND R.CODREGRA = C.CODREGRA
     AND R.CODFILIAL = C.CODFILIALRA AND R.CODEMP = C.CODEMPRA
     AND R.CVITRF=:CV AND NOUFITRF=:NOEST
   INTO CODNAT;
 END
 SUSPEND;

END^


ALTER PROCEDURE LFNOVODOCSP (
    SSERIE CHAR(4),
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT)
RETURNS (
    DOC INTEGER)
AS
BEGIN
  SELECT DOCSERIE FROM LFSERIE WHERE SERIE=:sSerie
         AND CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL INTO :Doc;
  IF ((Doc IS NULL) OR (Doc = 0)) THEN
    Doc = 1;
  ELSE
    Doc = Doc + 1;
  UPDATE LFSERIE SET DOCSERIE=:Doc WHERE SERIE=:sSerie
         AND CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL;
  SUSPEND;
END^


ALTER PROCEDURE PPATUDISTOPSP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODOP INTEGER,
    SSEQOP SMALLINT,
    NQTDDISTOLD NUMERIC(15,5),
    NQTDDISTNEW NUMERIC(15,5))
AS
begin
  if (NQTDDISTOLD is null) then
     NQTDDISTOLD = 0;
  if (NQTDDISTNEW is null) then
     NQTDDISTNEW = 0;
  if (NQTDDISTOLD!=NQTDDISTNEW) then
     UPDATE PPOP SET QTDDISTPOP = QTDDISTPOP + (:NQTDDISTNEW-:NQTDDISTOLD)
        WHERE CODEMP=:ICODEMP AND CODFILIAL=:SCODFILIAL AND
          CODOP=:ICODOP AND SEQOP=:SSEQOP ;
  suspend;
end^


ALTER PROCEDURE PPCUSTOPRODSP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODPROD INTEGER,
    DTESTOQ DATE,
    CTIPOCUSTO CHAR(1),
    ICODEMPAX INTEGER,
    SCODFILIALAX SMALLINT,
    ICODALMOX INTEGER,
    CCOMSALDO CHAR(10))
RETURNS (
    CUSTOUNIT NUMERIC(15,5),
    SLDPROD NUMERIC(15,5))
AS
DECLARE VARIABLE QTDITEST NUMERIC(15,5);
DECLARE VARIABLE SEQEST SMALLINT;
DECLARE VARIABLE TIPOPROD CHAR(1);
DECLARE VARIABLE CUSTOTOT NUMERIC(15,5);
DECLARE VARIABLE CODPRODPD INTEGER;
begin
  /* Retorna o custo unitário do produto */
  IF (CTIPOCUSTO IS NULL) then
     CTIPOCUSTO = 'P';

  SELECT P.TIPOPROD
   FROM EQPRODUTO P
   WHERE P.CODEMP = :ICODEMP AND P.CODFILIAL = :SCODFILIAL AND
      P.CODPROD=:ICODPROD
   INTO :TIPOPROD;

  IF (TIPOPROD='F') THEN
  BEGIN
     SELECT SLDPROD FROM EQCUSTOPRODSP(:ICODEMP, :SCODFILIAL, :ICODPROD,
        :DTESTOQ, :CTIPOCUSTO,  :ICODEMPAX, :SCODFILIALAX, :ICODALMOX, 'N')
     INTO :SLDPROD;

     CUSTOTOT = 0;

     SELECT FIRST 1 E.SEQEST FROM PPESTRUTURA E
       WHERE E.CODEMP=:ICODEMP AND E.CODFILIAL=:SCODFILIAL AND E.CODPROD=:ICODPROD
       ORDER BY E.SEQEST INTO :SEQEST;

     FOR SELECT I.CODPRODPD,I.QTDITEST FROM  PPITESTRUTURA I
        WHERE I.CODEMP=:ICODEMP AND I.CODFILIAL=:SCODFILIAL AND
          I.CODPROD=:ICODPROD AND I.SEQEST=:SEQEST
        INTO :CODPRODPD, :QTDITEST DO
     BEGIN
         SELECT CUSTOUNIT FROM PPCUSTOPRODSP(:ICODEMP, :SCODFILIAL, :CODPRODPD, :DTESTOQ,
            :CTIPOCUSTO, :ICODEMPAX, :SCODFILIALAX, :ICODALMOX, :CCOMSALDO)
         INTO :CUSTOUNIT;
         CUSTOTOT = CUSTOTOT + ( CUSTOUNIT * QTDITEST)  ;
     END
  END
  ELSE
  BEGIN
     SELECT CUSTOUNIT,SLDPROD FROM EQCUSTOPRODSP(:ICODEMP, :SCODFILIAL, :ICODPROD,
        :DTESTOQ, :CTIPOCUSTO,  :ICODEMPAX, :SCODFILIALAX, :ICODALMOX, 'N')
     INTO :CUSTOTOT, :SLDPROD;
  END
  CUSTOUNIT = CUSTOTOT;
  SUSPEND;
end^


ALTER PROCEDURE PPGERAOPCQ (
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT,
    ICODOP INTEGER,
    ISEQOP SMALLINT)
AS
DECLARE VARIABLE ISEQEF SMALLINT;
DECLARE VARIABLE ISEQOPCQ SMALLINT;
DECLARE VARIABLE ICODEMPEA INTEGER;
DECLARE VARIABLE ICODFILIALEA SMALLINT;
DECLARE VARIABLE ICODESTANALISE INTEGER;
DECLARE VARIABLE ICODEMPFS INTEGER;
DECLARE VARIABLE ICODFILIALFS SMALLINT;
DECLARE VARIABLE ICODFASE INTEGER;
BEGIN

    SELECT COALESCE(MAX(SEQOPCQ),0)
        FROM PPOPCQ
            WHERE CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL
                AND CODOP=:ICODOP AND SEQOP=:ISEQOP
    INTO :ISEQOPCQ;

    FOR
        SELECT EA.SEQEF, EA.CODEMPFS, EA.CODFILIALFS, EA.CODFASE,
            EA.codemp,EA.codfilial,EA.codestanalise
            FROM PPESTRUANALISE EA, PPOP O, PPESTRUTURA E
            WHERE O.CODEMP=:iCodEmp AND O.CODFILIAL=:iCodFilial
                AND O.CODOP=:iCodOp AND O.SEQOP=:iSEQOP AND E.CODEMP=O.CODEMPPD
                AND E.CODFILIAL=O.CODFILIALPD AND E.CODPROD=O.CODPROD AND E.SEQEST=O.SEQEST
                AND EA.CODEMP=E.CODEMP AND EA.CODFILIAL=E.CODFILIAL AND EA.CODPROD=E.CODPROD
                AND EA.SEQEST=E.SEQEST
        INTO :iSeqEf, :iCodEmpFs, :iCodFilialFs, :iCodFase,
             :ICODEMPEA,:ICODFILIALEA,:ICODESTANALISE
    DO
    BEGIN
        ISEQOPCQ = :ISEQOPCQ + 1;
        INSERT INTO PPOPCQ (CODEMP,CODFILIAL,CODOP,SEQOP,SEQOPCQ,
            CODEMPEA,CODFILIALEA,CODESTANALISE)
            VALUES (:iCodEmp,:iCodFilial,:iCodOp,:iSeqOp, :ISEQOPCQ,:ICODEMPEA,
                    :ICODFILIALEA,:ICODESTANALISE);
    END
   SUSPEND;
END^


ALTER PROCEDURE PPITOPSP01 (
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT,
    ICODOP INTEGER,
    ISEQOP SMALLINT)
AS
DECLARE VARIABLE ICODEMPPD INTEGER;
DECLARE VARIABLE ICODFILIALPD SMALLINT;
DECLARE VARIABLE GERARMA CHAR(1);
DECLARE VARIABLE CREFPROD CHAR(13);
DECLARE VARIABLE ISEQITEST SMALLINT;
DECLARE VARIABLE ICODPRODPD INTEGER;
DECLARE VARIABLE NQTDITOP NUMERIC(15,5);
DECLARE VARIABLE ICODEMPLE INTEGER;
DECLARE VARIABLE ICODFILIALLE SMALLINT;
DECLARE VARIABLE CCODLOTE VARCHAR(20);
DECLARE VARIABLE ICODEMPFS INTEGER;
DECLARE VARIABLE ICODFILIALFS SMALLINT;
DECLARE VARIABLE ICODFASE INTEGER;
DECLARE VARIABLE ICODEMPTR INTEGER;
DECLARE VARIABLE ICODFILIALTR SMALLINT;
DECLARE VARIABLE ICODTPREC INTEGER;
DECLARE VARIABLE ICODEMPRP INTEGER;
DECLARE VARIABLE ICODFILIALRP SMALLINT;
DECLARE VARIABLE ICODRECP INTEGER;
DECLARE VARIABLE DTEMPOOF NUMERIC(15,5);
DECLARE VARIABLE ISEQOF SMALLINT;
DECLARE VARIABLE ISEQPPITOP INTEGER;
DECLARE VARIABLE QTDITEST NUMERIC(15,5);
DECLARE VARIABLE QTDEST NUMERIC(15,5);
DECLARE VARIABLE QTDPREVPRODOP NUMERIC(15,5);
DECLARE VARIABLE QTDFIXA CHAR(1);
BEGIN
   FOR SELECT EF.SEQEF, EF.CODEMPFS, EF.CODFILIALFS, EF.CODFASE,
      EF.CODEMPTR, EF.CODFILIALTR, EF.CODTPREC, EF.TEMPOEF
      FROM PPESTRUFASE EF, PPOP O, PPESTRUTURA E
      WHERE O.CODEMP=:iCodEmp AND O.CODFILIAL=:iCodFilial AND
       O.CODOP=:iCodOp AND O.SEQOP=:iSEQOP AND E.CODEMP=O.CODEMPPD AND
       E.CODFILIAL=O.CODFILIALPD AND
       E.CODPROD=O.CODPROD AND E.SEQEST=O.SEQEST AND
       EF.CODEMP=E.CODEMP AND EF.CODFILIAL=E.CODFILIAL AND
       EF.CODPROD=E.CODPROD AND EF.SEQEST=E.SEQEST
       INTO :iSeqOf, :iCodEmpFs, :iCodFilialFs, :iCodFase,
         :iCodEmpTr, :iCodFilialTr, :iCodTpRec, :dTempoOf
         DO
   BEGIN
       SELECT FIRST 1 CODEMP,CODFILIAL,CODRECP FROM PPRECURSO R
         WHERE R.CODEMP=:iCodEmpTr AND R.CODFILIAL=:iCodFilialTr AND
           R.CODTPREC=:iCodTpRec
         INTO :iCodEmpRp, :iCodFilialRp, :iCodRecP;

       INSERT INTO PPOPFASE (CODEMP,CODFILIAL,CODOP,SEQOP,SEQOF,CODEMPFS,
          CODFILIALFS,CODFASE,CODEMPRP,CODFILIALRP,CODRECP,TEMPOOF,
          CODEMPTR, CODFILIALTR, CODTPREC)
          VALUES (:iCodEmp,:iCodFilial,:iCodOp,:iSeqOp, :iSeqOf,:iCodEmpFs,
          :iCodFilialFs,:iCodFase,:iCodEmpRp,:iCodFilialRp,:iCodRecP,:dTempoOf,
          :iCodEmpTr, :iCodFilialTr, :iCodTpRec);
   END

   ISEQPPITOP = 0;

   FOR SELECT IE.CODEMPPD,IE.CODFILIALPD,IE.SEQITEST,IE.CODPRODPD,IE.REFPRODPD,
     IE.RMAAUTOITEST,IE.CODEMPFS,IE.CODFILIALFS,IE.CODFASE,
     IE.QTDITEST,E.QTDEST,O.QTDPREVPRODOP,IE.QTDFIXA,
     (SELECT MIN(L.CODLOTE) FROM EQLOTE L WHERE
     L.CODEMP=E.CODEMP AND L.CODFILIAL=E.CODFILIAL AND
     L.CODPROD=E.CODPROD AND L.SLDLIQLOTE>0 AND L.VENCTOLOTE =
     ( SELECT MIN(LS.VENCTOLOTE) FROM EQLOTE LS WHERE LS.CODPROD=L.CODPROD
     AND LS.CODFILIAL=L.CODFILIAL AND LS.CODEMP=L.CODEMP AND LS.SLDLIQLOTE>0)) CODLOTE
     FROM PPITESTRUTURA IE, PPESTRUTURA E, PPOP O
     WHERE IE.CODEMP=E.CODEMP AND IE.CODFILIAL=E.CODFILIAL AND
     IE.CODPROD=E.CODPROD AND IE.SEQEST=E.SEQEST AND
     O.CODEMPPD=E.CODEMP AND O.CODFILIALPD=E.CODFILIAL AND
     O.CODPROD=E.CODPROD AND O.SEQEST=E.SEQEST AND
     O.CODEMP=:iCodEmp AND O.CODFILIAL=:iCodFilial AND
     O.CODOP=:iCodOp AND O.SEQOP=:iSeqOp
     ORDER BY CODFASE
     INTO :iCodEmpPd, :iCodFilialPd, :iSeqItEst, :iCodProdPd,:CREFPROD,
      :GERARMA, :iCodEmpFs, :iCodFilialFs, :iCodFase,
      :QTDITEST,:QTDEST,:QTDPREVPRODOP,:QTDFIXA,:cCodLote DO
   BEGIN
     IF (:cCodLote IS NULL ) then
     BEGIN
       iCodEmpLe = null;
       iCodFilialLe = null;
     END
     ELSE
     BEGIN
       iCodEmpLe = iCodEmpPd;
       iCodFilialLe = iCodFilialPd;
     END

     ISEQPPITOP = :ISEQPPITOP + 1;

     IF ('S'=QTDFIXA) THEN
     BEGIN                  
       nQtdItOp = :QTDITEST;
     END
     ELSE                
       nQtdItOp = CAST(:QTDITEST/:QTDEST AS NUMERIC(15,5) )*CAST(:QTDPREVPRODOP AS NUMERIC(15, 5));
     BEGIN

     END

     INSERT INTO PPITOP (CODEMP,CODFILIAL,CODOP,SEQOP,SEQITOP,CODEMPPD,CODFILIALPD,
        CODPROD,REFPROD,CODEMPFS,CODFILIALFS,CODFASE,QTDITOP,GERARMA)
        VALUES (:iCodEmp, :iCodFilial, :iCodOp, :iSeqOp, :ISEQPPITOP, :iCodEmpPd, :iCodFilialPd,
        :iCodProdPd, :CREFPROD,:iCodEmpFs, :iCodFilialFs, :iCodFase, :nQtdItOp,:GERARMA);

   END
   SUSPEND;
END^


ALTER PROCEDURE PPITOPSP02 (
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT,
    ICODOP INTEGER,
    ISEQOP SMALLINT)
AS
DECLARE VARIABLE NQTDITOP NUMERIC(15,5);
DECLARE VARIABLE ICODPRODPD INTEGER;
DECLARE VARIABLE ISEQITOP SMALLINT;
DECLARE VARIABLE ICODEMPPD INTEGER;
DECLARE VARIABLE ISEQPPITOP SMALLINT;
BEGIN
    FOR SELECT It.seqitop,
        CAST( IE.QTDITEST / E.QTDEST AS NUMERIC(15,5) ) * CAST(O.QTDFINALPRODOP AS NUMERIC(15, 5))
        FROM PPITESTRUTURA IE, PPESTRUTURA E, PPOP O, PPITOP IT
            WHERE IE.CODEMP=E.CODEMP AND IE.CODFILIAL=E.CODFILIAL AND
                IE.CODPROD=E.CODPROD AND IE.SEQEST=E.SEQEST AND
                O.CODEMPPD=E.CODEMP AND O.CODFILIALPD=E.CODFILIAL AND
                O.CODPROD=E.CODPROD AND O.SEQEST=E.SEQEST AND
                O.CODEMP=:ICODEMP AND O.CODFILIAL=:ICODFILIAL AND
                O.CODOP=:ICODOP AND O.SEQOP=:ISEQOP AND
                IT.codemp=O.CODEMP AND IT.CODFILIAL=O.CODFILIAL AND
                IT.codop=O.CODOP AND IT.seqop=O.seqop AND
                IE.codempfs=IT.codempfs AND IE.codfilial=IT.codfilialfs AND
                IE.codfase=IT.codfase and
                ie.codemppd=it.codemp and ie.codfilialpd=it.codfilial and
                ie.codprodpd=it.codprod and
                IE.qtdvariavel = 'S'
            INTO :ISEQITOP,:NQTDITOP
    DO
    BEGIN
        UPDATE PPITOP IOP SET QTDITOP=:NQTDITOP
            WHERE CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL AND IOP.codop=:ICODOP
                AND IOP.seqop=:ISEQOP AND IOP.seqitop=:ISEQITOP;

    END
   SUSPEND;
END^


ALTER PROCEDURE PPRELCUSTOSP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    DTESTOQ DATE,
    ICODEMPMC INTEGER,
    SCODFILIALMC SMALLINT,
    CCODMARCA CHAR(6),
    ICODEMPGP INTEGER,
    SCODFILIALGP SMALLINT,
    CCODGRUP CHAR(14),
    CTIPOCUSTO CHAR(1),
    ICODEMPAX INTEGER,
    SCODFILIALAX SMALLINT,
    ICODALMOX INTEGER)
RETURNS (
    CODPROD INTEGER,
    REFPROD CHAR(13),
    DESCPROD CHAR(50),
    TIPOPROD CHAR(1),
    SLDPROD NUMERIC(15,5),
    CUSTOUNIT NUMERIC(15,5),
    CUSTOTOT NUMERIC(15,5))
AS
begin
  /* Procedure Text */
  IF (ICODEMPGP IS NOT NULL) THEN
  BEGIN
    IF (STRLEN(RTRIM(CCODGRUP))<14) THEN
       CCODGRUP = RTRIM(CCODGRUP)||'%';
  END
  IF (CTIPOCUSTO IS NULL) then
     CTIPOCUSTO = 'P';

  FOR SELECT P.CODPROD,P.REFPROD,P.DESCPROD, P.TIPOPROD
   FROM EQPRODUTO P
   WHERE P.CODEMP = :ICODEMP AND P.CODFILIAL = :SCODFILIAL AND
   ( (:ICODEMPMC IS NULL) OR (P.CODEMPMC=:ICODEMPMC AND P.CODFILIALMC=:SCODFILIALMC AND
      P.CODMARCA=:CCODMARCA) ) AND
   ((:ICODEMPGP IS NULL) OR (P.CODEMPGP=:ICODEMPGP AND P.CODFILIALGP=:SCODFILIALGP AND
      P.CODGRUP LIKE :CCODGRUP) )
   INTO :CODPROD, :REFPROD, :DESCPROD, :TIPOPROD  DO
  BEGIN
     SELECT CUSTOUNIT,SLDPROD FROM PPCUSTOPRODSP(:ICODEMP,
        :SCODFILIAL, :CODPROD, :DTESTOQ, :CTIPOCUSTO, :ICODEMPAX,
        :SCODFILIALAX, :ICODALMOX, 'N')
       INTO :CUSTOUNIT, :SLDPROD;
     CUSTOTOT = CUSTOUNIT * SLDPROD;
     SUSPEND;
  END
end^


ALTER PROCEDURE PVABRECAIXASP (
    ICODCAIXA INTEGER,
    SCODFILIAL SMALLINT,
    ICODEMP INTEGER,
    NVLRINICAIXA NUMERIC(15,5),
    DDTAMOV DATE,
    ICODFILIALUS SMALLINT,
    CIDUSU CHAR(8))
AS
DECLARE VARIABLE INROMOV INTEGER;
BEGIN
    SELECT INROMOV FROM PVSEQMOVCAIXASP(:ICODEMP, :SCODFILIAL, :ICODCAIXA, :DDTAMOV) INTO :INROMOV;

    INSERT INTO PVMOVCAIXA (CODCAIXA,CODFILIAL,CODEMP,DTAMOV,NROMOV,TIPOMOV,VLRSLDMOV,VLRMOV,CODEMPUS,CODFILIALUS,IDUSU) VALUES
      (:iCodCaixa,:sCodFilial,:iCodEmp,:DDTAMOV,:INROMOV,'A',:nVlrIniCaixa,:nVlrIniCaixa,:iCodEmp,:iCodFilialUs,:cIdUsu);
  SUSPEND;
END^


ALTER PROCEDURE PVADICMOVCAIXASP01 (
    ICODCAIXA INTEGER,
    NVLRINICAIXA NUMERIC(18,3),
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    DDTAMOV DATE)
AS
DECLARE VARIABLE ICODMOVCAIXA INTEGER;
BEGIN
  SELECT INROMOV FROM PVSEQMOVCAIXASP(:ICODEMP, :SCODFILIAL, :ICODCAIXA, :DDTAMOV) INTO :ICODMOVCAIXA;
  INSERT INTO PVMOVCAIXA (CODEMP,CODFILIAL,CODCAIXA,DTAMOV,NROMOV,TIPOMOV,VLRSLDMOV,VLRMOV)
         VALUES (
                :ICODEMP,:SCODFILIAL,:iCodCaixa,:DDTAMOV,
                :ICODMOVCAIXA,'A',:nVlrIniCaixa,:nVlrIniCaixa
         );
  SUSPEND;
END^


ALTER PROCEDURE PVFECHACAIXASP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODCAIXA INTEGER,
    DDTAMOV DATE,
    REDUZ CHAR(1),
    ICODFILIALUS SMALLINT,
    CIDUSU CHAR(8))
AS
DECLARE VARIABLE ICODMOVCAIXA INTEGER;
DECLARE VARIABLE STATUSFECHA CHAR(1);
BEGIN
  SELECT INROMOV FROM PVSEQMOVCAIXASP(:ICODEMP, :SCODFILIAL, :ICODCAIXA, :DDTAMOV) INTO :ICODMOVCAIXA;

  IF (REDUZ = 'S') THEN
    STATUSFECHA = 'Z';
  ELSE
    STATUSFECHA = 'F';


  INSERT INTO PVMOVCAIXA (CODEMP,CODFILIAL,CODCAIXA,DTAMOV,NROMOV,TIPOMOV,
                          VLRMOV,CODEMPUS,CODFILIALUS,IDUSU) VALUES (
                         :ICODEMP,:SCODFILIAL,:ICODCAIXA,:DDTAMOV,
                         :ICODMOVCAIXA,:STATUSFECHA,0,:ICODEMP,:ICODFILIALUS,:CIDUSU
                         );
  SUSPEND;
END^


ALTER PROCEDURE PVFECHAVENDASP (
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT,
    NVALOR NUMERIC(15,5),
    ITERM INTEGER,
    DDTAMOV DATE,
    CIDUSU CHAR(8))
AS
DECLARE VARIABLE ICODMOVCAIXA INTEGER;
DECLARE VARIABLE IFILIALUSU SMALLINT;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'SGUSUARIO') INTO IFILIALUSU;
  /*SELECT ISEQ FROM SPGERANUM(:ICODEMP,:ICODFILIAL,'MC') INTO ICODMOVCAIXA;*/
  SELECT INROMOV FROM PVSEQMOVCAIXASP(:ICODEMP, :ICODFILIAL, :ITERM , :DDTAMOV) INTO :ICODMOVCAIXA;
  INSERT INTO PVMOVCAIXA (CODEMP,CODFILIAL,CODCAIXA,DTAMOV,NROMOV,TIPOMOV,VLRMOV,CODEMPUS,CODFILIALUS,IDUSU)
         VALUES (
                :ICODEMP,:ICODFILIAL,:ITERM,:DDTAMOV,
                :ICODMOVCAIXA,'V',:NVALOR,:ICODEMP,:IFILIALUSU,:CIDUSU
         );
  SUSPEND;
END^


ALTER PROCEDURE PVRETMOVCAIXASP (
    ICODCAIXA INTEGER,
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT,
    DDTAMOV DATE)
RETURNS (
    DDTAMOVRET DATE,
    CTIPOMOV CHAR(1),
    NVLRSLDMOV NUMERIC(15,5),
    CIDUSU CHAR(8))
AS
BEGIN
  SELECT DTAMOV,TIPOMOV,VLRSLDMOV,IDUSU FROM PVMOVCAIXA WHERE
         NROMOV = (
                  SELECT MAX(NROMOV) FROM PVMOVCAIXA WHERE
                         CODCAIXA=:ICODCAIXA
                         AND DTAMOV =:DDTAMOV
                         AND CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL
                  )
         AND CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL AND DTAMOV=:DDTAMOV AND CODCAIXA=:ICODCAIXA
         INTO :DDTAMOVRET, :CTIPOMOV, :NVLRSLDMOV, :CIDUSU;

  SUSPEND;
END^


ALTER PROCEDURE PVSANGRIASP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    NVALOR NUMERIC(18,3),
    ICODCAIXA INTEGER,
    DDTAMOV DATE,
    CIDUSU CHAR(8))
AS
DECLARE VARIABLE ICODMOVCAIXA INTEGER;
DECLARE VARIABLE IFILIALUSU INTEGER;
BEGIN
  if (NVALOR IS NULL) then
     NVALOR = 0;
  SELECT INROMOV FROM PVSEQMOVCAIXASP(:ICODEMP, :SCODFILIAL, :ICODCAIXA, :DDTAMOV) INTO :ICODMOVCAIXA;
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'SGUSUARIO') INTO IFILIALUSU;
  INSERT INTO PVMOVCAIXA (CODEMP,CODFILIAL,CODCAIXA,DTAMOV,NROMOV,TIPOMOV,VLRMOV,CODEMPUS,CODFILIALUS,IDUSU)
         VALUES (
                :ICODEMP,:SCODFILIAL,:ICODCAIXA,:DDTAMOV,
                :ICODMOVCAIXA,'S',:NVALOR*-1,:ICODEMP,:IFILIALUSU,:CIDUSU
         );
  SUSPEND;
END^


ALTER PROCEDURE PVSEQMOVCAIXASP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODCAIXA INTEGER,
    DDTAMOV DATE)
RETURNS (
    INROMOV INTEGER)
AS
begin
    SELECT NROMOV FROM PVSEQMOVCAIXA WHERE DTAMOV=:DDTAMOV AND CODCAIXA=:ICODCAIXA
          AND CODEMP=:ICODEMP AND CODFILIAL=:SCODFILIAL INTO :INROMOV;
    IF (INROMOV IS NULL) THEN
    BEGIN
       INROMOV = 1;
       INSERT INTO PVSEQMOVCAIXA (DTAMOV,CODCAIXA,CODEMP,CODFILIAL,NROMOV)
          VALUES (:DDTAMOV, :ICODCAIXA, :ICODEMP, :SCODFILIAL, :INROMOV);
    END
    ELSE
    BEGIN
       INROMOV = INROMOV + 1;
       UPDATE PVSEQMOVCAIXA SET NROMOV=:INROMOV WHERE DTAMOV=:DDTAMOV AND CODCAIXA=:ICODCAIXA AND
            CODEMP=:ICODEMP AND CODFILIAL=:SCODFILIAL;
    END

  suspend;
end^


ALTER PROCEDURE PVSUPRIMENTOSP (
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT,
    NVALOR NUMERIC(18,3),
    ITERM INTEGER,
    DDTAMOV DATE,
    CIDUSU CHAR(8))
AS
DECLARE VARIABLE ICODMOVCAIXA INTEGER;
DECLARE VARIABLE IFILIALUSU INTEGER;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'SGUSUARIO') INTO IFILIALUSU;
  SELECT INROMOV FROM PVSEQMOVCAIXASP(:ICODEMP, :IFILIALUSU, :ITERM, :DDTAMOV) INTO :ICODMOVCAIXA;
  INSERT INTO PVMOVCAIXA (CODEMP,CODFILIAL,CODCAIXA,DTAMOV,NROMOV,TIPOMOV,VLRMOV,CODEMPUS,CODFILIALUS,IDUSU)
         VALUES (
                :ICODEMP,:ICODFILIAL,:ITERM,:DDTAMOV,
                :ICODMOVCAIXA,'U',:NVALOR,:ICODEMP,:IFILIALUSU,:CIDUSU
         );
  SUSPEND;
END^


ALTER PROCEDURE PVVALIDFAIXACAIXASP (
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT,
    ICODCAIXA INTEGER,
    NEWSEQINI INTEGER,
    NEWSEQMAX INTEGER)
AS
DECLARE VARIABLE ISEQINI INTEGER;
DECLARE VARIABLE ISEQMAX INTEGER;
DECLARE VARIABLE VARCODCAIXA INTEGER;
begin
  /* Procedure Text */
  FOR SELECT CODCAIXA FROM PVCAIXA WHERE CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL
     INTO :VARCODCAIXA DO
     BEGIN
        IF(:VARCODCAIXA<>:ICODCAIXA) THEN
           SELECT SEQINI,SEQMAX FROM PVCAIXA
              WHERE CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL AND CODCAIXA=:VARCODCAIXA
              INTO :ISEQINI, :ISEQMAX;
           IF (((NEWSEQINI >= :ISEQINI) and (NEWSEQINI <= :ISEQMAX))
                 or ((NEWSEQMAX >= :ISEQINI) and (NEWSEQMAX <= :ISEQMAX)) ) THEN
              EXCEPTION PVSEQCAIXA01 'FAIXA DE SEQUENCIA INVALIDA!';
     END
  suspend;
end^


ALTER PROCEDURE PVVERIFCAIXASP (
    ICODCAIXA INTEGER,
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    DDTAMOV DATE,
    SCODFILIALUS SMALLINT,
    CIDUSU CHAR(8))
RETURNS (
    IRETORNO INTEGER)
AS
DECLARE VARIABLE CTMP CHAR(1);
DECLARE VARIABLE CIDUSUANT CHAR(8);
DECLARE VARIABLE SCODFILIALANT SMALLINT;
DECLARE VARIABLE DULTMOV DATE;
DECLARE VARIABLE INROMOV INTEGER;
BEGIN
  iRetorno = -1;
  SELECT FIRST 1 MC.TIPOMOV, MC.IDUSU, MC.CODFILIALUS, MC.DTAMOV, MC.NROMOV
    FROM PVMOVCAIXA MC
    WHERE MC.CODCAIXA=:ICODCAIXA  AND
       MC.CODEMP=:ICODEMP AND MC.CODFILIAL=:SCODFILIAL
    ORDER BY MC.DTAMOV DESC, MC.NROMOV DESC
    INTO :cTMP, :cIDUSUANT, :SCodFilialAnt, :DULTMOV, :INROMOV;

  if ( (DULTMOV IS NULL) OR (DDTAMOV = DULTMOV) ) then
  BEGIN
     if ( (cTMP IS NULL) OR (cTMP = 'F') ) then
     BEGIN
       iRetorno = 0; /*Caixa OK*/
       SUSPEND;
       EXIT;
     END
     else if (cTMP = 'Z') then
     BEGIN
       iRetorno = 11; /*Jah foi realizada reduçãoZ neste dia*/
       SUSPEND;
       EXIT;
     END
     else if (cTMP in ('A','S','U','V')) then
     BEGIN
       if ( (cIDUSU=cIDUSUANT) AND (SCodFilialUs=SCodFilialAnt) )then
          iRetorno = 1; /*Caixa aberto*/
       else
          iRetorno = 12; /* Caixa aberto por outro usuatio */
       SUSPEND;
       EXIT;
     END
  END
  else if (DDTAMOV > DULTMOV) then
  BEGIN
     if ( cTMP = 'F' ) then /* Caixa anterior fechado sem redução Z */
     BEGIN                  /* O usuário deverá digitar a leitura da memória fiscal */
       iRetorno = 2;
       SUSPEND;
       EXIT;
     END
     else if (cTMP = 'Z') then
     BEGIN
       iRetorno = 0; /* Caixa anterior fechado corretamente */
       SUSPEND;
       EXIT;
     END
     else /* Caixa anterior deverá ser fechado */
     BEGIN
       iRetorno = 3; /* devera fechar o caixa*/
       SUSPEND;
       EXIT;
     END
  END
  ELSE
  BEGIN /*Tentativa de abertura de caixa retroativo*/
     iRetorno = 13;
  END
  SUSPEND;
END^


ALTER PROCEDURE RHLISTACANDVAGASP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODVAGA INTEGER,
    ICODFUNC INTEGER)
RETURNS (
    CODCAND INTEGER,
    NOMECAND CHAR(50),
    FONECAND CHAR(12),
    PRETENSAOSAL NUMERIC(15,2),
    QUALIFICACOES INTEGER,
    RESTRICOES INTEGER,
    CURSOS INTEGER,
    EXPERIENCIA INTEGER,
    STVAGACAND CHAR(2),
    STCAND CHAR(2))
AS
begin
    for select cd.codcand, cd.nomecand, cd.fonecand, cd.pretensaosal,cd.stcand,
        (select count(*) from rhcandidatocarac ctq
            where ctq.codemp=cd.codemp and ctq.codfilial=cd.codfilial and ctq.codcand=cd.codcand
                and ctq.codcarac in
                    (select ctvq.codcarac from rhvagacaracquali ctvq
                        where ctvq.codemp=:icodemp and ctvq.codfilial=:scodfilial
                        and ctvq.codvaga=:icodvaga)
        ) as qualificacoes,
        (select count(*) from rhcandidatocarac ctr
            where ctr.codemp=cd.codemp and ctr.codfilial=cd.codfilial and ctr.codcand=cd.codcand
                and ctr.codcarac in
                    (select ctvr.codcarac from rhvagacaracrest ctvr
                        where ctvr.codemp=:icodemp and ctvr.codfilial=:scodfilial
                        and ctvr.codvaga=:icodvaga)
        ) as restricoes,
        (select count(*) from rhcandidatocurso cu
            where cu.codemp=cd.codemp and cu.codfilial=cd.codfilial and cu.codcand=cd.codcand
                and cu.codcurso in
                    (select vc.codcurso from rhvagacurso vc
                        where vc.codemp=:icodemp and vc.codfilial=:scodfilial
                            and vc.codvaga=:icodvaga )
        ) as cursos,
        (select count(*) from rhcandidatofunc fu
            where fu.codemp=cd.codemp and fu.codfilial=cd.codfilial and fu.codcand=cd.codcand
                and fu.codfunc=:icodfunc )
        as experiencia,
        coalesce(
            (select rv.stvagacand from rhvagacandidato rv
                where rv.codemp=:icodemp and rv.codfilial=:scodfilial and rv.codvaga=:icodvaga
                    and rv.codempca=cd.codemp and rv.codfilialca=cd.codfilial and rv.codcand=cd.codcand
            ),'DI'
        )

        from rhcandidato cd

    into :codcand, :nomecand, :fonecand, :pretensaosal, :stcand, :qualificacoes,
         :restricoes, :cursos, :experiencia, :stvagacand
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE RHLISTAVAGACANDSP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODCAND INTEGER)
RETURNS (
    CODVAGA INTEGER,
    NOMEEMPR CHAR(60),
    CODFUNC INTEGER,
    DESCFUNC VARCHAR(100),
    FAIXASALINI NUMERIC(15,2),
    FAIXASALFIM NUMERIC(15,2),
    STVAGA CHAR(2),
    QUALIFICACOES INTEGER,
    RESTRICOES INTEGER,
    CURSOS INTEGER,
    STVAGACAND CHAR(2))
AS
begin
    for select vg.codvaga, empr.nomeempr, vg.codfunc, fu.descfunc, vg.faixasalini, vg.faixasalfim, vg.stvaga,
        (select count(*) from rhvagacaracquali ctq
            where ctq.codemp=vg.codemp and ctq.codfilial=vg.codfilial and ctq.codvaga=vg.codvaga
                and ctq.codcarac in
                    (select ctvq.codcarac from rhcandidatocarac ctvq
                        where ctvq.codemp=:icodemp and ctvq.codfilial=:scodfilial
                        and ctvq.codcand=:icodcand)
        ) as qualificacoes,
        (select count(*) from rhvagacaracrest ctr
            where ctr.codemp=vg.codemp and ctr.codfilial=vg.codfilial and ctr.codvaga=vg.codvaga
                and ctr.codcarac in
                    (select ctvr.codcarac from rhcandidatocarac ctvr
                        where ctvr.codemp=:icodemp and ctvr.codfilial=:scodfilial
                        and ctvr.codcand=:icodcand)
        ) as restricoes,
        (select count(*) from rhvagacurso cu
            where cu.codemp=vg.codemp and cu.codfilial=vg.codfilial and cu.codvaga=vg.codvaga
                and cu.codcurso in
                    (select cc.codcurso from rhcandidatocurso cc
                        where cc.codemp=:icodemp and cc.codfilial=:scodfilial
                            and cc.codcand=:icodcand )
        ) as cursos,
        coalesce(
            (select rv.stvagacand from rhvagacandidato rv
                where rv.codemp=:icodemp and rv.codfilial=:scodfilial and rv.codcand=:icodcand
                    and rv.codemp=vg.codemp and rv.codfilial=vg.codfilial and rv.codvaga=vg.codvaga
            ),'DI'
        )

        from rhvaga vg, rhempregador empr, rhfuncao fu
            where
            empr.codemp=vg.codempem and empr.codfilial=vg.codfilialem and empr.codempr=vg.codempr
            and fu.codemp=vg.codempfc and fu.codfilial=vg.codfilialfc and fu.codfunc=vg.codfunc
            
    into :codvaga, :nomeempr, :codfunc, :descfunc, :faixasalini, :faixasalfim, :stvaga,
         :qualificacoes, :restricoes, :cursos, :stvagacand
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SGAGENTEISP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    CTIPOAGE CHAR(5),
    CDESCAGE CHAR(50))
RETURNS (
    CODAGE INTEGER)
AS
begin
  /* Procedure para inserir agente */
  SELECT MAX(CODAGE) FROM SGAGENTE
     WHERE CODEMP=:ICODEMP AND CODFILIAL=:SCODFILIAL AND
       TIPOAGE=:CTIPOAGE INTO :CODAGE;
  if (CODAGE IS NULL) then
     CODAGE = 1;
  else
     CODAGE = CODAGE+1;
  INSERT INTO SGAGENTE (CODEMP, CODFILIAL, TIPOAGE, CODAGE, DESCAGE)
     VALUES (:ICODEMP, :SCODFILIAL, :CTIPOAGE, :CODAGE, :CDESCAGE);
  suspend;
end^


ALTER PROCEDURE SGAGENTEUIDSP (
    CIUD CHAR(1),
    ICODEMP INTEGER,
    CTIPOAGE CHAR(5),
    ICODAGE INTEGER,
    CDESCAGE CHAR(50))
RETURNS (
    CODEMP INTEGER,
    CODFILIAL SMALLINT,
    TIPOAGE CHAR(5),
    CODAGE INTEGER)
AS
begin
  /* Procedure para inserir, atualizar e deletar AGENTES */
  CODEMP = ICODEMP;
  TIPOAGE = CTIPOAGE;
  SELECT ICODFILIAL FROM SGRETFILIAL(:CODEMP, 'SGAGENTE') INTO :CODFILIAL;
  if (CIUD='I') then
     SELECT CODAGE FROM SGAGENTEISP(:CODEMP, :CODFILIAL, :TIPOAGE, :CDESCAGE)
        INTO :CODAGE;
  else if (CIUD='U') then
     SELECT CODAGE FROM SGAGENTEUSP(:CODEMP, :CODFILIAL, :TIPOAGE, :ICODAGE, :CDESCAGE)
        INTO :CODAGE;
  else if (CIUD='D') then
  begin
     DELETE FROM SGAGENTE WHERE CODEMP=:CODEMP AND CODFILIAL=:CODFILIAL AND
        TIPOAGE=:TIPOAGE AND CODAGE=:ICODAGE;
     CODAGE=:ICODAGE;
  end
  suspend;
end^


ALTER PROCEDURE SGAGENTEUSP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    CTIPOAGE CHAR(5),
    ICODAGE INTEGER,
    CDESCAGE CHAR(50))
RETURNS (
    CODAGE INTEGER)
AS
DECLARE VARIABLE CDESCAGEOLD CHAR(50);
begin
  /* Procedure para atualizar AGENTE*/
  CODAGE = ICODAGE;
  SELECT DESCAGE FROM SGAGENTE WHERE CODEMP=:ICODEMP AND CODFILIAL=:SCODFILIAL
     AND TIPOAGE=:CTIPOAGE AND CODAGE=:ICODAGE INTO :CDESCAGEOLD;
  IF ( (CDESCAGEOLD IS NOT NULL ) AND (CDESCAGEOLD!=CDESCAGE) ) THEN
     UPDATE SGAGENTE SET DESCAGE=:CDESCAGE WHERE
        CODEMP=:ICODEMP AND CODFILIAL=:SCODFILIAL
           AND TIPOAGE=:CTIPOAGE AND CODAGE=:ICODAGE;
  suspend;
end^


ALTER PROCEDURE SGATUALIZABDSP (
    ICODEMP INTEGER)
AS
DECLARE VARIABLE ICODEMPTMP INTEGER;
begin
  if (ICODEMP IS NULL) then
     ICODEMP = 99;
  /*CTEMP = printLog('Entrou no atualizabdsp '||cast(ICODEMP AS CHAR(10)));*/

  EXECUTE PROCEDURE SGDADOSINISP(:ICODEMP);
  EXECUTE PROCEDURE SGGRANTUSERSP ;
  FOR SELECT CODEMP FROM SGEMPRESA INTO :ICODEMPTMP DO
  BEGIN
     EXECUTE PROCEDURE SGOBJETOINSTBSP(:ICODEMPTMP);
     EXECUTE PROCEDURE SGGRANTADMSP(:ICODEMPTMP);
  END
  suspend;
end^


ALTER PROCEDURE SGCALCVENCSP (
    CODEMP INTEGER,
    DTBASE DATE,
    DTVENC DATE,
    REGRVCTO CHAR(1),
    RVSAB CHAR(1),
    RVDOM CHAR(1),
    RVFER CHAR(1),
    RVDIA CHAR(1),
    DIAVCTO SMALLINT,
    DIASVCTO SMALLINT)
RETURNS (
    DTVENCRET DATE)
AS
declare variable maxloop smallint;
declare variable curloop smallint;
declare variable dttemp date;
declare variable valorinc smallint;
declare variable codfilial smallint;
declare variable curloop02 smallint;
begin
  DTVENCRET = DTVENC;

  -- Busca o codigo da filial que será utilizado em duas regras
  if ( (REGRVCTO<>'N') and (RVFER = 'S') ) then
  begin
     SELECT ICODFILIAL FROM SGRETFILIAL(:CODEMP,'SGFERIADO') INTO :CODFILIAL;
  end

  -- Logica pra dia fixo
  if ( RVDIA = 'F' ) then
  begin
     MAXLOOP = 2;
     CURLOOP = 1;
     while ( CURLOOP<MAXLOOP ) do
     begin
        DTTEMP = DTVENCRET + ( 1 - EXTRACT(DAY FROM DTVENCRET) );
        DTTEMP = DTTEMP + DIAVCTO - 1;
        -- Objetivo do loop é voltar quando o dia fixo for no final do mês.
        while ( ( ( extract( month from DTVENCRET ) ) < ( extract( month from DTTEMP ) ) ) or
                ( ( extract( year from DTVENCRET ) ) < ( extract( year from DTTEMP ) ) ) ) do
        begin
           DTTEMP = DTTEMP - 1;
        end
        DTVENCRET = DTTEMP;
        if ( DTVENCRET<DTBASE ) then
        begin
           DTVENCRET = addmonth(DTVENCRET,1);
        end
        else
        begin
           break;
        end
        CURLOOP = CURLOOP + 1;
     end
  end
  -- Logica para ajustar dias uteis
  else if ( RVDIA = 'U' ) then
  begin
     while ( ( extract(month from DTVENCRET)<=extract(month from DTBASE) ) and
             ( extract(year from DTVENCRET)<=extract(year from DTBASE ) ) and
             ( DIASVCTO>0 ) ) do
     begin
        DTVENCRET = addmonth(DTVENCRET,1);
     end
     DTTEMP = DTVENCRET + ( 1 - EXTRACT(DAY FROM DTVENCRET) );
     DTVENCRET = DTTEMP;
     if (DIAVCTO<28) then -- Se for menor que dia 28 calcula o dia útil
     begin                -- Caso contrário vai será o último dia útil.
        CURLOOP02 = 1;
        while (CURLOOP02<12) do
        begin
           CURLOOP = 1;
           MAXLOOP = DIAVCTO;
           while ( CURLOOP < MAXLOOP )  do
           begin
              DTTEMP = null;
              if (RVFER='S') then
              begin
                 SELECT DATAFER FROM SGFERIADO F
                   WHERE F.CODEMP=:CODEMP AND F.CODFILIAL=:CODFILIAL AND
                     F.DATAFER=:DTVENCRET AND F.BANCFER='S'
                       INTO :DTTEMP;
              end
              if ( ( (extract( weekday from DTVENCRET )=0) and (RVDOM='S')  ) or
                   ( (extract( weekday from DTVENCRET )=6) and (RVSAB='S')  ) or
                   ( (RVFER='S') and (DTVENCRET=DTTEMP) ) ) then
              begin
                 DTVENCRET = DTVENCRET + 1;
              end
              else
              begin
                 DTVENCRET = DTVENCRET + 1;
                 CURLOOP = CURLOOP + 1;
              end
           end
           if (DTVENCRET<=DTBASE) then
           begin
              DTTEMP = DTVENCRET + ( 1 - EXTRACT(DAY FROM DTVENCRET) );
              DTVENCRET = DTTEMP;
              while ( ( extract(month from DTVENCRET)<=extract(month from DTBASE) ) and
                  ( extract(year from DTVENCRET)<=extract(year from DTBASE ) ) ) do
              begin
                 DTVENCRET = addmonth(DTVENCRET,1);
              end
           end
           else
           begin
              break;
           end
           CURLOOP02 = CURLOOP02 + 1;
        end
     end
     else
     begin
        DTTEMP = addmonth(DTVENCRET,1);
        DTVENCRET = DTTEMP - 1;
     end
  end

--  if (extract(month from dtvencret)=8) then
--  begin
--     exception fnreceberex02 'VENCIMENTO: '||CAST(dtvencret AS CHAR(10))||'REGRAVCTO = ' || REGRVCTO || 'REGRA DIA '|| RVDIA;

--  end


  -- Logica para ajustar finais de semana e feriados
  if ( (REGRVCTO<>'N') ) then
  begin
     MAXLOOP = 30;
     CURLOOP = 1;
     if ( REGRVCTO='A' ) then
     begin
        VALORINC = -1;
     end
     else
     begin
        VALORINC = 1;
     end
     while (CURLOOP<MAXLOOP) do
     begin
        if ( ( (extract( weekday from dtvencret )=0) and (RVDOM='S')  ) or
             ( (extract( weekday from dtvencret )=6) and (RVSAB='S')  ) ) then
        begin
           DTVENCRET = DTVENCRET + VALORINC;
        end
        else if (RVFER='S') then
        begin
           DTTEMP = NULL;
           SELECT DATAFER FROM SGFERIADO F
             WHERE F.CODEMP=:CODEMP AND F.CODFILIAL=:CODFILIAL AND
               F.DATAFER=:DTVENCRET AND F.BANCFER='S'
                 INTO :DTTEMP;
           if ( (DTTEMP IS NOT NULL) AND (DTTEMP=DTVENCRET) ) then
           begin
             DTVENCRET = DTVENCRET + VALORINC;
           end
           else
           begin
             break;
           end
        end
        else
        begin
           break;
        end
        CURLOOP = CURLOOP + 1;
     end
  end
  suspend;
end^


ALTER PROCEDURE SGDADOSINISP (
    ICODEMP INTEGER)
AS
DECLARE VARIABLE CROLE_NAME CHAR(31);
DECLARE VARIABLE INUMEMP INTEGER;
DECLARE VARIABLE CIDGRPUSU CHAR(8);
DECLARE VARIABLE CIDUSU CHAR(8);
DECLARE VARIABLE CSQL VARCHAR(256);
begin
  /*CTEMP = printLog('Entrou em dados ini '||cast(ICODEMP AS CHAR(10)));*/
  SELECT CODEMP FROM SGEMPRESA WHERE CODEMP=:ICODEMP INTO :INUMEMP;
  IF (INUMEMP IS NULL) THEN
  BEGIN
   /* CTEMP = printLog('Empresa é nulo '||cast(ICODEMP AS CHAR(10))); */
     INSERT INTO SGEMPRESA (CODEMP,RAZEMP)
        VALUES (:ICODEMP,'EMPRESA '||CAST(:ICODEMP AS CHAR(10) ));
     INSERT INTO SGFILIAL (CODEMP, CODFILIAL, RAZFILIAL,
        NOMEFILIAL,MZFILIAL)
       VALUES (:ICODEMP,1,'EMPRESA'||CAST(:ICODEMP AS CHAR(10) )||' - MATRIZ',
        'EMPRESA'||CAST(:ICODEMP AS CHAR(10) )||' - MATRIZ' ,'S');
    /*CTEMP = printLog('Inseriu empresa e filial '||cast(ICODEMP AS CHAR(10)));*/
  END
  SELECT RDB$ROLE_NAME FROM RDB$ROLES
     WHERE RDB$ROLE_NAME='ADM'
       INTO :CROLE_NAME;
  IF (CROLE_NAME IS NULL) THEN
  BEGIN
     CSQL = 'CREATE ROLE ADM';
     EXECUTE STATEMENT CSQL;
  END
  /* CTEMP = printLog('cadastrou roles'); */
  FOR SELECT CODEMP FROM SGEMPRESA INTO :INUMEMP DO
  BEGIN
  /* CTEMP = printLog('LOOP DE EMPRESA PARA CADASTRAR GRUPO'||CAST(INUMEMP AS CHAR(10)));*/

     SELECT IDGRPUSU FROM SGGRPUSU
       WHERE CODEMP=:INUMEMP AND IDGRPUSU='ADM'
         INTO :CIDGRPUSU;
     IF (CIDGRPUSU IS NULL) THEN
        INSERT INTO SGGRPUSU ( CODEMP, CODFILIAL, IDGRPUSU, NOMEGRPUSU)
          VALUES ( :INUMEMP, 1, 'ADM', 'ADMINISTRADOR' );
     SELECT IDUSU FROM SGUSUARIO
       WHERE CODEMP=:INUMEMP AND IDUSU='sysdba' AND CODFILIAL=1
         INTO :CIDUSU;
     IF (CIDUSU IS NULL) THEN
        INSERT INTO SGUSUARIO (CODEMP, CODFILIAL, IDUSU, NOMEUSU, IDGRPUSU)
          VALUES (:INUMEMP, 1, 'sysdba', 'ADMINISTRADOR DBA', 'ADM');
  /* CTEMP = printLog('CADASTROU USUARIOS');*/

  END

  suspend;
end^


ALTER PROCEDURE SGESTACAOIMPSP01 (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODEST INTEGER,
    SNROIMP SMALLINT,
    CPADIMP CHAR(1))
AS
begin
  /* Procedure que ajusta impressora padrão */
  IF ( (CPADIMP IS NOT NULL) AND (CPADIMP='S') ) THEN
     UPDATE SGESTACAOIMP SET IMPPAD='N' WHERE CODEMP=:ICODEMP AND
        CODFILIAL=:SCODFILIAL AND CODEST=:ICODEST AND NROIMP!=:SNROIMP;
  suspend;
end^


ALTER PROCEDURE SGFIMCONSP
AS
DECLARE VARIABLE ICONECTADO INTEGER;
begin
  /* Procedure Text */
  SELECT CONECTADO FROM SGCONEXAO WHERE NRCONEXAO=CURRENT_CONNECTION INTO iConectado;
  if (iConectado is not null) then
     UPDATE SGCONEXAO SET CONECTADO=0
        WHERE NRCONEXAO=CURRENT_CONNECTION;
  suspend;
end^


ALTER PROCEDURE SGGRANTADMSP (
    ICODEMP INTEGER)
AS
DECLARE VARIABLE CSQL VARCHAR(200);
DECLARE VARIABLE CIDOBJ CHAR(30);
begin
  /* Procedure que dá grant para o grupo ADM */
  FOR SELECT IDOBJ FROM SGOBJETO
    WHERE CODEMP=:ICODEMP AND TIPOOBJ='TB'
    INTO :CIDOBJ DO
  BEGIN
      CSQL = 'GRANT DELETE, INSERT, SELECT, UPDATE ON TABLE '||CIDOBJ||
        ' TO ROLE ADM';
      EXECUTE STATEMENT CSQL;
  END
  suspend;
end^


ALTER PROCEDURE SGGRANTUSERSP
AS
DECLARE VARIABLE CIDGRPUSU CHAR(8);
DECLARE VARIABLE CIDUSU CHAR(8);
DECLARE VARIABLE CSQL VARCHAR(200);
begin
  FOR SELECT DISTINCT IDGRPUSU, IDUSU FROM SGUSUARIO
     INTO :CIDGRPUSU, :CIDUSU DO
  BEGIN
      CSQL = 'GRANT '||RTRIM(CIDGRPUSU)||' TO USER '||RTRIM(CIDUSU);
      EXECUTE STATEMENT CSQL;
  END
  suspend;
end^


ALTER PROCEDURE SGINICONSP (
    ICODEMP INTEGER,
    CIDUSU CHAR(8),
    ICODFILIALSEL SMALLINT,
    ICODTERM SMALLINT)
RETURNS (
    SRET SMALLINT)
AS
DECLARE VARIABLE ICONECTADO INTEGER;
DECLARE VARIABLE ICODFILIALSELCX SMALLINT;
DECLARE VARIABLE ICODEMPTMP INTEGER;
DECLARE VARIABLE ICODFILIAL SMALLINT;
begin
  /* Procedure para inicialização da conexão com o banco de dados */
  SRET = 0;
  if (ICODEMP IS NULL) then
     ICODEMP = 99;
  /*CTEMP = printLog('Vai verificar o usuário');*/
  CIDUSU = lower(CIDUSU);
  IF ( CIDUSU='sysdba' ) THEN
  BEGIN
/*     CTEMP = printLog('Usuário sysdba');*/

     SELECT CODEMP FROM SGEMPRESA WHERE CODEMP=:ICODEMP INTO :ICODEMPTMP;
     IF (ICODEMPTMP IS NULL) THEN
        EXECUTE PROCEDURE SGATUALIZABDSP(:ICODEMP);
  END
  SELECT CODFILIAL FROM SGUSUARIO WHERE IDUSU=:cIdUsu AND
      CODEMP=:ICODEMP  INTO :iCodFilial;
/*  CTEMP = printLog('O usuário é = '||cIdUsu); */

/*  CTEMP = printLog('Contador de usuários '||cIdUsu); */

  if (iCodFilial is null) then
    EXCEPTION SGCONEXAOEX02;

  if (iCodFilialSel is not null) then
  begin
      SRET = 1;
      SELECT CONECTADO, CODFILIALSEL FROM SGCONEXAO
        WHERE NRCONEXAO=CURRENT_CONNECTION INTO :iConectado, iCodFilialSelCX;
      if (iConectado is null) then
          INSERT INTO SGCONEXAO (NRCONEXAO, CODEMP,CODFILIAL,IDUSU,CODFILIALSEL,CONECTADO,CODTERM)
            VALUES (CURRENT_CONNECTION, :iCodemp, :iCodfilial, :cIdusu, :iCodfilialSel, 1, :iCodTerm);
      else
      begin
          if (iConectado<=0) then
             UPDATE SGCONEXAO SET CONECTADO=1, CODFILIALSEL=:iCodfilialSel, CODTERM = :iCodTerm,
               CODEMP=:iCodemp, CODFILIAL=:iCodfilial , IDUSU=:cIdUsu
               WHERE NRCONEXAO=CURRENT_CONNECTION;
          else
          begin
             if (not (iCodfilialSelCX=iCodfilialSel) ) then
                EXCEPTION SGCONEXAOEX01;
             else
                UPDATE SGCONEXAO SET CONECTADO=CONECTADO+1, CODTERM = :iCodTerm,
                   CODEMP=:iCodemp, CODFILIAL=:iCodfilial, IDUSU=:cIdUsu
                WHERE NRCONEXAO=CURRENT_CONNECTION;
          end
      end 
  end
  suspend;
end^


ALTER PROCEDURE SGLOGSP01 (
    CLASLOG CHAR(2),
    TIPOLOG CHAR(3),
    DESCLOG CHAR(60),
    OBSLOG VARCHAR(1000))
RETURNS (
    CODFILIAL SMALLINT,
    CODLOG INTEGER)
AS
DECLARE VARIABLE IDUSU CHAR(8);
DECLARE VARIABLE CODEMP INTEGER;
DECLARE VARIABLE CODCAIXA INTEGER;
BEGIN
  SELECT CODEMP,CODFILIALSEL,CODTERM, IDUSU FROM SGCONEXAO WHERE NRCONEXAO=CURRENT_CONNECTION AND
    CONECTADO > 0 INTO CODEMP, CODFILIAL, CODCAIXA, IDUSU;
  SELECT ISEQ FROM SPGERANUM(:CODEMP,:CODFILIAL,'LG') INTO CODLOG;
  INSERT INTO SGLOG(CODEMP,CODFILIAL,CODLOG,CODEMPUS,CODFILIALUS,IDUSU,
               CLASLOG,TIPOLOG,CODEMPCX,CODFILIALCX,CODCAIXA,
        DESCLOG,OBSLOG) VALUES
              (:CODEMP,:CODFILIAL,:CODLOG,:CODEMP,:CODFILIAL,:IDUSU,
               :CLASLOG,:TIPOLOG,:CODEMP,:CODFILIAL,:CODCAIXA,
               :DESCLOG,:OBSLOG);
  SUSPEND;
END^


ALTER PROCEDURE SGOBJETOINSTBSP (
    ICODEMP INTEGER)
AS
begin

   INSERT INTO SGOBJETO (CODEMP,IDOBJ,DESCOBJ,TIPOOBJ,COMENTOBJ,USOMEOBJ,SIGLAOBJ)
       SELECT DISTINCT :ICODEMP, RC.RDB$RELATION_NAME, RC.RDB$RELATION_NAME,
        'TB', RC.RDB$RELATION_NAME /*CAST(R.RDB$DESCRIPTION AS VARCHAR(10000))*/, 'S', SUBSTRING(RC.RDB$RELATION_NAME FROM 1 FOR 8)
       FROM RDB$RELATION_CONSTRAINTS RC, RDB$RELATIONS R
       WHERE R.RDB$RELATION_NAME = RC.RDB$RELATION_NAME AND
       RC.RDB$RELATION_NAME NOT IN (SELECT IDOBJ FROM SGOBJETO O
       WHERE O.TIPOOBJ='TB' AND O.IDOBJ=RC.RDB$RELATION_NAME);

    suspend;
end^


ALTER PROCEDURE SGRETCAIXA
RETURNS (
    CODEMP INTEGER,
    CODFILIAL SMALLINT,
    CODTERM INTEGER)
AS
begin
  SELECT CODEMP, CODFILIALSEL, CODTERM FROM SGCONEXAO WHERE
    NRCONEXAO=CURRENT_CONNECTION AND CONECTADO > 0 INTO CODEMP, CODFILIAL,CODTERM;
  SUSPEND;
end^


ALTER PROCEDURE SGRETFILIAL (
    ICODEMP INTEGER,
    SNOMETAB CHAR(30))
RETURNS (
    ICODFILIAL SMALLINT)
AS
DECLARE VARIABLE SEHME CHAR(1);
begin
  SELECT USOMEOBJ FROM SGOBJETO WHERE TIPOOBJ='TB' AND IDOBJ=:SNOMETAB
    INTO sEhME;
  IF (sEhME = 'N') THEN
  BEGIN
    SELECT CODFILIALSEL FROM SGCONEXAO WHERE CODEMP=:ICODEMP AND
      NRCONEXAO=CURRENT_CONNECTION AND CONECTADO > 0 INTO ICODFILIAL;
  END
  ELSE
  BEGIN
    SELECT FL.CODFILIAL FROM SGFILIAL FL WHERE
      FL.CODEMP = :ICODEMP AND FL.MZFILIAL='S'
      INTO ICODFILIAL;
    IF (ICODFILIAL IS NULL) THEN
      EXCEPTION SGFILIALEX01;
  END
  IF (ICODFILIAL IS NULL) THEN
  BEGIN
    EXCEPTION SGFILIALEX02;
  END
  SUSPEND;
end^


ALTER PROCEDURE SGRETINFOUSU (
    IDUSU CHAR(8))
RETURNS (
    ANOCCUSU SMALLINT,
    CODFILIALCCUSU SMALLINT,
    CODEMPUSU INTEGER,
    CODFILIALUSU SMALLINT,
    CODCCUSU CHAR(19),
    IDUSUS CHAR(8),
    ALMOXARIFE CHAR(1),
    APROVARMA CHAR(2))
AS
begin
  for SELECT CODEMP,CODFILIAL,CODFILIALCC,ANOCC,CODCC,IDUSU,ALMOXARIFEUSU,APROVRMAUSU
     FROM SGUSUARIO WHERE lower(IDUSU)=lower(:IDUSU)
    INTO :CODEMPUSU,:CODFILIALUSU,:CODFILIALCCUSU,:ANOCCUSU,:CODCCUSU,:IDUSUS,:ALMOXARIFE,:APROVARMA
    do
    begin
       suspend;
    end
end^


ALTER PROCEDURE SGRETMULTIALMOXSP (
    ICODEMP INTEGER)
RETURNS (
    CMULTIALMOX CHAR(1))
AS
DECLARE VARIABLE SCODFILIALPF SMALLINT;
begin
  /* Procedure Text */
  SELECT RF.ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'SGPREFERE1') RF
     INTO :SCODFILIALPF;
  SELECT MULTIALMOX FROM SGPREFERE1 WHERE CODEMP=:ICODEMP AND
     CODFILIAL=:SCODFILIALPF
     INTO :CMULTIALMOX;

/* Condição que evita null no valor do flag */
  CMULTIALMOX = coalesce(CMULTIALMOX,'N');

  suspend;
end^


ALTER PROCEDURE SGRETMULTICOMISSP (
    ICODEMP INTEGER,
    CODEMPTM INTEGER,
    CODFILIALTM SMALLINT,
    CODTIPOMOV INTEGER)
RETURNS (
    CMULTICOMIS CHAR(1))
AS
declare variable scodfilialpf smallint;
declare variable cmulticomistm char(1);
begin
    select rf.icodfilial from sgretfilial(:icodemp, 'SGPREFERE1') rf
        into :scodfilialpf;

    /* Verifica se o mecanismo de multiplos comissionados está habilitado nas preferências gerais */

    select pf.multicomis from sgprefere1 pf
        where pf.codemp=:icodemp and pf.codfilial=:scodfilialpf
    into :cmulticomis;

    /* Caso esteja habilitado nas preferências, verifica se o tipo de movimento suporta multiplos comissionados */
    if(:cmulticomis = 'S') then
    begin

        select tm.mcomistipomov from eqtipomov tm
            where tm.codemp=:codemptm and tm.codfilial=:codfilialtm and tm.codtipomov=:codtipomov
        into :cmulticomistm;

        if(:cmulticomis is null or :cmulticomistm='N') then
        begin
            cmulticomis = 'N';
        end

    end

  cmulticomis = coalesce(cmulticomis,'N');

  suspend;
end^


ALTER PROCEDURE SGSETAGENDASP (
    CODAGD INTEGER,
    CODEMP INTEGER,
    DTAINIAGD DATE,
    HRINIAGD TIME,
    DTAFIMAGD DATE,
    HRFIMAGD TIME,
    ASSUNTOAGD CHAR(50),
    DESCAGD VARCHAR(10000),
    CODFILIALTA SMALLINT,
    CODTIPOAGD INTEGER,
    PRIORAGD SMALLINT,
    CODAGE INTEGER,
    TIPOAGE CHAR(5),
    CODFILIALAE SMALLINT,
    CODAGEEMIT INTEGER,
    TIPOAGEEMIT CHAR(5),
    CAAGD CHAR(2))
RETURNS (
    IRET INTEGER)
AS
DECLARE VARIABLE IFILIALAGD INTEGER;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(:CODEMP,'SGAGENDA') INTO IFILIALAGD;
  IF (CODAGD = 0) THEN
  BEGIN
    SELECT ISEQ FROM SPGERANUM(:CODEMP,:IFILIALAGD,'AG') INTO CODAGD;
    INSERT INTO SGAGENDA(
      CODEMP,CODFILIAL,CODAGE,TIPOAGE,CODAGD,
      DATAAGD,DTAINIAGD,HRINIAGD,DTAFIMAGD,HRFIMAGD,
      ASSUNTOAGD,DESCAGD,CODEMPTA,CODFILIALTA,CODTIPOAGD,PRIORAGD,SITAGD,
      CODEMPAE,CODFILIALAE,CODAGEEMIT,TIPOAGEEMIT,CAAGD)
      VALUES (
      :CODEMP,:IFILIALAGD,:CODAGE,:TIPOAGE,:CODAGD,
      CAST('today' AS DATE),:DTAINIAGD,:HRINIAGD,:DTAFIMAGD,:HRFIMAGD,
      :ASSUNTOAGD,:DESCAGD,:CODEMP,:CODFILIALTA,:CODTIPOAGD,:PRIORAGD,'AI',
      :CODEMP,:CODFILIALAE,:CODAGEEMIT,:TIPOAGEEMIT,:CAAGD);
  END
  ELSE
    UPDATE SGAGENDA SET
      DTAINIAGD=:DTAINIAGD,HRINIAGD=:HRINIAGD,
      DTAFIMAGD=:DTAFIMAGD,HRFIMAGD=:HRFIMAGD,
      ASSUNTOAGD=:ASSUNTOAGD,DESCAGD=:DESCAGD,
      CODEMPTA=:CODEMP,CODFILIALTA=:CODFILIALTA,CODTIPOAGD=:CODTIPOAGD,
      PRIORAGD=:PRIORAGD,CAAGD=:CAAGD
      WHERE CODEMP=:CODEMP AND CODFILIAL=:IFILIALAGD
      AND CODAGD=:CODAGD AND CODAGE=:CODAGE AND TIPOAGE=:TIPOAGE;
  IRET = CODAGD;
  SUSPEND;
END^


ALTER PROCEDURE SGULTIMODIAMESSP (
    DTCALC DATE)
RETURNS (
    DTRET DATE)
AS
begin
  DTRET = DTCALC + ( 1 - EXTRACT(DAY FROM DTCALC) );
  DTRET = addmonth( DTRET, 1);
  DTRET = DTRET - 1;
  suspend;
end^


ALTER PROCEDURE SGUPACESSOMUSP (
    ICODEMP INTEGER,
    ICODFILIAL INTEGER,
    SIDUSU CHAR(8),
    ICODSIS INTEGER,
    ICODMODU INTEGER,
    ICODMENU INTEGER,
    CTPACESSOMU CHAR(1))
AS
BEGIN
  DELETE FROM SGACESSOMU WHERE CODEMP = :ICODEMP
         AND CODFILIAL = :ICODFILIAL
         AND IDUSU = :SIDUSU
         AND CODSIS =:ICODSIS
         AND CODMODU =:ICODMODU
         AND CODMENU =:ICODMENU;
  INSERT INTO SGACESSOMU (CODEMP,CODFILIAL,IDUSU,CODSIS,CODMODU,CODMENU,TPACESSOMU)
         VALUES (
                :ICODEMP,
                :ICODFILIAL,
                :SIDUSU,
                :ICODSIS,
                :ICODMODU,
                :ICODMENU,
                :CTPACESSOMU
         );
  SUSPEND;
END^


ALTER PROCEDURE SGUPMENUSP01 (
    ICODSIS INTEGER,
    CDESCSIS CHAR(50),
    ICODMODU INTEGER,
    CDESCMODU CHAR(50),
    ICODMENU INTEGER,
    CDESCMENU CHAR(50),
    CNOMEMENU CHAR(50),
    CACAOMENU CHAR(100),
    ICODSISPAI INTEGER,
    ICODMODUPAI INTEGER,
    ICODMENUPAI INTEGER)
AS
DECLARE VARIABLE ITMP INTEGER;
BEGIN
  SELECT COUNT(*) FROM SGSISTEMA WHERE CODSIS = :ICODSIS
     INTO :ITMP;
  IF ( (ITMP is null) OR (ITMP=0) ) THEN
      INSERT INTO SGSISTEMA(CODSIS, DESCSIS)
         VALUES(:ICODSIS, :CDESCSIS);

  SELECT COUNT(*) FROM SGMODULO WHERE CODSIS = :ICODSIS AND CODMODU = :ICODMODU
     INTO :ITMP;
  IF ( (ITMP is null) OR (ITMP=0) ) THEN
      INSERT INTO SGMODULO(CODSIS, CODMODU, DESCMODU)
         VALUES(:ICODSIS, :ICODMODU, :CDESCMODU);

  SELECT COUNT(*) FROM SGMENU WHERE CODSIS =:ICODSIS
         AND CODMODU =:ICODMODU
         AND CODMENU =:ICODMENU INTO :ITMP;
  IF ( (ITMP IS NOT NULL)  AND (ITMP > 0) ) THEN
  BEGIN
    UPDATE SGMENU
      SET
        DESCMENU = :CDESCMENU,
        CODSISPAI = :ICODSISPAI,
        CODMODUPAI = :ICODMODUPAI,
        CODMENUPAI = :ICODMENUPAI
      WHERE
        CODSIS = :ICODSIS AND
        CODMODU = :ICODMODU AND
        CODMENU = :ICODMENU;
  END
  ELSE
  BEGIN
    INSERT INTO SGMENU (CODSIS,CODMODU,CODMENU,DESCMENU,NOMEMENU,ACAOMENU,
      CODSISPAI,CODMODUPAI,CODMENUPAI)
     VALUES ( :ICODSIS, :ICODMODU, :ICODMENU, :CDESCMENU, :CNOMEMENU, :CACAOMENU,
      :ICODSISPAI,:ICODMODUPAI, :ICODMENUPAI );
  END
  SUSPEND;
END^


ALTER PROCEDURE SPGERANUM (
    ICODEMP INTEGER,
    ICODFILIAL INTEGER,
    STAB CHAR(2))
RETURNS (
    ISEQ INTEGER)
AS
begin
  ISEQ = NULL;
  SELECT NROSEQ FROM SGSEQUENCIA
    WHERE CODEMP=:iCodEmp AND
      CODFILIAL=:iCodFilial AND
      SGTAB=:STAB INTO :ISEQ;
   IF (ISEQ IS NULL) THEN
   BEGIN
     INSERT INTO SGSEQUENCIA (CODEMP,CODFILIAL,SGTAB,NROSEQ)
            VALUES (:ICODEMP,:ICODFILIAL,:STAB,0);
     ISEQ = 1;
   END
   UPDATE SGSEQUENCIA SET NROSEQ=:ISEQ+1 WHERE
          CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL
          AND SGTAB=:STAB;
  SUSPEND;
end^


ALTER PROCEDURE SPGERANUMPDV (
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT,
    ICODCAIXA INTEGER)
RETURNS (
    ISEQ INTEGER)
AS
DECLARE VARIABLE ISEQINI INTEGER;
DECLARE VARIABLE ISEQMAX INTEGER;
begin
  /* Procedure Text */
  ISEQ = NULL;               
  SELECT SEQINI, SEQMAX FROM PVCAIXA
     WHERE CODEMP=:ICODEMP AND
        CODFILIAL=:ICODFILIAL AND
        CODCAIXA=:ICODCAIXA
        INTO :ISEQINI, :ISEQMAX;
  SELECT SEQCAIXA FROM PVSEQUENCIA
     WHERE CODEMP=:ICODEMP AND
        CODFILIAL=:ICODFILIAL AND
        CODCAIXA=:ICODCAIXA
        INTO :ISEQ;
  IF (ISEQ IS NULL) THEN
  BEGIN
     IF(ISEQINI IS NOT NULL AND ISEQMAX IS NOT NULL) THEN
     BEGIN
        INSERT INTO PVSEQUENCIA (CODEMP,CODFILIAL,CODCAIXA,SEQCAIXA)
           VALUES (:ICODEMP,:ICODFILIAL,:ICODCAIXA,:ISEQINI);
        ISEQ = :ISEQINI;
     END
     ELSE
        EXCEPTION PVSEQCAIXA01;
  END
  IF (ISEQ >=ISEQINI AND ISEQ < ISEQMAX)  THEN
     UPDATE PVSEQUENCIA SET SEQCAIXA=:ISEQ+1 WHERE
        CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL
        AND CODCAIXA=:ICODCAIXA;
  ELSE
     EXCEPTION PVSEQCAIXA02;
  suspend;
end^


ALTER PROCEDURE TKCONTTOCLI (
    CODEMP INTEGER,
    CODFILIAL INTEGER,
    CODCTO INTEGER,
    CODFILIALTI INTEGER,
    CODTIPOCLI INTEGER,
    CODFILIALCC INTEGER,
    CODCLASCLI INTEGER,
    CODFILIALSR INTEGER,
    CODSETOR INTEGER)
RETURNS (
    IRET INTEGER)
AS
DECLARE VARIABLE ICODCLI INTEGER;
DECLARE VARIABLE IFILIALCLI INTEGER;
BEGIN
  SELECT MAX(CODCLI)+1 FROM VDCLIENTE WHERE CODEMP=:CODEMP AND CODFILIAL=:CODFILIAL INTO ICODCLI;
  SELECT ICODFILIAL FROM SGRETFILIAL(:CODEMP, 'VDCLIENTE') INTO IFILIALCLI;
  INSERT INTO VDCLIENTE (CODEMP,CODFILIAL,CODCLI,RAZCLI,CODEMPCC,CODFILIALCC,CODCLASCLI,
  CODEMPVD,CODFILIALVD,CODVEND,CODEMPSR,CODFILIALSR,CODSETOR,NOMECLI,CODEMPTI,CODFILIALTI,
  CODTIPOCLI,DATACLI,PESSOACLI,ATIVOCLI,CNPJCLI,INSCCLI,CPFCLI,RGCLI,ENDCLI,NUMCLI,
  COMPLCLI,BAIRCLI,CIDCLI,UFCLI,CEPCLI,FONECLI,FAXCLI,EMAILCLI,CONTCLI)
    SELECT :CODEMP,:IFILIALCLI,:ICODCLI,RAZCTO,:CODEMP,:CODFILIALCC,:CODCLASCLI,
    CODEMPVD,CODFILIALVD,CODVEND,:CODEMP,:CODFILIALSR,:CODSETOR,NOMECTO,:CODEMP,:CODFILIALTI,
    :CODTIPOCLI,DATACTO,PESSOACTO,ATIVOCTO,CNPJCTO,INSCCTO,CPFCTO,RGCTO,ENDCTO,NUMCTO,
    COMPLCTO,BAIRCTO,CIDCTO,UFCTO,CEPCTO,FONECTO,FAXCTO,EMAILCTO,CONTCTO FROM TKCONTATO WHERE
    CODEMP=:CODEMP AND CODFILIAL=:CODFILIAL AND CODCTO=:CODCTO;

    IRET = ICODCLI;
  SUSPEND;
END^


ALTER PROCEDURE TKGERACAMPANHACTO (
    CODEMPCA INTEGER,
    CODFILIALCA SMALLINT,
    CODCAMP CHAR(13),
    CODEMPCO INTEGER,
    CODFILIALCO SMALLINT,
    CODCTO INTEGER,
    CODEMPAT INTEGER,
    CODFILIALAT SMALLINT,
    CODATIV INTEGER,
    SITHISTTK CHAR(2),
    DESCHISTTK VARCHAR(1000))
AS
declare variable codctoval integer; /* Código do contato pra validação. */
declare variable seqsitcamp integer;
declare variable ifilialhistorico smallint;
declare variable icodhisttk integer;
declare variable codempae integer;
declare variable codfilialae smallint;
declare variable codatend integer; /* Código do atendente. */
declare variable codempus integer;
declare variable codfilialus smallint;
declare variable idusu char(8); /* Id do usuário */
begin

    select icodfilial from sgretfilial(:codempca,'TKHISTORICO') into ifilialhistorico;
    select iseq from spgeranum(:codempca,:ifilialhistorico,'HI') into icodhisttk;
    select codempusu,codfilialusu,idusus from sgretinfousu(user) where codempusu=:codempca into
            codempus,codfilialus,idusu;

    select codemp, codfilial, codatend from atatendente
            where codempus=:codempus and codfilialus=:codfilialus and idusu=:idusu
    into codempae, codfilialae, codatend;

    if(:codatend is null) then
    begin
        exception TKGERACAMANHACTO01 ':' || idusu;
    end

    /*Verifica se o contato já foi vinculado à campanha*/

    select count(*) from tkcampanhacto cc
        where cc.codemp=:codempca and cc.codfilial=:codfilialca and cc.codcamp=:codcamp
            and cc.codempco=:codempco and cc.codfilialco=:codfilialco and cc.codcto=:codcto
    into :codctoval;

    if(:codctoval = 0) then
    begin
        seqsitcamp = 1;

        insert into tkcampanhacto (codemp,codfilial,codcamp,codempco,codfilialco,codcto)
        values(:codempca,:codfilialca,:codcamp,:codempco,:codfilialco,:codcto);

    end
    else
    begin
        select max(sc.seqsitcamp) from tksitcamp sc
            where sc.codemp=:codempca and sc.codfilial=:codfilialca and sc.codcamp=:codcamp
            and sc.codempco=:codempco and sc.codfilialco=:codfilialco and sc.codcto=:codcto
        into :seqsitcamp;


        if(:seqsitcamp is null) then
        begin
            seqsitcamp = 0;
        end

        seqsitcamp = seqsitcamp + 1;

        insert into tksitcamp (codemp,codfilial,codcamp,codempco,codfilialco,codcto,seqsitcamp,
                               codempav,codfilialav,codativ)
        values (:codempca,:codfilialca,:codcamp,:codempco,:codfilialco,:codcto,:seqsitcamp,
                :codempat,:codfilialat ,:codativ );
    end

    /*Inserindo histórico*/

    insert into tkhistorico (codemp, codfilial,codhisttk,horahisttk,datahisttk,
                             codempco,codfilialco,codcto,deschisttk,codempae,codfilialae,codatend,
                             sithisttk,tipohisttk)
      values (:codempca,:ifilialhistorico,:icodhisttk,cast('now' as time),cast('now' as date),
              :codempco,:codfilialco,:codcto,:deschisttk,:codempae,:codfilialae,:codatend,
              :sithisttk,'C');

end^


ALTER PROCEDURE TKSETHISTSP (
    CODHISTTK INTEGER,
    CODEMP INTEGER,
    CODFILIALCO INTEGER,
    CODCTO INTEGER,
    CODFILIALCL INTEGER,
    CODCLI INTEGER,
    DESCHISTTK VARCHAR(10000),
    CODFILIALAE INTEGER,
    CODATEND INTEGER,
    SITHISTTK CHAR(2),
    DATAHISTTK DATE,
    TIPOHISTTK CHAR(1))
RETURNS (
    IRET INTEGER)
AS
DECLARE VARIABLE IFILIALHIST INTEGER;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(:CODEMP,'TKHISTORICO') INTO IFILIALHIST;
  IF (TIPOHISTTK = '') THEN
  BEGIN
    TIPOHISTTK = 'H';
  END
  IF (CODHISTTK = 0) THEN
  BEGIN
    SELECT ISEQ FROM SPGERANUM(:CODEMP,:IFILIALHIST,'HI') INTO CODHISTTK;
    INSERT INTO TKHISTORICO(CODEMP,CODFILIAL,CODHISTTK,DATAHISTTK,HORAHISTTK,CODEMPCO,CODFILIALCO,
      CODCTO,CODEMPCL,CODFILIALCL,CODCLI,DESCHISTTK,CODEMPAE,CODFILIALAE,CODATEND,SITHISTTK,TIPOHISTTK)
      VALUES (:CODEMP,:IFILIALHIST,:CODHISTTK,:DATAHISTTK,CAST('now' AS TIME),:CODEMP,:CODFILIALCO,
      :CODCTO,:CODEMP,:CODFILIALCL,:CODCLI,:DESCHISTTK,:CODEMP,:CODFILIALAE,:CODATEND,:SITHISTTK,:TIPOHISTTK);
  END
  ELSE
  BEGIN
    UPDATE TKHISTORICO SET DATAHISTTK=:DATAHISTTK,CODEMPCO=:CODEMP,CODFILIALCO=:CODFILIALCO,
      CODCTO=:CODCTO,CODEMPCL=:CODEMP,CODFILIALCL=:CODFILIALCL,
      CODCLI=:CODCLI,DESCHISTTK=:DESCHISTTK,CODEMPAE=:CODEMP,
      CODFILIALAE=:CODFILIALAE,CODATEND=:CODATEND,SITHISTTK=:SITHISTTK,TIPOHISTTK=:TIPOHISTTK
      WHERE CODEMP=:CODEMP AND CODFILIAL=:IFILIALHIST AND CODHISTTK=:CODHISTTK;
    /*IF (NOT SITHISTTK IN ('AG')) THEN
      DELETE FROM SGAGENDA WHERE OBJORIGAGD='HISTO' AND CODEMPCH=:CODEMP AND
        CODFILIALCH=:IFILIALHIST AND CODCHAVE=:CODHISTTK; */
  END
  SUSPEND;
END^


ALTER PROCEDURE VDADICCOMISSAOSP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODREC INTEGER,
    INPARCITREC INTEGER,
    NVLRVENDACOMI NUMERIC(15,5),
    NVLRCOMI NUMERIC(15,5),
    DDATACOMI DATE,
    DDTVENCCOMI DATE,
    CTIPOCOMI CHAR(1),
    CODEMPVD INTEGER,
    CODFILIALVD SMALLINT,
    CODVEND INTEGER)
AS
declare variable scodfilialcs smallint;
declare variable icodcomi integer;
declare variable cstatuscomi char(2);
begin
  /* Adiciona comissão na tabela vdcomissao*/
  IF ( (nVlrComi is null) OR  (nVlrComi=0) ) THEN /* se o valor for zero */
  BEGIN
     /*  então deleta a comissão gerada */
     DELETE FROM VDCOMISSAO WHERE CODEMPRC=:iCodEmp AND CODFILIALRC=:sCodFilial AND
        CODREC=:iCodRec AND NPARCITREC=:iNParcItRec AND TIPOCOMI=:cTipoComi AND
        CODEMPVD=:codempvd AND codfilialvd=:codfilialvd AND codvend=:codvend;
  END
  ELSE IF (nVlrComi<0) THEN /* Caso seja um estorno de comissão */
  BEGIN
     SELECT MAX(CODCOMI) FROM VDCOMISSAO WHERE CODEMP=:ICODEMP AND
        CODFILIAL = :SCODFILIALCS INTO iCodComi;
     IF (:iCodComi IS NULL) THEN
        iCodComi = 1;
     ELSE
        iCodComi = iCodComi+1;
     INSERT INTO VDCOMISSAO (CODEMP,CODFILIAL,CODCOMI,CODEMPRC,CODFILIALRC,CODREC,STATUSCOMI,
               NPARCITREC,VLRVENDACOMI,VLRCOMI,DATACOMI,DTVENCCOMI,STATUSCOMI,TIPOCOMI,
               CODEMPVD,CODFILIALVD,CODVEND)
              VALUES ( :iCodEmp,:sCodFilialCs,:iCodComi,:iCodEmp,:sCodFilial,:iCodRec,:cStatusComi,
              :iNParcItRec,:nVlrVendaComi,:nVlrComi,:dDataComi,:dDtVencComi,'CE',:cTipoComi,
              :codempvd,:codfilialvd,:codvend);
     nVlrComi = nVlrComi * -1; /*  Transforma o valor da comissão em positivo e programa para o proximo pagto. */
     INSERT INTO VDCOMISSAO (CODEMP,CODFILIAL,CODCOMI,CODEMPRC,CODFILIALRC,CODREC,STATUSCOMI,
               NPARCITREC,VLRVENDACOMI,VLRCOMI,DATACOMI,DTVENCCOMI,STATUSCOMI,TIPOCOMI,
               CODEMPVD,CODFILIALVD,CODVEND)
              VALUES ( :iCodEmp,:sCodFilialCs,:iCodComi,:iCodEmp,:sCodFilial,:iCodRec,:cStatusComi,
              :iNParcItRec,:nVlrVendaComi,:nVlrComi,:dDataComi,:dDtVencComi,'C1',:cTipoComi,
              :codempvd,:codfilialvd,:codvend);
  END
  ELSE
  BEGIN
     IF (cTipoComi='F') THEN
        cStatusComi = 'C2';
     ELSE
        cStatusComi = 'C1';
     SELECT ICODFILIAL FROM sgretfilial(:ICODEMP,'VDCOMISSAO') INTO :SCODFILIALCS;
     SELECT CODCOMI FROM VDCOMISSAO WHERE CODEMP=:iCodEmp AND CODFILIALRC=:sCodFilial AND
        CODREC=:iCodRec AND NPARCITREC=:iNParcItRec AND TIPOCOMI=:cTipoComi
        AND CODEMPVD=:codempvd AND codfilialvd=:codfilialvd AND codvend=:codvend
        INTO :iCodComi;
     IF (iCodComi IS NULL) THEN  /* se não encontrou a comissão */
     BEGIN /*-então insere */
        SELECT MAX(CODCOMI) FROM VDCOMISSAO WHERE CODEMP=:ICODEMP AND
           CODFILIAL = :SCODFILIALCS INTO iCodComi;
        IF (:iCodComi IS NULL) THEN
          iCodComi = 1;
        ELSE
          iCodComi = iCodComi+1;
        INSERT INTO VDCOMISSAO (CODEMP,CODFILIAL,CODCOMI,CODEMPRC,CODFILIALRC,CODREC,STATUSCOMI,
               NPARCITREC,VLRVENDACOMI,VLRCOMI,DATACOMI,DTVENCCOMI,STATUSCOMI,TIPOCOMI,
               CODEMPVD,CODFILIALVD,CODVEND)
              VALUES ( :iCodEmp,:sCodFilialCs,:iCodComi,:iCodEmp,:sCodFilial,:iCodRec,:cStatusComi,
              :iNParcItRec,:nVlrVendaComi,:nVlrComi,:dDataComi,:dDtVencComi,:cStatusComi,:cTipoComi,
              :codempvd,:codfilialvd,:codvend);
     END
     ELSE /* se encontrou a comissão atualiza */
     BEGIN
        UPDATE VDCOMISSAO SET VLRVENDACOMI=:nVlrVendaComi, VLRCOMI=:nVlrComi,
            DATACOMI=:dDataComi, DTVENCCOMI=:dDtVencComi, STATUSCOMI=:cStatusComi
        WHERE CODEMP=:iCodEmp AND CODFILIAL=:sCodFilialCs AND CODCOMI=:iCodComi
        AND codempvd=:codempvd AND codfilialvd=:codfilialvd AND codvend=:codvend
        AND STATUSCOMI!='CP' ;
     END
  END
  suspend;
end^


ALTER PROCEDURE VDADICITEMPDVSP (
    CODVENDA INTEGER,
    CODEMP INTEGER,
    CODFILIAL CHAR(8),
    CODPROD INTEGER,
    CODEMPPD INTEGER,
    CODFILIALPD INTEGER,
    QTDITVENDA NUMERIC(9,5),
    VLRPRECOITVENDA NUMERIC(18,5),
    VLRDESCITVENDA NUMERIC(18,5),
    PERCDESCITVENDA NUMERIC(15,5),
    VLRCOMISITVENDA NUMERIC(15,5),
    PERCCOMISITVENDA NUMERIC(15,5),
    SCODLOTE VARCHAR(20),
    CODEMPLE INTEGER,
    CODFILIALLE SMALLINT,
    CODFILIALCV SMALLINT,
    CODCONV INTEGER)
RETURNS (
    CODITVENDA INTEGER,
    PERCICMSITVENDA NUMERIC(9,2),
    VLRBASEICMSITVENDA NUMERIC(18,3),
    VLRICMSITVENDA NUMERIC(18,3),
    VLRLIQITVENDA NUMERIC(18,3))
AS
DECLARE VARIABLE ICODFILIALNT SMALLINT;
DECLARE VARIABLE ICODCLI INTEGER;
DECLARE VARIABLE ICODFILIALCL INTEGER;
DECLARE VARIABLE ICODTIPOMOV INTEGER;
DECLARE VARIABLE ICODFILIALTM INTEGER;
DECLARE VARIABLE SCODNAT CHAR(4);
DECLARE VARIABLE TIPOFISC CHAR(2);
DECLARE VARIABLE SORIGFISC CHAR(1);
DECLARE VARIABLE SCODTRATTRIB CHAR(2);
DECLARE VARIABLE ICODFILIALTT SMALLINT;
DECLARE VARIABLE ICODFILIALME SMALLINT;
DECLARE VARIABLE ICODMENS SMALLINT;
DECLARE VARIABLE PERCIPIITVENDA NUMERIC(9,2);
DECLARE VARIABLE VLRBASEIPIITVENDA NUMERIC(15,5);
DECLARE VARIABLE VLRIPIITVENDA NUMERIC(15,5);
DECLARE VARIABLE VLRPRODITVENDA NUMERIC(15,5);
DECLARE VARIABLE SREFPROD CHAR(13);
DECLARE VARIABLE OBSITORC VARCHAR(500);
DECLARE VARIABLE UFCLI CHAR(2);
DECLARE VARIABLE UFFLAG CHAR(1);
DECLARE VARIABLE PERCRED NUMERIC(9,2);
begin

  SELECT MAX(CODITVENDA)+1 FROM VDITVENDA WHERE CODVENDA=:CODVENDA
    AND CODFILIAL=:CODFILIAL AND CODEMP=:CODEMP INTO CODITVENDA;

  IF (CODITVENDA IS NULL) THEN
    CODITVENDA = 1;

/*Informações da Venda.:*/

  SELECT V.CODCLI,V.CODFILIALCL,C.UFCLI,V.CODTIPOMOV,V.CODFILIALTM FROM VDVENDA V, VDCLIENTE C
    WHERE V.CODEMP=:CODEMP AND V.CODFILIAL=:CODFILIAL
    AND V.CODVENDA=:CODVENDA AND V.TIPOVENDA='E' AND
    C.CODCLI=V.CODCLI AND C.CODEMP=V.CODEMPCL AND
    C.CODFILIAL=V.CODFILIALCL INTO ICODCLI,ICODFILIALCL,UFCLI,ICODTIPOMOV,ICODFILIALTM;


  UFFLAG = 'N';

  SELECT 'S' FROM SGFILIAL  WHERE CODEMP=:CODEMP
    AND CODFILIAL=:CODFILIAL AND UFFILIAL=:UFCLI INTO UFFLAG;


  SELECT ICODFILIAL FROM SGRETFILIAL(:CODEMP,'LFNATOPER') INTO ICODFILIALNT;
  SELECT ICODFILIAL FROM SGRETFILIAL(:CODEMP,'LFTRATTRIB') INTO ICODFILIALTT;
  SELECT ICODFILIAL FROM SGRETFILIAL(:CODEMP,'LFMENSAGEM') INTO ICODFILIALME;
  SELECT C.ALIQIPIFISC
      FROM EQPRODUTO P, LFCLFISCAL C
         WHERE P.CODPROD=:CODPROD AND P.CODFILIAL=:CODFILIALPD
         AND P.CODEMP=:CODEMPPD AND C.CODFISC=P.CODFISC AND C.CODFILIAL=P.CODFILIALFC
         AND C.CODEMP=P.CODEMPFC INTO PERCIPIITVENDA;

  SELECT CODNAT FROM
      LFBUSCANATSP(:CODFILIAL,:CODEMP,:CODFILIALPD,
                   :CODPROD,:CODEMP,:ICODFILIALCL,
                   :ICODCLI,NULL,NULL,NULL,:ICODFILIALTM,:ICODTIPOMOV)
      INTO SCODNAT;

  IF (SCODNAT IS NULL) THEN
      EXCEPTION VDITVENDAEX03;

  SELECT TIPOFISC,REDFISC,CODTRATTRIB,ORIGFISC,CODMENS,ALIQFISC FROM
      LFBUSCAFISCALSP(:CODFILIAL,:CODEMP,:CODFILIALPD,:CODPROD,
                      :CODEMP,:ICODFILIALCL,:ICODCLI,
                      :CODEMP,:ICODTIPOMOV,:ICODFILIALTM)
      INTO TIPOFISC,PERCRED,SCODTRATTRIB,SORIGFISC,ICODMENS,PERCICMSITVENDA;

  VLRPRODITVENDA = (QTDITVENDA*VLRPRECOITVENDA);
  VLRBASEIPIITVENDA = 0;
  VLRBASEICMSITVENDA = 0;
  VLRICMSITVENDA = 0;
  VLRIPIITVENDA = 0;
  IF (PERCIPIITVENDA IS NULL) THEN
     PERCIPIITVENDA = 0;

  IF ( TIPOFISC = 'II') THEN
  BEGIN
    PERCICMSITVENDA = 0;
    VLRICMSITVENDA = 0;
    VLRBASEICMSITVENDA = 0;
    PERCIPIITVENDA = 0;
    VLRIPIITVENDA = 0;
    VLRBASEIPIITVENDA = 0;
  END
  ELSE IF ( TIPOFISC = 'FF') THEN
  BEGIN
    PERCICMSITVENDA = 0;
    VLRICMSITVENDA = 0;
    VLRBASEICMSITVENDA = 0;
    PERCIPIITVENDA = 0;
    VLRIPIITVENDA = 0;
    VLRBASEIPIITVENDA = 0;
  END
  ELSE IF ( TIPOFISC = 'NN') THEN
  BEGIN
    PERCICMSITVENDA = 0;
    VLRICMSITVENDA = 0;
    VLRBASEICMSITVENDA = 0;
    PERCIPIITVENDA = 0;
    VLRIPIITVENDA = 0;
    VLRBASEIPIITVENDA = 0;
  END
  ELSE IF ( TIPOFISC = 'TT') THEN
  BEGIN
    IF (PERCICMSITVENDA = 0 OR PERCICMSITVENDA IS NULL) THEN
      SELECT PERCICMS FROM LFBUSCAICMSSP (:SCODNAT,:UFCLI,:CODEMP,:CODFILIAL) INTO PERCICMSITVENDA;
    IF (PERCRED IS NULL) THEN
      PERCRED = 0;
    VLRBASEICMSITVENDA = (VLRPRODITVENDA-VLRDESCITVENDA) - ((VLRPRODITVENDA-VLRDESCITVENDA)*(PERCRED/100));
    VLRBASEIPIITVENDA = VLRPRODITVENDA-VLRDESCITVENDA;
    VLRICMSITVENDA = VLRBASEICMSITVENDA*(PERCICMSITVENDA/100);
    VLRIPIITVENDA = VLRBASEIPIITVENDA*(PERCIPIITVENDA/100);
  END
  VLRLIQITVENDA= VLRPRODITVENDA+VLRIPIITVENDA-VLRDESCITVENDA;
  INSERT INTO VDITVENDA (
     CODEMP,CODFILIAL,TIPOVENDA,CODVENDA,CODITVENDA,
     CODEMPNT,CODFILIALNT,CODNAT,
     CODEMPPD,CODFILIALPD,CODPROD,
     CODEMPLE,CODFILIALLE,CODLOTE,
     QTDITVENDA,PRECOITVENDA,PERCDESCITVENDA,VLRDESCITVENDA,
     VLRCOMISITVENDA,PERCCOMISITVENDA,
     PERCICMSITVENDA,VLRBASEICMSITVENDA,VLRICMSITVENDA,
     PERCIPIITVENDA,VLRBASEIPIITVENDA,VLRIPIITVENDA,VLRLIQITVENDA,
     VLRPRODITVENDA,REFPROD,ORIGFISC,
     CODEMPTT,CODFILIALTT,CODTRATTRIB,TIPOFISC,
     CODEMPME,CODFILIALME,CODMENS,OBSITVENDA,
     CODEMPCV,CODFILIALCV,CODCONV) VALUES (
     :CODEMP,:CODFILIAL,'E',:CODVENDA,:CODITVENDA,
     :CODEMP,:ICODFILIALNT,:SCODNAT,
     :CODEMPPD,:CODFILIALPD,:CODPROD,
     :CODEMPLE,:CODFILIALLE,:SCODLOTE,
     :QTDITVENDA,:VLRPRECOITVENDA,:PERCDESCITVENDA,:VLRDESCITVENDA,
     :VLRCOMISITVENDA,:PERCCOMISITVENDA,
     :PERCICMSITVENDA,:VLRBASEICMSITVENDA,:VLRICMSITVENDA,
     :PERCIPIITVENDA,:VLRBASEIPIITVENDA,:VLRIPIITVENDA,:VLRLIQITVENDA,
     :VLRPRODITVENDA,:SREFPROD,:SORIGFISC,
     :CODEMP,:ICODFILIALTT,:SCODTRATTRIB,:TIPOFISC,
     :CODEMP,:ICODFILIALME,:ICODMENS,:OBSITORC,
     :CODEMP, :CODFILIALCV,:CODCONV);
  SUSPEND;
END^


ALTER PROCEDURE VDADICITVENDAORCSP (
    FILIALATUAL INTEGER,
    ICODVENDA INTEGER,
    ICODORC INTEGER,
    ICODITORC INTEGER,
    ICODFILIAL SMALLINT,
    ICODEMP INTEGER,
    STIPOVENDA CHAR(10),
    TPAGRUP CHAR(1),
    IQTDITVENDA FLOAT,
    VLRDESCITVENDA NUMERIC(15,5))
AS
DECLARE VARIABLE ICODITVENDA INTEGER;
DECLARE VARIABLE ICODFILIALIT SMALLINT;
DECLARE VARIABLE ICODFILIALNT SMALLINT;
DECLARE VARIABLE CODEMPAX INTEGER;
DECLARE VARIABLE CODFILIALAX INTEGER;
DECLARE VARIABLE CODALMOX INTEGER;
DECLARE VARIABLE ICODCLI INTEGER;
DECLARE VARIABLE ICODFILIALTM INTEGER;
DECLARE VARIABLE ICODTIPOMOV INTEGER;
DECLARE VARIABLE ICODFILIALCL INTEGER;
DECLARE VARIABLE SCODNAT CHAR(4);
DECLARE VARIABLE ICODFILIALLE SMALLINT;
DECLARE VARIABLE SCODLOTE VARCHAR(20);
DECLARE VARIABLE TIPOFISC CHAR(2);
DECLARE VARIABLE SORIGFISC CHAR(1);
DECLARE VARIABLE SCODTRATTRIB CHAR(2);
DECLARE VARIABLE ICODFILIALTT SMALLINT;
DECLARE VARIABLE ICODFILIALME SMALLINT;
DECLARE VARIABLE ICODMENS SMALLINT;
DECLARE VARIABLE PERCICMSITVENDA NUMERIC(9,2);
DECLARE VARIABLE VLRBASEICMSITVENDA NUMERIC(15,5);
DECLARE VARIABLE VLRICMSITVENDA NUMERIC(15,5);
DECLARE VARIABLE PERCIPIITVENDA NUMERIC(9,2);
DECLARE VARIABLE VLRBASEIPIITVENDA NUMERIC(15,5);
DECLARE VARIABLE VLRIPIITVENDA NUMERIC(15,5);
DECLARE VARIABLE ICODPROD INTEGER;
DECLARE VARIABLE ICODFILIALPD INTEGER;
DECLARE VARIABLE VLRPRECOITVENDA NUMERIC(15,5);
DECLARE VARIABLE PERCDESCITVENDA NUMERIC(9,2);
DECLARE VARIABLE VLRLIQITVENDA NUMERIC(15,5);
DECLARE VARIABLE VLRPRODITVENDA NUMERIC(15,5);
DECLARE VARIABLE SREFPROD CHAR(13);
DECLARE VARIABLE OBSITORC VARCHAR(500);
DECLARE VARIABLE UFCLI CHAR(2);
DECLARE VARIABLE UFFLAG CHAR(1);
DECLARE VARIABLE PERCRED NUMERIC(9,2);
DECLARE VARIABLE CLOTEPROD CHAR(1);
DECLARE VARIABLE ICONTA1 INTEGER;
DECLARE VARIABLE ICONTA2 INTEGER;
begin

  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'VDVENDA') INTO ICODFILIALIT;
  SELECT MAX(CODITVENDA) FROM VDITVENDA WHERE CODVENDA=:ICODVENDA
    AND CODFILIAL=:ICODFILIALIT AND CODEMP=:ICODEMP AND TIPOVENDA=:STIPOVENDA INTO ICODITVENDA;

  IF (ICODITVENDA IS NULL) THEN
    ICODITVENDA = 1;
  ELSE IF (TPAGRUP <> 'F') THEN
    ICODITVENDA = ICODITVENDA + 1;

/*Informações do Orcamento.:*/

  SELECT CODCLI,CODFILIALCL FROM VDORCAMENTO
    WHERE CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL
    AND CODORC=:ICODORC INTO ICODCLI,ICODFILIALCL;

/*Informações do ItOrcamento.:*/

/*  SELECT CODEMPPD,CODFILIALPD,CODPROD,PRECOITORC,PERCDESCITORC,VLRDESCITORC,
         VLRLIQITORC,VLRPRODITORC,REFPROD,OBSITORC,CODEMPAX,CODFILIALAX,CODALMOX FROM VDITORCAMENTO WHERE
         CODITORC=:ICODITORC AND CODORC=:ICODORC AND CODFILIAL=:ICODFILIAL AND CODEMP=:ICODEMP
         INTO ICODEMP,ICODFILIALPD,ICODPROD,VLRPRECOITVENDA,PERCDESCITVENDA,VLRDESCITVENDA,
           VLRLIQITVENDA,VLRPRODITVENDA,SREFPROD,OBSITORC,CODEMPAX,CODFILIALAX,CODALMOX;*/

    SELECT CODEMPPD,CODFILIALPD,CODPROD,PRECOITORC,PERCDESCITORC,
         VLRLIQITORC,VLRPRODITORC,REFPROD,OBSITORC,CODEMPAX,CODFILIALAX,CODALMOX FROM VDITORCAMENTO WHERE
         CODITORC=:ICODITORC AND CODORC=:ICODORC AND CODFILIAL=:ICODFILIAL AND CODEMP=:ICODEMP
         INTO ICODEMP,ICODFILIALPD,ICODPROD,VLRPRECOITVENDA,PERCDESCITVENDA,
           VLRLIQITVENDA,VLRPRODITVENDA,SREFPROD,OBSITORC,CODEMPAX,CODFILIALAX,CODALMOX;

/*Informações fiscais.:*/

  SELECT C.UFCLI FROM VDORCAMENTO O, VDCLIENTE C WHERE
    O.CODORC=:ICODORC AND O.CODFILIAL=:ICODFILIAL AND O.CODEMP=:ICODEMP AND
    C.CODCLI=O.CODCLI AND C.CODFILIAL=O.CODFILIALCL AND C.CODEMP=O.CODEMPCL
    INTO UFCLI;

  UFFLAG = 'N';

  SELECT 'S' FROM SGFILIAL  WHERE CODEMP=:ICODEMP
    AND CODFILIAL=:ICODFILIAL AND UFFILIAL=:UFCLI INTO UFFLAG;

  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'VDVENDA') INTO ICODFILIALIT;
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'LFNATOPER') INTO ICODFILIALNT;
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'LFTRATTRIB') INTO ICODFILIALTT;
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'LFMENSAGEM') INTO ICODFILIALME;

  SELECT C.ALIQIPIFISC,P.CLOTEPROD
    FROM VDITORCAMENTO IT, EQPRODUTO P, LFCLFISCAL C WHERE
    IT.CODEMP=:ICODEMP AND IT.CODFILIAL=:ICODFILIAL AND IT.CODITORC=:ICODITORC AND
    IT.CODORC=:ICODORC AND P.CODPROD = IT.CODPROD AND P.CODFILIAL = IT.CODFILIALPD AND
    P.CODEMP = IT.CODEMPPD AND C.CODFISC = P.CODFISC AND C.CODFILIAL = P.CODFILIALFC AND
    C.CODEMP = P.CODEMPFC INTO PERCIPIITVENDA,CLOTEPROD;

  SELECT CODTIPOMOV,CODFILIALTM FROM VDVENDA WHERE
    CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL
    AND CODVENDA=:ICODVENDA AND TIPOVENDA=:STIPOVENDA
  INTO ICODTIPOMOV,ICODFILIALTM;

  SELECT CODNAT FROM
    LFBUSCANATSP(:FILIALATUAL,:ICODEMP,:ICODFILIALPD,
      :ICODPROD,:ICODEMP,:ICODFILIALCL,:ICODCLI,
      NULL,NULL,NULL,:ICODFILIALTM,:ICODTIPOMOV)
    INTO SCODNAT;
    
  IF (SCODNAT IS NULL) THEN
    EXCEPTION VDITVENDAEX03;

  SELECT TIPOFISC,REDFISC,CODTRATTRIB,ORIGFISC,CODMENS,ALIQFISC FROM
    LFBUSCAFISCALSP(:FILIALATUAL,:ICODEMP,:ICODFILIALPD,:ICODPROD,:ICODEMP,:ICODFILIALCL,:ICODCLI,:ICODEMP,:ICODFILIALTM,:ICODTIPOMOV)
    INTO TIPOFISC,PERCRED,SCODTRATTRIB,SORIGFISC,ICODMENS,PERCICMSITVENDA;

/*Cod Lote.:*/

  IF (CLOTEPROD = 'S') THEN
  BEGIN
    SELECT FIRST 1 L.CODLOTE FROM EQLOTE L WHERE
      L.CODPROD=:ICODPROD AND L.CODFILIAL=:ICODFILIALPD
       AND L.CODEMP=:ICODEMP AND L.VENCTOLOTE =
         (
           SELECT MIN(VENCTOLOTE) FROM EQLOTE LS WHERE LS.CODPROD=L.CODPROD AND LS.CODFILIAL=L.CODFILIAL
             AND LS.CODEMP=L.CODEMP AND LS.SLDLIQLOTE>=:IQTDITVENDA
         ) AND L.SLDLIQLOTE>=:IQTDITVENDA INTO SCODLOTE;
    ICODFILIALLE = ICODFILIALPD;
  END

  VLRPRODITVENDA = VLRPRECOITVENDA * :IQTDITVENDA;
  VLRLIQITVENDA = VLRPRODITVENDA - :VLRDESCITVENDA;
  VLRBASEIPIITVENDA = 0;
  VLRBASEICMSITVENDA = 0;
  VLRICMSITVENDA = 0;
  VLRIPIITVENDA = 0;

  IF ( TIPOFISC = 'II') THEN
  BEGIN
    PERCICMSITVENDA = 0;
    VLRICMSITVENDA = 0;
    VLRBASEICMSITVENDA = 0;
    PERCIPIITVENDA = 0;
    VLRIPIITVENDA = 0;
    VLRBASEIPIITVENDA = 0;
  END
  ELSE IF ( TIPOFISC = 'FF') THEN
  BEGIN
    PERCICMSITVENDA = 0;
    VLRICMSITVENDA = 0;
    VLRBASEICMSITVENDA = 0;
    PERCIPIITVENDA = 0;
    VLRIPIITVENDA = 0;
    VLRBASEIPIITVENDA = 0;
  END
  ELSE IF ( TIPOFISC = 'NN') THEN
  BEGIN
    PERCICMSITVENDA = 0;
    VLRICMSITVENDA = 0;
    VLRBASEICMSITVENDA = 0;
    PERCIPIITVENDA = 0;
    VLRIPIITVENDA = 0;
    VLRBASEIPIITVENDA = 0;
  END
  ELSE IF ( TIPOFISC = 'TT') THEN
  BEGIN
    IF (PERCICMSITVENDA = 0 OR PERCICMSITVENDA IS NULL) THEN
      SELECT PERCICMS FROM LFBUSCAICMSSP (:SCODNAT,:UFCLI,:ICODEMP,:ICODFILIAL) INTO PERCICMSITVENDA;
    IF (PERCRED IS NULL) THEN
      PERCRED = 0;
    VLRBASEICMSITVENDA = VLRPRODITVENDA - (VLRPRODITVENDA*(PERCRED/100));
    VLRBASEIPIITVENDA = VLRPRODITVENDA;
    VLRICMSITVENDA = VLRBASEICMSITVENDA*(PERCICMSITVENDA/100);
    VLRIPIITVENDA = VLRBASEIPIITVENDA*(PERCIPIITVENDA/100);
  END

  IF ( (TPAGRUP <> 'F') ) THEN
  BEGIN
  INSERT INTO VDITVENDA (CODEMP,CODFILIAL,CODVENDA,TIPOVENDA,CODITVENDA,CODEMPNT,CODFILIALNT,CODNAT,CODEMPPD,
     CODFILIALPD,CODPROD,CODEMPLE,CODFILIALLE,CODLOTE,QTDITVENDA,PRECOITVENDA,PERCDESCITVENDA,VLRDESCITVENDA,
     PERCICMSITVENDA,VLRBASEICMSITVENDA,VLRICMSITVENDA,PERCIPIITVENDA,VLRBASEIPIITVENDA,VLRIPIITVENDA,
     VLRLIQITVENDA,VLRPRODITVENDA,REFPROD,ORIGFISC,CODEMPTT,CODFILIALTT,CODTRATTRIB,TIPOFISC,
     CODEMPME,CODFILIALME,CODMENS,OBSITVENDA,CODEMPAX,CODFILIALAX,CODALMOX)
     VALUES (:ICODEMP,:ICODFILIAL,:ICODVENDA,:STIPOVENDA,:ICODITVENDA,:ICODEMP,
     :ICODFILIALNT,:SCODNAT,:ICODEMP,:ICODFILIALPD,:ICODPROD,:ICODEMP,:ICODFILIALPD,:SCODLOTE,:IQTDITVENDA,
     :VLRPRECOITVENDA,:PERCDESCITVENDA,:VLRDESCITVENDA,:PERCICMSITVENDA,:VLRBASEICMSITVENDA,:VLRICMSITVENDA,
     :PERCIPIITVENDA,:VLRBASEIPIITVENDA,:VLRIPIITVENDA,:VLRLIQITVENDA,:VLRPRODITVENDA,:SREFPROD,:SORIGFISC,
     :ICODEMP,:ICODFILIALTT,:SCODTRATTRIB,:TIPOFISC,:ICODEMP,:ICODFILIALME,:ICODMENS,:OBSITORC,
     :CODEMPAX,:CODFILIALAX,:CODALMOX);
  END

  EXECUTE PROCEDURE VDUPVENDAORCSP(:ICODEMP,:ICODFILIAL,:ICODORC,:ICODITORC,
                    :ICODFILIAL,:ICODVENDA,:ICODITVENDA,:STIPOVENDA);
end^


ALTER PROCEDURE VDADICVENDAORCSP (
    ICODORC INTEGER,
    ICODFILIAL SMALLINT,
    ICODEMP INTEGER,
    STIPOVENDA CHAR(10),
    NEWCODVENDA INTEGER)
RETURNS (
    IRET INTEGER)
AS
DECLARE VARIABLE ICODVENDA INTEGER;
DECLARE VARIABLE IFILIALVD SMALLINT;
DECLARE VARIABLE ICODTIPOMOV INTEGER;
DECLARE VARIABLE IFILIALTM SMALLINT;
DECLARE VARIABLE SSERIE CHAR(4);
DECLARE VARIABLE IFILIALSE SMALLINT;
DECLARE VARIABLE SSTATUSVENDA CHAR(2);
DECLARE VARIABLE DPERCCOMVEND NUMERIC(9,2);
DECLARE VARIABLE ICODVEND INTEGER;
DECLARE VARIABLE ICODFILIALVD INTEGER;
DECLARE VARIABLE ICODCLI INTEGER;
DECLARE VARIABLE ICODFILIALCL INTEGER;
DECLARE VARIABLE ICODPLANOPAG INTEGER;
DECLARE VARIABLE ICODFILIALPG INTEGER;
DECLARE VARIABLE USAPEDSEQ CHAR(1);
DECLARE VARIABLE ICONTA INTEGER;
DECLARE VARIABLE ICODCLCOMIS INTEGER;
DECLARE VARIABLE ICODFILIALCM INTEGER;
BEGIN

/*Cod. Tipo Mov e Sequencia:*/
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'EQTIPOMOV') INTO IFILIALTM;
  SELECT COUNT(P.TIPOPROD) FROM EQPRODUTO P, VDITORCAMENTO I WHERE
    P.CODPROD=I.CODPROD AND P.CODFILIAL=I.CODFILIALPD AND P.CODEMP=I.CODEMPPD
    AND P.TIPOPROD = 'S' AND I.CODORC=:ICODORC
    AND I.CODFILIAL=:ICODFILIAL AND I.CODEMP=:ICODEMP INTO ICONTA;
    
  IF (ICONTA > 0) THEN
    SELECT CODTIPOMOV4,USAPEDSEQ FROM SGPREFERE1
      WHERE CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL
      INTO ICODTIPOMOV,USAPEDSEQ;
  IF (ICODTIPOMOV IS NULL) THEN  /* CASO AINDA O IF DE CIMA NAO TENHA PREECHIDO... */
    SELECT CODTIPOMOV3,USAPEDSEQ FROM SGPREFERE1
      WHERE CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL
      INTO ICODTIPOMOV,USAPEDSEQ;

/*Informações basicas:*/

  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'VDVENDA') INTO IFILIALVD;
  IF (USAPEDSEQ='S') THEN
    SELECT ISEQ FROM SPGERANUM(:ICODEMP,:IFILIALVD,'VD') INTO ICODVENDA;
  ELSE
    IF ((:NEWCODVENDA > 0) AND (:NEWCODVENDA IS NOT NULL)) THEN
      ICODVENDA = :NEWCODVENDA;
    ELSE
      SELECT MAX(CODVENDA)+1 FROM VDVENDA
        WHERE CODEMP=:ICODEMP AND CODFILIAL=:IFILIALVD
        INTO ICODVENDA;

/*Serie:*/
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'LFSERIE') INTO IFILIALSE;
  SELECT SERIE FROM EQTIPOMOV WHERE CODEMP=:ICODEMP AND CODFILIAL=:IFILIALTM AND CODTIPOMOV=:ICODTIPOMOV INTO SSERIE;

/*Status:*/
  SSTATUSVENDA = 'P1';

/*Busca no orçamento:*/
  SELECT O.CODFILIALVD,O.CODVEND,O.CODFILIALCL,O.CODCLI,O.CODFILIALPG,
    O.CODPLANOPAG,VE.PERCCOMVEND,O.CODCLCOMIS,O.CODFILIALCM
    FROM VDORCAMENTO O, VDVENDEDOR VE WHERE O.CODORC=:ICODORC
    AND O.CODFILIAL=:ICODFILIAL AND O.CODEMP=:ICODEMP
    AND VE.CODEMP=O.CODEMP AND VE.CODFILIAL=O.CODFILIALVD
    AND VE.CODVEND=O.CODVEND INTO
           :ICODFILIALVD,:ICODVEND,:ICODFILIALCL,:ICODCLI,
           :ICODFILIALPG,:ICODPLANOPAG,DPERCCOMVEND,:ICODCLCOMIS,:ICODFILIALCM;

  INSERT INTO VDVENDA (CODEMP,CODFILIAL,CODVENDA,TIPOVENDA,CODEMPVD,CODFILIALVD,CODVEND,CODEMPCL,CODFILIALCL,CODCLI,
                CODEMPPG,CODFILIALPG,CODPLANOPAG,CODEMPSE,CODFILIALSE,SERIE,CODEMPTM,CODFILIALTM,
                CODTIPOMOV,DTSAIDAVENDA,DTEMITVENDA,STATUSVENDA,PERCCOMISVENDA,CODCLCOMIS,CODFILIALCM,CODEMPCM)
                VALUES (:ICODEMP,:IFILIALVD,:ICODVENDA,:STIPOVENDA,:ICODEMP,:ICODFILIALVD,
                :ICODVEND,:ICODEMP,:ICODFILIALCL,:ICODCLI,:ICODEMP,:ICODFILIALPG,:ICODPLANOPAG,
                :ICODEMP,:IFILIALSE,:SSERIE,:ICODEMP,:IFILIALTM,:ICODTIPOMOV,
                CAST('today' AS DATE),CAST('today' AS DATE),:SSTATUSVENDA,:DPERCCOMVEND,:ICODCLCOMIS,:ICODFILIALCM,:ICODEMP);

  IRET = ICODVENDA;

  SUSPEND;
END^


ALTER PROCEDURE VDBAIXACOMISSAOSP (
    STIPO CHAR(1),
    DINI DATE,
    DFIM DATE,
    ICODVEND INTEGER,
    ICODEMPVD INTEGER,
    ICODFILIALVD SMALLINT,
    SCODCONTA CHAR(10),
    ICODEMPCA INTEGER,
    ICODFILIALCA SMALLINT,
    SCODPLAN CHAR(13),
    ICODEMPPN INTEGER,
    ICODFILIALPN SMALLINT,
    DDATA DATE,
    IDOC INTEGER,
    DVLR NUMERIC(15,5),
    SOBS CHAR(50),
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT)
AS
DECLARE VARIABLE ICODPCOMI INTEGER;
DECLARE VARIABLE ICODCOMI INTEGER;
DECLARE VARIABLE ICODEMPCOMI INTEGER;
DECLARE VARIABLE ICODFILIALCOMI INTEGER;
DECLARE VARIABLE CFLAG CHAR(1);
DECLARE VARIABLE IFILIALPCOMI INTEGER;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'FNPAGTOCOMI') INTO IFILIALPCOMI;
  SELECT ISEQ FROM SPGERANUM(:ICODEMP,:IFILIALPCOMI,'CI') INTO ICODPCOMI;
  INSERT INTO FNPAGTOCOMI(CODEMP,CODFILIAL,CODPCOMI,CODEMPCA,CODFILIALCA,NUMCONTA,CODEMPPN,CODFILIALPN,CODPLAN,DATAPCOMI,DOCPCOMI,VLRPCOMI,OBSPCOMI)
         VALUES (
                :ICODEMP,:IFILIALPCOMI,:iCodPComi,:ICODEMPCA,:ICODFILIALCA,:sCodConta,:ICODEMPPN,:ICODFILIALPN,:sCodPlan,:dData,:iDoc,:dVlr,:sObs
         );
  FOR SELECT C.CODCOMI,C.CODEMP,C.CODFILIAL,C.FLAG FROM VDCOMISSAO C,FNRECEBER R WHERE R.CODVEND=:iCodVend
               AND R.CODEMPVD=:ICODEMPVD AND R.CODFILIALVD=:ICODFILIALVD
               AND C.CODREC=R.CODREC AND C.CODEMPRC=R.CODEMP AND C.CODFILIALRC=R.CODFILIAL
               AND ( (:STIPO='E') OR  (C.DTVENCCOMI BETWEEN :dIni AND :dFim) )
               AND ( (:STIPO='V') OR  (C.DATACOMI BETWEEN :dIni AND :dFim) )
               AND STATUSCOMI='C2'
               AND R.CODEMP=:ICODEMP AND R.CODFILIAL=:ICODFILIAL
               INTO :iCodComi,:iCodEmpComi,:iCodFilialComi,:cFLAG DO
  BEGIN
     UPDATE VDCOMISSAO SET VLRPAGOCOMI=VLRAPAGCOMI, CODPCOMI=:iCodPComi,CODEMPCI=:ICODEMP,
        CODFILIALCI=:IFILIALPCOMI,STATUSCOMI='CP',DTPAGTOCOMI=:dData,FLAG=:cFLAG
      WHERE CODCOMI=:iCodComi AND CODEMP=:iCodEmpComi AND CODFILIAL=:iCodFilialComi;
  END
END^


ALTER PROCEDURE VDBLOQVENDASP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    CTIPOVENDA CHAR(1),
    ICODVENDA INTEGER,
    CBLOQVENDA CHAR(1))
AS
begin
  /* Stored procedure de bloqueio e desbloqueio de venda*/
  UPDATE VDVENDA SET EMMANUT='S', BLOQVENDA=:CBLOQVENDA WHERE CODEMP=:ICODEMP AND
     CODFILIAL=:SCODFILIAL AND TIPOVENDA=:CTIPOVENDA AND CODVENDA=:ICODVENDA;
  UPDATE VDVENDA SET EMMANUT='N' WHERE CODEMP=:ICODEMP AND
     CODFILIAL=:SCODFILIAL AND TIPOVENDA=:CTIPOVENDA AND CODVENDA=:ICODVENDA;
  suspend;
end^


ALTER PROCEDURE VDBUSCAPRECOSP (
    ICODPROD INTEGER,
    ICODCLI INTEGER,
    ICODEMPCL INTEGER,
    ICODFILIALCL SMALLINT,
    ICODPLANOPAG INTEGER,
    ICODEMPPG INTEGER,
    ICODFILIALPG SMALLINT,
    ICODTIPOMOV INTEGER,
    ICODEMPTM INTEGER,
    ICODFILIALTM SMALLINT,
    ICODEMP INTEGER,
    ICODFILIAL SMALLINT)
RETURNS (
    PRECO NUMERIC(18,2))
AS
DECLARE VARIABLE iCodTab INTEGER;
  DECLARE VARIABLE iCodEmpTab INTEGER;
  DECLARE VARIABLE iCodFilialTab SMALLINT;
  DECLARE VARIABLE iCodClasCli INTEGER;
  DECLARE VARIABLE iCodEmpClasCli INTEGER;
  DECLARE VARIABLE iCodFilialClasCli SMALLINT;
BEGIN
  SELECT CODTAB,CODEMPTB,CODFILIALTB FROM EQTIPOMOV WHERE CODTIPOMOV=:iCodTipoMov
         AND CODEMP=:ICODEMPTM AND CODFILIAL=:ICODFILIALTM INTO :iCodTab,:iCodEmpTab,:iCodFilialTab;
  SELECT CODCLASCLI,CODEMPCC,CODFILIALCC FROM VDCLIENTE WHERE CODCLI=:iCodCli
         AND CODEMP=:ICODEMPCL AND CODFILIAL=:ICODFILIALCL INTO :iCodClasCli,:iCodEmpClasCli,iCodFilialClasCli;
  SELECT PRECOPROD FROM VDPRECOPROD WHERE CODPROD=:iCodProd
         AND CODPLANOPAG=:iCodPlanoPag
         AND CODEMPPG=:ICODEMPPG
         AND CODFILIALPG=:ICODFILIALPG
         AND CODTAB=:iCodTab
         AND CODEMPTB=:iCodEmpTab
         AND CODFILIALTB=:iCodFilialTab
         AND CODCLASCLI=:iCodClasCli
         AND CODEMPCC=:iCodEmpClasCli
         AND CODFILIALCC=:iCodFilialClasCli
         AND CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL INTO :Preco;
  if ((Preco IS NULL) OR (Preco = 0)) THEN
  BEGIN
    SELECT MAX(PRECOPROD) FROM VDPRECOPROD WHERE CODPROD=:iCodProd
         AND CODPLANOPAG=:iCodPlanoPag
         AND CODEMPPG=:ICODEMPPG
         AND CODFILIALPG=:ICODFILIALPG
         AND CODTAB=:iCodTab
         AND CODEMPTB=:iCodEmpTab
         AND CODFILIALTB=:iCodFilialTab
         AND CODCLASCLI IS NULL
         AND CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL INTO :Preco;
  END
  /*Se ainda não conseguiu pagar o preco.*/
  if ((Preco IS NULL) OR (Preco = 0)) THEN
  BEGIN
    SELECT PRECOBASEPROD FROM EQPRODUTO WHERE CODPROD=:ICODPROD AND
      CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL INTO :Preco;
  END
  SUSPEND;
END^


ALTER PROCEDURE VDCLIENTEATIVOSP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODCLI INTEGER)
AS
DECLARE VARIABLE CATIVOCLI CHAR(1);
begin
  SELECT ATIVOCLI FROM VDCLIENTE WHERE CODEMP=:ICODEMP AND
    CODFILIAL=:SCODFILIAL AND CODCLI=:ICODCLI
    INTO :CATIVOCLI;
  IF ( (CATIVOCLI IS NOT NULL) AND (CATIVOCLI='N') ) then
     exception vdvendaex01 'CLIENTE INATIVO!';
  suspend;
end^


ALTER PROCEDURE VDCOPIAORCSP (
    CODEMP INTEGER,
    CODFILIAL INTEGER,
    CODORC INTEGER,
    CODFILIALCL INTEGER,
    CODCLI INTEGER)
RETURNS (
    IRET INTEGER)
AS
DECLARE VARIABLE ICODORC INTEGER;
DECLARE VARIABLE ICODFILIALPF INTEGER;
DECLARE VARIABLE CUSAORCSEQ CHAR(1);
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(:CODEMP, 'SGPREFERE1')
    INTO :ICODFILIALPF;
  SELECT USAORCSEQ FROM SGPREFERE1 P
     WHERE P.CODEMP=:CODEMP AND P.CODFILIAL=:ICODFILIALPF
     INTO :CUSAORCSEQ;
  IF (CUSAORCSEQ='S') THEN
  BEGIN
     SELECT ISEQ FROM SPGERANUM(:CODEMP,:CODFILIAL,'OC') INTO ICODORC;
  END
  ELSE
  BEGIN
     SELECT COALESCE(MAX(O.CODORC),0)+1 FROM VDORCAMENTO O
       WHERE O.CODEMP=:CODEMP AND O.CODFILIAL=:CODFILIAL AND
       O.TIPOORC='O' INTO ICODORC;
  END

  INSERT INTO VDORCAMENTO (CODEMP,CODFILIAL,TIPOORC,CODORC,
    CODEMPAE,CODFILIALAE,CODATEND,CODEMPCV,CODFILIALCV,CODCONV,
    DTORC,DTVENCORC,VLRPRODORC,PERCDESCORC,VLRDESCORC,VLRADICORC,
    VLRDESCITORC,VLRLIQORC,STATUSORC,OBSORC,CODPLANOPAG,CODFILIALPG,
    CODEMPPG,TXT01,CODEMPVD,CODFILIALVD,CODVEND,CODEMPCL,CODFILIALCL,
    CODCLI,CODTPCONV,CODFILIALTC,CODEMPTC,PRAZOENTORC)
    SELECT CODEMP,CODFILIAL,'O',:ICODORC,CODEMPAE,CODFILIALAE,
      CODATEND,CODEMPCV,CODFILIALCV,CODCONV,DTORC,DTVENCORC,VLRPRODORC,
      PERCDESCORC,VLRDESCORC,VLRADICORC,VLRDESCITORC,VLRLIQORC,
      STATUSORC,OBSORC,CODPLANOPAG,CODFILIALPG,CODEMPPG,TXT01,CODEMPVD,
      CODFILIALVD,CODVEND,:CODEMP,:CODFILIALCL,:CODCLI,CODTPCONV,
      CODFILIALTC,CODEMPTC,PRAZOENTORC FROM VDORCAMENTO WHERE
      CODORC=:CODORC AND CODEMP=:CODEMP AND CODFILIAL=:CODFILIAL;

  INSERT INTO VDITORCAMENTO (CODEMP,CODFILIAL,TIPOORC,CODORC,CODITORC,
    CODEMPPD,CODFILIALPD,CODPROD,QTDITORC,PRECOITORC,PERCDESCITORC,
    VLRDESCITORC,VLRLIQITORC,VLRPRODITORC,REFPROD,NUMAUTORIZORC,ACEITEITORC,
    APROVITORC,EMITITORC,VENCAUTORIZORC,STRDESCITORC,OBSITORC,
    CODEMPAX, CODFILIALAX, CODALMOX)
    SELECT CODEMP,CODFILIAL,TIPOORC,:ICODORC,CODITORC,
      CODEMPPD,CODFILIALPD,CODPROD,QTDITORC,PRECOITORC,PERCDESCITORC,
      VLRDESCITORC,VLRLIQITORC,VLRPRODITORC,REFPROD,NUMAUTORIZORC,ACEITEITORC,
      APROVITORC,EMITITORC,VENCAUTORIZORC,STRDESCITORC,OBSITORC,
      CODEMPAX, CODFILIALAX, CODALMOX
      FROM VDITORCAMENTO WHERE CODORC=:CODORC AND CODEMP=:CODEMP
      AND CODFILIAL=:CODFILIAL;
  IRET = ICODORC;
  SUSPEND;
END^


ALTER PROCEDURE VDDESBAIXACOMISSAOSP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODVEND INTEGER,
    CORDEM CHAR(1),
    DINI DATE,
    DFIM DATE)
AS
DECLARE VARIABLE SCODFILIALCI SMALLINT;
DECLARE VARIABLE ICODPCOMI INTEGER;
DECLARE VARIABLE IQTD INTEGER;
begin
  /* Procedure Text */
  FOR SELECT CODFILIALCI,CODPCOMI,COUNT(*)
     FROM VDCOMISSAO C, FNRECEBER R
     WHERE R.CODEMPVD = :ICODEMP AND R.CODFILIALVD = :SCODFILIAL AND R.CODVEND = :ICODVEND AND
        C.CODREC = R.CODREC AND C.CODEMPRC = R.CODEMP AND C.CODFILIALRC = R.CODFILIAL AND
        C.STATUSCOMI = 'CP' AND C.CODPCOMI IS NOT NULL AND
         ( (:CORDEM = 'V')  OR (C.DATACOMI BETWEEN :DINI AND :DFIM) ) AND
         ( (:CORDEM = 'E')  OR (C.DTVENCCOMI BETWEEN :DINI AND :DFIM) )
         GROUP BY CODFILIALCI,CODPCOMI
         INTO  :SCODFILIALCI, :ICODPCOMI, :IQTD
         DO
     BEGIN
        UPDATE VDCOMISSAO SET STATUSCOMI='CD'
           WHERE CODEMPCI=:ICODEMP AND
             CODFILIALCI=:SCODFILIALCI AND
             CODPCOMI=:ICODPCOMI;
        DELETE FROM FNPAGTOCOMI
           WHERE CODEMP=:ICODEMP AND
             CODFILIAL=:SCODFILIALCI AND
             CODPCOMI=:ICODPCOMI;
     END
  suspend;
end^


ALTER PROCEDURE VDESTORNACOMISSAOSP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODEMPVD INTEGER,
    SCODFILIALVD SMALLINT,
    ICODVEND INTEGER,
    DINI DATE,
    DFIM DATE,
    CORDEM CHAR(1))
AS
declare variable icodcomi integer;
declare variable icodemprc integer;
declare variable scodfilialrc smallint;
declare variable icodrec integer;
declare variable inparcitrec integer;
declare variable nvlrvendacomi numeric(15,5);
declare variable nvlrcomi numeric(15,5);
declare variable ddatacomi date;
declare variable ddtvenccomi date;
declare variable ctipocomi char(1);
declare variable cstatuscomi char(2);
declare variable datual date;
declare variable cstatusitrec char(2);
declare variable ddtvencitrec date;
begin
  /* Procedure Text */
  DATUAL = CAST( 'now' AS DATE);
  FOR SELECT C.CODCOMI,C.CODEMPRC, C.CODFILIALRC , C.CODREC, C.NPARCITREC,
      C.VLRVENDACOMI, C.VLRCOMI, C.DATACOMI , C.DTVENCCOMI,
      C.TIPOCOMI, C.STATUSCOMI , IR.STATUSITREC, IR.DTVENCITREC
    FROM VDCOMISSAO C, FNITRECEBER IR, FNRECEBER R
    WHERE C.CODEMP=:ICODEMP AND C.CODFILIAL=:SCODFILIAL AND
       IR.CODEMP=C.CODEMPRC AND IR.CODFILIAL=C.CODFILIALRC AND
       IR.CODREC=C.CODREC AND IR.NPARCITREC=C.NPARCITREC AND
       R.CODEMP=C.CODEMPRC AND R.CODFILIAL=C.CODFILIALRC AND
       R.CODREC=C.CODREC AND R.CODEMPVD=:ICODEMPVD AND
       R.CODFILIALVD=:SCODFILIALVD AND R.CODVEND=:ICODVEND AND
       ( (:CORDEM = 'V')  OR (C.DATACOMI BETWEEN :DINI AND :DFIM) ) AND
       ( (:CORDEM = 'E')  OR (C.DTVENCCOMI BETWEEN :DINI AND :DFIM) ) AND
       C.STATUSCOMI IN ('C2','CP') AND
       IR.STATUSITREC NOT IN ('RP') AND
       NOT EXISTS(SELECT * FROM VDCOMISSAO C2 /* Sub-select para verificar a */
          /* existencia de estorno anterior. */
         WHERE C2.CODEMPRC=C.CODEMPRC AND C2.CODFILIALRC=C.CODFILIALRC AND
         C2.CODREC=C.CODREC AND C2.NPARCITREC=C.NPARCITREC AND
         C2.TIPOCOMI=C.TIPOCOMI AND C2.STATUSCOMI IN ('CE') )
    INTO :ICODCOMI, :ICODEMPRC, :SCODFILIALRC, :ICODREC, :INPARCITREC, :NVLRVENDACOMI,
      :NVLRCOMI, :DDATACOMI, :DDTVENCCOMI, :CTIPOCOMI, :CSTATUSCOMI, :CSTATUSITREC,
      :DDTVENCITREC
  DO
  BEGIN
     IF ( (DATUAL>DDTVENCITREC) AND (CSTATUSCOMI='C2') ) THEN
     /* Caso a data atual seja maior que a data de vencimento e a */
     /* comissão não esteja paga, passa o status da comissão para não */
     /* liberada. */
     BEGIN
        UPDATE VDCOMISSAO SET STATUSCOMI='C1'
          WHERE CODEMP=:ICODEMP AND CODFILIAL=:SCODFILIAL AND
            CODCOMI=:ICODCOMI;
     END
     ELSE IF ( (DATUAL>DDTVENCITREC) AND (CSTATUSCOMI='CP') ) THEN
     /* Caso a comissão esteja paga e a parcela esteja vencida, */
     /* gera um estorno da comissão. */
     BEGIN
        NVLRCOMI = NVLRCOMI * -1; /* Transforma o valor da comissão em negativo */
        /* para gerar estorno */
        EXECUTE PROCEDURE vdadiccomissaosp(:ICODEMPRC,:SCODFILIALRC,:ICODREC,
          :INPARCITREC, :NVLRVENDACOMI, :NVLRCOMI, :DDATACOMI , :DDTVENCITREC,
          :CTIPOCOMI, :icodempvd, :scodfilialvd, : icodvend );
     END
  END
  suspend;
end^


ALTER PROCEDURE VDEVOLUVENDAS (
    ICODEMP SMALLINT,
    ICODFILIAL SMALLINT,
    DATAINI DATE,
    DATAFIM DATE,
    ICODTIPOCLI SMALLINT,
    ICODCLI SMALLINT,
    FILTRAVENDAS CHAR(1))
RETURNS (
    VALOR NUMERIC(15,5),
    MES SMALLINT,
    ANO SMALLINT)
AS
DECLARE VARIABLE VALORTMP NUMERIC(15, 5);
DECLARE VARIABLE DATATMP DATE;
DECLARE VARIABLE MESTMP SMALLINT;
DECLARE VARIABLE ANOTMP SMALLINT;
DECLARE VARIABLE MESANT SMALLINT;
DECLARE VARIABLE ANOANT SMALLINT;
DECLARE VARIABLE VALORANT NUMERIC(15, 5);
DECLARE VARIABLE ENVIOU CHAR(1);
begin
  /* Retorna os valores de vendas por período */
  VALOR = 0;
  VALORANT = 0;
  ENVIOU = 'N';

  FOR select sum(v.vlrliqvenda),v.dtemitvenda from vdvenda v, vdcliente c, eqtipomov tm
             where c.codcli=v.codcli and c.codemp=v.codempcl and c.codfilial=v.codfilialcl
             and v.dtemitvenda between :DATAINI and :DATAFIM and v.codemp = :ICODEMP
             and v.codfilial = :ICODFILIAL
             and tm.codemp=v.codemptm and tm.codfilial=v.codfilialtm and tm.codtipomov=v.codtipomov
             and ( (c.codtipocli=:ICODTIPOCLI) or (:ICODTIPOCLI is null) )
             and ( (v.codcli=:ICODCLI) or (:ICODCLI is null) )
             and ( (tm.tipomov in(select tm2.tipomov from eqtipomov tm2 where tm2.codemp=v.codemptm and tm2.codfilial=v.codfilialtm and tm2.somavdtipomov='S')) or (:FILTRAVENDAS='N') )
             group by v.dtemitvenda order by v.dtemitvenda
      into VALORTMP,DATATMP do
      BEGIN
        MESTMP = extract(MONTH from DATATMP);
        ANOTMP = extract(YEAR from DATATMP);
        VALOR=VALOR+VALORANT;
        MES=MESANT;
        ANO=ANOANT;
        if ((not MESANT = MESTMP or not ANOANT = ANOTMP) AND not MESANT is null) then
        begin
          suspend;
          ENVIOU = 'S';
          VALOR = 0;
          MESANT=MESTMP;
          ANOANT=ANOTMP;
          VALORANT=VALORTMP;
        end
        ELSE
        BEGIN
          MESANT=MESTMP;
          ANOANT=ANOTMP;
          VALORANT=VALORTMP;
        END
      END

     VALOR=VALOR+VALORANT;
     MES=MESANT;
     ANO=ANOANT;
     suspend;
end^


ALTER PROCEDURE VDGERACOMISSAOSP (
    ICODEMP INTEGER,
    SCODFILIAL SMALLINT,
    ICODREC INTEGER,
    INPARCITREC INTEGER,
    NVLRCOMIITREC NUMERIC(15,5),
    DDTVENCITREC DATE)
AS
declare variable icodempva integer;
declare variable scodfilialva smallint;
declare variable ctipovenda char(3);
declare variable icodvenda integer;
declare variable icodempcm integer;
declare variable scodfilialcm smallint;
declare variable icodclcomis integer;
declare variable nvlrvendacomi numeric(15,5);
declare variable ddatacomi date;
declare variable npercfatclcomis numeric(9,2);
declare variable npercpgtoclcomis numeric(9,2);
declare variable ctipocomi char(1);
declare variable nvlrcomi numeric(15,5);
declare variable i integer;
declare variable icodemptm integer;
declare variable scodfilialtm smallint;
declare variable icodtipomov integer;
declare variable cmulticomis char(1);
declare variable icodempvd integer; /* Código da empresa do comissionado principal */
declare variable scodfilialvd smallint; /* Código da filial do comissionado principal */
declare variable icodvend integer; /* Código do comissionado principal */
declare variable nperccomisvendadic numeric(15,2); /* Percentual de comissão para cada comissionado adicional */
declare variable nvlrcomiadic numeric(15,5); /* Valor total da comissão para os comissionados adicionais. */
declare variable icodempvdadic integer; /* Código da empresa do comissionado adicional */
declare variable scodfilialvdadic smallint; /* Código da filial do comissionado adicional */
declare variable icodvendadic integer; /* Código do comissionado adicional */
declare variable nvlrcomiparc numeric(15,5); /* Valor da comissão por vendedor parcial. */
begin
    /* Gera as comissões a pagar na tabela VDCOMISSAO */


    nvlrcomiadic = 0;

    select r.codempva, r.codfilialva, r.tipovenda, r.codvenda,
        v.codempcm, v.codfilialcm, v.codclcomis, ( v.vlrprodvenda - v.vlrdescvenda ),
        v.dtemitvenda, cm.percfatclcomis, cm.percpgtoclcomis,
        v.codemptm, v.codfilialtm, v.codtipomov,
        v.codempvd, v.codfilialvd, v.codvend
        from fnreceber r, vdvenda v, vdclcomis cm
        where r.codemp=:icodemp and r.codfilial=:scodfilial and r.codrec=:icodrec
            and v.codemp=r.codempva and v.codfilial=r.codfilialva and v.tipovenda=r.tipovenda
            and v.codvenda=r.codvenda and cm.codemp=v.codempcm and cm.codfilial=v.codfilialcm
            and cm.codclcomis=v.codclcomis
    into :icodempva, :scodfilialva, :ctipovenda, :icodvenda,
         :icodempcm, :scodfilialcm, :icodclcomis, :nvlrvendacomi,
         :ddatacomi, :npercfatclcomis, :npercpgtoclcomis,
         :icodemptm, :scodfilialtm, :icodtipomov,
         :icodempvd, :scodfilialvd, :icodvend ;

    /*Verifica se deve utilizar mecanismo de multiplos comissionados*/

    select cmulticomis from sgretmulticomissp(:icodemp, :icodemptm, :scodfilialtm, :icodtipomov)
        into cmulticomis;

    if(cmulticomis = 'S') then
    begin

        /*Implementação do mecanismo de multiplos comissionados*/
        
        for select vc.codempvd, vc.codfilialvd, vc.codvend, vc.percvc
            from vdvendacomis vc
            where vc.codemp=:icodempva and vc.codfilial=:scodfilialva and vc.codvenda=:icodvenda
                and vc.tipovenda=:ctipovenda and vc.codvend is not null
        into :icodempvdadic, :scodfilialvdadic, :icodvendadic, :nperccomisvendadic do
        begin

            /* Calcula o valor da comissão proporcional para cada comissionado adicional*/

            nvlrcomi = cast( ( nvlrcomiitrec * nperccomisvendadic / 100 ) as numeric(15,5));
            I = 1;
            while (:I<=2) do
            begin
                if (I=1) then
                    begin
                        ctipocomi='F';
                        nvlrcomiparc = cast( ( nvlrcomi * npercfatclcomis / 100 ) as NUMERIC(15, 5));
                    end
                else
                    begin
                        ctipocomi='R';
                        nvlrcomiparc = cast( (nvlrcomi * npercpgtoclcomis / 100 ) as NUMERIC(15, 5));
                    end
                execute procedure vdadiccomissaosp(:iCodEmp, :sCodFilial, :iCodRec, :iNParcItRec,
                    :nVlrVendaComi, :nvlrcomiparc, :dDataComi, :dDtVencItRec, cTipoComi,:icodempvdadic, :scodfilialvdadic, :icodvendadic );
                I=I+1;
                /*Acumula as comissões adicionais para posteriormente descontar do valor principal*/
                nvlrcomiadic = nvlrcomiadic + nvlrcomiparc;

           /*     exception vdcomissaoex02 'rodou procedure para o vendedor:' || cast(:icodempvdadic as char(2)) || '-' || cast(:scodfilialvdadic as char(2)) || '-' || cast(:icodvendadic as char(2)) || '-' || ' - nvlrcomiadic:' || cast(nvlrcomiadic as char(20));*/

            end

        end

    end

    /*Comissionamento do vendedor principal*/

    I = 1;
    while (:I<=2) do
        begin
            if (I=1) then
                begin
                    ctipocomi='F';
                    nvlrcomi = cast( ( (nvlrcomiitrec - nvlrcomiadic ) * nPercFatClComis / 100 ) as numeric(15, 5) );
                end
            else
                begin
                    ctipocomi='R';
                    nvlrcomi = cast( ( (nvlrcomiitrec - nvlrcomiadic ) * nPercPgtoClComis / 100 ) as numeric(15, 5));
                end
/*
                exception vdcomissaoex01 ''
                || cast(:icodempvd as char(2)) || '-' || cast(:scodfilialvd as char(2)) || '-' || cast(:icodvend as char(2))
                || 'nvlrcomi:' || cast(:nvlrcomi as char(20))
                || 'nvlrvendacomi:' || cast(:nvlrvendacomi as char(20));
  */
            execute procedure vdadiccomissaosp(:icodemp, :scodfilial, :icodrec, :inparcitrec,
                :nvlrvendacomi, :nvlrcomi, :ddatacomi, :ddtvencitrec, ctipocomi, :icodempvd, :scodfilialvd, :icodvend );


            I=I+1;
        end

        suspend;
end^


ALTER PROCEDURE VDGERAESTORNOCOMISP
AS
begin
  /* Procedure Text */

  suspend;
end^


ALTER PROCEDURE VDRETULTVDCLIPROD (
    ICODEMP INTEGER,
    ICODCLI INTEGER,
    ICODFILIALVD SMALLINT,
    ICODVEND INTEGER,
    DTINI DATE,
    DTFIM DATE)
RETURNS (
    RAZCLI_RET CHAR(50),
    CODCLI_RET INTEGER,
    DESCPROD_RET CHAR(50),
    CODPROD_RET INTEGER,
    DTEMITVENDA_RET DATE,
    DOCVENDA_RET INTEGER,
    SERIE_RET CHAR(4),
    PRECOVENDA_RET NUMERIC(15,4))
AS
DECLARE VARIABLE ICODFILIAL SMALLINT;
DECLARE VARIABLE ICODPROD INTEGER;
begin

    select icodfilial from sgretfilial(:ICODEMP,'VDVENDA') into :ICODFILIAL;

    for select v.codcli,iv.codprod
        from vdvenda v, vditvenda iv
        where
            iv.codemp=v.codemp and iv.codfilial=v.codfilial
            and iv.tipovenda=v.TIPOVENDA and iv.codvenda=v.codvenda
            and v.codemp=:ICODEMP and v.codfilial=:ICODFILIAL
            and (v.codcli=:ICODCLI or :ICODCLI is null)
            and (v.codvend=:ICODVEND or :ICODVEND is null )
            and v.dtemitvenda between :DTINI and :DTFIM
        group by v.codcli,iv.codprod into :ICODCLI,:ICODPROD
    do
    begin
        select first 1 c.razcli, c.codcli, p.descprod, iv.codprod, v.dtemitvenda, v.docvenda, v.serie,
            (iv.vlrliqitvenda/(case when iv.qtditvenda=0 then 1 else iv.qtditvenda end)) precovenda
        from vdcliente c, vdvenda v, vditvenda iv, eqproduto p
        where
            c.codemp=v.codempcl and c.codfilial=v.codfilialcl and c.codcli=v.codcli
            and c.codemp=v.codempcl and c.codfilial=v.codfilialcl and iv.codemp=v.codemp
            and iv.codfilial=v.codfilial and iv.tipovenda=v.tipovenda and iv.codvenda=v.codvenda
            and p.codemp=iv.codemppd and p.codfilial=iv.codfilialpd and p.codprod=iv.codprod
            and v.codempvd=:ICODEMP and v.codfilialvd=:ICODFILIALVD and (v.codvend=:ICODVEND or :ICODVEND is null )
            and v.dtemitvenda between :DTINI and :DTFIM and c.codcli=:ICODCLI and codprod=:ICODPROD
            order by v.dtemitvenda desc
            into :RAZCLI_RET, :CODCLI_RET, :DESCPROD_RET, :CODPROD_RET, :DTEMITVENDA_RET, :DOCVENDA_RET, :SERIE_RET,
                 :PRECOVENDA_RET;
            suspend;
    end
end^


ALTER PROCEDURE VDUPVENDAORCSP (
    ICODEMP INTEGER,
    ICODFILIAL INTEGER,
    ICODORC INTEGER,
    ICODITORC INTEGER,
    ICODFILIALVD INTEGER,
    ICODVENDA INTEGER,
    ICODITVENDA INTEGER,
    STIPOVENDA CHAR(10))
AS
DECLARE VARIABLE ICONTA1 INTEGER;
DECLARE VARIABLE ICONTA2 INTEGER;
begin
  /* Procedure Text */
  
  UPDATE VDITORCAMENTO SET EMITITORC='S' WHERE CODITORC=:ICODITORC AND CODORC=:ICODORC
    AND CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL;
    
  SELECT COUNT(*) FROM VDITORCAMENTO WHERE CODORC=:ICODORC
    AND CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL AND EMITITORC='S' INTO ICONTA1;
  SELECT COUNT(*) FROM VDITORCAMENTO WHERE CODORC=:ICODORC
    AND CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL INTO ICONTA2;

  IF (ICONTA1 = ICONTA2) THEN
  BEGIN
    UPDATE VDORCAMENTO SET STATUSORC='OV' WHERE
      CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL AND
      CODORC=:ICODORC;
  END

  INSERT INTO VDVENDAORC (CODEMP,CODFILIAL,TIPOVENDA,CODVENDA,CODITVENDA,
                          CODEMPOR,CODFILIALOR,TIPOORC,CODORC,CODITORC) VALUES
                         (:ICODEMP,:ICODFILIALVD,:STIPOVENDA,:ICODVENDA,:ICODITVENDA,
                          :ICODEMP,:ICODFILIAL,'O',:ICODORC,:ICODITORC);
  suspend;
end^



SET TERM ; ^


/******************************************************************************/
/*                                   Roles                                    */
/******************************************************************************/

CREATE ROLE ADM;


/******************************************************************************/
/*                                Descriptions                                */
/******************************************************************************/

DESCRIBE TABLE ATATENDENTE
'Atendentes.';

DESCRIBE TABLE ATENCAMINHADOR
'Tabela de empresas encaminhadoras de conveniados';

DESCRIBE TABLE CPTIPOFOR
'Tabela de tipos de fornecedores.';

DESCRIBE TABLE EQALMOX
'Tabela de almoxarifados.';

DESCRIBE TABLE EQALMOXFILIAL
'Amarração Almoxarifado x Filiais.';

DESCRIBE TABLE EQCLIFOR
'Amarração Cliente x Fornecedor.';

DESCRIBE TABLE EQCODALTPROD
'Tabela de códigos alternativos para produtos.';

DESCRIBE TABLE EQITRMA
'Ítens de RMA.';

DESCRIBE TABLE EQMODLOTE
'Tabela de modelos de lotes, para geração automatica de lotes a partir da Ordem de produção.';

DESCRIBE TABLE EQPRODACESSO
'Tabela de controle de acesso do produto para RMA, PDV e outras implementações futuras.';

DESCRIBE TABLE EQPRODPLAN
'Tabela de vínculo produto x planejamento, para uso nos rateios.';

DESCRIBE TABLE EQSALDOLOTE
'Tabelas de saldos por lote e almoxarifado.';

DESCRIBE TABLE EQTIPOMOVUSU
'Tabela de vínculo de tipos de movimento com usuários.';

DESCRIBE TABLE FNBANCO
'Bancos.';

DESCRIBE TABLE FNCARTCOB
'Carteiras de cobrança.';

DESCRIBE TABLE FNHISTPAD
'Tabela de histórico padrão.';

DESCRIBE TABLE FNITMODBOLETO
'Tabela de amarração modelo de boleto e banco';

DESCRIBE TABLE FNITTBJUROS
'Itens das tabelas de juros.
';

DESCRIBE TABLE FNRESTRICAO
'Tabela de restrições dos clientes.';

DESCRIBE TABLE FNTBJUROS
'Tabela de juros financeiros
';

DESCRIBE TABLE FNTIPORESTR
'Tipos de restrições.';

DESCRIBE TABLE PPDISTRIB
'Distribuição da estrutura para mais de um produto final.';

DESCRIBE TABLE PPESTRUANALISE
'Cadastro de etapas de analise e controle de qualidade, previstas para a estrutura de um produto.';

DESCRIBE TABLE PPESTRUFASE
'Vínculo estrutura, fase de produção e recursos de produção.
';

DESCRIBE TABLE PPESTRUTURA
'Estrutura de produtos.';

DESCRIBE TABLE PPFASE
'Fases de produção
';

DESCRIBE TABLE PPFOTOMTAN
'Fotos das características dos métodos analíticos.';

DESCRIBE TABLE PPITESTRUTURA
'Ítens de estrutura de produtos.';

DESCRIBE TABLE PPITOP
'Ítens de ordens de produção.';

DESCRIBE TABLE PPMETODOANALISE
'Cadastro de métodos de análise.';

DESCRIBE TABLE PPOP
'Ordens de produção.';

DESCRIBE TABLE PPOPACAOCORRET
'Cadastro de ações corretivas.';

DESCRIBE TABLE PPOPCQ
'Cadastros de lançamento de resultados de análises de controle de qualidade.';

DESCRIBE TABLE PPOPFASE
'Vínculo OP x Fase
';

DESCRIBE TABLE PPRECURSO
'Recursos de produção
';

DESCRIBE TABLE PPRETCP
'Retenção de contra-provas (controle de qualidade).';

DESCRIBE TABLE PPTIPOANALISE
'Tabela para cadastro dos tipos de análise de controle de qualidade.';

DESCRIBE TABLE PPTIPOREC
'Tipos de recurso de produção.
';

DESCRIBE TABLE RHAREA
'Areas de negócio para cursos e vagas módulo RH (Recrutamento e seleção).';

DESCRIBE TABLE RHBENEFICIO
'Cadastro de benefícios.';

DESCRIBE TABLE RHCANDIDATO
'Cadastro de candidatos a vaga para uso no módulo de recrutamento e seleção.';

DESCRIBE TABLE RHCANDIDATOCARAC
'Tabela de vinculo entre candidatos e suas caracteristicas.';

DESCRIBE TABLE RHCANDIDATOCURSO
'Tabela de vinculo entre candidatos e cursos.';

DESCRIBE TABLE RHCANDIDATOFUNC
'Tabela de vinculo entre candidatos e funcoes exercidas.';

DESCRIBE TABLE RHCANDIDATOSTATUS
'Tabela de histórico dos status do candidato.';

DESCRIBE TABLE RHCARACTERISTICA
'Cadastro de caracteristicas pessoais.';

DESCRIBE TABLE RHCURSO
'Cadastro de cursos para utilização no módulo de RH (Recrutamento e seleção).';

DESCRIBE TABLE RHDEPTO
'Cadastro de departamentos.';

DESCRIBE TABLE RHEMPREGADO
'Cadastro de empregados.';

DESCRIBE TABLE RHEMPREGADOBENEF
'Tabela de vínculos entre empregados e seus benefícios.';

DESCRIBE TABLE RHEMPREGADOR
'Cadastro de empregadores conveniados para módulo de recrutamento e seleção.';

DESCRIBE TABLE RHEMPREGADOSAL
'Table de histório salarial do empregado.';

DESCRIBE TABLE RHFUNCAO
'Tabela de funções profissionais.';

DESCRIBE TABLE RHNIVELCURSO
'Cadastro dos níveis dos cursos do módulo de RH (Recrutamento e seleção).';

DESCRIBE TABLE RHPONTO
'Tabela para registro do ponto dos funcionários.';

DESCRIBE TABLE RHTURNO
'Tabela de turnos.';

DESCRIBE TABLE RHVAGA
'Cadastro de vagas de emprego.';

DESCRIBE TABLE RHVAGACANDIDATO
'Tabela de vínculo entre vaga e candidatos.';

DESCRIBE TABLE RHVAGACARACQUALI
'Tabela de relacionamento entre vagas e caracteristicas qualificativas.';

DESCRIBE TABLE RHVAGACARACREST
'Tabela de relacionamento entre vagas e atribuições restritivas.';

DESCRIBE TABLE RHVAGACURSO
'Tabela de vínculo entre vagas e cursos.';

DESCRIBE TABLE RHVAGASTATUS
'Tabela histórica dos status das vagas.';

DESCRIBE TABLE SGAGENTE
'Tabela de pessoas, recursos e outros para os quais podemos agendar tarefas.';

DESCRIBE TABLE SGESTCIVIL
'Tabela de estados civis.';

DESCRIBE TABLE SGITPREFERE6
'Tabela de preferências Febraban detalhada por banco e tipo (SIACC E CNAB)';

DESCRIBE TABLE SGMUNICIPIO
'Tabela de municipios.';

DESCRIBE TABLE SGPAIS
'Tabela de Paises';

DESCRIBE TABLE SGPREFERE1
'Preferências do módulo STD (Gerais).';

DESCRIBE TABLE SGPREFERE2
'Preferências do módulo ATD.';

DESCRIBE TABLE SGPREFERE3
'Preferencias do módulo TMK.';

DESCRIBE TABLE SGPREFERE4
'Preferências do módulo de PDV
';

DESCRIBE TABLE SGPREFERE5
'Preferências do módulo de PCP
';

DESCRIBE TABLE SGPREFERE6
'Tabela de preferências Febraban (SIACC E CNAB)';

DESCRIBE TABLE SGUF
'Tabela de Unidades Federativas.';

DESCRIBE TABLE SVOS
'Cabeçalho para ordem de serviço.
';

DESCRIBE TABLE TKATIVIDADE
'Tabela de atividades.';

DESCRIBE TABLE TKCAMPANHA
'Tabela de cadastro de campanhas de marketing.';

DESCRIBE TABLE TKCAMPANHACTO
'Tabela de relacionamento entre contatos e campanhas.';

DESCRIBE TABLE TKCAMPANHAEMAIL
'Tabela de relacionamento entre campanhas e seus respectivos emails associados.';

DESCRIBE TABLE TKCONFEMAIL
'Tabela de configurações para utilização nos emails de campanhas de marketing.';

DESCRIBE TABLE TKCONTATO
'Tabela de contatos.';

DESCRIBE TABLE TKCTOATIV
'Tabela de relacionamento entre contatos e atividades.';

DESCRIBE TABLE TKCTOGRPINT
'Tabela de relacionamento entre contatos e os grupos de interesse.';

DESCRIBE TABLE TKEMAIL
'Tabela de emails para campanhas de marketing.';

DESCRIBE TABLE TKORIGCONT
'Tabela de origens de contatos ex: lista telefonica, pesquisa na internet, panfletagem, etc...';

DESCRIBE TABLE TKSITCAMP
'Tabela da situação do cantato com relação à campanha, de acordo com a atividade desenvolvida.';

DESCRIBE TABLE VDCLCOMIS
'Classificação de comissões
';

DESCRIBE TABLE VDCLIAUTP
'Pessoas autorizadas a comprar em nome do cliente';

DESCRIBE TABLE VDCLICOMPL
'Ficha de informações complementares do cliente.';

DESCRIBE TABLE VDCLICONTAS
'Contas bancarias dos clientes.';

DESCRIBE TABLE VDCLIENTE
'Clientes.';

DESCRIBE TABLE VDCLIIMOV
'Cadastro de imoveis do cliente.';

DESCRIBE TABLE VDCLIREFC
'Referências comerciais do cliente.';

DESCRIBE TABLE VDCLISOCIOS
'Socios da empresa cliente.';

DESCRIBE TABLE VDCLITERRA
'Terras do cliente.';

DESCRIBE TABLE VDCLIVEIC
'Veículos do cliente.';

DESCRIBE TABLE VDCONTRATO
'Tabela de contratos.';

DESCRIBE TABLE VDETIQCLI
'  tabela temporária para impressão de etiquetas de cliente.';

DESCRIBE TABLE VDITCONTRATO
'Tabela de ítens de contrato.';

DESCRIBE TABLE VDPRAZOENT
'Prazos de entrega.';

DESCRIBE TABLE VDREGRACOMIS
'Regras de comissões';

DESCRIBE TABLE VDTEF
'Tabela para vendas com TEF vinculado';

DESCRIBE TABLE VDTIPOCLI
'Tipos de clientes.';

DESCRIBE TABLE VDTIPOVEND
'Tipos de comissionados.';

DESCRIBE TABLE VDTRANSP
'Transportadoras.';



/******************************************************************************/
/*                                Descriptions                                */
/******************************************************************************/



/******************************************************************************/
/*                                Descriptions                                */
/******************************************************************************/

DESCRIBE PROCEDURE PPGERAOPCQ
'Procedure disparada após a inserção na tabela PPOP, realiza varredura na estrutura do produto, verificando as análises necessárias
no controle de qualidade e gerando registros referentes ao controle de qualidade na tabela PPOPCQ.';

DESCRIBE PROCEDURE TKGERACAMPANHACTO
'Procedure para geração de registros nas tabelas TKCAMPANHACTO e TKSITCAMP.';

DESCRIBE PROCEDURE VDRETULTVDCLIPROD
'Procedure para relatório de ultimas vendas por cliente/produto.';



/* Fields descriptions */

DESCRIBE FIELD DATAATENDOFIN TABLE ATATENDIMENTO
'Data final do atendimento';

DESCRIBE FIELD HORAATENDOFIN TABLE ATATENDIMENTO
'Hora final do atendimento.';

DESCRIBE FIELD CODEMPEC TABLE ATCONVENIADO
'Código da empresa - Encaminhador
';

DESCRIBE FIELD CODFILIALEC TABLE ATCONVENIADO
'Código da filial na tabela de encaminhador.
';

DESCRIBE FIELD CODENC TABLE ATCONVENIADO
'Código do encaminhador.
';

DESCRIBE FIELD CODEMPFC TABLE ATCONVENIADO
'Código da empresa na tabela RHFUNCAO';

DESCRIBE FIELD CODFILIALFC TABLE ATCONVENIADO
'Código da filial na tabela RHFUNCAO.';

DESCRIBE FIELD CODFUNC TABLE ATCONVENIADO
'Código da função.';

DESCRIBE FIELD DDDCONV TABLE ATCONVENIADO
'Código DDD do telefone principal do conveniado.';

DESCRIBE FIELD DDDFAXCONV TABLE ATCONVENIADO
'CÓDIGO DDD DO FAX DO CONVENIADO.';

DESCRIBE FIELD DDDCELCONV TABLE ATCONVENIADO
'CÓDIGO DDD DO CELULAR DO CONVENIADO.';

DESCRIBE FIELD CODEMP TABLE ATENCAMINHADOR
'Código da empresa
';

DESCRIBE FIELD CODFILIAL TABLE ATENCAMINHADOR
'Código da filial
';

DESCRIBE FIELD CODENC TABLE ATENCAMINHADOR
'Código do encaminhador
';

DESCRIBE FIELD NOMEENC TABLE ATENCAMINHADOR
'Nome do encaminhador
';

DESCRIBE FIELD ENDENC TABLE ATENCAMINHADOR
'Endereço
';

DESCRIBE FIELD NUMENC TABLE ATENCAMINHADOR
'Número do logradouro
';

DESCRIBE FIELD COMPLENC TABLE ATENCAMINHADOR
'Complemento do endereço
';

DESCRIBE FIELD CIDENC TABLE ATENCAMINHADOR
'Cidade
';

DESCRIBE FIELD BAIRENC TABLE ATENCAMINHADOR
'Bairro
';

DESCRIBE FIELD UFENC TABLE ATENCAMINHADOR
'Estado UF
';

DESCRIBE FIELD CEPENC TABLE ATENCAMINHADOR
'Cep
';

DESCRIBE FIELD FONEENC TABLE ATENCAMINHADOR
'Telefone
';

DESCRIBE FIELD FAXENC TABLE ATENCAMINHADOR
'Número do fax
';

DESCRIBE FIELD IMPNOTACOMPRA TABLE CPCOMPRA
'Flag que indica se a nota fiscal foi impressa (S/N).';

DESCRIBE FIELD BLOQCOMPRA TABLE CPCOMPRA
'Flag de bloqueio de compra.';

DESCRIBE FIELD EMMANUT TABLE CPCOMPRA
'Flag que indica se a tabela está em manutenção (S/N).';

DESCRIBE FIELD ADICFRETECOMPRA TABLE CPCOMPRA
'Flag que indica se soma o valor do frete ao custo do produto.';

DESCRIBE FIELD TIPOFRETECOMPRA TABLE CPCOMPRA
'Tipo do frete na compra.';

DESCRIBE FIELD OBS01 TABLE CPCOMPRA
'Campo ''coringa'' para outras observações.';

DESCRIBE FIELD OBS02 TABLE CPCOMPRA
'Campo ''coringa'' para outras observações.';

DESCRIBE FIELD OBS03 TABLE CPCOMPRA
'Campo ''coringa'' para outras observações.';

DESCRIBE FIELD OBS04 TABLE CPCOMPRA
'Campo ''coringa'' para outras observações.';

DESCRIBE FIELD CELFOR TABLE CPFORNECED
'Número do celular
';

DESCRIBE FIELD SSPFOR TABLE CPFORNECED
'Orgão de espedição do rg.';

DESCRIBE FIELD DDDFONEFOR TABLE CPFORNECED
'DDD do telefone principal.';

DESCRIBE FIELD DDDFAXFOR TABLE CPFORNECED
'DDD do fax do fornecedor.';

DESCRIBE FIELD DDDCELFOR TABLE CPFORNECED
'DDD do celular do fornecedor.';

DESCRIBE FIELD SITEFOR TABLE CPFORNECED
'Endereço eletrônico do site do fornecedor.';

DESCRIBE FIELD CODFORCONTAB TABLE CPFORNECED
'Código contabil';

DESCRIBE FIELD CODEMPAX TABLE CPITCOMPRA
'Código da empresa na tabela de almoxarifados.';

DESCRIBE FIELD CODFILIALAX TABLE CPITCOMPRA
'Código da filial na tabela de almoxarifados.';

DESCRIBE FIELD CODALMOX TABLE CPITCOMPRA
'Código do almoxarifado.';

DESCRIBE FIELD CUSTOVDITCOMPRA TABLE CPITCOMPRA
'Custo para formação de preços
';

DESCRIBE FIELD EMMANUT TABLE CPITCOMPRA
'Flag que indica se a tabela está em manutenção.';

DESCRIBE FIELD CODEMP TABLE CPITSOLICITACAO
'Código da empresa';

DESCRIBE FIELD CODFILIAL TABLE CPITSOLICITACAO
'Código da filial';

DESCRIBE FIELD CODSOL TABLE CPITSOLICITACAO
'Código da solicitação';

DESCRIBE FIELD CODITSOL TABLE CPITSOLICITACAO
'Número sequencial do item';

DESCRIBE FIELD CODEMPPD TABLE CPITSOLICITACAO
'Código da empresa para produtos';

DESCRIBE FIELD CODFILIALPD TABLE CPITSOLICITACAO
'Código da filial para produtos';

DESCRIBE FIELD CODPROD TABLE CPITSOLICITACAO
'Código do produto ou serviço';

DESCRIBE FIELD REFPROD TABLE CPITSOLICITACAO
'Referência do produto.';

DESCRIBE FIELD QTDITSOL TABLE CPITSOLICITACAO
'Quantidade solicitada';

DESCRIBE FIELD QTDAPROVITSOL TABLE CPITSOLICITACAO
'Quantidade aprovada';

DESCRIBE FIELD IDUSUITSOL TABLE CPITSOLICITACAO
'Id do usuário que solicitou';

DESCRIBE FIELD DTITSOL TABLE CPITSOLICITACAO
'Data da solicitação do item';

DESCRIBE FIELD IDUSUAPROVITSOL TABLE CPITSOLICITACAO
'Id do usuário que aprovou';

DESCRIBE FIELD DTAPROVITSOL TABLE CPITSOLICITACAO
'Data da aprovação do item';

DESCRIBE FIELD SITAPROVITSOL TABLE CPITSOLICITACAO
'Situação da aprovação do item:
PE - Pendente
AP - Aprovação parcial
AT - Aprovação total
NA - Não aprovada';

DESCRIBE FIELD SITCOMPITSOL TABLE CPITSOLICITACAO
'Situação da compra:
PE - Pendente
CP - Compra parcial
CT - Compra total
';

DESCRIBE FIELD SITITSOL TABLE CPITSOLICITACAO
'Situação do item da solicitação:
PE - Pendente
SC - Solicitação concluída
CA - Cancelada';

DESCRIBE FIELD CODEMP TABLE CPRATEIO
'Código da empresa.';

DESCRIBE FIELD CODFILIAL TABLE CPRATEIO
'Código da filial.';

DESCRIBE FIELD CODCOMPRA TABLE CPRATEIO
'Código da compra.';

DESCRIBE FIELD SEQRATEIO TABLE CPRATEIO
'Número sequencial do rateio.';

DESCRIBE FIELD CODEMPFN TABLE CPRATEIO
'Código da empresa na tabela FNPLANEJAMENTO';

DESCRIBE FIELD CODFILIALFN TABLE CPRATEIO
'Código da filial na tabela FNPLANEJAMENTO.';

DESCRIBE FIELD CODPLAN TABLE CPRATEIO
'Código do planejamento.';

DESCRIBE FIELD CODEMPCC TABLE CPRATEIO
'Código da empresa na tabela FNCC.';

DESCRIBE FIELD CODFILIALCC TABLE CPRATEIO
'Código da filial na tabela FNCC';

DESCRIBE FIELD ANOCC TABLE CPRATEIO
'Ano do centro de custo.';

DESCRIBE FIELD CODCC TABLE CPRATEIO
'Código do centro de custo.';

DESCRIBE FIELD PERCRATEIO TABLE CPRATEIO
'Percentual de rateio.';

DESCRIBE FIELD VLRRATEIO TABLE CPRATEIO
'Valor do rateio.';

DESCRIBE FIELD SITRATEIO TABLE CPRATEIO
'Situação da conciliação do rateio:
N-Pendente
P-Parcial
T-Total';

DESCRIBE FIELD IDUSUIN TABLE CPRATEIO
'ID do usuário que inseriu.';

DESCRIBE FIELD DTINS TABLE CPRATEIO
'Data de inserção.';

DESCRIBE FIELD HINS TABLE CPRATEIO
'Hora de inserção.';

DESCRIBE FIELD IDUSUALT TABLE CPRATEIO
'ID do usuário que fez a última alteração.';

DESCRIBE FIELD DTALT TABLE CPRATEIO
'Data da última alteração.';

DESCRIBE FIELD HALT TABLE CPRATEIO
'Hora da última alteração.';

DESCRIBE FIELD CODEMP TABLE CPSOLICITACAO
'Código da empresa';

DESCRIBE FIELD CODFILIAL TABLE CPSOLICITACAO
'Código da filial';

DESCRIBE FIELD CODSOL TABLE CPSOLICITACAO
'Código da solicitação';

DESCRIBE FIELD DTEMITSOL TABLE CPSOLICITACAO
'Data de emissão da solicitação';

DESCRIBE FIELD SITSOL TABLE CPSOLICITACAO
'PE - Pendente
SC - Solicitação concluída
CA - Cancelada';

DESCRIBE FIELD ORIGSOL TABLE CPSOLICITACAO
'Origem da solicitação
RM - RMA
AX - ALMOXARIFE';

DESCRIBE FIELD MOTIVOSOL TABLE CPSOLICITACAO
'Motivo de cancelamento.';

DESCRIBE FIELD DTINS TABLE CPSOLICITACAO
'Data de inserção';

DESCRIBE FIELD HINS TABLE CPSOLICITACAO
'Hora de inserção';

DESCRIBE FIELD DTALT TABLE CPSOLICITACAO
'Data da última alteração';

DESCRIBE FIELD HALT TABLE CPSOLICITACAO
'Hora da última alteração';

DESCRIBE FIELD IDUSUINS TABLE CPSOLICITACAO
'ID do usuário que inseriu';

DESCRIBE FIELD IDUSUALT TABLE CPSOLICITACAO
'ID do usuário da última alteração';

DESCRIBE FIELD CODEMP TABLE EQALMOXFILIAL
'Código da empresa na tabela EQALMOX.';

DESCRIBE FIELD CODFILIAL TABLE EQALMOXFILIAL
'Código da filial na tabela EQALMOX.';

DESCRIBE FIELD CODALMOX TABLE EQALMOXFILIAL
'Código do almoxarifado.';

DESCRIBE FIELD CODEMPAF TABLE EQALMOXFILIAL
'Código da empresa na tabela SGFILIAL.';

DESCRIBE FIELD CODFILIALAF TABLE EQALMOXFILIAL
'Código da filial na tabela SGFILIAL.';

DESCRIBE FIELD BAIXAESTOQAF TABLE EQALMOXFILIAL
'Flag que indica se é possível baixar o estoque dessa filial.';

DESCRIBE FIELD CPFATCONV TABLE EQFATCONV
'Flag que indica se a unidade é preferencial para compras.';

DESCRIBE FIELD ESTNEGGRUP TABLE EQGRUPO
'Flag para permitir o estoque negativo de produtos.';

DESCRIBE FIELD ESTLOTNEGGRUP TABLE EQGRUPO
'Flag que define se permite estoque negativo de lotes.';

DESCRIBE FIELD OBSINVP TABLE EQINVPROD
'Observações relativas ao inventário, como motivo, justificativa, etc.';

DESCRIBE FIELD SITITRMA TABLE EQITRMA
'Situação geral do item de rma:
PE - Pendente 
EA - Em andamento
AF - Aprovação finalizada
EF - Expedição finalizada
CA - Cancelado 
';

DESCRIBE FIELD CODEMPAX TABLE EQITRMA
'Código da empresa na tabela de almoxarifados.';

DESCRIBE FIELD CODFILIALAX TABLE EQITRMA
'Código da filail na tabela de almoxarifados.';

DESCRIBE FIELD CODALMOX TABLE EQITRMA
'Código do almoxarifado.';

DESCRIBE FIELD DTAPROVITRMA TABLE EQITRMA
'Data da aprovação do item.';

DESCRIBE FIELD SITAPROVITRMA TABLE EQITRMA
'Situação da aprovação do item:
''PE'' - Aprovação pendente
''AP'' - Aprovação parcial
''AT'' - Aprovação total
''NA'' - Não aprovado';

DESCRIBE FIELD SITEXPITRMA TABLE EQITRMA
'Situação da expedição do item:
''PE'' - Expedição pendente
''EP'' - Expedição parcial
''ET'' - Expedição total
''NE'' - Não expedida';

DESCRIBE FIELD MOTIVOCANCITRMA TABLE EQITRMA
'Motivo do cancelamento do ítem de rma.';

DESCRIBE FIELD PRIORITRMA TABLE EQITRMA
'Prioridade da RMA.
(B-Baixa, M-Media, A-Alta).
';

DESCRIBE FIELD MOTIVOPRIORITRMA TABLE EQITRMA
'Motivo de prioridade para item de RMA.
';

DESCRIBE FIELD CODEMP TABLE EQMODLOTE
'Código da empresa do modelo de lote.';

DESCRIBE FIELD CODFILIAL TABLE EQMODLOTE
'Filial do modelo de lote.';

DESCRIBE FIELD CODMODLOTE TABLE EQMODLOTE
'Código do modelo de lote.';

DESCRIBE FIELD DESCMODLOTE TABLE EQMODLOTE
'Descrição do modelo de lote.';

DESCRIBE FIELD CODEMPAX TABLE EQMOVPROD
'Código da empresa na tabela de almoxarifados.';

DESCRIBE FIELD CODFILIALAX TABLE EQMOVPROD
'Código da filial na tabela de almoxarifados.';

DESCRIBE FIELD CODALMOX TABLE EQMOVPROD
'Código do almoxarifado.';

DESCRIBE FIELD CODEMPOP TABLE EQMOVPROD
'Código da empresa da ordem de produção.';

DESCRIBE FIELD CODFILIALOP TABLE EQMOVPROD
'Codigo da filial da Ordem de produção.';

DESCRIBE FIELD CODOP TABLE EQMOVPROD
'Código da Ordem de produção.';

DESCRIBE FIELD SEQOP TABLE EQMOVPROD
'Número sequencial da OP.';

DESCRIBE FIELD CODEMP TABLE EQPRODACESSO
'Código da empresa.';

DESCRIBE FIELD CODFILIAL TABLE EQPRODACESSO
'Código da filial.';

DESCRIBE FIELD CODPROD TABLE EQPRODACESSO
'Código do produto.';

DESCRIBE FIELD TIPOPA TABLE EQPRODACESSO
'Tipo do acesso (RMA, PDV).
';

DESCRIBE FIELD CODPA TABLE EQPRODACESSO
'Código do acesso.';

DESCRIBE FIELD CODEMPCC TABLE EQPRODACESSO
'Código da empresa na tabela de centro de custos.';

DESCRIBE FIELD CODFILIALCC TABLE EQPRODACESSO
'Código da filial na tabela de centro de custos.';

DESCRIBE FIELD ANOCC TABLE EQPRODACESSO
'Ano do centro de custo.';

DESCRIBE FIELD CODCC TABLE EQPRODACESSO
'Código do centro de custo.';

DESCRIBE FIELD CODEMPCX TABLE EQPRODACESSO
'Código da empresa na tabela de caixa ECF.';

DESCRIBE FIELD CODFILIALCX TABLE EQPRODACESSO
'Código da filial na tabela de caixa ECF.';

DESCRIBE FIELD CODCAIXA TABLE EQPRODACESSO
'Código do caixa ECF.';

DESCRIBE FIELD IDUSUINS TABLE EQPRODACESSO
'ID. do usuário que inseriu o registro.';

DESCRIBE FIELD DTINS TABLE EQPRODACESSO
'Data de inserção.';

DESCRIBE FIELD HINS TABLE EQPRODACESSO
'Horário de inserção.';

DESCRIBE FIELD IDUSUALT TABLE EQPRODACESSO
'ID. do usuário que fez a última alteração.';

DESCRIBE FIELD DTALT TABLE EQPRODACESSO
'Data da última alteração.';

DESCRIBE FIELD HALT TABLE EQPRODACESSO
'Hora da última alteração.';

DESCRIBE FIELD CODEMP TABLE EQPRODPLAN
'Código da empresa na tabela EQPRODUTO';

DESCRIBE FIELD CODFILIAL TABLE EQPRODPLAN
'Código da filial na tabela EQPRODUTO';

DESCRIBE FIELD CODPROD TABLE EQPRODPLAN
'Código do produto.';

DESCRIBE FIELD SEQPP TABLE EQPRODPLAN
'Número sequencial.';

DESCRIBE FIELD TIPOPP TABLE EQPRODPLAN
'Tipo (R-Receita / D-Despesa).';

DESCRIBE FIELD CODEMPPN TABLE EQPRODPLAN
'Código da empresa na tabela EQPLANEJAMENTO.';

DESCRIBE FIELD CODFILIALPN TABLE EQPRODPLAN
'Código da filial na tabela EQPLANEJAMENTO.';

DESCRIBE FIELD CODPLAN TABLE EQPRODPLAN
'Código do planejamento.';

DESCRIBE FIELD CODEMPCC TABLE EQPRODPLAN
'Código da empresa na tabela FNCC.';

DESCRIBE FIELD CODFILIALCC TABLE EQPRODPLAN
'Código da filial na tabela FNCC.';

DESCRIBE FIELD ANOCC TABLE EQPRODPLAN
'Ano do centro de custo.';

DESCRIBE FIELD CODCC TABLE EQPRODPLAN
'Código do centro de custo.';

DESCRIBE FIELD PERCPP TABLE EQPRODPLAN
'Percentual de rateio.';

DESCRIBE FIELD IDUSUINS TABLE EQPRODPLAN
'ID do usuário que inseriu.';

DESCRIBE FIELD DTINS TABLE EQPRODPLAN
'Data de inserção.';

DESCRIBE FIELD HINS TABLE EQPRODPLAN
'Hora de inserção.';

DESCRIBE FIELD IDUSUALT TABLE EQPRODPLAN
'Id do usuário da última alteração.';

DESCRIBE FIELD DTALT TABLE EQPRODPLAN
'Data da última alteração.';

DESCRIBE FIELD HALT TABLE EQPRODPLAN
'Hora da última alteração.';

DESCRIBE FIELD CVPROD TABLE EQPRODUTO
'Indica se o produto e de compra ou venda:
V - Venda
C - Compra
A - Ambos';

DESCRIBE FIELD LOCALPROD TABLE EQPRODUTO
'Local de armazenamento do produto (Prateleira)
';

DESCRIBE FIELD RMAPROD TABLE EQPRODUTO
'Flag que indica se podem ser feitas RMA´s do produto.';

DESCRIBE FIELD CODEMPPE TABLE EQPRODUTO
'Código da empresa do prazo de entrega padrão.';

DESCRIBE FIELD CODFILIALPE TABLE EQPRODUTO
'Código da filial do prazo de entrega padrão.';

DESCRIBE FIELD CODPE TABLE EQPRODUTO
'Código do prazo de entrega.';

DESCRIBE FIELD USARECEITAPROD TABLE EQPRODUTO
'Flag indicando se o produto nescessita de receita.';

DESCRIBE FIELD USATELAADICPDV TABLE EQPRODUTO
'Flag indicando se o produto abre uma tela para informações adicionais na venda do PDV';

DESCRIBE FIELD VLRDENSIDADE TABLE EQPRODUTO
'Valor da densidade';

DESCRIBE FIELD VLRCONCENT TABLE EQPRODUTO
'Valor da concentração.';

DESCRIBE FIELD COMPRIMENTO TABLE EQPRODUTO
'Comprimento do produto em cm.';

DESCRIBE FIELD LARGURA TABLE EQPRODUTO
'Largura do produto em cm.';

DESCRIBE FIELD ESPESSURA TABLE EQPRODUTO
'Espessura do produto em cm.';

DESCRIBE FIELD MOTIVORMA TABLE EQRMA
'Motivo da solicitação.';

DESCRIBE FIELD MOTIVOCANCRMA TABLE EQRMA
'Motivo do cancelamento.';

DESCRIBE FIELD SITRMA TABLE EQRMA
'Situação geral da rma:
PE - Pendente (não foi realizado nenhum procedimento de aprovação, ou expedição)
EA - Em andamento
AF - Aprovação finalizada
EF - Expedição finalizada
CA - Cancelada (requisição foi cancelada)
';

DESCRIBE FIELD DTAREQRMA TABLE EQRMA
'Data da requisição.';

DESCRIBE FIELD DTAEXPRMA TABLE EQRMA
'Data da expedição da RMA.';

DESCRIBE FIELD SITAPROVRMA TABLE EQRMA
'Status da aprovação da RMA.
''PE'' - Aprovação pendente.
''AP'' - Aprovação parcial.
''AT'' - Aprovação total.
''NA'' - Não aprovada.';

DESCRIBE FIELD SITEXPRMA TABLE EQRMA
'Status da expedição da RMA.
''PE'' - Expedição pendente.
''EP'' - Expedida parcial.
''ET'' - Expedida total.
''NE'' - Não expedida.';

DESCRIBE FIELD IDUSUAPROV TABLE EQRMA
'ID do usuário que aprovou/aprovará a RMA.';

DESCRIBE FIELD CODEMPUA TABLE EQRMA
'Código da empresa do usuário que aprovou/aprovará a RMA.';

DESCRIBE FIELD CODFILIALUA TABLE EQRMA
'Código da filial do usuário que aprovou/aprovará a RMA.';

DESCRIBE FIELD IDUSUEXP TABLE EQRMA
'ID do usuário que expediu/expedirá a RMA.';

DESCRIBE FIELD CODEMPUE TABLE EQRMA
'Código da empresa do usuário que expediu/expedirá a RMA.';

DESCRIBE FIELD CODFILIALUE TABLE EQRMA
'Código da filial do usuário que expediu/expedirá a RMA.';

DESCRIBE FIELD DTAAPROVRMA TABLE EQRMA
'Data da aprovação da RMA.';

DESCRIBE FIELD CODEMPOF TABLE EQRMA
'Código da empresa a OP/Fase';

DESCRIBE FIELD CODFILIALOF TABLE EQRMA
'Código da filial da OP X Fase';

DESCRIBE FIELD CODOP TABLE EQRMA
'Código da ordem de produção.';

DESCRIBE FIELD SEQOP TABLE EQRMA
'Número sequencial da OP.';

DESCRIBE FIELD SEQOF TABLE EQRMA
'Sequencial da fase de produção.';

DESCRIBE FIELD ESTOQTIPOMOV TABLE EQTIPOMOV
'Indica se o tipo de movimento movimenta estoque.';

DESCRIBE FIELD IMPPEDTIPOMOV TABLE EQTIPOMOV
'Flag que indica se imprime pedido.';

DESCRIBE FIELD IMPNFTIPOMOV TABLE EQTIPOMOV
'Flag que indica se imprime NF.';

DESCRIBE FIELD IMPBOLTIPOMOV TABLE EQTIPOMOV
'Flag que indica se imprime boleto.';

DESCRIBE FIELD IMPRECTIPOMOV TABLE EQTIPOMOV
'Flag que indica se imprime recibo no fechamento da venda.';

DESCRIBE FIELD REIMPNFTIPOMOV TABLE EQTIPOMOV
'Flag que indica se reimprime NF.';

DESCRIBE FIELD TUSUTIPOMOV TABLE EQTIPOMOV
'Flag que indica se todos os usuários podem utilizar o tipo de movimento.';

DESCRIBE FIELD SOMAVDTIPOMOV TABLE EQTIPOMOV
'Indica se as movimentações geradas com esse tipo de movimento devem aparecer nos relatórios de venda.';

DESCRIBE FIELD SEQNFTIPOMOV TABLE EQTIPOMOV
'Flag que indica alocação do número da nota fiscal.
';

DESCRIBE FIELD VLRMFINTIPOMOV TABLE EQTIPOMOV
'Permite valor financeiro menor que total da nota.';

DESCRIBE FIELD MCOMISTIPOMOV TABLE EQTIPOMOV
'Indica se o sistema de comissões é com múltiplos comissionados.';

DESCRIBE FIELD CTIPOFRETE TABLE EQTIPOMOV
'flag de preferencia para o tipo de frete na venda com este tipo de movimento.';

DESCRIBE FIELD CODEMPTN TABLE EQTIPOMOV
'Código da empresa da transportadora padrão para o tipo de movimento.';

DESCRIBE FIELD CODFILIALTN TABLE EQTIPOMOV
'Código da filial da transportadora padrão para o tipo de movimento.';

DESCRIBE FIELD CODTRAN TABLE EQTIPOMOV
'Código da transportadora padrão para o tipo de movimento.';

DESCRIBE FIELD CODEMP TABLE EQTIPOMOVUSU
'Código da empresa na tabela de tipos de movimento.';

DESCRIBE FIELD CODFILIAL TABLE EQTIPOMOVUSU
'Código da filial na tabela de tipos de movimento.';

DESCRIBE FIELD CODTIPOMOV TABLE EQTIPOMOVUSU
'Código do tipo de movimento.';

DESCRIBE FIELD CODEMPUS TABLE EQTIPOMOVUSU
'Código de empresa na tabela de usuários.';

DESCRIBE FIELD CODFILIALUS TABLE EQTIPOMOVUSU
'Código da filial na tabela de usuários.';

DESCRIBE FIELD IDUSU TABLE EQTIPOMOVUSU
'ID do usuário.';

DESCRIBE FIELD CASASDEC TABLE EQUNIDADE
'Número de casas decimais utilizadas para a unidade.';

DESCRIBE FIELD DVBANCO TABLE FNBANCO
'Dígito verificador do banco.';

DESCRIBE FIELD CODEMPBO TABLE FNCARTCOB
'Código da empresa na tabela FNBANCO.';

DESCRIBE FIELD CODFILIALBO TABLE FNCARTCOB
'Código da filial na tabela FNBANCO.';

DESCRIBE FIELD CODBANCO TABLE FNCARTCOB
'Código do banco.';

DESCRIBE FIELD CODEMP TABLE FNCARTCOB
'Código da empresa.';

DESCRIBE FIELD CODFILIAL TABLE FNCARTCOB
'Código da filial.';

DESCRIBE FIELD CODCARTCOB TABLE FNCARTCOB
'Código da carteira de cobrança.';

DESCRIBE FIELD DESCCARTCOB TABLE FNCARTCOB
'Descrição da carteira de cobrança.';

DESCRIBE FIELD CARTCOBCNAB TABLE FNCARTCOB
'Carteira de cobrança para CNAB.';

DESCRIBE FIELD CODEMPHP TABLE FNCONTA
'Código da empresa na tabela de histórico padrão.';

DESCRIBE FIELD CODFILIALHP TABLE FNCONTA
'Código da filial na tabela de histórico padrão.';

DESCRIBE FIELD CODHIST TABLE FNCONTA
'Código do histórico padrão.';

DESCRIBE FIELD CODCONTDEB TABLE FNCONTA
'Código da conta débito contábil.';

DESCRIBE FIELD CODCONTCRED TABLE FNCONTA
'Código da conta crédito contábil.';

DESCRIBE FIELD CONVCOBCONTA TABLE FNCONTA
'Convênio de cobrança';

DESCRIBE FIELD ATIVACONTA TABLE FNCONTA
'Indica se a conta está ativa.';

DESCRIBE FIELD STIPOFEBRABAN TABLE FNFBNCLI
'Sub-Tipo Febraban 01=Débito em folha / 02=Débito em conta corrente.';

DESCRIBE FIELD STIPOFEBRABAN TABLE FNFBNREC
'Sub-Tipo Febraban 01=Débito em folha / 02=Débito em conta corrente.';

DESCRIBE FIELD SITREMESSA TABLE FNFBNREC
'Situação da remessa 00=Selecionado / 01=Exportada';

DESCRIBE FIELD SITRETORNO TABLE FNFBNREC
'Situação do retorno. 00=Sem retorno.';

DESCRIBE FIELD TXAHISTPAD TABLE FNHISTPAD
'Campo para criação de modelo dinâmico de histórico padrão.';

DESCRIBE FIELD CODEMP TABLE FNITMODBOLETO
'Código da empresa';

DESCRIBE FIELD CODFILIAL TABLE FNITMODBOLETO
'Código filial.';

DESCRIBE FIELD CODMODBOL TABLE FNITMODBOLETO
'Código do modelo de boleto.';

DESCRIBE FIELD CODEMPBO TABLE FNITMODBOLETO
'Código da empresa na tabela FNBANCO.';

DESCRIBE FIELD CODFILIALBO TABLE FNITMODBOLETO
'Código da filial na tabela FNBANCO.';

DESCRIBE FIELD CODBANCO TABLE FNITMODBOLETO
'Código do banco.';

DESCRIBE FIELD CODEMPCB TABLE FNITMODBOLETO
'Código da empresa na tabela FNCARTCOB.';

DESCRIBE FIELD CODFILIALCB TABLE FNITMODBOLETO
'Código da filial na tabela FNCARTCOB.';

DESCRIBE FIELD CODCARTCOB TABLE FNITMODBOLETO
'Código da carteira de cobrança.';

DESCRIBE FIELD CONVCOB TABLE FNITMODBOLETO
'Convênio de cobrança.';

DESCRIBE FIELD VLRDEVITPAG TABLE FNITPAGAR
'Valor das devoluções de compra da parcela.';

DESCRIBE FIELD VLRDEVITREC TABLE FNITRECEBER
'Valor de devolução da parcela.';

DESCRIBE FIELD DESCPONT TABLE FNITRECEBER
'Indica se o desconto e do tipo pontualidade.';

DESCRIBE FIELD STATUSITREC TABLE FNITRECEBER
'R1 (Conta em aberto)
RP (Recebimento total)
RL (Recebimento parcial)';

DESCRIBE FIELD CODEMPTC TABLE FNITRECEBER
'Código da filial em FNTIPOCOB.';

DESCRIBE FIELD CODFILIALTC TABLE FNITRECEBER
'Código filial em FNTIPOCOB.';

DESCRIBE FIELD CODTIPOCOB TABLE FNITRECEBER
'Código do tipo de cobrança.';

DESCRIBE FIELD CODEMPCB TABLE FNITRECEBER
'Código da empresa na tabela FNCARTCOB.';

DESCRIBE FIELD CODFILIALCB TABLE FNITRECEBER
'Código filial na tabela FNCARTCOB.';

DESCRIBE FIELD CODCARTCOB TABLE FNITRECEBER
'Código da carteira de cobrança.';

DESCRIBE FIELD VLRCOMIITREC TABLE FNITRECEBER
'Valor de comissão por parcela.';

DESCRIBE FIELD IMPRECIBOITREC TABLE FNITRECEBER
'Flag que indica se será impresso recibo.';

DESCRIBE FIELD RECIBOITREC TABLE FNITRECEBER
'Armazena o número do recibo.';

DESCRIBE FIELD ALTUSUITREC TABLE FNITRECEBER
'Flag que indica se está sendo feita alteração de item de contas a receber pelo usuário.';

DESCRIBE FIELD PDVITREC TABLE FNITRECEBER
'Indica se foi recebido pelo PDV.';

DESCRIBE FIELD HISTBLANCA TABLE FNLANCA
'Histórico bancário.';

DESCRIBE FIELD PDVITREC TABLE FNLANCA
'Indica se foi recebido pelo PDV';

DESCRIBE FIELD CODCLI TABLE FNLANCA
'Código do cliente, para vínculo com contas a receber.';

DESCRIBE FIELD CODEMPCL TABLE FNLANCA
'Código da empresa do cliente';

DESCRIBE FIELD CODFILIALCL TABLE FNLANCA
'Código da filial do cliente.';

DESCRIBE FIELD VLRVENDACRED TABLE FNLIBCRED
'Valor da venda no momento da liberação de crédito.';

DESCRIBE FIELD PREIMPMODBOL TABLE FNMODBOLETO
'Flag para indicar se usa boleto pre-impresso.[ S ]';

DESCRIBE FIELD CARTCOB TABLE FNMODBOLETO
'Carteira de cobrança.';

DESCRIBE FIELD MDECOB TABLE FNMODBOLETO
'Modalidade de cobrança.';

DESCRIBE FIELD ACEITEMODBOL TABLE FNMODBOLETO
'Flag indicador para aceitação do boleto pelo cliente.';

DESCRIBE FIELD DESCLPMODBOL TABLE FNMODBOLETO
'Descrição do local de pagamento do boleto.';

DESCRIBE FIELD INSTPAGMODBOL TABLE FNMODBOLETO
'Instruções para o pagamento do boleto.';

DESCRIBE FIELD IMPINFOPARC TABLE FNMODBOLETO
'Indica se deve imprimir informações da parcela nas intruções de cobrança para boletos gráficos.';

DESCRIBE FIELD CODFBNMOEDA TABLE FNMOEDA
'Código da moeda padrão Febraban.';

DESCRIBE FIELD VLRDEVPAG TABLE FNPAGAR
'Valor das devoluções de compra.';

DESCRIBE FIELD AUTOBAIXAPARC TABLE FNPARCPAG
'Flag para marcar baixa automática da parcela.';

DESCRIBE FIELD FINPLAN TABLE FNPLANEJAMENTO
'Finalidade do planejamento.';

DESCRIBE FIELD CODCONTCRED TABLE FNPLANEJAMENTO
'Código da conta crédito para contabilidade.';

DESCRIBE FIELD CODCONTDEB TABLE FNPLANEJAMENTO
'Código da conta débido para contabilidade.';

DESCRIBE FIELD APORCPLANOPAG TABLE FNPLANOPAG
'Flag que indica se orçamento será aprovado por padrão na tela de fechamento de orçamento.';

DESCRIBE FIELD ATIVOPLANOPAG TABLE FNPLANOPAG
'Flag que indica se o plano de pagamento está ativo "S" ou inativo "N".';

DESCRIBE FIELD CVPLANOPAG TABLE FNPLANOPAG
'Indica se o plano de pagamento é para compra "C", venda "V" ou ambos "A", deve ser usado como filtro nas telas correspondentes.';

DESCRIBE FIELD CODEMPTBJ TABLE FNPLANOPAG
'Código da empresa da tabela de juros.';

DESCRIBE FIELD CODFILIALTBJ TABLE FNPLANOPAG
'Código da filial da tabela de juros.';

DESCRIBE FIELD CODTBJ TABLE FNPLANOPAG
'Código da tabela de juros.';

DESCRIBE FIELD PERCDESC TABLE FNPLANOPAG
'Percentual de desconto.';

DESCRIBE FIELD REGRVCTOPLANOPAG TABLE FNPLANOPAG
'Regra de para vencimento.
N - Nenhuma
A - Antecipar
P - Prorrogar';

DESCRIBE FIELD RVSABPLANOPAG TABLE FNPLANOPAG
'Define se a regra de vencimento vale para os sábados.';

DESCRIBE FIELD RVDOMPLANOPAG TABLE FNPLANOPAG
'Define se a regra de vencimento vale para os domingos.';

DESCRIBE FIELD RVFERPLANOPAG TABLE FNPLANOPAG
'Define se a regra de vencimento vale para os feriados.';

DESCRIBE FIELD RVDIAPLANOPAG TABLE FNPLANOPAG
'Regra do dia de vencimento
A - Automático
F - Dia fixo
U - Dia util
';

DESCRIBE FIELD DIAVCTOPLANOPAG TABLE FNPLANOPAG
'Dia fixo ou útil para o vencimento.';

DESCRIBE FIELD CODEMPTC TABLE FNRECEBER
'Código da empresa em FNTIPOCOB.';

DESCRIBE FIELD CODFILIALTC TABLE FNRECEBER
'Código da filial em FNTIPOCOB.';

DESCRIBE FIELD CODTIPOCOB TABLE FNRECEBER
'Código do tipo de cobrança.';

DESCRIBE FIELD CODEMPCB TABLE FNRECEBER
'Código da empresa na tabela FNCARTCOB.';

DESCRIBE FIELD CODFILIALCB TABLE FNRECEBER
'Código da filial na tabela FNCARTCOB.';

DESCRIBE FIELD CODCARTCOB TABLE FNRECEBER
'Código da carteira de cobrança.';

DESCRIBE FIELD VLRDEVREC TABLE FNRECEBER
'Valor total das devoluções.';

DESCRIBE FIELD SITRESTR TABLE FNRESTRICAO
'Situaçao da restrição 
I - Inclusão
C - Cancelada';

DESCRIBE FIELD TIPOTBJ TABLE FNTBJUROS
'Tipo da tabela de juros: 
"D" = Diário
"M" = Mensal
"B" = Bimestral
"T" = Trimestral
"S" = Semestral
"A" = Anual
"F" = Fixo';

DESCRIBE FIELD TIPOFEBRABAN TABLE FNTIPOCOB
'Define se é febraban. 00=não / 01-SIACC / 02-CNAB';

DESCRIBE FIELD OBRIGCARTCOB TABLE FNTIPOCOB
'Define se é obrigatório carteira de cobrança.';

DESCRIBE FIELD BLOQTPRESTR TABLE FNTIPORESTR
'Define se a restrição bloqueia os lançamentos.';

DESCRIBE FIELD TPREDICMSFISC TABLE LFCLFISCAL
'Tipo de redução de ICMS
B - BASE DE CÁLCULO
V - VALOR DO ICMS';

DESCRIBE FIELD SITPISFISC TABLE LFCLFISCAL
'Situação tributária do PIS (T-Tributado, I-Isento, S-Substituição)';

DESCRIBE FIELD SITCOFINSFISC TABLE LFCLFISCAL
'Situação tributária do COFINS (T-Tributado, I-Isento, S-Substituição)';

DESCRIBE FIELD TPREDICMSFISC TABLE LFITCLFISCAL
'Tipo de redução de ICMS
B - BASE DE CÁLCULO
V - VALOR DO ICMS';

DESCRIBE FIELD ALIQIPIFISC TABLE LFITCLFISCAL
'Alíquota de IPI';

DESCRIBE FIELD IMPDTSAIDANAT TABLE LFNATOPER
'Flag para impressão de data de saida na nota fiscal.
';

DESCRIBE FIELD CALCCOFINSTF TABLE LFTIPOFISCCLI
'Indica se deve calcular o cofins.';

DESCRIBE FIELD CALCCSOCIALTF TABLE LFTIPOFISCCLI
'Indica se calcula a contribuição social.';

DESCRIBE FIELD CALCICMSTF TABLE LFTIPOFISCCLI
'Indica se calcula o ICMS.';

DESCRIBE FIELD CALCIPITF TABLE LFTIPOFISCCLI
'Indica se calcula o IPI.';

DESCRIBE FIELD CALCIRTF TABLE LFTIPOFISCCLI
'Indica se calcula o IR.';

DESCRIBE FIELD CALCISSTF TABLE LFTIPOFISCCLI
'Indica se calcula o iss.';

DESCRIBE FIELD CALCPISTF TABLE LFTIPOFISCCLI
'Indica se calcula o PIS.';

DESCRIBE FIELD IMPCOFINSTF TABLE LFTIPOFISCCLI
'Indica se imprime o cofins.';

DESCRIBE FIELD IMPCSOCIALTF TABLE LFTIPOFISCCLI
'indica se imprime a contribuição social.';

DESCRIBE FIELD IMPICMSTF TABLE LFTIPOFISCCLI
'indica se imprime o ICMS.';

DESCRIBE FIELD IMPISSTF TABLE LFTIPOFISCCLI
'indica se imprime o ISS.';

DESCRIBE FIELD IMPIPITF TABLE LFTIPOFISCCLI
'indica se imprime o IPI.';

DESCRIBE FIELD IMPIRTF TABLE LFTIPOFISCCLI
'indica se imprime o IR.';

DESCRIBE FIELD IMPPISTF TABLE LFTIPOFISCCLI
'indica se imprime o PIS.';

DESCRIBE FIELD CODEMP TABLE PPDISTRIB
'Código da empresa.';

DESCRIBE FIELD CODFILIAL TABLE PPDISTRIB
'Código da filial.';

DESCRIBE FIELD CODPROD TABLE PPDISTRIB
'Código do produto referente a estrutura.';

DESCRIBE FIELD SEQEST TABLE PPDISTRIB
'Número sequencial da estrutura.';

DESCRIBE FIELD SEQEF TABLE PPDISTRIB
'Sequencia da fase.';

DESCRIBE FIELD CODEMPFS TABLE PPDISTRIB
'Código da empresa na tabela PPFASE.';

DESCRIBE FIELD CODFILIALFS TABLE PPDISTRIB
'Código da filial na tabela PPFASE.';

DESCRIBE FIELD CODFASE TABLE PPDISTRIB
'Código da fase.';

DESCRIBE FIELD SEQDE TABLE PPDISTRIB
'Sequencia da distribuição da estrutura.';

DESCRIBE FIELD CODEMPDE TABLE PPDISTRIB
'Código da empresa para vínculo com estrutura usada para distribuição.';

DESCRIBE FIELD CODFILIALDE TABLE PPDISTRIB
'Código da filial para estrutura de distribuição.';

DESCRIBE FIELD CODPRODDE TABLE PPDISTRIB
'Código do produto para estrutura de distribuição.';

DESCRIBE FIELD SEQESTDE TABLE PPDISTRIB
'Número sequencial da estrutura de distribuição.';

DESCRIBE FIELD CODEMP TABLE PPESTRUANALISE
'Código da empresa.';

DESCRIBE FIELD CODFILIAL TABLE PPESTRUANALISE
'Código da filial.';

DESCRIBE FIELD CODESTANALISE TABLE PPESTRUANALISE
'Código da estrutra x analise.';

DESCRIBE FIELD CODPROD TABLE PPESTRUANALISE
'Código do produto vinculado a estrutura.';

DESCRIBE FIELD SEQEST TABLE PPESTRUANALISE
'Sequência da estrutura.';

DESCRIBE FIELD SEQEF TABLE PPESTRUANALISE
'Sequência da estrutura x fase.';

DESCRIBE FIELD CODEMPFS TABLE PPESTRUANALISE
'Código da emprea da estrutura x fase.';

DESCRIBE FIELD CODFILIALFS TABLE PPESTRUANALISE
'Código da filial da estrutura x fase.';

DESCRIBE FIELD CODFASE TABLE PPESTRUANALISE
'Código da fase.';

DESCRIBE FIELD CODEMPTA TABLE PPESTRUANALISE
'Código da empresa do tipo de analise.';

DESCRIBE FIELD CODFILIALTA TABLE PPESTRUANALISE
'Código da filial do tipo de analise.';

DESCRIBE FIELD CODTPANALISE TABLE PPESTRUANALISE
'Código do tipo de análise.';

DESCRIBE FIELD VLRMIN TABLE PPESTRUANALISE
'Valor mínimo de tolerância.';

DESCRIBE FIELD VLRMAX TABLE PPESTRUANALISE
'Valor máximo de tolerância.';

DESCRIBE FIELD ESPECIFICACAO TABLE PPESTRUANALISE
'Espessificação padrão da análise, utilizada quando a análise é descritiva.';

DESCRIBE FIELD EMITCERT TABLE PPESTRUANALISE
'Indica se a analise deve sair no certificado de analises.';

DESCRIBE FIELD DTINS TABLE PPESTRUANALISE
'Data de inserção do registro.';

DESCRIBE FIELD IDUSUINS TABLE PPESTRUANALISE
'Usuário que inseriu o registro.';

DESCRIBE FIELD DTALT TABLE PPESTRUANALISE
'Data de alteração do registro.';

DESCRIBE FIELD IDUSUALT TABLE PPESTRUANALISE
'Usuário que alterou o registro.';

DESCRIBE FIELD HINS TABLE PPESTRUANALISE
'Hora de inserção do registro.';

DESCRIBE FIELD HALT TABLE PPESTRUANALISE
'Hora da ultima alteração no registro.';

DESCRIBE FIELD SEQEST TABLE PPESTRUFASE
'Número sequencial da estrutura.';

DESCRIBE FIELD FINALIZAOP TABLE PPESTRUFASE
'Indica se a fase finaliza o processo de produção (S/N).';

DESCRIBE FIELD INSTRUCOES TABLE PPESTRUFASE
'Instruções da fase de produção para a estrutura.';

DESCRIBE FIELD SEQEST TABLE PPESTRUTURA
'Número sequencial da estrutura.';

DESCRIBE FIELD ATIVOEST TABLE PPESTRUTURA
'Indica se a estrutura está ativa.(S/N)';

DESCRIBE FIELD CODEMPML TABLE PPESTRUTURA
'Código da empresa para o modelo de lote.';

DESCRIBE FIELD CODFILIALML TABLE PPESTRUTURA
'Código da filial do modelo de lote.';

DESCRIBE FIELD CODMODLOTE TABLE PPESTRUTURA
'Código do modelo de lote.';

DESCRIBE FIELD NRODIASVALID TABLE PPESTRUTURA
'Número de dias de validade do produto fabricado.';

DESCRIBE FIELD GLOTEOPP TABLE PPESTRUTURA
'Flag que indica, se quando distribuido, produto gera codigo do lote a partir do produto da op principal.';

DESCRIBE FIELD TIPOFASE TABLE PPFASE
'''EX'' = Execução;
''CQ'' = Controle de qualidade;
''EB'' = Embalagem.
';

DESCRIBE FIELD CODMTANALISE TABLE PPFOTOMTAN
'Código do método analítico.';

DESCRIBE FIELD CODFOTOMTAN TABLE PPFOTOMTAN
'Código da foto.';

DESCRIBE FIELD DESCFOTOMTAN TABLE PPFOTOMTAN
'Descrição da foto.';

DESCRIBE FIELD SEQEST TABLE PPITESTRUTURA
'Número sequencial da estrutura.';

DESCRIBE FIELD REFPROD TABLE PPITESTRUTURA
'Referencia do produto (estrutura)';

DESCRIBE FIELD REFPRODPD TABLE PPITESTRUTURA
'Referencia do produto (item).';

DESCRIBE FIELD SEQEF TABLE PPITESTRUTURA
'Sequencia da fase.';

DESCRIBE FIELD RMAAUTOITEST TABLE PPITESTRUTURA
'Flag para geração de RMA automática (S/N)';

DESCRIBE FIELD CPROVA TABLE PPITESTRUTURA
'Indica se o ítem será utilizado para retenção de contra-prova (controle de qualidade).';

DESCRIBE FIELD QTDVARIAVEL TABLE PPITESTRUTURA
'Indica se a quantidade varia em virtude da quantidade final produzida.';

DESCRIBE FIELD QTDFIXA TABLE PPITESTRUTURA
'Indica se a quantidade não deve ser multiplicada pela quantidade de itens de estrutura produzida.';

DESCRIBE FIELD SEQOP TABLE PPITOP
'Número sequencial da OP.';

DESCRIBE FIELD REFPROD TABLE PPITOP
'Referencia do produto.';

DESCRIBE FIELD CODEMPLE TABLE PPITOP
'Código da empresa - lote
';

DESCRIBE FIELD CODFILIALLE TABLE PPITOP
'Código da filial - Lote
';

DESCRIBE FIELD CODLOTE TABLE PPITOP
'Código do lote
';

DESCRIBE FIELD SEQITOPCP TABLE PPITOP
'Sequência do ítem copiado (utilizado no rateamento automático de lotes)';

DESCRIBE FIELD CODLOTERAT TABLE PPITOP
'Código do lote rateado';

DESCRIBE FIELD QTDCOPIAITOP TABLE PPITOP
'Quantidade da inserida na cópia do item. Este valor dispara o trigger para criação da cópia.';

DESCRIBE FIELD GERARMA TABLE PPITOP
'Indica se deve gerar rma para o item. pode ser que não deva ser gerado por padrão, ou por já ter sido gerado.';

DESCRIBE FIELD SEQAC TABLE PPITOP
'Sequencial da ação corretiva.';

DESCRIBE FIELD BLOQOP TABLE PPITOP
'Marca se item bloqueou op.';

DESCRIBE FIELD DESCMTANALISE TABLE PPMETODOANALISE
'Descrição do tipo de análise.';

DESCRIBE FIELD TITULOANALISE TABLE PPMETODOANALISE
'Título do método analítico.';

DESCRIBE FIELD FONTEMTANALISE TABLE PPMETODOANALISE
'Fonte do método analítico.';

DESCRIBE FIELD MATANALISE TABLE PPMETODOANALISE
'Material utilizado para a análise.';

DESCRIBE FIELD REAGANALISE TABLE PPMETODOANALISE
'Reagente da análise.';

DESCRIBE FIELD PROCANALISE TABLE PPMETODOANALISE
'Procedimentos';

DESCRIBE FIELD DTINS TABLE PPMETODOANALISE
'Data de inserção do registro.';

DESCRIBE FIELD IDUSUINS TABLE PPMETODOANALISE
'Usuário que inseriu o registro';

DESCRIBE FIELD HINS TABLE PPMETODOANALISE
'Hora da inserção do registro.';

DESCRIBE FIELD DTALT TABLE PPMETODOANALISE
'Data da ultima alteração do registro.';

DESCRIBE FIELD IDUSUALT TABLE PPMETODOANALISE
'Usuário que realizou a ultima alteração no registro.';

DESCRIBE FIELD HALT TABLE PPMETODOANALISE
'Hora da ultima alteração no registro.';

DESCRIBE FIELD CODOP TABLE PPOP
'Código da ordem de produção.';

DESCRIBE FIELD SEQOP TABLE PPOP
'Número sequencial da OP.';

DESCRIBE FIELD DTEMITOP TABLE PPOP
'Data de emissão
';

DESCRIBE FIELD CODEMPPD TABLE PPOP
'Código da empresa do produto acabado.';

DESCRIBE FIELD CODFILIALPD TABLE PPOP
'Código da filial do produto acabado.';

DESCRIBE FIELD CODPROD TABLE PPOP
'Código do produto acabado.';

DESCRIBE FIELD SEQEST TABLE PPOP
'Numero sequencial da estrutura.';

DESCRIBE FIELD REFPROD TABLE PPOP
'Referencia do produto acabado.';

DESCRIBE FIELD DTFABROP TABLE PPOP
'Data de fabricação do produto acabado.';

DESCRIBE FIELD QTDSUGPRODOP TABLE PPOP
'Quantidade final sugerida de produção.';

DESCRIBE FIELD QTDPREVPRODOP TABLE PPOP
'Quantidade prevista a ser produzida.';

DESCRIBE FIELD QTDFINALPRODOP TABLE PPOP
'Quantidade realmente produzida.';

DESCRIBE FIELD QTDDISTPOP TABLE PPOP
'Quantidade distribuída referente a OP principal.';

DESCRIBE FIELD QTDDISTIOP TABLE PPOP
'Quantidade distribuída referente a OP de distribuição.';

DESCRIBE FIELD DTVALIDPDOP TABLE PPOP
'Data de validade do lote do produto acabado.';

DESCRIBE FIELD CODEMPLE TABLE PPOP
'Código da empresa do lote do produto acabado.';

DESCRIBE FIELD CODFILIALLE TABLE PPOP
'Código da filial do lote do produto acabado.';

DESCRIBE FIELD CODLOTE TABLE PPOP
'Código do Lote para o produto acabado.';

DESCRIBE FIELD CODEMPTM TABLE PPOP
'Código da empresa do tipo de movimento.';

DESCRIBE FIELD CODFILIALTM TABLE PPOP
'Código da filial do tipo de movimento.';

DESCRIBE FIELD CODTIPOMOV TABLE PPOP
'Código do tipo de movimento.';

DESCRIBE FIELD CODEMPAX TABLE PPOP
'Código da empresa do almoxarifado.';

DESCRIBE FIELD CODFILIALAX TABLE PPOP
'Codigo da filial do almoxarifado.';

DESCRIBE FIELD CODALMOX TABLE PPOP
'Código do almoxarifado';

DESCRIBE FIELD CODEMPOPM TABLE PPOP
'Código da empresa da ordem de produção mestre (principal).';

DESCRIBE FIELD CODFILIALOPM TABLE PPOP
'Código da filial da ordem de produção mestre (principal).';

DESCRIBE FIELD CODOPM TABLE PPOP
'Código da ordem de produção mestre (principal).';

DESCRIBE FIELD SEQOPM TABLE PPOP
'Sequencial da ordem de produção mestre (principal).';

DESCRIBE FIELD SITOP TABLE PPOP
'Situação da OP.
PE - Pendente;
CA - Cancelada;
FN - Finalizada;
BL - Bloqueada;';

DESCRIBE FIELD OBSOP TABLE PPOP
'Campo para observações a cerca da ordem de produção.';

DESCRIBE FIELD JUSTFICQTDPROD TABLE PPOP
'Justificativa pela divergencia entre quantidade prevista e quantidade produzida.';

DESCRIBE FIELD JUSTIFICCANC TABLE PPOP
'Justificativa relativa ao cancelamento da OP.';

DESCRIBE FIELD DTCANC TABLE PPOP
'Data e hora do cancelamento da O.P.';

DESCRIBE FIELD IDUSUCANC TABLE PPOP
'Id do usuário que cancelou a O.P.';

DESCRIBE FIELD HCANC TABLE PPOP
'Hora do cancelamento da O.P.';

DESCRIBE FIELD DTINS TABLE PPOP
'Data de inserção do registro.';

DESCRIBE FIELD HINS TABLE PPOP
'Hora de inserção do registro.';

DESCRIBE FIELD IDUSUINS TABLE PPOP
'ID do usuário que inseriu o registro.';

DESCRIBE FIELD DTALT TABLE PPOP
'Data da última alteração no registro.';

DESCRIBE FIELD HALT TABLE PPOP
'Hora da última alteração no registro.';

DESCRIBE FIELD IDUSUALT TABLE PPOP
'Id do usuário que realizou a ultima alteração no registro.';

DESCRIBE FIELD TPCAUSA TABLE PPOPACAOCORRET
'Tipo de causas fundamentais:
''1M'' - Material;
''2M'' - Máquina;
''3M'' - Método;
''4M'' - Meio ambiente;
''5M'' - Mão-de-obra;
''6M'' - Medida;


';

DESCRIBE FIELD TPACAO TABLE PPOPACAOCORRET
'Tipo de ação corretiva pré-definida:
''II'' - Inclusão de insumos;
''DP'' - Descarte da produção;';

DESCRIBE FIELD CODEMP TABLE PPOPCQ
'Código da empresa.';

DESCRIBE FIELD CODFILIAL TABLE PPOPCQ
'Código da filial.';

DESCRIBE FIELD CODOP TABLE PPOPCQ
'Código da ordem de produção.';

DESCRIBE FIELD SEQOP TABLE PPOPCQ
'Sequência da ordem de produção.';

DESCRIBE FIELD SEQOPCQ TABLE PPOPCQ
'Sequência do controle de qualidade.';

DESCRIBE FIELD SEQAC TABLE PPOPCQ
'Sequencial da ação corretiva para o problema detectado.';

DESCRIBE FIELD CODEMPEA TABLE PPOPCQ
'Código da empresa da estrutura x analise.';

DESCRIBE FIELD CODFILIALEA TABLE PPOPCQ
'Código da filial da estrutura x analise.';

DESCRIBE FIELD CODESTANALISE TABLE PPOPCQ
'Código da estrutura x analise.';

DESCRIBE FIELD VLRAFER TABLE PPOPCQ
'Valor da aferição.';

DESCRIBE FIELD DESCAFER TABLE PPOPCQ
'Descritivo da aferição.';

DESCRIBE FIELD STATUS TABLE PPOPCQ
'Status da análise de controle de qualidade.
''PE'' - Pendente;
''AP'' - Aprovado;
''RC'' - Recusado;
''CO'' - Corrigido.';

DESCRIBE FIELD DTINS TABLE PPOPCQ
'Data de inserção do registro.';

DESCRIBE FIELD IDUSUINS TABLE PPOPCQ
'Usuário que inseriu o registro.';

DESCRIBE FIELD DTALT TABLE PPOPCQ
'Data de alteração no registro.';

DESCRIBE FIELD IDUSUALT TABLE PPOPCQ
'Usuário que alterou o registro.';

DESCRIBE FIELD HINS TABLE PPOPCQ
'Hora de inserção do registro.';

DESCRIBE FIELD HALT TABLE PPOPCQ
'Hora de alteração do registro.';

DESCRIBE FIELD SEQOP TABLE PPOPFASE
'Número sequencial da OP.';

DESCRIBE FIELD CODEMPTR TABLE PPOPFASE
'Código da empresa para tabela de tipos de recurso.';

DESCRIBE FIELD CODFILIALTR TABLE PPOPFASE
'Código da filial para tabela de tipos de recurso.';

DESCRIBE FIELD CODTPREC TABLE PPOPFASE
'Código do tipo de recurso.';

DESCRIBE FIELD DATAINIPRODFS TABLE PPOPFASE
'Data de inicio da produção da fase.';

DESCRIBE FIELD HINIPRODFS TABLE PPOPFASE
'Hora de inicio da produção da fase.';

DESCRIBE FIELD DATAFIMPRODFS TABLE PPOPFASE
'Data de termino da produção da fase.';

DESCRIBE FIELD HFIMPRODFS TABLE PPOPFASE
'Hora final da produção da fase.';

DESCRIBE FIELD OBSFS TABLE PPOPFASE
'Observações referentes a fase de produção.';

DESCRIBE FIELD SITFS TABLE PPOPFASE
'Indica se da fase está pendente ou finalizada.
''PE'' - Pendente
''FN'' - Finalizada';

DESCRIBE FIELD CODEMP TABLE PPTIPOANALISE
'Código da empresa.';

DESCRIBE FIELD CODFILIAL TABLE PPTIPOANALISE
'Código da filial.';

DESCRIBE FIELD CODTPANALISE TABLE PPTIPOANALISE
'Código do tipo de análise.';

DESCRIBE FIELD DESCTPANALISE TABLE PPTIPOANALISE
'Descrição do tipo de análise.';

DESCRIBE FIELD OBSTPANALISE TABLE PPTIPOANALISE
'Observação relativa ao tipo de análise, pode descrever o método de análise, instruções de coleta e/ou aferição, etc...';

DESCRIBE FIELD TIPOEXPEC TABLE PPTIPOANALISE
'Tipo de registro de especificações.
''MM'' - Mínimo e máximo;
''DT'' - Descritivo.';

DESCRIBE FIELD CODEMPUD TABLE PPTIPOANALISE
'Código da empresa da unidade.';

DESCRIBE FIELD CODFILIALUD TABLE PPTIPOANALISE
'Código da filial da unidade.';

DESCRIBE FIELD CODUNID TABLE PPTIPOANALISE
'Código da unidade de medida da análise.';

DESCRIBE FIELD CODEMPMA TABLE PPTIPOANALISE
'Código da empresa do método analítico.';

DESCRIBE FIELD CODFILIALMA TABLE PPTIPOANALISE
'Código da filial do método analítico.';

DESCRIBE FIELD CODMTANALISE TABLE PPTIPOANALISE
'Código do método analítico.';

DESCRIBE FIELD DTINS TABLE PPTIPOANALISE
'Data de inserção do registro.';

DESCRIBE FIELD IDUSUINS TABLE PPTIPOANALISE
'Usuário que inseriu o registro.';

DESCRIBE FIELD HINS TABLE PPTIPOANALISE
'Hora de inserção do registro.';

DESCRIBE FIELD DTALT TABLE PPTIPOANALISE
'Data da alteração no registro.';

DESCRIBE FIELD IDUSUALT TABLE PPTIPOANALISE
'Usuário que alterou o registro.';

DESCRIBE FIELD HALT TABLE PPTIPOANALISE
'Hora da alteração no registro.';

DESCRIBE FIELD CODEMPET TABLE PVCAIXA
'Código da empresa na tabela de estação de trabalho.';

DESCRIBE FIELD CODFILIALET TABLE PVCAIXA
'Código da filial na tabela de estações de trabalho.';

DESCRIBE FIELD CODEST TABLE PVCAIXA
'Código da estação de trabalho.';

DESCRIBE FIELD SEQINI TABLE PVCAIXA
'FAIXA INICIAL PARA SEQUENCIA DE VENDA DE ECF';

DESCRIBE FIELD SEQMAX TABLE PVCAIXA
'FAIXA FINAL PARA SEQUENCIA DE VENDA DE ECF';

DESCRIBE FIELD ORCCAIXA TABLE PVCAIXA
'Habilita a venda para pdv somente com orçamento.';

DESCRIBE FIELD CODAREA TABLE RHAREA
'Código da área.';

DESCRIBE FIELD UFCAND TABLE RHCANDIDATO
'Unidade federativa do candidato.';

DESCRIBE FIELD OUTROSEMPREGOS TABLE RHCANDIDATO
'Outros empregos.';

DESCRIBE FIELD CODEMPES TABLE RHCANDIDATO
'Código da empresa do estado civil.';

DESCRIBE FIELD CODFILIALES TABLE RHCANDIDATO
'Código da filial do estado civil.';

DESCRIBE FIELD CODESTCIVIL TABLE RHCANDIDATO
'Código do estado civil.';

DESCRIBE FIELD PRETENSAOSAL TABLE RHCANDIDATO
'Pretensão salarial.';

DESCRIBE FIELD STCAND TABLE RHCANDIDATO
'Status do candidato:
''IN'' - Inativo;
''DI'' - Disponível;
''EN'' - Encaminhado;
''EL'' - Eliminado de processo seletivo;
''EF'' - Efetivado;
''EM'' - Empregado;
''EV'' - Entrevistado;
''DL'' - Desligado;';

DESCRIBE FIELD OBSCAND TABLE RHCANDIDATO
'Observações do candidato.';

DESCRIBE FIELD NROFILHOS TABLE RHCANDIDATO
'Número de filhos.';

DESCRIBE FIELD ISENCTRANSP TABLE RHCANDIDATO
'Indica se candidato é isento de tarifa de transporte - S/N';

DESCRIBE FIELD DTSTATUS TABLE RHCANDIDATOSTATUS
'Data do status.';

DESCRIBE FIELD DESCCURSO TABLE RHCURSO
'Descrição do curso.';

DESCRIBE FIELD CONTPROGCURSO TABLE RHCURSO
'Conteúdo programático do curso.';

DESCRIBE FIELD INSTITUICAOCURSO TABLE RHCURSO
'Instituição de ensino onde foi realizado o curso.';

DESCRIBE FIELD DURACAOCURSO TABLE RHCURSO
'Duração do curso (em meses).';

DESCRIBE FIELD CODAREA TABLE RHCURSO
'Código da área ';

DESCRIBE FIELD CODEMPAR TABLE RHCURSO
'Código da empresa da área.';

DESCRIBE FIELD CODFILIALAR TABLE RHCURSO
'Código da filial da área.';

DESCRIBE FIELD CODNIVELCURSO TABLE RHCURSO
'Nível do curso';

DESCRIBE FIELD CODEMPNC TABLE RHCURSO
'Código da empresa do nível do curso.';

DESCRIBE FIELD CODFILIALNC TABLE RHCURSO
'Código da filial do nível do curso.';

DESCRIBE FIELD APELIDOEMPR TABLE RHEMPREGADO
'Nome reduzido ou apelido para uso no cracha do empregado.';

DESCRIBE FIELD DTADMISSAO TABLE RHEMPREGADO
'Data de admissão do empregado.';

DESCRIBE FIELD FOTOEMPR TABLE RHEMPREGADO
'Foto do empregado.';

DESCRIBE FIELD STATUSEMPR TABLE RHEMPREGADO
'Status do empregado
''AD'' - Admitido;
''DE'' - Demitido;
''EF'' - Em férias;
''LM'' - Licença maternidade;
''AI'' - Afastamento INSS;
''AP'' - Aposentado;';

DESCRIBE FIELD SEXOEMPR TABLE RHEMPREGADO
'Sexo do empregado';

DESCRIBE FIELD DTNASCEMPR TABLE RHEMPREGADO
'Data de nascimento do empregado.';

DESCRIBE FIELD CTPSEMPR TABLE RHEMPREGADO
'Identificação da Carteira de Trabalho e Previdência Social.';

DESCRIBE FIELD SERIECTPSEMPR TABLE RHEMPREGADO
'Série da carteira de trabalho e previdência social.';

DESCRIBE FIELD UFCTPSEMPR TABLE RHEMPREGADO
'Estado de emissão da carteira de trabalho e previdência social.';

DESCRIBE FIELD CERTRESERVEMPR TABLE RHEMPREGADO
'Certificado de reservista (Exército)';

DESCRIBE FIELD PISPASEPEMPR TABLE RHEMPREGADO
'PIS PASEP do empregado.';

DESCRIBE FIELD RGEMPR TABLE RHEMPREGADO
'RG do empregado.';

DESCRIBE FIELD ORGEXPRHEMPR TABLE RHEMPREGADO
'Orgão de expedição do RG do Empregado.';

DESCRIBE FIELD CPFEMPR TABLE RHEMPREGADO
'CPF do Empregado.';

DESCRIBE FIELD UFRGEMPR TABLE RHEMPREGADO
'Estado de expedição do RG.';

DESCRIBE FIELD DTEXPRGEMPR TABLE RHEMPREGADO
'Data de expedição do RG.';

DESCRIBE FIELD TITELEITEMPR TABLE RHEMPREGADO
'Titulo de eleitor.';

DESCRIBE FIELD ZONAELEITEMPR TABLE RHEMPREGADO
'Zona eleitoral do empregado.';

DESCRIBE FIELD SECAOELEITEMPR TABLE RHEMPREGADO
'Secao eleitoral do empregado.';

DESCRIBE FIELD CNHEMPR TABLE RHEMPREGADO
'Carteira nacional de habilitação do empregado.';

DESCRIBE FIELD MAEEMPR TABLE RHEMPREGADO
'Nome da mãe do empregado.';

DESCRIBE FIELD PAIEMPR TABLE RHEMPREGADO
'Nome do pai do empregado.';

DESCRIBE FIELD COMPLENDEMPR TABLE RHEMPREGADO
'Complemento do endereço do empregado.';

DESCRIBE FIELD UFEMPR TABLE RHEMPREGADO
'Estado do empregado (Endereço).';

DESCRIBE FIELD DTDEMISSAOEMPR TABLE RHEMPREGADO
'Data de demissão do empregado.';

DESCRIBE FIELD DDDEMPR TABLE RHEMPREGADO
'DDD do telefone do cliente.';

DESCRIBE FIELD FONE2EMPR TABLE RHEMPREGADO
'Segundo telefone do empregado.';

DESCRIBE FIELD CELEMPR TABLE RHEMPREGADO
'Telefone celular do empregado.';

DESCRIBE FIELD EMAILEMPR TABLE RHEMPREGADO
'Email do empregado.';

DESCRIBE FIELD NOMEEMPR TABLE RHEMPREGADOR
'Nome do empregador conveniado.';

DESCRIBE FIELD ATIVOEMPR TABLE RHEMPREGADOR
'Indica se empregador está (A) ativo ou inativo (I).';

DESCRIBE FIELD CNPJEMPR TABLE RHEMPREGADOR
'CNPJ do empregador conveniado.';

DESCRIBE FIELD INSCEMPR TABLE RHEMPREGADOR
'Inscrição estadual do empregador conveniado.';

DESCRIBE FIELD ENDEMPR TABLE RHEMPREGADOR
'Endereço do empregador conveniado.';

DESCRIBE FIELD NUMEMPR TABLE RHEMPREGADOR
'Número do endereço do empregador conveniado.';

DESCRIBE FIELD DTVIGOR TABLE RHEMPREGADOSAL
'Data de vigor do novo salário.';

DESCRIBE FIELD OBSSAL TABLE RHEMPREGADOSAL
'Observações a respeito do salário.';

DESCRIBE FIELD CBOFUNC TABLE RHFUNCAO
'Código brasileiro de ocupações (CBO)';

DESCRIBE FIELD DESCTURNO TABLE RHTURNO
'Descrição do turno.';

DESCRIBE FIELD NHSTURNO TABLE RHTURNO
'Número de horas semanais.';

DESCRIBE FIELD TIPOTURNO TABLE RHTURNO
'Tipo de turno:
N - Normal (Manhã e tarde)
M - Manhã
T - Tarde
O - Noite
E - Especial
';

DESCRIBE FIELD HINITURNO TABLE RHTURNO
'Hora inicial do turno.';

DESCRIBE FIELD HFIMTURNO TABLE RHTURNO
'Hora final do turno.';

DESCRIBE FIELD HINIINTTURNO TABLE RHTURNO
'Hora inicial do intervalo.';

DESCRIBE FIELD HFIMINTTURNO TABLE RHTURNO
'Hora final do intervalo.';

DESCRIBE FIELD TOLENTRADA TABLE RHTURNO
'Tolerância na entrada (minutos).';

DESCRIBE FIELD TOLSAIDA TABLE RHTURNO
'Tolerância na saída (minutos).';

DESCRIBE FIELD CODVAGA TABLE RHVAGA
'Código da vaga.';

DESCRIBE FIELD CODEMPR TABLE RHVAGA
'Código do empregador.';

DESCRIBE FIELD CODFUNC TABLE RHVAGA
'Código da função.';

DESCRIBE FIELD CODEMPTN TABLE RHVAGA
'Código da empresa do turno.';

DESCRIBE FIELD CODFILIALTN TABLE RHVAGA
'Código da filial do turno.';

DESCRIBE FIELD CODTURNO TABLE RHVAGA
'Código do turno.';

DESCRIBE FIELD STVAGA TABLE RHVAGA
'Status da vaga:
''AB'' - Aberta;
''SL'' - Em processo de seleção;
''CA'' - Cancelada;
''PR'' - Preenchida;';

DESCRIBE FIELD DTULTST TABLE RHVAGA
'Data do ultimo status.';

DESCRIBE FIELD STVAGACAND TABLE RHVAGACANDIDATO
'Situação do candidato na vaga:
''EN'' Encaminhado
''EF'' Efetivado ';

DESCRIBE FIELD CODVAGA TABLE RHVAGASTATUS
'Código da vaga.';

DESCRIBE FIELD SQSTVAGA TABLE RHVAGASTATUS
'Sequencial do status da vaga.';

DESCRIBE FIELD STVAGA TABLE RHVAGASTATUS
'Status da vaga:
''''AB'''' - Aberta;
''''SL'''' - Em processo de seleção;
''''CA'''' - Cancelada;
''''PR'''' - Preenchida;';

DESCRIBE FIELD DTSTATUS TABLE RHVAGASTATUS
'Data do ustatus.';

DESCRIBE FIELD TIPOAGE TABLE SGAGENDA
'Tipo do agente.';

DESCRIBE FIELD CODAGE TABLE SGAGENDA
'Código do agente.';

DESCRIBE FIELD CODAGEEMIT TABLE SGAGENDA
'Código do agente criador do agendamento';

DESCRIBE FIELD CAAGD TABLE SGAGENDA
'Controle de acesso ao agendamento
"PU" - publico
"PR" - privado
';

DESCRIBE FIELD CODTIPOAGD TABLE SGAGENDA
'Código do tipo de agendamento.';

DESCRIBE FIELD CODEMP TABLE SGAGENTE
'Código da empresa
';

DESCRIBE FIELD CODFILIAL TABLE SGAGENTE
'Código da filial';

DESCRIBE FIELD TIPOAGE TABLE SGAGENTE
'Tipo do agente:
SGUSU - Usuário
';

DESCRIBE FIELD CODAGE TABLE SGAGENTE
'Código do agente.';

DESCRIBE FIELD DESCAGE TABLE SGAGENTE
'Descrição ou nome do agente.';

DESCRIBE FIELD IDUSUINS TABLE SGATRIBUSU
'ID do usuário que inseriu.';

DESCRIBE FIELD DTINS TABLE SGATRIBUSU
'Data de inserção.';

DESCRIBE FIELD HINS TABLE SGATRIBUSU
'Hora de inserção.';

DESCRIBE FIELD IDUSUALT TABLE SGATRIBUSU
'ID do último usuário que alterou.';

DESCRIBE FIELD DTALT TABLE SGATRIBUSU
'Data da última alteração.';

DESCRIBE FIELD HALT TABLE SGATRIBUSU
'Hora da última alteração.';

DESCRIBE FIELD MULTIALMOXEMP TABLE SGEMPRESA
'Flag que indica se o estoque será controlado por multiplos almoxarifados.';

DESCRIBE FIELD MODODEMOEST TABLE SGESTACAO
'Indica se a estação está em modo demonstrativo.';

DESCRIBE FIELD IDUSUINS TABLE SGESTACAO
'ID do usuário que inseriu.';

DESCRIBE FIELD DTINS TABLE SGESTACAO
'Data de inserção.';

DESCRIBE FIELD HINS TABLE SGESTACAO
'Hora de inserção.';

DESCRIBE FIELD IDUSUALT TABLE SGESTACAO
'ID do último usuário que alterou.';

DESCRIBE FIELD DTALT TABLE SGESTACAO
'Data da última alteração.';

DESCRIBE FIELD HALT TABLE SGESTACAO
'Hora da última alteração.';

DESCRIBE FIELD CODFILIAL TABLE SGESTACAOIMP
'Código da filial na tabela de estações de trabalho.';

DESCRIBE FIELD CODEST TABLE SGESTACAOIMP
'Código da estação de trabalho.';

DESCRIBE FIELD NROIMP TABLE SGESTACAOIMP
'Número da impressora na estação.';

DESCRIBE FIELD CODEMPIP TABLE SGESTACAOIMP
'Código da empresa na tabela de impressoras.';

DESCRIBE FIELD CODFILIALIP TABLE SGESTACAOIMP
'Código da filial na tabela de impressoras.';

DESCRIBE FIELD CODIMP TABLE SGESTACAOIMP
'Código da impressora.';

DESCRIBE FIELD CODEMPPP TABLE SGESTACAOIMP
'Código da empresa na tabela de papel.';

DESCRIBE FIELD CODFILIALPP TABLE SGESTACAOIMP
'Código da filial na tabela papel.';

DESCRIBE FIELD CODPAPEL TABLE SGESTACAOIMP
'Código do papel.';

DESCRIBE FIELD PORTAWIN TABLE SGESTACAOIMP
'Porta de impressão no windows.';

DESCRIBE FIELD PORTALIN TABLE SGESTACAOIMP
'Porta de impressão no linux.';

DESCRIBE FIELD IMPPAD TABLE SGESTACAOIMP
'Flag que define se a impressora é padrão.';

DESCRIBE FIELD TIPOUSOIMP TABLE SGESTACAOIMP
'Tipo de uso da impressora.:
NF - Nota fiscal;
NS - Nota fiscal - serviço;
PD - Pedido;
RS - Relatório simples;
RG - Relatório gráfico;
TO - Todos;
';

DESCRIBE FIELD IMPGRAFICA TABLE SGESTACAOIMP
'Flag que define se a impressão é gráfica.';

DESCRIBE FIELD IDUSUINS TABLE SGESTACAOIMP
'ID do usuário que inseriu.';

DESCRIBE FIELD DTINS TABLE SGESTACAOIMP
'Data de inserção do registro.';

DESCRIBE FIELD HINS TABLE SGESTACAOIMP
'Hora da inserção.';

DESCRIBE FIELD IDUSUALT TABLE SGESTACAOIMP
'ID do último usuário que alterou.';

DESCRIBE FIELD DTALT TABLE SGESTACAOIMP
'Data da última alteração.';

DESCRIBE FIELD HALT TABLE SGESTACAOIMP
'Hora da última alteração.';

DESCRIBE FIELD DESCESTCIVIL TABLE SGESTCIVIL
'Descrição do estado civil.';

DESCRIBE FIELD BANCFER TABLE SGFERIADO
'Indica se é um feriado bancário.';

DESCRIBE FIELD TRABFER TABLE SGFERIADO
'Indica se é um feriado trabalhista.';

DESCRIBE FIELD TIPOFEBRABAN TABLE SGITPREFERE6
'Tipo de layout SIACC=01 ou CNAB=02';

DESCRIBE FIELD CODCONV TABLE SGITPREFERE6
'Código do convênio.';

DESCRIBE FIELD CONVCOB TABLE SGITPREFERE6
'Convênio de cobrança do bloqueto.';

DESCRIBE FIELD VERLAYOUT TABLE SGITPREFERE6
'Versão do layout.';

DESCRIBE FIELD IDENTSERV TABLE SGITPREFERE6
'Identificação do serviço.';

DESCRIBE FIELD CONTACOMPR TABLE SGITPREFERE6
'Conta compromisso.';

DESCRIBE FIELD IDENTAMBCLI TABLE SGITPREFERE6
'Identificação de ambiente do cliente. P=Produção - T=Teste.';

DESCRIBE FIELD IDENTAMBBCO TABLE SGITPREFERE6
'Identificação do ambiente do banco. P=Produção - T=Teste.';

DESCRIBE FIELD NUMCONTA TABLE SGITPREFERE6
'Número da conta corrente.';

DESCRIBE FIELD FORCADTIT TABLE SGITPREFERE6
'Forma de cadastramento do titulo.
1 - Com cadastro.
2 - Sem cadastro.';

DESCRIBE FIELD TIPODOC TABLE SGITPREFERE6
'Tipo de documento.
1 - Tradicional.
2 - Escrutiral.
';

DESCRIBE FIELD IDENTEMITBOL TABLE SGITPREFERE6
'Identificação da emissão de bloqueto.
1 - Banco emite.
2 - Cliente emite.
3 - Banco pré-emite e o cliente completa.
4 - Banco reemite.
5 - Banco não reemite.
6 - Cobrança sem papel.
Obs.: Os campos 4 e 5 só serão aceitos para código de movimento para remessa 31.';

DESCRIBE FIELD IDENTDISTBOL TABLE SGITPREFERE6
'Identificação da distribuição.
1 - Banco.
2 - Cliente.';

DESCRIBE FIELD ESPECTIT TABLE SGITPREFERE6
'Especie do titulo.
01 - CH Cheque.
02 - DM Duplicata mercantíl.
03 - DMI Duplicata mercantíl p/ indicação.
04 - DS Duplicata de serviço.
05 - DSI DUplicata de serviçõ p/ indicação.
06 - DR Duplicata rural.
07 - LC Letra de cambio.
08 - NCC Nota de crédito comercial.
09 - NCE Nota de crédito a exportação.
10 - NCI Nota de crédito indústria.
11 - NCR Nota de crédito rural.
12 - NP Nota promissória.
13 - NPR Nota promissória rural.
14 - TM Triplicata mercantíl.
15 - TS Triplicata de serviço.
16 - NS Nota de seguro.
17 - RC Recibo.
18 - FAT Fatura.
19 - ND Nota de débito.
20 - AP Apolice de seguro.
21 - ME Mensalidade escolar.
22 - PC Parcela de consórcio.
99 - Outros.

';

DESCRIBE FIELD CODJUROS TABLE SGITPREFERE6
'Código do juros de mora.
1 - Valor por dia.
2 - Taxa nensal.
3 - Isento.
';

DESCRIBE FIELD VLRPERCJUROS TABLE SGITPREFERE6
'Valor ou percentual do juros.
';

DESCRIBE FIELD CODDESC TABLE SGITPREFERE6
'Código do desconto.
1 - Valor fixo até a data informada.
2 - Percentual até a data informada.
3 - Valor por antecipação por dia corrido.
4 - Valor por antecipação por dia util.
5 - Percentual sobre o valor nominal dia corrido.
6 - Percentual sobre o valor nominal dia util.
Obs.: Para as opções 1 e 2 será obrigatório a informação da data.';

DESCRIBE FIELD VLRPERCDESC TABLE SGITPREFERE6
'Valor ou percentual do desconto.';

DESCRIBE FIELD CODPROT TABLE SGITPREFERE6
'Código para protesto.
1 - Dias corridos.
2 - Dias utéis.
3 - Não protestar.';

DESCRIBE FIELD DIASPROT TABLE SGITPREFERE6
'Número de dias para protesto.';

DESCRIBE FIELD CODBAIXADEV TABLE SGITPREFERE6
'Código para baixa/devolução.
1 - Baixar/Devolver.
2 - Não baixar/ Não devolver.';

DESCRIBE FIELD DIASBAIXADEV TABLE SGITPREFERE6
'Número de dias para a Baixa / Devolução.';

DESCRIBE FIELD ACEITE TABLE SGITPREFERE6
'Defini o aceite do arquivo de cnab S - sim e N - não';

DESCRIBE FIELD CLASLOG TABLE SGLOG
'Classificacao do log
PR - Procedimento
ER - Erro 
';

DESCRIBE FIELD TIPOLOG TABLE SGLOG
'Tipo do log:
LIB - Liberação de venda abaixo do custo
';

DESCRIBE FIELD DESCLOG TABLE SGLOG
'Descrição resumida da operação
';

DESCRIBE FIELD OBSLOG TABLE SGLOG
'Descrição completa e observações sobre a operação
';

DESCRIBE FIELD EECMODETIQ TABLE SGMODETIQUETA
'Número de espaços entre colunas.';

DESCRIBE FIELD COMPRIMIDO TABLE SGMODETIQUETA
'Indica se deve imprimir comprimido.';

DESCRIBE FIELD POSSCRIPT TABLE SGMODETIQUETA
'indica se a etiqueta é pós script.';

DESCRIBE FIELD MODETIQ TABLE SGMODETIQUETA
'indica o nome do jasper.';

DESCRIBE FIELD CODPAIS TABLE SGPAIS
'Código do país segundo o ISO 3166-1';

DESCRIBE FIELD SIGLA3CPAIS TABLE SGPAIS
'Sigla do país com 3 caracteres.';

DESCRIBE FIELD DDIPAIS TABLE SGPAIS
'Código de discagem direta a distancia do pais (ddi)';

DESCRIBE FIELD SIGLA2CPAIS TABLE SGPAIS
'Sigla do pais com 2 caracteres';

DESCRIBE FIELD USAORCSEQ TABLE SGPREFERE1
'FLAG QUE INDICA SE USA PEDIDO SEQUENCIAL NO ORÇAMENTO';

DESCRIBE FIELD TIPOPREFCRED TABLE SGPREFERE1
'Indica quando deve ser feita a verificação do crédito:
FV - Fechamento de venda;
II - Inserção de ítem;
AB - Ambos;';

DESCRIBE FIELD TABFRETEVD TABLE SGPREFERE1
'Indica se a aba frete será obrigatória na tela de vendas.
';

DESCRIBE FIELD TABADICVD TABLE SGPREFERE1
'Indica se a aba adicionais será obrigatória na tela de vendas.
';

DESCRIBE FIELD TRAVATMNFVD TABLE SGPREFERE1
'Trava tela de venda para não receber tipo de movimento de NF na inserção.
';

DESCRIBE FIELD TIPOVALIDORC TABLE SGPREFERE1
'Opção de validade para impressão nos orçamentos:
"N"=número de dias ; 
"D" data 
';

DESCRIBE FIELD CLIMESMOCNPJ TABLE SGPREFERE1
'Permitir clientes com mesmo CNPJ:
S-SIM N-NÃO
';

DESCRIBE FIELD CNPJOBRIGCLI TABLE SGPREFERE1
'CNPJ Obrigatório para o cadastro de clientes S ou N
';

DESCRIBE FIELD CODEMPTN TABLE SGPREFERE1
'Código da empresa para transportadora';

DESCRIBE FIELD CODFILIALTN TABLE SGPREFERE1
'Código da filial para transportadora.';

DESCRIBE FIELD CODTRAN TABLE SGPREFERE1
'Código da transportadora.';

DESCRIBE FIELD ESTLOTNEG TABLE SGPREFERE1
'Permitir estoque de lote negativo
';

DESCRIBE FIELD NATVENDA TABLE SGPREFERE1
'CFOP habilitada na tela de venda
';

DESCRIBE FIELD IPIVENDA TABLE SGPREFERE1
'Habilita campo IPI ';

DESCRIBE FIELD CUSTOSICMS TABLE SGPREFERE1
'Preço de custo na compra sem ICMS.';

DESCRIBE FIELD CASASDECFIN TABLE SGPREFERE1
'Define as casas decimas para assuntos financeiros';

DESCRIBE FIELD COMISPDUPL TABLE SGPREFERE1
'Cálculo de comissões por duplicata
''S'' calcula pelas parcelas do contas a receber.
''N'' calcula pelo valor da venda.';

DESCRIBE FIELD CODEMPT6 TABLE SGPREFERE1
'Código da empresa para tipo de movimento de inventário';

DESCRIBE FIELD CODFILIALT6 TABLE SGPREFERE1
'Código da filial para tipo de movimento de inventário';

DESCRIBE FIELD CODTIPOMOV6 TABLE SGPREFERE1
'Código de tipo de movimento de inventário';

DESCRIBE FIELD BLOQCOMPRA TABLE SGPREFERE1
'FLAG PARA BLOQUEAR A COMPRA';

DESCRIBE FIELD VENDAMATPRIM TABLE SGPREFERE1
'Flag para permitir venda de matéria prima (S/N).';

DESCRIBE FIELD PEPSPROD TABLE SGPREFERE1
'Flag que indica se deve aparecer o campo custo peps na tela de cadastro de produtos.';

DESCRIBE FIELD CNPJFOROBRIG TABLE SGPREFERE1
'Flag que indica se o CNPJ do fornecedor é obrigatório.';

DESCRIBE FIELD INSCESTFOROBRIG TABLE SGPREFERE1
'Flag que indica se a insc. est. do fornecedor é obrigatória.';

DESCRIBE FIELD BUSCAPRODSIMILAR TABLE SGPREFERE1
'Flag que indica se ao entrar com código de produto em textfield deverá buscar os produtos similares.';

DESCRIBE FIELD MULTIALMOX TABLE SGPREFERE1
'Flag que indica o trabalho com multiplos almoxarifados.';

DESCRIBE FIELD CODEMPT8 TABLE SGPREFERE1
'Cod. emp. do tipo de movimento padrão para RMA.';

DESCRIBE FIELD CODFILIALT8 TABLE SGPREFERE1
'Cod. filial do tipo de movimento padrão para RMA.';

DESCRIBE FIELD CODTIPOMOV8 TABLE SGPREFERE1
'Codigo do tipo de movimento padrão para RMA.';

DESCRIBE FIELD ESTNEGGRUP TABLE SGPREFERE1
'Define se controla o estoque negativo por grupo.';

DESCRIBE FIELD USATABPE TABLE SGPREFERE1
'Flag para usar tabela de prazos de entrega.';

DESCRIBE FIELD DESCCOMPPED TABLE SGPREFERE1
'Indica se será utilizada a descrição completa nos orçamentos e pedidos.';

DESCRIBE FIELD OBSCLIVEND TABLE SGPREFERE1
'Flag para mostrar observações do cliente na tela de venda.';

DESCRIBE FIELD CONTESTOQ TABLE SGPREFERE1
'Flag que define se o sistema vai trabalhar com estoque.';

DESCRIBE FIELD DIASPEDT TABLE SGPREFERE1
'S - mostra data de entrega no pedido
N - mostra número de dias para entrega';

DESCRIBE FIELD RECALCPCVENDA TABLE SGPREFERE1
'flag que marca se deve recalcular os valores do item quando alterar o cabeçalho';

DESCRIBE FIELD RECALCPCORC TABLE SGPREFERE1
'flag que marca se deve recalcular os valores do item quando alterar o cabeçalho';

DESCRIBE FIELD USALAYOUTPED TABLE SGPREFERE1
'define se usa layout proprio para pedido';

DESCRIBE FIELD VERIFALTPARCVENDA TABLE SGPREFERE1
'FLAG INDICA SE FAZ VERIFICAÇÃO PARA ALTERAR PARCELA DA VENDA';

DESCRIBE FIELD BUSCACODPRODGEN TABLE SGPREFERE1
'BUSCA GENERICA DO CÓDIGO DO PRODUTO';

DESCRIBE FIELD FILBUSCGENPROD TABLE SGPREFERE1
'FILTAR POR PRODUTO NA BUSCA COM O CÓDIGO DE BARRAS';

DESCRIBE FIELD FILBUSCGENREF TABLE SGPREFERE1
'FILTAR POR REFERENCIA NA BUSCA COM O CÓDIGO DE BARRAS';

DESCRIBE FIELD FILBUSCGENCODBAR TABLE SGPREFERE1
'FILTAR POR CODIGO DE BARRAS NA BUSCA COM O CÓDIGO DE BARRAS';

DESCRIBE FIELD FILBUSCGENCODFAB TABLE SGPREFERE1
'FILTAR POR CODIGO DO FABRICANTE NA BUSCA COM O CÓDIGO DE BARRAS';

DESCRIBE FIELD BUSCAVLRULTCOMPRA TABLE SGPREFERE1
'Busca o valor da ultima compra na tela de compras.';

DESCRIBE FIELD USAIMGASSORC TABLE SGPREFERE1
'Flag para usar imagem de assinatura no orçamento.';

DESCRIBE FIELD IMGASSORC TABLE SGPREFERE1
'Imagem de assinatura pra orçamento.';

DESCRIBE FIELD CONSISTCPFCLI TABLE SGPREFERE1
'Indica se deve consistir CPF no cliente';

DESCRIBE FIELD CONSISTEIECLI TABLE SGPREFERE1
'Indica se deve consistir IE no cliente';

DESCRIBE FIELD CONSISTEIEFOR TABLE SGPREFERE1
'Indica se deve consistir IE no fornecedor.';

DESCRIBE FIELD USANOMEVENDORC TABLE SGPREFERE1
'Flag ''S'' para indicar o uso de nome do vendedor no orçamento, caso contrário utilizará o nome da empresa.';

DESCRIBE FIELD SISCONTABIL TABLE SGPREFERE1
'Seleciona o sistema de contabilidade utilizado.
00 - Nenhum
01 - Freedom Contábil
02 - Safe Contábil
';

DESCRIBE FIELD ATBANCOIMPBOL TABLE SGPREFERE1
'Flag que indica se o banco poderá ser atualizado na tela de impressão de boleto.';

DESCRIBE FIELD TIPOCODBAR TABLE SGPREFERE1
'Tipo de código de barras.
1-EAN
2-39';

DESCRIBE FIELD ADICORCOBSPED TABLE SGPREFERE1
'Flag que indica se deve carregar os códigos dos orçamentos nas observações dos pedidos, gerados a partir de orçamentos.';

DESCRIBE FIELD CODEMPMENSORC TABLE SGPREFERE1
'Código da empresa para a mensagem padrão para orçamento.';

DESCRIBE FIELD CODFILIALMENSORC TABLE SGPREFERE1
'Código da filial para mensagem padrão para orçamento.';

DESCRIBE FIELD CODMENSORC TABLE SGPREFERE1
'Código da mensagem padrão para orçamento.';

DESCRIBE FIELD CUSTOCOMPRA TABLE SGPREFERE1
'Habilita para digitação campo de custo na compra.';

DESCRIBE FIELD TABTRANSPCP TABLE SGPREFERE1
'Indica se deve mostrar aba de transportadora na tela de compra.';

DESCRIBE FIELD TABSOLCP TABLE SGPREFERE1
'Habilita e desabilita aba de solicitação na tela de compras.';

DESCRIBE FIELD ADICFRETEBASEICM TABLE SGPREFERE1
'Indica se deve permitir adicionar frete à base de calculo do ICMS.
';

DESCRIBE FIELD PRECOCPREL TABLE SGPREFERE1
'Indica se deve mostrar o preço de compra nos relatórios de compra.';

DESCRIBE FIELD MULTICOMIS TABLE SGPREFERE1
'Habilita e desabilita multi-comissionados.';

DESCRIBE FIELD USUATIVCLI TABLE SGPREFERE1
'S - Define controle de acesso para ativação de cliente por usuário.';

DESCRIBE FIELD CODEMPHISTREC TABLE SGPREFERE1
'Código da empresa do histórico padrão para lançamentos financeiros provenientes do contas a receber.';

DESCRIBE FIELD CODFILIALHISTREC TABLE SGPREFERE1
'Código da filial do histórico padrão para lançamentos financeiros provenientes do contas a receber.';

DESCRIBE FIELD CODHISTREC TABLE SGPREFERE1
'Código do histórico padrão para lançamentos financeiros provenientes do contas a receber.';

DESCRIBE FIELD CODEMPHISTPAG TABLE SGPREFERE1
'Código da empresa do histórico padrão para lançamentos financeiros provenientes do contas a pagar.';

DESCRIBE FIELD CODFILIALHISTPAG TABLE SGPREFERE1
'Código da filial do histórico padrão para lançamentos financeiros provenientes do contas a pagar.';

DESCRIBE FIELD CODHISTPAG TABLE SGPREFERE1
'Código do histórico padrão para lançamentos financeiros provenientes do contas a pagar.';

DESCRIBE FIELD ESTITRECALTDTVENC TABLE SGPREFERE1
'Flag que indica se estorna recebimento ao alterar data de vencimento da parcela com baixa automatica.';

DESCRIBE FIELD LCREDGLOBAL TABLE SGPREFERE1
'Indica se a liberação de crédito deve ser agrupada, para clientes com sub-clientes.';

DESCRIBE FIELD VDMANUTCOMOBRIG TABLE SGPREFERE1
'Indica se o filtro de vendedor é obrigatória na tela de manutenção de comissões.';

DESCRIBE FIELD CLASSPED TABLE SGPREFERE1
'Classe padrão para pedidos gráficos.';

DESCRIBE FIELD TIPOCLASSPED TABLE SGPREFERE1
'Indica o tipo de classe padrão para orçamentos.
QA - Resultset como parâmetro (Query na Aplicação);
QJ - Parametros de filtro (Query no Jasper).
';

DESCRIBE FIELD USAIBGECLI TABLE SGPREFERE1
'Indica se deve usar a tabela de IBGE de cidades para o cadastro de clientes.';

DESCRIBE FIELD USAIBGEFOR TABLE SGPREFERE1
'Indica se deve usar a tabela de IBGE de cidades para o cadastro de fornecedores.';

DESCRIBE FIELD USAIBGETRANSP TABLE SGPREFERE1
'Indica se deve usar a tabela de IBGE de cidades para o cadastro de transportadoras.';

DESCRIBE FIELD SOMAVOLUMES TABLE SGPREFERE1
'Indica se deve somar as quantidades dos itens de venda e lançar no campo "volumes".';

DESCRIBE FIELD BUSCACEP TABLE SGPREFERE1
'Indica se deve habilitar o botão para busca de ceps nos cadastros.';

DESCRIBE FIELD URLWSCEP TABLE SGPREFERE1
'URL do web service de busca de endereço pelo cep.';

DESCRIBE FIELD CLASSCP TABLE SGPREFERE1
'Classe padrão para pedido de compra.';

DESCRIBE FIELD LABELOBS01CP TABLE SGPREFERE1
'Descrição para o campo coringa obs01 da tabela CPCOMPRA.';

DESCRIBE FIELD LABELOBS02CP TABLE SGPREFERE1
'Descrição para o campo coringa obs02 da tabela CPCOMPRA.';

DESCRIBE FIELD LABELOBS03CP TABLE SGPREFERE1
'Descrição para o campo coringa obs03 da tabela CPCOMPRA.';

DESCRIBE FIELD LABELOBS04CP TABLE SGPREFERE1
'Descrição para o campo coringa obs04 da tabela CPCOMPRA.';

DESCRIBE FIELD CONSISTEIEPF TABLE SGPREFERE1
'Indica se deve consistir a inscrição estadual de clientes do tipo pessoa física.';

DESCRIBE FIELD CABTERMR01 TABLE SGPREFERE2
'Cabeçalho 1 do termo de recebimento.';

DESCRIBE FIELD CABTERMR02 TABLE SGPREFERE2
'Cabeçalho 2 do termo de recebimento.';

DESCRIBE FIELD RODTERMR TABLE SGPREFERE2
'Rodapé do termo de recebimento.';

DESCRIBE FIELD CODATIVCE TABLE SGPREFERE3
'Código da atividade padrão para envio de campanha.';

DESCRIBE FIELD CODATIVTE TABLE SGPREFERE3
'Código da atividade padrão para envio de campanha frustrado.';

DESCRIBE FIELD CODEMPCL TABLE SGPREFERE4
'Código da empresa para cliente.';

DESCRIBE FIELD CODFILIALCL TABLE SGPREFERE4
'Código filial para cliente.';

DESCRIBE FIELD CODCLI TABLE SGPREFERE4
'Código do cliente padrão para venda.';

DESCRIBE FIELD CODEMPPD TABLE SGPREFERE4
'CODIGO DA EMPRESA DO PRODUTO PARA FRETE';

DESCRIBE FIELD CODFILIALPD TABLE SGPREFERE4
'CODIGO DA FILIAL DO PRODUTO PARA FRETE';

DESCRIBE FIELD CODPROD TABLE SGPREFERE4
'CODIGO DO PRODUTO PRA FRETE';

DESCRIBE FIELD ADICPDV TABLE SGPREFERE4
'flag que indica se mostra frete no fechamento da venda no PDV';

DESCRIBE FIELD APROVORC TABLE SGPREFERE4
'FLAG QUE PERMITE APROVAÇÃO DO ORÇAMENTO DA TELA DE CADASTRO DO ORÇAMENTO';

DESCRIBE FIELD DIASVENCORC TABLE SGPREFERE4
'DIAS PARA O VENCIMENTO DO ORÇAMENTO.';

DESCRIBE FIELD USABUSCAGENPROD TABLE SGPREFERE4
'indica se abilita o campo para fazer a busca generica de produtos';

DESCRIBE FIELD AUTOFECHAVENDA TABLE SGPREFERE4
'Flag indica se chama a tela de fecha venda automatico quando buscar orçamento.';

DESCRIBE FIELD USALOTEORC TABLE SGPREFERE4
'Flag que indica se usa lote na tela de orçamento.';

DESCRIBE FIELD HABRECEBER TABLE SGPREFERE4
'Habilita aba de receber no fechamento da venda de ECF.';

DESCRIBE FIELD MESESDESCCP TABLE SGPREFERE5
'Número de meses para descarte de análises de contra-prova.';

DESCRIBE FIELD CODTIPOMOV TABLE SGPREFERE5
'Código do tipo de movimento padrão para Ordem de produção.';

DESCRIBE FIELD CODEMPTM TABLE SGPREFERE5
'Código da empresa do tipo de movimento padrão para Ordem de Produção.';

DESCRIBE FIELD CODFILIALTM TABLE SGPREFERE5
'Código da filial do tipo de movimento padrão para Ordem de Produção.';

DESCRIBE FIELD SITRMAOP TABLE SGPREFERE5
'Situação da RMA gerada pela OP.
Pode ser:
''PE'' - Pendente
''AF'' - Aprovada 
''EF'' - Expedida ';

DESCRIBE FIELD IMGASSRESP TABLE SGPREFERE5
'Imagem da assinatura do responsável técnico.';

DESCRIBE FIELD BAIXARMAAPROV TABLE SGPREFERE5
'Indica se deve baixar o estoque de insumos em RMA''s aprovadas não expedidas.';

DESCRIBE FIELD RATAUTO TABLE SGPREFERE5
'Defini rateio automatico de itens de OP.';

DESCRIBE FIELD APAGARMAOP TABLE SGPREFERE5
'Indica se deve permitir a exclusão de RMAs geradas por outro usuário.
Regra se aplica apenas em RMA vinculadas a Ordens de produção.';

DESCRIBE FIELD NOMEEMP TABLE SGPREFERE6
'Nome da empresa para remessa.';

DESCRIBE FIELD NOMEEMPCNAB TABLE SGPREFERE6
'Nome da empresa para cnab.';

DESCRIBE FIELD SIGLATB TABLE SGTABELA
'Sigla da tabela.';

DESCRIBE FIELD CODTIPOAGD TABLE SGTIPOAGENDA
'Código do tipo de agendamento';

DESCRIBE FIELD REGIAOUF TABLE SGUF
'Região geográfica
N - Norte
NE - Nordeste
S - Sul
SE - Sudeste
CO - Centro Oeste';

DESCRIBE FIELD APROVCPSOLICITACAOUSU TABLE SGUSUARIO
'Indica o nível de aprovação do usuario para solicitação de compras.
ND : Nenhuma
CC : Mesmo Centro de Custo
TD : Todas';

DESCRIBE FIELD APROVRMAUSU TABLE SGUSUARIO
'Indica o nível de aprovação do usuario para RMA.
ND : Nenhuma
CC : Mesmo Centro de Custo
TD : Todas';

DESCRIBE FIELD ALTPARCVENDA TABLE SGUSUARIO
'FLAG INDICA DE PODE ALTERAR PARCELA DA VENDA';

DESCRIBE FIELD APROVRECEITA TABLE SGUSUARIO
'Permite que o usuario aprove venda de produto com receita.';

DESCRIBE FIELD ATIVCLI TABLE SGUSUARIO
'Define se o usuário tem acesso para ativar clientes.';

DESCRIBE FIELD CODCAMP TABLE TKCAMPANHA
'Código da campanha.';

DESCRIBE FIELD DESCCAMP TABLE TKCAMPANHA
'Descrição da campanha.';

DESCRIBE FIELD OBSCAMP TABLE TKCAMPANHA
'Observações relativas à campanha.';

DESCRIBE FIELD CODCAMP TABLE TKCAMPANHACTO
'Código da campanha.';

DESCRIBE FIELD CODCTO TABLE TKCAMPANHACTO
'Código do contato.';

DESCRIBE FIELD CODORIGCONT TABLE TKCONTATO
'Código da origem do contato.';

DESCRIBE FIELD FORMATO TABLE TKEMAIL
'text/plain ou text/html';

DESCRIBE FIELD CHARSET TABLE TKEMAIL
'Formato da pagina de códigos.';

DESCRIBE FIELD TIPOHISTTK TABLE TKHISTORICO
'Tipo de histórico: 
''H'' - Histórico 
''V'' - Visita ao cliente
''N'' - Visita a novos clientes(não cadastrados)
''I'' - Visitas não identificadas
''C'' - Campanha';

DESCRIBE FIELD CODEMPCA TABLE TKHISTORICO
'Código da empresa da campanha.';

DESCRIBE FIELD CODFILIALCA TABLE TKHISTORICO
'Código da filial da campanha.';

DESCRIBE FIELD CODCAMP TABLE TKHISTORICO
'Código da campanha.';

DESCRIBE FIELD SEQSITCAMP TABLE TKHISTORICO
'Sequencia da situação da campanha (para fk com tksitcamp)';

DESCRIBE FIELD SIGLACLASCLI TABLE VDCLASCLI
'Sigla ou abreviação da descrição da classificação do cliente (utilizado em alguns relatórios)';

DESCRIBE FIELD NOMEAUTP TABLE VDCLIAUTP
'Nome da pessoa autorizada a comprar em nome do cliente.';

DESCRIBE FIELD ENDAUTP TABLE VDCLIAUTP
'Endereco da pessoa autorizada a comprar em nome do cliente.';

DESCRIBE FIELD NUMAUTP TABLE VDCLIAUTP
'Número do endereço da pessoa autorizada a comprar em nome do cliente.';

DESCRIBE FIELD COMPLAUTP TABLE VDCLIAUTP
'Complemento do endereço da pessoa autorizada a comprar em nome do cliente.';

DESCRIBE FIELD CARGOTRABCLI TABLE VDCLICOMPL
'Cargo ocupado pelo cliente.';

DESCRIBE FIELD DTADMTRABCLI TABLE VDCLICOMPL
'Data de admissão do cliente.';

DESCRIBE FIELD DDDTRABCLI TABLE VDCLICOMPL
'DDD do local de trabalho do cliente.';

DESCRIBE FIELD FONETRABCLI TABLE VDCLICOMPL
'Telefone do local de trabalho do cliente.';

DESCRIBE FIELD ENDTRABCLI TABLE VDCLICOMPL
'Endereço do trabalho do cliente.';

DESCRIBE FIELD NUMTRABCLI TABLE VDCLICOMPL
'Número do logradouro do trabalho do cliente.';

DESCRIBE FIELD BAIRTRABCLI TABLE VDCLICOMPL
'Bairro do trabalho do cliente.';

DESCRIBE FIELD CIDTRABCLI TABLE VDCLICOMPL
'Cidade do trabalho do cliente.';

DESCRIBE FIELD UFTRABCLI TABLE VDCLICOMPL
'Estado (UF) do trabalho do cliente.';

DESCRIBE FIELD OUTRENDACLI TABLE VDCLICOMPL
'Outras rendas do cliente.';

DESCRIBE FIELD FONTRENDACLI TABLE VDCLICOMPL
'Fonte das outras rendas do cliente.';

DESCRIBE FIELD NOMECONJCLI TABLE VDCLICOMPL
'Nome do conjuge do cliente.';

DESCRIBE FIELD DTNASCCONJCLI TABLE VDCLICOMPL
'Data de nascimento do conjuge do cliente.';

DESCRIBE FIELD RENDACONJCLI TABLE VDCLICOMPL
'Renda do conjuge do cliente.';

DESCRIBE FIELD COMPLTRABCLI TABLE VDCLICOMPL
'Complemento de endereco do trabalho do cliente.';

DESCRIBE FIELD CEPTRABCLI TABLE VDCLICOMPL
'Cep do trabalho do cliente.';

DESCRIBE FIELD RAMALTRABCLI TABLE VDCLICOMPL
'Ramal do trabalho do cliente.';

DESCRIBE FIELD RGCONJCLI TABLE VDCLICOMPL
'RG do conjuge.';

DESCRIBE FIELD SSPCONJCLI TABLE VDCLICOMPL
'Orgao de espedicao do RG do conjuge.';

DESCRIBE FIELD CPFCONJCLI TABLE VDCLICOMPL
'CPF do conjuge.';

DESCRIBE FIELD NATCONJCLI TABLE VDCLICOMPL
'Naturalidade do conjuge.';

DESCRIBE FIELD UFNATCONJCLI TABLE VDCLICOMPL
'Estado de onde e natural o conjuge.';

DESCRIBE FIELD CARGOCONJCLI TABLE VDCLICOMPL
'Cargo do conjuge.';

DESCRIBE FIELD EMPTRABCONJCLI TABLE VDCLICOMPL
'Empresa onde trabalha o conjuge.';

DESCRIBE FIELD DTADMTRABCONJCLI TABLE VDCLICOMPL
'Data de admissao do conjuge.';

DESCRIBE FIELD NOMEAVALCLI TABLE VDCLICOMPL
'Nome do avalista.';

DESCRIBE FIELD DTNASCAVALCLI TABLE VDCLICOMPL
'Data de nascimento do avalista do cliente.';

DESCRIBE FIELD RGAVALCLI TABLE VDCLICOMPL
'Rg do avalista.';

DESCRIBE FIELD SSPAVALCLI TABLE VDCLICOMPL
'Orgao de espedicao do Rg do avalista.';

DESCRIBE FIELD CPFAVALCLI TABLE VDCLICOMPL
'CPF do avalista do cliente.';

DESCRIBE FIELD ENDAVALCLI TABLE VDCLICOMPL
'Endereco do avalista do cliente.';

DESCRIBE FIELD NUMAVALCLI TABLE VDCLICOMPL
'Numero no endereco do avalista do cliente.';

DESCRIBE FIELD BAIRAVALCLI TABLE VDCLICOMPL
'Bairro do avalista do cliente.';

DESCRIBE FIELD CIDVALCLI TABLE VDCLICOMPL
'Cidade do avalista do cliente.';

DESCRIBE FIELD CEPAVALCLI TABLE VDCLICOMPL
'Cep do avalista do cliente.';

DESCRIBE FIELD UFAVALCLI TABLE VDCLICOMPL
'Estado do avalista do cliente.';

DESCRIBE FIELD DDDAVALCLI TABLE VDCLICOMPL
'DDD do telefone do avalista do cliente.';

DESCRIBE FIELD FONEAVALCLI TABLE VDCLICOMPL
'Fone do avalista do cliente.';

DESCRIBE FIELD EMPTRABAVALCLI TABLE VDCLICOMPL
'Empresa onde trabalha o avalista do cliente.';

DESCRIBE FIELD DTADMTRABAVALCLI TABLE VDCLICOMPL
'Data de admissao do avalista do cliente.';

DESCRIBE FIELD CARGOAVALCLI TABLE VDCLICOMPL
'Cargo do avalista do cliente.';

DESCRIBE FIELD CODEMPEC TABLE VDCLIENTE
'Código da empresa para tabela de estado civil.';

DESCRIBE FIELD CODFILIALEC TABLE VDCLIENTE
'Código da filial para tabela de estado civil.';

DESCRIBE FIELD CODTBEC TABLE VDCLIENTE
'Código da tabela de estado civil.';

DESCRIBE FIELD CODITTBEC TABLE VDCLIENTE
'Código do estado civil.';

DESCRIBE FIELD CODEMPCB TABLE VDCLIENTE
'Código da empresa na tabela FNCARTCOB.';

DESCRIBE FIELD CODFILIALCB TABLE VDCLIENTE
'Código da filial na tabela FNCARTCOB.';

DESCRIBE FIELD CODCARTCOB TABLE VDCLIENTE
'Código da carteira de cobrança.';

DESCRIBE FIELD SSPCLI TABLE VDCLIENTE
'Orgão de espedição do RG.';

DESCRIBE FIELD DTINITR TABLE VDCLIENTE
'Data de abertura do crédito';

DESCRIBE FIELD CELCLI TABLE VDCLIENTE
'Número do Celular
';

DESCRIBE FIELD NATCLI TABLE VDCLIENTE
'Naturalidade do cliente';

DESCRIBE FIELD UFNATCLI TABLE VDCLIENTE
'UF ref. a naturalizade.';

DESCRIBE FIELD TEMPORESCLI TABLE VDCLIENTE
'Tempo de residência do cliente';

DESCRIBE FIELD APELIDOCLI TABLE VDCLIENTE
'Apelido do cliente.';

DESCRIBE FIELD SITECLI TABLE VDCLIENTE
'Endereço eletrônico do site do cliente.';

DESCRIBE FIELD CODCONTDEB TABLE VDCLIENTE
'Código contabil de debito.';

DESCRIBE FIELD CODCONTCRED TABLE VDCLIENTE
'Código contabil de credito';

DESCRIBE FIELD CODCLICONTAB TABLE VDCLIENTE
'Código contabil';

DESCRIBE FIELD FOTOCLI TABLE VDCLIENTE
'Foto do cliente.';

DESCRIBE FIELD IMGASSCLI TABLE VDCLIENTE
'Imagem da assinatura do cliente';

DESCRIBE FIELD CODMUNIC TABLE VDCLIENTE
'Código do municipio (IBGE)';

DESCRIBE FIELD SIGLAUF TABLE VDCLIENTE
'Sigla da Unidade da Federeção (Estado)';

DESCRIBE FIELD CODPAIS TABLE VDCLIENTE
'Código do pais.';

DESCRIBE FIELD CODMUNICENT TABLE VDCLIENTE
'Código do municipio (IBGE) do endereço de entrega.';

DESCRIBE FIELD SIGLAUFENT TABLE VDCLIENTE
'Sigla da Unidade da Federação do endereço de entrega.';

DESCRIBE FIELD CODPAISENT TABLE VDCLIENTE
'Código do país do endereço de entrega.';

DESCRIBE FIELD CODMUNICCOB TABLE VDCLIENTE
'Código do municipio (IBGE) do endereço de cobrança.';

DESCRIBE FIELD SIGLAUFCOB TABLE VDCLIENTE
'Sigla da Unidade da Federação do endereço de cobrança.';

DESCRIBE FIELD CODPAISCOB TABLE VDCLIENTE
'Código do país do endereço de cobrança.';

DESCRIBE FIELD CODCPCLIFOR TABLE VDCLIENTEFOR
'Código complementar ou da campanha que o cliente participa  junto ao fornecedor.';

DESCRIBE FIELD TIPOIMOV TABLE VDCLIIMOV
'Tipo de imovel.';

DESCRIBE FIELD CONSTRIMOV TABLE VDCLIIMOV
'Tipo de construcao no imovel';

DESCRIBE FIELD AREATERIMOV TABLE VDCLIIMOV
'Area do terrano do imovel.';

DESCRIBE FIELD VALORIMOV TABLE VDCLIIMOV
'Valor do imovel.';

DESCRIBE FIELD ANOMETAVEND TABLE VDCLIMETAVEND
'Ano para a meta de vendas';

DESCRIBE FIELD VLRMETAVEND TABLE VDCLIMETAVEND
'Valor de meta para vendas.';

DESCRIBE FIELD OBSMETAVEND TABLE VDCLIMETAVEND
'Observações referentes a meta de vendas para um determinado ano.';

DESCRIBE FIELD NOMEEMPREFC TABLE VDCLIREFC
'Nome da empresa.';

DESCRIBE FIELD DDDREFC TABLE VDCLIREFC
'DDD da referencia comercial.';

DESCRIBE FIELD FONEREFC TABLE VDCLIREFC
'Fone da referencia comercial.';

DESCRIBE FIELD DTMAIORCP TABLE VDCLIREFC
'Data da maior compra do cliente na referencia comercial.';

DESCRIBE FIELD VLRMAIORCP TABLE VDCLIREFC
'Valor da maior compra do cliente na referencia comercial.';

DESCRIBE FIELD NROPARCMAIORCP TABLE VDCLIREFC
'Numero de parcelas da maior compra do cliente na referencia comercial.';

DESCRIBE FIELD DTULTCP TABLE VDCLIREFC
'Data da ultima compra do cliente na referencia comercial.';

DESCRIBE FIELD VLRULTCP TABLE VDCLIREFC
'Valor da ultima compra do cliente na referencia comercial.';

DESCRIBE FIELD NROPARCULTCP TABLE VDCLIREFC
'Nro de parcelas da ultima compra do cliente na referencia comercial.';

DESCRIBE FIELD DTPRIMCP TABLE VDCLIREFC
'Data da primeira compra do cliente na referencia comercial.';

DESCRIBE FIELD PONTUAL TABLE VDCLIREFC
'Flag que indica se o cliente é pontual na referencia comercial. (S ou N)';

DESCRIBE FIELD MEDIAATRASO TABLE VDCLIREFC
'Média de atraso do cliente na referencia comercial.';

DESCRIBE FIELD CONCEITO TABLE VDCLIREFC
'Conceito do cliente junto à referencia comercial.';

DESCRIBE FIELD AVALISTA TABLE VDCLIREFC
'Flag que indica se a empresa é avalista do cliente.';

DESCRIBE FIELD INFORMANTE TABLE VDCLIREFC
'Nome do informante na empresa.';

DESCRIBE FIELD OBSREFC TABLE VDCLIREFC
'Observações.';

DESCRIBE FIELD CODEMP TABLE VDCLIREFP
'Codigo da empresa.';

DESCRIBE FIELD CODFILIAL TABLE VDCLIREFP
'Codigo da filial.';

DESCRIBE FIELD CODCLI TABLE VDCLIREFP
'Codigo do cliente.';

DESCRIBE FIELD NOMEREFP TABLE VDCLIREFP
'Nome da referência pessoal.';

DESCRIBE FIELD ENDREFP TABLE VDCLIREFP
'Endereco.';

DESCRIBE FIELD NUMREFP TABLE VDCLIREFP
'Numero.';

DESCRIBE FIELD COMPLREFP TABLE VDCLIREFP
'Complemento do endereço.';

DESCRIBE FIELD BAIRREFP TABLE VDCLIREFP
'Bairro.';

DESCRIBE FIELD CIDREFP TABLE VDCLIREFP
'Cidade.';

DESCRIBE FIELD UFREFP TABLE VDCLIREFP
'Estado.';

DESCRIBE FIELD CEPREFP TABLE VDCLIREFP
'Cep.';

DESCRIBE FIELD DDDREFP TABLE VDCLIREFP
'DDD.';

DESCRIBE FIELD FONEREFP TABLE VDCLIREFP
'Fone.';

DESCRIBE FIELD CODREFP TABLE VDCLIREFP
'Codigo da referencia.';

DESCRIBE FIELD ENDTERRA TABLE VDCLITERRA
'Endereço da terra.';

DESCRIBE FIELD PLACAVEIC TABLE VDCLIVEIC
'Placa do veículo.';

DESCRIBE FIELD MODELOVEIC TABLE VDCLIVEIC
'Modelo do veículo.';

DESCRIBE FIELD ALIENADOVEIC TABLE VDCLIVEIC
'Indica se o veículo está alienado.';

DESCRIBE FIELD ANOVEIC TABLE VDCLIVEIC
'Ano de fabricação.';

DESCRIBE FIELD VALORVEIC TABLE VDCLIVEIC
'Valor do veículo.';

DESCRIBE FIELD TIPOCOMI TABLE VDCOMISSAO
'Tipo de comissão:
F-Valor gerado no faturamento
R-Valor gerado no recebimento
';

DESCRIBE FIELD STATUSCOMI TABLE VDCOMISSAO
'Situação da comissão:
C1 - Em aberto
C2 - Liberada
CP - Paga';

DESCRIBE FIELD CODEMPVD TABLE VDCOMISSAO
'Código da empresa do vendedor.';

DESCRIBE FIELD CODFILIALVD TABLE VDCOMISSAO
'Código da filial do vendedor.';

DESCRIBE FIELD CODVEND TABLE VDCOMISSAO
'Código do vendedor.';

DESCRIBE FIELD CODCONTR TABLE VDCONTRATO
'Código do contrato.';

DESCRIBE FIELD DESCCONTR TABLE VDCONTRATO
'Descrição do contrato.';

DESCRIBE FIELD MINUTACONTR TABLE VDCONTRATO
'Minuta do contrato.';

DESCRIBE FIELD CODEMPCL TABLE VDCONTRATO
'Código da empresa do cliente';

DESCRIBE FIELD CODFILIALCL TABLE VDCONTRATO
'Código da filial do cliente.';

DESCRIBE FIELD CODCLI TABLE VDCONTRATO
'Código do cliente.';

DESCRIBE FIELD DTINICIO TABLE VDCONTRATO
'Data de inicio de vigor do contrato.';

DESCRIBE FIELD DTFIM TABLE VDCONTRATO
'Data do fim do contrato.';

DESCRIBE FIELD TPCOBCONTR TABLE VDCONTRATO
'Tipo de cobrança do contrato:
''ME'' - Mensal
''BI'' - Bimestral
''AN'' - Anual
''ES'' - Esporádico ';

DESCRIBE FIELD DIAVENCCONTR TABLE VDCONTRATO
'Dia de vencimento da cobrança.';

DESCRIBE FIELD DIAFECHCONTR TABLE VDCONTRATO
'Dia do mes para fechamento das cobranças.';

DESCRIBE FIELD ADICFRETEVD TABLE VDFRETEVD
'FLAG QUE INDICA SE ADICIONA O VALOR DO FRETE NA NOTA';

DESCRIBE FIELD ADICFRETEBASEICM TABLE VDFRETEVD
'Indica se deve adicionar o valor do frete na base de calculo do icms da venda.';

DESCRIBE FIELD ALIQICMSFRETEVD TABLE VDFRETEVD
'Aliquota de icms incidente no frete.';

DESCRIBE FIELD CODEMPPD TABLE VDITCONTRATO
'Código da empresa do produto.';

DESCRIBE FIELD CODFILIALPD TABLE VDITCONTRATO
'Código da filial do produto.';

DESCRIBE FIELD CODPROD TABLE VDITCONTRATO
'Código do produto.';

DESCRIBE FIELD QTDITCONTR TABLE VDITCONTRATO
'Quantidade do produto no ítem de contrato.';

DESCRIBE FIELD VLRITCONTR TABLE VDITCONTRATO
'Valor contratado para o produto.';

DESCRIBE FIELD VLRITCONTREXCED TABLE VDITCONTRATO
'Valor cobrado por excedente à quantidade contratada.';

DESCRIBE FIELD CODEMPAX TABLE VDITORCAMENTO
'Código da empresa na tabela de almoxarifados.';

DESCRIBE FIELD CODFILIALAX TABLE VDITORCAMENTO
'Código da filial na tabela de almoxarifados.';

DESCRIBE FIELD CODALMOX TABLE VDITORCAMENTO
'Código do almoxarifado.';

DESCRIBE FIELD CODEMPPE TABLE VDITORCAMENTO
'Código da empresa do prazo de entrega.';

DESCRIBE FIELD CODFILIALPE TABLE VDITORCAMENTO
'Código da filial do prazo de entrega.';

DESCRIBE FIELD CODPE TABLE VDITORCAMENTO
'Código do prazo de entrega.';

DESCRIBE FIELD DIASPE TABLE VDITORCAMENTO
'Prazo de entrega (em dias) no ítem.';

DESCRIBE FIELD EMMANUT TABLE VDITORCAMENTO
'Flag para por a tabela em manutençao (S/N).';

DESCRIBE FIELD SITENTITORC TABLE VDITORCAMENTO
'Situação da entrega 
N - Não entregue
E - Entregue
';

DESCRIBE FIELD SITTERMRITORC TABLE VDITORCAMENTO
'Situação do termo de recebimento.
E - Emitir
N - Não emitir
O - Emitido';

DESCRIBE FIELD CODEMPAX TABLE VDITVENDA
'Código da empresa na tabela de almoxarifados.';

DESCRIBE FIELD CODFILIALAX TABLE VDITVENDA
'Código da filial na tabela de almoxarifados.';

DESCRIBE FIELD CODALMOX TABLE VDITVENDA
'Código do almoxarifado.';

DESCRIBE FIELD EMMANUT TABLE VDITVENDA
'Flag para manutenção da tabela (S/N).';

DESCRIBE FIELD CANCITVENDA TABLE VDITVENDA
'Flag para marcar se o item foi cancelado.';

DESCRIBE FIELD CODEMPPE TABLE VDITVENDA
'Código da empresa do prazo de entrega.';

DESCRIBE FIELD CODFILIALPE TABLE VDITVENDA
'Código da filial do prazo de entrega.';

DESCRIBE FIELD CODPE TABLE VDITVENDA
'Código do prazo de entrega.';

DESCRIBE FIELD DIASPE TABLE VDITVENDA
'Prazo de entrega (em dias) no ítem.';

DESCRIBE FIELD CODCONV TABLE VDITVENDA
'Código do conveniado';

DESCRIBE FIELD EMMANUT TABLE VDORCAMENTO
'Flag para por a tabela em manutençao (S/N).';

DESCRIBE FIELD CODCLCOMIS TABLE VDORCAMENTO
'CODIGO DA CLASSIFICAÇÃO DA COMISSÃO';

DESCRIBE FIELD CODEMP TABLE VDPRAZOENT
'Código da empresa.';

DESCRIBE FIELD CODFILIAL TABLE VDPRAZOENT
'Código da filial';

DESCRIBE FIELD CODPE TABLE VDPRAZOENT
'Cód. prazo de entrega.';

DESCRIBE FIELD DESCPE TABLE VDPRAZOENT
'Descrição do prazo de entrega';

DESCRIBE FIELD DIASPE TABLE VDPRAZOENT
'Número de dias para entrega.';

DESCRIBE FIELD CHEQTIPOCLI TABLE VDTIPOCLI
'Flag que indica se haverá aba adicional no cadastro de clientes (cheque).';

DESCRIBE FIELD FISTIPOCLI TABLE VDTIPOCLI
'Flag que indica se haverá aba adicional no cadastro de clientes (pessoa física).';

DESCRIBE FIELD JURTIPOCLI TABLE VDTIPOCLI
'Flag que indica se haverá aba adicional no cadastro de clientes (pessoa jurídica).';

DESCRIBE FIELD FILTIPOCLI TABLE VDTIPOCLI
'Flag que indica se haverá aba adicional no cadastro de clientes (Filiação).';

DESCRIBE FIELD LOCTRABTIPOCLI TABLE VDTIPOCLI
'Flag que indica se haverá aba adicional no cadastro de clientes (local de trabalho).';

DESCRIBE FIELD REFCOMLTIPOCLI TABLE VDTIPOCLI
'Flag que indica se haverá aba adicional no cadastro de clientes (Referências comerciais).';

DESCRIBE FIELD BANCTIPOCLI TABLE VDTIPOCLI
'Flag que indica se haverá aba adicional no cadastro de clientes (Dados bancários).';

DESCRIBE FIELD REFPESTIPOCLI TABLE VDTIPOCLI
'Flag que indica se haverá aba adicional no cadastro de clientes (referências pessoais).';

DESCRIBE FIELD CONJTIPOCLI TABLE VDTIPOCLI
'Flag que indica se haverá aba adicional no cadastro de clientes (dados do cônjuge jurídica).';

DESCRIBE FIELD VEICTIPOCLI TABLE VDTIPOCLI
'Flag que indica se haverá aba adicional no cadastro de clientes (veículos).';

DESCRIBE FIELD IMOVTIPOCLI TABLE VDTIPOCLI
'Flag que indica se haverá aba adicional no cadastro de clientes (imóveis).';

DESCRIBE FIELD TERRATIPOCLI TABLE VDTIPOCLI
'Flag que indica se haverá aba adicional no cadastro de clientes (terras).';

DESCRIBE FIELD PESAUTCPTIPOCLI TABLE VDTIPOCLI
'Flag para dados complementares (pessoa autorizada a comprar).';

DESCRIBE FIELD AVALTIPOCLI TABLE VDTIPOCLI
'Flag para dados complementares (avalista).';

DESCRIBE FIELD SOCIOTIPOCLI TABLE VDTIPOCLI
'Flag para dados complementares (sócios).';

DESCRIBE FIELD SIGLATIPOCLI TABLE VDTIPOCLI
'Sigla ou abreviação da descrição do tipo de cliente (utilizado em alguns relatórios)';

DESCRIBE FIELD CPFTRAN TABLE VDTRANSP
'CPF do transportador';

DESCRIBE FIELD DDDFONETRAN TABLE VDTRANSP
'DDD do telefone principal.';

DESCRIBE FIELD DDDFAXTRAN TABLE VDTRANSP
'DDD do Fax.';

DESCRIBE FIELD DDDCELTRAN TABLE VDTRANSP
'DDD do celular da transportadora.';

DESCRIBE FIELD CALCICMSVENDA TABLE VDVENDA
'Indica se deve calcular o valor do ICMS na nota.';

DESCRIBE FIELD IMPICMSVENDA TABLE VDVENDA
'Indica se deve imprimir o valor do ICMS na nota.';

DESCRIBE FIELD CALCIPIVENDA TABLE VDVENDA
'Indica se deve calcular o valor do IPI na nota.';

DESCRIBE FIELD IMPIPIVENDA TABLE VDVENDA
'Indica se deve imprimir o valor do IPI na nota.';

DESCRIBE FIELD CALCISSVENDA TABLE VDVENDA
'Indica se deve calcular o valor do ISS na nota.';

DESCRIBE FIELD IMPIISSVENDA TABLE VDVENDA
'Indica se deve imprimir o valor do ISS na nota.';

DESCRIBE FIELD CALCPISVENDA TABLE VDVENDA
'Indica se deve calcular o valor do PIS na nota.';

DESCRIBE FIELD IMPPISVENDA TABLE VDVENDA
'Indica se deve imprimir o valor do PIS na nota.';

DESCRIBE FIELD CALCCOFINSVENDA TABLE VDVENDA
'Indica se deve calcular o valor do COFINS na nota.';

DESCRIBE FIELD IMPCOFINSVENDA TABLE VDVENDA
'Indica se deve imprimir o valor do COFINS na nota.';

DESCRIBE FIELD CALCIRVENDA TABLE VDVENDA
'Indica se deve calcular o valor do IR na nota.';

DESCRIBE FIELD IMPIRVENDA TABLE VDVENDA
'Indica se deve imprimir o valor do IR na nota.';

DESCRIBE FIELD CALCCSOCIALVENDA TABLE VDVENDA
'Indica se deve calcular o valor da CONTRIBUICAO SOCIAL na nota.';

DESCRIBE FIELD IMPCSOCIALVENDA TABLE VDVENDA
'Indica se deve imprimir o valor da CONTRIBUICAO SOCIAL na nota.';

DESCRIBE FIELD CODEMPCB TABLE VDVENDA
'Código da empresa na tabela FNCARTCOB.';

DESCRIBE FIELD CODFILIALCB TABLE VDVENDA
'Código da filial na tabela FNCARTCOB.';

DESCRIBE FIELD CODCARTCOB TABLE VDVENDA
'Código da carteira de cobrança.';

DESCRIBE FIELD PEDCLIVENDA TABLE VDVENDA
'Número do pedido do cliente.';

DESCRIBE FIELD EMMANUT TABLE VDVENDA
'Flag que indica se a tabela está em manutenção (S/N).';

DESCRIBE FIELD TIPOVENDA TABLE VDVENDACOMIS
'Tipo de venda
O = Orçamento
V = Venda
E = Vencda Ecf
';

DESCRIBE FIELD CODFORNVEND TABLE VDVENDEDOR
'CODIGO DO VENDEDOR NO FORNECEDOR
';

DESCRIBE FIELD CODFUNC TABLE VDVENDEDOR
'Funcao/Cargo do comissionado.';

DESCRIBE FIELD CODEMPFU TABLE VDVENDEDOR
'Código da empresa da funcao/cargo do vendedor.';

DESCRIBE FIELD CODFILIALFU TABLE VDVENDEDOR
'Código da filial da funcao do comissionado.';

DESCRIBE FIELD DDDFONEVEND TABLE VDVENDEDOR
'DDD do telefone do vendedor.';

DESCRIBE FIELD DDDFAXVEND TABLE VDVENDEDOR
'DDD do fax do vendedor.';

DESCRIBE FIELD DDDCELVEND TABLE VDVENDEDOR
'DDD do celular do vendedor.';

DESCRIBE FIELD SSPVEND TABLE VDVENDEDOR
'Orgão de emissão do RG do vendedor.';

DESCRIBE FIELD OBSVEND TABLE VDVENDEDOR
'Observações do vendedor.';

DESCRIBE FIELD ATIVOCOMIS TABLE VDVENDEDOR
'Indica se o comissionado esta ativo.';



/* Parameters descriptions */

DESCRIBE PARAMETER ICODFUNC PROCEDURE RHLISTACANDVAGASP
'Código da função';

DESCRIBE PARAMETER ICODVAGA PROCEDURE RHLISTACANDVAGASP
'Código da vaga';

DESCRIBE PARAMETER IQTDITVENDA PROCEDURE VDADICITVENDAORCSP
'Quantidade do ítem de venda.';

DESCRIBE PARAMETER TPAGRUP PROCEDURE VDADICITVENDAORCSP
'Indica se deve gerar item de venda para o ítem de orçamento. (Usado em caso de agrupamento de ítens de orçamento).';

DESCRIBE PARAMETER VLRDESCITVENDA PROCEDURE VDADICITVENDAORCSP
'Valor do desconto';

