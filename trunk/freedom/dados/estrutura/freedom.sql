/*  External Function declarations */
DECLARE EXTERNAL FUNCTION "ABS"
DOUBLE PRECISION
RETURNS DOUBLE PRECISION BY VALUE 
ENTRY_POINT 'IB_UDF_abs' MODULE_NAME 'ib_udf';

DECLARE EXTERNAL FUNCTION "ACOS"
DOUBLE PRECISION
RETURNS DOUBLE PRECISION BY VALUE 
ENTRY_POINT 'IB_UDF_acos' MODULE_NAME 'ib_udf';

DECLARE EXTERNAL FUNCTION ADDDAY
TIMESTAMP, INTEGER
RETURNS TIMESTAMP 
ENTRY_POINT 'addDay' MODULE_NAME 'fbudf';

DECLARE EXTERNAL FUNCTION ADDHOUR
TIMESTAMP, INTEGER
RETURNS TIMESTAMP 
ENTRY_POINT 'addHour' MODULE_NAME 'fbudf';

DECLARE EXTERNAL FUNCTION ADDMILLISECOND
TIMESTAMP, INTEGER
RETURNS TIMESTAMP 
ENTRY_POINT 'addMilliSecond' MODULE_NAME 'fbudf';

DECLARE EXTERNAL FUNCTION ADDMINUTE
TIMESTAMP, INTEGER
RETURNS TIMESTAMP 
ENTRY_POINT 'addMinute' MODULE_NAME 'fbudf';

DECLARE EXTERNAL FUNCTION ADDMONTH
TIMESTAMP, INTEGER
RETURNS TIMESTAMP 
ENTRY_POINT 'addMonth' MODULE_NAME 'fbudf';

DECLARE EXTERNAL FUNCTION ADDSECOND
TIMESTAMP, INTEGER
RETURNS TIMESTAMP 
ENTRY_POINT 'addSecond' MODULE_NAME 'fbudf';

DECLARE EXTERNAL FUNCTION ADDWEEK
TIMESTAMP, INTEGER
RETURNS TIMESTAMP 
ENTRY_POINT 'addWeek' MODULE_NAME 'fbudf';

DECLARE EXTERNAL FUNCTION ADDYEAR
TIMESTAMP, INTEGER
RETURNS TIMESTAMP 
ENTRY_POINT 'addYear' MODULE_NAME 'fbudf';

DECLARE EXTERNAL FUNCTION "ASCII_CHAR"
INTEGER
RETURNS CSTRING(1) FREE_IT
ENTRY_POINT 'IB_UDF_ascii_char' MODULE_NAME 'ib_udf';

DECLARE EXTERNAL FUNCTION "ASCII_VAL"
CHAR(1)
RETURNS INTEGER BY VALUE 
ENTRY_POINT 'IB_UDF_ascii_val' MODULE_NAME 'ib_udf';

DECLARE EXTERNAL FUNCTION "ASIN"
DOUBLE PRECISION
RETURNS DOUBLE PRECISION BY VALUE 
ENTRY_POINT 'IB_UDF_asin' MODULE_NAME 'ib_udf';

DECLARE EXTERNAL FUNCTION "ATAN"
DOUBLE PRECISION
RETURNS DOUBLE PRECISION BY VALUE 
ENTRY_POINT 'IB_UDF_atan' MODULE_NAME 'ib_udf';

DECLARE EXTERNAL FUNCTION "ATAN2"
DOUBLE PRECISION, DOUBLE PRECISION
RETURNS DOUBLE PRECISION BY VALUE 
ENTRY_POINT 'IB_UDF_atan2' MODULE_NAME 'ib_udf';

DECLARE EXTERNAL FUNCTION "BIN_AND"
INTEGER, INTEGER
RETURNS INTEGER BY VALUE 
ENTRY_POINT 'IB_UDF_bin_and' MODULE_NAME 'ib_udf';

DECLARE EXTERNAL FUNCTION "BIN_OR"
INTEGER, INTEGER
RETURNS INTEGER BY VALUE 
ENTRY_POINT 'IB_UDF_bin_or' MODULE_NAME 'ib_udf';

DECLARE EXTERNAL FUNCTION "BIN_XOR"
INTEGER, INTEGER
RETURNS INTEGER BY VALUE 
ENTRY_POINT 'IB_UDF_bin_xor' MODULE_NAME 'ib_udf';

DECLARE EXTERNAL FUNCTION "CEILING"
DOUBLE PRECISION
RETURNS DOUBLE PRECISION BY VALUE 
ENTRY_POINT 'IB_UDF_ceiling' MODULE_NAME 'ib_udf';

DECLARE EXTERNAL FUNCTION "COS"
DOUBLE PRECISION
RETURNS DOUBLE PRECISION BY VALUE 
ENTRY_POINT 'IB_UDF_cos' MODULE_NAME 'ib_udf';

DECLARE EXTERNAL FUNCTION "COSH"
DOUBLE PRECISION
RETURNS DOUBLE PRECISION BY VALUE 
ENTRY_POINT 'IB_UDF_cosh' MODULE_NAME 'ib_udf';

DECLARE EXTERNAL FUNCTION "COT"
DOUBLE PRECISION
RETURNS DOUBLE PRECISION BY VALUE 
ENTRY_POINT 'IB_UDF_cot' MODULE_NAME 'ib_udf';

DECLARE EXTERNAL FUNCTION DIV
INTEGER, INTEGER
RETURNS DOUBLE PRECISION BY VALUE 
ENTRY_POINT 'IB_UDF_div' MODULE_NAME 'ib_udf';

DECLARE EXTERNAL FUNCTION DNULLIF
DOUBLE PRECISION BY DESCRIPTOR, DOUBLE PRECISION BY DESCRIPTOR
RETURNS DOUBLE PRECISION BY DESCRIPTOR 
ENTRY_POINT 'dNullIf' MODULE_NAME 'fbudf';

DECLARE EXTERNAL FUNCTION DNVL
DOUBLE PRECISION BY DESCRIPTOR, DOUBLE PRECISION BY DESCRIPTOR
RETURNS DOUBLE PRECISION BY DESCRIPTOR 
ENTRY_POINT 'idNvl' MODULE_NAME 'fbudf';

DECLARE EXTERNAL FUNCTION DOW
TIMESTAMP, VARCHAR(15)
RETURNS PARAMETER 2
ENTRY_POINT 'DOW' MODULE_NAME 'fbudf';

DECLARE EXTERNAL FUNCTION DPOWER
DOUBLE PRECISION BY DESCRIPTOR, DOUBLE PRECISION BY DESCRIPTOR, DOUBLE PRECISION BY DESCRIPTOR
RETURNS PARAMETER 3
ENTRY_POINT 'power' MODULE_NAME 'fbudf';

DECLARE EXTERNAL FUNCTION "FLOOR"
DOUBLE PRECISION
RETURNS DOUBLE PRECISION BY VALUE 
ENTRY_POINT 'IB_UDF_floor' MODULE_NAME 'ib_udf';

DECLARE EXTERNAL FUNCTION GETEXACTTIMESTAMP
TIMESTAMP
RETURNS PARAMETER 1
ENTRY_POINT 'getExactTimestamp' MODULE_NAME 'fbudf';

DECLARE EXTERNAL FUNCTION I64NULLIF
NUMERIC(18, 4) BY DESCRIPTOR, NUMERIC(18, 4) BY DESCRIPTOR
RETURNS NUMERIC(18, 4) BY DESCRIPTOR 
ENTRY_POINT 'iNullIf' MODULE_NAME 'fbudf';

DECLARE EXTERNAL FUNCTION I64NVL
NUMERIC(18, 0) BY DESCRIPTOR, NUMERIC(18, 0) BY DESCRIPTOR
RETURNS NUMERIC(18, 0) BY DESCRIPTOR 
ENTRY_POINT 'idNvl' MODULE_NAME 'fbudf';

DECLARE EXTERNAL FUNCTION I64ROUND
NUMERIC(18, 4) BY DESCRIPTOR, NUMERIC(18, 4) BY DESCRIPTOR
RETURNS PARAMETER 2
ENTRY_POINT 'fbround' MODULE_NAME 'fbudf';

DECLARE EXTERNAL FUNCTION I64TRUNCATE
NUMERIC(18, 0) BY DESCRIPTOR, NUMERIC(18, 0) BY DESCRIPTOR
RETURNS PARAMETER 2
ENTRY_POINT 'fbtruncate' MODULE_NAME 'fbudf';

DECLARE EXTERNAL FUNCTION INULLIF
INTEGER BY DESCRIPTOR, INTEGER BY DESCRIPTOR
RETURNS INTEGER BY DESCRIPTOR 
ENTRY_POINT 'iNullIf' MODULE_NAME 'fbudf';

DECLARE EXTERNAL FUNCTION INVL
INTEGER BY DESCRIPTOR, INTEGER BY DESCRIPTOR
RETURNS INTEGER BY DESCRIPTOR 
ENTRY_POINT 'idNvl' MODULE_NAME 'fbudf';

DECLARE EXTERNAL FUNCTION "LN"
DOUBLE PRECISION
RETURNS DOUBLE PRECISION BY VALUE 
ENTRY_POINT 'IB_UDF_ln' MODULE_NAME 'ib_udf';

DECLARE EXTERNAL FUNCTION "LOG"
DOUBLE PRECISION, DOUBLE PRECISION
RETURNS DOUBLE PRECISION BY VALUE 
ENTRY_POINT 'IB_UDF_log' MODULE_NAME 'ib_udf';

DECLARE EXTERNAL FUNCTION "LOG10"
DOUBLE PRECISION
RETURNS DOUBLE PRECISION BY VALUE 
ENTRY_POINT 'IB_UDF_log10' MODULE_NAME 'ib_udf';

DECLARE EXTERNAL FUNCTION "LOWER"
CSTRING(255)
RETURNS CSTRING(255) FREE_IT
ENTRY_POINT 'IB_UDF_lower' MODULE_NAME 'ib_udf';

DECLARE EXTERNAL FUNCTION LTRIM
CSTRING(255)
RETURNS CSTRING(255) FREE_IT
ENTRY_POINT 'IB_UDF_ltrim' MODULE_NAME 'ib_udf';

DECLARE EXTERNAL FUNCTION "MOD"
INTEGER, INTEGER
RETURNS DOUBLE PRECISION BY VALUE 
ENTRY_POINT 'IB_UDF_mod' MODULE_NAME 'ib_udf';

DECLARE EXTERNAL FUNCTION "PI"

RETURNS DOUBLE PRECISION BY VALUE 
ENTRY_POINT 'IB_UDF_pi' MODULE_NAME 'ib_udf';

DECLARE EXTERNAL FUNCTION "RAND"

RETURNS DOUBLE PRECISION BY VALUE 
ENTRY_POINT 'IB_UDF_rand' MODULE_NAME 'ib_udf';

DECLARE EXTERNAL FUNCTION "ROUND"
INTEGER BY DESCRIPTOR, INTEGER BY DESCRIPTOR
RETURNS PARAMETER 2
ENTRY_POINT 'fbround' MODULE_NAME 'fbudf';

DECLARE EXTERNAL FUNCTION RTRIM
CSTRING(255)
RETURNS CSTRING(255) FREE_IT
ENTRY_POINT 'IB_UDF_rtrim' MODULE_NAME 'ib_udf';

DECLARE EXTERNAL FUNCTION SDOW
TIMESTAMP, VARCHAR(5)
RETURNS PARAMETER 2
ENTRY_POINT 'SDOW' MODULE_NAME 'fbudf';

DECLARE EXTERNAL FUNCTION "SIGN"
DOUBLE PRECISION
RETURNS INTEGER BY VALUE 
ENTRY_POINT 'IB_UDF_sign' MODULE_NAME 'ib_udf';

DECLARE EXTERNAL FUNCTION "SIN"
DOUBLE PRECISION
RETURNS DOUBLE PRECISION BY VALUE 
ENTRY_POINT 'IB_UDF_sin' MODULE_NAME 'ib_udf';

DECLARE EXTERNAL FUNCTION "SINH"
DOUBLE PRECISION
RETURNS DOUBLE PRECISION BY VALUE 
ENTRY_POINT 'IB_UDF_sinh' MODULE_NAME 'ib_udf';

DECLARE EXTERNAL FUNCTION "SQRT"
DOUBLE PRECISION
RETURNS DOUBLE PRECISION BY VALUE 
ENTRY_POINT 'IB_UDF_sqrt' MODULE_NAME 'ib_udf';

DECLARE EXTERNAL FUNCTION STRLEN
CSTRING(32767)
RETURNS INTEGER BY VALUE 
ENTRY_POINT 'IB_UDF_strlen' MODULE_NAME 'ib_udf';

DECLARE EXTERNAL FUNCTION SUBSTR
CSTRING(255), SMALLINT, SMALLINT
RETURNS CSTRING(255) FREE_IT
ENTRY_POINT 'IB_UDF_substr' MODULE_NAME 'ib_udf';

DECLARE EXTERNAL FUNCTION "TAN"
DOUBLE PRECISION
RETURNS DOUBLE PRECISION BY VALUE 
ENTRY_POINT 'IB_UDF_tan' MODULE_NAME 'ib_udf';

DECLARE EXTERNAL FUNCTION "TANH"
DOUBLE PRECISION
RETURNS DOUBLE PRECISION BY VALUE 
ENTRY_POINT 'IB_UDF_tanh' MODULE_NAME 'ib_udf';

DECLARE EXTERNAL FUNCTION TRUNCATE
INTEGER BY DESCRIPTOR, INTEGER BY DESCRIPTOR
RETURNS PARAMETER 2
ENTRY_POINT 'fbtruncate' MODULE_NAME 'fbudf';


/*  Generators or sequences */
CREATE GENERATOR EQEXPEDAMOSTRAGEMINC;
CREATE GENERATOR EQRECAMOSTRAGEMINC;
CREATE GENERATOR GEN_SGDEBUG_ID;
CREATE GENERATOR SGOBJETOINC;

/* Domain definitions */
CREATE DOMAIN CHARBIGDLEDN AS CHAR(200) NOT NULL;
CREATE DOMAIN CHARMIDDLEDN AS CHAR(50);
CREATE DOMAIN CHARSMALLDN AS CHAR(30);
CREATE DOMAIN NEW_DOMAIN AS INTEGER;
CREATE DOMAIN NUMERICDN AS NUMERIC(15, 5);
CREATE DOMAIN NUMERICDN2 AS NUMERIC(15, 9);
CREATE DOMAIN TIMEDN AS TIME;

/* Table: GTT_RECURSIVO, Owner: SYSDBA */
CREATE GLOBAL TEMPORARY TABLE GTT_RECURSIVO (ID BIGINT NOT NULL,
        CONTA INTEGER DEFAULT 0 NOT NULL,
CONSTRAINT PK_GTT_RECURSIVO PRIMARY KEY (ID))
ON COMMIT DELETE ROWS;

/* Table: ATAGENDA, Owner: SYSDBA */
CREATE TABLE ATAGENDA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODAG INTEGER NOT NULL,
        CODEMPSA INTEGER NOT NULL,
        CODFILIALSA SMALLINT NOT NULL,
        CODSETAT INTEGER NOT NULL,
        DTACADAG DATE DEFAULT 'today' NOT NULL,
        HORACATAG TIME DEFAULT 'now' NOT NULL,
        DTAAG DATE DEFAULT 'today' NOT NULL,
        HORAAG TIME DEFAULT 'now' NOT NULL,
        DESCAGENDA CHAR(50) NOT NULL,
        CODEMPAE INTEGER,
        CODFILIALAE SMALLINT,
        CODATEND INTEGER,
        DTAATENDAG DATE,
        HORAATENDAG TIME,
        OBSAGENDA VARCHAR(10000),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER);

/* Table: ATATENDENTE, Owner: SYSDBA */
CREATE TABLE ATATENDENTE (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODATEND INTEGER NOT NULL,
        NOMEATEND CHAR(50) NOT NULL,
        CODEMPTA INTEGER NOT NULL,
        CODFILIALTA SMALLINT NOT NULL,
        CODTPATEND INTEGER NOT NULL,
        RGATEND CHAR(13),
        ENDATEND CHAR(50),
        BAIRATEND CHAR(30),
        CIDATEND CHAR(30),
        CEPATEND CHAR(8),
        FONEATEND CHAR(12),
        FAXATEND VARCHAR(9),
        EMAILATEND CHAR(60),
        NUMATEND INTEGER,
        UFATEND CHAR(2),
        CELATEND VARCHAR(9),
        IDENTIFICATEND CHAR(18),
        CODEMPUS INTEGER,
        CODFILIALUS INTEGER,
        IDUSU CHAR(8),
        CPFATEND CHAR(11),
        CODVEND INTEGER,
        CODEMPVE INTEGER,
        CODFILIALVE INTEGER,
        CODEMPEP INTEGER,
        CODFILIALEP SMALLINT,
        MATEMPR INTEGER,
        METAATEND NUMERIC(15, 5) DEFAULT 0 NOT NULL,
        PARTPREMIATEND CHAR(1) DEFAULT 'N' NOT NULL,
        ACESATDOLEROUT CHAR(1) DEFAULT 'S' NOT NULL,
        ACESATDOALTOUT CHAR(1) DEFAULT 'S' NOT NULL,
        ACESATDODELLAN CHAR(1) DEFAULT 'S' NOT NULL,
        ACESATDODELOUT CHAR(1) DEFAULT 'S' NOT NULL,
        ACESRELESTOUT CHAR(1) DEFAULT 'S' NOT NULL,
        ACESTROCOMIS CHAR(1) DEFAULT 'S' NOT NULL,
        ACESTROCOMISOUT CHAR(1) DEFAULT 'S' NOT NULL,
        ACESCHAMLEROUT CHAR(1) DEFAULT 'S' NOT NULL,
        ACESCHAMALTOUT CHAR(1) DEFAULT 'S' NOT NULL,
        ACESCHAMDELLAN CHAR(1) DEFAULT 'S' NOT NULL,
        ACESCHAMALTPRO CHAR(1) DEFAULT 'S' NOT NULL,
        ACESCHAMDELOUT CHAR(1) DEFAULT 'S' NOT NULL,
        ACESCHAMFINPRO CHAR(1) DEFAULT 'S' NOT NULL,
        ACESCHAMFINOUT CHAR(1) DEFAULT 'S' NOT NULL, 
        DTINS DATE DEFAULT 'now',
        IDUSUINS CHAR(8) DEFAULT USER,
        DTALT DATE DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
        HINS TIME DEFAULT 'now',
        HALT TIME DEFAULT 'now',
CONSTRAINT ATATENDENTEPK PRIMARY KEY (CODATEND, CODFILIAL, CODEMP));

/* Table: ATATENDIMENTO, Owner: SYSDBA */
CREATE TABLE ATATENDIMENTO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODATENDO INTEGER NOT NULL,
        CODCONV INTEGER,
        CODEMPCV INTEGER,
        CODFILIALCV INTEGER,
        CODEMPTO INTEGER NOT NULL,
        CODFILIALTO SMALLINT NOT NULL,
        CODTPATENDO INTEGER NOT NULL,
        CODEMPAE INTEGER NOT NULL,
        CODFILIALAE SMALLINT NOT NULL,
        CODATEND INTEGER NOT NULL,
        CODEMPSA INTEGER NOT NULL,
        CODFILIALSA INTEGER NOT NULL,
        CODSETAT INTEGER NOT NULL,
        DATAATENDO DATE DEFAULT 'today' NOT NULL,
        HORAATENDO TIME DEFAULT 'now' NOT NULL,
        DATAATENDOFIN DATE DEFAULT 'today' NOT NULL,
        HORAATENDOFIN TIME DEFAULT 'now' NOT NULL,
        OBSATENDO VARCHAR(10000),
        OBSINTERNO VARCHAR(10000),
        STATUSATENDO CHAR(2) NOT NULL,
        SITREVATENDO CHAR(2) DEFAULT 'PE' NOT NULL,
        CODEMPCL INTEGER,
        CODFILIALCL SMALLINT,
        CODCLI INTEGER,
        IDUSU CHAR(8) NOT NULL,
        CODEMPUS INTEGER NOT NULL,
        CODFILIALUS INTEGER NOT NULL,
        DOCATENDO INTEGER NOT NULL,
        CODEMPCT INTEGER,
        CODFILIALCT SMALLINT,
        CODCONTR INTEGER,
        CODITCONTR SMALLINT,
        CODEMPTA INTEGER,
        CODFILIALTA SMALLINT,
        CODTAREFA INTEGER,
        CODEMPCA INTEGER,
        CODFILIALCA SMALLINT,
        CODCLASATENDO INTEGER,
        CODEMPCH INTEGER,
        CODFILIALCH SMALLINT,
        CODCHAMADO INTEGER,
        CONCLUICHAMADO CHAR(1) DEFAULT 'N' NOT NULL,
        CODEMPEA INTEGER,
        CODFILIALEA SMALLINT,
        CODESPEC INTEGER,
        SITATENDO CHAR(2),
        EMMANUT CHAR(1) DEFAULT 'N' NOT NULL,
        BLOQATENDO CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT ATATENDIMENTOPK PRIMARY KEY (CODATENDO, CODFILIAL, CODEMP));

/* Table: ATATENDIMENTOITREC, Owner: SYSDBA */
CREATE TABLE ATATENDIMENTOITREC (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODATENDO INTEGER NOT NULL,
        CODEMPIR INTEGER NOT NULL,
        CODFILIALIR SMALLINT NOT NULL,
        CODREC INTEGER NOT NULL,
        NPARCITREC INTEGER NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT ATATENDITRECPK PRIMARY KEY (CODATENDO, CODFILIAL, CODEMP, CODREC, NPARCITREC, CODFILIALIR, CODEMPIR));

/* Table: ATATENDIMENTOORC, Owner: SYSDBA */
CREATE TABLE ATATENDIMENTOORC (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODATENDO INTEGER NOT NULL,
        CODEMPOC INTEGER NOT NULL,
        CODFILIALOC SMALLINT NOT NULL,
        TIPOORC CHAR(1) NOT NULL,
        CODORC INTEGER NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT ATATENDIMENTOORCPK PRIMARY KEY (CODATENDO, CODFILIAL, CODEMP, CODORC, TIPOORC, CODFILIALOC, CODEMPOC));

/* Table: ATATENDOAGENDA, Owner: SYSDBA */
CREATE TABLE ATATENDOAGENDA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODATENDO INTEGER NOT NULL,
        CODEMPAG INTEGER NOT NULL,
        CODFILIALAG SMALLINT NOT NULL,
        TIPOAGE CHAR(5) NOT NULL,
        CODAGE INTEGER NOT NULL,
        CODAGD INTEGER NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT ATATENDOAGENDAPK PRIMARY KEY (CODATENDO, CODEMP, CODFILIAL, CODAGE, TIPOAGE, CODAGD, CODFILIALAG, CODEMPAG));

/* Table: ATATRIBUICAO, Owner: SYSDBA */
CREATE TABLE ATATRIBUICAO (CODEMP INTEGER NOT NULL,
        CODFILIAL INTEGER NOT NULL,
        CODATRIB CHAR(15) NOT NULL,
        DESCATRIB CHAR(50) NOT NULL,
        OBSATRIB VARCHAR(10000),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT ATATRIBUICAOPK PRIMARY KEY (CODATRIB, CODFILIAL, CODEMP));

/* Table: ATCLASATENDO, Owner: SYSDBA */
CREATE TABLE ATCLASATENDO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCLASATENDO INTEGER NOT NULL,
        DESCCLASATENDO CHAR(50) NOT NULL,
        GERACOB CHAR(1) default 'S' NOT NULL,
        GERAREL CHAR(1) DEFAULT 'S' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT ATCLASATENDPK PRIMARY KEY (CODCLASATENDO, CODFILIAL, CODEMP));

/* Table: ATCONVATRIB, Owner: SYSDBA */
CREATE TABLE ATCONVATRIB (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCONV INTEGER NOT NULL,
        SEQCONVATRIB SMALLINT NOT NULL,
        CODEMPAB INTEGER NOT NULL,
        CODFILIALAB SMALLINT NOT NULL,
        CODATRIB CHAR(15) NOT NULL,
        OBSCONVATRIB VARCHAR(10000),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT ATCONVATRIBPK PRIMARY KEY (CODCONV, SEQCONVATRIB, CODFILIAL, CODEMP));

/* Table: ATCONVATRIBTB, Owner: SYSDBA */
CREATE TABLE ATCONVATRIBTB (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCONV INTEGER NOT NULL,
        SEQCONVATRIB SMALLINT NOT NULL,
        CODEMPTB INTEGER NOT NULL,
        CODFILIALTB SMALLINT NOT NULL,
        CODTB SMALLINT NOT NULL,
        CODITTB INTEGER NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT ATCONVATRIBTB PRIMARY KEY (CODITTB, CODTB, CODFILIALTB, CODEMPTB, SEQCONVATRIB, CODCONV, CODFILIAL, CODEMP));

/* Table: ATCONVENIADO, Owner: SYSDBA */
CREATE TABLE ATCONVENIADO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCONV INTEGER NOT NULL,
        NOMECONV CHAR(50) NOT NULL,
        CODEMPTC INTEGER NOT NULL,
        CODFILIALTC SMALLINT NOT NULL,
        CODTPCONV INTEGER NOT NULL,
        DTNASCCONV DATE NOT NULL,
        CODEMPAE INTEGER,
        CODFILIALAE SMALLINT,
        CODATEND INTEGER,
        CODEMPGI INTEGER,
        CODFILIALGI SMALLINT,
        CODGRI INTEGER,
        RGCONV CHAR(13),
        CPFCONV CHAR(11),
        ENDCONV CHAR(50),
        NUMCONV INTEGER,
        BAIRCONV CHAR(30),
        CIDCONV CHAR(30),
        CEPCONV CHAR(8),
        FONECONV CHAR(12),
        FAXCONV VARCHAR(9),
        EMAILCONV CHAR(60),
        PAICONV CHAR(50),
        MAECONV CHAR(50),
        RGPAICONV CHAR(13),
        RGMAECONV CHAR(13),
        CNSCONV CHAR(15),
        CODEMPCL INTEGER,
        CODFILIALCL INTEGER,
        CODCLI INTEGER,
        UFCONV CHAR(2),
        CELCONV CHAR(9),
        SEXOCONV CHAR(1),
        IDENTIFICCONV CHAR(20),
        COMPLCONV CHAR(20),
        CODEMPEC INTEGER,
        CODFILIALEC SMALLINT,
        CODENC INTEGER,
        CODEMPFC INTEGER,
        CODFILIALFC SMALLINT,
        CODFUNC INTEGER,
        ICARDCONV CHAR(15),
        NRVIACONV SMALLINT,
        DDDCONV CHAR(4),
        DDDFAXCONV CHAR(4),
        DDDCELCONV CHAR(4),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT 'now',
CONSTRAINT ATCONVENIADOPK PRIMARY KEY (CODCONV, CODFILIAL, CODEMP));

/* Table: ATENCAMINHADOR, Owner: SYSDBA */
CREATE TABLE ATENCAMINHADOR (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODENC INTEGER NOT NULL,
        NOMEENC CHAR(50) NOT NULL,
        ENDENC CHAR(50),
        NUMENC INTEGER,
        COMPLENC CHAR(30),
        CIDENC CHAR(30),
        BAIRENC CHAR(30),
        UFENC CHAR(2),
        CEPENC CHAR(8),
        FONEENC CHAR(12),
        FAXENC VARCHAR(9),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT ATENCAMINHADORPK PRIMARY KEY (CODENC, CODFILIAL, CODEMP));

/* Table: ATESPECATEND, Owner: SYSDBA */
CREATE TABLE ATESPECATEND (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODESPEC INTEGER NOT NULL,
        DESCESPEC VARCHAR(100) NOT NULL,
        PGCOMIESPEC CHAR(1) DEFAULT 'S' NOT NULL,
        COBCLIESPEC CHAR(1) DEFAULT 'S' NOT NULL,
        CONTMETAESPEC CHAR(1) DEFAULT 'S' NOT NULL,
        TEMPOMINCOBESPEC INTEGER DEFAULT 0 NOT NULL,
        TEMPOMAXCOBESPEC INTEGER DEFAULT 0 NOT NULL,
        PERCCOMIESPEC NUMERIC(15, 5) DEFAULT 0 NOT NULL,
        MRELCOBESPEC CHAR(1) DEFAULT 'S' NOT NULL,
        BHESPEC CHAR(1) DEFAULT 'S' NOT NULL,
        OBRIGCHAMESPEC CHAR(1) DEFAULT 'N' NOT NULL,
        OBRIGPROJESPEC CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now' NOT NULL,
        IDUSUALT VARCHAR(128) DEFAULT USER NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
CONSTRAINT ATESPECATENDPK PRIMARY KEY (CODESPEC, CODFILIAL, CODEMP));

/* Table: ATMODATENDO, Owner: SYSDBA */
CREATE TABLE ATMODATENDO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODMODEL INTEGER NOT NULL,
        DESCMODEL VARCHAR(100) NOT NULL,
        CODCONV INTEGER,
        CODEMPCV INTEGER,
        CODFILIALCV INTEGER,
        CODEMPTO INTEGER,
        CODFILIALTO SMALLINT,
        CODTPATENDO INTEGER,
        CODEMPSA INTEGER,
        CODFILIALSA INTEGER,
        CODSETAT INTEGER,
        OBSATENDO VARCHAR(10000),
        OBSINTERNO VARCHAR(10000),
        STATUSATENDO CHAR(2),
        CODEMPCL INTEGER,
        CODFILIALCL SMALLINT,
        CODCLI INTEGER,
        CODEMPCT INTEGER,
        CODFILIALCT SMALLINT,
        CODCONTR INTEGER,
        CODITCONTR SMALLINT,
        CODEMPCA INTEGER,
        CODFILIALCA SMALLINT,
        CODCLASATENDO INTEGER,
        CODEMPCH INTEGER,
        CODFILIALCH SMALLINT,
        CODCHAMADO INTEGER,
        CODEMPEA INTEGER,
        CODFILIALEA SMALLINT,
        CODESPEC INTEGER,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT ATMODATENDOPK PRIMARY KEY (CODMODEL, CODFILIAL, CODEMP));

/* Table: ATSETOR, Owner: SYSDBA */
CREATE TABLE ATSETOR (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODSETAT INTEGER NOT NULL,
        DESCSETAT CHAR(50) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT ATSETORPK PRIMARY KEY (CODSETAT, CODFILIAL, CODEMP));

/* Table: ATSETORATENDENTE, Owner: SYSDBA */
CREATE TABLE ATSETORATENDENTE (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODSETAT INTEGER NOT NULL,
        CODEMPAE INTEGER NOT NULL,
        CODFILIALAE SMALLINT NOT NULL,
        CODATEND INTEGER NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT ATSETORATENDENTEPK PRIMARY KEY (CODSETAT, CODFILIAL, CODEMP, CODATEND, CODFILIALAE, CODEMPAE));

/* Table: ATTIPOATEND, Owner: SYSDBA */
CREATE TABLE ATTIPOATEND (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTPATEND INTEGER NOT NULL,
        DESCTPATEND CHAR(50) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT ATTIPOATENDPK PRIMARY KEY (CODTPATEND, CODFILIAL, CODEMP));

/* Table: ATTIPOATENDO, Owner: SYSDBA */
CREATE TABLE ATTIPOATENDO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTPATENDO INTEGER NOT NULL,
        DESCTPATENDO CHAR(50) NOT NULL,
        TIPOATENDO CHAR(1) DEFAULT 'A' NOT NULL,
        CODEMPFX INTEGER,
        CODFILIALFX SMALLINT,
        CODFLUXO INTEGER,
        ATIVOATENDO CHAR(1) DEFAULT 'S' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT ATTIPOATENDOPK PRIMARY KEY (CODTPATENDO, CODFILIAL, CODEMP));

/* Table: ATTIPOATENDOSETOR, Owner: SYSDBA */
CREATE TABLE ATTIPOATENDOSETOR (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTPATENDO INTEGER NOT NULL,
        CODEMPST INTEGER NOT NULL,
        CODFILIALST SMALLINT NOT NULL,
        CODSETAT INTEGER NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT ATTIPOATENDOSETOPK PRIMARY KEY (CODSETAT, CODFILIALST, CODEMPST, CODTPATENDO, CODFILIAL, CODEMP));

/* Table: ATTIPOCONV, Owner: SYSDBA */
CREATE TABLE ATTIPOCONV (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTPCONV INTEGER NOT NULL,
        DESCTPCONV CHAR(50) NOT NULL,
        CLASSTPCONV CHAR(20),
        CODAUXTPCONV CHAR(20) DEFAULT ' ' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT ATTIPOCONVPK PRIMARY KEY (CODTPCONV, CODFILIAL, CODEMP));

/* Table: CBCONTAEXT, Owner: SYSDBA */
CREATE TABLE CBCONTAEXT (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCONTABIL VARCHAR(30) NOT NULL,
        DESCCONTABIL VARCHAR(100) NOT NULL,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT CBCONTAEXTPK PRIMARY KEY (CODCONTABIL, CODEMP, CODFILIAL));

/* Table: CPCOMPRA, Owner: SYSDBA */
CREATE TABLE CPCOMPRA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCOMPRA INTEGER NOT NULL,
        CODEMPPG INTEGER NOT NULL,
        CODFILIALPG SMALLINT NOT NULL,
        CODPLANOPAG INTEGER NOT NULL,
        CODEMPFR INTEGER NOT NULL,
        CODFILIALFR SMALLINT NOT NULL,
        CODFOR INTEGER NOT NULL,
        CODEMPSE INTEGER NOT NULL,
        CODFILIALSE SMALLINT NOT NULL,
        SERIE CHAR(4) NOT NULL,
        CODEMPTM INTEGER NOT NULL,
        CODFILIALTM SMALLINT NOT NULL,
        CODTIPOMOV INTEGER NOT NULL,
        DOCCOMPRA INTEGER NOT NULL,
        DTENTCOMPRA DATE NOT NULL,
        DTEMITCOMPRA DATE NOT NULL,
        DTCOMPCOMPRA DATE NOT NULL,
        PERCDESCCOMPRA NUMERICDN,
        PERCIPICOMPRA NUMERIC(6, 2),
        VLRPRODCOMPRA NUMERICDN,
        VLRLIQCOMPRA NUMERICDN,
        VLRCOMPRA NUMERICDN,
        VLRDESCCOMPRA NUMERICDN,
        VLRDESCITCOMPRA NUMERICDN,
        VLRADICCOMPRA NUMERICDN,
        VLRBASEICMSCOMPRA NUMERICDN,
        VLRBASEICMSSTCOMPRA NUMERICDN   DEFAULT 0,
        VLRBASEIPICOMPRA NUMERICDN,
        VLRBASEPISCOMPRA NUMERICDN,
        VLRBASECOFINSCOMPRA NUMERICDN,
        VLRICMSCOMPRA NUMERICDN,
        VLRICMSSTCOMPRA NUMERICDN   DEFAULT 0,
        VLRIPICOMPRA NUMERICDN,
        VLRPISCOMPRA NUMERICDN,
        VLRCOFINSCOMPRA NUMERICDN,
        VLRFUNRURALCOMPRA NUMERICDN,
        VLRFRETECOMPRA NUMERICDN,
        VLROUTRASCOMPRA NUMERICDN,
        VLRISENTASCOMPRA NUMERICDN,
        CODEMPTC INTEGER,
        CODFILIALTC SMALLINT,
        CODTIPOCOB INTEGER,
        CODEMPBO INTEGER,
        CODFILIALBO SMALLINT,
        CODBANCO CHAR(3),
        IMPNOTACOMPRA CHAR(1) DEFAULT 'N' NOT NULL,
        BLOQCOMPRA CHAR(1) DEFAULT 'N' NOT NULL,
        EMMANUT CHAR(1) DEFAULT 'N' NOT NULL,
        FLAG CHAR(1) DEFAULT 'N',
        ADICFRETECOMPRA CHAR(1) DEFAULT 'N' NOT NULL,
        TIPOFRETECOMPRA CHAR(1),
        CODEMPSOL INTEGER,
        CODFILIALSOL SMALLINT,
        CODSOL INTEGER,
        CODEMPTN INTEGER,
        CODFILIALTN SMALLINT,
        CODTRAN INTEGER,
        OBSERVACAO VARCHAR(10000),
        OBS01 VARCHAR(1024),
        OBS02 VARCHAR(1024),
        OBS03 VARCHAR(1024),
        OBS04 VARCHAR(1024),
        ADICADICCOMPRA CHAR(1) DEFAULT 'N' NOT NULL,
        QTDFRETECOMPRA NUMERICDN,
        ADICFRETEBASEICMS CHAR(1),
        ADICADICBASEICMS CHAR(1),
        ADICIPIBASEICMS CHAR(1),
        CHAVENFECOMPRA CHAR(44),
        STATUSCOMPRA CHAR(2) NOT NULL,
        NRODI CHAR(10),
        DTREGDI DATE,
        LOCDESEMBDI CHAR(60),
        SIGLAUFDESEMBDI CHAR(2),
        CODPAISDESEMBDI INTEGER,
        DTDESEMBDI DATE,
        IDENTCONTAINER CHAR(20),
        CALCTRIB CHAR(1) DEFAULT 'N' NOT NULL,
        CODEMPRM INTEGER,
        CODFILIALRM SMALLINT,
        TICKET INTEGER,
        CODEMPCT INTEGER,
        CODFILIALCT SMALLINT,
        NUMCONTA CHAR(10),
        CODEMPCC INTEGER,
        CODFILIALCC SMALLINT,
        ANOCC SMALLINT,
        CODCC CHAR(19),
        CODEMPPN INTEGER,
        CODFILIALPN SMALLINT,
        CODPLAN CHAR(13),
        INFCOMPL VARCHAR(10000),
        NUMACDRAW VARCHAR(20),
        TIPODOCIMP CHAR(1),
        SITDOC CHAR(2),
        OBSNFE VARCHAR(10000),
        CODEMPOP INTEGER,
        CODFILIALOP SMALLINT,
        CODOP INTEGER,
        SEQOP SMALLINT,
        CODEMPIM INTEGER,
        CODFILIALIM SMALLINT,
        CODIMP INTEGER,
        VLRBASEIICOMPRA NUMERICDN,
        VLRIICOMPRA NUMERICDN,
        VLRICMSDIFERIDO NUMERICDN,
        VLRICMSDEVIDO NUMERICDN,
        VLRICMSCREDPRESUM NUMERICDN,
        OBSPAG VARCHAR(250),
        CODEMPOC INTEGER,
        CODFILIALOC SMALLINT,
        CODORDCP INTEGER,
        VLRISSCOMPRA NUMERICDN,
        NROORDEMCOMPRA VARCHAR(20),
        VLROUTRASDESP NUMERICDN,
        CNF BIGINT DEFAULT 0,
        CHAVENFEVALIDA VARCHAR(20) DEFAULT 'N' NOT NULL,
        MOTIVOCANCCOMPRA VARCHAR(255),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT CPCOMPRAPK PRIMARY KEY (CODCOMPRA, CODFILIAL, CODEMP));

/* Table: CPCOMPRALCCHAVE, Owner: SYSDBA */
CREATE TABLE CPCOMPRALCCHAVE (ID BIGINT NOT NULL,
        CODEMP INTEGER NOT NULL,
        CODFILIAL INTEGER NOT NULL,
        CODCOMPRA INTEGER NOT NULL,
        DTCONSULTA DATE NOT NULL,
        HCONSULTA TIME NOT NULL,
        CODRETORNO INTEGER NOT NULL,
        MENSAGEM VARCHAR(2000) NOT NULL,
        CHAVEVALIDA CHAR(1) DEFAULT 'N' NOT NULL,
        CHAVENFE VARCHAR(100) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT VARCHAR(128) DEFAULT USER,
CONSTRAINT CPCOMPRALCCHAVEPK PRIMARY KEY (ID));

/* Table: CPCOMPRAPED, Owner: SYSDBA */
CREATE TABLE CPCOMPRAPED (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCOMPRA INTEGER NOT NULL,
        CODITCOMPRA INTEGER NOT NULL,
        CODEMPPC INTEGER NOT NULL,
        CODFILIALPC SMALLINT NOT NULL,
        CODCOMPRAPC INTEGER NOT NULL,
        CODITCOMPRAPC INTEGER NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT CPCOMPRAPEDPK PRIMARY KEY (CODCOMPRA, CODITCOMPRA, CODFILIAL, CODEMP, CODCOMPRAPC, CODITCOMPRAPC, CODFILIALPC, CODEMPPC));

/* Table: CPCOMPRASOL, Owner: SYSDBA */
CREATE TABLE CPCOMPRASOL (CODEMP INTEGER NOT NULL,
        CODFILIAL INTEGER NOT NULL,
        CODCOMPRA INTEGER NOT NULL,
        CODITCOMPRA INTEGER NOT NULL,
        CODEMPSL INTEGER NOT NULL,
        CODFILIALSL INTEGER NOT NULL,
        CODSOL INTEGER NOT NULL,
        CODITSOL INTEGER NOT NULL,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT CPCOMPRASOLPK PRIMARY KEY (CODCOMPRA, CODITCOMPRA, CODFILIAL, CODEMP, CODSOL, CODITSOL, CODFILIALSL, CODEMPSL));

/* Table: CPCOMPRAVENDA, Owner: SYSDBA */
CREATE TABLE CPCOMPRAVENDA (CODEMP INTEGER NOT NULL,
        CODFILIAL INTEGER NOT NULL,
        CODCOMPRA INTEGER NOT NULL,
        CODITCOMPRA INTEGER NOT NULL,
        CODEMPVD INTEGER NOT NULL,
        CODFILIALVD INTEGER NOT NULL,
        TIPOVENDA CHAR(1) NOT NULL,
        CODVENDA INTEGER NOT NULL,
        CODITVENDA INTEGER NOT NULL,
        QTDDEV NUMERICDN NOT NULL,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT CPCOMPRAVENDAPK PRIMARY KEY (CODITCOMPRA, CODCOMPRA, CODFILIAL, CODEMP));

/* Table: CPCOTACAO, Owner: SYSDBA */
CREATE TABLE CPCOTACAO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODSOL INTEGER NOT NULL,
        CODITSOL SMALLINT NOT NULL,
        CODCOT SMALLINT NOT NULL,
        DTCOT DATE DEFAULT 'now' NOT NULL,
        DTVALIDCOT DATE DEFAULT 'today' NOT NULL,
        IDUSUCOT CHAR(8) DEFAULT user NOT NULL,
        CODEMPFR INTEGER NOT NULL,
        CODFILIALFR SMALLINT NOT NULL,
        CODFOR INTEGER NOT NULL,
        QTDCOT NUMERICDN              DEFAULT 0 NOT NULL,
        QTDAPROVCOT NUMERICDN              DEFAULT 0 NOT NULL,
        PRECOCOT NUMERICDN              DEFAULT 0 NOT NULL,
        SITCOMPITSOL CHAR(2) DEFAULT 'PE',
        SITAPROVITSOL CHAR(2) DEFAULT 'PE',
        SITITSOL CHAR(2) DEFAULT 'PE',
        MOTIVOCANCCOT VARCHAR(10000),
        MOTIVOCOTABAIXO VARCHAR(10000),
        USARENDACOT CHAR(1),
        RENDACOT SMALLINT,
        IDUSUALT CHAR(8),
        VLRFRETEITCOMPRA NUMERIC(15, 5),
        PERCIPIITCOMPRA NUMERIC(9, 2),
        VLRBASEIPIITCOMPRA NUMERIC(15, 5),
        VLRIPIITCOMPRA NUMERIC(15, 5),
        VLRLIQITCOMPRA NUMERIC(15, 5),
        CODEMPPP INTEGER,
        CODFILIALPP SMALLINT,
        CODPLANOPAG INTEGER,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE,
        HALT TIME,
CONSTRAINT CPCOTACAOPK PRIMARY KEY (CODSOL, CODITSOL, CODCOT, CODFILIAL, CODEMP));

/* Table: CPDEVOLUCAO, Owner: SYSDBA */
CREATE TABLE CPDEVOLUCAO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCOMPRA INTEGER NOT NULL,
        CODITCOMPRA INTEGER NOT NULL,
        QTDDEV NUMERICDN NOT NULL,
        CODEMPVD INTEGER NOT NULL,
        CODFILIALVD SMALLINT NOT NULL,
        CODVENDA INTEGER NOT NULL,
        TIPOVENDA CHAR(2) NOT NULL,
        CODITVENDA INTEGER NOT NULL,
        IDUSUALT CHAR(8) DEFAULT USER,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
CONSTRAINT CPDEVOLUCAOPK PRIMARY KEY (CODITCOMPRA, CODCOMPRA, CODFILIAL, CODEMP, CODVENDA, CODITVENDA, TIPOVENDA, CODFILIALVD, CODEMPVD));

/* Table: CPEQUIVCFOP, Owner: SYSDBA */
CREATE TABLE CPEQUIVCFOP (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODNAT CHAR(4) NOT NULL,
        CODEMPND INTEGER NOT NULL,
        CODFILIALND SMALLINT NOT NULL,
        CODNATND CHAR(4) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT CPEQUIVCFOPPK PRIMARY KEY (CODNAT, CODFILIAL, CODEMP));

/* Table: CPFORNECED, Owner: SYSDBA */
CREATE TABLE CPFORNECED (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODFOR INTEGER NOT NULL,
        RAZFOR CHAR(60) NOT NULL,
        CODEMPTF INTEGER NOT NULL,
        CODFILIALTF SMALLINT NOT NULL,
        CODTIPOFOR INTEGER NOT NULL,
        CODEMPBO INTEGER,
        CODFILIALBO SMALLINT,
        CODBANCO CHAR(3),
        CODEMPHP INTEGER,
        CODFILIALHP SMALLINT,
        CODHIST INTEGER,
        NOMEFOR CHAR(50) NOT NULL,
        DATAFOR DATE DEFAULT 'today' NOT NULL,
        ATIVOFOR CHAR(1),
        PESSOAFOR CHAR(1) NOT NULL,
        CNPJFOR CHAR(14),
        CPFFOR CHAR(11),
        INSCFOR VARCHAR(20),
        RGFOR CHAR(13),
        ENDFOR CHAR(50),
        NUMFOR INTEGER,
        COMPLFOR CHAR(20),
        BAIRFOR CHAR(30),
        CEPFOR CHAR(8),
        CIDFOR CHAR(30),
        UFFOR CHAR(2),
        CONTFOR CHAR(40),
        FONEFOR CHAR(12),
        FAXFOR VARCHAR(9),
        AGENCIAFOR CHAR(6),
        CONTAFOR CHAR(10),
        EMAILFOR CHAR(50),
        OBSFOR VARCHAR(10000),
        CELFOR VARCHAR(9),
        CLIFOR CHAR(1) DEFAULT 'F',
        SSPFOR CHAR(10),
        DDDFONEFOR CHAR(4),
        DDDFAXFOR CHAR(4),
        DDDCELFOR CHAR(4),
        SITEFOR CHAR(50),
        CODCONTDEB VARCHAR(20),
        CODCONTCRED VARCHAR(20),
        CODFORCONTAB VARCHAR(20),
        CODMUNIC CHAR(7),
        SIGLAUF CHAR(2),
        CODPAIS SMALLINT,
        CODEMPUC INTEGER,
        CODFILIALUC SMALLINT,
        CODUNIFCOD INTEGER,
        CODEMPFF INTEGER,
        CODFILIALFF SMALLINT,
        CODFISCFOR INTEGER,
        SUFRAMAFOR VARCHAR(9),
        NRODEPENDFOR SMALLINT,
        INSCCONREG VARCHAR(15),
        CODEXPORTADOR VARCHAR(20),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT CPFORNECEDPK PRIMARY KEY (CODFOR, CODFILIAL, CODEMP));

/* Table: CPFRETECP, Owner: SYSDBA */
CREATE TABLE CPFRETECP (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCOMPRA INTEGER NOT NULL,
        CODEMPTN INTEGER,
        CODFILIALTN SMALLINT,
        CODTRAN INTEGER,
        TIPOFRETECP CHAR(1) NOT NULL,
        PLACAFRETECP CHAR(10) NOT NULL,
        UFFRETECP CHAR(2) NOT NULL,
        VLRFRETECP NUMERICDN NOT NULL,
        QTDFRETECP NUMERICDN NOT NULL,
        PESOBRUTCP NUMERICDN NOT NULL,
        PESOLIQCP NUMERICDN NOT NULL,
        ESPFRETECP CHAR(10) NOT NULL,
        MARCAFRETECP CHAR(10) NOT NULL,
        CONHECFRETECP CHAR(13),
        PERCCOMPRAFRETECP NUMERIC(9, 2),
        ADICFRETECP CHAR(1) DEFAULT 'N' NOT NULL,
        ADICFRETEBASEICM CHAR(1) DEFAULT 'N' NOT NULL,
        ALIQICMSFRETECP NUMERICDN,
        VLRICMSFRETECP NUMERICDN,
        VLRSEGFRETECP NUMERICDN,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT CPFRETECPPK PRIMARY KEY (CODCOMPRA, CODFILIAL, CODEMP));

/* Table: CPHOMOLOGFOR, Owner: SYSDBA */
CREATE TABLE CPHOMOLOGFOR (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODFOR INTEGER NOT NULL,
        ISHFOR CHAR(1) DEFAULT 'S' NOT NULL,
        DTHFOR DATE DEFAULT 'now' NOT NULL,
        OBSHFOR VARCHAR(2000) DEFAULT '' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT VARCHAR(128) DEFAULT USER,
CONSTRAINT CPHOMOLOGFORPK PRIMARY KEY (CODFOR, CODFILIAL, CODEMP));

/* Table: CPIMPORTACAO, Owner: SYSDBA */
CREATE TABLE CPIMPORTACAO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODIMP INTEGER NOT NULL,
        CODEMPMI INTEGER NOT NULL,
        CODFILIALMI SMALLINT NOT NULL,
        CODMOEDA CHAR(4) NOT NULL,
        COTACAOMOEDA NUMERICDN NOT NULL,
        CODEMPPG INTEGER NOT NULL,
        CODFILIALPG SMALLINT NOT NULL,
        CODPLANOPAG INTEGER NOT NULL,
        CODEMPFR INTEGER NOT NULL,
        CODFILIALFR SMALLINT NOT NULL,
        CODFOR INTEGER NOT NULL,
        CODEMPOI INTEGER,
        CODFILIALOI SMALLINT,
        CODIMPOI INTEGER,
        TIPOIMP CHAR(1) DEFAULT 'O' NOT NULL,
        INVOICE VARCHAR(20),
        DI CHAR(10),
        MANIFESTO VARCHAR(20),
        CERTORIGEM VARCHAR(200),
        LACRE VARCHAR(100),
        PRESCARGA VARCHAR(200),
        IDENTHOUSE VARCHAR(100),
        DTA VARCHAR(50),
        CONHECCARGA VARCHAR(100),
        IDENTCONTAINER CHAR(20),
        TIPOMANIFESTO VARCHAR(20),
        DTIMP DATE NOT NULL,
        DTEMB DATE,
        DTCHEGADA DATE,
        DTDESEMBDI DATE,
        DTREGDI DATE,
        LOCALEMB VARCHAR(200),
        RECINTOADUANEIRO VARCHAR(200),
        CODPAISDESEMBDI INTEGER,
        SIGLAUFDESEMBDI CHAR(2),
        LOCDESEMBDI CHAR(60),
        OBS VARCHAR(1024),
        VEICULO VARCHAR(200),
        PESOBRUTO NUMERICDN              DEFAULT 0.00 NOT NULL,
        PESOLIQUIDO NUMERICDN              DEFAULT 0.00 NOT NULL,
        VLRFRETEMI NUMERICDN              DEFAULT 0.00 NOT NULL,
        VLRFRETE NUMERICDN              DEFAULT 0.00 NOT NULL,
        VMLEMI NUMERICDN              DEFAULT 0.00 NOT NULL,
        VMLDMI NUMERICDN              DEFAULT 0.00 NOT NULL,
        VMLE NUMERICDN              DEFAULT 0.00 NOT NULL,
        VMLD NUMERICDN              DEFAULT 0.00 NOT NULL,
        VLRSEGUROMI NUMERICDN              DEFAULT 0.00 NOT NULL,
        VLRSEGURO NUMERICDN              DEFAULT 0.00 NOT NULL,
        VLRII NUMERICDN              DEFAULT 0.00 NOT NULL,
        VLRIPI NUMERICDN              DEFAULT 0.00 NOT NULL,
        VLRPIS NUMERICDN              DEFAULT 0.00 NOT NULL,
        VLRCOFINS NUMERICDN              DEFAULT 0.00 NOT NULL,
        VLRDIREITOSAD NUMERICDN              DEFAULT 0.00 NOT NULL,
        VLRTHC NUMERICDN              DEFAULT 0.00 NOT NULL,
        VLRTHCMI NUMERICDN              DEFAULT 0.00 NOT NULL,
        VLRTXSISCOMEX NUMERICDN              DEFAULT 0.00 NOT NULL,
        VLRAD NUMERICDN               DEFAULT 0.00 NOT NULL,
        VLRADMI NUMERICDN               DEFAULT 0.00 NOT NULL,
        VLRBASEICMS NUMERICDN               DEFAULT 0.00 NOT NULL,
        VLRICMS NUMERICDN               DEFAULT 0.00 NOT NULL,
        VLRICMSDIFERIDO NUMERICDN               DEFAULT 0.00 NOT NULL,
        VLRICMSDEVIDO NUMERICDN               DEFAULT 0.00 NOT NULL,
        VLRICMSCREDPRESUM NUMERICDN               DEFAULT 0.00 NOT NULL,
        VLRICMSRECOLHIMENTO NUMERICDN               DEFAULT 0.00 NOT NULL,
        VLRDESPAD NUMERICDN               DEFAULT 0.00 NOT NULL,
        VLRCOMPL NUMERICDN         DEFAULT 0.00 NOT NULL,
        EMMANUT CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT CPIMPORTACAOPK PRIMARY KEY (CODIMP, CODFILIAL, CODEMP));

/* Table: CPIMPORTACAOADIC, Owner: SYSDBA */
CREATE TABLE CPIMPORTACAOADIC (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODIMP INTEGER NOT NULL,
        CODNCM VARCHAR(10) NOT NULL,
        CODADIC INTEGER NOT NULL,
        VLRTXSISCOMEX NUMERICDN NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT CPIMPORTACAOADICPK PRIMARY KEY (CODNCM, CODFILIAL, CODIMP, CODEMP));

/* Table: CPIMPORTACAOCOMPL, Owner: SYSDBA */
CREATE TABLE CPIMPORTACAOCOMPL (ID BIGINT NOT NULL,
        CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODIMP INTEGER NOT NULL,
        DESCADIC VARCHAR(50) NOT NULL,
        VLRDESPADIC NUMERICDN     DEFAULT 0.00 NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT CPIMPORTACAOCOMPLPK PRIMARY KEY (ID));

/* Table: CPITCOMPRA, Owner: SYSDBA */
CREATE TABLE CPITCOMPRA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCOMPRA INTEGER NOT NULL,
        CODITCOMPRA INTEGER NOT NULL,
        CODEMPPD INTEGER NOT NULL,
        CODFILIALPD SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        CODEMPLE INTEGER,
        CODFILIALLE SMALLINT,
        CODLOTE VARCHAR(20),
        CODEMPNT INTEGER NOT NULL,
        CODFILIALNT SMALLINT NOT NULL,
        CODNAT CHAR(4) NOT NULL,
        CODEMPAX INTEGER NOT NULL,
        CODFILIALAX SMALLINT NOT NULL,
        CODALMOX INTEGER NOT NULL,
        QTDITCOMPRA NUMERICDN NOT NULL,
        QTDITCOMPRACANC NUMERICDN,
        PRECOITCOMPRA NUMERICDN NOT NULL,
        PERCDESCITCOMPRA NUMERICDN,
        VLRDESCITCOMPRA NUMERICDN,
        PERCICMSITCOMPRA NUMERICDN,
        VLRBASEICMSITCOMPRA NUMERICDN,
        VLRICMSITCOMPRA NUMERICDN,
        PERCICMSSTITCOMPRA NUMERICDN   DEFAULT 0 NOT NULL,
        VLRBASEICMSSTITCOMPRA NUMERICDN   DEFAULT 0 NOT NULL,
        VLRICMSSTITCOMPRA NUMERICDN   DEFAULT 0 NOT NULL,
        PERCIPIITCOMPRA NUMERICDN,
        VLRBASEIPIITCOMPRA NUMERICDN,
        VLRIPIITCOMPRA NUMERICDN,
        VLRBASEFUNRURALITCOMPRA NUMERICDN              
DEFAULT 0 NOT NULL,
        ALIQFUNRURALITCOMPRA NUMERICDN              
DEFAULT 0 NOT NULL,
        VLRFUNRURALITCOMPRA NUMERICDN              
DEFAULT 0 NOT NULL,
        VLRLIQITCOMPRA NUMERICDN,
        VLRADICITCOMPRA NUMERICDN,
        VLRFRETEITCOMPRA NUMERICDN,
        VLRISENTASITCOMPRA NUMERICDN,
        VLROUTRASITCOMPRA NUMERICDN,
        VLRPRODITCOMPRA NUMERICDN,
        CUSTOITCOMPRA NUMERICDN              DEFAULT 0,
        CUSTOVDITCOMPRA NUMERICDN              DEFAULT 0 NOT NULL,
        REFPROD VARCHAR(20),
        OBSITCOMPRA VARCHAR(10000),
        CODEMPIF INTEGER,
        CODFILIALIF SMALLINT,
        CODFISC CHAR(13),
        EMMANUT CHAR(1) DEFAULT 'N' NOT NULL,
        CODITFISC SMALLINT,
        CODEMPNS INTEGER,
        CODFILIALNS SMALLINT,
        NUMSERIETMP VARCHAR(30),
        NADICAO SMALLINT,
        SEQADIC SMALLINT,
        DESCDI NUMERICDN,
        APROVPRECO CHAR(1) DEFAULT 'N',
        EMITITCOMPRA CHAR(1),
        ALIQISSITCOMPRA NUMERICDN,
        VLRISSITCOMPRA NUMERICDN,
        VLRIIITCOMPRA NUMERICDN  DEFAULT 0.00,
        VLRITOUTRASDESPITCOMPRA NUMERICDN  DEFAULT 0.00,
        CALCCUSTO CHAR(1) DEFAULT 'S' NOT NULL,
        ADICICMSTOTNOTA CHAR(1) DEFAULT 'N' NOT NULL,
        VLRTXSISCOMEXITCOMPRA NUMERICDN  DEFAULT 0.00,
        TIPONFITCOMPRA CHAR(1) DEFAULT 'N',
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT CPITCOMPRAPK PRIMARY KEY (CODCOMPRA, CODITCOMPRA, CODFILIAL, CODEMP));

/* Table: CPITCOMPRAITCOMPRA, Owner: SYSDBA */
CREATE TABLE CPITCOMPRAITCOMPRA (ID BIGINT NOT NULL,
        CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCOMPRA INTEGER NOT NULL,
        CODITCOMPRA INTEGER NOT NULL,
        CODEMPCO INTEGER,
        CODFILIALCO SMALLINT,
        CODCOMPRACO INTEGER NOT NULL,
        CODITCOMPRACO INTEGER NOT NULL,
        QTDITCOMPRA DECIMAL(15, 5) DEFAULT 0 NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT VARCHAR(128) DEFAULT USER,
CONSTRAINT CPITCOMPRACPITCOMPRAPK PRIMARY KEY (ID));

/* Table: CPITCOMPRASERIE, Owner: SYSDBA */
CREATE TABLE CPITCOMPRASERIE (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCOMPRA INTEGER NOT NULL,
        CODITCOMPRA INTEGER NOT NULL,
        SEQITSERIE INTEGER NOT NULL,
        CODEMPPD INTEGER,
        CODFILIALPD SMALLINT,
        CODPROD INTEGER,
        NUMSERIE VARCHAR(30),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT CPITCOMPRASERIEPK PRIMARY KEY (CODCOMPRA, CODITCOMPRA, SEQITSERIE, CODFILIAL, CODEMP));

/* Table: CPITIMPORTACAO, Owner: SYSDBA */
CREATE TABLE CPITIMPORTACAO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODIMP INTEGER NOT NULL,
        CODITIMP SMALLINT NOT NULL,
        CODEMPPD INTEGER NOT NULL,
        CODFILIALPD SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        REFPROD VARCHAR(20) NOT NULL,
        QTD NUMERICDN NOT NULL,
        CODEMPUN INTEGER NOT NULL,
        CODFILIALUN SMALLINT NOT NULL,
        CODUNID VARCHAR(20) NOT NULL,
        PESOLIQUIDO NUMERICDN NOT NULL,
        PESOBRUTO NUMERICDN NOT NULL,
        PRECOMI NUMERICDN NOT NULL,
        PRECO NUMERICDN NOT NULL,
        VMLEMI NUMERICDN              DEFAULT 0.00 NOT NULL,
        VMLDMI NUMERICDN              DEFAULT 0.00 NOT NULL,
        VMLE NUMERICDN              DEFAULT 0.00 NOT NULL,
        VMLD NUMERICDN              DEFAULT 0.00 NOT NULL,
        VLRFRETEMI NUMERICDN              DEFAULT 0.00 NOT NULL,
        VLRFRETE NUMERICDN              DEFAULT 0.00 NOT NULL,
        VLRSEGUROMI NUMERICDN              DEFAULT 0.00 NOT NULL,
        VLRSEGURO NUMERICDN              DEFAULT 0.00 NOT NULL,
        VLRTHCMI NUMERICDN              DEFAULT 0.00 NOT NULL,
        VLRTHC NUMERICDN              DEFAULT 0.00 NOT NULL,
        VLRADMI NUMERICDN              DEFAULT 0.00 NOT NULL,
        VLRAD NUMERICDN              DEFAULT 0.00 NOT NULL,
        ALIQICMSIMP NUMERICDN              DEFAULT 0.00 NOT NULL,
        ALIQICMSUF NUMERICDN              DEFAULT 0.00 NOT NULL,
        PERCDIFERICMS NUMERICDN              DEFAULT 0.00 NOT NULL,
        PERCCREDPRESIMP NUMERICDN     DEFAULT 100.00 NOT NULL,
        ALIQIPI NUMERICDN              DEFAULT 0.00 NOT NULL,
        ALIQPIS NUMERICDN              DEFAULT 0.00 NOT NULL,
        ALIQCOFINS NUMERICDN              DEFAULT 0.00 NOT NULL,
        ALIQII NUMERICDN              DEFAULT 0.00 NOT NULL,
        VLRII NUMERICDN              DEFAULT 0.00 NOT NULL,
        VLRIPI NUMERICDN              DEFAULT 0.00 NOT NULL,
        VLRPIS NUMERICDN              DEFAULT 0.00 NOT NULL,
        VLRCOFINS NUMERICDN              DEFAULT 0.00 NOT NULL,
        VLRBASEICMS NUMERICDN              DEFAULT 0.00 NOT NULL,
        VLRICMS NUMERICDN              DEFAULT 0.00 NOT NULL,
        VLRICMSDIFERIDO NUMERICDN              DEFAULT 0.00 NOT NULL,
        VLRICMSDEVIDO NUMERICDN               DEFAULT 0.00 NOT NULL,
        VLRICMSCREDPRESUM NUMERICDN              DEFAULT 0.00 NOT NULL,
        VLRICMSRECOLHIMENTO NUMERICDN              DEFAULT 0.00 NOT NULL,
        VLRITDESPAD NUMERICDN              DEFAULT 0.00 NOT NULL,
        VLRTXSISCOMEX NUMERICDN              
DEFAULT 0.00 NOT NULL,
        VLRVMCV NUMERICDN               DEFAULT 0.00 NOT NULL,
        VLRCOMPL NUMERICDN         DEFAULT 0.00 NOT NULL,
        CODEMPCF INTEGER,
        CODFILIALCF SMALLINT,
        CODFISC CHAR(13),
        CODITFISC INTEGER,
        CODNCM VARCHAR(10),
        SEQADIC SMALLINT,
        EMMANUT CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT CPITIMPORTACAOPK PRIMARY KEY (CODIMP, CODITIMP, CODFILIAL, CODEMP));

/* Table: CPITORDCOMPRA, Owner: SYSDBA */
CREATE TABLE CPITORDCOMPRA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODORDCP INTEGER NOT NULL,
        CODITORDCP SMALLINT NOT NULL,
        QTDITORDCP NUMERICDN NOT NULL,
        PRECOITORDCP NUMERICDN NOT NULL,
        QTDAPITORDCP NUMERICDN  DEFAULT 0.00,
        VLRBRUTITORDCP NUMERICDN,
        VLRBRUTAPITORDCP NUMERICDN,
        ALIQIPIITORDCP NUMERICDN  DEFAULT 0.00,
        VLRIPIITORDCP NUMERICDN  DEFAULT 0.00,
        VLRIPIAPITORDCP NUMERICDN,
        VLRLIQITORDCP NUMERICDN,
        VLRLIQAPITORDCP NUMERICDN,
        CODEMPPD INTEGER NOT NULL,
        CODFILIALPD SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        REFPROD VARCHAR(20) NOT NULL,
        STATUSITOC CHAR(2) DEFAULT 'PE' NOT NULL,
        STATUSAPITOC CHAR(2) DEFAULT 'PE' NOT NULL,
        STATUSRECITOC CHAR(2) DEFAULT 'PE' NOT NULL,
        JUSTCANCITOC VARCHAR(2000),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT user NOT NULL,
        DTALT DATE,
        HALT TIME,
        IDUSUALT CHAR(8),
CONSTRAINT CPITORDCOMPRAPK PRIMARY KEY (CODEMP, CODFILIAL, CODORDCP, CODITORDCP));

/* Table: CPITORDCOMPRAPE, Owner: SYSDBA */
CREATE TABLE CPITORDCOMPRAPE (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODORDCP INTEGER NOT NULL,
        CODITORDCP SMALLINT NOT NULL,
        SEQITORDCPPE SMALLINT NOT NULL,
        DTITPE DATE NOT NULL,
        QTDITPE NUMERICDN NOT NULL,
        QTDITENTPE NUMERICDN   DEFAULT 0.00 NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT 'user' NOT NULL,
        DTALT DATE,
        HALT TIME,
        IDUSUALT CHAR(8),
CONSTRAINT CPITORDCOMPRAPEPK PRIMARY KEY (CODEMP, CODFILIAL, CODORDCP, CODITORDCP, SEQITORDCPPE));

/* Table: CPITSOLICITACAO, Owner: SYSDBA */
CREATE TABLE CPITSOLICITACAO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODSOL INTEGER NOT NULL,
        CODITSOL SMALLINT NOT NULL,
        CODEMPPD INTEGER NOT NULL,
        CODFILIALPD SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        REFPROD VARCHAR(20) NOT NULL,
        QTDITSOL NUMERICDN              DEFAULT 0 NOT NULL,
        QTDAPROVITSOL NUMERICDN              DEFAULT 0 NOT NULL,
        IDUSUITSOL CHAR(8) DEFAULT USER NOT NULL,
        DTITSOL DATE DEFAULT 'now' NOT NULL,
        IDUSUAPROVITSOL CHAR(8),
        DTAPROVITSOL DATE,
        SITAPROVITSOL CHAR(2) DEFAULT 'PE' NOT NULL,
        SITCOMPITSOL CHAR(2) DEFAULT 'PE' NOT NULL,
        SITITSOL CHAR(2) DEFAULT 'PE' NOT NULL,
        CODEMPAM INTEGER NOT NULL,
        CODFILIALAM SMALLINT NOT NULL,
        CODALMOX INTEGER NOT NULL,
        MOTIVOITSOL VARCHAR(10000),
        MOTIVOAPROVITSOL VARCHAR(10000),
        MOTIVOCOMPITSOL VARCHAR(10000),
        IDUSUCANCITSOL CHAR(8),
        PRIORITSOL CHAR(1) DEFAULT 'B' NOT NULL,
        MOTIVOPRIORITSOL VARCHAR(10000),
        MOTIVOCANCITSOL VARCHAR(10000),
        MOTIVOCOTABAIX VARCHAR(10000),
        CODEMPUA INTEGER,
        CODFILIALUA SMALLINT,
        EMMANUT CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE,
        HALT TIME,
        IDUSUALT CHAR(8),
CONSTRAINT CPITSOLICITACAOPK PRIMARY KEY (CODSOL, CODITSOL, CODFILIAL, CODEMP));

/* Table: CPITSOLITSOL, Owner: SYSDBA */
CREATE TABLE CPITSOLITSOL (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODSOL INTEGER NOT NULL,
        CODITSOL SMALLINT NOT NULL,
        CODEMPSN INTEGER NOT NULL,
        CODFILIALSN SMALLINT NOT NULL,
        CODSOLN INTEGER NOT NULL,
        CODITSOLN SMALLINT NOT NULL,
        DTITSOLIS DATE DEFAULT 'now' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE,
        HALT TIME,
        IDUSUALT CHAR(128),
CONSTRAINT CPITSOLITSOLPK PRIMARY KEY (CODSOL, CODITSOL, CODSOLN, CODITSOLN, CODFILIAL, CODEMP, CODFILIALSN, CODEMPSN));

/* Table: CPITSUMSOL, Owner: SYSDBA */
CREATE TABLE CPITSUMSOL (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODSUMSOL INTEGER NOT NULL,
        CODEMPSC INTEGER NOT NULL,
        CODFILIALSC SMALLINT NOT NULL,
        CODSOL INTEGER NOT NULL,
        CODITSOL SMALLINT NOT NULL,
        DTCOT DATE,
        IDUSUCOT CHAR(8),
        CODEMPFR INTEGER,
        CODFILIALFR SMALLINT,
        CODFOR INTEGER,
        QTDCOT NUMERIC(15, 5),
        PRECOCOT NUMERIC(15, 5),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE,
        HALT TIME,
        IDUSUALT CHAR(8),
CONSTRAINT PK_CPITSUMSOL PRIMARY KEY (CODITSOL, CODSOL, CODFILIALSC, CODEMPSC, CODSUMSOL, CODFILIAL, CODEMP));

/* Table: CPORDCOMPRA, Owner: SYSDBA */
CREATE TABLE CPORDCOMPRA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODORDCP INTEGER NOT NULL,
        CODEMPFR INTEGER NOT NULL,
        CODFILIALFR SMALLINT NOT NULL,
        CODFOR INTEGER NOT NULL,
        CODEMPPG INTEGER NOT NULL,
        CODFILIALPG SMALLINT NOT NULL,
        CODPLANOPAG INTEGER NOT NULL,
        OBSORDCP VARCHAR(2000),
        JUSTIFCANCORDCP VARCHAR(2000),
        DTEMITORDCP DATE NOT NULL,
        DTAPORDCP DATE,
        STATUSOC CHAR(2) DEFAULT 'PE' NOT NULL,
        STATUSAPOC CHAR(2) DEFAULT 'PE' NOT NULL,
        STATUSRECOC CHAR(2) DEFAULT 'PE' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT user NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT user,
CONSTRAINT CPORDCOMPRAPK PRIMARY KEY (CODEMP, CODFILIAL, CODORDCP));

/* Table: CPPRODFOR, Owner: SYSDBA */
CREATE TABLE CPPRODFOR (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        CODEMPFR INTEGER NOT NULL,
        CODFILIALFR SMALLINT NOT NULL,
        CODFOR INTEGER NOT NULL,
        REFPRODFOR VARCHAR(21),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT CPPRODFORPK PRIMARY KEY (CODPROD, CODFOR, CODFILIAL, CODFILIALFR, CODEMP, CODEMPFR));

/* Table: CPRATEIO, Owner: SYSDBA */
CREATE TABLE CPRATEIO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCOMPRA INTEGER NOT NULL,
        SEQRATEIO SMALLINT NOT NULL,
        CODEMPFN INTEGER NOT NULL,
        CODFILIALFN SMALLINT NOT NULL,
        CODPLAN CHAR(13) NOT NULL,
        CODEMPCC INTEGER NOT NULL,
        CODFILIALCC SMALLINT NOT NULL,
        ANOCC SMALLINT NOT NULL,
        CODCC CHAR(19) NOT NULL,
        PERCRATEIO NUMERIC(6, 2) DEFAULT 0 NOT NULL,
        VLRRATEIO NUMERICDN               DEFAULT 0 NOT NULL,
        SITRATEIO CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE,
        HALT TIME,
        IDUSUALT CHAR(8),
CONSTRAINT CPRATEIOPK PRIMARY KEY (CODCOMPRA, SEQRATEIO, CODFILIAL, CODEMP));

/* Table: CPSOLICITACAO, Owner: SYSDBA */
CREATE TABLE CPSOLICITACAO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODSOL INTEGER NOT NULL,
        DTEMITSOL DATE NOT NULL,
        SITSOL CHAR(2) DEFAULT 'PE' NOT NULL,
        ORIGSOL CHAR(2) DEFAULT 'AX' NOT NULL,
        MOTIVOSOL VARCHAR(10000),
        CODEMPUU INTEGER NOT NULL,
        CODFILIALUU SMALLINT NOT NULL,
        IDUSU CHAR(8) NOT NULL,
        DTAAPROVSOL DATE,
        CODEMPUA INTEGER,
        CODFILIALUA SMALLINT,
        IDUSUAPROV CHAR(8),
        CODEMPCC INTEGER NOT NULL,
        CODFILIALCC SMALLINT NOT NULL,
        CODCC CHAR(19) NOT NULL,
        ANOCC SMALLINT NOT NULL,
        IDUSUCANCSOL CHAR(8),
        MOTIVOCANCSOL VARCHAR(10000),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE,
        HALT TIME,
        IDUSUALT CHAR(8),
CONSTRAINT CPSOLICITACAOPK PRIMARY KEY (CODSOL, CODFILIAL, CODEMP));

/* Table: CPSUMSOL, Owner: SYSDBA */
CREATE TABLE CPSUMSOL (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODSUMSOL INTEGER NOT NULL,
        CODEMPPD INTEGER NOT NULL,
        CODFILIALPD SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        REFPROD VARCHAR(20) NOT NULL,
        QTDITSOL NUMERICDN               DEFAULT 0 NOT NULL,
        QTDAPROVITSOL NUMERICDN               DEFAULT 0 NOT NULL,
        SITITSOL CHAR(2) DEFAULT 'PE' NOT NULL,
        DTAPROVITSOL DATE,
        IDUSUAPROVITSOL CHAR(8),
        SITAPROVITSOL CHAR(2),
        MOTIVOCOTABAIX VARCHAR(10000),
        EMMANUT CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE,
        HALT TIME,
        IDUSUALT CHAR(8),
CONSTRAINT CPSUMSOLPK PRIMARY KEY (CODSUMSOL, CODFILIAL, CODEMP));

/* Table: CPTABFOR, Owner: SYSDBA */
CREATE TABLE CPTABFOR (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODFOR INTEGER NOT NULL,
        REFPRODTFOR CHAR(21) NOT NULL,
        DESCPRODTFOR CHAR(50) NOT NULL,
        PRECOPRODTFOR NUMERICDN              DEFAULT 0 NOT NULL,
        CODEMPPD INTEGER,
        CODFILIALPD SMALLINT,
        CODPROD INTEGER,
        REFORIGTFOR CHAR(18),
        LINHATFOR CHAR(30),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT CPTABFORPK PRIMARY KEY (REFPRODTFOR, CODFOR, CODFILIAL, CODEMP));

/* Table: CPTIPOFOR, Owner: SYSDBA */
CREATE TABLE CPTIPOFOR (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTIPOFOR INTEGER NOT NULL,
        DESCTIPOFOR CHAR(40),
        RETENCAOINSS CHAR(1),
        PERCBASEINSS NUMERICDN,
        RETENCAOOUTROS CHAR(1),
        PERCRETOUTROS NUMERICDN,
        RETENCAOIRRF CHAR(1),
        PERCBASEIRRF NUMERICDN,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT CPTIPOFORPK PRIMARY KEY (CODTIPOFOR, CODFILIAL, CODEMP));

/* Table: CRAMBIENTEAVAL, Owner: SYSDBA */
CREATE TABLE CRAMBIENTEAVAL (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODAMBAVAL INTEGER NOT NULL,
        DESCAMBAVAL VARCHAR(50) NOT NULL,
        SIGLAAMBAVAL VARCHAR(10) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT VARCHAR(128) DEFAULT USER,
CONSTRAINT CRAMBIENTEAVALPK PRIMARY KEY (CODAMBAVAL, CODFILIAL, CODEMP));

/* Table: CRCHAMADO, Owner: SYSDBA */
CREATE TABLE CRCHAMADO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCHAMADO INTEGER NOT NULL,
        DESCCHAMADO CHAR(100) NOT NULL,
        FATOGERADOR VARCHAR(1000),
        AMBIENTE VARCHAR(1000),
        DETCHAMADO VARCHAR(1000),
        OBSCHAMADO VARCHAR(1000),
        CODEMPCL INTEGER NOT NULL,
        CODFILIALCL SMALLINT NOT NULL,
        CODCLI INTEGER NOT NULL,
        SOLICITANTE CHAR(50) NOT NULL,
        PRIORIDADE SMALLINT DEFAULT 2 NOT NULL,
        CODEMPTC INTEGER NOT NULL,
        CODFILIALTC SMALLINT NOT NULL,
        CODTPCHAMADO INTEGER NOT NULL,
        STATUS CHAR(2) DEFAULT 'PE' NOT NULL,
        DTCHAMADO DATE DEFAULT 'today' NOT NULL,
        DTPREVISAO DATE DEFAULT 'today' NOT NULL,
        QTDHORASPREVISAO NUMERICDN              DEFAULT 0 NOT NULL,
        CODEMPCT INTEGER,
        CODFILIALCT SMALLINT,
        CODCONTR INTEGER,
        CODITCONTR SMALLINT,
        DTCONCLUSAO DATE,
        CODEMPAE INTEGER,
        CODFILIALAE SMALLINT,
        CODATEND INTEGER,
        CODEMPOS INTEGER,
        CODFILIALOS SMALLINT,
        TICKET INTEGER,
        CODITRECMERC SMALLINT,
        CODITOS SMALLINT,
        EMATENDIMENTO CHAR(1) DEFAULT 'N' NOT NULL,
        CODEMPQL INTEGER,
        CODFILIALQL SMALLINT,
        CODQUALIFIC INTEGER,
        EMAILSOLICITANTE CHAR(60),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT CRCHAMADOPK PRIMARY KEY (CODCHAMADO, CODFILIAL, CODEMP));

/* Table: CRCHAMADOANEXO, Owner: SYSDBA */
CREATE TABLE CRCHAMADOANEXO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCHAMADO INTEGER NOT NULL,
        CODANEXO SMALLINT NOT NULL,
        DESCANEXO VARCHAR(200),
        ANEXO BLOB SUB_TYPE TEXT SEGMENT SIZE 80,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT CRCHAMADOANEXOPK PRIMARY KEY (CODCHAMADO, CODANEXO, CODEMP, CODFILIAL));

/* Table: CRFEEDBACK, Owner: SYSDBA */
CREATE TABLE CRFEEDBACK (ID BIGINT NOT NULL,
        CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        NOME VARCHAR(128) NOT NULL,
        CODEMPPE INTEGER NOT NULL,
        CODFILIALPE SMALLINT NOT NULL,
        EMAILPESSOA VARCHAR(128) NOT NULL,
        ID_MOTIVO BIGINT NOT NULL,
        MENSAGEM VARCHAR(10000) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT VARCHAR(128) DEFAULT USER,
CONSTRAINT CRFEEDBACKPK PRIMARY KEY (ID));

/* Table: CRFICHAAVAL, Owner: SYSDBA */
CREATE TABLE CRFICHAAVAL (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        SEQFICHAAVAL INTEGER NOT NULL,
        CODEMPCO INTEGER NOT NULL,
        CODFILIALCO SMALLINT NOT NULL,
        CODCTO INTEGER NOT NULL,
        CODEMPMA INTEGER NOT NULL,
        CODFILIALMA SMALLINT NOT NULL,
        CODMOTAVAL INTEGER NOT NULL,
        DTFICHAAVAL DATE DEFAULT 'now' NOT NULL,
        LOCALFICHAAVAL CHAR(1) DEFAULT 'A',
        FINALICRIFICHAAVAL CHAR(1) DEFAULT 'N' NOT NULL,
        FINALIANIFICHAAVAL CHAR(1) DEFAULT 'N' NOT NULL,
        FINALIOUTFICHAAVAL CHAR(1) DEFAULT 'N' NOT NULL,
        PREDENTRFICHAAVAL CHAR(1) DEFAULT 'N' NOT NULL,
        ANDARFICHAAVAL SMALLINT DEFAULT 0 NOT NULL,
        COBERTFICHAAVAL CHAR(1) DEFAULT 'N' NOT NULL,
        ESTRUTFICHAAVAL CHAR(1) DEFAULT 'N' NOT NULL,
        OCUPADOFICHAAVAL CHAR(1) DEFAULT 'N' NOT NULL,
        MOBILFICHAAVAL CHAR(1) DEFAULT 'M' NOT NULL,
        JANELAFICHAAVAL CHAR(1) DEFAULT 'N' NOT NULL,
        QTDJANELAFICHAAVAL INTEGER,
        SACADAFICHAAVAL CHAR(1) DEFAULT 'N' NOT NULL,
        QTDSACADAFICHAAVAL INTEGER,
        OUTROSFICHAAVAL CHAR(1) DEFAULT 'N' NOT NULL,
        DTVISITAFICHAAVAL DATE,
        HVISITAFICHAAVAL TIME,
        DESCOUTROSFICHAAVAL VARCHAR(30),
        OBSFICHAAVAL VARCHAR(1000),
        PONTOREFFICHAAVAL VARCHAR(100),
        CODEMPVD INTEGER,
        CODFILIALVD SMALLINT,
        CODVEND INTEGER,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT VARCHAR(128) DEFAULT USER,
CONSTRAINT CRFICHAAVALPK PRIMARY KEY (SEQFICHAAVAL, CODFILIAL, CODEMP));

/* Table: CRFICHAORC, Owner: SYSDBA */
CREATE TABLE CRFICHAORC (CODEMP INTEGER NOT NULL,
        CODFILIAL INTEGER NOT NULL,
        SEQFICHAAVAL INTEGER NOT NULL,
        SEQITFICHAAVAL INTEGER NOT NULL,
        CODEMPOR INTEGER NOT NULL,
        CODFILIALOR INTEGER NOT NULL,
        TIPOORC CHAR(1) NOT NULL,
        CODORC INTEGER NOT NULL,
        CODITORC INTEGER NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT CRFICHAORCPK PRIMARY KEY (SEQFICHAAVAL, SEQITFICHAAVAL, CODFILIAL, CODEMP, CODORC, CODITORC, TIPOORC, CODFILIALOR, CODEMPOR));

/* Table: CRITFICHAAVAL, Owner: SYSDBA */
CREATE TABLE CRITFICHAAVAL (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        SEQFICHAAVAL INTEGER NOT NULL,
        SEQITFICHAAVAL INTEGER NOT NULL,
        CODEMPAM INTEGER NOT NULL,
        CODFILIALAM SMALLINT NOT NULL,
        CODAMBAVAL INTEGER NOT NULL,
        DESCITFICHAAVAL VARCHAR(50) NOT NULL,
        CODEMPPD INTEGER NOT NULL,
        CODFILIALPD SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        ALTITFICHAAVAL NUMERIC(15, 5) NOT NULL,
        COMPITFICHAAVAL NUMERIC(15, 5) NOT NULL,
        TIRITFICHAAVAL NUMERIC(15, 5) DEFAULT 0 NOT NULL,
        M2ITFICHAAVAL NUMERIC(15, 5) NOT NULL,
        VLRUNITITFICHAAVAL NUMERIC(15, 5) NOT NULL,
        VLRTOTITFICHAAVAL NUMERIC(15, 5) NOT NULL,
        CODEMPV1 INTEGER,
        CODFILIALV1 SMALLINT,
        CODVARG1 INTEGER,
        SEQITVARG1 SMALLINT,
        CODEMPV2 INTEGER,
        CODFILIALV2 SMALLINT,
        CODVARG2 INTEGER,
        SEQITVARG2 SMALLINT,
        CODEMPV3 INTEGER,
        CODFILIALV3 SMALLINT,
        CODVARG3 INTEGER,
        SEQITVARG3 SMALLINT,
        CODEMPV4 INTEGER,
        CODFILIALV4 SMALLINT,
        CODVARG4 INTEGER,
        SEQITVARG4 SMALLINT,
        CODEMPV5 INTEGER,
        CODFILIALV5 SMALLINT,
        CODVARG5 INTEGER,
        SEQITVARG5 SMALLINT,
        CODEMPV6 INTEGER,
        CODFILIALV6 SMALLINT,
        CODVARG6 INTEGER,
        SEQITVARG6 SMALLINT,
        CODEMPV7 INTEGER,
        CODFILIALV7 SMALLINT,
        CODVARG7 INTEGER,
        SEQITVARG7 SMALLINT,
        CODEMPV8 INTEGER,
        CODFILIALV8 SMALLINT,
        CODVARG8 INTEGER,
        SEQITVARG8 SMALLINT,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT VARCHAR(128) DEFAULT USER,
CONSTRAINT CRITFICHAAVALPK PRIMARY KEY (SEQFICHAAVAL, SEQITFICHAAVAL, CODFILIAL, CODEMP));

/* Table: CRMARCADOR, Owner: SYSDBA */
CREATE TABLE CRMARCADOR (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODMARCOR INTEGER NOT NULL,
        DESCMARCOR VARCHAR(100) NOT NULL,
        VERMARCOR VARCHAR(10) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT VARCHAR(128) DEFAULT USER,
CONSTRAINT CRMARCADORPK PRIMARY KEY (CODMARCOR, CODFILIAL, CODEMP));

/* Table: CRMOTIVOAVAL, Owner: SYSDBA */
CREATE TABLE CRMOTIVOAVAL (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODMOTAVAL INTEGER NOT NULL,
        DESCMOTAVAL VARCHAR(50) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT VARCHAR(128) DEFAULT USER,
CONSTRAINT CRMOTIVOAVALPK PRIMARY KEY (CODMOTAVAL, CODFILIAL, CODEMP));

/* Table: CRMOTIVOFB, Owner: SYSDBA */
CREATE TABLE CRMOTIVOFB (ID BIGINT NOT NULL,
        CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        DESCRICAO VARCHAR(128) NOT NULL,
        TIPO CHAR(2) DEFAULT '00' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(128) DEFAULT USER,
CONSTRAINT CRMOTIVOFBPK PRIMARY KEY (ID));

/* Table: CRPESSOA, Owner: SYSDBA */
CREATE TABLE CRPESSOA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        EMAILPESSOA VARCHAR(128) NOT NULL,
        NOMEPESSOA VARCHAR(60) NOT NULL,
        SENHAPESSOA VARCHAR(128) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT VARCHAR(128) DEFAULT USER NOT NULL,
CONSTRAINT CRPESSOAPK PRIMARY KEY (EMAILPESSOA, CODFILIAL, CODEMP));

/* Table: CRQUALIFICACAO, Owner: SYSDBA */
CREATE TABLE CRQUALIFICACAO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODQUALIFIC INTEGER NOT NULL,
        DESCQUALIFIC CHAR(100) NOT NULL,
        FINALIZA CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT CRQUALIFICACAOPK PRIMARY KEY (CODFILIAL, CODEMP, CODQUALIFIC));

/* Table: CRTAREFA, Owner: SYSDBA */
CREATE TABLE CRTAREFA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTAREFA INTEGER NOT NULL,
        DESCTAREFA VARCHAR(100) NOT NULL,
        TIPOTAREFA CHAR(1) DEFAULT 'T' NOT NULL,
        LANCTOTAREFA CHAR(1) DEFAULT 'S' NOT NULL,
        DESCDETTAREFA VARCHAR(2000) NOT NULL,
        CODEMPCT INTEGER NOT NULL,
        CODFILIALCT SMALLINT NOT NULL,
        CODCONTR INTEGER NOT NULL,
        CODITCONTR SMALLINT NOT NULL,
        INDEXTAREFA INTEGER DEFAULT 1 NOT NULL,
        TEMPOESTTAREFA VARCHAR(10) DEFAULT '00:00' NOT NULL,
        TEMPODECTAREFA NUMERICDN   DEFAULT 0 NOT NULL,
        CODEMPTA INTEGER,
        CODFILIALTA SMALLINT,
        CODTAREFATA INTEGER,
        CODEMPCH INTEGER,
        CODFILIALCH SMALLINT,
        CODCHAMADO INTEGER,
        CODEMPMO INTEGER,
        CODFILIALMO SMALLINT,
        CODMARCOR INTEGER,
        NOTASTAREFA VARCHAR(2000),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT VARCHAR(128) DEFAULT USER,
CONSTRAINT CRTAREFAPK PRIMARY KEY (CODTAREFA, CODFILIAL, CODEMP));

/* Table: CRTAREFAPER, Owner: SYSDBA */
CREATE TABLE CRTAREFAPER (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTAREFA INTEGER NOT NULL,
        ANOTPER SMALLINT NOT NULL,
        MESTPER SMALLINT NOT NULL,
        DTINIPER DATE NOT NULL,
        DTFIMPER DATE NOT NULL,
        TEMPOESTTAREFA VARCHAR(10) DEFAULT '00:00' NOT NULL,
        TEMPODECTAREFA NUMERICDN   DEFAULT 0 NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT VARCHAR(128) DEFAULT USER,
CONSTRAINT CRTAREFAPERPK PRIMARY KEY (CODTAREFA, MESTPER, ANOTPER, CODFILIAL, CODEMP));

/* Table: CRTIPOCHAMADO, Owner: SYSDBA */
CREATE TABLE CRTIPOCHAMADO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTPCHAMADO INTEGER NOT NULL,
        DESCTPCHAMADO CHAR(50) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT CRTIPOCHAMADOPK PRIMARY KEY (CODTPCHAMADO, CODFILIAL, CODEMP));

/* Table: CRTOTAL, Owner: SYSDBA */
CREATE TABLE CRTOTAL (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        SEQTOT INTEGER NOT NULL,
        TPTOT CHAR(2) DEFAULT 'CT',
        ANOTOT SMALLINT DEFAULT 0 NOT NULL,
        MESTOT SMALLINT DEFAULT 0 NOT NULL,
        TPMESTOT CHAR(1) DEFAULT 'G' NOT NULL,
        TOTALPREV DECIMAL(10, 2) DEFAULT 0 NOT NULL,
        TOTALMIN INTEGER DEFAULT 0 NOT NULL,
        TOTALGERAL DECIMAL(10, 2) DEFAULT 0 NOT NULL,
        TOTALCOMIS DECIMAL(10, 2) DEFAULT 0 NOT NULL,
        TOTALBH DECIMAL(10, 2) DEFAULT 0 NOT NULL,
        CODEMPCT INTEGER,
        CODFILIALCT SMALLINT,
        CODCONTR INTEGER,
        CODITCONTR SMALLINT,
        CODEMPTA INTEGER,
        CODFILIALTA SMALLINT,
        CODTAREFA INTEGER,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT VARCHAR(128) DEFAULT USER,
CONSTRAINT CRTOTAL PRIMARY KEY (SEQTOT, CODFILIAL, CODEMP));

/* Table: EQALMOX, Owner: SYSDBA */
CREATE TABLE EQALMOX (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODALMOX INTEGER NOT NULL,
        DESCALMOX CHAR(40) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQALMOXPK PRIMARY KEY (CODALMOX, CODFILIAL, CODEMP));

/* Table: EQALMOXFILIAL, Owner: SYSDBA */
CREATE TABLE EQALMOXFILIAL (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODALMOX INTEGER NOT NULL,
        CODEMPAF INTEGER NOT NULL,
        CODFILIALAF SMALLINT NOT NULL,
        BAIXAESTOQAF CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQALMOXFILIALPK PRIMARY KEY (CODALMOX, CODFILIAL, CODEMP, CODFILIALAF, CODEMPAF));

/* Table: EQCLIFOR, Owner: SYSDBA */
CREATE TABLE EQCLIFOR (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCLI INTEGER NOT NULL,
        CODEMPFR INTEGER NOT NULL,
        CODFILIALFR SMALLINT NOT NULL,
        CODFOR INTEGER NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT VARCHAR(128) DEFAULT USER,
CONSTRAINT EQCLIFORPK PRIMARY KEY (CODCLI, CODEMP, CODFILIAL, CODFOR, CODEMPFR, CODFILIALFR));

/* Table: EQCODALTPROD, Owner: SYSDBA */
CREATE TABLE EQCODALTPROD (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        CODALTPROD CHAR(20) NOT NULL,
        REFPROD VARCHAR(20) NOT NULL,
        EMMANUT CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT user NOT NULL,
        DTALT DATE,
        HALT TIME,
        IDUSUALT CHAR(8),
CONSTRAINT EQCODALTPRODPK PRIMARY KEY (CODALTPROD, CODPROD, CODFILIAL, CODEMP));

/* Table: EQETIQPROD, Owner: SYSDBA */
CREATE TABLE EQETIQPROD (NRCONEXAO INTEGER NOT NULL,
        CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER);

/* Table: EQEXPEDAMOSTRAGEM, Owner: SYSDBA */
CREATE TABLE EQEXPEDAMOSTRAGEM (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        TICKET INTEGER NOT NULL,
        CODITEXPED INTEGER NOT NULL,
        CODAMOSTRAGEM INTEGER NOT NULL,
        PESOAMOST NUMERICDN       DEFAULT 0 NOT NULL,
        DATAAMOST DATE default 'today' NOT NULL,
        HORAAMOST TIME default 'now' NOT NULL,
        SEQAMOSTRAGEM INTEGER DEFAULT 0 NOT NULL,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQEXPEDAMOSTRAGEMPK PRIMARY KEY (TICKET, CODITEXPED, CODAMOSTRAGEM, CODFILIAL, CODEMP));

/* Table: EQEXPEDICAO, Owner: SYSDBA */
CREATE TABLE EQEXPEDICAO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        TICKET INTEGER NOT NULL,
        CODEMPVE INTEGER,
        CODFILIALVE SMALLINT,
        CODVEIC INTEGER,
        CODEMPMT INTEGER,
        CODFILIALMT SMALLINT,
        CODMOT INTEGER,
        CODEMPPD INTEGER,
        CODFILIALPD SMALLINT,
        CODPROD INTEGER,
        REFPROD VARCHAR(20),
        CODEMPTE INTEGER NOT NULL,
        CODFILIALTE SMALLINT NOT NULL,
        CODTIPOEXPED INTEGER NOT NULL,
        CODEMPTN INTEGER,
        CODFILIALTN SMALLINT,
        CODTRAN INTEGER,
        STATUS CHAR(2) DEFAULT 'PE' NOT NULL,
        TIPOFRETE CHAR(1) DEFAULT 'C' NOT NULL,
        DTSAIDA DATE DEFAULT 'today' NOT NULL,
        CODEMPAX INTEGER,
        CODFILIALAX SMALLINT,
        CODALMOX INTEGER,
        CODEMPRO INTEGER,
        CODFILIALRO SMALLINT,
        CODROMA INTEGER,
        PESOENTRADA NUMERICDN,
        PESOSAIDA NUMERICDN,
        QTDINFORMADA NUMERICDN,
        PRECOPESO NUMERICDN,
        OBSEXPED VARCHAR(1000),
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQEXPEDICAOPK PRIMARY KEY (TICKET, CODFILIAL, CODEMP));

/* Table: EQFATCONV, Owner: SYSDBA */
CREATE TABLE EQFATCONV (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        CODUNID VARCHAR(20) NOT NULL,
        TIPOCONV CHAR(1) DEFAULT 'U' NOT NULL,
        FATCONV NUMERIC(10, 3) DEFAULT 1 NOT NULL,
        CPFATCONV CHAR(1) DEFAULT 'N' NOT NULL,
        CODEMPET INTEGER,
        CODFILIALET SMALLINT,
        CODPRODET INTEGER,
        SEQEST SMALLINT,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQFATCONVPK PRIMARY KEY (CODUNID, CODPROD, CODFILIAL, CODEMP));

/* Table: EQGRUPO, Owner: SYSDBA */
CREATE TABLE EQGRUPO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODGRUP CHAR(14) NOT NULL,
        DESCGRUP CHAR(50) NOT NULL,
        NIVELGRUP INTEGER,
        CODEMPSG INTEGER,
        CODFILIALSG SMALLINT,
        CODSUBGRUP CHAR(14),
        SIGLAGRUP CHAR(10),
        ESTNEGGRUP CHAR(1) DEFAULT 'N' NOT NULL,
        ESTLOTNEGGRUP CHAR(1) DEFAULT 'N' NOT NULL,
        WEB CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQGRUPOPK PRIMARY KEY (CODGRUP, CODFILIAL, CODEMP));

/* Table: EQGUIATRAF, Owner: SYSDBA */
CREATE TABLE EQGUIATRAF (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCOMPRA INTEGER NOT NULL,
        CODITCOMPRA INTEGER NOT NULL,
        DTEMISGUIATRAF DATE NOT NULL,
        NROGUIATRAF VARCHAR(20),
        NROSELOGUIATRAF VARCHAR(15),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQGUIATRAFPK PRIMARY KEY (CODITCOMPRA, CODCOMPRA, CODFILIAL, CODEMP));

/* Table: EQINVPROD, Owner: SYSDBA */
CREATE TABLE EQINVPROD (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODINVPROD INTEGER NOT NULL,
        CODEMPPD INTEGER NOT NULL,
        CODFILIALPD SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        CODEMPLE INTEGER,
        CODFILIALLE SMALLINT,
        CODLOTE VARCHAR(20),
        CODEMPTM INTEGER NOT NULL,
        CODFILIALTM SMALLINT NOT NULL,
        CODTIPOMOV INTEGER NOT NULL,
        DATAINVP DATE NOT NULL,
        QTDINVP NUMERICDN NOT NULL,
        PRECOINVP NUMERICDN              DEFAULT 0 NOT NULL,
        CODEMPAX INTEGER NOT NULL,
        CODFILIALAX SMALLINT NOT NULL,
        CODALMOX INTEGER NOT NULL,
        REFPROD VARCHAR(20),
        SLDATUALINVP NUMERICDN,
        SLDDIGINVP NUMERICDN,
        FLAG CHAR(1) DEFAULT 'S',
        OBSINVP VARCHAR(500),
        EMMANUT CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQINVPRODPK PRIMARY KEY (CODINVPROD, CODFILIAL, CODEMP));

/* Table: EQITEXPEDICAO, Owner: SYSDBA */
CREATE TABLE EQITEXPEDICAO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        TICKET INTEGER NOT NULL,
        CODITEXPED INTEGER NOT NULL,
        CODEMPPD INTEGER NOT NULL,
        CODFILIALPD SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        REFPROD VARCHAR(20) NOT NULL,
        CODEMPTE SMALLINT NOT NULL,
        CODFILIALTE SMALLINT NOT NULL,
        CODTIPOEXPED SMALLINT NOT NULL,
        CODPROCEXPED INTEGER NOT NULL,
        STATUSITEXPED CHAR(2) DEFAULT 'PE' NOT NULL,
        EMMANUT CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQITEXPEDICAOPK PRIMARY KEY (TICKET, CODITEXPED, CODFILIAL, CODEMP));

/* Table: EQITMODGRADE, Owner: SYSDBA */
CREATE TABLE EQITMODGRADE (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODMODG INTEGER NOT NULL,
        CODITMODG INTEGER NOT NULL,
        ORDEMITMODG INTEGER DEFAULT 0 NOT NULL,
        REFITMODG CHAR(6),
        CODEMPVG INTEGER NOT NULL,
        CODFILIALVG SMALLINT NOT NULL,
        CODVARG INTEGER NOT NULL,
        CODFABITMODG CHAR(6),
        CODBARITMODG CHAR(6),
        DESCITMODG CHAR(20) NOT NULL,
        DESCCOMPITMODG VARCHAR(50),
        PRECOITVARG DECIMAL(15, 5) DEFAULT 0 NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQITMODGRADEPK PRIMARY KEY (CODITMODG, CODMODG, CODFILIAL, CODEMP));

/* Table: EQITRECMERC, Owner: SYSDBA */
CREATE TABLE EQITRECMERC (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        TICKET INTEGER NOT NULL,
        CODITRECMERC INTEGER NOT NULL,
        DESCITRECMERC VARCHAR(1000),
        CODEMPPD INTEGER NOT NULL,
        CODFILIALPD SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        CODEMPNS INTEGER,
        CODFILIALNS SMALLINT,
        NUMSERIE VARCHAR(30),
        GARANTIA CHAR(1) DEFAULT 'N' NOT NULL,
        REFPROD VARCHAR(20) NOT NULL,
        CODEMPTP SMALLINT NOT NULL,
        CODFILIALTP SMALLINT NOT NULL,
        CODTIPORECMERC SMALLINT NOT NULL,
        CODPROCRECMERC INTEGER NOT NULL,
        MEDIAAMOSTRAGEM NUMERICDN              DEFAULT 0 NOT NULL,
        RENDAAMOSTRAGEM SMALLINT DEFAULT 0 NOT NULL,
        QTDITRECMERC NUMERICDN              
DEFAULT 1 NOT NULL,
        STATUSITRECMERC CHAR(2) DEFAULT 'PE' NOT NULL,
        DEFEITOITRECMERC VARCHAR(1000),
        CONDICOESITRECMERC VARCHAR(1000),
        SERVICOSOLICITRECMERC VARCHAR(1000),
        OBSITRECMERC VARCHAR(1000),
        PLACAVEICULO VARCHAR(10),
        NROFROTA VARCHAR(20),
        GARAGEM VARCHAR(20),
        EMMANUT CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQITRECMERCPK PRIMARY KEY (TICKET, CODITRECMERC, CODFILIAL, CODEMP));

/* Table: EQITRECMERCITCP, Owner: SYSDBA */
CREATE TABLE EQITRECMERCITCP (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        TICKET INTEGER NOT NULL,
        CODITRECMERC INTEGER NOT NULL,
        CODEMPCP INTEGER NOT NULL,
        CODFILIALCP SMALLINT NOT NULL,
        CODCOMPRA INTEGER NOT NULL,
        CODITCOMPRA SMALLINT NOT NULL,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQITRECMERCITCPPK PRIMARY KEY (TICKET, CODITRECMERC, CODFILIAL, CODEMP, CODEMPCP, CODFILIALCP, CODCOMPRA, CODITCOMPRA));

/* Table: EQITRECMERCITOS, Owner: SYSDBA */
CREATE TABLE EQITRECMERCITOS (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        TICKET INTEGER NOT NULL,
        CODITRECMERC INTEGER NOT NULL,
        CODITOS SMALLINT NOT NULL,
        CODEMPPD INTEGER NOT NULL,
        CODFILIALPD SMALLINT NOT NULL,
        CODPRODPD INTEGER NOT NULL,
        REFPRODPD VARCHAR(20) NOT NULL,
        CODEMPNS INTEGER,
        CODFILIALNS SMALLINT,
        NUMSERIE VARCHAR(30),
        QTDITOS NUMERICDN              DEFAULT 0 NOT NULL,
        OBSITOS VARCHAR(1000),
        STATUSITOS CHAR(2) DEFAULT 'PE' NOT NULL,
        GERARMA CHAR(1),
        GERACHAMADO CHAR(1) DEFAULT 'N',
        GERANOVO CHAR(1),
        EMMANUT CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQITRECMERITOSCPK PRIMARY KEY (TICKET, CODITRECMERC, CODITOS, CODFILIAL, CODEMP));

/* Table: EQITRECMERCITOSITORC, Owner: SYSDBA */
CREATE TABLE EQITRECMERCITOSITORC (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        TICKET INTEGER NOT NULL,
        CODITRECMERC INTEGER NOT NULL,
        CODITOS INTEGER NOT NULL,
        CODEMPOC INTEGER NOT NULL,
        CODFILIALOC SMALLINT NOT NULL,
        CODORC INTEGER NOT NULL,
        TIPOORC CHAR(1) NOT NULL,
        CODITORC SMALLINT NOT NULL,
        STATUS CHAR(2) DEFAULT 'EO' NOT NULL,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQITRECMERCITOSITORCPK PRIMARY KEY (TICKET, CODITRECMERC, CODFILIAL, CODEMP, CODEMPOC, CODFILIALOC, CODORC, TIPOORC, CODITORC, CODITOS));

/* Table: EQITRECMERCSERIE, Owner: SYSDBA */
CREATE TABLE EQITRECMERCSERIE (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        TICKET INTEGER NOT NULL,
        CODITRECMERC INTEGER NOT NULL,
        SEQITSERIE INTEGER NOT NULL,
        CODEMPPD INTEGER,
        CODFILIALPD SMALLINT,
        CODPROD INTEGER,
        NUMSERIE VARCHAR(30),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQITRECMERCSERIEPK PRIMARY KEY (TICKET, CODITRECMERC, SEQITSERIE, CODFILIAL, CODEMP));

/* Table: EQITRMA, Owner: SYSDBA */
CREATE TABLE EQITRMA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODRMA INTEGER NOT NULL,
        CODITRMA SMALLINT NOT NULL,
        CODEMPPD INTEGER NOT NULL,
        CODFILIALPD SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        QTDITRMA NUMERICDN NOT NULL,
        CODEMPAX INTEGER NOT NULL,
        CODFILIALAX SMALLINT NOT NULL,
        CODALMOX INTEGER,
        QTDAPROVITRMA NUMERICDN               DEFAULT 0 NOT NULL,
        QTDEXPITRMA NUMERICDN              DEFAULT 0 NOT NULL,
        CODEMPLE INTEGER,
        CODFILIALLE SMALLINT,
        CODLOTE VARCHAR(20),
        REFPROD VARCHAR(20) NOT NULL,
        DTAPROVITRMA DATE,
        DTAEXPITRMA DATE,
        PRECOITRMA NUMERICDN              DEFAULT 0 NOT NULL,
        SITITRMA CHAR(2) DEFAULT 'PE' NOT NULL,
        SITAPROVITRMA CHAR(2) DEFAULT 'PE' NOT NULL,
        SITEXPITRMA CHAR(2) DEFAULT 'PE' NOT NULL,
        MOTIVOCANCITRMA VARCHAR(10000),
        PRIORITRMA CHAR(1) DEFAULT 'B' NOT NULL,
        MOTIVOPRIORITRMA VARCHAR(10000),
        CODEMPOS INTEGER,
        CODFILIALOS SMALLINT,
        TICKET INTEGER,
        CODITRECMERC SMALLINT,
        CODITOS SMALLINT,
        EMMANUT CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQITRMAPK PRIMARY KEY (CODRMA, CODITRMA, CODFILIAL, CODEMP));

/* Table: EQITSIMILAR, Owner: SYSDBA */
CREATE TABLE EQITSIMILAR (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODSIM INTEGER NOT NULL,
        CODEMPPD INTEGER NOT NULL,
        CODFILIALPD SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        REFPROD VARCHAR(20) NOT NULL,
        EMMANUT CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE,
        HALT TIME,
        IDUSUALT CHAR(8),
CONSTRAINT EQITSIMILARPK PRIMARY KEY (CODPROD, CODFILIALPD, CODEMPPD, CODSIM, CODFILIAL, CODEMP));

/* Table: EQITVARGRADE, Owner: SYSDBA */
CREATE TABLE EQITVARGRADE (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODVARG INTEGER NOT NULL,
        SEQITVARG SMALLINT NOT NULL,
        DESCITVARG VARCHAR(50) NOT NULL,
        SIGLAITVARG VARCHAR(10) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT VARCHAR(128) DEFAULT USER,
CONSTRAINT EQITVARGRADEPK PRIMARY KEY (CODVARG, SEQITVARG, CODFILIAL, CODEMP));

/* Table: EQLANCTOEXP, Owner: SYSDBA */
CREATE TABLE EQLANCTOEXP (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODLEXP INTEGER NOT NULL,
        CODEMPTE INTEGER NOT NULL,
        CODFILIALTE SMALLINT NOT NULL,
        CODTIPOEXP INTEGER NOT NULL,
        CODEMPCL INTEGER NOT NULL,
        CODFILIALCL SMALLINT NOT NULL,
        CODCLI INTEGER NOT NULL,
        DTLEXP DATE NOT NULL,
        QTDLEXP INTEGER NOT NULL,
        DTRETLEXP DATE,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQLANCTOEXPPK PRIMARY KEY (CODLEXP, CODFILIAL, CODEMP));

/* Table: EQLOCDESCARGA, Owner: SYSDBA */
CREATE TABLE EQLOCDESCARGA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODLOCDESCARGA INTEGER NOT NULL,
        DESCLOCDESCARGA CHAR(40) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQLOCDESCARGAPK PRIMARY KEY (CODLOCDESCARGA, CODFILIAL, CODEMP));

/* Table: EQLOTE, Owner: SYSDBA */
CREATE TABLE EQLOTE (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        CODLOTE VARCHAR(20) NOT NULL,
        VENCTOLOTE DATE NOT NULL,
        SLDLOTE NUMERICDN,
        SLDRESLOTE NUMERICDN,
        SLDCONSIGLOTE NUMERICDN,
        SLDLIQLOTE NUMERICDN,
        QTDPRODLOTE NUMERICDN,
        DINILOTE DATE,
        DIASAVISOLOTE SMALLINT DEFAULT 0 NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQLOTEPK PRIMARY KEY (CODLOTE, CODPROD, CODFILIAL, CODEMP));

/* Table: EQMARCA, Owner: SYSDBA */
CREATE TABLE EQMARCA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODMARCA CHAR(6) NOT NULL,
        DESCMARCA CHAR(40) NOT NULL,
        SIGLAMARCA CHAR(20),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQMARCAPK PRIMARY KEY (CODMARCA, CODFILIAL, CODEMP));

/* Table: EQMODGRADE, Owner: SYSDBA */
CREATE TABLE EQMODGRADE (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODMODG INTEGER NOT NULL,
        CODEMPPD INTEGER NOT NULL,
        CODFILIALPD SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        DESCMODG CHAR(40) NOT NULL,
        DESCPRODMODG CHAR(20) NOT NULL,
        DESCCOMPPRODMODG VARCHAR(50),
        REFMODG CHAR(10) NOT NULL,
        CODFABMODG CHAR(10) NOT NULL,
        CODBARMODG CHAR(10) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQMODGRADEPK PRIMARY KEY (CODMODG, CODFILIAL, CODEMP));

/* Table: EQMODLOTE, Owner: SYSDBA */
CREATE TABLE EQMODLOTE (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODMODLOTE INTEGER NOT NULL,
        DESCMODLOTE CHAR(30) NOT NULL,
        TXAMODLOTE VARCHAR(100) NOT NULL,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQMODLOTEPK PRIMARY KEY (CODMODLOTE, CODFILIAL, CODEMP));

/* Table: EQMOVEXP, Owner: SYSDBA */
CREATE TABLE EQMOVEXP (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODMOVEXP INTEGER NOT NULL,
        CODEMPTE INTEGER NOT NULL,
        CODFILIALTE SMALLINT NOT NULL,
        CODTIPOEXP INTEGER NOT NULL,
        CODEMPCL INTEGER NOT NULL,
        CODFILIALCL SMALLINT NOT NULL,
        CODCLI INTEGER NOT NULL,
        DTSAIMOVEXP DATE NOT NULL,
        QTDMOVEXP INTEGER NOT NULL,
        DTENTMOVEXP DATE,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQMOVEXPPK PRIMARY KEY (CODMOVEXP, CODFILIAL, CODEMP));

/* Table: EQMOVPROD, Owner: SYSDBA */
CREATE TABLE EQMOVPROD (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODMOVPROD INTEGER NOT NULL,
        CODEMPPD INTEGER NOT NULL,
        CODFILIALPD SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        CODEMPVD INTEGER,
        CODFILIALVD SMALLINT,
        TIPOVENDA CHAR(1),
        CODVENDA INTEGER,
        CODITVENDA INTEGER,
        CODEMPLE INTEGER,
        CODFILIALLE SMALLINT,
        CODLOTE VARCHAR(20),
        CODEMPTM INTEGER NOT NULL,
        CODFILIALTM SMALLINT NOT NULL,
        CODTIPOMOV INTEGER NOT NULL,
        CODEMPCP INTEGER,
        CODFILIALCP SMALLINT,
        CODCOMPRA INTEGER,
        CODITCOMPRA INTEGER,
        CODEMPIV INTEGER,
        CODFILIALIV SMALLINT,
        CODINVPROD INTEGER,
        DTMOVPROD DATE NOT NULL,
        TIPOMOVPROD CHAR(1) NOT NULL,
        ESTOQMOVPROD CHAR(1) DEFAULT 'S' NOT NULL,
        CODEMPAX INTEGER NOT NULL,
        CODFILIALAX SMALLINT NOT NULL,
        CODALMOX INTEGER NOT NULL,
        QTDMOVPROD NUMERICDN NOT NULL,
        PRECOMOVPROD NUMERICDN,
        CUSTOMPMMOVPROD NUMERICDN              DEFAULT 0,
        CUSTOMPMMOVPRODAX NUMERICDN,
        SLDMOVPROD NUMERICDN,
        SLDMOVPRODAX NUMERICDN,
        FLAG CHAR(1) DEFAULT 'N',
        CODEMPNT INTEGER,
        CODFILIALNT SMALLINT,
        CODNAT CHAR(4),
        DOCMOVPROD INTEGER,
        CODEMPRM INTEGER,
        CODFILIALRM SMALLINT,
        CODRMA INTEGER,
        CODITRMA SMALLINT,
        EMMANUT CHAR(1) DEFAULT 'N',
        CODEMPOP INTEGER,
        CODFILIALOP SMALLINT,
        CODOP INTEGER,
        SEQOP SMALLINT,
        SEQENTOP SMALLINT,
        SEQSUBPROD SMALLINT,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQMOVPRODPK PRIMARY KEY (CODMOVPROD, CODFILIAL, CODEMP));

/* Table: EQMOVSERIE, Owner: SYSDBA */
CREATE TABLE EQMOVSERIE (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODMOVSERIE INTEGER NOT NULL,
        CODEMPPD INTEGER NOT NULL,
        CODFILIALPD SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        NUMSERIE VARCHAR(30) NOT NULL,
        CODEMPVD INTEGER,
        CODFILIALVD SMALLINT,
        TIPOVENDA CHAR(1),
        CODVENDA INTEGER,
        CODITVENDA INTEGER,
        CODEMPTM INTEGER,
        CODFILIALTM SMALLINT,
        CODTIPOMOV INTEGER,
        CODEMPCP INTEGER,
        CODFILIALCP SMALLINT,
        CODCOMPRA INTEGER,
        CODITCOMPRA INTEGER,
        CODEMPIV INTEGER,
        CODFILIALIV SMALLINT,
        CODINVPROD INTEGER,
        DTMOVSERIE DATE NOT NULL,
        TIPOMOVSERIE SMALLINT NOT NULL,
        CODEMPRM INTEGER,
        CODFILIALRM SMALLINT,
        DOCMOVSERIE INTEGER,
        CODRMA INTEGER,
        CODITRMA SMALLINT,
        CODEMPOP INTEGER,
        CODFILIALOP SMALLINT,
        CODOP INTEGER,
        SEQOP SMALLINT,
        CODLOTE VARCHAR(20),
        CODEMPLE INTEGER,
        CODFILIALLE SMALLINT,
        CODALMOX INTEGER,
        CODEMPAX INTEGER,
        CODFILIALAX SMALLINT,
        CODEMPRC INTEGER,
        CODFILIALRC SMALLINT,
        TICKET SMALLINT,
        CODITRECMERC SMALLINT,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUALT CHAR(8) DEFAULT USER,
        HALT TIME DEFAULT 'now',
        DTALT DATE DEFAULT 'now',
CONSTRAINT EQMOVSERIEPK PRIMARY KEY (CODMOVSERIE, CODFILIAL, CODEMP));

/* Table: EQPREVESTOQLOG, Owner: SYSDBA */
CREATE TABLE EQPREVESTOQLOG (ID BIGINT NOT NULL,
        CODEMP INTEGER,
        CODFILIAL SMALLINT,
        DTINI DATE NOT NULL,
        DTFIM DATE NOT NULL,
        CODEMPGP INTEGER,
        CODFILIALGP SMALLINT,
        CODGRUP CHAR(14),
        CODEMPPD INTEGER,
        CODFILIALPD SMALLINT,
        CODPROD INTEGER,
        ORDEM CHAR(1) DEFAULT 'V' NOT NULL,
        MERCADORIA_REVENDA CHAR(1) DEFAULT 'S' NOT NULL,
        MATERIA_PRIMA CHAR(1) DEFAULT 'S' NOT NULL,
        EM_PROCESSO CHAR(1) DEFAULT 'S' NOT NULL,
        OUTROS CHAR(1) DEFAULT 'S' NOT NULL,
        SUB_PRODUTO CHAR(1) DEFAULT 'S' NOT NULL,
        EQUIPAMENTO CHAR(1) DEFAULT 'S' NOT NULL,
        MATERIAL_CONSUMO CHAR(1) DEFAULT 'S' NOT NULL,
        PRODUTO_INTERMED CHAR(1) DEFAULT 'S' NOT NULL,
        PRODUTO_ACABADO CHAR(1) DEFAULT 'S' NOT NULL,
        EMBALAGEM CHAR(1) DEFAULT 'S' NOT NULL,
        OUTROS_INSUMOS CHAR(1) DEFAULT 'S' NOT NULL,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT VARCHAR(128) DEFAULT USER NOT NULL,
CONSTRAINT EQPREVESTOQLOG PRIMARY KEY (ID));

/* Table: EQPROCEXPED, Owner: SYSDBA */
CREATE TABLE EQPROCEXPED (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTIPOEXPED INTEGER NOT NULL,
        CODPROCEXPED INTEGER NOT NULL,
        DESCPROCEXPED CHAR(40) NOT NULL,
        TIPOPROCEXPED CHAR(2) NOT NULL,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT CHAR(8) DEFAULT USER NOT NULL,
CONSTRAINT EQPROCEXPEDPK PRIMARY KEY (CODTIPOEXPED, CODPROCEXPED, CODFILIAL, CODEMP));

/* Table: EQPROCRECMERC, Owner: SYSDBA */
CREATE TABLE EQPROCRECMERC (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTIPORECMERC INTEGER NOT NULL,
        CODPROCRECMERC INTEGER NOT NULL,
        DESCPROCRECMERC CHAR(40) NOT NULL,
        TIPOPROCRECMERC CHAR(2) NOT NULL,
        NROAMOSTPROCRECMERC SMALLINT DEFAULT 0 NOT NULL,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT CHAR(8) DEFAULT USER NOT NULL,
CONSTRAINT EQPROCMERCPK PRIMARY KEY (CODTIPORECMERC, CODPROCRECMERC, CODFILIAL, CODEMP));

/* Table: EQPRODACESSO, Owner: SYSDBA */
CREATE TABLE EQPRODACESSO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        TIPOPA CHAR(3) NOT NULL,
        CODPA INTEGER NOT NULL,
        CODEMPCC INTEGER,
        CODFILIALCC SMALLINT,
        ANOCC SMALLINT,
        CODCC CHAR(19),
        CODEMPCX INTEGER,
        CODFILIALCX SMALLINT,
        CODCAIXA INTEGER,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE,
        HALT TIME,
        IDUSUALT CHAR(8),
CONSTRAINT EQPRODACESSOPK PRIMARY KEY (CODPROD, CODPA, TIPOPA, CODFILIAL, CODEMP));

/* Table: EQPRODPLAN, Owner: SYSDBA */
CREATE TABLE EQPRODPLAN (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        SEQPP SMALLINT NOT NULL,
        TIPOPP CHAR(1) NOT NULL,
        CODEMPPN INTEGER NOT NULL,
        CODFILIALPN SMALLINT NOT NULL,
        CODPLAN CHAR(13) NOT NULL,
        CODEMPCC INTEGER NOT NULL,
        CODFILIALCC SMALLINT NOT NULL,
        ANOCC SMALLINT NOT NULL,
        CODCC CHAR(19) NOT NULL,
        PERCPP NUMERIC(6, 2) DEFAULT 0 NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE,
        HALT TIME,
        IDUSUALT CHAR(8),
CONSTRAINT EQPRODPLANPK PRIMARY KEY (CODPROD, CODFILIAL, CODEMP, SEQPP));

/* Table: EQPRODUTO, Owner: SYSDBA */
CREATE TABLE EQPRODUTO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        DESCPROD CHAR(100) NOT NULL,
        REFPROD VARCHAR(20) NOT NULL,
        CODEMPAX INTEGER NOT NULL,
        CODFILIALAX SMALLINT NOT NULL,
        CODALMOX INTEGER NOT NULL,
        CODEMPMA INTEGER NOT NULL,
        CODFILIALMA SMALLINT NOT NULL,
        CODMOEDA CHAR(4) NOT NULL,
        CODEMPUD INTEGER NOT NULL,
        CODFILIALUD SMALLINT NOT NULL,
        CODUNID VARCHAR(20) NOT NULL,
        CODEMPFC INTEGER NOT NULL,
        CODFILIALFC SMALLINT NOT NULL,
        CODFISC CHAR(13) NOT NULL,
        CODEMPMC INTEGER NOT NULL,
        CODFILIALMC SMALLINT NOT NULL,
        CODMARCA CHAR(6) NOT NULL,
        DESCAUXPROD CHAR(40),
        TIPOPROD VARCHAR(2) NOT NULL,
        CVPROD CHAR(1) NOT NULL,
        CODEMPGP INTEGER NOT NULL,
        CODFILIALGP SMALLINT NOT NULL,
        CODGRUP CHAR(14) NOT NULL,
        CODBARPROD CHAR(15),
        CLOTEPROD CHAR(1) NOT NULL,
        SERIEPROD CHAR(1) DEFAULT 'N' NOT NULL,
        CODFABPROD CHAR(15),
        COMISPROD NUMERIC(6, 2),
        PESOLIQPROD NUMERIC(10, 3),
        PESOBRUTPROD NUMERIC(10, 3),
        QTDMINPROD NUMERICDN,
        QTDMAXPROD NUMERICDN,
        DTMPMPROD DATE,
        CUSTOMPMPROD NUMERICDN              DEFAULT 0,
        CUSTOPEPSPROD NUMERICDN              DEFAULT 0,
        CUSTOINFOPROD NUMERICDN,
        PRECOBASEPROD NUMERICDN,
        PRECOCOMISPROD NUMERICDN,
        SLDPROD NUMERICDN,
        SLDRESPROD NUMERICDN,
        SLDCONSIGPROD NUMERICDN,
        SLDLIQPROD NUMERICDN,
        ATIVOPROD CHAR(1) DEFAULT 'S',
        DTULTCPPROD DATE,
        QTDULTCPPROD NUMERICDN,
        DESCCOMPPROD VARCHAR(500),
        OBSPROD VARCHAR(10000),
        VERIFPROD CHAR(1) DEFAULT 'S',
        LOCALPROD CHAR(15),
        RMAPROD CHAR(1) DEFAULT 'N' NOT NULL,
        CODEMPPE INTEGER,
        CODFILIALPE SMALLINT,
        CODPE INTEGER,
        CODEMPCC INTEGER,
        CODFILIALCC SMALLINT,
        ANOCC SMALLINT,
        CODCC CHAR(19),
        USARECEITAPROD CHAR(1) DEFAULT 'N' NOT NULL,
        USATELAADICPDV CHAR(1) DEFAULT 'N' NOT NULL,
        VLRDENSIDADE NUMERIC(15, 5),
        VLRCONCENT NUMERIC(15, 5),
        COMPRIMENTO NUMERICDN,
        LARGURA NUMERICDN,
        ESPESSURA NUMERICDN,
        GUIATRAFPROD CHAR(1) DEFAULT 'N' NOT NULL,
        QTDEMBALAGEM NUMERICDN              DEFAULT 1 NOT NULL,
        CODEANPROD VARCHAR(14),
        CUBAGEM NUMERICDN,
        CODEMPSC INTEGER,
        CODFILIALSC SMALLINT,
        CODSECAO VARCHAR(13),
        CODEMPTC SMALLINT,
        CODFILIALTC SMALLINT,
        CODTPCHAMADO INTEGER,
        QTDHORASSERV NUMERICDN,
        NRODIASVALID SMALLINT,
        DESCCLI CHAR(1),
        QTDPORPLANO SMALLINT,
        NROPLANOS SMALLINT,
        CERTFSC CHAR(1) DEFAULT 'N',
        FATORFSC NUMERICDN,
        CODEMPOG INTEGER,
        CODFILIALOG SMALLINT,
        CODPRODOG INTEGER,
        CODEMPMG INTEGER,
        CODFILIALMG SMALLINT,
        CODMODG INTEGER,
        PRAZOREPO INTEGER,
        MEDIAVENDA NUMERIC(15, 5),
        EMMANUT CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQPRODUTOPK PRIMARY KEY (CODPROD, CODFILIAL, CODEMP));

/* Table: EQPRODUTOLOG, Owner: SYSDBA */
CREATE TABLE EQPRODUTOLOG (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        PRECOBASEPRODANT NUMERICDN NOT NULL,
        PRECOBASEPRODNOVO NUMERICDN NOT NULL,
        SEQLOG INTEGER NOT NULL,
        PRECOPROC CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER);

/* Table: EQRECAMOSTRAGEM, Owner: SYSDBA */
CREATE TABLE EQRECAMOSTRAGEM (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        TICKET INTEGER NOT NULL,
        CODITRECMERC INTEGER NOT NULL,
        CODAMOSTRAGEM INTEGER NOT NULL,
        PESOAMOST NUMERICDN              DEFAULT 0 NOT NULL,
        PESOAMOST2 NUMERICDN              DEFAULT 0 NOT NULL,
        DATAAMOST DATE default 'today' NOT NULL,
        HORAAMOST TIME default 'now' NOT NULL,
        SEQAMOSTRAGEM INTEGER DEFAULT 0 NOT NULL,
        IMPUREZA NUMERICDN,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQRECAMOSTRAGEMPK PRIMARY KEY (TICKET, CODITRECMERC, CODAMOSTRAGEM, CODFILIAL, CODEMP));

/* Table: EQRECMERC, Owner: SYSDBA */
CREATE TABLE EQRECMERC (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        TICKET INTEGER NOT NULL,
        PLACAVEICULO CHAR(7),
        CODEMPPD INTEGER,
        CODFILIALPD SMALLINT,
        CODPROD INTEGER,
        REFPROD VARCHAR(20),
        CODEMPFR INTEGER,
        CODFILIALFR SMALLINT,
        CODFOR INTEGER,
        CODEMPTR INTEGER NOT NULL,
        CODFILIALTR SMALLINT NOT NULL,
        CODTIPORECMERC INTEGER NOT NULL,
        CODEMPTN INTEGER,
        CODFILIALTN SMALLINT,
        CODTRAN INTEGER,
        IDUSUALT CHAR(8) DEFAULT USER,
        CODBAIRRO INTEGER,
        CODMUNIC CHAR(7),
        SIGLAUF CHAR(2),
        CODPAIS SMALLINT,
        STATUS CHAR(2) DEFAULT 'PE' NOT NULL,
        TIPOFRETE CHAR(1) DEFAULT 'C' NOT NULL,
        DTENT DATE DEFAULT 'today' NOT NULL,
        DTPREVRET DATE,
        DOCRECMERC INTEGER,
        CODEMPVD INTEGER,
        CODFILIALVD SMALLINT,
        CODVEND INTEGER,
        CODEMPCL INTEGER,
        CODFILIALCL SMALLINT,
        CODCLI INTEGER,
        CODEMPAR INTEGER,
        CODFILIALAR SMALLINT,
        CODATENDREC INTEGER,
        SOLICITANTE CHAR(50),
        MEDIAAMOSTRAGEM NUMERICDN,
        RENDAAMOSTRAGEM SMALLINT,
        CODEMPAX INTEGER,
        CODFILIALAX SMALLINT,
        CODALMOX INTEGER,
        OBSRECMERC CHAR(1000),
        DESCONTO NUMERICDN,
        EMMANUT CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
CONSTRAINT QRECEPMERCPK PRIMARY KEY (TICKET, CODFILIAL, CODEMP));

/* Table: EQRMA, Owner: SYSDBA */
CREATE TABLE EQRMA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODRMA INTEGER NOT NULL,
        IDUSU CHAR(8) NOT NULL,
        CODEMPTM INTEGER NOT NULL,
        CODFILIALTM SMALLINT NOT NULL,
        CODTIPOMOV INTEGER NOT NULL,
        MOTIVORMA VARCHAR(10000),
        MOTIVOCANCRMA VARCHAR(10000),
        SITRMA CHAR(2) DEFAULT 'PE' NOT NULL,
        CODEMPCC INTEGER NOT NULL,
        CODFILIALCC SMALLINT NOT NULL,
        ANOCC SMALLINT NOT NULL,
        CODCC CHAR(19) NOT NULL,
        CODEMPUU INTEGER NOT NULL,
        CODFILIALUU SMALLINT NOT NULL,
        DTAREQRMA DATE DEFAULT 'today' NOT NULL,
        DTAEXPRMA DATE,
        SITAPROVRMA CHAR(2) DEFAULT 'PE' NOT NULL,
        SITEXPRMA CHAR(2) DEFAULT 'PE' NOT NULL,
        IDUSUAPROV CHAR(8),
        CODEMPUA INTEGER,
        CODFILIALUA SMALLINT,
        IDUSUEXP CHAR(8),
        CODEMPUE INTEGER,
        CODFILIALUE SMALLINT,
        DTAAPROVRMA DATE,
        CODEMPOF INTEGER,
        CODFILIALOF SMALLINT,
        CODOP INTEGER,
        SEQOP SMALLINT,
        SEQOF SMALLINT,
        CODEMPCT INTEGER,
        CODFILIALCT SMALLINT,
        CODCONTR INTEGER,
        CODITCONTR SMALLINT,
        CODEMPOS INTEGER,
        CODFILIALOS SMALLINT,
        TICKET INTEGER,
        CODITRECMERC SMALLINT,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQRMAPK PRIMARY KEY (CODRMA, CODFILIAL, CODEMP));

/* Table: EQRMAAL, Owner: SYSDBA */
CREATE TABLE EQRMAAL (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODRMA INTEGER NOT NULL,
        TIPORMAAL CHAR(1) DEFAULT 'L' NOT NULL,
        CODEMPUU INTEGER NOT NULL,
        CODFILIALUU SMALLINT NOT NULL,
        IDUSU CHAR(8) NOT NULL,
        DTINS DATE DEFAULT 'today',
        HINS TIME DEFAULT 'now',
        IDUSUINS CHAR(8) DEFAULT USER,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQRMAALPK PRIMARY KEY (CODRMA, TIPORMAAL, CODFILIAL, CODEMP, IDUSU, CODFILIALUU, CODEMPUU));

/* Table: EQSALDOLOTE, Owner: SYSDBA */
CREATE TABLE EQSALDOLOTE (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        CODLOTE VARCHAR(20) NOT NULL,
        CODEMPAX INTEGER NOT NULL,
        CODFILIALAX SMALLINT NOT NULL,
        CODALMOX INTEGER NOT NULL,
        SLDLOTE NUMERICDN               DEFAULT 0 NOT NULL,
        SLDRESLOTE NUMERICDN               DEFAULT 0 NOT NULL,
        SLDCONSIGLOTE NUMERICDN               DEFAULT 0 NOT NULL,
        SLDLIQLOTE NUMERICDN               DEFAULT 0 NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQSALDOLOTEPK PRIMARY KEY (CODLOTE, CODPROD, CODFILIAL, CODEMP, CODALMOX, CODFILIALAX, CODEMPAX));

/* Table: EQSALDOPROD, Owner: SYSDBA */
CREATE TABLE EQSALDOPROD (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        CODEMPAX INTEGER NOT NULL,
        CODFILIALAX SMALLINT NOT NULL,
        CODALMOX INTEGER NOT NULL,
        SLDPROD NUMERICDN              DEFAULT 0 NOT NULL,
        SLDRESPROD NUMERICDN              DEFAULT 0 NOT NULL,
        SLDCONSIGPROD NUMERICDN              DEFAULT 0 NOT NULL,
        SLDLIQPROD NUMERICDN              DEFAULT 0 NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQSALDOPRODPK PRIMARY KEY (CODPROD, CODFILIAL, CODEMP, CODALMOX, CODFILIALAX, CODEMPAX));

/* Table: EQSECAO, Owner: SYSDBA */
CREATE TABLE EQSECAO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODSECAO VARCHAR(13) NOT NULL,
        DESCSECAO CHAR(50) NOT NULL,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQSECAOPK PRIMARY KEY (CODSECAO, CODFILIAL, CODEMP));

/* Table: EQSERIE, Owner: SYSDBA */
CREATE TABLE EQSERIE (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        NUMSERIE VARCHAR(30) NOT NULL,
        DTFABRICSERIE DATE,
        DTVALIDSERIE DATE,
        OBSSERIE VARCHAR(500),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQSERIEPK PRIMARY KEY (NUMSERIE, CODPROD, CODFILIAL, CODEMP));

/* Table: EQSIMILAR, Owner: SYSDBA */
CREATE TABLE EQSIMILAR (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODSIM INTEGER NOT NULL,
        DESCSIM CHAR(50) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQSIMILARPK PRIMARY KEY (CODSIM, CODFILIAL, CODEMP));

/* Table: EQTIPOEXP, Owner: SYSDBA */
CREATE TABLE EQTIPOEXP (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTIPOEXP INTEGER NOT NULL,
        DESCTIPOEXP CHAR(40) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQTIPOEXPPK PRIMARY KEY (CODTIPOEXP, CODFILIAL, CODEMP));

/* Table: EQTIPOEXPEDICAO, Owner: SYSDBA */
CREATE TABLE EQTIPOEXPEDICAO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTIPOEXPED INTEGER NOT NULL,
        DESCTIPOEXPED CHAR(40),
        TIPOEXPED CHAR(2) DEFAULT 'CO' NOT NULL,
        CODEMPTM INTEGER,
        CODFILIALTM SMALLINT,
        CODTIPOMOV INTEGER,
        CODEMPPD INTEGER,
        CODFILIALPD SMALLINT,
        CODPROD INTEGER,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQTIPOEXPEDPK PRIMARY KEY (CODTIPOEXPED, CODFILIAL, CODEMP));

/* Table: EQTIPOMOV, Owner: SYSDBA */
CREATE TABLE EQTIPOMOV (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTIPOMOV INTEGER NOT NULL,
        CODEMPMN INTEGER NOT NULL,
        CODFILIALMN SMALLINT NOT NULL,
        CODMODNOTA INTEGER NOT NULL,
        CODEMPSE INTEGER NOT NULL,
        CODFILIALSE SMALLINT NOT NULL,
        SERIE CHAR(4) NOT NULL,
        CODEMPSC INTEGER,
        CODFILIALSC SMALLINT,
        SERIEC CHAR(4),
        DESCTIPOMOV CHAR(40) NOT NULL,
        ESTIPOMOV CHAR(1) NOT NULL,
        FISCALTIPOMOV CHAR(1) NOT NULL,
        ESTOQTIPOMOV CHAR(1) NOT NULL,
        TIPOMOV CHAR(2) NOT NULL,
        CODEMPTB INTEGER,
        CODFILIALTB SMALLINT,
        CODTAB INTEGER,
        ESPECIETIPOMOV CHAR(4),
        CODEMPTM INTEGER,
        CODFILIALTM SMALLINT,
        CODTIPOMOVTM INTEGER,
        CODEMPTC INTEGER,
        CODFILIALTC SMALLINT,
        CODTIPOMOVTC INTEGER,
        IMPPEDTIPOMOV CHAR(1) DEFAULT 'N' NOT NULL,
        IMPNFTIPOMOV CHAR(1) DEFAULT 'N' NOT NULL,
        IMPBOLTIPOMOV CHAR(1) DEFAULT 'N' NOT NULL,
        IMPRECTIPOMOV CHAR(1) DEFAULT 'N' NOT NULL,
        REIMPNFTIPOMOV CHAR(1) DEFAULT 'N' NOT NULL,
        TUSUTIPOMOV CHAR(1) DEFAULT 'S' NOT NULL,
        SOMAVDTIPOMOV CHAR(1) DEFAULT 'N',
        SEQNFTIPOMOV CHAR(1) DEFAULT 'N' NOT NULL,
        VLRMFINTIPOMOV CHAR(1) DEFAULT 'N' NOT NULL,
        MCOMISTIPOMOV CHAR(1) DEFAULT 'N' NOT NULL,
        OPERTIPOMOV CHAR(1) DEFAULT 'C' NOT NULL,
        CTIPOFRETE CHAR(1) DEFAULT 'C',
        CODEMPRC INTEGER,
        CODFILIALRC SMALLINT,
        CODREGRCOMIS INTEGER,
        CODEMPTN INTEGER,
        CODFILIALTN SMALLINT,
        CODTRAN INTEGER,
        EMITNFCPMOV CHAR(1) DEFAULT 'N' NOT NULL,
        CODEMPDF INTEGER,
        CODFILIALDF SMALLINT,
        CODMODDOCFISC CHAR(3),
        CODEMPPP INTEGER,
        CODFILIALPP SMALLINT,
        CODPLANOPAG INTEGER,
        DESCNATCOMPL VARCHAR(60),
        CODEMPMC INTEGER,
        CODFILIALMC SMALLINT,
        CODMENS INTEGER,
        DESBLOQCV CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQTIPOMOVPK PRIMARY KEY (CODTIPOMOV, CODFILIAL, CODEMP));

/* Table: EQTIPOMOVUSU, Owner: SYSDBA */
CREATE TABLE EQTIPOMOVUSU (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTIPOMOV INTEGER NOT NULL,
        CODEMPUS INTEGER NOT NULL,
        CODFILIALUS SMALLINT NOT NULL,
        IDUSU CHAR(8) NOT NULL,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQTIPOMOVUSUPK PRIMARY KEY (CODTIPOMOV, CODFILIAL, CODEMP, IDUSU, CODFILIALUS, CODEMPUS));

/* Table: EQTIPORECMERC, Owner: SYSDBA */
CREATE TABLE EQTIPORECMERC (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTIPORECMERC INTEGER NOT NULL,
        DESCTIPORECMERC CHAR(40),
        TIPORECMERC CHAR(2) DEFAULT 'CO' NOT NULL,
        CODEMPTC INTEGER,
        CODFILIALTC SMALLINT,
        CODTIPOMOVCP INTEGER,
        CODEMPPD INTEGER,
        CODFILIALPD SMALLINT,
        CODPROD INTEGER,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQTIPORECMERCPK PRIMARY KEY (CODTIPORECMERC, CODFILIAL, CODEMP));

CREATE TABLE EQTROCAREFPROD (ID BIGINT NOT NULL,
        CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        MOTIVO VARCHAR(80),
        DTTROCA DATE DEFAULT 'now' NOT NULL,
        SITUACAO CHAR(2) DEFAULT 'PE' NOT NULL, 
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT VARCHAR(128) DEFAULT USER,
CONSTRAINT EQTROCAREFPRODPK PRIMARY KEY (ID));

CREATE TABLE EQITTROCAREFPROD (ID_IT BIGINT NOT NULL,
        ID BIGINT NOT NULL,
        DTEXEC DATE DEFAULT 'now' NOT NULL,
        CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODEMPPD INTEGER NOT NULL,
        CODFILIALPD SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        REFPRODOLD VARCHAR(20) NOT NULL,
        REFPRODNEW VARCHAR(20) NOT NULL,
        SITUACAO CHAR(2) DEFAULT 'PE' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT VARCHAR(128) DEFAULT USER,
CONSTRAINT EQITTROCAREFPRODPK PRIMARY KEY (ID_IT));

CREATE TABLE EQITTROCARPLOG (ID BIGINT NOT NULL,
        ID_IT_TROCA BIGINT NOT NULL,
        DTEXEC DATE DEFAULT 'now' NOT NULL,
        HEXEC TIME DEFAULT 'now' NOT NULL,
        SITUACAO CHAR(2) DEFAULT 'OK' NOT NULL,
        TABELA VARCHAR(50) DEFAULT '' NOT NULL,
        MENSAGEM VARCHAR(2000),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT VARCHAR(128) DEFAULT USER,
CONSTRAINT EQITTROCARPLOGPK PRIMARY KEY (ID));

/* Table: EQUNIDADE, Owner: SYSDBA */
CREATE TABLE EQUNIDADE (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODUNID VARCHAR(20) NOT NULL,
        DESCUNID VARCHAR(60) NOT NULL,
        CASASDEC SMALLINT DEFAULT 2 NOT NULL,
        CALCVOLEMB CHAR(1),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQUNIDADEPK PRIMARY KEY (CODUNID, CODFILIAL, CODEMP));

/* Table: EQVARGRADE, Owner: SYSDBA */
CREATE TABLE EQVARGRADE (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODVARG INTEGER NOT NULL,
        DESCVARG CHAR(30) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT EQVARGRADEPK PRIMARY KEY (CODVARG, CODFILIAL, CODEMP));

/* Table: FNBANCO, Owner: SYSDBA */
CREATE TABLE FNBANCO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODBANCO CHAR(3) NOT NULL,
        NOMEBANCO CHAR(40) NOT NULL,
        DVBANCO CHAR(1) DEFAULT '' NOT NULL,
        SITEBANCO VARCHAR(80) DEFAULT '',
        CODEMPMB INTEGER,
        CODFILIALMB INTEGER,
        CODMODBOL INTEGER,
        IMGBOLBANCO BLOB SUB_TYPE 0 SEGMENT SIZE 80,
        IMGBOLBANCO2 BLOB SUB_TYPE 0 SEGMENT SIZE 80,
        LAYOUTCHEQBANCO VARCHAR(1000),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT FNBANCOPK PRIMARY KEY (CODBANCO, CODFILIAL, CODEMP));

/* Table: FNBORDERO, Owner: SYSDBA */
CREATE TABLE FNBORDERO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODBOR INTEGER NOT NULL,
        DTBOR DATE NOT NULL,
        OBSBOR VARCHAR(300),
        CODEMPCC INTEGER NOT NULL,
        CODFILIALCC INTEGER NOT NULL,
        NUMCONTA CHAR(10) NOT NULL,
        CODEMPCB INTEGER NOT NULL,
        CODFILIALCB SMALLINT NOT NULL,
        NUMCONTABOR CHAR(10) NOT NULL,
        STATUSBOR CHAR(2) DEFAULT 'BA' NOT NULL,
        DTINI DATE DEFAULT 'now',
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT PK_FNBORDERO PRIMARY KEY (CODBOR, CODFILIAL, CODEMP));

/* Table: FNCARTCOB, Owner: SYSDBA */
CREATE TABLE FNCARTCOB (CODEMPBO INTEGER NOT NULL,
        CODFILIALBO SMALLINT NOT NULL,
        CODBANCO CHAR(3) NOT NULL,
        CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCARTCOB CHAR(3) NOT NULL,
        VARIACAOCARTCOB CHAR(10),
        DESCCARTCOB VARCHAR(50) NOT NULL,
        CARTCOBCNAB CHAR(3) NOT NULL,
        CODCARTCOBCNAB CHAR(1),
        CONVCOB VARCHAR(20),
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT FNCARTCOBPK PRIMARY KEY (CODCARTCOB, CODFILIAL, CODEMP, CODBANCO, CODFILIALBO, CODEMPBO));

/* Table: FNCC, Owner: SYSDBA */
CREATE TABLE FNCC (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        ANOCC SMALLINT NOT NULL,
        CODCC CHAR(19) NOT NULL,
        DESCCC CHAR(50) NOT NULL,
        NIVELCC INTEGER NOT NULL,
        CODREDCC INTEGER,
        CODEMPSCC INTEGER,
        CODFILIALSCC SMALLINT,
        ANOSCC SMALLINT,
        CODSUBCC CHAR(19),
        SIGLACC CHAR(10) DEFAULT '' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT FNCCPK PRIMARY KEY (CODCC, ANOCC, CODFILIAL, CODEMP));

/* Table: FNCHEQUE, Owner: SYSDBA */
CREATE TABLE FNCHEQUE (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODEMPBO INTEGER NOT NULL,
        SEQCHEQ INTEGER NOT NULL,
        CODFILIALBO SMALLINT NOT NULL,
        CODBANC CHAR(3) NOT NULL,
        AGENCIACHEQ VARCHAR(7) NOT NULL,
        CONTACHEQ VARCHAR(10) NOT NULL,
        NUMCHEQ INTEGER NOT NULL,
        NOMEEMITCHEQ VARCHAR(50) NOT NULL,
        NOMEFAVCHEQ VARCHAR(50) NOT NULL,
        DTEMITCHEQ DATE DEFAULT 'today' NOT NULL,
        DTVENCTOCHEQ DATE DEFAULT 'today' NOT NULL,
        DTCOMPCHEQ DATE DEFAULT 'today',
        TIPOCHEQ CHAR(2) DEFAULT 'PF' NOT NULL,
        PREDATCHEQ CHAR(1) DEFAULT 'N',
        SITCHEQ CHAR(2) DEFAULT 'CA' NOT NULL,
        VLRCHEQ NUMERIC(15, 5) DEFAULT 0 NOT NULL,
        HISTCHEQ VARCHAR(500) NOT NULL,
        CNPJEMITCHEQ VARCHAR(14),
        CPFEMITCHEQ VARCHAR(11),
        CNPJFAVCHEQ VARCHAR(14),
        CPFFAVCHEQ VARCHAR(11),
        DDDFAVCHEQ VARCHAR(4),
        DDDEMITCHEQ VARCHAR(4),
        FONEEMITCHEQ VARCHAR(9),
        FONEFAVCHEQ VARCHAR(9),
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT user NOT NULL,
        DTALT DATE DEFAULT 'today' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT VARCHAR(128) DEFAULT user NOT NULL,
CONSTRAINT FNCHEQUEPK PRIMARY KEY (SEQCHEQ, CODFILIAL, CODEMP));

/* Table: FNCONTA, Owner: SYSDBA */
CREATE TABLE FNCONTA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        NUMCONTA CHAR(10) NOT NULL,
        DESCCONTA CHAR(50) NOT NULL,
        CODEMPMA INTEGER NOT NULL,
        CODFILIALMA SMALLINT NOT NULL,
        CODMOEDA CHAR(4) NOT NULL,
        CODEMPBO INTEGER,
        CODFILIALBO SMALLINT,
        CODBANCO CHAR(3),
        CODEMPPN INTEGER NOT NULL,
        CODFILIALPN SMALLINT NOT NULL,
        CODPLAN CHAR(13) NOT NULL,
        TIPOCONTA CHAR(1) NOT NULL,
        DATACONTA DATE NOT NULL,
        CODEMPHP INTEGER,
        CODFILIALHP SMALLINT,
        CODHIST INTEGER,
        CODCONTDEB VARCHAR(20),
        CODCONTCRED VARCHAR(20),
        AGENCIACONTA CHAR(6),
        CONVCOBCONTA VARCHAR(20),
        ATIVACONTA CHAR(1) DEFAULT 'S' NOT NULL,
        TUSUCONTA CHAR(1) DEFAULT 'S' NOT NULL,
        TIPOCAIXA CHAR(1) DEFAULT 'F' NOT NULL,
        POSTOCONTA CHAR(2),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT FNCONTAPK PRIMARY KEY (NUMCONTA, CODFILIAL, CODEMP),
CONSTRAINT FNCONTAUNIQFNPLANEJA UNIQUE (CODEMPPN, CODFILIALPN, CODPLAN));

/* Table: FNCONTAUSU, Owner: SYSDBA */
CREATE TABLE FNCONTAUSU (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        NUMCONTA CHAR(10) NOT NULL,
        CODEMPUS INTEGER NOT NULL,
        CODFILIALUS SMALLINT NOT NULL,
        IDUSU CHAR(8) NOT NULL,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT FNCONTAUSUPK PRIMARY KEY (NUMCONTA, CODFILIAL, CODEMP, IDUSU, CODFILIALUS, CODEMPUS));

/* Table: FNCONTAVINCULADA, Owner: SYSDBA */
CREATE TABLE FNCONTAVINCULADA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        NUMCONTA CHAR(10) NOT NULL,
        CODEMPCV INTEGER NOT NULL,
        CODFILIALCV SMALLINT NOT NULL,
        NUMCONTACV CHAR(10) NOT NULL,
        CONTACHEQUE CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT FNCONTAVINCULADAPK PRIMARY KEY (NUMCONTA, CODFILIAL, CODEMP, NUMCONTACV, CODFILIALCV, CODEMPCV));

/* Table: FNCOTMOEDA, Owner: SYSDBA */
CREATE TABLE FNCOTMOEDA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODMOEDA CHAR(4) NOT NULL,
        DATACOT DATE NOT NULL,
        VALORCOT NUMERICDN NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT FNCOTMOEDAPK PRIMARY KEY (DATACOT, CODMOEDA, CODFILIAL, CODEMP));

/* Table: FNFBNCLI, Owner: SYSDBA */
CREATE TABLE FNFBNCLI (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCLI INTEGER NOT NULL,
        CODEMPPF INTEGER NOT NULL,
        CODFILIALPF SMALLINT NOT NULL,
        CODEMPBO INTEGER NOT NULL,
        CODFILIALBO SMALLINT NOT NULL,
        CODBANCO CHAR(3) NOT NULL,
        TIPOFEBRABAN CHAR(2) NOT NULL,
        NUMCONTACLI CHAR(10),
        AGENCIACLI VARCHAR(9),
        IDENTCLI VARCHAR(14) NOT NULL,
        STIPOFEBRABAN CHAR(2) DEFAULT '02' NOT NULL,
        TIPOREMCLI CHAR(1) DEFAULT 'B' NOT NULL,
        CODEMPCA INTEGER,
        CODFILIALCA SMALLINT,
        NUMCONTA CHAR(10),
        CODEMPPN INTEGER,
        CODFILIALPN SMALLINT,
        CODPLAN CHAR(13),
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT FNFBNCLIPK PRIMARY KEY (CODCLI, CODFILIAL, CODEMP, CODBANCO, CODFILIALBO, CODEMPBO, CODFILIALPF, CODEMPPF, TIPOFEBRABAN));

/* Table: FNFBNCODRET, Owner: SYSDBA */
CREATE TABLE FNFBNCODRET (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODEMPBO INTEGER NOT NULL,
        CODFILIALBO SMALLINT NOT NULL,
        CODBANCO CHAR(3) NOT NULL,
        TIPOFEBRABAN CHAR(2) NOT NULL,
        CODRET VARCHAR(4) NOT NULL,
        DESCRET VARCHAR(100) NOT NULL,
        TIPORET CHAR(2) DEFAULT 'IN' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT CHAR(8) DEFAULT USER NOT NULL,
CONSTRAINT FNFBNCODRETPK PRIMARY KEY (CODRET, TIPOFEBRABAN, CODBANCO, CODFILIALBO, CODEMPBO, CODFILIAL, CODEMP));

/* Table: FNFBNREC, Owner: SYSDBA */
CREATE TABLE FNFBNREC (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODREC INTEGER NOT NULL,
        NPARCITREC INTEGER NOT NULL,
        CODEMPPF INTEGER NOT NULL,
        CODFILIALPF SMALLINT NOT NULL,
        CODEMPBO INTEGER NOT NULL,
        CODFILIALBO SMALLINT NOT NULL,
        CODBANCO CHAR(3) NOT NULL,
        TIPOFEBRABAN CHAR(2) NOT NULL,
        STIPOFEBRABAN CHAR(2) NOT NULL,
        SITREMESSA CHAR(2) DEFAULT '00' NOT NULL,
        SITRETORNO CHAR(2) DEFAULT '00' NOT NULL,
        NOMEARQUIVO VARCHAR(200),
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT FNFBNRECPK PRIMARY KEY (CODREC, NPARCITREC, CODFILIAL, CODEMP));

/* Table: FNFINALIDADE, Owner: SYSDBA */
CREATE TABLE FNFINALIDADE (CODFIN VARCHAR(3) NOT NULL,
        DESCFIN VARCHAR(50) NOT NULL,
        ESFIN CHAR(1) default 'S' NOT NULL,
        CLASFIN CHAR(1) default 'O' NOT NULL,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT FNFINALIDADEPK PRIMARY KEY (CODFIN));

/* Table: FNHISTPAD, Owner: SYSDBA */
CREATE TABLE FNHISTPAD (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODHIST INTEGER NOT NULL,
        DESCHIST VARCHAR(80) NOT NULL,
        TXAHISTPAD VARCHAR(500) DEFAULT '' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT CHAR(8) DEFAULT USER NOT NULL,
CONSTRAINT FNHISTPADPK PRIMARY KEY (CODHIST, CODFILIAL, CODEMP));

/* Table: FNITBORDERO, Owner: SYSDBA */
CREATE TABLE FNITBORDERO (CODEMP INTEGER NOT NULL,
        CODFILIAL INTEGER NOT NULL,
        CODBOR INTEGER NOT NULL,
        CODEMPRC INTEGER NOT NULL,
        CODFILIALRC INTEGER NOT NULL,
        CODREC INTEGER NOT NULL,
        NPARCITREC INTEGER NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT PK_FNITBORDERO PRIMARY KEY (CODBOR, CODFILIAL, CODEMP, CODREC, NPARCITREC, CODFILIALRC, CODEMPRC));

/* Table: FNITFBNCODRET, Owner: SYSDBA */
CREATE TABLE FNITFBNCODRET (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODEMPBO INTEGER NOT NULL,
        CODFILIALBO SMALLINT NOT NULL,
        CODBANCO CHAR(3) NOT NULL,
        TIPOFEBRABAN CHAR(2) NOT NULL,
        CODRET VARCHAR(4) NOT NULL,
        CODITRET VARCHAR(4) NOT NULL,
        DESCITRET VARCHAR(150) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT CHAR(8) DEFAULT USER NOT NULL,
CONSTRAINT FNITFBNCODRETPK PRIMARY KEY (CODRET, CODITRET, TIPOFEBRABAN, CODBANCO, CODFILIALBO, CODEMPBO, CODFILIAL, CODEMP));

/* Table: FNITMODBOLETO, Owner: SYSDBA */
CREATE TABLE FNITMODBOLETO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODMODBOL INTEGER NOT NULL,
        CODEMPBO INTEGER NOT NULL,
        CODFILIALBO SMALLINT NOT NULL,
        CODBANCO CHAR(3) NOT NULL,
        CODEMPCB INTEGER NOT NULL,
        CODFILIALCB SMALLINT NOT NULL,
        CODCARTCOB CHAR(3) NOT NULL,
        CONVCOB VARCHAR(20) DEFAULT ' ' NOT NULL,
        DVCONVCOB CHAR(4),
        CODEMPCT INTEGER,
        CODFILIALCT SMALLINT,
        NUMCONTA CHAR(10),
        SEQNOSSONUMERO INTEGER,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT FNITMODBOLETOPK PRIMARY KEY (CODMODBOL, CODFILIAL, CODEMP, CODBANCO, CODFILIALBO, CODEMPBO, CODCARTCOB, CODFILIALCB, CODEMPCB));

/* Table: FNITPAGAR, Owner: SYSDBA */
CREATE TABLE FNITPAGAR (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODPAG INTEGER NOT NULL,
        NPARCPAG INTEGER NOT NULL,
        VLRITPAG NUMERICDN NOT NULL,
        VLRDESCITPAG NUMERICDN,
        VLRMULTAITPAG NUMERICDN,
        VLRJUROSITPAG NUMERICDN,
        VLRDEVITPAG NUMERICDN DEFAULT 0 NOT NULL,
        VLRPARCITPAG NUMERICDN NOT NULL,
        VLRPAGOITPAG NUMERICDN,
        VLRAPAGITPAG NUMERICDN,
        VLRADICITPAG NUMERICDN DEFAULT 0,
        VLRCANCITPAG NUMERICDN DEFAULT 0,
        DTITPAG DATE NOT NULL,
        DTCOMPITPAG DATE NOT NULL,
        DTVENCITPAG DATE NOT NULL,
        DTPAGOITPAG DATE,
        STATUSITPAG CHAR(2) NOT NULL,
        CODEMPCA INTEGER,
        CODFILIALCA SMALLINT,
        NUMCONTA CHAR(10),
        CODEMPPN INTEGER,
        CODFILIALPN SMALLINT,
        CODPLAN CHAR(13),
        DOCLANCAITPAG VARCHAR(15),
        OBSITPAG VARCHAR(250),
        FLAG CHAR(1) DEFAULT 'N',
        CODEMPCC INTEGER,
        CODFILIALCC SMALLINT,
        ANOCC SMALLINT,
        CODCC CHAR(19),
        CODEMPTC INTEGER,
        CODFILIALTC SMALLINT,
        CODTIPOCOB INTEGER,
        CODEMPCT INTEGER,
        CODFILIALCT SMALLINT,
        CODCONTR INTEGER,
        CODITCONTR SMALLINT,
        EMMANUT CHAR(1) DEFAULT 'N' NOT NULL,
        CODEMPSN INTEGER,
        CODFILIALSN SMALLINT,
        CODSINAL SMALLINT,
        CODEMPEM INTEGER,
        CODFILIALEM SMALLINT,
        MATEMPR INTEGER,
        MULTIBAIXA CHAR(1) DEFAULT 'N',
        EDITITPAG CHAR(1) DEFAULT 'N',
        DTINS DATE DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
        HINS TIME DEFAULT 'now' NOT NULL,
        HALT TIME DEFAULT 'now',
CONSTRAINT FNITPAGARPK PRIMARY KEY (CODPAG, NPARCPAG, CODFILIAL, CODEMP));

/* Table: FNITRECEBER, Owner: SYSDBA */
CREATE TABLE FNITRECEBER (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODREC INTEGER NOT NULL,
        NPARCITREC INTEGER NOT NULL,
        VLRITREC NUMERICDN NOT NULL,
        VLRDESCITREC NUMERICDN,
        VLRMULTAITREC NUMERICDN,
        VLRJUROSITREC NUMERICDN,
        VLRDEVITREC NUMERICDN              
DEFAULT 0 NOT NULL,
        VLRPARCITREC NUMERICDN,
        VLRPAGOITREC NUMERICDN,
        VLRAPAGITREC NUMERICDN,
        VLRCOMIITREC NUMERICDN DEFAULT 0,
        VLRCANCITREC NUMERICDN DEFAULT 0,
        VLRBASECOMIS NUMERICDN,
        DESCPONT CHAR(1) DEFAULT 'N' NOT NULL,
        DTITREC DATE NOT NULL,
        DTCOMPITREC DATE NOT NULL,
        DTVENCITREC DATE NOT NULL,
        DTPREVITREC DATE,
        DTPAGOITREC DATE,
        DTLIQITREC DATE,
        STATUSITREC CHAR(2) NOT NULL,
        CODEMPPN INTEGER,
        CODFILIALPN SMALLINT,
        CODPLAN CHAR(13),
        OBSITREC VARCHAR(250),
        CODEMPCA INTEGER,
        CODFILIALCA SMALLINT,
        NUMCONTA CHAR(10),
        CODEMPBO INTEGER,
        CODFILIALBO SMALLINT,
        CODBANCO CHAR(3),
        CODEMPTC INTEGER,
        CODFILIALTC SMALLINT,
        CODTIPOCOB INTEGER,
        CODEMPCB INTEGER,
        CODFILIALCB SMALLINT,
        CODCARTCOB CHAR(3),
        DOCLANCAITREC VARCHAR(15),
        FLAG CHAR(1) DEFAULT 'N',
        CODEMPCC INTEGER,
        CODFILIALCC SMALLINT,
        ANOCC SMALLINT,
        CODCC CHAR(19),
        IMPRECIBOITREC CHAR(1) DEFAULT 'N' NOT NULL,
        RECIBOITREC INTEGER,
        ALTUSUITREC CHAR(1) DEFAULT 'S' NOT NULL,
        PDVITREC CHAR(1) DEFAULT 'N' NOT NULL,
        RECEMCOB CHAR(1) DEFAULT 'N' NOT NULL,
        DTINIEMCOB DATE,
        DTFIMEMCOB DATE,
        SEQNOSSONUMERO INTEGER,
        NOSSONUMERO VARCHAR(20),
        EMMANUT CHAR(1) DEFAULT 'N' NOT NULL,
        CODEMPSN INTEGER,
        CODFILIALSN SMALLINT,
        CODSINAL SMALLINT,
        MULTIBAIXA CHAR(1) DEFAULT 'N',
        CODEMPCT INTEGER,
        CODFILIALCT SMALLINT,
        CODCONTR INTEGER,
        CODITCONTR SMALLINT,
        CODEMPEM INTEGER,
        CODFILIALEM SMALLINT,
        MATEMPR INTEGER,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT FNITRECEBERPK PRIMARY KEY (CODREC, NPARCITREC, CODFILIAL, CODEMP));

/* Table: FNITRENEGREC, Owner: SYSDBA */
CREATE TABLE FNITRENEGREC (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODRENEGREC INTEGER NOT NULL,
        CODITRENEGREC SMALLINT NOT NULL,
        CODEMPIR INTEGER NOT NULL,
        CODFILIALIR SMALLINT NOT NULL,
        CODREC INTEGER NOT NULL,
        NPARCITREC INTEGER NOT NULL,
        DTINI DATE DEFAULT 'now',
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT FNITRENEGRECPK PRIMARY KEY (CODITRENEGREC, CODRENEGREC, CODFILIAL, CODEMP));

/* Table: FNITTBJUROS, Owner: SYSDBA */
CREATE TABLE FNITTBJUROS (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTBJ INTEGER NOT NULL,
        ANOITTBJ SMALLINT NOT NULL,
        MESITTBJ SMALLINT NOT NULL,
        PERCITTBJ NUMERIC(7, 3) DEFAULT 0 NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT FNITTBJUROSPK PRIMARY KEY (CODTBJ, MESITTBJ, ANOITTBJ, CODFILIAL, CODEMP));

/* Table: FNLANCA, Owner: SYSDBA */
CREATE TABLE FNLANCA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODLANCA INTEGER NOT NULL,
        CODCOMI INTEGER,
        CODEMPPG INTEGER,
        CODFILIALPG SMALLINT,
        CODPAG INTEGER,
        NPARCPAG INTEGER,
        CODEMPRC INTEGER,
        CODFILIALRC SMALLINT,
        CODREC INTEGER,
        NPARCITREC INTEGER,
        CODEMPPN INTEGER NOT NULL,
        CODFILIALPN SMALLINT NOT NULL,
        CODPLAN CHAR(13) NOT NULL,
        DTCOMPLANCA DATE NOT NULL,
        DATALANCA DATE NOT NULL,
        DOCLANCA VARCHAR(15),
        HISTBLANCA VARCHAR(250) NOT NULL,
        HISTLANCA VARCHAR(10000),
        TRANSFLANCA CHAR(1) DEFAULT 'N',
        STATUSLANCA CHAR(2),
        DTPREVLANCA DATE,
        DTPREVSUBLANCA DATE,
        VLRLANCA NUMERICDN              DEFAULT 0,
        CODEMPCI INTEGER,
        CODFILIALCI SMALLINT,
        CODPCOMI INTEGER,
        FLAG CHAR(1) DEFAULT 'N',
        TIPOLANCA CHAR(1) DEFAULT 'A' NOT NULL,
        PDVITREC CHAR(1) DEFAULT 'N' NOT NULL,
        CODCLI INTEGER,
        CODEMPCL INTEGER,
        CODFILIALCL SMALLINT,
        CODEMPFR INTEGER,
        CODFILIALFR SMALLINT,
        CODFOR INTEGER,
        EMMANUT CHAR(1) DEFAULT 'N' NOT NULL,
        CODEMPSN INTEGER,
        CODFILIALSN SMALLINT,
        CODSINAL SMALLINT,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT FNLANCAPK PRIMARY KEY (CODLANCA, CODFILIAL, CODEMP));

/* Table: FNLIBCRED, Owner: SYSDBA */
CREATE TABLE FNLIBCRED (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODLCRED INTEGER NOT NULL,
        TIPOVENDA CHAR(1) NOT NULL,
        CODEMPVD INTEGER NOT NULL,
        CODFILIALVD SMALLINT NOT NULL,
        CODVENDA INTEGER NOT NULL,
        DTAEMITLCRED DATE DEFAULT 'now' NOT NULL,
        VLRAUTORIZLCRED NUMERICDN              DEFAULT 0 NOT NULL,
        VLRUTILLCRED NUMERICDN              DEFAULT 0 NOT NULL,
        VLRVENDACRED NUMERICDN,
        CODEMPUS INTEGER,
        CODFILIALUS SMALLINT,
        IDUSU CHAR(8),
        DTAUTILLCRED DATE,
        SITLCRED CHAR(1) DEFAULT 'L' NOT NULL,
        CODEMPCL INTEGER NOT NULL,
        CODFILIALCL SMALLINT NOT NULL,
        CODCLI INTEGER NOT NULL,
        DTAVCTOLCRED DATE DEFAULT 'today' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT FNLIBCREDPK PRIMARY KEY (CODLCRED, CODFILIAL, CODEMP));

/* Table: FNMODBOLETO, Owner: SYSDBA */
CREATE TABLE FNMODBOLETO (CODEMP INTEGER NOT NULL,
        CODFILIAL INTEGER NOT NULL,
        CODMODBOL INTEGER NOT NULL,
        DESCMODBOL CHAR(30) NOT NULL,
        TXAMODBOL VARCHAR(10000) DEFAULT ' ' NOT NULL,
        PREIMPMODBOL CHAR(1) DEFAULT 'S' NOT NULL,
        CARTCOB CHAR(2) DEFAULT '' NOT NULL,
        MDECOB VARCHAR(8) DEFAULT '21' NOT NULL,
        ACEITEMODBOL CHAR(1) DEFAULT 'N' NOT NULL,
        CLASSMODBOL VARCHAR(80),
        ESPDOCMODBOL CHAR(3),
        DESCLPMODBOL VARCHAR(80),
        INSTPAGMODBOL VARCHAR(500),
        CODEMPCC INTEGER,
        CODFILIALCC SMALLINT,
        NUMCONTA CHAR(10),
        IMPINFOPARC CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT FNMODBOLETOPK PRIMARY KEY (CODMODBOL, CODFILIAL, CODEMP));

/* Table: FNMOEDA, Owner: SYSDBA */
CREATE TABLE FNMOEDA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODMOEDA CHAR(4) NOT NULL,
        TIPOMOEDA CHAR(1) NOT NULL,
        ATUALIZAMOEDA CHAR(1) NOT NULL,
        SINGMOEDA CHAR(20) NOT NULL,
        PLURMOEDA CHAR(20) NOT NULL,
        CODFBNMOEDA CHAR(1) DEFAULT '9' NOT NULL,
        DECSMOEDA CHAR(20),
        DECPMOEDA CHAR(20),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT FNMOEDAPK PRIMARY KEY (CODMOEDA, CODFILIAL, CODEMP));

/* Table: FNMOVIMENTO, Owner: SYSDBA */
CREATE TABLE FNMOVIMENTO (ID BIGINT NOT NULL,
        TIPOMOV CHAR(1) DEFAULT 'R' NOT NULL,
        SITMOV CHAR(1) DEFAULT 'E' NOT NULL,
        DTMOV DATE DEFAULT 'now' NOT NULL,
        STATUSOLD CHAR(2) DEFAULT 'R1' NOT NULL,
        VLRTITULO NUMERIC(15, 5) DEFAULT 0 NOT NULL,
        VLRPARC NUMERIC(15, 5) DEFAULT 0 NOT NULL,
        VLRAPAG NUMERIC(15, 5) DEFAULT 0 NOT NULL,
        VLRPAGO NUMERIC(15, 5) DEFAULT 0 NOT NULL,
        VLRDEV NUMERIC(15, 5) DEFAULT 0 NOT NULL,
        VLRJUROS NUMERIC(15, 5) DEFAULT 0 NOT NULL,
        VLRDESC NUMERIC(15, 5) DEFAULT 0 NOT NULL,
        CODEMPRC INTEGER,
        CODFILIALRC SMALLINT,
        CODREC INTEGER,
        NPARCITREC SMALLINT,
        CODEMPPG INTEGER,
        CODFILIALPG SMALLINT,
        CODPAG INTEGER,
        NPARCPAG SMALLINT,
        EMMANUT CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT VARCHAR(128) DEFAULT USER,
CONSTRAINT FNMOVIMENTOPK PRIMARY KEY (ID));

/* Table: FNPAGAR, Owner: SYSDBA */
CREATE TABLE FNPAGAR (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODPAG INTEGER NOT NULL,
        CODEMPCP INTEGER,
        CODFILIALCP SMALLINT,
        CODCOMPRA INTEGER,
        CODEMPPG INTEGER NOT NULL,
        CODFILIALPG SMALLINT NOT NULL,
        CODPLANOPAG INTEGER NOT NULL,
        CODEMPFR INTEGER NOT NULL,
        CODFILIALFR SMALLINT NOT NULL,
        CODFOR INTEGER NOT NULL,
        CODEMPBO INTEGER,
        CODFILIALBO SMALLINT,
        CODBANCO CHAR(3),
        VLRDESCPAG NUMERICDN,
        VLRMULTAPAG NUMERICDN,
        VLRJUROSPAG NUMERICDN,
        VLRDEVPAG NUMERICDN              
DEFAULT 0 NOT NULL,
        VLRPARCPAG NUMERICDN NOT NULL,
        VLRPAGOPAG NUMERICDN,
        VLRAPAGPAG NUMERICDN,
        DATAPAG DATE,
        DTCOMPPAG DATE NOT NULL,
        STATUSPAG CHAR(2) NOT NULL,
        DTQUITPAG DATE,
        DOCPAG INTEGER NOT NULL,
        VLRPAG NUMERICDN              DEFAULT 0,
        NROPARCPAG INTEGER DEFAULT 0,
        OBSPAG VARCHAR(250),
        VLRADICPAG NUMERICDN              DEFAULT 0,
        FLAG CHAR(1) DEFAULT 'N',
        CODEMPTC INTEGER,
        CODFILIALTC SMALLINT,
        CODTIPOCOB INTEGER,
        CODEMPCA INTEGER,
        CODFILIALCA SMALLINT,
        NUMCONTA CHAR(10),
        EMMANUT CHAR(1) DEFAULT 'N' NOT NULL,
        VLRBASEIRRF NUMERICDN,
        VLRBASEINSS NUMERICDN,
        VLRRETIRRF NUMERICDN,
        VLRRETINSS NUMERICDN,
        CODEMPPN INTEGER,
        CODFILIALPN SMALLINT,
        CODPLAN CHAR(13),
        CODEMPCC INTEGER,
        CODFILIALCC SMALLINT,
        ANOCC SMALLINT,
        CODCC CHAR(19),
        CODEMPOC INTEGER,
        CODFILIALOC SMALLINT,
        CODORDCP INTEGER,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT FNPAGARPK PRIMARY KEY (CODPAG, CODFILIAL, CODEMP));

/* Table: FNPAGCHEQ, Owner: SYSDBA */
CREATE TABLE FNPAGCHEQ (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODPAG INTEGER NOT NULL,
        NPARCPAG SMALLINT NOT NULL,
        CODEMPCH INTEGER NOT NULL,
        CODFILIALCH SMALLINT NOT NULL,
        SEQCHEQ INTEGER NOT NULL,
        BAIXA CHAR(1),
        TRANSFERE CHAR(1),
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT VARCHAR(128) DEFAULT USER NOT NULL,
CONSTRAINT FNPAGCHEQPK PRIMARY KEY (SEQCHEQ, CODPAG, NPARCPAG, CODFILIALCH, CODEMPCH, CODFILIAL, CODEMP));

/* Table: FNPAGTOCOMI, Owner: SYSDBA */
CREATE TABLE FNPAGTOCOMI (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODPCOMI INTEGER NOT NULL,
        CODEMPPN INTEGER NOT NULL,
        CODFILIALPN SMALLINT NOT NULL,
        CODPLAN CHAR(13) NOT NULL,
        CODEMPCA INTEGER NOT NULL,
        CODFILIALCA SMALLINT NOT NULL,
        NUMCONTA CHAR(10) NOT NULL,
        VLRPCOMI NUMERICDN              DEFAULT 0,
        DOCPCOMI INTEGER NOT NULL,
        OBSPCOMI VARCHAR(300),
        DTCOMPPCOMI DATE NOT NULL,
        DATAPCOMI DATE NOT NULL,
        FLAG CHAR(1) DEFAULT 'N',
        EMMANUT CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT FNPAGTOCOMIPK PRIMARY KEY (CODPCOMI, CODFILIAL, CODEMP));

/* Table: FNPARCPAG, Owner: SYSDBA */
CREATE TABLE FNPARCPAG (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODPLANOPAG INTEGER NOT NULL,
        NROPARCPAG INTEGER NOT NULL,
        PERCPAG NUMERIC(9, 5),
        DIASPAG INTEGER,
        DESCPARCPAG CHAR(30),
        AUTOBAIXAPARC CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT FNPARCPAGPK PRIMARY KEY (NROPARCPAG, CODPLANOPAG, CODFILIAL, CODEMP));

/* Table: FNPLANEJAMENTO, Owner: SYSDBA */
CREATE TABLE FNPLANEJAMENTO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODPLAN CHAR(13) NOT NULL,
        DESCPLAN CHAR(50) NOT NULL,
        NIVELPLAN INTEGER NOT NULL,
        CODREDPLAN INTEGER,
        CODEMPSP INTEGER,
        CODFILIALSP SMALLINT,
        CODSUBPLAN CHAR(13),
        TIPOPLAN CHAR(1) NOT NULL,
        FINPLAN CHAR(3),
        COMPSLDCXPLAN CHAR(1) DEFAULT 'S' NOT NULL,
        CODEMPHP INTEGER,
        CODFILIALHP SMALLINT,
        CODHIST INTEGER,
        CODCONTCRED VARCHAR(20),
        CODCONTDEB VARCHAR(20),
        ESFINPLAN CHAR(1) DEFAULT 'E' NOT NULL,
        CLASFINPLAN CHAR(1) DEFAULT 'O' NOT NULL,
        LANCTOXPLAN CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT FNPLANEJAMENTOPK PRIMARY KEY (CODPLAN, CODFILIAL, CODEMP));

/* Table: FNPLANOPAG, Owner: SYSDBA */
CREATE TABLE FNPLANOPAG (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODPLANOPAG INTEGER NOT NULL,
        DESCPLANOPAG CHAR(40),
        PARCPLANOPAG INTEGER NOT NULL,
        APORCPLANOPAG CHAR(1) DEFAULT 'N' NOT NULL,
        AUTOBAIXAPLANOPAG CHAR(1) DEFAULT 'N',
        CODEMPCA INTEGER,
        CODFILIALCA SMALLINT,
        NUMCONTA CHAR(10),
        CODEMPPN INTEGER,
        CODFILIALPN SMALLINT,
        CODPLAN CHAR(13),
        CODEMPCC INTEGER,
        CODFILIALCC SMALLINT,
        ANOCC SMALLINT,
        CODCC CHAR(19),
        ATIVOPLANOPAG CHAR(1) DEFAULT 'S' NOT NULL,
        CVPLANOPAG CHAR(1) DEFAULT 'A' NOT NULL,
        CODEMPTBJ INTEGER,
        CODFILIALTBJ SMALLINT,
        CODTBJ INTEGER,
        PERCDESC NUMERICDN,
        REGRVCTOPLANOPAG CHAR(1) DEFAULT 'N' NOT NULL,
        RVSABPLANOPAG CHAR(1) DEFAULT 'N' NOT NULL,
        RVDOMPLANOPAG CHAR(1) DEFAULT 'N' NOT NULL,
        RVFERPLANOPAG CHAR(1) DEFAULT 'N' NOT NULL,
        RVDIAPLANOPAG CHAR(1) DEFAULT 'A' NOT NULL,
        DIAVCTOPLANOPAG SMALLINT DEFAULT 0 NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT FNPLANOPAGPK PRIMARY KEY (CODPLANOPAG, CODFILIAL, CODEMP));

/* Table: FNRECEBER, Owner: SYSDBA */
CREATE TABLE FNRECEBER (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODREC INTEGER NOT NULL,
        CODEMPBO INTEGER,
        CODFILIALBO SMALLINT,
        CODBANCO CHAR(3),
        CODEMPPG INTEGER NOT NULL,
        CODFILIALPG SMALLINT NOT NULL,
        CODPLANOPAG INTEGER NOT NULL,
        CODEMPCL INTEGER NOT NULL,
        CODFILIALCL SMALLINT NOT NULL,
        CODCLI INTEGER NOT NULL,
        CODEMPVD INTEGER,
        CODFILIALVD SMALLINT,
        CODVEND INTEGER,
        CODEMPVA INTEGER,
        CODFILIALVA SMALLINT,
        TIPOVENDA CHAR(1),
        CODVENDA INTEGER,
        CODEMPTC INTEGER,
        CODFILIALTC SMALLINT,
        CODTIPOCOB INTEGER,
        CODEMPCB INTEGER,
        CODFILIALCB SMALLINT,
        CODCARTCOB CHAR(3),
        VLRREC NUMERICDN NOT NULL,
        VLRDESCREC NUMERICDN,
        VLRMULTAREC NUMERICDN,
        VLRJUROSREC NUMERICDN,
        VLRDEVREC NUMERICDN              
DEFAULT 0 NOT NULL,
        VLRPARCREC NUMERICDN NOT NULL,
        VLRPAGOREC NUMERICDN,
        VLRAPAGREC NUMERICDN,
        VLRBASECOMIS NUMERICDN,
        VLRRETENSAOISS NUMERICDN,
        DTCOMPREC DATE NOT NULL,
        DATAREC DATE NOT NULL,
        STATUSREC CHAR(2) NOT NULL,
        VLRCOMIREC NUMERICDN,
        DTQUITREC DATE,
        DOCREC INTEGER NOT NULL,
        NROPARCREC INTEGER DEFAULT 0,
        OBSREC VARCHAR(250),
        FLAG CHAR(1) DEFAULT 'N',
        ALTUSUREC CHAR(1) DEFAULT 'N',
        CODEMPCA INTEGER,
        CODFILIALCA SMALLINT,
        NUMCONTA CHAR(10),
        CODEMPPN INTEGER,
        CODFILIALPN SMALLINT,
        CODPLAN CHAR(13),
        CODEMPCC INTEGER,
        CODFILIALCC SMALLINT,
        ANOCC SMALLINT,
        CODCC CHAR(19),
        CODEMPRR INTEGER,
        CODFILIALRR SMALLINT,
        CODRENEGREC INTEGER,
        EMMANUT CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT FNRECEBERPK PRIMARY KEY (CODREC, CODFILIAL, CODEMP));

/* Table: FNRENEGREC, Owner: SYSDBA */
CREATE TABLE FNRENEGREC (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODRENEGREC INTEGER NOT NULL,
        DTRENEGREC DATE NOT NULL,
        VLRORIGINAL NUMERICDN NOT NULL,
        VLRDESCONTO NUMERICDN,
        VLRADICIONAL NUMERICDN,
        VLRJUROS NUMERICDN,
        VLRLIQRENEGREC NUMERICDN NOT NULL,
        CODEMPPG INTEGER NOT NULL,
        CODFILIALPG INTEGER NOT NULL,
        CODPLANOPAG INTEGER NOT NULL,
        OBSRENEGREC VARCHAR(250),
        DTINI DATE DEFAULT 'now',
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT FNRENEGRECPK PRIMARY KEY (CODRENEGREC, CODFILIAL, CODEMP));

/* Table: FNRESTRICAO, Owner: SYSDBA */
CREATE TABLE FNRESTRICAO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCLI INTEGER NOT NULL,
        SEQRESTR SMALLINT NOT NULL,
        CODEMPTR INTEGER NOT NULL,
        CODFILIALTR SMALLINT NOT NULL,
        CODTPRESTR INTEGER NOT NULL,
        SITRESTR CHAR(1) DEFAULT 'I' NOT NULL,
        DTRESTR DATE NOT NULL,
        OBSRESTR VARCHAR(512),
        DTCANCRESTR DATE,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT VARCHAR(128) DEFAULT USER,
CONSTRAINT FNRESTRICAOPK PRIMARY KEY (CODCLI, SEQRESTR, CODFILIAL, CODEMP));

/* Table: FNSALDOLANCA, Owner: SYSDBA */
CREATE TABLE FNSALDOLANCA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODEMPPN INTEGER NOT NULL,
        CODFILIALPN INTEGER NOT NULL,
        CODPLAN CHAR(13) NOT NULL,
        DATASL DATE NOT NULL,
        PREVSL NUMERICDN,
        SALDOSL NUMERICDN NOT NULL,
        FECHADO CHAR(1),
        EMMANUT CHAR(1),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT FNSALDOLANCAPK PRIMARY KEY (DATASL, CODFILIALPN, CODEMPPN, CODPLAN, CODFILIAL, CODEMP));

/* Table: FNSINAL, Owner: SYSDBA */
CREATE TABLE FNSINAL (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODSINAL SMALLINT NOT NULL,
        DESCSINAL VARCHAR(100) NOT NULL,
        CORSINAL INTEGER default 0 NOT NULL,
        DTINS DATE default 'now' NOT NULL,
        HINS TIME default 'now' NOT NULL,
        IDUSUINS VARCHAR(128) default user NOT NULL,
        DTALT DATE default 'now' NOT NULL,
        HALT TIME default 'now' NOT NULL,
        IDUSUALT VARCHAR(128) default user NOT NULL,
CONSTRAINT FNSINALPK PRIMARY KEY (CODSINAL, CODEMP, CODFILIAL));

/* Table: FNSUBLANCA, Owner: SYSDBA */
CREATE TABLE FNSUBLANCA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODLANCA INTEGER NOT NULL,
        CODSUBLANCA INTEGER NOT NULL,
        CODEMPPN INTEGER NOT NULL,
        CODFILIALPN SMALLINT NOT NULL,
        CODPLAN CHAR(13) NOT NULL,
        STATUSSUBLANCA CHAR(2) NOT NULL,
        ORIGSUBLANCA CHAR(1),
        DTCOMPSUBLANCA DATE NOT NULL,
        DTPREVSUBLANCA DATE,
        TIPOSUBLANCA CHAR(1) DEFAULT 'P' NOT NULL,
        DATASUBLANCA DATE,
        VLRSUBLANCA NUMERICDN              DEFAULT 0,
        FLAG CHAR(1) DEFAULT 'N',
        CODEMPCC INTEGER,
        CODFILIALCC SMALLINT,
        ANOCC SMALLINT,
        CODCC CHAR(19),
        CODEMPCL INTEGER,
        CODFILIALCL SMALLINT,
        CODCLI INTEGER,
        CODEMPFR INTEGER,
        CODFILIALFR SMALLINT,
        CODFOR INTEGER,
        HISTSUBLANCA VARCHAR(250),
        CODEMPCT INTEGER,
        CODFILIALCT SMALLINT,
        CODCONTR INTEGER,
        CODITCONTR SMALLINT,
        CODEMPPG INTEGER,
        CODFILIALPG SMALLINT,
        CODPAG INTEGER,
        NPARCPAG INTEGER,
        CODEMPRC INTEGER,
        CODFILIALRC SMALLINT,
        CODREC INTEGER,
        NPARCITREC INTEGER,
        CODEMPEM INTEGER,
        CODFILIALEM SMALLINT,
        MATEMPR INTEGER,
        EMMANUT CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT FNSUBLANCAPK PRIMARY KEY (CODSUBLANCA, CODLANCA, CODFILIAL, CODEMP));

/* Table: FNTALAOCHEQ, Owner: SYSDBA */
CREATE TABLE FNTALAOCHEQ (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        NUMCONTA CHAR(10) NOT NULL,
        SEQTALAO SMALLINT NOT NULL,
        DTTALAO DATE DEFAULT 'today' NOT NULL,
        CHEQINITALAO INTEGER DEFAULT 0 NOT NULL,
        CHEQFIMTALAO INTEGER DEFAULT 1 NOT NULL,
        CHEQATUALTALAO INTEGER DEFAULT 1 NOT NULL,
        ATIVOTALAO CHAR(1) DEFAULT 'S' NOT NULL,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT 'USER' NOT NULL,
        DTALT DATE DEFAULT 'today' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT VARCHAR(128) DEFAULT 'USER' NOT NULL,
CONSTRAINT FNTALAOCHEQPK PRIMARY KEY (NUMCONTA, SEQTALAO, CODFILIAL, CODEMP));

/* Table: FNTBJUROS, Owner: SYSDBA */
CREATE TABLE FNTBJUROS (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTBJ INTEGER NOT NULL,
        DESCTBJ CHAR(50) NOT NULL,
        TIPOTBJ CHAR(1) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT FNTBJUROSPK PRIMARY KEY (CODTBJ, CODFILIAL, CODEMP));

/* Table: FNTIPOCOB, Owner: SYSDBA */
CREATE TABLE FNTIPOCOB (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTIPOCOB INTEGER NOT NULL,
        DESCTIPOCOB CHAR(40) NOT NULL,
        TIPOFEBRABAN CHAR(2) DEFAULT '00' NOT NULL,
        TIPOSPED CHAR(2),
        DUPLCOB CHAR(8),
        OBRIGCARTCOB CHAR(1) DEFAULT 'N' NOT NULL,
        CODEMPCT INTEGER,
        CODFILIALCT SMALLINT,
        NUMCONTA VARCHAR(10),
        SEQTALAO SMALLINT,
        NRODIASCOMP SMALLINT,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT FNTIPOCOBPK PRIMARY KEY (CODTIPOCOB, CODFILIAL, CODEMP));

/* Table: FNTIPOCRED, Owner: SYSDBA */
CREATE TABLE FNTIPOCRED (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTPCRED INTEGER NOT NULL,
        DESCTPCRED CHAR(50) NOT NULL,
        VLRTPCRED NUMERICDN NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT FNTIPOCREDPK PRIMARY KEY (CODTPCRED, CODFILIAL, CODEMP));

/* Table: FNTIPORESTR, Owner: SYSDBA */
CREATE TABLE FNTIPORESTR (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTPRESTR INTEGER NOT NULL,
        DESCTPRESTR CHAR(50) NOT NULL,
        BLOQTPRESTR CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT VARCHAR(128) DEFAULT USER,
CONSTRAINT FNTIPORESTRPK PRIMARY KEY (CODTPRESTR, CODFILIAL, CODEMP));

/* Table: LFCALCCUSTO, Owner: SYSDBA */
CREATE TABLE LFCALCCUSTO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCALC INTEGER NOT NULL,
        DESCCALC VARCHAR(60) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT VARCHAR(128) DEFAULT USER,
CONSTRAINT LFCALCCUSTOPK PRIMARY KEY (CODCALC, CODFILIAL, CODEMP));

/* Table: LFCLFISCAL, Owner: SYSDBA */
CREATE TABLE LFCLFISCAL (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODFISC CHAR(13) NOT NULL,
        DESCFISC CHAR(50) NOT NULL,
        TIPOFISC CHAR(2),
        TPREDICMSFISC CHAR(1) DEFAULT 'B',
        ALIQFISC NUMERIC(6, 2),
        ALIQLFISC NUMERIC(6, 2),
        REDFISC NUMERIC(6, 2),
        ALIQIPIFISC NUMERIC(6, 2),
        CODEMPRA INTEGER NOT NULL,
        CODFILIALRA SMALLINT NOT NULL,
        CODREGRA CHAR(4) NOT NULL,
        ORIGFISC CHAR(1),
        CODEMPTT INTEGER,
        CODFILIALTT SMALLINT,
        CODTRATTRIB CHAR(2),
        CODEMPME INTEGER,
        CODFILIALME SMALLINT,
        CODMENS INTEGER,
        SITPISFISC CHAR(1) DEFAULT 'T',
        SITCOFINSFISC CHAR(1) DEFAULT 'T',
        TIPOST CHAR(2) DEFAULT 'SI',
        MARGEMVLAGR NUMERICDN,
        CODNCM VARCHAR(10),
        CODNBM VARCHAR(12),
        EXTIPI CHAR(2),
        CODSERV CHAR(5),
        CST CHAR(2),
        CODIGO VARCHAR(10),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT LFCLFISCALPK PRIMARY KEY (CODFISC, CODFILIAL, CODEMP));

/* Table: LFCSOSN, Owner: SYSDBA */
CREATE TABLE LFCSOSN (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CSOSN CHAR(4) NOT NULL,
        DESCCSOSN VARCHAR(1000) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT LFCSOSNPK PRIMARY KEY (CSOSN, CODFILIAL, CODEMP));

/* Table: LFFRETE, Owner: SYSDBA */
CREATE TABLE LFFRETE (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODFRETE INTEGER NOT NULL,
        DOCFRETE VARCHAR(13),
        CODEMPTN INTEGER NOT NULL,
        CODFILIALTN SMALLINT NOT NULL,
        CODTRAN INTEGER NOT NULL,
        CODEMPTM INTEGER NOT NULL,
        CODFILIALTM SMALLINT NOT NULL,
        CODTIPOMOV INTEGER NOT NULL,
        CODEMPNT INTEGER,
        CODFILIALNT SMALLINT,
        CODNAT CHAR(4),
        TIPOFRETE CHAR(1) NOT NULL,
        TIPOPGTO CHAR(1) NOT NULL,
        CODEMPRE INTEGER NOT NULL,
        CODFILIALRE SMALLINT NOT NULL,
        CODREMET INTEGER NOT NULL,
        CODEMPDE INTEGER NOT NULL,
        CODFILIALDE SMALLINT NOT NULL,
        CODDESTINAT INTEGER NOT NULL,
        DTEMITFRETE DATE NOT NULL,
        DTMOVFRETE DATE,
        DTPAGFRETE DATE,
        QTDFRETE NUMERICDN NOT NULL,
        VLRMERCADORIA NUMERICDN NOT NULL,
        VLRFRETE NUMERICDN NOT NULL,
        VLRFRETENOTA NUMERICDN,
        PESOBRUTO NUMERICDN NOT NULL,
        PESOLIQUIDO NUMERICDN NOT NULL,
        ALIQICMSFRETE NUMERICDN              DEFAULT 0 NOT NULL,
        VLRICMSFRETE NUMERICDN              DEFAULT 0 NOT NULL,
        VLRBASEICMSFRETE NUMERICDN              DEFAULT 0 NOT NULL,
        CODEMPPA INTEGER,
        CODFILIALPA SMALLINT,
        CODPAG INTEGER,
        SERIE CHAR(4),
        CODEMPRM INTEGER,
        CODFILIALRM SMALLINT,
        TICKET INTEGER,
        CHAVECTE VARCHAR(44),
        CODEMPTT INTEGER,
        CODFILIALTT SMALLINT,
        CODTRATTRIB CHAR(2),
        CODEMPEX INTEGER,
        CODFILIALEX SMALLINT,
        TICKETEX INTEGER,
        EMMANUT CHAR(1) DEFAULT 'N',
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDFRETEPK PRIMARY KEY (CODFRETE, CODFILIAL, CODEMP));

/* Table: LFFRETECOMPRA, Owner: SYSDBA */
CREATE TABLE LFFRETECOMPRA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODFRETE INTEGER NOT NULL,
        CODCOMPRA INTEGER NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT LFFRETECPPK PRIMARY KEY (CODFRETE, CODCOMPRA, CODFILIAL, CODEMP));

/* Table: LFFRETEVENDA, Owner: SYSDBA */
CREATE TABLE LFFRETEVENDA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODFRETE INTEGER NOT NULL,
        CODVENDA INTEGER NOT NULL,
        TIPOVENDA CHAR(1) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT LFFRETEVDPK PRIMARY KEY (CODFRETE, CODVENDA, TIPOVENDA, CODFILIAL, CODEMP));

/* Table: LFITCALCCUSTO, Owner: SYSDBA */
CREATE TABLE LFITCALCCUSTO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCALC INTEGER NOT NULL,
        SEQITCALC SMALLINT NOT NULL,
        SIGLACALC VARCHAR(10) NOT NULL,
        OPERACAOCALC VARCHAR(1) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT VARCHAR(128) DEFAULT USER,
CONSTRAINT LFITCALCCUSTOPK PRIMARY KEY (CODCALC, SEQITCALC, CODFILIAL, CODEMP));

/* Table: LFITCLFISCAL, Owner: SYSDBA */
CREATE TABLE LFITCLFISCAL (CODEMP INTEGER NOT NULL,
        CODFILIAL INTEGER NOT NULL,
        CODFISC CHAR(13) NOT NULL,
        CODITFISC INTEGER NOT NULL,
        ORIGFISC CHAR(1) NOT NULL,
        CODEMPTT INTEGER NOT NULL,
        CODFILIALTT INTEGER NOT NULL,
        TIPOFISC CHAR(2) NOT NULL,
        TPREDICMSFISC CHAR(1) DEFAULT 'B' NOT NULL,
        ATIVOITFISC CHAR(1) DEFAULT 'S' NOT NULL,
        REDFISC NUMERIC(9, 2),
        CODTRATTRIB CHAR(2) NOT NULL,
        NOUFITFISC CHAR(1) DEFAULT 'N' NOT NULL,
        CODEMPFC INTEGER,
        CODFILIALFC INTEGER,
        CODFISCCLI INTEGER,
        ALIQFISC NUMERIC(9, 2),
        ALIQFISCINTRA NUMERIC(9, 2),
        ALIQLFISC NUMERIC(9, 2),
        ALIQIPIFISC NUMERIC(6, 2) DEFAULT 0 NOT NULL,
        ALIQPISFISC NUMERIC(6, 2) DEFAULT 0 NOT NULL,
        ALIQCOFINSFISC NUMERIC(6, 2) DEFAULT 0 NOT NULL,
        ALIQCSOCIALFISC NUMERIC(6, 2) DEFAULT 0 NOT NULL,
        ALIQIRFISC NUMERIC(6, 2) DEFAULT 0 NOT NULL,
        ALIQFUNRURALFISC NUMERIC(6, 2) DEFAULT 0 NOT NULL,
        ALIQIIFISC NUMERIC(9, 2) DEFAULT 0 NOT NULL,
        CODEMPME INTEGER,
        CODFILIALME SMALLINT,
        CODMENS INTEGER,
        CODEMPTM INTEGER,
        CODFILIALTM SMALLINT,
        CODTIPOMOV INTEGER,
        TIPOST CHAR(2) DEFAULT 'SI',
        MARGEMVLAGR NUMERICDN,
        GERALFISC CHAR(1) DEFAULT 'N' NOT NULL,
        CODEMPSP INTEGER,
        CODFILIALSP SMALLINT,
        CODSITTRIBPIS CHAR(2),
        IMPSITTRIBPIS CHAR(2),
        CODEMPSC INTEGER,
        CODFILIALSC SMALLINT,
        CODSITTRIBCOF CHAR(2),
        IMPSITTRIBCOF CHAR(2),
        CODEMPSI INTEGER,
        CODFILIALSI SMALLINT,
        CODSITTRIBIPI CHAR(2),
        IMPSITTRIBIPI CHAR(2),
        TPCALCIPI CHAR(1),
        VLRIPIUNIDTRIB NUMERICDN,
        MODBCICMS SMALLINT DEFAULT 3 NOT NULL,
        MODBCICMSST SMALLINT DEFAULT 4 NOT NULL,
        CODPAIS SMALLINT,
        SIGLAUF CHAR(2),
        VLRPISUNIDTRIB NUMERICDN,
        VLRCOFUNIDTRIB NUMERICDN,
        TIPOUSOITFISC CHAR(2) DEFAULT 'VD' NOT NULL,
        REDBASEST CHAR(1) DEFAULT 'S',
        REDBASEFRETE CHAR(1) DEFAULT 'N',
        CODEMPRA INTEGER,
        CODFILIALRA SMALLINT,
        CODREGRA CHAR(4),
        CODEMPIS INTEGER,
        CODFILIALIS SMALLINT,
        CODSITTRIBISS CHAR(2),
        IMPSITTRIBISS CHAR(2),
        ALIQISSFISC NUMERIC(6, 2),
        RETENSAOISS CHAR(1),
        INDAPURIPI CHAR(1),
        CODEMPCN INTEGER,
        CODFILIALCN SMALLINT,
        CSOSN CHAR(4),
        ALIQICMSIMP NUMERICDN,
        PERCCREDPRESIMP NUMERICDN   DEFAULT 100.00 NOT NULL,
        ADICIPIBASEICMS CHAR(1) DEFAULT 'N' NOT NULL,
        ADICICMSTOTNOTA CHAR(1) DEFAULT 'N' NOT NULL,
        CODEMPCC INTEGER,
        CODFILIALCC SMALLINT,
        CODCALC INTEGER,
        ALIQICMSSTCM NUMERIC(9, 2) DEFAULT 0,
        CALCSTCM CHAR(1) DEFAULT 'N',
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT LFITCLFISCAL PRIMARY KEY (CODEMP, CODFILIAL, CODFISC, CODITFISC));

/* Table: LFITCOMPRA, Owner: SYSDBA */
CREATE TABLE LFITCOMPRA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCOMPRA INTEGER NOT NULL,
        CODITCOMPRA INTEGER NOT NULL,
        ALIQCOFINS NUMERICDN,
        CODEMPSP INTEGER,
        CODFILIALSP SMALLINT,
        CODSITTRIBPIS CHAR(2),
        IMPSITTRIBPIS CHAR(2),
        CODEMPSC INTEGER,
        CODFILIALSC SMALLINT,
        CODSITTRIBCOF CHAR(2),
        IMPSITTRIBCOF CHAR(2),
        CODEMPSI INTEGER,
        CODFILIALSI SMALLINT,
        CODSITTRIBIPI CHAR(2),
        IMPSITTRIBIPI CHAR(2),
        VLRIPIUNIDTRIB NUMERICDN,
        MODBCICMS SMALLINT DEFAULT 3,
        MODBCICMSST SMALLINT DEFAULT 4,
        ALIQREDBCICMS NUMERICDN,
        ALIQREDBCICMSST NUMERICDN,
        ALIQICMSST NUMERICDN,
        ALIQPIS NUMERICDN,
        VLRPISUNIDTRIB NUMERICDN,
        VLRBASEPIS NUMERICDN,
        VLRBASECOFINS NUMERICDN,
        VLRCOFUNIDTRIB NUMERICDN,
        VLRIR NUMERICDN,
        VLRPIS NUMERICDN,
        VLRCOFINS NUMERICDN,
        VLRCSOCIAL NUMERICDN,
        ORIGFISC CHAR(1),
        CODTRATTRIB CHAR(2),
        MARGEMVLAGRITCOMPRA NUMERICDN,
        VLRBASEICMSSTITCOMPRA NUMERICDN,
        VLRICMSSTITCOMPRA NUMERICDN,
        PERCISSITCOMPRA NUMERICDN,
        VLRBASEISSITCOMPRA NUMERICDN,
        VLRISSITCOMPRA NUMERICDN,
        PERCICMSSIMPLES NUMERICDN,
        EMMANUT CHAR(1) DEFAULT 'N' NOT NULL,
        VLRBASEICMSSTITRETCOMPRA NUMERICDN,
        VLRICMSSTRETITCOMPRA NUMERICDN,
        ALIQII NUMERICDN,
        VLRBASEII NUMERICDN,
        VLRII NUMERICDN,
        VLRICMSDIFERIDO NUMERICDN,
        VLRICMSDEVIDO NUMERICDN,
        VLRICMSCREDPRESUM NUMERICDN,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT LFITCOMPRA PRIMARY KEY (CODCOMPRA, CODITCOMPRA, CODFILIAL, CODEMP));

/* Table: LFITNATOPER, Owner: SYSDBA */
CREATE TABLE LFITNATOPER (CODEMP INTEGER NOT NULL,
        CODFILIAL INTEGER NOT NULL,
        CODNAT CHAR(4) NOT NULL,
        CODITNATOPER INTEGER NOT NULL,
        CODEMPTI INTEGER NOT NULL,
        CODFILIALTI INTEGER NOT NULL,
        UFTI CHAR(2) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT LFITNATOPER PRIMARY KEY (CODITNATOPER, CODNAT, CODFILIAL, CODEMP));

/* Table: LFITREGRAFISCAL, Owner: SYSDBA */
CREATE TABLE LFITREGRAFISCAL (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODREGRA CHAR(4) NOT NULL,
        CODNAT CHAR(4) NOT NULL,
        NOUFITRF CHAR(1) NOT NULL,
        CVITRF CHAR(1) NOT NULL,
        CODEMPTM INTEGER,
        CODFILIALTM SMALLINT,
        CODTIPOMOV INTEGER,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT LFITREGRAFISCALPK PRIMARY KEY (CODNAT, CODREGRA, CODFILIAL, CODEMP));

/* Table: LFITVENDA, Owner: SYSDBA */
CREATE TABLE LFITVENDA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        TIPOVENDA CHAR(1) DEFAULT 'V' NOT NULL,
        CODVENDA INTEGER NOT NULL,
        CODITVENDA INTEGER NOT NULL,
        ALIQCOFINS NUMERICDN,
        CODEMPSP INTEGER,
        CODFILIALSP SMALLINT,
        CODSITTRIBPIS CHAR(2),
        IMPSITTRIBPIS CHAR(2),
        CODEMPSC INTEGER,
        CODFILIALSC SMALLINT,
        CODSITTRIBCOF CHAR(2),
        IMPSITTRIBCOF CHAR(2),
        CODEMPSI INTEGER,
        CODFILIALSI SMALLINT,
        CODSITTRIBIPI CHAR(2),
        IMPSITTRIBIPI CHAR(2),
        VLRIPIUNIDTRIB NUMERICDN,
        MODBCICMS SMALLINT DEFAULT 3,
        MODBCICMSST SMALLINT DEFAULT 4,
        ALIQREDBCICMS NUMERICDN,
        ALIQREDBCICMSST NUMERICDN,
        ALIQICMSST NUMERICDN,
        ALIQPIS NUMERICDN,
        VLRPISUNIDTRIB NUMERICDN,
        VLRBASEPIS NUMERICDN,
        VLRBASECOFINS NUMERICDN,
        VLRCOFUNIDTRIB NUMERICDN,
        VLRIR NUMERICDN,
        VLRPIS NUMERICDN,
        VLRCOFINS NUMERICDN,
        VLRCSOCIAL NUMERICDN,
        VLRBASEICMSITVENDA NUMERICDN,
        VLRBASEICMSFRETEITVENDA NUMERICDN,
        VLRICMSFRETEITVENDA NUMERICDN,
        VLRBASENCM DECIMAL(15, 5) DEFAULT 0 NOT NULL,
        ALIQNACNCM DECIMAL(9, 2) DEFAULT 0 NOT NULL,
        ALIQIMPNCM DECIMAL(9, 2) DEFAULT 0 NOT NULL,
        VLRNACNCM DECIMAL(15, 5) DEFAULT 0 NOT NULL,
        VLRIMPNCM DECIMAL(15, 5) DEFAULT 0 NOT NULL,
        EMMANUT CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT LFITVENDA PRIMARY KEY (CODVENDA, CODITVENDA, TIPOVENDA, CODFILIAL, CODEMP));

/* Table: LFLIVROFISCAL, Owner: SYSDBA */
CREATE TABLE LFLIVROFISCAL (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        TIPOLF CHAR(1) NOT NULL,
        ANOMESLF CHAR(6) NOT NULL,
        CODLF INTEGER NOT NULL,
        CODEMPET INTEGER NOT NULL,
        CODFILIALET SMALLINT NOT NULL,
        CODEMITLF INTEGER NOT NULL,
        SERIELF CHAR(4) NOT NULL,
        DOCINILF INTEGER NOT NULL,
        DTEMITLF DATE NOT NULL,
        DTESLF DATE NOT NULL,
        CODEMPNT INTEGER,
        CODFILIALNT SMALLINT,
        CODNAT CHAR(4),
        DOCFIMLF INTEGER NOT NULL,
        ESPECIELF CHAR(3) NOT NULL,
        UFLF CHAR(2) NOT NULL,
        VLRCONTABILLF NUMERICDN              DEFAULT 0,
        VLRBASEICMSLF NUMERICDN              DEFAULT 0,
        ALIQICMSLF NUMERIC(7, 3) DEFAULT 0,
        VLRICMSLF NUMERICDN              DEFAULT 0,
        VLRISENTASICMSLF NUMERICDN              DEFAULT 0,
        VLROUTRASICMSLF NUMERICDN              DEFAULT 0,
        VLRBASEIPILF NUMERICDN              DEFAULT 0,
        ALIQIPILF NUMERIC(7, 3) DEFAULT 0,
        VLRIPILF NUMERICDN              DEFAULT 0,
        VLRISENTASIPILF NUMERICDN              DEFAULT 0,
        VLROUTRASIPILF NUMERICDN              DEFAULT 0,
        OBSLF CHAR(30),
        CODEMPMN INTEGER,
        CODFILIALMN SMALLINT,
        CODMODNOTA INTEGER,
        SITUACAOLF CHAR(1) DEFAULT 'N' NOT NULL,
        VLRBASEICMSSTLF NUMERICDN,
        VLRICMSSTLF NUMERICDN,
        VLRACESSORIASLF NUMERICDN,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT LFLIVROFISCALPK PRIMARY KEY (CODLF, ANOMESLF, TIPOLF, CODFILIAL, CODEMP));

/* Table: LFMENSAGEM, Owner: SYSDBA */
CREATE TABLE LFMENSAGEM (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODMENS INTEGER NOT NULL,
        MENS VARCHAR(10000) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT LFMENSAGEMPK PRIMARY KEY (CODMENS, CODFILIAL, CODEMP));

/* Table: LFMODDOCFISC, Owner: SYSDBA */
CREATE TABLE LFMODDOCFISC (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODMODDOCFISC CHAR(2) NOT NULL,
        DESCMODDOCFISC CHAR(60) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT LFMODDOCFISCPK PRIMARY KEY (CODMODDOCFISC, CODFILIAL, CODEMP));

/* Table: LFMODNOTA, Owner: SYSDBA */
CREATE TABLE LFMODNOTA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODMODNOTA INTEGER NOT NULL,
        DESCMODNOTA CHAR(30) NOT NULL,
        TIPOMODNOTA CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT LFMODNOTAPK PRIMARY KEY (CODMODNOTA, CODFILIAL, CODEMP));

/* Table: LFNATOPER, Owner: SYSDBA */
CREATE TABLE LFNATOPER (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODNAT CHAR(4) NOT NULL,
        DESCNAT CHAR(60) NOT NULL,
        IMPDTSAIDANAT CHAR(1) DEFAULT 'S' NOT NULL,
        ALIQENAT NUMERIC(6, 2) DEFAULT 0 NOT NULL,
        ALIQFNAT NUMERIC(6, 2) DEFAULT 0 NOT NULL,
        TXTNAT VARCHAR(500),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT LFNATOPERPK PRIMARY KEY (CODNAT, CODFILIAL, CODEMP));

/* Table: LFNBM, Owner: SYSDBA */
CREATE TABLE LFNBM (CODNBM VARCHAR(12) NOT NULL,
        DESCNBM VARCHAR(60) NOT NULL,
        DTINS DATE default 'now' NOT NULL,
        HINS TIME default 'now' NOT NULL,
        IDUSUINS CHAR(8) default user NOT NULL,
        DTALT DATE default 'now' NOT NULL,
        HALT TIME default 'now' NOT NULL,
        IDUSUALT CHAR(8) default user NOT NULL,
CONSTRAINT LFNBMPK PRIMARY KEY (CODNBM));

/* Table: LFNCM, Owner: SYSDBA */
CREATE TABLE LFNCM (CODNCM VARCHAR(10) NOT NULL,
        DESCNCM VARCHAR(60) NOT NULL,
        ALIQNCM VARCHAR(6),
        TEXTONCM VARCHAR(2000),
        EXCECAONCM VARCHAR(1000),
        ALIQNAC DECIMAL(9, 2) DEFAULT 0 NOT NULL,
        ALIQIMP DECIMAL(9, 2) DEFAULT 0 NOT NULL,
        DTINS DATE default 'now' NOT NULL,
        HINS TIME default 'now' NOT NULL,
        IDUSUINS CHAR(8) default user NOT NULL,
        DTALT DATE default 'now' NOT NULL,
        HALT TIME default 'now' NOT NULL,
        IDUSUALT CHAR(8) default user NOT NULL,
CONSTRAINT LFNCMPK PRIMARY KEY (CODNCM));

/* Table: LFNCMNBM, Owner: SYSDBA */
CREATE TABLE LFNCMNBM (CODNCM VARCHAR(10) NOT NULL,
        CODNBM VARCHAR(12) NOT NULL,
        DTINS DATE default 'now' NOT NULL,
        HINS TIME default 'now' NOT NULL,
        IDUSUINS CHAR(8) default user NOT NULL,
        DTALT DATE default 'now' NOT NULL,
        HALT TIME default 'now' NOT NULL,
        IDUSUALT CHAR(8) default user NOT NULL,
CONSTRAINT LFNCMNBMPK PRIMARY KEY (CODNCM, CODNBM));

/* Table: LFREGRAFISCAL, Owner: SYSDBA */
CREATE TABLE LFREGRAFISCAL (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODREGRA CHAR(4) NOT NULL,
        DESCREGRA CHAR(50),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT LFREGRAFISCALPK PRIMARY KEY (CODREGRA, CODFILIAL, CODEMP));

/* Table: LFSEQSERIE, Owner: SYSDBA */
CREATE TABLE LFSEQSERIE (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        SERIE CHAR(4) NOT NULL,
        CODEMPSS INTEGER NOT NULL,
        CODFILIALSS SMALLINT NOT NULL,
        SEQSERIE SMALLINT NOT NULL,
        DOCSERIE INTEGER DEFAULT 0 NOT NULL,
        ATIVSERIE CHAR(1) DEFAULT 'S' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT VARCHAR(128) DEFAULT USER NOT NULL,
CONSTRAINT LFSEQSERIEPK PRIMARY KEY (SERIE, CODFILIAL, CODEMP, SEQSERIE, CODFILIALSS, CODEMPSS));

/* Table: LFSERIE, Owner: SYSDBA */
CREATE TABLE LFSERIE (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        SERIE CHAR(4) NOT NULL,
        DOCSERIE INTEGER DEFAULT 1 NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT LFSERIEPK PRIMARY KEY (SERIE, CODFILIAL, CODEMP));

/* Table: LFSERVICO, Owner: SYSDBA */
CREATE TABLE LFSERVICO (CODSERV CHAR(5) NOT NULL,
        DESCSERV VARCHAR(500),
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT LFSERVICOSPK PRIMARY KEY (CODSERV));

/* Table: LFSITTRIB, Owner: SYSDBA */
CREATE TABLE LFSITTRIB (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODSITTRIB CHAR(2) NOT NULL,
        IMPSITTRIB CHAR(2) NOT NULL,
        DESCSITTRIB VARCHAR(200) NOT NULL,
        OPERACAO CHAR(1) DEFAULT 'S' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT LFSITTRIBPK PRIMARY KEY (CODSITTRIB, IMPSITTRIB, CODFILIAL, CODEMP));

/* Table: LFTABICMS, Owner: SYSDBA */
CREATE TABLE LFTABICMS (CODEMP INTEGER NOT NULL,
        CODFILIAL INTEGER NOT NULL,
        UFTI CHAR(2) NOT NULL,
        ALIQTI NUMERIC(9, 2) NOT NULL,
        ALIQINTRATI SMALLINT,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT LFTABICMSPK PRIMARY KEY (UFTI, CODFILIAL, CODEMP));

/* Table: LFTIPOFISCCLI, Owner: SYSDBA */
CREATE TABLE LFTIPOFISCCLI (CODEMP INTEGER NOT NULL,
        CODFILIAL INTEGER NOT NULL,
        CODFISCCLI INTEGER NOT NULL,
        DESCFISCCLI CHAR(40) NOT NULL,
        CALCCOFINSTF CHAR(1) DEFAULT 'N' NOT NULL,
        CALCCSOCIALTF CHAR(1) DEFAULT 'N' NOT NULL,
        CALCICMSTF CHAR(1) DEFAULT 'N' NOT NULL,
        CALCIPITF CHAR(1) DEFAULT 'N' NOT NULL,
        CALCIRTF CHAR(1) DEFAULT 'N' NOT NULL,
        CALCISSTF CHAR(1) DEFAULT 'N' NOT NULL,
        CALCPISTF CHAR(1) DEFAULT 'N' NOT NULL,
        IMPCOFINSTF CHAR(1) DEFAULT 'N' NOT NULL,
        IMPCSOCIALTF CHAR(1) DEFAULT 'N' NOT NULL,
        IMPICMSTF CHAR(1) DEFAULT 'N' NOT NULL,
        IMPISSTF CHAR(1) DEFAULT 'N' NOT NULL,
        IMPIPITF CHAR(1) DEFAULT  'N' NOT NULL,
        IMPIRTF CHAR(1) DEFAULT 'N' NOT NULL,
        IMPPISTF CHAR(1) DEFAULT 'N' NOT NULL,
        LEITRANSP CHAR(1) DEFAULT 'N' NOT NULL,
        CODEMPOC INTEGER,
        CODFILIALOC SMALLINT,
        CODTIPOMOVOC INTEGER,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT LFTIPOFISCCLIPK PRIMARY KEY (CODFISCCLI, CODFILIAL, CODEMP));

/* Table: LFTRATTRIB, Owner: SYSDBA */
CREATE TABLE LFTRATTRIB (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTRATTRIB CHAR(2) NOT NULL,
        DESCTRATTRIB CHAR(60) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT LFTRATTRIBPK PRIMARY KEY (CODTRATTRIB, CODFILIAL, CODEMP));

/* Table: MGPRODUTO, Owner: SYSDBA */
CREATE TABLE MGPRODUTO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        DESCPROD VARCHAR(255) NOT NULL,
        DESCPRODCOMPL BLOB SUB_TYPE TEXT SEGMENT SIZE 80,
        DTINS DATE DEFAULT 'now',
        IDUSUINS CHAR(8) DEFAULT USER,
        DTALT DATE DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
        HINS TIME DEFAULT 'now',
        HALT TIME DEFAULT 'now',
CONSTRAINT MGPRODUTOPK PRIMARY KEY (CODPROD, CODFILIAL, CODEMP));

/* Table: NECONTINGENCIA, Owner: SYSDBA */
CREATE TABLE NECONTINGENCIA (ID BIGINT NOT NULL,
        CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        DTENTRADA DATE NOT NULL,
        HENTRADA TIME NOT NULL,
        DTSAIDA DATE,
        HSAIDA TIME,
        TIPOEMISSAONFE CHAR(1) NOT NULL,
        JUSTIFICATIVA VARCHAR(256) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(128) DEFAULT USER,
CONSTRAINT NECONTINGENCIAPK PRIMARY KEY (ID));

/* Table: PEBATIDA, Owner: SYSDBA */
CREATE TABLE PEBATIDA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        DTBAT DATE NOT NULL,
        HBAT TIME NOT NULL,
        CODEMPEP INTEGER NOT NULL,
        CODFILIALEP SMALLINT NOT NULL,
        MATEMPR INTEGER NOT NULL,
        TIPOBAT CHAR(1) DEFAULT 'M' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT VARCHAR(128) DEFAULT USER NOT NULL,
CONSTRAINT PEBATIDAPK PRIMARY KEY (HBAT, DTBAT, CODFILIAL, CODEMP, MATEMPR, CODEMPEP, CODFILIALEP));

/* Table: PEBATIDALOG, Owner: SYSDBA */
CREATE TABLE PEBATIDALOG (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        DTBAT DATE NOT NULL,
        HBAT TIME NOT NULL,
        CODEMPEP INTEGER NOT NULL,
        CODFILIALEP SMALLINT NOT NULL,
        MATEMPR INTEGER NOT NULL,
        SEQLOG SMALLINT NOT NULL,
        TIPOLOG CHAR(1) DEFAULT 'D' NOT NULL,
        TIPOBAT CHAR(1) DEFAULT 'M' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT VARCHAR(128) DEFAULT USER NOT NULL,
        IDUSULOG VARCHAR(128) DEFAULT USER NOT NULL,
        DTINSLOG DATE DEFAULT 'now' NOT NULL,
        HINSLOG DATE DEFAULT 'now' NOT NULL,
CONSTRAINT PEBATIDALOGPK PRIMARY KEY (HBAT, DTBAT, SEQLOG, CODFILIAL, CODEMP, MATEMPR, CODEMPEP, CODFILIALEP));

/* Table: PEFALTA, Owner: SYSDBA */
CREATE TABLE PEFALTA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        DTFALTA DATE NOT NULL,
        PERIODOFALTA CHAR(1) DEFAULT 'I' NOT NULL,
        TIPOFALTA CHAR(1) DEFAULT 'I' NOT NULL,
        HINIFALTA TIME NOT NULL,
        HINIINTFALTA TIME NOT NULL,
        HFININTFALTA TIME NOT NULL,
        HFINFALTA TIME NOT NULL,
        CODEMPEP INTEGER NOT NULL,
        CODFILIALEP SMALLINT NOT NULL,
        MATEMPR INTEGER NOT NULL,
        JUSTIFFALTA VARCHAR(2000),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT VARCHAR(128) DEFAULT USER NOT NULL,
CONSTRAINT PEFALTAPK PRIMARY KEY (HINIFALTA, DTFALTA, CODFILIAL, CODEMP, MATEMPR, CODEMPEP, CODFILIALEP));

/* Table: PPDISTRIB, Owner: SYSDBA */
CREATE TABLE PPDISTRIB (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        SEQEST SMALLINT NOT NULL,
        SEQEF SMALLINT NOT NULL,
        CODEMPFS INTEGER NOT NULL,
        CODFILIALFS SMALLINT NOT NULL,
        CODFASE INTEGER NOT NULL,
        SEQDE SMALLINT NOT NULL,
        CODEMPDE INTEGER NOT NULL,
        CODFILIALDE SMALLINT NOT NULL,
        CODPRODDE INTEGER NOT NULL,
        SEQESTDE SMALLINT NOT NULL,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT PPDISTRIBPK PRIMARY KEY (CODPROD, CODFILIAL, CODEMP, SEQEST, SEQEF, CODPRODDE, CODFILIALDE, CODEMPDE, SEQDE, SEQESTDE, CODFASE, CODFILIALFS, CODEMPFS));

/* Table: PPESTRUANALISE, Owner: SYSDBA */
CREATE TABLE PPESTRUANALISE (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODESTANALISE INTEGER NOT NULL,
        CODPROD INTEGER NOT NULL,
        SEQEST SMALLINT NOT NULL,
        SEQEF SMALLINT NOT NULL,
        CODEMPFS INTEGER NOT NULL,
        CODFILIALFS SMALLINT NOT NULL,
        CODFASE INTEGER NOT NULL,
        CODEMPTA INTEGER NOT NULL,
        CODFILIALTA SMALLINT NOT NULL,
        CODTPANALISE SMALLINT NOT NULL,
        VLRMIN NUMERIC(15, 5),
        VLRMAX NUMERIC(15, 5),
        ESPECIFICACAO CHAR(50),
        EMITCERT CHAR(1) DEFAULT 'S' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT CHAR(8) DEFAULT USER NOT NULL,
CONSTRAINT PPESTRUANALISEPK PRIMARY KEY (CODESTANALISE, CODFILIAL, CODEMP));

/* Table: PPESTRUFASE, Owner: SYSDBA */
CREATE TABLE PPESTRUFASE (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        SEQEST SMALLINT DEFAULT 0 NOT NULL,
        SEQEF SMALLINT NOT NULL,
        CODEMPFS INTEGER NOT NULL,
        CODFILIALFS SMALLINT NOT NULL,
        CODFASE INTEGER NOT NULL,
        CODEMPTR INTEGER NOT NULL,
        CODFILIALTR SMALLINT NOT NULL,
        CODTPREC INTEGER NOT NULL,
        TEMPOEF NUMERICDN              DEFAULT 0 NOT NULL,
        FINALIZAOP CHAR(1) DEFAULT 'N' NOT NULL,
        INSTRUCOES VARCHAR(5000),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT PPESTRUFASEPK PRIMARY KEY (CODPROD, SEQEST, SEQEF, CODFILIAL, CODEMP, CODFASE, CODFILIALFS, CODEMPFS));

/* Table: PPESTRUTURA, Owner: SYSDBA */
CREATE TABLE PPESTRUTURA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        SEQEST SMALLINT DEFAULT 0 NOT NULL,
        DESCEST CHAR(50) NOT NULL,
        QTDEST NUMERICDN NOT NULL,
        REFPROD VARCHAR(20) NOT NULL,
        ATIVOEST CHAR(1) DEFAULT 'N' NOT NULL,
        CODEMPML INTEGER,
        CODFILIALML SMALLINT,
        CODMODLOTE INTEGER,
        NRODIASVALID SMALLINT,
        GLOTEOPP CHAR(1) DEFAULT 'N' NOT NULL,
        USADENSIDADEOP CHAR(1) DEFAULT 'N' NOT NULL,
        OBSERVACAO VARCHAR(1000),
        ESTDINAMICA CHAR(1),
        DESPAUTO CHAR(1) DEFAULT 'N' NOT NULL,
        BLOQQTDPROD CHAR(1) DEFAULT 'N' NOT NULL,
        EXPEDIRRMA CHAR(1) DEFAULT 'N' NOT NULL,
        GERAROP CHAR(1) DEFAULT 'N' NOT NULL,
        EMMANUT CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT PPESTRUTURAPK PRIMARY KEY (CODPROD, SEQEST, CODFILIAL, CODEMP));

/* Table: PPFASE, Owner: SYSDBA */
CREATE TABLE PPFASE (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODFASE INTEGER NOT NULL,
        DESCFASE CHAR(50) NOT NULL,
        TIPOFASE CHAR(2) NOT NULL,
        EXTERNAFASE CHAR(1),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT PPFASEPK PRIMARY KEY (CODFASE, CODFILIAL, CODEMP));

/* Table: PPFOTOMTAN, Owner: SYSDBA */
CREATE TABLE PPFOTOMTAN (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODMTANALISE INTEGER NOT NULL,
        CODFOTOMTAN INTEGER NOT NULL,
        DESCFOTOMTAN VARCHAR(300) NOT NULL,
        FOTOMTAN BLOB SUB_TYPE 0 SEGMENT SIZE 80 NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDFOTOMTAN PRIMARY KEY (CODFOTOMTAN, CODMTANALISE, CODFILIAL, CODEMP));

/* Table: PPITESTRUTURA, Owner: SYSDBA */
CREATE TABLE PPITESTRUTURA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        SEQEST SMALLINT DEFAULT 0 NOT NULL,
        SEQITEST SMALLINT NOT NULL,
        REFPROD VARCHAR(20),
        CODEMPPD INTEGER NOT NULL,
        CODFILIALPD SMALLINT NOT NULL,
        CODPRODPD INTEGER NOT NULL,
        REFPRODPD VARCHAR(20),
        CODEMPFS INTEGER NOT NULL,
        CODFILIALFS SMALLINT NOT NULL,
        CODFASE INTEGER NOT NULL,
        SEQEF SMALLINT NOT NULL,
        QTDITEST NUMERICDN2 NOT NULL,
        RMAAUTOITEST CHAR(1) DEFAULT 'N' NOT NULL,
        CPROVA CHAR(1) DEFAULT 'N' NOT NULL,
        QTDVARIAVEL CHAR(1) DEFAULT 'N' NOT NULL,
        QTDFIXA CHAR(1) DEFAULT 'N' NOT NULL,
        PERMITEAJUSTEITEST CHAR(1) DEFAULT 'N' NOT NULL,
        TIPOEXTERNO CHAR(1) DEFAULT 'E' NOT NULL,
        EMMANUT CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT PPITESTRUTURAPK PRIMARY KEY (CODPROD, SEQEST, SEQITEST, CODFILIAL, CODEMP, SEQEF, CODFASE, CODFILIALFS, CODEMPFS));

/* Table: PPITESTRUTURASUBPROD, Owner: SYSDBA */
CREATE TABLE PPITESTRUTURASUBPROD (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        SEQEST SMALLINT DEFAULT 0 NOT NULL,
        SEQITESTSP SMALLINT NOT NULL,
        REFPROD VARCHAR(20),
        CODEMPPD INTEGER NOT NULL,
        CODFILIALPD SMALLINT NOT NULL,
        CODPRODPD INTEGER NOT NULL,
        REFPRODPD VARCHAR(20),
        CODEMPFS INTEGER NOT NULL,
        CODFILIALFS SMALLINT NOT NULL,
        CODFASE INTEGER NOT NULL,
        SEQEF SMALLINT NOT NULL,
        QTDITESTSP NUMERICDN NOT NULL,
        QTDVARIAVEL CHAR(1) DEFAULT 'N' NOT NULL,
        QTDFIXA CHAR(1) DEFAULT 'N' NOT NULL,
        EMMANUT CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT PPITESTRUTURASUBPRODPK PRIMARY KEY (CODPROD, SEQEST, SEQITESTSP, CODFILIAL, CODEMP));

/* Table: PPITOP, Owner: SYSDBA */
CREATE TABLE PPITOP (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODOP INTEGER NOT NULL,
        SEQOP SMALLINT DEFAULT 0 NOT NULL,
        SEQITOP SMALLINT NOT NULL,
        CODEMPPD INTEGER NOT NULL,
        CODFILIALPD SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        REFPROD VARCHAR(20) NOT NULL,
        QTDITOP NUMERICDN              DEFAULT 0 NOT NULL,
        CODEMPFS INTEGER NOT NULL,
        CODFILIALFS SMALLINT NOT NULL,
        CODFASE INTEGER NOT NULL,
        CODEMPLE INTEGER,
        CODFILIALLE SMALLINT,
        CODLOTE VARCHAR(20),
        SEQITOPCP SMALLINT,
        CODLOTERAT VARCHAR(20),
        QTDCOPIAITOP NUMERICDN,
        GERARMA CHAR(1) NOT NULL,
        SEQAC SMALLINT,
        BLOQOP CHAR(1) DEFAULT 'N' NOT NULL,
        PERMITEAJUSTEITOP CHAR(1),
        TIPOEXTERNO CHAR(1),
        CODEMPVD INTEGER,
        CODFILIALVD SMALLINT,
        TIPOVENDA CHAR(1),
        CODVENDA INTEGER,
        CODEMPCP INTEGER,
        CODFILIALCP SMALLINT,
        CODCOMPRA INTEGER,
        EMMANUT CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT PPITOPPK PRIMARY KEY (CODOP, SEQOP, SEQITOP, CODFILIAL, CODEMP));

/* Table: PPITRETCP, Owner: SYSDBA */
CREATE TABLE PPITRETCP (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODOP INTEGER NOT NULL,
        SEQOP SMALLINT DEFAULT 0 NOT NULL,
        CODITRETCP SMALLINT NOT NULL,
        CODEMPPD INTEGER NOT NULL,
        CODFILIALPD SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        QTDITRET NUMERICDN               DEFAULT 0 NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT PPITRETCPPK PRIMARY KEY (CODITRETCP, CODOP, SEQOP, CODFILIAL, CODEMP));

/* Table: PPMETODOANALISE, Owner: SYSDBA */
CREATE TABLE PPMETODOANALISE (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODMTANALISE SMALLINT NOT NULL,
        DESCMTANALISE VARCHAR(80) NOT NULL,
        TITULOANALISE VARCHAR(100) NOT NULL,
        FONTEMTANALISE VARCHAR(100),
        MATANALISE VARCHAR(6000),
        REAGANALISE VARCHAR(6000),
        PROCANALISE VARCHAR(6000),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT VARCHAR(128) DEFAULT USER NOT NULL,
CONSTRAINT PPMETODOANALISEPK PRIMARY KEY (CODMTANALISE, CODFILIAL, CODEMP));

/* Table: PPOP, Owner: SYSDBA */
CREATE TABLE PPOP (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODOP INTEGER NOT NULL,
        SEQOP SMALLINT DEFAULT 0 NOT NULL,
        DTEMITOP DATE DEFAULT 'now' NOT NULL,
        CODEMPPD INTEGER NOT NULL,
        CODFILIALPD SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        SEQEST SMALLINT DEFAULT 0 NOT NULL,
        REFPROD VARCHAR(20) NOT NULL,
        DTFABROP DATE NOT NULL,
        QTDSUGPRODOP NUMERICDN              DEFAULT 0 NOT NULL,
        QTDPREVPRODOP NUMERICDN NOT NULL,
        QTDFINALPRODOP NUMERICDN               DEFAULT 0 NOT NULL,
        QTDDISTPOP NUMERICDN              
DEFAULT 0 NOT NULL,
        QTDDISTIOP NUMERICDN              
DEFAULT 0 NOT NULL,
        DTVALIDPDOP DATE,
        CODEMPLE INTEGER,
        CODFILIALLE SMALLINT,
        CODLOTE VARCHAR(20),
        CODEMPTM INTEGER NOT NULL,
        CODFILIALTM SMALLINT NOT NULL,
        CODTIPOMOV INTEGER NOT NULL,
        CODEMPAX INTEGER NOT NULL,
        CODFILIALAX SMALLINT NOT NULL,
        CODALMOX INTEGER NOT NULL,
        CODEMPOPM INTEGER,
        CODFILIALOPM SMALLINT,
        CODOPM INTEGER,
        SEQOPM SMALLINT,
        SITOP CHAR(2) DEFAULT 'PE' NOT NULL,
        OBSOP VARCHAR(1000),
        JUSTFICQTDPROD VARCHAR(500),
        JUSTIFICCANC VARCHAR(500),
        DTCANC TIMESTAMP,
        IDUSUCANC CHAR(8),
        HCANC TIME,
        CODEMPCP INTEGER,
        CODFILIALCP SMALLINT,
        CODCOMPRA INTEGER,
        CODITCOMPRA SMALLINT,
        ESTDINAMICA CHAR(1) DEFAULT 'N',
        GARANTIA CHAR(1),
        CODEMPOS INTEGER,
        CODFILIALOS SMALLINT,
        TICKET INTEGER,
        CODITRECMERC SMALLINT,
        CODITOS SMALLINT,
        EMMANUT CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT PPOPPK PRIMARY KEY (CODOP, SEQOP, CODFILIAL, CODEMP));

/* Table: PPOPACAOCORRET, Owner: SYSDBA */
CREATE TABLE PPOPACAOCORRET (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODOP INTEGER NOT NULL,
        SEQOP SMALLINT NOT NULL,
        SEQAC SMALLINT NOT NULL,
        TPCAUSA CHAR(2) NOT NULL,
        OBSCAUSA VARCHAR(500),
        TPACAO CHAR(2),
        OBSACAO VARCHAR(500),
        STATUS CHAR(2) DEFAULT 'PE' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT CHAR(8) DEFAULT USER NOT NULL,
CONSTRAINT PPOPACAOCORRETPK PRIMARY KEY (CODOP, SEQOP, SEQAC, CODFILIAL, CODEMP));

/* Table: PPOPCQ, Owner: SYSDBA */
CREATE TABLE PPOPCQ (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODOP INTEGER NOT NULL,
        SEQOP SMALLINT NOT NULL,
        SEQOPCQ INTEGER NOT NULL,
        SEQAC SMALLINT,
        CODEMPEA INTEGER NOT NULL,
        CODFILIALEA SMALLINT NOT NULL,
        CODESTANALISE INTEGER NOT NULL,
        SEQEF SMALLINT,
        VLRAFER NUMERIC(15, 5),
        DESCAFER CHAR(80),
        STATUS CHAR(2) DEFAULT 'PE' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT CHAR(8) DEFAULT USER NOT NULL,
CONSTRAINT PPOPCQPK PRIMARY KEY (CODOP, SEQOP, SEQOPCQ, CODFILIAL, CODEMP));

/* Table: PPOPENTRADA, Owner: SYSDBA */
CREATE TABLE PPOPENTRADA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODOP INTEGER NOT NULL,
        SEQOP SMALLINT DEFAULT 0 NOT NULL,
        SEQENT SMALLINT DEFAULT 0 NOT NULL,
        DTENT DATE DEFAULT 'now' NOT NULL,
        HENT TIME DEFAULT 'now' NOT NULL,
        QTDENT NUMERICDN               DEFAULT 0 NOT NULL,
        OBSENT VARCHAR(1000),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT PPOPENTRADAPK PRIMARY KEY (CODOP, SEQOP, SEQENT, CODFILIAL, CODEMP));

/* Table: PPOPFASE, Owner: SYSDBA */
CREATE TABLE PPOPFASE (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODOP INTEGER NOT NULL,
        SEQOP SMALLINT DEFAULT 0 NOT NULL,
        SEQOF SMALLINT NOT NULL,
        CODEMPFS INTEGER NOT NULL,
        CODFILIALFS SMALLINT NOT NULL,
        CODFASE INTEGER NOT NULL,
        CODEMPRP INTEGER NOT NULL,
        CODFILIALRP SMALLINT NOT NULL,
        CODRECP INTEGER NOT NULL,
        TEMPOOF NUMERICDN              DEFAULT 0 NOT NULL,
        CODEMPTR INTEGER NOT NULL,
        CODFILIALTR SMALLINT NOT NULL,
        CODTPREC INTEGER NOT NULL,
        DATAINIPRODFS DATE,
        HINIPRODFS TIME,
        DATAFIMPRODFS DATE,
        HFIMPRODFS TIME,
        OBSFS VARCHAR(500),
        SITFS CHAR(2) DEFAULT 'PE',
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT PPOPFASEPK PRIMARY KEY (CODOP, SEQOP, SEQOF, CODFILIAL, CODEMP));

/* Table: PPOPITORC, Owner: SYSDBA */
CREATE TABLE PPOPITORC (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODOP INTEGER NOT NULL,
        SEQOP SMALLINT DEFAULT 0 NOT NULL,
        CODEMPOC INTEGER NOT NULL,
        CODFILIALOC SMALLINT NOT NULL,
        TIPOORC CHAR(1) DEFAULT 'O' NOT NULL,
        CODORC INTEGER NOT NULL,
        CODITORC INTEGER NOT NULL,
        QTDPROD NUMERICDN              DEFAULT 0 NOT NULL,
        QTDFINALPRODITORC NUMERICDN,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT PPOPITORCPK PRIMARY KEY (CODOP, SEQOP, CODFILIAL, CODEMP, CODORC, CODITORC, TIPOORC, CODFILIALOC, CODEMPOC));

/* Table: PPOPSUBPROD, Owner: SYSDBA */
CREATE TABLE PPOPSUBPROD (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODOP INTEGER NOT NULL,
        SEQOP SMALLINT DEFAULT 0 NOT NULL,
        SEQSUBPROD SMALLINT NOT NULL,
        CODEMPPD INTEGER NOT NULL,
        CODFILIALPD SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        REFPROD VARCHAR(20) NOT NULL,
        QTDITSP NUMERICDN               DEFAULT 0 NOT NULL,
        CODEMPFS INTEGER NOT NULL,
        CODFILIALFS SMALLINT NOT NULL,
        CODFASE INTEGER NOT NULL,
        SEQOF SMALLINT NOT NULL,
        CODEMPLE INTEGER,
        CODFILIALLE SMALLINT,
        CODLOTE VARCHAR(20),
        CODEMPTM INTEGER NOT NULL,
        CODFILIALTM SMALLINT NOT NULL,
        CODTIPOMOV INTEGER NOT NULL,
        DTSUBPROD DATE,
        EMMANUT CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT PPOPSUBPRODPK PRIMARY KEY (CODOP, SEQOP, SEQSUBPROD, CODFILIAL, CODEMP));

/* Table: PPPROCESSAOPTMP, Owner: SYSDBA */
CREATE TABLE PPPROCESSAOPTMP (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODORC INTEGER NOT NULL,
        CODITORC INTEGER NOT NULL,
        TIPOORC CHAR(1) DEFAULT 'O' NOT NULL,
        DTFABROP DATE NOT NULL,
        QTDAPROD NUMERIC(15, 5) NOT NULL,
        CODEMPET INTEGER NOT NULL,
        CODFILIALET SMALLINT NOT NULL,
        CODEST SMALLINT NOT NULL,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT PPPROCESSAOPTMPPK PRIMARY KEY (CODORC, CODITORC, TIPOORC, CODFILIAL, CODEMP));

/* Table: PPRECURSO, Owner: SYSDBA */
CREATE TABLE PPRECURSO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODRECP INTEGER NOT NULL,
        DESCRECP CHAR(50) NOT NULL,
        CODEMPTR INTEGER NOT NULL,
        CODFILIALTR SMALLINT NOT NULL,
        CODTPREC INTEGER NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT PPRECURSOPK PRIMARY KEY (CODRECP, CODFILIAL, CODEMP));

/* Table: PPRETCP, Owner: SYSDBA */
CREATE TABLE PPRETCP (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODOP INTEGER NOT NULL,
        SEQOP SMALLINT DEFAULT 0 NOT NULL,
        DTRETENCAO DATE DEFAULT 'now' NOT NULL,
        DTDESCARTE DATE DEFAULT 'now' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now',
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT PPRETCPPK PRIMARY KEY (CODOP, SEQOP, CODFILIAL, CODEMP));

/* Table: PPTIPOANALISE, Owner: SYSDBA */
CREATE TABLE PPTIPOANALISE (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTPANALISE SMALLINT NOT NULL,
        DESCTPANALISE VARCHAR(80),
        OBSTPANALISE VARCHAR(500),
        TIPOEXPEC CHAR(2) NOT NULL,
        CODEMPUD INTEGER,
        CODFILIALUD SMALLINT,
        CODUNID VARCHAR(20),
        CODEMPMA INTEGER NOT NULL,
        CODFILIALMA SMALLINT NOT NULL,
        CODMTANALISE SMALLINT NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT VARCHAR(128) DEFAULT USER NOT NULL,
CONSTRAINT PPTIPOANALISEPK PRIMARY KEY (CODTPANALISE, CODFILIAL, CODEMP));

/* Table: PPTIPOREC, Owner: SYSDBA */
CREATE TABLE PPTIPOREC (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTPREC INTEGER NOT NULL,
        DESCTPREC CHAR(50) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT PPTIPORECPK PRIMARY KEY (CODTPREC, CODFILIAL, CODEMP));

/* Table: PVCAIXA, Owner: SYSDBA */
CREATE TABLE PVCAIXA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCAIXA INTEGER NOT NULL,
        DESCCAIXA CHAR(40) NOT NULL,
        CODEMPET INTEGER NOT NULL,
        CODFILIALET SMALLINT NOT NULL,
        CODEST INTEGER NOT NULL,
        SEQINI INTEGER,
        SEQMAX INTEGER,
        ECFCAIXA CHAR(1) DEFAULT 'S' NOT NULL,
        TEFCAIXA CHAR(1) DEFAULT 'N',
        ORCCAIXA CHAR(1) DEFAULT 'N' NOT NULL,
        MODODEMO CHAR(1) DEFAULT 'S' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT PVCAIXAPK PRIMARY KEY (CODCAIXA, CODFILIAL, CODEMP));

/* Table: PVCAIXAIMP, Owner: SYSDBA */
CREATE TABLE PVCAIXAIMP (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCAIXA INTEGER NOT NULL,
        CODIMP INTEGER NOT NULL,
        IMPPAD CHAR(1),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT PVCAIXAIMPPK PRIMARY KEY (CODIMP, CODCAIXA, CODFILIAL, CODEMP));

/* Table: PVLEITURAX, Owner: SYSDBA */
CREATE TABLE PVLEITURAX (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCAIXA INTEGER NOT NULL,
        DTLX DATE NOT NULL,
        TT01 NUMERICDN,
        TT02 NUMERICDN,
        TT03 NUMERICDN,
        TT04 NUMERICDN,
        TT05 NUMERICDN,
        TT06 NUMERICDN,
        TT07 NUMERICDN,
        TT08 NUMERICDN,
        TT09 NUMERICDN,
        TT10 NUMERICDN,
        TT11 NUMERICDN,
        TT12 NUMERICDN,
        TT13 NUMERICDN,
        TT14 NUMERICDN,
        TT15 NUMERICDN,
        TT16 NUMERICDN,
        TISENCAO NUMERICDN,
        TNINCIDENCIA NUMERICDN,
        TSUBSTITUICAO NUMERICDN,
        TN1 NUMERICDN,
        TN2 NUMERICDN,
        TN3 NUMERICDN,
        TN4 NUMERICDN,
        TN5 NUMERICDN,
        TN6 NUMERICDN,
        TN7 NUMERICDN,
        TN8 NUMERICDN,
        TN9 NUMERICDN,
        TSANGRIA NUMERICDN,
        TSUPRIMENTO NUMERICDN,
        TGTOTAL NUMERICDN,
        ALIQ01 NUMERICDN,
        ALIQ02 NUMERICDN,
        ALIQ03 NUMERICDN,
        ALIQ04 NUMERICDN,
        ALIQ05 NUMERICDN,
        ALIQ06 NUMERICDN,
        ALIQ07 NUMERICDN,
        ALIQ08 NUMERICDN,
        ALIQ09 NUMERICDN,
        ALIQ10 NUMERICDN,
        ALIQ11 NUMERICDN,
        ALIQ12 NUMERIC(15, 3),
        ALIQ13 NUMERIC(15, 3),
        ALIQ14 NUMERIC(15, 3),
        ALIQ15 NUMERIC(15, 3),
        ALIQ16 NUMERIC(15, 3),
        VLRCONTABILLX NUMERIC(15, 3),
        VLRBASECALCLX NUMERIC(15, 3),
        NUMCANCLX INTEGER,
        NUMREDLX INTEGER,
        VLRCANCLX NUMERIC(15, 3),
        VLRDESCLX NUMERIC(15, 3),
        CONTALX NUMERIC(15, 3),
        VLROUTROSRECLX NUMERIC(15, 3),
        ULTCUPOMLX INTEGER,
        PRIMCUPOMLX INTEGER,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
PRIMARY KEY (CODEMP, CODFILIAL, CODCAIXA, DTLX));

/* Table: PVMOVCAIXA, Owner: SYSDBA */
CREATE TABLE PVMOVCAIXA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCAIXA INTEGER NOT NULL,
        DTAMOV DATE NOT NULL,
        NROMOV INTEGER NOT NULL,
        TIPOMOV CHAR(1) NOT NULL,
        VLRMOV NUMERICDN NOT NULL,
        VLRSLDMOV NUMERICDN,
        CODEMPUS INTEGER NOT NULL,
        CODFILIALUS SMALLINT NOT NULL,
        IDUSU CHAR(8) NOT NULL,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT PVMOVCAIXAPK PRIMARY KEY (NROMOV, DTAMOV, CODCAIXA, CODFILIAL, CODEMP));

/* Table: PVSEQMOVCAIXA, Owner: SYSDBA */
CREATE TABLE PVSEQMOVCAIXA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCAIXA INTEGER NOT NULL,
        DTAMOV DATE NOT NULL,
        NROMOV INTEGER DEFAULT 0 NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS DATE DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT PVSEQMOVCAIXA PRIMARY KEY (DTAMOV, CODCAIXA, CODFILIAL, CODEMP));

/* Table: PVSEQUENCIA, Owner: SYSDBA */
CREATE TABLE PVSEQUENCIA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCAIXA INTEGER NOT NULL,
        SEQCAIXA INTEGER DEFAULT 1 NOT NULL,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT PK_PVSEQUENCIA PRIMARY KEY (CODEMP, CODFILIAL, CODCAIXA));

/* Table: RHAREA, Owner: SYSDBA */
CREATE TABLE RHAREA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODAREA INTEGER NOT NULL,
        DESCAREA CHAR(60) NOT NULL,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT RHAREAPK PRIMARY KEY (CODAREA, CODFILIAL, CODEMP));

/* Table: RHBENEFICIO, Owner: SYSDBA */
CREATE TABLE RHBENEFICIO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODBENEF INTEGER NOT NULL,
        DESCBENEF CHAR(60) NOT NULL,
        VALORBENEF NUMERICDN,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT RHBENEFICIOPK PRIMARY KEY (CODBENEF, CODFILIAL, CODEMP));

/* Table: RHCANDIDATO, Owner: SYSDBA */
CREATE TABLE RHCANDIDATO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCAND INTEGER NOT NULL,
        NOMECAND CHAR(50) NOT NULL,
        ENDCAND CHAR(50),
        NUMCAND INTEGER,
        UFCAND CHAR(2),
        CIDCAND CHAR(50),
        BAIRCAND CHAR(30),
        CEPCAND CHAR(8),
        FONECAND CHAR(12),
        DDDCAND CHAR(4),
        CELCAND VARCHAR(9),
        DTNASCCAND DATE,
        SEXOCAND CHAR(1) NOT NULL,
        PISPASEPCAND CHAR(20),
        CTPSCAND CHAR(20),
        CPFCAND CHAR(11),
        RGCAND CHAR(13),
        SSPCAND CHAR(10),
        TITELEITCAND CHAR(15),
        EMAILCAND CHAR(50),
        OUTROSEMPREGOS VARCHAR(1000),
        CODEMPES INTEGER NOT NULL,
        CODFILIALES SMALLINT NOT NULL,
        CODESTCIVIL CHAR(2) NOT NULL,
        PRETENSAOSAL NUMERICDN,
        STCAND CHAR(2) DEFAULT 'DI' NOT NULL,
        DTULTST DATE DEFAULT 'now' NOT NULL,
        OBSCAND VARCHAR(1000),
        NROFILHOS SMALLINT DEFAULT 0,
        ISENCTRANSP CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT RHCANDIDATOPK PRIMARY KEY (CODCAND, CODFILIAL, CODEMP));

/* Table: RHCANDIDATOCARAC, Owner: SYSDBA */
CREATE TABLE RHCANDIDATOCARAC (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCAND INTEGER NOT NULL,
        CODEMPCT INTEGER NOT NULL,
        CODFILIALCT SMALLINT NOT NULL,
        CODCARAC CHAR(15) NOT NULL,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT RHCANDATOCARACPK PRIMARY KEY (CODCAND, CODFILIAL, CODEMP, CODCARAC, CODFILIALCT, CODEMPCT));

/* Table: RHCANDIDATOCURSO, Owner: SYSDBA */
CREATE TABLE RHCANDIDATOCURSO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCAND INTEGER NOT NULL,
        CODEMPCS INTEGER NOT NULL,
        CODFILIALCS SMALLINT NOT NULL,
        CODCURSO INTEGER NOT NULL,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT RHCANDIDATOCURSOPK PRIMARY KEY (CODCAND, CODFILIAL, CODEMP, CODCURSO, CODFILIALCS, CODEMPCS));

/* Table: RHCANDIDATOFUNC, Owner: SYSDBA */
CREATE TABLE RHCANDIDATOFUNC (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCAND INTEGER NOT NULL,
        CODEMPFC INTEGER NOT NULL,
        CODFILIALFC SMALLINT NOT NULL,
        CODFUNC INTEGER NOT NULL,
        SEQCANDFUNC SMALLINT NOT NULL,
        EMPRESA CHAR(60),
        DTINIFUNC DATE,
        DTFIMFUNC DATE,
        OBSFUNC VARCHAR(500),
        SALARIO NUMERICDN,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT RHCANDIDATOFUNCPK PRIMARY KEY (CODCAND, CODFILIAL, CODEMP, CODFUNC, CODFILIALFC, CODEMPFC, SEQCANDFUNC));

/* Table: RHCANDIDATOSTATUS, Owner: SYSDBA */
CREATE TABLE RHCANDIDATOSTATUS (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCAND INTEGER NOT NULL,
        CODEMPVG INTEGER,
        CODFILIALVG SMALLINT,
        CODVAGA INTEGER,
        SQSTCAND INTEGER NOT NULL,
        STCAND CHAR(2) DEFAULT 'DI',
        DTSTATUS DATE DEFAULT 'now' NOT NULL,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT RHCANDIDATOSTATUSPK PRIMARY KEY (CODCAND, CODFILIAL, CODEMP, SQSTCAND));

/* Table: RHCARACTERISTICA, Owner: SYSDBA */
CREATE TABLE RHCARACTERISTICA (CODEMP INTEGER NOT NULL,
        CODFILIAL INTEGER NOT NULL,
        CODCARAC CHAR(15) NOT NULL,
        DESCCARAC CHAR(50) NOT NULL,
        OBSCARAC VARCHAR(10000),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT ATCARACTERISTICAPK PRIMARY KEY (CODCARAC, CODFILIAL, CODEMP));

/* Table: RHCODGPS, Owner: SYSDBA */
CREATE TABLE RHCODGPS (CODGPS CHAR(4) NOT NULL,
        DESCGPS CHAR(80),
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT RHCODGPSPK PRIMARY KEY (CODGPS));

/* Table: RHCURSO, Owner: SYSDBA */
CREATE TABLE RHCURSO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCURSO INTEGER NOT NULL,
        DESCCURSO CHAR(60) NOT NULL,
        CONTPROGCURSO VARCHAR(1000),
        INSTITUICAOCURSO CHAR(80),
        DURACAOCURSO SMALLINT,
        CODAREA INTEGER,
        CODEMPAR INTEGER,
        CODFILIALAR SMALLINT,
        CODNIVELCURSO SMALLINT NOT NULL,
        CODEMPNC INTEGER NOT NULL,
        CODFILIALNC SMALLINT NOT NULL,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT RHCURSOPK PRIMARY KEY (CODCURSO, CODFILIAL, CODEMP));

/* Table: RHDEPTO, Owner: SYSDBA */
CREATE TABLE RHDEPTO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODDEP INTEGER NOT NULL,
        DESCDEP CHAR(50) NOT NULL,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT RHDEPTOPK PRIMARY KEY (CODDEP, CODFILIAL, CODEMP));

/* Table: RHEMPREGADO, Owner: SYSDBA */
CREATE TABLE RHEMPREGADO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        MATEMPR INTEGER NOT NULL,
        NOMEEMPR CHAR(50) NOT NULL,
        APELIDOEMPR CHAR(30) NOT NULL,
        CODEMPFO INTEGER NOT NULL,
        CODFILIALFO SMALLINT NOT NULL,
        CODFUNC INTEGER NOT NULL,
        CODEMPDP INTEGER NOT NULL,
        CODFILIALDP SMALLINT NOT NULL,
        CODDEP INTEGER NOT NULL,
        CODEMPTO INTEGER NOT NULL,
        CODFILIALTO SMALLINT NOT NULL,
        CODTURNO INTEGER,
        ENDEMPR CHAR(50),
        NUMEMPR INTEGER,
        CIDEMPR CHAR(30),
        BAIREMPR CHAR(30),
        CEPEMPR CHAR(8),
        FONEEMPR CHAR(12),
        DTADMISSAO DATE NOT NULL,
        FOTOEMPR BLOB SUB_TYPE 0 SEGMENT SIZE 80,
        STATUSEMPR CHAR(2) NOT NULL,
        SEXOEMPR CHAR(1) DEFAULT 'M' NOT NULL,
        DTNASCEMPR DATE,
        CTPSEMPR VARCHAR(20),
        SERIECTPSEMPR VARCHAR(6),
        UFCTPSEMPR CHAR(2),
        CERTRESERVEMPR VARCHAR(20),
        PISPASEPEMPR VARCHAR(20),
        RGEMPR CHAR(13),
        ORGEXPRHEMPR CHAR(10),
        CPFEMPR CHAR(11),
        UFRGEMPR CHAR(2),
        DTEXPRGEMPR DATE,
        TITELEITEMPR CHAR(15),
        ZONAELEITEMPR INTEGER,
        SECAOELEITEMPR INTEGER,
        CNHEMPR VARCHAR(20),
        MAEEMPR VARCHAR(80),
        PAIEMPR CHAR(80),
        COMPLENDEMPR VARCHAR(40),
        UFEMPR CHAR(2),
        DTDEMISSAOEMPR DATE,
        DDDEMPR CHAR(4),
        FONE2EMPR CHAR(12),
        CELEMPR CHAR(12),
        EMAILEMPR VARCHAR(40),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT RHEMPREGADOPK PRIMARY KEY (MATEMPR, CODFILIAL, CODEMP));

/* Table: RHEMPREGADOBENEF, Owner: SYSDBA */
CREATE TABLE RHEMPREGADOBENEF (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        MATEMPR INTEGER NOT NULL,
        CODEMPBN INTEGER NOT NULL,
        CODFILIALBN SMALLINT NOT NULL,
        CODBENEF INTEGER NOT NULL,
        QTDBENEF NUMERICDN,
        VLRTOTBENEF NUMERICDN,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT RHEMPREGADOBENEFPK PRIMARY KEY (MATEMPR, CODFILIAL, CODEMP, CODBENEF, CODFILIALBN, CODEMPBN));

/* Table: RHEMPREGADOR, Owner: SYSDBA */
CREATE TABLE RHEMPREGADOR (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODEMPR INTEGER NOT NULL,
        NOMEEMPR CHAR(60) NOT NULL,
        ATIVOEMPR CHAR(1) NOT NULL,
        CNPJEMPR CHAR(14),
        INSCEMPR VARCHAR(20),
        ENDEMPR CHAR(50),
        NUMEMPR INTEGER,
        BAIREMPR CHAR(30),
        CIDEMPR CHAR(30),
        UFEMPR CHAR(2),
        CEPEMPR CHAR(8),
        DDDEMPR CHAR(4),
        FONEEMPR CHAR(12),
        RAMALEMPR CHAR(6),
        DDDFAXEMPR CHAR(4),
        FAXEMPR VARCHAR(9),
        EMAILEMPR CHAR(50),
        CONTEMPR CHAR(40),
        OBSEMPR VARCHAR(10000),
        DDDCELEMPR CHAR(4),
        CELEMPR VARCHAR(9),
        SITEEMPR CHAR(50),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT user,
CONSTRAINT RHEMPREGADORPK PRIMARY KEY (CODEMPR, CODFILIAL, CODEMP));

/* Table: RHEMPREGADOSAL, Owner: SYSDBA */
CREATE TABLE RHEMPREGADOSAL (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        MATEMPR INTEGER NOT NULL,
        SEQSAL SMALLINT NOT NULL,
        VALORSAL NUMERICDN,
        CUSTOHORATRAB NUMERICDN,
        DTVIGOR DATE DEFAULT 'now' NOT NULL,
        OBSSAL VARCHAR(1000),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT RHEMPREGADOSALPK PRIMARY KEY (MATEMPR, SEQSAL, CODFILIAL, CODEMP));

/* Table: RHEXPEDIENTE, Owner: SYSDBA */
CREATE TABLE RHEXPEDIENTE (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTURNO SMALLINT NOT NULL,
        DTEXPED DATE DEFAULT 'today' NOT NULL,
        ANOEXPED SMALLINT DEFAULT 0 NOT NULL,
        MESEXPED SMALLINT DEFAULT 0 NOT NULL,
        HORASEXPED DECIMAL(15, 5) DEFAULT 0 NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT RHEXPEDIENTEPK PRIMARY KEY (DTEXPED, CODTURNO, CODFILIAL, CODEMP));

/* Table: RHEXPEDMES, Owner: SYSDBA */
CREATE TABLE RHEXPEDMES (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTURNO SMALLINT NOT NULL,
        ANOEXPED SMALLINT DEFAULT 0 NOT NULL,
        MESEXPED SMALLINT DEFAULT 0 NOT NULL,
        HORASEXPED NUMERIC(15, 5) DEFAULT 0 NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT RHEXPEDMESPK PRIMARY KEY (MESEXPED, ANOEXPED, CODTURNO, CODFILIAL, CODEMP));

/* Table: RHFUNCAO, Owner: SYSDBA */
CREATE TABLE RHFUNCAO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODFUNC INTEGER NOT NULL,
        DESCFUNC VARCHAR(100) NOT NULL,
        CBOFUNC VARCHAR(10),
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT RHFUNCAOPK PRIMARY KEY (CODFUNC, CODFILIAL, CODEMP));

/* Table: RHNIVELCURSO, Owner: SYSDBA */
CREATE TABLE RHNIVELCURSO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODNIVELCURSO SMALLINT NOT NULL,
        DESCNIVELCURSO CHAR(60) NOT NULL,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT RHNIVELCURSOPK PRIMARY KEY (CODNIVELCURSO, CODFILIAL, CODEMP));

/* Table: RHPONTO, Owner: SYSDBA */
CREATE TABLE RHPONTO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        MATEMPR INTEGER NOT NULL,
        DTPT DATE DEFAULT 'now' NOT NULL,
        HRPT TIME DEFAULT 'now' NOT NULL,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT RHPONTOPK PRIMARY KEY (DTPT, HRPT, MATEMPR, CODFILIAL, CODEMP));

/* Table: RHTABELAINSS, Owner: SYSDBA */
CREATE TABLE RHTABELAINSS (CODTABINSS INTEGER NOT NULL,
        TETO NUMERICDN NOT NULL,
        ALIQUOTA NUMERICDN NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT RHTABELAINSSPK PRIMARY KEY (CODTABINSS));

/* Table: RHTABELAIRRF, Owner: SYSDBA */
CREATE TABLE RHTABELAIRRF (CODTABIRRF INTEGER NOT NULL,
        TETO NUMERICDN NOT NULL,
        ALIQUOTA NUMERICDN NOT NULL,
        REDUCAODEPENDENTE NUMERICDN NOT NULL,
        DEDUCAO NUMERICDN NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT RHTABELAIRRFPK PRIMARY KEY (CODTABIRRF));

/* Table: RHTURNO, Owner: SYSDBA */
CREATE TABLE RHTURNO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTURNO SMALLINT NOT NULL,
        DESCTURNO CHAR(60) NOT NULL,
        NHSTURNO SMALLINT DEFAULT 0 NOT NULL,
        TIPOTURNO CHAR(1) DEFAULT 'N' NOT NULL,
        HINITURNO TIMEDN NOT NULL,
        HFIMTURNO TIMEDN NOT NULL,
        HINIINTTURNO TIMEDN,
        HFIMINTTURNO TIMEDN,
        TOLENTRADA SMALLINT DEFAULT 0 NOT NULL,
        TOLSAIDA SMALLINT DEFAULT 0 NOT NULL,
        TRABSABTURNO CHAR(1) DEFAULT 'N' NOT NULL,
        TRABDOMTURNO CHAR(1) DEFAULT 'N' NOT NULL,
        PERCBHTBSABTURNO DECIMAL(15, 5) DEFAULT 0 NOT NULL,
        PERCBHTBDOMTURNO DECIMAL(15, 5) DEFAULT 0 NOT NULL,
        PERCBHTBFERTURNO DECIMAL(15, 5) DEFAULT 0 NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT RHTURNOPK PRIMARY KEY (CODTURNO, CODFILIAL, CODEMP));

/* Table: RHVAGA, Owner: SYSDBA */
CREATE TABLE RHVAGA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODVAGA INTEGER NOT NULL,
        CODEMPEM INTEGER NOT NULL,
        CODFILIALEM SMALLINT NOT NULL,
        CODEMPR INTEGER NOT NULL,
        CODEMPFC INTEGER NOT NULL,
        CODFILIALFC SMALLINT NOT NULL,
        CODFUNC INTEGER NOT NULL,
        FAIXASALINI NUMERICDN NOT NULL,
        FAIXASALFIM NUMERICDN NOT NULL,
        CODEMPTN INTEGER,
        CODFILIALTN SMALLINT,
        CODTURNO SMALLINT,
        STVAGA CHAR(2) DEFAULT 'AB' NOT NULL,
        DTULTST DATE DEFAULT 'now' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT RHVAGAPK PRIMARY KEY (CODVAGA, CODFILIAL, CODEMP));

/* Table: RHVAGACANDIDATO, Owner: SYSDBA */
CREATE TABLE RHVAGACANDIDATO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODVAGA INTEGER NOT NULL,
        CODEMPCA INTEGER NOT NULL,
        CODFILIALCA SMALLINT NOT NULL,
        CODCAND INTEGER NOT NULL,
        STVAGACAND CHAR(2) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT RHVAGACANDPK PRIMARY KEY (CODVAGA, CODFILIAL, CODEMP, CODCAND, CODFILIALCA, CODEMPCA));

/* Table: RHVAGACARACQUALI, Owner: SYSDBA */
CREATE TABLE RHVAGACARACQUALI (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODVAGA INTEGER NOT NULL,
        CODEMPCT INTEGER NOT NULL,
        CODFILIALCT SMALLINT NOT NULL,
        CODCARAC CHAR(15) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT RHVAGACTRQUALIPK PRIMARY KEY (CODVAGA, CODFILIAL, CODEMP, CODCARAC, CODFILIALCT, CODEMPCT));

/* Table: RHVAGACARACREST, Owner: SYSDBA */
CREATE TABLE RHVAGACARACREST (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODVAGA INTEGER NOT NULL,
        CODEMPCT INTEGER NOT NULL,
        CODFILIALCT SMALLINT NOT NULL,
        CODCARAC CHAR(15) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT RHVAGACTRESTPK PRIMARY KEY (CODVAGA, CODFILIAL, CODEMP, CODCARAC, CODFILIALCT, CODEMPCT));

/* Table: RHVAGACURSO, Owner: SYSDBA */
CREATE TABLE RHVAGACURSO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODVAGA INTEGER NOT NULL,
        CODEMPCS INTEGER NOT NULL,
        CODFILIALCS SMALLINT NOT NULL,
        CODCURSO INTEGER NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT RHVAGACURSOPK PRIMARY KEY (CODVAGA, CODFILIAL, CODEMP, CODCURSO, CODFILIALCS, CODEMPCS));

/* Table: RHVAGASTATUS, Owner: SYSDBA */
CREATE TABLE RHVAGASTATUS (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODVAGA INTEGER NOT NULL,
        SQSTVAGA INTEGER NOT NULL,
        STVAGA CHAR(2) DEFAULT 'AB' NOT NULL,
        DTSTATUS DATE DEFAULT 'now' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT RHVAGASTATUSPK PRIMARY KEY (CODVAGA, CODFILIAL, CODEMP, SQSTVAGA));

/* Table: SGACESSOEU, Owner: SYSDBA */
CREATE TABLE SGACESSOEU (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        IDUSU CHAR(8) NOT NULL,
        CODEMPFL INTEGER NOT NULL,
        CODFILIALFL SMALLINT NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGACESSOEUPK PRIMARY KEY (CODFILIALFL, CODEMPFL, IDUSU, CODEMP, CODFILIAL));

/* Table: SGACESSOMG, Owner: SYSDBA */
CREATE TABLE SGACESSOMG (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        IDGRPUSU CHAR(8) NOT NULL,
        CODSIS INTEGER NOT NULL,
        CODMODU INTEGER NOT NULL,
        CODMENU INTEGER NOT NULL,
        TPACESSOMG CHAR(1) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGACESSOMGPK PRIMARY KEY (CODMENU, CODMODU, CODSIS, IDGRPUSU, CODFILIAL, CODEMP));

/* Table: SGACESSOMU, Owner: SYSDBA */
CREATE TABLE SGACESSOMU (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        IDUSU CHAR(8) NOT NULL,
        CODSIS INTEGER NOT NULL,
        CODMODU INTEGER NOT NULL,
        CODMENU INTEGER NOT NULL,
        TPACESSOMU CHAR(1) NOT NULL,
        PLANOMU CHAR(1) DEFAULT 'O' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGACESSOMUPK PRIMARY KEY (CODMENU, CODMODU, CODSIS, IDUSU, CODFILIAL, CODEMP));

/* Table: SGAGENDA, Owner: SYSDBA */
CREATE TABLE SGAGENDA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        TIPOAGE CHAR(5) NOT NULL,
        CODAGE INTEGER NOT NULL,
        CODAGD INTEGER NOT NULL,
        DATAAGD DATE NOT NULL,
        DTAINIAGD DATE NOT NULL,
        HRINIAGD TIME NOT NULL,
        DTAFIMAGD DATE NOT NULL,
        HRFIMAGD TIME NOT NULL,
        ASSUNTOAGD VARCHAR(150) NOT NULL,
        DESCAGD VARCHAR(10000) NOT NULL,
        PRIORAGD SMALLINT NOT NULL,
        SITAGD CHAR(2) DEFAULT 'PE' NOT NULL,
        CODEMPAE INTEGER NOT NULL,
        CODFILIALAE SMALLINT NOT NULL,
        CODAGEEMIT INTEGER NOT NULL,
        TIPOAGEEMIT CHAR(5) NOT NULL,
        CAAGD CHAR(2) DEFAULT 'PR' NOT NULL,
        CODEMPTA INTEGER NOT NULL,
        CODFILIALTA SMALLINT NOT NULL,
        CODTIPOAGD INTEGER NOT NULL,
        RESOLUCAOMOTIVO VARCHAR(10000),
        CODEMPAR INTEGER,
        CODFILIALAR SMALLINT,
        TIPOAGEAR CHAR(5),
        CODAGEAR INTEGER,
        CODAGDAR INTEGER,
        DIATODO CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGAGENDAPK PRIMARY KEY (CODAGE, TIPOAGE, CODAGD, CODFILIAL, CODEMP));

/* Table: SGAGENTE, Owner: SYSDBA */
CREATE TABLE SGAGENTE (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        TIPOAGE CHAR(5) NOT NULL,
        CODAGE INTEGER NOT NULL,
        DESCAGE CHAR(50) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT user NOT NULL,
        DTALT DATE,
        HALT TIME,
        IDUSUALT CHAR(8),
CONSTRAINT SGAGENTEPK PRIMARY KEY (CODAGE, TIPOAGE, CODFILIAL, CODEMP));

/* Table: SGATRIBUICAO, Owner: SYSDBA */
CREATE TABLE SGATRIBUICAO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        IDATRIB CHAR(10) NOT NULL,
        DESCATRIB CHAR(50) NOT NULL,
        RMAATRIB CHAR(2) NOT NULL,
        OBSATRIB VARCHAR(500),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGATRIBUICAOPK PRIMARY KEY (IDATRIB, CODFILIAL, CODEMP));

/* Table: SGATRIBUSU, Owner: SYSDBA */
CREATE TABLE SGATRIBUSU (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        IDATRIB CHAR(10) NOT NULL,
        CODEMPUU INTEGER NOT NULL,
        CODFILIALUU SMALLINT NOT NULL,
        IDUSU CHAR(8) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE,
        HALT TIME,
        IDUSUALT CHAR(8),
CONSTRAINT SGATRIBUSUPK PRIMARY KEY (IDUSU, CODFILIALUU, CODEMPUU, IDATRIB, CODFILIAL, CODEMP));

/* Table: SGBAIRRO, Owner: SYSDBA */
CREATE TABLE SGBAIRRO (CODBAIRRO INTEGER NOT NULL,
        CODMUNIC CHAR(7) NOT NULL,
        SIGLAUF CHAR(2) NOT NULL,
        CODPAIS SMALLINT NOT NULL,
        NOMEBAIRRO CHAR(40),
        VLRFRETE NUMERICDN,
        QTDFRETE NUMERICDN,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGBAIRROPK PRIMARY KEY (CODBAIRRO, CODMUNIC, SIGLAUF, CODPAIS));

/* Table: SGCATIMG, Owner: SYSDBA */
CREATE TABLE SGCATIMG (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCATIMG INTEGER NOT NULL,
        DESCCATIMG VARCHAR(100) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGCATIMGPK PRIMARY KEY (CODCATIMG, CODFILIAL, CODEMP));

/* Table: SGCNAE, Owner: SYSDBA */
CREATE TABLE SGCNAE (CODCNAE VARCHAR(15) NOT NULL,
        DESCCNAE VARCHAR(100) NOT NULL,
        SECCNAE CHAR(1),
        DIVCNAE VARCHAR(5),
        GRUPCNAE VARCHAR(5),
        DTREVCNAE DATE,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT VARCHAR(8) DEFAULT USER NOT NULL,
CONSTRAINT SGCNAEPK PRIMARY KEY (CODCNAE));

/* Table: SGCONEXAO, Owner: SYSDBA */
CREATE TABLE SGCONEXAO (NRCONEXAO INTEGER NOT NULL,
        CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        IDUSU CHAR(10) NOT NULL,
        CODFILIALSEL SMALLINT NOT NULL,
        CODTERM INTEGER,
        CONECTADO INTEGER DEFAULT 0 NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGCONEXAOPK PRIMARY KEY (NRCONEXAO));

/* Table: SGDEBUG, Owner: SYSDBA */
CREATE TABLE SGDEBUG (SEQ INTEGER NOT NULL,
        DATA DATE DEFAULT 'today',
        HORA TIME DEFAULT 'now',
        ROTINA VARCHAR(60),
        TEXTO VARCHAR(100));

/* Table: SGEMPRESA, Owner: SYSDBA */
CREATE TABLE SGEMPRESA (CODEMP INTEGER NOT NULL,
        RAZEMP CHAR(50),
        NOMEEMP CHAR(50),
        CNPJEMP CHAR(14),
        INSCEMP VARCHAR(20),
        ENDEMP CHAR(50),
        NUMEMP INTEGER,
        COMPLEMP CHAR(20),
        BAIREMP CHAR(30),
        CEPEMP CHAR(8),
        CIDEMP CHAR(30),
        UFEMP CHAR(2),
        DDDEMP CHAR(4),
        FONEEMP CHAR(12),
        FAXEMP VARCHAR(9),
        EMAILEMP CHAR(50),
        WWWEMP CHAR(50),
        CODEANEMP CHAR(10),
        NOMECONTEMP CHAR(40),
        MULTIALMOXEMP CHAR(1) DEFAULT 'N' NOT NULL,
        FOTOEMP BLOB SUB_TYPE 0 SEGMENT SIZE 80,
        CODMUNIC CHAR(7),
        SIGLAUF CHAR(2),
        CODPAIS SMALLINT,
        PERCISSEMP NUMERIC(6, 2) DEFAULT 0,
        CODPAISEMP CHAR(3),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGEMPRESAPK PRIMARY KEY (CODEMP));

/* Table: SGEQVCLIFOR, Owner: SYSDBA */
CREATE TABLE SGEQVCLIFOR (CODEMPCL INTEGER NOT NULL,
        CODFILIALCL INTEGER NOT NULL,
        CODCLI INTEGER NOT NULL,
        CODEMPFR INTEGER NOT NULL,
        CODFILIALFR INTEGER NOT NULL,
        CODFOR INTEGER NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGEQVCLIFORPK PRIMARY KEY (CODCLI, CODFILIALCL, CODEMPCL, CODFOR, CODFILIALFR, CODEMPFR));

/* Table: SGESTACAO, Owner: SYSDBA */
CREATE TABLE SGESTACAO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODEST SMALLINT NOT NULL,
        DESCEST CHAR(50) NOT NULL,
        MODODEMOEST CHAR(1) DEFAULT 'N' NOT NULL,
        NFEEST CHAR(1) DEFAULT 'N' NOT NULL,
        ATIVAEST CHAR(1) DEFAULT 'S' NOT NULL,
        TAMFONTETXT SMALLINT,
        FONTETXT CHAR(30),
        PATHCACERTS VARCHAR(256),
        CODEMPPX INTEGER,
        CODFILIALPX SMALLINT,
        CODPROXY INTEGER,
        HOSTEST VARCHAR(100),
        IPEST VARCHAR(20),
        MACADDRESSEST VARCHAR(20),
        DESCLOCALEST VARCHAR(1000),
        NOMECONTEST VARCHAR(50),
        RAMALEST VARCHAR(10),
        EMAILEST VARCHAR(80),
        PATHPDFREADER VARCHAR(256),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE,
        HALT TIME,
        IDUSUALT CHAR(8),
CONSTRAINT SGESTACAOPK PRIMARY KEY (CODEST, CODFILIAL, CODEMP));

/* Table: SGESTACAOBAL, Owner: SYSDBA */
CREATE TABLE SGESTACAOBAL (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODEST INTEGER NOT NULL,
        NROBAL SMALLINT NOT NULL,
        DRIVERBAL CHAR(50) NOT NULL,
        PORTABAL SMALLINT DEFAULT 0 NOT NULL,
        SPEEDBAL SMALLINT default 9600 NOT NULL,
        BITSBAL SMALLINT default 8 NOT NULL,
        STOPBITBAL SMALLINT default 2 NOT NULL,
        PARITYBAL SMALLINT default 0 NOT NULL,
        TIPOPROCRECMERC CHAR(2) DEFAULT 'TO' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE,
        HALT TIME,
        IDUSUALT CHAR(8),
CONSTRAINT SGESTACAOBALPK PRIMARY KEY (CODEST, NROBAL, CODFILIAL, CODEMP));

/* Table: SGESTACAOIMP, Owner: SYSDBA */
CREATE TABLE SGESTACAOIMP (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODEST INTEGER NOT NULL,
        NROIMP SMALLINT NOT NULL,
        CODEMPIP INTEGER NOT NULL,
        CODFILIALIP SMALLINT NOT NULL,
        CODIMP INTEGER NOT NULL,
        CODEMPPP INTEGER NOT NULL,
        CODFILIALPP SMALLINT NOT NULL,
        CODPAPEL CHAR(10) NOT NULL,
        PORTAWIN CHAR(50) NOT NULL,
        PORTALIN CHAR(50) NOT NULL,
        IMPPAD CHAR(1) DEFAULT 'N' NOT NULL,
        TIPOUSOIMP CHAR(2) NOT NULL,
        IMPGRAFICA CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE,
        HALT TIME,
        IDUSUALT CHAR(8),
CONSTRAINT SGESTACAOIMPPK PRIMARY KEY (CODEST, NROIMP, CODFILIAL, CODEMP));

/* Table: SGESTCIVIL, Owner: SYSDBA */
CREATE TABLE SGESTCIVIL (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODESTCIVIL CHAR(2) NOT NULL,
        DESCESTCIVIL CHAR(50) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGESTCIVILPK PRIMARY KEY (CODESTCIVIL, CODFILIAL, CODEMP));

/* Table: SGFERIADO, Owner: SYSDBA */
CREATE TABLE SGFERIADO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        DATAFER DATE NOT NULL,
        DESCFER CHAR(50) NOT NULL,
        BANCFER CHAR(1) default 'S' NOT NULL,
        TRABFER CHAR(1) DEFAULT 'S' NOT NULL,
        OPTFER CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT VARCHAR(128) DEFAULT USER NOT NULL,
CONSTRAINT SGFERIADOPK PRIMARY KEY (DATAFER, CODFILIAL, CODEMP));

/* Table: SGFILIAL, Owner: SYSDBA */
CREATE TABLE SGFILIAL (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        RAZFILIAL CHAR(50) NOT NULL,
        NOMEFILIAL CHAR(50) NOT NULL,
        MZFILIAL CHAR(1) NOT NULL,
        CNPJFILIAL CHAR(14),
        INSCFILIAL VARCHAR(20),
        ENDFILIAL CHAR(50),
        NUMFILIAL INTEGER,
        COMPLFILIAL CHAR(20),
        BAIRFILIAL CHAR(30),
        CEPFILIAL CHAR(8),
        CIDFILIAL CHAR(30),
        UFFILIAL CHAR(2),
        DDDFILIAL CHAR(4),
        FONEFILIAL CHAR(12),
        FAXFILIAL VARCHAR(9),
        EMAILFILIAL CHAR(50),
        WWWFILIAL CHAR(50),
        CODDISTFILIAL INTEGER,
        PERCPISFILIAL NUMERIC(5, 2) DEFAULT 0,
        PERCCOFINSFILIAL NUMERIC(5, 2) DEFAULT 0,
        PERCIRFILIAL NUMERIC(5, 2) DEFAULT 0,
        PERCCSOCIALFILIAL NUMERIC(5, 2) DEFAULT 0,
        SIMPLESFILIAL CHAR(1),
        PERCSIMPLESFILIAL NUMERIC(9, 2),
        CODMUNIC CHAR(7),
        SIGLAUF CHAR(2),
        CODPAIS SMALLINT,
        CODEMPUC INTEGER,
        CODFILIALUC SMALLINT,
        CODUNIFCOD INTEGER,
        INSCMUNFILIAL CHAR(15),
        CNAEFILIAL CHAR(7),
        PERCISSFILIAL NUMERIC(5, 2),
        CONTRIBIPIFILIAL CHAR(1) DEFAULT 'N' NOT NULL,
        TIMBREFILIAL BLOB SUB_TYPE 0 SEGMENT SIZE 80,
        PERFILFILIAL CHAR(1),
        PERFILEPC CHAR(1),
        INDATIVFILIAL CHAR(1),
        INDATIVEPC CHAR(1),
        INDNATPJFILIAL CHAR(2),
        CODEMPCO INTEGER,
        CODFILIALCO SMALLINT,
        CODFOR INTEGER,
        SUFRAMA CHAR(9),
        CODINCTRIB CHAR(1),
        INDAPROCRED CHAR(1),
        CODTIPOCONT CHAR(1),
        INDREGCUM CHAR(1),
        UNIDFRANQUEADA CHAR(30),
        MARCAFRANQUEADORA CHAR(30),
        WWWFRANQUEADORA CHAR(50),
        CODRECEITA VARCHAR(20),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGFILIALPK PRIMARY KEY (CODFILIAL, CODEMP));

/* Table: SGFLUXO, Owner: SYSDBA */
CREATE TABLE SGFLUXO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODFLUXO INTEGER NOT NULL,
        DESCFLUXO CHAR(50) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGFLUXOPK PRIMARY KEY (CODFLUXO, CODFILIAL, CODEMP));

/* Table: SGGATILHO, Owner: SYSDBA */
CREATE TABLE SGGATILHO (CODEMP INTEGER NOT NULL,
        CODOBJ INTEGER NOT NULL,
        DISPGAT CHAR(2) NOT NULL,
        ATIVOGAT CHAR(1) DEFAULT 'S' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGGATILHOPK PRIMARY KEY (CODOBJ, DISPGAT, CODEMP));

/* Table: SGGRAUINST, Owner: SYSDBA */
CREATE TABLE SGGRAUINST (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODGRI INTEGER NOT NULL,
        DESCGRI CHAR(50) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGGRAUINSTPK PRIMARY KEY (CODGRI, CODFILIAL, CODEMP));

/* Table: SGGRPUSU, Owner: SYSDBA */
CREATE TABLE SGGRPUSU (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        IDGRPUSU CHAR(8) NOT NULL,
        NOMEGRPUSU CHAR(50) NOT NULL,
        COMENTGRPUSU VARCHAR(10000),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGGRPUSUPK PRIMARY KEY (IDGRPUSU, CODFILIAL, CODEMP));

/* Table: SGIMAGEM, Owner: SYSDBA */
CREATE TABLE SGIMAGEM (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODIMG INTEGER NOT NULL,
        DESCIMG VARCHAR(100) NOT NULL,
        CODEMPCI INTEGER NOT NULL,
        CODFILIALCI SMALLINT NOT NULL,
        CODCATIMG INTEGER NOT NULL,
        BINIMG BLOB SUB_TYPE 0 SEGMENT SIZE 80 NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGIMAGEMPK PRIMARY KEY (CODIMG, CODFILIAL, CODEMP));

/* Table: SGIMPRESSORA, Owner: SYSDBA */
CREATE TABLE SGIMPRESSORA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODIMP INTEGER NOT NULL,
        DESCIMP CHAR(40) NOT NULL,
        TIPOIMP CHAR(2) NOT NULL,
        LINPAGIMP INTEGER,
        NSERIEIMP VARCHAR(20),
        PORTAWINIMP CHAR(4),
        PORTALINIMP CHAR(60),
        CODEMPPL INTEGER,
        CODFILIALPL SMALLINT,
        CODPAPEL CHAR(10),
        DESTIMP CHAR(2) DEFAULT 'TO',
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGIMPRESSORAPK PRIMARY KEY (CODIMP, CODFILIAL, CODEMP));

/* Table: SGITFLUXO, Owner: SYSDBA */
CREATE TABLE SGITFLUXO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODFLUXO INTEGER NOT NULL,
        SEQITFLUXO SMALLINT NOT NULL,
        CODEMPPC INTEGER NOT NULL,
        CODFILIALPC SMALLINT NOT NULL,
        CODPROC INTEGER NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS DATE DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGITFLUXOPK PRIMARY KEY (CODFLUXO, SEQITFLUXO, CODFILIAL, CODEMP));

/* Table: SGITPREFERE6, Owner: SYSDBA */
CREATE TABLE SGITPREFERE6 (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODEMPBO INTEGER NOT NULL,
        CODFILIALBO SMALLINT NOT NULL,
        CODBANCO CHAR(3) NOT NULL,
        TIPOFEBRABAN CHAR(2) NOT NULL,
        MDECOB CHAR(2) DEFAULT '00' NOT NULL,
        CODCONV VARCHAR(20),
        CONVCOB VARCHAR(20),
        VERLAYOUT VARCHAR(2),
        IDENTSERV VARCHAR(17),
        CONTACOMPR VARCHAR(16),
        IDENTAMBCLI VARCHAR(1),
        IDENTAMBBCO VARCHAR(1),
        NROSEQ INTEGER,
        CODEMPCA INTEGER,
        CODFILIALCA SMALLINT,
        NUMCONTA CHAR(10),
        FORCADTIT SMALLINT DEFAULT 1,
        TIPODOC SMALLINT DEFAULT 1,
        IDENTEMITBOL SMALLINT DEFAULT 1,
        IDENTDISTBOL SMALLINT DEFAULT 1,
        ESPECTIT SMALLINT DEFAULT 1,
        CODJUROS SMALLINT DEFAULT 1,
        VLRPERCJUROS NUMERIC(15, 5) DEFAULT 0.0,
        CODDESC SMALLINT DEFAULT 1,
        VLRPERCDESC NUMERIC(15, 5) DEFAULT 0.0,
        VLRPERCMULTA NUMERIC(15, 5) DEFAULT 0.0,
        CODPROT SMALLINT DEFAULT 3,
        DIASPROT SMALLINT DEFAULT 0,
        CODBAIXADEV SMALLINT DEFAULT 1,
        DIASBAIXADEV SMALLINT DEFAULT 1,
        ACEITE CHAR(1) DEFAULT 'N',
        PADRAOCNAB CHAR(4) DEFAULT '240' NOT NULL,
        CAMINHOREMESSA VARCHAR(300),
        CAMINHORETORNO VARCHAR(300),
        BACKUPREMESSA VARCHAR(300),
        BACKUPRETORNO VARCHAR(300),
        CODINSTR SMALLINT DEFAULT 1,
        CODOUTINSTR SMALLINT DEFAULT 65,
        PADRAOSIACC CHAR(4) DEFAULT '150' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT CHAR(8) DEFAULT USER NOT NULL,
CONSTRAINT SGITPREFERE6PK PRIMARY KEY (CODBANCO, TIPOFEBRABAN, CODFILIALBO, CODEMPBO, CODFILIAL, CODEMP));

/* Table: SGITPROCESSO, Owner: SYSDBA */
CREATE TABLE SGITPROCESSO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODPROC INTEGER NOT NULL,
        SEQITPROC SMALLINT NOT NULL,
        CODEMPTA INTEGER NOT NULL,
        CODFILIALTA SMALLINT NOT NULL,
        CODTAREFA INTEGER NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT DATE DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGITPROCESSOPK PRIMARY KEY (CODPROC, SEQITPROC, CODFILIAL, CODEMP));

/* Table: SGITTABELA, Owner: SYSDBA */
CREATE TABLE SGITTABELA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTB SMALLINT NOT NULL,
        CODITTB INTEGER NOT NULL,
        DESCITTB CHAR(50) NOT NULL,
        PADRAOITTB CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGITTABELAPK PRIMARY KEY (CODITTB, CODTB, CODFILIAL, CODEMP));

/* Table: SGLOG, Owner: SYSDBA */
CREATE TABLE SGLOG (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODLOG INTEGER NOT NULL,
        DATALOG DATE DEFAULT 'now' NOT NULL,
        HORALOG TIME DEFAULT 'now' NOT NULL,
        CODEMPUS INTEGER NOT NULL,
        CODFILIALUS SMALLINT NOT NULL,
        IDUSU CHAR(8) NOT NULL,
        CLASLOG CHAR(2) DEFAULT 01 NOT NULL,
        TIPOLOG CHAR(3) NOT NULL,
        CODEMPCX INTEGER NOT NULL,
        CODFILIALCX SMALLINT NOT NULL,
        CODCAIXA INTEGER NOT NULL,
        DESCLOG CHAR(60) NOT NULL,
        OBSLOG VARCHAR(1000),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGLOGPK PRIMARY KEY (CODLOG, CODFILIAL, CODEMP));

/* Table: SGLOGCRUD, Owner: SYSDBA */
CREATE TABLE SGLOGCRUD (ID BIGINT NOT NULL,
        TABLENAME VARCHAR(100) NOT NULL,
        OPERATION CHAR(1) DEFAULT 'U' NOT NULL,
        EVENTLOG CHAR(1) DEFAULT 'B' NOT NULL,
        DTLOG DATE DEFAULT 'now' NOT NULL,
        HLOG TIME DEFAULT 'now' NOT NULL,
        IDUSU VARCHAR(128) DEFAULT user NOT NULL,
        XML BLOB SUB_TYPE TEXT SEGMENT SIZE 80 NOT NULL,
CONSTRAINT SGLOGCRUDPK PRIMARY KEY (ID));

/* Table: SGMENU, Owner: SYSDBA */
CREATE TABLE SGMENU (CODSIS INTEGER NOT NULL,
        CODMODU INTEGER NOT NULL,
        CODMENU INTEGER NOT NULL,
        DESCMENU CHARBIGDLEDN NOT NULL,
        NOMEMENU CHARBIGDLEDN NOT NULL,
        PLANOMENU CHAR(1) DEFAULT 'O' NOT NULL,
        ACAOMENU CHARBIGDLEDN NOT NULL,
        CODSISPAI INTEGER,
        CODMODUPAI INTEGER,
        CODMENUPAI INTEGER,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGMENUPK PRIMARY KEY (CODMENU, CODMODU, CODSIS));

/* Table: SGMENUOBJ, Owner: SYSDBA */
CREATE TABLE SGMENUOBJ (CODEMP INTEGER NOT NULL,
        IDOBJ CHAR(30) NOT NULL,
        CODSIS INTEGER NOT NULL,
        CODMODU INTEGER NOT NULL,
        CODMENU INTEGER NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGMENUOBJOK PRIMARY KEY (CODMENU, CODMODU, CODSIS, IDOBJ, CODEMP));

/* Table: SGMODETIQUETA, Owner: SYSDBA */
CREATE TABLE SGMODETIQUETA (CODEMP INTEGER NOT NULL,
        CODFILIAL INTEGER NOT NULL,
        CODMODETIQ INTEGER NOT NULL,
        DESCMODETIQ CHAR(30) NOT NULL,
        NCOLMODETIQ SMALLINT DEFAULT 0,
        EECMODETIQ SMALLINT DEFAULT 0,
        TXAMODETIQ VARCHAR(1000),
        CODEMPPL INTEGER,
        CODFILIALPL SMALLINT,
        CODPAPEL CHAR(10),
        COMPRIMIDO CHAR(1) DEFAULT 'S' NOT NULL,
        POSSCRIPT CHAR(1) DEFAULT 'N',
        MODETIQ VARCHAR(30),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGMODETIQUETAPK PRIMARY KEY (CODMODETIQ, CODFILIAL, CODEMP));

/* Table: SGMODULO, Owner: SYSDBA */
CREATE TABLE SGMODULO (CODSIS INTEGER NOT NULL,
        CODMODU INTEGER NOT NULL,
        DESCMODU CHAR(50) NOT NULL,
        COMENTMODU VARCHAR(10000),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGMODULOPK PRIMARY KEY (CODMODU, CODSIS));

/* Table: SGMUNICIPIO, Owner: SYSDBA */
CREATE TABLE SGMUNICIPIO (CODMUNIC CHAR(7) NOT NULL,
        SIGLAUF CHAR(2) NOT NULL,
        CODPAIS SMALLINT NOT NULL,
        NOMEMUNIC CHAR(80) NOT NULL,
        DDDMUNIC CHAR(4) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGMUNICIPIOPK PRIMARY KEY (CODMUNIC, SIGLAUF, CODPAIS));

/* Table: SGOBJETO, Owner: SYSDBA */
CREATE TABLE SGOBJETO (CODEMP INTEGER NOT NULL,
        IDOBJ CHAR(30) NOT NULL,
        DESCOBJ CHAR(50) NOT NULL,
        TIPOOBJ CHAR(2) NOT NULL,
        COMENTOBJ VARCHAR(10000),
        USOMEOBJ CHAR(1) DEFAULT 'N',
        SIGLAOBJ CHAR(8),
        NIVELOBJ SMALLINT DEFAULT -1 NOT NULL,
        NUMREGOBJ INTEGER DEFAULT 0 NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGOBJETOPK PRIMARY KEY (IDOBJ, CODEMP));

/* Table: SGOBJETOTB, Owner: SYSDBA */
CREATE TABLE SGOBJETOTB (CODEMP INTEGER NOT NULL,
        IDOBJ CHAR(30) NOT NULL,
        CODEMPTB INTEGER NOT NULL,
        CODFILIALTB SMALLINT NOT NULL,
        CODTB SMALLINT NOT NULL,
        OBRIGOBJTB CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGOBJETOTBPK PRIMARY KEY (CODTB, CODFILIALTB, CODEMPTB, IDOBJ, CODEMP));

/* Table: SGPAIS, Owner: SYSDBA */
CREATE TABLE SGPAIS (CODPAIS SMALLINT NOT NULL,
        NOMEPAIS CHAR(50) NOT NULL,
        SIGLA3CPAIS CHAR(3) NOT NULL,
        DDIPAIS SMALLINT,
        SIGLA2CPAIS CHAR(2) NOT NULL,
        CODBACENPAIS INTEGER,
        CODEANPAIS CHAR(3),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGPAISPK PRIMARY KEY (CODPAIS));

/* Table: SGPAPEL, Owner: SYSDBA */
CREATE TABLE SGPAPEL (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODPAPEL CHAR(10) NOT NULL,
        DESCPAPEL CHAR(40),
        LINPAPEL INTEGER,
        ALTPAPEL INTEGER,
        LARGPAPEL INTEGER,
        CLASSNOTAPAPEL CHAR(20),
        COLPAPEL SMALLINT,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGPAPELPK PRIMARY KEY (CODPAPEL, CODFILIAL, CODEMP));

/* Table: SGPREFERE1, Owner: SYSDBA */
CREATE TABLE SGPREFERE1 (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        USAREFPROD CHAR(1) NOT NULL,
        CODTIPOMOV INTEGER,
        CODEMPTM SMALLINT,
        CODFILIALTM SMALLINT,
        USAPEDSEQ CHAR(1),
        USAORCSEQ CHAR(1) DEFAULT 'N' NOT NULL,
        FILTRO CHAR(2),
        USALIQREL CHAR(1) DEFAULT 'N',
        TIPOPRECOCUSTO CHAR(1) DEFAULT 'M' NOT NULL,
        ANOCENTROCUSTO SMALLINT,
        OBSORCPAD VARCHAR(10000),
        CODTIPOMOV2 INTEGER,
        CODFILIALT2 SMALLINT,
        CODEMPT2 INTEGER,
        CLASSORC VARCHAR(80),
        CLASSORCPD VARCHAR(80),
        CLASSORCLAUDOSUS VARCHAR(80),
        CLASSORCCTALUGUEL VARCHAR(80),
        TITORCTXT01 CHAR(20),
        CODTIPOMOV3 INTEGER,
        CODFILIALT3 SMALLINT,
        CODEMPT3 INTEGER,
        ORDNOTA CHAR(1),
        SETORVENDA CHAR(1) DEFAULT 'C',
        PREFCRED CHAR(1),
        TIPOPREFCRED CHAR(2) DEFAULT 'AB' NOT NULL,
        CODEMPMO INTEGER NOT NULL,
        CODFILIALMO INTEGER NOT NULL,
        CODMOEDA CHAR(4) NOT NULL,
        CODTIPOMOV4 INTEGER,
        CODFILIALT4 INTEGER,
        CODEMPT4 INTEGER,
        USACLASCOMIS CHAR(1),
        PERCPRECOCUSTO NUMERIC(9, 2) DEFAULT 0 NOT NULL,
        CODGRUP CHAR(14),
        CODFILIALGP INTEGER,
        CODEMPGP INTEGER,
        CODMARCA CHAR(6),
        CODFILIALMC INTEGER,
        CODEMPMC INTEGER,
        RGCLIOBRIG CHAR(1) DEFAULT 'S' NOT NULL,
        TABFRETEVD CHAR(1) DEFAULT 'S' NOT NULL,
        TABADICVD CHAR(1) DEFAULT 'S' NOT NULL,
        TRAVATMNFVD CHAR(1) DEFAULT 'S' NOT NULL,
        TIPOVALIDORC CHAR(1) DEFAULT 'D',
        CLIMESMOCNPJ CHAR(1) DEFAULT 'N',
        CODTBJ INTEGER,
        CODEMPTJ INTEGER,
        CODFILIALTJ INTEGER,
        CNPJOBRIGCLI CHAR(1) DEFAULT 'S' NOT NULL,
        JUROSPOSCALC CHAR(1),
        CODEMPFR INTEGER,
        CODFILIALFR INTEGER,
        CODFOR INTEGER,
        CODEMPTN INTEGER,
        CODFILIALTN SMALLINT,
        CODTRAN INTEGER,
        CODEMPTF INTEGER,
        CODFILIALTF INTEGER,
        CODTIPOFOR INTEGER,
        CODEMPT5 INTEGER,
        CODFILIALT5 INTEGER,
        CODTIPOMOV5 INTEGER,
        ESTLOTNEG CHAR(1) DEFAULT 'N',
        ESTNEG CHAR(1) DEFAULT 'N',
        NATVENDA CHAR(1) DEFAULT 'S',
        IPIVENDA CHAR(1) DEFAULT 'N',
        CUSTOSICMS CHAR(1) DEFAULT 'S' NOT NULL,
        CODEMPPG INTEGER,
        CODFILIALPG SMALLINT,
        CODPLANOPAG INTEGER,
        CODEMPTB INTEGER,
        CODFILIALTB SMALLINT,
        CODTAB INTEGER,
        CODEMPCE INTEGER,
        CODFILIALCE SMALLINT,
        CODCLASCLI INTEGER,
        CASASDEC SMALLINT default 2,
        CASASDECFIN SMALLINT DEFAULT 2,
        COMISPDUPL CHAR(1) DEFAULT 'S',
        CODEMPT6 INTEGER,
        CODFILIALT6 SMALLINT,
        CODTIPOMOV6 INTEGER,
        BLOQVENDA CHAR(1) DEFAULT 'S' NOT NULL,
        BLOQCOMPRA CHAR(1) DEFAULT 'N' NOT NULL,
        VENDAMATPRIM CHAR(1) DEFAULT 'N' NOT NULL,
        VENDAPATRIM CHAR(1) DEFAULT 'N' NOT NULL,
        PEPSPROD CHAR(1) DEFAULT 'N' NOT NULL,
        CNPJFOROBRIG CHAR(1) DEFAULT 'S' NOT NULL,
        INSCESTFOROBRIG CHAR(1) DEFAULT 'S' NOT NULL,
        BUSCAPRODSIMILAR CHAR(1) DEFAULT 'N' NOT NULL,
        MULTIALMOX CHAR(1) DEFAULT 'N' NOT NULL,
        CODEMPT8 INTEGER,
        CODFILIALT8 SMALLINT,
        CODTIPOMOV8 INTEGER,
        ESTNEGGRUP CHAR(1) DEFAULT 'N' NOT NULL,
        USATABPE CHAR(1) DEFAULT 'N' NOT NULL,
        TAMDESCPROD SMALLINT DEFAULT 50,
        DESCCOMPPED CHAR(1) DEFAULT 'N' NOT NULL,
        OBSCLIVEND CHAR(1) DEFAULT 'N' NOT NULL,
        CONTESTOQ CHAR(1) DEFAULT 'S' NOT NULL,
        DIASPEDT CHAR(1) DEFAULT 'N' NOT NULL,
        RECALCPCVENDA CHAR(1) DEFAULT 'N' NOT NULL,
        RECALCPCORC CHAR(1) DEFAULT 'N' NOT NULL,
        USALAYOUTPED CHAR(1) DEFAULT 'N' NOT NULL,
        VERIFALTPARCVENDA CHAR(1) DEFAULT 'N' NOT NULL,
        BUSCACODPRODGEN CHAR(1) DEFAULT 'N' NOT NULL,
        FILBUSCGENPROD CHAR(1) DEFAULT 'N' NOT NULL,
        FILBUSCGENREF CHAR(1) DEFAULT 'N' NOT NULL,
        FILBUSCGENCODBAR CHAR(1) NOT NULL,
        FILBUSCGENCODFAB CHAR(1) DEFAULT 'N' NOT NULL,
        FILBUSCGENCODFOR CHAR(1) DEFAULT 'N' NOT NULL,
        BUSCAVLRULTCOMPRA CHAR(1) DEFAULT 'N' NOT NULL,
        ICMSVENDA CHAR(1) DEFAULT 'N' NOT NULL,
        USAPRECOZERO CHAR(1) DEFAULT 'N' NOT NULL,
        USAIMGASSORC CHAR(1) DEFAULT 'N' NOT NULL,
        IMGASSORC BLOB SUB_TYPE 0 SEGMENT SIZE 80,
        CONSISTCPFCLI CHAR(1) DEFAULT 'S' NOT NULL,
        CONSISTEIECLI CHAR(1) DEFAULT 'S' NOT NULL,
        CONSISTEIEFOR CHAR(1) DEFAULT 'S' NOT NULL,
        CONSISTECPFFOR CHAR(1) DEFAULT 'N' NOT NULL,
        USANOMEVENDORC CHAR(1) DEFAULT 'N' NOT NULL,
        SISCONTABIL CHAR(2) DEFAULT '00' NOT NULL,
        ATBANCOIMPBOL CHAR(1) DEFAULT 'N' NOT NULL,
        TIPOCODBAR CHAR(1) DEFAULT '1' NOT NULL,
        ADICORCOBSPED CHAR(1) DEFAULT 'N' NOT NULL,
        CODEMPMENSORC INTEGER,
        CODFILIALMENSORC SMALLINT,
        CODMENSORC INTEGER,
        CUSTOCOMPRA CHAR(1) DEFAULT 'N' NOT NULL,
        TABTRANSPCP CHAR(1) DEFAULT 'N' NOT NULL,
        TABTRANSPORC CHAR(1),
        TABSOLCP CHAR(1) DEFAULT 'N' NOT NULL,
        ADICFRETEBASEICM CHAR(1) DEFAULT 'N' NOT NULL,
        PRECOCPREL CHAR(1) DEFAULT 'N' NOT NULL,
        DESCORC VARCHAR(80),
        MULTICOMIS CHAR(1) DEFAULT 'N' NOT NULL,
        USUATIVCLI CHAR(1) DEFAULT 'N' NOT NULL,
        CODEMPHISTREC INTEGER,
        CODFILIALHISTREC SMALLINT,
        CODHISTREC INTEGER,
        CODEMPHISTPAG INTEGER,
        CODFILIALHISTPAG SMALLINT,
        CODHISTPAG INTEGER,
        CODEMPTC INTEGER,
        CODFILIALTC SMALLINT,
        CODTIPOCLI INTEGER,
        ESTITRECALTDTVENC CHAR(1) DEFAULT 'N' NOT NULL,
        LCREDGLOBAL CHAR(1) DEFAULT 'S' NOT NULL,
        VDMANUTCOMOBRIG CHAR(1) DEFAULT 'S' NOT NULL,
        CLASSPED VARCHAR(80),
        CLASSPED02 VARCHAR(80),
        TIPOCLASSPED CHAR(2) DEFAULT 'QA' NOT NULL,
        USAIBGECLI CHAR(1) DEFAULT 'N' NOT NULL,
        USAIBGEFOR CHAR(1) DEFAULT 'N' NOT NULL,
        USAIBGETRANSP CHAR(1) DEFAULT 'N' NOT NULL,
        SOMAVOLUMES CHAR(1) DEFAULT 'N' NOT NULL,
        BUSCACEP CHAR(1) DEFAULT 'N' NOT NULL,
        URLWSCEP VARCHAR(150),
        CLASSCP VARCHAR(80),
        LABELOBS01CP CHAR(40),
        LABELOBS02CP CHAR(40),
        LABELOBS03CP CHAR(40),
        LABELOBS04CP CHAR(40),
        CONSISTEIEPF CHAR(1) DEFAULT 'N' NOT NULL,
        CREDICMSSIMPLES CHAR(1) DEFAULT 'N' NOT NULL,
        CODEMPMS INTEGER,
        CODFILIALMS SMALLINT,
        CODMENSICMSSIMPLES SMALLINT,
        GERACOMISVENDAORC CHAR(1) DEFAULT 'N' NOT NULL,
        GERACODUNIF CHAR(1) DEFAULT 'N' NOT NULL,
        CODTIPOMOV9 INTEGER,
        CODFILIALT9 SMALLINT,
        CODEMPT9 SMALLINT,
        CODEMPJP INTEGER,
        CODFILIALJP SMALLINT,
        CODPLANJP CHAR(13),
        CODEMPJR INTEGER,
        CODFILIALJR SMALLINT,
        CODPLANJR CHAR(13),
        CODEMPDR INTEGER,
        CODFILIALDR SMALLINT,
        CODPLANDR CHAR(13),
        CODEMPDC INTEGER,
        CODFILIALDC SMALLINT,
        CODPLANDC CHAR(13),
        GERAPAGEMIS CHAR(1) DEFAULT 'N' NOT NULL,
        LANCAFINCONTR CHAR(1) DEFAULT 'N' NOT NULL,
        LANCARMACONTR CHAR(1) DEFAULT 'N' NOT NULL,
        CASASDECPRE SMALLINT,
        VISUALIZALUCR CHAR(1) DEFAULT 'N' NOT NULL,
        CLASSNFE VARCHAR(80),
        DIRNFE VARCHAR(80),
        DIRNFELIN VARCHAR(80),
        FORMATODANFE SMALLINT,
        AMBIENTENFE SMALLINT,
        PROCEMINFE SMALLINT,
        VERPROCNFE VARCHAR(20),
        KEYLICNFE VARCHAR(500),
        DTVENCTONFE DATE,
        INFADPRODNFE CHAR(1),
        CODEMPNF INTEGER,
        CODFILIALNF SMALLINT,
        CODEMAILNF INTEGER,
        EXIBEPARCOBSDANFE CHAR(1) DEFAULT 'S',
        VERSAONFE CHAR(8),
        REGIMETRIBNFE CHAR(1),
        INFCPDEVOLUCAO CHAR(1) DEFAULT 'N' NOT NULL,
        INFVDREMESSA CHAR(1) DEFAULT 'N' NOT NULL,
        GERARECEMIS CHAR(1) DEFAULT 'N' NOT NULL,
        RETENSAOIMP CHAR(1) DEFAULT 'N' NOT NULL,
        TIPOCUSTOLUC CHAR(1) DEFAULT 'U' NOT NULL,
        TABIMPORTCP CHAR(1) DEFAULT 'N' NOT NULL,
        HABVLRTOTITORC CHAR(1) DEFAULT 'N' NOT NULL,
        USABUSCAGENPRODCP CHAR(1) DEFAULT 'N' NOT NULL,
        ADICOBSORCPED CHAR(1) DEFAULT 'S' NOT NULL,
        USAPRECOCOT CHAR(1),
        BLOQPRECOAPROV CHAR(1),
        CODEMPFT INTEGER,
        CODFILIALFT SMALLINT,
        CODTIPOFORFT INTEGER,
        USAPRECOCOMIS CHAR(1) DEFAULT 'N' NOT NULL,
        ESPECIALCOMIS CHAR(1) DEFAULT 'N',
        CODFILIALTS SMALLINT,
        CODTIPOMOVS INTEGER,
        CODEMPTS INTEGER,
        CODEMPSV INTEGER,
        CODFILIALSV SMALLINT,
        CODPLANOPAGSV INTEGER,
        ARREDPRECO SMALLINT,
        CODEMPPC INTEGER,
        CODFILIALPC SMALLINT,
        CODPLANPC CHAR(13),
        TPNOSSONUMERO CHAR(1),
        IMPDOCBOL CHAR(1) DEFAULT 'N' NOT NULL,
        FECHACAIXA CHAR(1),
        FECHACAIXAAUTO CHAR(1),
        NUMDIGIDENTTIT SMALLINT,
        KEYLICEFD VARCHAR(500),
        DTVENCTOEFD DATE,
        REVALIDARLOTECOMPRA CHAR(1) DEFAULT 'N',
        ENCORCPROD CHAR(1) DEFAULT 'N',
        CODEMPIM INTEGER,
        CODFILIALIM SMALLINT,
        CODTIPOMOVIM INTEGER,
        COMISSAODESCONTO CHAR(1) DEFAULT 'N',
        CODEMPHC INTEGER,
        CODFILIALHC SMALLINT,
        CODHISTCNAB INTEGER,
        ALINHATELALANCA CHAR(1),
        VENDACONSUM CHAR(1) DEFAULT 'N' NOT NULL,
        CVPROD CHAR(1),
        VERIFPROD CHAR(1),
        RMAPROD CHAR(1) DEFAULT 'N' NOT NULL,
        TIPOPROD VARCHAR(2),
        CODEMPIG INTEGER,
        CODFILIALIG SMALLINT,
        CODIMG INTEGER,
        OBSITVENDAPED CHAR(1) DEFAULT 'N' NOT NULL,
        FATORCPARC CHAR(1) DEFAULT 'N' NOT NULL,
        APROVORCFATPARC CHAR(1) DEFAULT 'N' NOT NULL,
        BLOQSEQICP CHAR(1) DEFAULT 'N' NOT NULL,
        BLOQSEQIVD CHAR(1) DEFAULT 'N' NOT NULL,
        UTILORDCPINT CHAR(1) DEFAULT 'N' NOT NULL,
        KEYLICEPC VARCHAR(500),
        DTVENCTOEPC DATE,
        IMPLOTENFE CHAR(1) DEFAULT 'S' NOT NULL,
        TOTCPSFRETE CHAR(1) DEFAULT 'N' NOT NULL,
        IDENTCLIBCO CHAR(1) DEFAULT 'D' NOT NULL,
        QTDDESC CHAR(1) DEFAULT 'N' NOT NULL,
        LOCALSERV CHAR(1) DEFAULT 'P' NOT NULL,
        VDPRODQQCLAS CHAR(1) DEFAULT 'N' NOT NULL,
        CODEMPVD INTEGER,
        CODFILIALVD SMALLINT,
        CODVEND INTEGER,
        PADRAONFE CHAR(1) DEFAULT 'T' NOT NULL,
        CODEMPME INTEGER,
        CODFILIALME SMALLINT,
        CODMENSVENDA INTEGER,
        TIPOEMISSAONFE CHAR(1),
        CCNFECP CHAR(1) DEFAULT 'N' NOT NULL,
        ADICICMSTOTNOTA CHAR(1) DEFAULT 'N' NOT NULL,
        UTILIZATBCALCCA CHAR(1) DEFAULT 'N' NOT NULL,
        HABCOMPRACOMPL CHAR(1) DEFAULT 'N' NOT NULL,
        CODEMPIC INTEGER,
        CODFILIALIC SMALLINT,
        CODTIPOMOVIC INTEGER,
        DESCNATCOMPL VARCHAR(60),
        HABLOGPAGAR CHAR(1) DEFAULT 'N' NOT NULL,
        HABLOGRECEBER CHAR(1) DEFAULT 'N' NOT NULL,
        CONSISTENDENTVD CHAR(1) DEFAULT 'N' NOT NULL,
        USACLISEQ CHAR(1) DEFAULT 'N' NOT NULL,
        BLOQDESCCOMPORC CHAR(1) DEFAULT 'N' NOT NULL,
        BLOQPRECOORC CHAR(1) DEFAULT 'N' NOT NULL,
        BLOQDESCCOMPVD CHAR(1) DEFAULT 'N' NOT NULL,
        BLOQPRECOVD CHAR(1) DEFAULT 'N' NOT NULL,
        DESABDESCFECHAVD CHAR(1) DEFAULT 'N' NOT NULL,
        DESABDESCFECHAORC CHAR(1) DEFAULT 'N' NOT NULL,
        PERMITBAIXAPARCJDM CHAR(1) DEFAULT 'N' NOT NULL,
        BLOQCOMISSORC CHAR(1) DEFAULT 'N' NOT NULL,
        BLOQCOMISSVD CHAR(1) DEFAULT 'N' NOT NULL,
        CALCPRECOG CHAR(1) DEFAULT 'N' NOT NULL,
        ENDERECOOBRIGCLI CHAR(1) DEFAULT 'N' NOT NULL,
        ENTREGAOBRIGCLI CHAR(1) DEFAULT 'N' NOT NULL,
        PERIODOCONSCH CHAR(1) DEFAULT 'M' NOT NULL,
        BLOQPEDVD CHAR(1) DEFAULT 'N' NOT NULL,
        AGENDAFPRINCIPAL CHAR(1) DEFAULT 'N' NOT NULL,
        ATUALIZAAGENDA CHAR(1) DEFAULT 'N' NOT NULL,
        TEMPOATUAGENDA INTEGER DEFAULT 30 NOT NULL,
        SOLDTSAIDA CHAR(1) DEFAULT 'N' NOT NULL,
        NPERMITDTMAIOR CHAR(1) DEFAULT 'N' NOT NULL,
        PERMITIMPORCANTAP CHAR(1) DEFAULT 'S' NOT NULL,
        BLOQEDITORCAPOSAP CHAR(1) DEFAULT 'N' NOT NULL,
        BLOQVDPORATRASO CHAR(1) DEFAULT 'N' NOT NULL,
        NUMDIASBLOQVD SMALLINT DEFAULT 0 NOT NULL,
        FATORSEGESTOQ DECIMAL(9, 5) DEFAULT 0 NOT NULL,
        LEITRANSP CHAR(1) DEFAULT 'N' NOT NULL,
        TIPOIMPDANFE CHAR(1) DEFAULT 'F' NOT NULL,
        REPLICAORC CHAR(1) DEFAULT 'N' NOT NULL,
        SQLREPLICAORC BLOB SUB_TYPE 1 SEGMENT SIZE 16384,
        BLOQNFEVDAUTORIZ CHAR(1) DEFAULT 'S' NOT NULL,
        OBRIGTIPOFISC CHAR(1) DEFAULT 'N' NOT NULL,
        -- Matricula do empregado no financeiro
        MATRICEMPFN CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGPREFERE1PK PRIMARY KEY (CODFILIAL, CODEMP));

/* Table: SGPREFERE2, Owner: SYSDBA */
CREATE TABLE SGPREFERE2 (CODFILIAL INTEGER NOT NULL,
        CODEMP INTEGER NOT NULL,
        CODTPATENDO INTEGER,
        CODFILIALTO INTEGER,
        CODEMPTO INTEGER,
        CODTPATENDO2 INTEGER,
        CODFILIALT2 INTEGER,
        CODEMPT2 INTEGER,
        CODTPATENDO3 INTEGER,
        CODFILIALT3 INTEGER,
        CODEMPT3 INTEGER,
        CODSETAT INTEGER,
        CODFILIALSA INTEGER,
        CODEMPSA INTEGER,
        CODSETAT2 INTEGER,
        CODFILIALS2 INTEGER,
        CODEMPS2 INTEGER,
        CODEMPAE INTEGER,
        CODFILIALAE SMALLINT,
        CODATEND INTEGER,
        CLASSMEDIDA CHAR(20),
        CODEMPTI INTEGER,
        CODFILIALTI SMALLINT,
        CODTIPOCLI INTEGER,
        CODEMPCI INTEGER,
        CODFILIALCI SMALLINT,
        CODCLASCLI INTEGER,
        CODEMPTA INTEGER,
        CODFILIALTA SMALLINT,
        CODTBA SMALLINT,
        CODITTBA INTEGER,
        CODEMPTV INTEGER,
        CODFILIALTV SMALLINT,
        CODTBV SMALLINT,
        CODITTBV INTEGER,
        CODEMPVD INTEGER NOT NULL,
        CODFILIALVD SMALLINT NOT NULL,
        CODVEND INTEGER NOT NULL,
        CABTERMR01 VARCHAR(1024),
        CABTERMR02 VARCHAR(1024),
        RODTERMR VARCHAR(1024),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT PKSGPREFERE2 PRIMARY KEY (CODFILIAL, CODEMP));

/* Table: SGPREFERE3, Owner: SYSDBA */
CREATE TABLE SGPREFERE3 (CODEMP INTEGER NOT NULL,
        CODFILIAL INTEGER NOT NULL,
        SMTPMAIL CHAR(40),
        SMTPSSLMAIL CHAR(1) DEFAULT 'N',
        SMTPAUTMAIL CHAR(1) DEFAULT 'N',
        PORTAMAIL INTEGER DEFAULT 25,
        USERMAIL CHAR(40),
        PASSMAIL CHAR(40),
        ENDMAIL VARCHAR(60),
        AUTOHORATEND CHAR(1) DEFAULT 'S' NOT NULL,
        CODEMPCE INTEGER,
        CODFILIALCE SMALLINT,
        CODATIVCE INTEGER,
        CODEMPTE INTEGER,
        CODFILIALTE SMALLINT,
        CODATIVTE INTEGER,
        BLOQATENDCLIATRASO CHAR(1),
        MOSTRACLIATRASO CHAR(1),
        CODEMPNC INTEGER,
        CODFILIALNC SMALLINT,
        CODEMAILNC INTEGER,
        CODEMPAO INTEGER,
        CODFILIALAO SMALLINT,
        CODATENDO INTEGER,
        CODEMPMI INTEGER,
        CODFILIALMI SMALLINT,
        CODMODELMI INTEGER,
        CODEMPME INTEGER,
        CODFILIALME SMALLINT,
        CODMODELME INTEGER,
        CODEMPFI INTEGER,
        CODFILIALFI SMALLINT,
        CODMODELFI INTEGER,
        CODEMPFJ INTEGER,
        CODFILIALFJ SMALLINT,
        CODMODELFJ INTEGER,
        CODEMPAP INTEGER,
        CODFILIALAP SMALLINT,
        CODMODELAP INTEGER,
        CODEMPOR INTEGER,
        CODFILIALOR SMALLINT,
        CODMODELOR INTEGER,
        CODEMPMC INTEGER,
        CODFILIALMC SMALLINT,
        CODMODELMC INTEGER,
        CODEMPEC INTEGER,
        CODFILIALEC SMALLINT,
        CODEMAILEC INTEGER,
        CODEMPEA INTEGER,
        CODFILIALEA SMALLINT,
        CODEMAILEA INTEGER,
        CODEMPT1 INTEGER,
        CODFILIALT1 SMALLINT,
        CODTIPOCONT1 INTEGER,
        CODEMPT2 INTEGER,
        CODFILIALT2 SMALLINT,
        CODTIPOCONT2 INTEGER,
        CODEMPCF INTEGER,
        CODFILIALCF SMALLINT,
        CODCONFEMAIL INTEGER,
        CODEMPC2 INTEGER,
        CODFILIALC2 SMALLINT,
        CODCONFEMAIL2 INTEGER,
        CODEMPEN INTEGER,
        CODFILIALEN SMALLINT,
        CODEMAILEN INTEGER,
        CODEMPE2 INTEGER,
        CODFILIALE2 SMALLINT,
        CODEMAILEN2 INTEGER,
        EMAILNOTIF1 VARCHAR(250),
        EMAILNOTIF2 VARCHAR(250),
        TEMPOMAXINT SMALLINT DEFAULT 0 NOT NULL,
        LANCAPONTOAF CHAR(1) DEFAULT 'N' NOT NULL,
        TOLREGPONTO SMALLINT DEFAULT 20 NOT NULL,
        USACTOSEQ CHAR(1) DEFAULT 'N' NOT NULL,
        LAYOUTFICHAAVAL VARCHAR(100),
        LAYOUTPREFICHAAVAL VARCHAR(100),
        CODEMPV1 INTEGER,
        CODFILIALV1 SMALLINT,
        CODVARG1 INTEGER,
        CODEMPV2 INTEGER,
        CODFILIALV2 SMALLINT,
        CODVARG2 INTEGER,
        CODEMPV3 INTEGER,
        CODFILIALV3 SMALLINT,
        CODVARG3 INTEGER,
        CODEMPV4 INTEGER,
        CODFILIALV4 SMALLINT,
        CODVARG4 INTEGER,
        CODEMPV5 INTEGER,
        CODFILIALV5 SMALLINT,
        CODVARG5 INTEGER,
        CODEMPV6 INTEGER,
        CODFILIALV6 SMALLINT,
        CODVARG6 INTEGER,
        CODEMPV7 INTEGER,
        CODFILIALV7 SMALLINT,
        CODVARG7 INTEGER,
        CODEMPV8 INTEGER,
        CODFILIALV8 SMALLINT,
        CODVARG8 INTEGER,
        CODEMPSR INTEGER,
        CODFILIALSR SMALLINT,
        CODSETOR INTEGER,
        BLOQATENDIMENTO CHAR(1) DEFAULT 'N' NOT NULL,
        PERIODOBLOQ INTEGER,
        CONTROLEACESATEND CHAR(1) DEFAULT 'N' NOT NULL,
        AGENDAOBRIGORC CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT PKSGPREFERE3 PRIMARY KEY (CODFILIAL, CODEMP));

/* Table: SGPREFERE4, Owner: SYSDBA */
CREATE TABLE SGPREFERE4 (CODEMP INTEGER NOT NULL,
        CODFILIAL INTEGER NOT NULL,
        CODTIPOMOV INTEGER,
        CODEMPTM INTEGER,
        CODFILIALTM INTEGER,
        CODEMPPP INTEGER,
        CODFILIALPP SMALLINT,
        CODPLANOPAG INTEGER,
        CODEMPCL INTEGER,
        CODFILIALCL SMALLINT,
        CODCLI INTEGER,
        CODEMPPD INTEGER,
        CODFILIALPD SMALLINT,
        CODPROD INTEGER,
        PRAZO SMALLINT,
        ADICPDV CHAR(1) DEFAULT 'N' NOT NULL,
        APROVORC CHAR(1) DEFAULT 'N' NOT NULL,
        DIASVENCORC INTEGER,
        USABUSCAGENPROD CHAR(1) DEFAULT 'N' NOT NULL,
        AUTOFECHAVENDA CHAR(1) DEFAULT 'N' NOT NULL,
        USALOTEORC CHAR(1) DEFAULT 'N' NOT NULL,
        HABRECEBER CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGPREFERE4PK PRIMARY KEY (CODFILIAL, CODEMP));

/* Table: SGPREFERE5, Owner: SYSDBA */
CREATE TABLE SGPREFERE5 (CODEMP INTEGER NOT NULL,
        CODFILIAL INTEGER NOT NULL,
        CLASSOP CHAR(20),
        NOMERESP CHAR(50),
        IDENTPROFRESP CHAR(30),
        CARGORESP CHAR(30),
        MESESDESCCP SMALLINT DEFAULT 3 NOT NULL,
        CODTIPOMOV INTEGER,
        CODEMPTM SMALLINT,
        CODFILIALTM SMALLINT,
        SITRMAOP CHAR(2) DEFAULT 'PE',
        IMGASSRESP BLOB SUB_TYPE 0 SEGMENT SIZE 80,
        BAIXARMAAPROV CHAR(1) DEFAULT 'N' NOT NULL,
        RATAUTO CHAR(1) DEFAULT 'N' NOT NULL,
        APAGARMAOP CHAR(1) DEFAULT 'N' NOT NULL,
        NOMERELANAL CHAR(1) DEFAULT 'U' NOT NULL,
        SITPADOP CHAR(2) DEFAULT 'PE' NOT NULL,
        SITPADOPCONV CHAR(2) DEFAULT 'PE' NOT NULL,
        HABCONVCP CHAR(1) DEFAULT 'N' NOT NULL,
        OPSEQ CHAR(1) DEFAULT 'N' NOT NULL,
        PRODETAPAS CHAR(1),
        CODEMPTS INTEGER,
        CODFILIALTS SMALLINT,
        CODTIPOMOVSP INTEGER,
        CODEMPEN INTEGER,
        CODFILIALEN SMALLINT,
        CODTIPOMOVEN INTEGER,
        CODEMPRE INTEGER,
        CODFILIALRE SMALLINT,
        CODTIPOMOVRE INTEGER,
        EXPEDIRRMA CHAR(1) DEFAULT 'N' NOT NULL,
        VALIDAQTDOP CHAR(1) DEFAULT 'N' NOT NULL,
        VALIDAFASEOP CHAR(1) DEFAULT 'N' NOT NULL,
        EDITQTDOP CHAR(1) DEFAULT 'S' NOT NULL,
        BLOQOPSEMSALDO CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGPREFERE5PK PRIMARY KEY (CODFILIAL, CODEMP));

/* Table: SGPREFERE6, Owner: SYSDBA */
CREATE TABLE SGPREFERE6 (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        NOMEEMP VARCHAR(20) NOT NULL,
        NOMEEMPCNAB VARCHAR(30) DEFAULT '' NOT NULL,
        SOBRESCREVEHIST CHAR(1) DEFAULT 'S' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT CHAR(8) DEFAULT USER NOT NULL,
CONSTRAINT SGPREFERE6PK PRIMARY KEY (CODFILIAL, CODEMP));

/* Table: SGPREFERE7, Owner: SYSDBA */
CREATE TABLE SGPREFERE7 (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODEMPCO INTEGER,
        CODFILIALCO SMALLINT,
        CODTIPOMOVCO INTEGER,
        CODEMPTV INTEGER,
        CODFILIALTV SMALLINT,
        CODTIPOMOVTV INTEGER,
        CODEMPTP INTEGER,
        CODFILIALTP SMALLINT,
        CODTIPOMOVTP INTEGER,
        CODEMPPV INTEGER,
        CODEMPPC INTEGER,
        CODFILIALPC SMALLINT,
        CODPLANCONSIG CHAR(13),
        CODFILIALPV SMALLINT,
        CODPLANVDCONSIG CHAR(13),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT CHAR(8) DEFAULT USER NOT NULL,
CONSTRAINT SGPREFERE7PK PRIMARY KEY (CODFILIAL, CODEMP));

/* Table: SGPREFERE8, Owner: SYSDBA */
CREATE TABLE SGPREFERE8 (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODEMPTR INTEGER,
        CODFILIALTR SMALLINT,
        CODTIPORECMERC INTEGER,
        CODEMPCM INTEGER,
        CODFILIALCM SMALLINT,
        CODTIPORECMERCCM INTEGER,
        CODEMPTC INTEGER,
        CODFILIALTC SMALLINT,
        CODTIPOMOVTC INTEGER,
        CODEMPTO INTEGER,
        CODFILIALTO SMALLINT,
        CODTIPORECMERCOS INTEGER,
        CODEMPPP INTEGER,
        CODFILIALPP SMALLINT,
        CODPLANOPAG INTEGER,
        GERACHAMADOOS CHAR(1) DEFAULT 'N' NOT NULL,
        USAPRECOPECASERV CHAR(1),
        CODEMPDS INTEGER,
        CODFILIALDS SMALLINT,
        CODTIPOMOVDS SMALLINT,
        CODEMPSE INTEGER,
        CODFILIALSE SMALLINT,
        CODPRODSE INTEGER,
        CODEMPTE INTEGER,
        CODFILIALTE SMALLINT,
        CODTIPOEXPED INTEGER,
        CODEMPTN INTEGER,
        CODFILIALTN SMALLINT,
        CODTRAN INTEGER,
        SINCTICKET CHAR(1),
        SOLCPHOMOLOGFOR CHAR(1) DEFAULT 'N' NOT NULL,
        UTILRENDACOT CHAR(1) DEFAULT 'S' NOT NULL,
        PERMITDOCCOLDUPL CHAR(1) DEFAULT 'S' NOT NULL,
        OBSPADOC VARCHAR(500),
        PERMITITEMREPCP CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT CHAR(8) DEFAULT USER NOT NULL,
        PERCPRECOCOLETACP NUMERIC(15, 5) DEFAULT 100 NOT NULL,
        DETITEMPAINELSERV CHAR(1) DEFAULT 'N' NOT NULL,
CONSTRAINT SGPREFERE8PK PRIMARY KEY (CODFILIAL, CODEMP));

/* Table: SGPROCESSO, Owner: SYSDBA */
CREATE TABLE SGPROCESSO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODPROC INTEGER NOT NULL,
        DESCPROC CHAR(50) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGPROCESSOPK PRIMARY KEY (CODPROC, CODFILIAL, CODEMP));

/* Table: SGPROXYWEB, Owner: SYSDBA */
CREATE TABLE SGPROXYWEB (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODPROXY INTEGER NOT NULL,
        DESCPROXY VARCHAR(60) NOT NULL,
        HOSTPROXY VARCHAR(100) NOT NULL,
        PORTAPROXY INTEGER NOT NULL,
        AUTPROXY CHAR(1) DEFAULT 'N' NOT NULL,
        USUPROXY VARCHAR(128),
        SENHAPROXY VARCHAR(128),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT VARCHAR(128) DEFAULT USER NOT NULL,
CONSTRAINT SGPROXYWEBPK PRIMARY KEY (CODPROXY, CODFILIAL, CODEMP));

/* Table: SGSEQUENCE_ID, Owner: SYSDBA */
CREATE TABLE SGSEQUENCE_ID (TABLE_NAME VARCHAR(128) NOT NULL,
        SEQ_ID BIGINT DEFAULT 0 NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGSEQUENCE_IDPK PRIMARY KEY (TABLE_NAME));

/* Table: SGSEQUENCIA, Owner: SYSDBA */
CREATE TABLE SGSEQUENCIA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        SGTAB CHAR(2) NOT NULL,
        NROSEQ INTEGER,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGSEQUENCIAPK PRIMARY KEY (SGTAB, CODFILIAL, CODEMP));

/* Table: SGSISTEMA, Owner: SYSDBA */
CREATE TABLE SGSISTEMA (CODSIS INTEGER NOT NULL,
        DESCSIS CHAR(50) NOT NULL,
        COMENTSIS VARCHAR(10000),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGSISTEMAPK PRIMARY KEY (CODSIS));

/* Table: SGSQUID_ACTION, Owner: SYSDBA */
CREATE TABLE SGSQUID_ACTION (ID BIGINT NOT NULL,
        SIGLA VARCHAR(40) NOT NULL,
        DESCRICAO VARCHAR(250) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGSQUID_ACTIONPK PRIMARY KEY (ID));

/* Table: SGSQUID_HIER, Owner: SYSDBA */
CREATE TABLE SGSQUID_HIER (ID BIGINT NOT NULL,
        SIGLA VARCHAR(40) NOT NULL,
        DESCRICAO VARCHAR(250) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGSQUID_HIERPK PRIMARY KEY (ID));

/* Table: SGSQUID_LOG, Owner: SYSDBA */
CREATE TABLE SGSQUID_LOG (ID BIGINT NOT NULL,
        CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        DTLOG DATE NOT NULL,
        HLOG TIME NOT NULL,
        DURATION INTEGER NOT NULL,
        CLIENTADDRESS VARCHAR(30) NOT NULL,
        ID_ACTION BIGINT NOT NULL,
        BYTES INTEGER NOT NULL,
        ID_METHOD BIGINT NOT NULL,
        URL VARCHAR(500) NOT NULL,
        AUTENTICATION VARCHAR(128),
        ID_HIER BIGINT,
        TYPES VARCHAR(250),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGSQUID_LOGPK PRIMARY KEY (ID));

/* Table: SGSQUID_METHOD, Owner: SYSDBA */
CREATE TABLE SGSQUID_METHOD (ID BIGINT NOT NULL,
        SIGLA VARCHAR(40) NOT NULL,
        DESCRICAO VARCHAR(250) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGSQUID_METHODPK PRIMARY KEY (ID));

/* Table: SGTABELA, Owner: SYSDBA */
CREATE TABLE SGTABELA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTB SMALLINT NOT NULL,
        DESCTB CHAR(50) NOT NULL,
        SIGLATB CHAR(10),
        DTINS DATE DEFAULT 'now',
        IDUSUINS CHAR(8) DEFAULT USER,
        DTALT DATE DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
        HINS TIME DEFAULT 'now',
        HALT TIME DEFAULT 'now',
CONSTRAINT SGTABELAPK PRIMARY KEY (CODTB, CODFILIAL, CODEMP));

/* Table: SGTAREFA, Owner: SYSDBA */
CREATE TABLE SGTAREFA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTAREFA INTEGER NOT NULL,
        DESCTAREFA CHAR(50) NOT NULL,
        CODEMPOB INTEGER NOT NULL,
        CODOBJ INTEGER NOT NULL,
        TIPOTAREFA CHAR(2) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGTAREFAPK PRIMARY KEY (CODTAREFA, CODFILIAL, CODEMP));

/* Table: SGTIPOAGENDA, Owner: SYSDBA */
CREATE TABLE SGTIPOAGENDA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTIPOAGD INTEGER NOT NULL,
        DESCTIPOAGD CHAR(50),
        DTINI DATE,
        IDUSUINI CHAR(8),
        HINI TIME,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE,
        HALT TIME,
        IDUSUALT CHAR(8),
CONSTRAINT PK_SGTIPOAGENDA PRIMARY KEY (CODEMP, CODFILIAL, CODTIPOAGD));

/* Table: SGTRATARET, Owner: SYSDBA */
CREATE TABLE SGTRATARET (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODPROC INTEGER NOT NULL,
        SEQITPROC SMALLINT NOT NULL,
        CODTRATRET SMALLINT NOT NULL,
        TIPOTRATRET CHAR(2) NOT NULL,
        CODEMPGT INTEGER,
        CODFILIALGT SMALLINT,
        SEQITPROCGT SMALLINT,
        CODPROCGT INTEGER,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGTRATARETPK PRIMARY KEY (CODPROC, CODTRATRET, SEQITPROC, CODFILIAL, CODEMP));

/* Table: SGUF, Owner: SYSDBA */
CREATE TABLE SGUF (SIGLAUF CHAR(2) NOT NULL,
        CODPAIS SMALLINT NOT NULL,
        NOMEUF VARCHAR(80) NOT NULL,
        NOMECURTO VARCHAR(40) DEFAULT '' NOT NULL,
        CODUF SMALLINT NOT NULL,
        REGIAOUF CHAR(2) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGUFPK PRIMARY KEY (SIGLAUF, CODPAIS));

/* Table: SGUNIFCOD, Owner: SYSDBA */
CREATE TABLE SGUNIFCOD (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODUNIFCOD INTEGER NOT NULL,
        TIPOUNIFCOD CHAR(1) NOT NULL,
        DESCUNIFCOD VARCHAR(80) NOT NULL,
        CODTMP INTEGER,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGUNIFCODPK PRIMARY KEY (CODUNIFCOD, CODFILIAL, CODEMP));

/* Table: SGUSUARIO, Owner: SYSDBA */
CREATE TABLE SGUSUARIO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        IDUSU CHAR(8) NOT NULL,
        NOMEUSU CHAR(50) NOT NULL,
        /*TIPOUSU - D=BANCO DE DADOS / W=WEB / A=AMBOS*/
        TIPOUSU CHAR(1) DEFAULT 'D' NOT NULL,
        CODEMPIG INTEGER,
        CODFILIALIG SMALLINT,
        IDGRPUSU CHAR(8),
        CODEMPCC INTEGER,
        CODFILIALCC SMALLINT,
        ANOCC SMALLINT,
        CODCC CHAR(19),
        PNOMEUSU CHAR(20),
        UNOMEUSU CHAR(20),
        COMENTUSU VARCHAR(10000),
        BAIXOCUSTOUSU CHAR(1) DEFAULT 'N',
        CODALMOX INTEGER,
        CODEMPAM INTEGER,
        CODFILIALAM SMALLINT,
        ABREGAVETAUSU CHAR(1) DEFAULT 'S',
        APROVCPSOLICITACAOUSU CHAR(2) DEFAULT 'ND',
        ALMOXARIFEUSU CHAR(1) DEFAULT 'N',
        CODEMPAE INTEGER,
        CODFILIALAE SMALLINT,
        TIPOAGE CHAR(5),
        CODAGE INTEGER,
        APROVRMAUSU CHAR(2) DEFAULT 'ND',
        COMPRASUSU CHAR(1) DEFAULT 'N',
        ALTPARCVENDA CHAR(1) DEFAULT 'N',
        APROVRECEITA CHAR(1) DEFAULT 'N',
        ATIVCLI CHAR(1) DEFAULT 'N' NOT NULL,
        LIBERACREDUSU CHAR(1) DEFAULT 'N' NOT NULL,
        CORAGENDA INTEGER DEFAULT 0 NOT NULL,
        CODEMPCE INTEGER,
        CODFILIALCE SMALLINT,
        CODCONFEMAIL INTEGER,
        CANCELAOP CHAR(1),
        VENDAPATRIMUSU CHAR(1) DEFAULT 'N' NOT NULL,
        RMAOUTCC CHAR(1) DEFAULT 'N' NOT NULL,
        ATIVOUSU CHAR(1) DEFAULT 'S' NOT NULL,
        VISUALIZALUCR CHAR(1) DEFAULT 'N' NOT NULL,
        LIBERACAMPOPESAGEM CHAR(1) DEFAULT 'N' NOT NULL,
        APROVORDCP CHAR(1) DEFAULT 'N' NOT NULL,
        ACESOPBTCADLOTE CHAR(1) DEFAULT 'S' NOT NULL,
        ACESOPBTRMA CHAR(1) DEFAULT 'S' NOT NULL,
        ACESOPBTQUALID CHAR(1) DEFAULT 'S' NOT NULL,
        ACESOPBTDISTR CHAR(1) DEFAULT 'S' NOT NULL,
        ACESOPBTFASE CHAR(1) DEFAULT 'S' NOT NULL,
        ACESOPBTCANC CHAR(1) DEFAULT 'S' NOT NULL,
        ACESOPBTSUBPROD CHAR(1) DEFAULT 'S' NOT NULL,
        ACESOPBTREMESSA CHAR(1) DEFAULT 'S' NOT NULL,
        ACESOPBTRETORNO CHAR(1) DEFAULT 'S' NOT NULL,
        ACESOPVERITENS CHAR(1) DEFAULT 'S' NOT NULL,
        CADOUTUSU CHAR(1) DEFAULT 'N' NOT NULL,
        SENHAUSU VARCHAR(128),
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGUSUARIOPK PRIMARY KEY (IDUSU, CODFILIAL, CODEMP));

/* Table: SGVARIAVEL, Owner: SYSDBA */
CREATE TABLE SGVARIAVEL (IDVAR CHAR(18) NOT NULL,
        IDCON INTEGER NOT NULL,
        VLRINTEGER INTEGER,
        VLRCHAR1 CHAR(20),
        VLRCHAR2 CHAR(50),
        VLRDECIMAL NUMERICDN,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SGVARIAVELPK PRIMARY KEY (IDVAR, IDCON));

/* Table: SPNATOPER, Owner: SYSDBA */
CREATE TABLE SPNATOPER (CST CHAR(2) NOT NULL,
        CODIGO VARCHAR(10) NOT NULL,
        DESC_PROD VARCHAR(500) NOT NULL,
        DT_INI DATE,
        DT_FIM DATE,
        NCM VARCHAR(1000),
        NCM_EX VARCHAR(1000),
        EX_IPI VARCHAR(1000),
        UNID VARCHAR(250),
        ALIQ_PIS DECIMAL(10, 2),
        ALIQ_COFIN DECIMAL(10, 2),
        EX_TAB_OPER_SEM_CSL VARCHAR(1000),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT VARCHAR(128) DEFAULT USER,
CONSTRAINT SPNATOPERLPK PRIMARY KEY (CODIGO, CST));

/* Table: SVAVALIACAO, Owner: SYSDBA */
CREATE TABLE SVAVALIACAO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODOS INTEGER NOT NULL,
        CODITOS SMALLINT NOT NULL,
        CODAVAL SMALLINT NOT NULL,
        CODEMPPD INTEGER NOT NULL,
        CODFILIALPD SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        REFPROD VARCHAR(20) NOT NULL,
        QTDAVAL NUMERICDN NOT NULL,
        PRECOAVAL NUMERICDN NOT NULL,
        VLRTOTAVAL NUMERICDN NOT NULL,
        VLRDESCAVAL NUMERICDN NOT NULL,
        VLRLIQAVAL NUMERICDN NOT NULL,
        SITAVAL CHAR(2) NOT NULL,
        SITAPROVAVAL CHAR(2) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SVAVALIACAOPK PRIMARY KEY (CODOS, CODITOS, CODAVAL, CODFILIAL, CODEMP));

/* Table: SVEXECUCAO, Owner: SYSDBA */
CREATE TABLE SVEXECUCAO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODOS INTEGER NOT NULL,
        CODITOS INTEGER NOT NULL,
        CODEXEC SMALLINT NOT NULL,
        CODEMPPD INTEGER NOT NULL,
        CODFILIALPD SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        REFPROD VARCHAR(20) NOT NULL,
        SITEXEC CHAR(2) NOT NULL,
        QTDEXEC NUMERICDN NOT NULL,
        PRECOEXEC NUMERICDN NOT NULL,
        VLRTOTEXEC NUMERICDN NOT NULL,
        VLRDESCEXEC NUMERICDN NOT NULL,
        VLRLIQEXEC NUMERICDN NOT NULL,
        DTEXEC DATE,
        OBSEXEC VARCHAR(1000),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SVEXECUCAOPK PRIMARY KEY (CODOS, CODITOS, CODEXEC, CODFILIAL, CODEMP));

/* Table: SVITOS, Owner: SYSDBA */
CREATE TABLE SVITOS (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODOS INTEGER NOT NULL,
        CODITOS SMALLINT NOT NULL,
        CODEMPPD INTEGER NOT NULL,
        CODFILIALPD SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        REFPROD VARCHAR(20) NOT NULL,
        QTDITOS NUMERICDN NOT NULL,
        PRECOITOS NUMERICDN NOT NULL,
        SITITOS CHAR(2) NOT NULL,
        OBSITOS VARCHAR(1000),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SVITOSPK PRIMARY KEY (CODOS, CODITOS, CODFILIAL, CODEMP));

/* Table: SVOS, Owner: SYSDBA */
CREATE TABLE SVOS (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODOS INTEGER NOT NULL,
        CODEMPCL INTEGER NOT NULL,
        CODFILIALCL SMALLINT NOT NULL,
        CODCLI INTEGER NOT NULL,
        DTENTOS DATE NOT NULL,
        SITOS CHAR(2) NOT NULL,
        CODEMPCV INTEGER,
        CODFILIALCV SMALLINT,
        CODCONV INTEGER,
        DTPREVOS DATE,
        DTSAIOS DATE,
        DESCOS VARCHAR(1000),
        OBSOS VARCHAR(1000),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT SVOSPK PRIMARY KEY (CODOS, CODFILIAL, CODEMP));

/* Table: TKATIVIDADE, Owner: SYSDBA */
CREATE TABLE TKATIVIDADE (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODATIV INTEGER NOT NULL,
        DESCATIV CHAR(50) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT TKATIVIDADEPK PRIMARY KEY (CODATIV, CODFILIAL, CODEMP));

/* Table: TKCAMPANHA, Owner: SYSDBA */
CREATE TABLE TKCAMPANHA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCAMP CHAR(13) NOT NULL,
        DESCCAMP CHAR(80) NOT NULL,
        OBSCAMP VARCHAR(500),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT TKCAMPANHAPK PRIMARY KEY (CODCAMP, CODFILIAL, CODEMP));

/* Table: TKCAMPANHACLI, Owner: SYSDBA */
CREATE TABLE TKCAMPANHACLI (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCAMP CHAR(13) NOT NULL,
        CODEMPCL INTEGER NOT NULL,
        CODFILIALCL SMALLINT NOT NULL,
        CODCLI INTEGER NOT NULL,
        DTINS DATE default 'now' NOT NULL,
        HINS TIME default 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT TKCAMPANHACLIPK PRIMARY KEY (CODCAMP, CODFILIAL, CODEMP, CODCLI, CODFILIALCL, CODEMPCL));

/* Table: TKCAMPANHACTO, Owner: SYSDBA */
CREATE TABLE TKCAMPANHACTO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCAMP CHAR(13) NOT NULL,
        SEQCAMPCTO INTEGER NOT NULL,
        CODEMPCO INTEGER,
        CODFILIALCO SMALLINT,
        CODCTO INTEGER,
        CODEMPCL INTEGER,
        CODFILIALCL SMALLINT,
        CODCLI INTEGER,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT TKCAMPANHACTOPK PRIMARY KEY (CODCAMP, SEQCAMPCTO, CODEMP, CODFILIAL));

/* Table: TKCAMPANHAEMAIL, Owner: SYSDBA */
CREATE TABLE TKCAMPANHAEMAIL (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCAMP CHAR(13) NOT NULL,
        CODEMPEM INTEGER NOT NULL,
        CODFILIALEM SMALLINT NOT NULL,
        CODEMAIL INTEGER NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT TKCAMPANHAEMAILPK PRIMARY KEY (CODCAMP, CODFILIAL, CODEMP, CODEMAIL, CODFILIALEM, CODEMPEM));

/* Table: TKCONFEMAIL, Owner: SYSDBA */
CREATE TABLE TKCONFEMAIL (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCONFEMAIL INTEGER NOT NULL,
        EMAILREMET VARCHAR(60) NOT NULL,
        NOMEREMET CHAR(50) NOT NULL,
        USUARIOREMET CHAR(40) NOT NULL,
        CRIPTSENHA CHAR(1) DEFAULT 'N' NOT NULL,
        SENHAREMET CHAR(40),
        EMAILRESP VARCHAR(60) NOT NULL,
        HOSTSMTP CHAR(40) NOT NULL,
        USASSL CHAR(1) DEFAULT 'N' NOT NULL,
        USAAUTSMTP CHAR(1) DEFAULT 'N' NOT NULL,
        PORTASMTP INTEGER DEFAULT 25 NOT NULL,
        ASSINATREMET VARCHAR(1000),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT TKCONFEMAILPK PRIMARY KEY (CODCONFEMAIL, CODFILIAL, CODEMP));

/* Table: TKCONTATO, Owner: SYSDBA */
CREATE TABLE TKCONTATO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCTO INTEGER NOT NULL,
        RAZCTO CHAR(60) NOT NULL,
        CODEMPVD INTEGER,
        CODFILIALVD SMALLINT,
        CODVEND INTEGER,
        CODEMPSR INTEGER NOT NULL,
        CODFILIALSR SMALLINT NOT NULL,
        CODSETOR INTEGER NOT NULL,
        NOMECTO CHAR(50) NOT NULL,
        DATACTO DATE DEFAULT 'today' NOT NULL,
        PESSOACTO CHAR(1) NOT NULL,
        ATIVOCTO CHAR(1) NOT NULL,
        CNPJCTO CHAR(14),
        INSCCTO VARCHAR(20),
        CPFCTO CHAR(11),
        RGCTO CHAR(13),
        ENDCTO CHAR(50),
        NUMCTO INTEGER,
        COMPLCTO CHAR(20),
        EDIFICIOCTO VARCHAR(30),
        BAIRCTO CHAR(30),
        CIDCTO CHAR(30),
        UFCTO CHAR(2),
        CEPCTO CHAR(8),
        DDDCTO CHAR(4),
        FONECTO CHAR(12),
        FAXCTO VARCHAR(9),
        EMAILCTO CHAR(50),
        CONTCTO CHAR(40),
        CARGOCONTCTO CHAR(30),
        OBSCTO VARCHAR(10000),
        REMOVCTO CHAR(1) DEFAULT 'N' NOT NULL,
        CODEMPTI INTEGER,
        CODFILIALTI SMALLINT,
        CODTPIMP INTEGER,
        CODEMPSO INTEGER,
        CODFILIALSO SMALLINT,
        CODSETORCTO INTEGER,
        NUMEMPCTO INTEGER,
        CODMUNIC CHAR(7),
        SIGLAUF CHAR(2),
        CODPAIS SMALLINT,
        CODEMPTC INTEGER,
        CODFILIALTC SMALLINT,
        CODTIPOCLI INTEGER,
        CODEMPOC INTEGER NOT NULL,
        CODFILIALOC SMALLINT NOT NULL,
        CODORIGCONT INTEGER NOT NULL,
        CODEMPTO INTEGER,
        CODFILIALTO SMALLINT,
        CODTIPOCONT INTEGER,
        CELCTO CHAR(12),
        REPLICADO CHAR(1) DEFAULT 'N' NOT NULL,
		DTREPL DATE,
		HREPL TIME,        
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT TKCONTATOPK PRIMARY KEY (CODCTO, CODFILIAL, CODEMP));

/* Table: TKCONTCLI, Owner: SYSDBA */
CREATE TABLE TKCONTCLI (CODEMPCTO INTEGER NOT NULL,
        CODFILIALCTO SMALLINT NOT NULL,
        CODCTO INTEGER NOT NULL,
        CODEMPCLI INTEGER NOT NULL,
        CODFILIALCLI SMALLINT NOT NULL,
        CODCLI INTEGER NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT TKCONTCLIPK PRIMARY KEY (CODCTO, CODFILIALCTO, CODEMPCTO, CODCLI, CODEMPCLI, CODFILIALCLI));

/* Table: TKCONTPESSOA, Owner: SYSDBA */
CREATE TABLE TKCONTPESSOA (CODEMPCTO INTEGER NOT NULL,
        CODFILIALCTO SMALLINT NOT NULL,
        CODCTO INTEGER NOT NULL,
        CODEMPPE INTEGER NOT NULL,
        CODFILIALPE SMALLINT NOT NULL,
        EMAILPESSOA VARCHAR(128) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT TKCONTPESSOAPK PRIMARY KEY (CODCTO, EMAILPESSOA, CODFILIALCTO, CODEMPCTO, CODEMPPE, CODFILIALPE));

/* Table: TKCTOATIV, Owner: SYSDBA */
CREATE TABLE TKCTOATIV (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCTO INTEGER NOT NULL,
        CODEMPAV INTEGER NOT NULL,
        CODFILIALAV SMALLINT NOT NULL,
        CODATIV INTEGER NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT TKCTOATIVPK PRIMARY KEY (CODCTO, CODFILIAL, CODEMP, CODATIV, CODFILIALAV, CODEMPAV));

/* Table: TKCTOGRPINT, Owner: SYSDBA */
CREATE TABLE TKCTOGRPINT (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCTO INTEGER NOT NULL,
        CODEMPGP INTEGER NOT NULL,
        CODFILIALGP SMALLINT NOT NULL,
        CODGRUP CHAR(14) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT TKCTOGRPINTPK PRIMARY KEY (CODCTO, CODFILIAL, CODEMP, CODGRUP, CODFILIALGP, CODEMPGP));

/* Table: TKEMAIL, Owner: SYSDBA */
CREATE TABLE TKEMAIL (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODEMAIL INTEGER NOT NULL,
        DESCEMAIL CHAR(50) NOT NULL,
        ASSUNTO VARCHAR(120) NOT NULL,
        CORPO VARCHAR(20000) NOT NULL,
        FORMATO CHAR(10) DEFAULT 'text/plain' NOT NULL,
        CHARSET CHAR(10) DEFAULT 'iso-8859-1' NOT NULL,
        CODEMPCM INTEGER NOT NULL,
        CODFILIALCM SMALLINT NOT NULL,
        CODCONFEMAIL INTEGER NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT TKEMAILPK PRIMARY KEY (CODEMAIL, CODFILIAL, CODEMP));

/* Table: TKHISTORICO, Owner: SYSDBA */
CREATE TABLE TKHISTORICO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODHISTTK INTEGER NOT NULL,
        DATAHISTTK DATE NOT NULL,
        HORAHISTTK TIME NOT NULL,
        CODEMPCO INTEGER,
        CODFILIALCO SMALLINT,
        CODCTO INTEGER,
        CODEMPCL INTEGER,
        CODFILIALCL SMALLINT,
        CODCLI INTEGER,
        DESCHISTTK VARCHAR(10000) NOT NULL,
        CODEMPAE INTEGER NOT NULL,
        CODFILIALAE SMALLINT NOT NULL,
        CODATEND INTEGER NOT NULL,
        SITHISTTK CHAR(2) NOT NULL,
        TIPOHISTTK CHAR(1) DEFAULT 'H',
        CODEMPCA INTEGER,
        CODFILIALCA SMALLINT,
        CODCAMP CHAR(13),
        TIPOCTO CHAR(1),
        SEQSITCAMP SMALLINT,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT TKHISTORICOPK PRIMARY KEY (CODHISTTK, CODFILIAL, CODEMP));

/* Table: TKORIGCONT, Owner: SYSDBA */
CREATE TABLE TKORIGCONT (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODORIGCONT INTEGER NOT NULL,
        DESCORIGCONT CHAR(40) NOT NULL,
        WEB CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT TKORIGCONTPK PRIMARY KEY (CODORIGCONT, CODFILIAL, CODEMP));

/* Table: TKSETORCTO, Owner: SYSDBA */
CREATE TABLE TKSETORCTO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODSETORCTO INTEGER NOT NULL,
        DESCSETORCTO CHAR(50) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT TKSETORCTOPK PRIMARY KEY (CODSETORCTO, CODFILIAL, CODEMP));

/* Table: TKSITCAMP, Owner: SYSDBA */
CREATE TABLE TKSITCAMP (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCAMP CHAR(13) NOT NULL,
        SEQSITCAMP INTEGER NOT NULL,
        TIPOCTO CHAR(1) NOT NULL,
        CODEMPAV INTEGER NOT NULL,
        CODFILIALAV SMALLINT NOT NULL,
        CODATIV INTEGER NOT NULL,
        CODEMPCO INTEGER,
        CODFILIALCO SMALLINT,
        CODCTO INTEGER,
        CODEMPCL INTEGER,
        CODFILIALCL SMALLINT,
        CODCLI INTEGER,
        DTSITCAMP DATE DEFAULT 'now' NOT NULL,
        HRSITCAMP TIME DEFAULT 'now' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT TKSITCAMPPK PRIMARY KEY (CODCAMP, SEQSITCAMP, TIPOCTO, CODFILIAL, CODEMP));

/* Table: TKTIPOCONT, Owner: SYSDBA */
CREATE TABLE TKTIPOCONT (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTIPOCONT INTEGER NOT NULL,
        DESCTIPOCONT CHAR(40),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT TKTIPOCONTPK PRIMARY KEY (CODTIPOCONT, CODFILIAL, CODEMP));

/* Table: TKTIPOIMP, Owner: SYSDBA */
CREATE TABLE TKTIPOIMP (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTPIMP INTEGER NOT NULL,
        DESCTPIMP CHAR(50) NOT NULL,
        TRANSBINTPIMP CHAR(1) DEFAULT 'N' NOT NULL,
        CSEPTPIMP CHAR(1) DEFAULT 'N' NOT NULL,
        ENTERLNTPIMP CHAR(1) DEFAULT 'S' NOT NULL,
        SEPTPIMP CHAR(10),
        LAYOUTTPIMP VARCHAR(256),
        DELCRTTPIMP SMALLINT,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT TKTIPOIMPPK PRIMARY KEY (CODTPIMP, CODFILIAL, CODEMP));

/* Table: VDAUXVENDA, Owner: SYSDBA */
CREATE TABLE VDAUXVENDA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        TIPOVENDA CHAR(1) NOT NULL,
        CODVENDA INTEGER NOT NULL,
        CODAUXV SMALLINT NOT NULL,
        CPFCLIAUXV CHAR(11),
        NOMECLIAUXV CHAR(50),
        ENDCLIAUXV CHAR(50),
        NUMCLIAUXV INTEGER,
        CIDCLIAUXV CHAR(30),
        UFCLIAUXV CHAR(2),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDAUXVENDAPK PRIMARY KEY (CODVENDA, CODAUXV, TIPOVENDA, CODFILIAL, CODEMP));

/* Table: VDCLASCLI, Owner: SYSDBA */
CREATE TABLE VDCLASCLI (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCLASCLI INTEGER NOT NULL,
        DESCCLASCLI CHAR(40) NOT NULL,
        SIGLACLASCLI CHAR(3),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDCLASCLIPK PRIMARY KEY (CODCLASCLI, CODFILIAL, CODEMP));

/* Table: VDCLCOMIS, Owner: SYSDBA */
CREATE TABLE VDCLCOMIS (CODEMP INTEGER NOT NULL,
        CODFILIAL INTEGER NOT NULL,
        CODCLCOMIS INTEGER NOT NULL,
        DESCCLCOMIS CHAR(50) NOT NULL,
        PERCFATCLCOMIS NUMERIC(9, 2),
        PERCPGTOCLCOMIS NUMERIC(9, 2),
        DTINS DATE DEFAULT 'today' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'today',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDCLCOMISPK PRIMARY KEY (CODCLCOMIS, CODFILIAL, CODEMP));

/* Table: VDCLIAUTP, Owner: SYSDBA */
CREATE TABLE VDCLIAUTP (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCLI INTEGER NOT NULL,
        CODAUTP SMALLINT NOT NULL,
        NOMEAUTP CHAR(50) NOT NULL,
        ENDAUTP CHAR(50),
        NUMAUTP INTEGER,
        COMPLAUTP CHAR(30),
        BAIRAUTP CHAR(30),
        CIDAUTP CHAR(30),
        UFAUTP CHAR(2),
        CEPAUTP CHAR(8),
        DDDAUTP CHAR(4),
        FONEAUTP CHAR(12),
        RGAUTP CHAR(13),
        SSPAUTP CHAR(10),
        CPFAUTP CHAR(11),
        FUNCAUTP CHAR(30),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDCLIAUTPPK PRIMARY KEY (CODCLI, CODAUTP, CODFILIAL, CODEMP));

/* Table: VDCLICOMPL, Owner: SYSDBA */
CREATE TABLE VDCLICOMPL (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCLI INTEGER NOT NULL,
        PAICLI CHAR(50),
        MAECLI CHAR(50),
        RGPAICLI CHAR(13),
        SSPPAICLI CHAR(10),
        RGMAECLI CHAR(13),
        SSPMAECLI CHAR(10),
        EMPTRABCLI CHAR(50),
        CARGOTRABCLI CHAR(20),
        DTADMTRABCLI DATE,
        RENDATRABCLI NUMERICDN,
        DDDTRABCLI CHAR(4),
        FONETRABCLI CHAR(9),
        ENDTRABCLI CHAR(50),
        NUMTRABCLI INTEGER,
        BAIRTRABCLI CHAR(30),
        CIDTRABCLI CHAR(30),
        UFTRABCLI CHAR(2),
        OUTRENDACLI NUMERICDN,
        FONTRENDACLI CHAR(50),
        NOMECONJCLI CHAR(50),
        DTNASCCONJCLI DATE,
        RENDACONJCLI NUMERICDN,
        COMPLTRABCLI CHAR(20),
        CEPTRABCLI CHAR(8),
        RAMALTRABCLI CHAR(8),
        RGCONJCLI CHAR(13),
        SSPCONJCLI CHAR(10),
        CPFCONJCLI CHAR(11),
        NATCONJCLI CHAR(30),
        UFNATCONJCLI CHAR(2),
        CARGOCONJCLI CHAR(20),
        EMPTRABCONJCLI CHAR(50),
        DTADMTRABCONJCLI DATE,
        NOMEAVALCLI CHAR(50),
        DTNASCAVALCLI DATE,
        RGAVALCLI CHAR(13),
        SSPAVALCLI CHAR(10),
        CPFAVALCLI CHAR(11),
        ENDAVALCLI CHAR(50),
        NUMAVALCLI INTEGER,
        BAIRAVALCLI CHAR(30),
        CIDVALCLI CHAR(30),
        CEPAVALCLI CHAR(8),
        UFAVALCLI CHAR(2),
        DDDAVALCLI CHAR(4),
        FONEAVALCLI CHAR(9),
        EMPTRABAVALCLI CHAR(50),
        DTADMTRABAVALCLI DATE,
        CARGOAVALCLI CHAR(20),
        RENDAAVALCLI NUMERICDN,
        DTFUNDACCLI DATE,
        RAMOATIVCLI CHAR(50),
        NUMFILIAISCLI SMALLINT,
        NUMFUNCCLI INTEGER,
        COMPRAREQCLI CHAR(1) DEFAULT 'S',
        FATURCLI NUMERICDN,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDCLICOMPLPK PRIMARY KEY (CODCLI, CODFILIAL, CODEMP));

/* Table: VDCLICONTAS, Owner: SYSDBA */
CREATE TABLE VDCLICONTAS (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCLI INTEGER NOT NULL,
        CODEMPBC INTEGER,
        CODFILIALBC SMALLINT,
        CODBANCO CHAR(3),
        CONTA CHAR(20) NOT NULL,
        DTABCONTA DATE,
        AGENCIA CHAR(30),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDCLICONTASPK PRIMARY KEY (CODCLI, CODFILIAL, CODEMP, CONTA));

/* Table: VDCLIENTE, Owner: SYSDBA */
CREATE TABLE VDCLIENTE (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCLI INTEGER NOT NULL,
        RAZCLI CHAR(60) NOT NULL,
        NOMECLI CHAR(50) NOT NULL,
        CODEMPCC INTEGER,
        CODFILIALCC SMALLINT,
        CODCLASCLI INTEGER,
        CODEMPVD INTEGER,
        CODFILIALVD SMALLINT,
        CODVEND INTEGER,
        CODEMPTC INTEGER,
        CODFILIALTC SMALLINT,
        CODTIPOCOB INTEGER,
        CODEMPPG INTEGER,
        CODFILIALPG SMALLINT,
        CODPLANOPAG INTEGER,
        CODEMPTN INTEGER,
        CODFILIALTN SMALLINT,
        CODTRAN INTEGER,
        CODEMPBO INTEGER,
        CODFILIALBO SMALLINT,
        CODBANCO CHAR(3),
        CODEMPSR INTEGER,
        CODFILIALSR SMALLINT,
        CODSETOR INTEGER,
        CODEMPTI INTEGER NOT NULL,
        CODFILIALTI SMALLINT NOT NULL,
        CODTIPOCLI INTEGER NOT NULL,
        CODTPCRED INTEGER,
        CODFILIALTR INTEGER,
        CODEMPTR INTEGER,
        CODFISCCLI INTEGER,
        CODEMPFC INTEGER,
        CODFILIALFC INTEGER,
        CODEMPEC INTEGER,
        CODFILIALEC SMALLINT,
        CODTBEC SMALLINT,
        CODITTBEC INTEGER,
        CODEMPHP INTEGER,
        CODFILIALHP SMALLINT,
        CODHIST INTEGER,
        CODEMPCB INTEGER,
        CODFILIALCB SMALLINT,
        CODCARTCOB CHAR(3),
        DATACLI DATE DEFAULT 'today' NOT NULL,
        PESSOACLI CHAR(1) NOT NULL,
        CONSUMIDORCLI CHAR(1) DEFAULT 'N' NOT NULL,
        ATIVOCLI CHAR(1) NOT NULL,
        CNPJCLI CHAR(14),
        INSCCLI VARCHAR(20),
        CPFCLI CHAR(11),
        RGCLI CHAR(13),
        SSPCLI CHAR(10),
        ENDCLI CHAR(50),
        NUMCLI INTEGER,
        COMPLCLI CHAR(20),
        EDIFICIOCLI VARCHAR(30),
        BAIRCLI CHAR(30),
        CIDCLI CHAR(30),
        UFCLI CHAR(2),
        CEPCLI CHAR(8),
        DDDCLI CHAR(4),
        FONECLI CHAR(12),
        RAMALCLI CHAR(6),
        DDDFAXCLI CHAR(4),
        FAXCLI VARCHAR(9),
        EMAILCLI CHAR(50),
        EMAILCOB CHAR(50),
        EMAILENT CHAR(50),
        EMAILNFECLI CHAR(50),
        CONTCLI CHAR(40),
        ENDCOB CHAR(50),
        NUMCOB INTEGER,
        COMPLCOB CHAR(20),
        BAIRCOB CHAR(30),
        CIDCOB CHAR(30),
        UFCOB CHAR(2),
        CEPCOB CHAR(8),
        DDDFONECOB CHAR(4),
        FONECOB CHAR(12),
        DDDFAXCOB CHAR(4),
        FAXCOB VARCHAR(9),
        ENDENT CHAR(50),
        NUMENT INTEGER,
        COMPLENT CHAR(20),
        BAIRENT CHAR(30),
        CIDENT CHAR(30),
        UFENT CHAR(2),
        CEPENT CHAR(8),
        DDDFONEENT CHAR(4),
        FONEENT CHAR(12),
        DDDFAXENT CHAR(4),
        FAXENT VARCHAR(9),
        DDDCELENT CHAR(4),
        CELENT VARCHAR(9),
        OBSCLI VARCHAR(10000),
        AGENCIACLI CHAR(6),
        NCONTABCOCLI VARCHAR(20),
        CODEMPPQ INTEGER,
        CODFILIALPQ SMALLINT,
        CODPESQ INTEGER,
        INCRACLI CHAR(15),
        DTINITR DATE,
        DTVENCTOTR DATE,
        NIRFCLI CHAR(15),
        SIMPLESCLI CHAR(1),
        DDDCELCLI CHAR(4),
        CELCLI VARCHAR(9),
        NATCLI CHAR(30),
        UFNATCLI CHAR(2),
        TEMPORESCLI CHAR(20),
        APELIDOCLI CHAR(30),
        SITECLI CHAR(50),
        CODCONTDEB VARCHAR(20),
        CODCONTCRED VARCHAR(20),
        CODCLICONTAB VARCHAR(20),
        FOTOCLI BLOB SUB_TYPE 0 SEGMENT SIZE 80,
        IMGASSCLI BLOB SUB_TYPE 0 SEGMENT SIZE 80,
        CODMUNIC CHAR(7),
        SIGLAUF CHAR(2),
        CODPAIS SMALLINT,
        CODMUNICENT CHAR(7),
        SIGLAUFENT CHAR(2),
        CODPAISENT SMALLINT,
        CODMUNICCOB CHAR(7),
        SIGLAUFCOB CHAR(2),
        CODPAISCOB SMALLINT,
        CODEMPUC INTEGER,
        CODFILIALUC SMALLINT,
        CODUNIFCOD INTEGER,
        SUFRAMACLI VARCHAR(9),
        PRODRURALCLI CHAR(1) DEFAULT 'N' NOT NULL,
        CTOCLI CHAR(1) DEFAULT 'C' NOT NULL,
        CODCNAE VARCHAR(15),
        INSCMUNCLI CHAR(20),
        PERCDESCCLI NUMERIC(3, 2),
        CONTCLICOB CHAR(40),
        CONTCLIENT CHAR(40),
        DESCIPI CHAR(1),
        IDENTCLIBCO CHAR(1) DEFAULT 'D' NOT NULL,
        DTNASCCLI DATE,
        -- REVISO DO CLIENTE N=NO REVISAR, O=OBRIGATRIA A REVISO, R=REVISADO
        SITREVCLI CHAR(1) DEFAULT 'N' NOT NULL,
        IDUSUREVCLI VARCHAR(128),
        DTREVCLI DATE,
        HREVCLI TIME,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT user,
CONSTRAINT VDCLIENTEPK PRIMARY KEY (CODCLI, CODFILIAL, CODEMP));

/* Table: VDCLIENTEFOR, Owner: SYSDBA */
CREATE TABLE VDCLIENTEFOR (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCLI INTEGER NOT NULL,
        CODEMPFR INTEGER NOT NULL,
        CODFILIALFR SMALLINT NOT NULL,
        CODFOR INTEGER NOT NULL,
        CODCLIFOR INTEGER,
        CODCPCLIFOR CHAR(10),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDCLIENTEFORPK PRIMARY KEY (CODCLI, CODFILIAL, CODEMP, CODFOR, CODFILIALFR, CODEMPFR));

/* Table: VDCLIIMOV, Owner: SYSDBA */
CREATE TABLE VDCLIIMOV (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCLI INTEGER NOT NULL,
        CODIMOV SMALLINT NOT NULL,
        TIPOIMOV CHAR(30),
        CONSTRIMOV CHAR(30),
        AREATERIMOV CHAR(30),
        VALORIMOV NUMERICDN,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDCLIIMOVPK PRIMARY KEY (CODCLI, CODFILIAL, CODEMP, CODIMOV));

/* Table: VDCLIMETAVEND, Owner: SYSDBA */
CREATE TABLE VDCLIMETAVEND (CODCLI INTEGER NOT NULL,
        CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        ANOMETAVEND SMALLINT NOT NULL,
        VLRMETAVEND NUMERICDN NOT NULL,
        OBSMETAVEND VARCHAR(500),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDCLIMETAVENDPK PRIMARY KEY (CODCLI, CODFILIAL, CODEMP, ANOMETAVEND));

/* Table: VDCLIREFC, Owner: SYSDBA */
CREATE TABLE VDCLIREFC (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCLI INTEGER NOT NULL,
        CODREFC SMALLINT NOT NULL,
        NOMEEMPREFC CHAR(50) NOT NULL,
        DDDREFC CHAR(4),
        FONEREFC CHAR(12),
        DTMAIORCP DATE,
        VLRMAIORCP NUMERICDN,
        NROPARCMAIORCP SMALLINT,
        DTULTCP DATE,
        VLRULTCP NUMERICDN,
        NROPARCULTCP SMALLINT,
        DTPRIMCP DATE,
        PONTUAL CHAR(1),
        MEDIAATRASO CHAR(20),
        CONCEITO CHAR(30),
        AVALISTA CHAR(1),
        INFORMANTE CHAR(50),
        OBSREFC VARCHAR(500),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDCLIREFCPK PRIMARY KEY (CODCLI, CODREFC, CODFILIAL, CODEMP));

/* Table: VDCLIREFP, Owner: SYSDBA */
CREATE TABLE VDCLIREFP (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCLI INTEGER NOT NULL,
        NOMEREFP CHAR(50) NOT NULL,
        ENDREFP CHAR(50),
        NUMREFP INTEGER,
        COMPLREFP CHAR(30),
        BAIRREFP CHAR(30),
        CIDREFP CHAR(30),
        UFREFP CHAR(2),
        CEPREFP CHAR(8),
        DDDREFP CHAR(4),
        FONEREFP CHAR(12),
        CODREFP SMALLINT NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDCLIREFPPK PRIMARY KEY (CODCLI, CODREFP, CODFILIAL, CODEMP));

/* Table: VDCLISOCIOS, Owner: SYSDBA */
CREATE TABLE VDCLISOCIOS (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCLI INTEGER NOT NULL,
        NOMESOCIO CHAR(50) NOT NULL,
        DTNASCSOCIO DATE,
        RGSOCIO CHAR(13),
        SSPSOCIO CHAR(10),
        CPFSOCIO CHAR(11),
        PERCCOTASSOCIO INTEGER,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDCLISOCIOSPK PRIMARY KEY (CODCLI, CODFILIAL, CODEMP, NOMESOCIO));

/* Table: VDCLITERRA, Owner: SYSDBA */
CREATE TABLE VDCLITERRA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCLI INTEGER NOT NULL,
        CODTERRA SMALLINT NOT NULL,
        ENDTERRA CHAR(50),
        NUMTERRA INTEGER,
        BAIRTERRA CHAR(30),
        CIDTERRA CHAR(30),
        UFTERRA CHAR(2),
        AREATERRA CHAR(30),
        QTDCAFETERRA INTEGER,
        QTDGADOTERRA INTEGER,
        OBSTERRA VARCHAR(500),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDCLITERRAPK PRIMARY KEY (CODCLI, CODFILIAL, CODEMP, CODTERRA));

/* Table: VDCLIVEIC, Owner: SYSDBA */
CREATE TABLE VDCLIVEIC (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCLI INTEGER NOT NULL,
        PLACAVEIC CHAR(10) NOT NULL,
        MODELOVEIC CHAR(50),
        ALIENADOVEIC CHAR(30),
        ANOVEIC SMALLINT,
        VALORVEIC NUMERICDN,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDCLIVEICPK PRIMARY KEY (PLACAVEIC, CODCLI, CODFILIAL, CODEMP));

/* Table: VDCOMISSAO, Owner: SYSDBA */
CREATE TABLE VDCOMISSAO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCOMI INTEGER NOT NULL,
        TIPOCOMI CHAR(1) DEFAULT 'F' NOT NULL,
        CODEMPRC INTEGER,
        CODFILIALRC SMALLINT,
        CODREC INTEGER,
        NPARCITREC INTEGER,
        VLRVENDACOMI NUMERICDN NOT NULL,
        VLRCOMI NUMERICDN              DEFAULT 0 NOT NULL,
        VLRPAGOCOMI NUMERICDN              DEFAULT 0 NOT NULL,
        VLRAPAGCOMI NUMERICDN              DEFAULT 0 NOT NULL,
        DATACOMI DATE NOT NULL,
        DTCOMPCOMI DATE NOT NULL,
        DTVENCCOMI DATE NOT NULL,
        DTPAGTOCOMI DATE,
        STATUSCOMI CHAR(2) NOT NULL,
        CODEMPCI INTEGER,
        CODFILIALCI SMALLINT,
        CODPCOMI INTEGER,
        FLAG CHAR(1) DEFAULT 'N',
        CODEMPCT INTEGER,
        CODFILIALCT SMALLINT,
        CODPCOMIANT INTEGER,
        CODEMPVD INTEGER,
        CODFILIALVD SMALLINT,
        CODVEND INTEGER,
        CODEMPVE INTEGER,
        CODFILIALVE SMALLINT,
        CODVENDA INTEGER,
        TIPOVENDA CHAR(1),
        EMMANUT CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDCOMISSAOPK PRIMARY KEY (CODCOMI, CODFILIAL, CODEMP));

/* Table: VDCONSIGNACAO, Owner: SYSDBA */
CREATE TABLE VDCONSIGNACAO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCONSIG INTEGER NOT NULL,
        CODEMPVD INTEGER NOT NULL,
        CODFILIALVD SMALLINT NOT NULL,
        CODVEND INTEGER NOT NULL,
        DOCCONSIG INTEGER NOT NULL,
        DTCONSIG DATE NOT NULL,
        CODEMPSL INTEGER,
        CODFILIALSL SMALLINT,
        CODLANCA INTEGER,
        CODSUBLANCA INTEGER,
        CODEMPSD INTEGER,
        CODFILIALSD SMALLINT,
        CODLANCASD INTEGER,
        CODSUBLANCASD INTEGER,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDCONSIGNACAOPK PRIMARY KEY (CODCONSIG, CODFILIAL, CODEMP));

/* Table: VDCONTRATO, Owner: SYSDBA */
CREATE TABLE VDCONTRATO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCONTR INTEGER NOT NULL,
        DESCCONTR CHAR(80) NOT NULL,
        MINUTACONTR VARCHAR(32000),
        CODEMPCL INTEGER NOT NULL,
        CODFILIALCL SMALLINT NOT NULL,
        CODCLI INTEGER NOT NULL,
        DTINICIO DATE NOT NULL,
        DTFIM DATE NOT NULL,
        TPCOBCONTR CHAR(2) NOT NULL,
        DIAVENCCONTR SMALLINT DEFAULT 0 NOT NULL,
        DIAFECHCONTR SMALLINT DEFAULT 0 NOT NULL,
        INDEXCONTR INTEGER DEFAULT 1 NOT NULL,
        TPCONTR CHAR(1) DEFAULT 'C' NOT NULL,
        SITCONTR CHAR(2) DEFAULT 'PE' NOT NULL,
        CODEMPMC INTEGER,
        CODFILIALMC SMALLINT,
        CODMODCONTR INTEGER,
        DTPREVFIN DATE,
        CODEMPSP INTEGER,
        CODFILIALSP SMALLINT,
        CODCONTRSP INTEGER,
        DESCSITCONTR VARCHAR(2000),
        ATIVO CHAR(1) DEFAULT 'S' NOT NULL,
        RECEBCONTR CHAR(1) DEFAULT 'S' NOT NULL,
        CONTHSUBCONTR CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDCONTRATOPK PRIMARY KEY (CODCONTR, CODFILIAL, CODEMP));

/* Table: VDCONTRORC, Owner: SYSDBA */
CREATE TABLE VDCONTRORC (CODEMP INTEGER NOT NULL,
        CODFILIAL INTEGER NOT NULL,
        CODCONTR INTEGER NOT NULL,
        CODITCONTR INTEGER NOT NULL,
        CODEMPOR INTEGER NOT NULL,
        CODFILIALOR INTEGER NOT NULL,
        TIPOORC CHAR(1) NOT NULL,
        CODORC INTEGER NOT NULL,
        CODITORC INTEGER NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDCONTRORCPK PRIMARY KEY (CODCONTR, CODITCONTR, CODFILIAL, CODEMP, CODORC, CODITORC, TIPOORC, CODFILIALOR, CODEMPOR));

/* Table: VDDETORC, Owner: SYSDBA */
CREATE TABLE VDDETORC (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        TIPOORC CHAR(1) DEFAULT 'O' NOT NULL,
        CODORC INTEGER NOT NULL,
        TITDETORC VARCHAR(100) NOT NULL,
        ATIVDETORC VARCHAR(2000) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT VARCHAR(128) DEFAULT USER,
CONSTRAINT VDDETORCPK PRIMARY KEY (CODORC, TIPOORC, CODFILIAL, CODEMP));

/* Table: VDETIQCLI, Owner: SYSDBA */
CREATE TABLE VDETIQCLI (NRCONEXAO INTEGER NOT NULL,
        CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCLI INTEGER NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER);

/* Table: VDFINCONTR, Owner: SYSDBA */
CREATE TABLE VDFINCONTR (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCONTR INTEGER NOT NULL,
        DTFINCONTR DATE DEFAULT 'now' NOT NULL,
        OBSFINCONTR VARCHAR(32000),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT VARCHAR(128) DEFAULT USER,
CONSTRAINT VDFINCONTRPK PRIMARY KEY (CODCONTR, CODFILIAL, CODEMP));

/* Table: VDFOTOPROD, Owner: SYSDBA */
CREATE TABLE VDFOTOPROD (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        CODFOTOPROD INTEGER NOT NULL,
        DESCFOTOPROD CHAR(40) NOT NULL,
        TIPOFOTOPROD CHAR(1) NOT NULL,
        LARGFOTOPROD INTEGER NOT NULL,
        ALTFOTOPROD INTEGER NOT NULL,
        FOTOPROD BLOB SUB_TYPE 0 SEGMENT SIZE 80 NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDFOTOPRODPK PRIMARY KEY (CODFOTOPROD, CODPROD, CODFILIAL, CODEMP));

/* Table: VDFRETEVD, Owner: SYSDBA */
CREATE TABLE VDFRETEVD (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        TIPOVENDA CHAR(1) DEFAULT 'V' NOT NULL,
        CODVENDA INTEGER NOT NULL,
        CODEMPTN INTEGER,
        CODFILIALTN SMALLINT,
        CODTRAN INTEGER,
        TIPOFRETEVD CHAR(1) NOT NULL,
        PLACAFRETEVD CHAR(10) NOT NULL,
        UFFRETEVD CHAR(2) NOT NULL,
        VLRFRETEVD NUMERICDN NOT NULL,
        QTDFRETEVD NUMERICDN NOT NULL,
        PESOBRUTVD NUMERICDN NOT NULL,
        PESOLIQVD NUMERICDN NOT NULL,
        ESPFRETEVD CHAR(10) NOT NULL,
        MARCAFRETEVD CHAR(10) NOT NULL,
        CONHECFRETEVD CHAR(13),
        PERCVENDAFRETEVD NUMERIC(9, 2),
        FLAG CHAR(1) DEFAULT 'N',
        ADICFRETEVD CHAR(1) DEFAULT 'N' NOT NULL,
        ADICFRETEBASEICM CHAR(1) DEFAULT 'N' NOT NULL,
        VLRBASEICMSFRETEVD NUMERICDN,
        ALIQICMSFRETEVD NUMERICDN,
        VLRICMSFRETEVD NUMERICDN,
        VLRSEGFRETEVD NUMERICDN,
        RNTCVD VARCHAR(20),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDFRETEVDPK PRIMARY KEY (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP));

/* Table: VDGRUPORC, Owner: SYSDBA */
CREATE TABLE VDGRUPORC (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODGO INTEGER NOT NULL,
        DESCGO VARCHAR(100) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT VARCHAR(128) DEFAULT USER,
CONSTRAINT VDGRUPORCPK PRIMARY KEY (CODGO, CODFILIAL, CODEMP));

/* Table: VDITCONTRATO, Owner: SYSDBA */
CREATE TABLE VDITCONTRATO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCONTR INTEGER NOT NULL,
        CODITCONTR SMALLINT NOT NULL,
        DESCITCONTR VARCHAR(80),
        CODEMPPD INTEGER NOT NULL,
        CODFILIALPD SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        QTDITCONTR NUMERICDN NOT NULL,
        VLRITCONTR NUMERICDN NOT NULL,
        CODEMPPE INTEGER NOT NULL,
        CODFILIALPE SMALLINT NOT NULL,
        CODPRODPE INTEGER NOT NULL,
        VLRITCONTREXCED NUMERICDN NOT NULL,
        INDEXITCONTR INTEGER DEFAULT 1 NOT NULL,
        KEYLIC VARCHAR(500),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
        ACUMULOITCONTR SMALLINT DEFAULT 0 NOT NULL,
        FRANQUIAITCONTR CHAR(1) DEFAULT 'S' NOT NULL,
CONSTRAINT VDIDCONTRATOPK PRIMARY KEY (CODCONTR, CODITCONTR, CODFILIAL, CODEMP));

/* Table: VDITCONTRATOAND, Owner: SYSDBA */
CREATE TABLE VDITCONTRATOAND (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCONTR INTEGER NOT NULL,
        CODITCONTR SMALLINT NOT NULL,
        SEQAND SMALLINT NOT NULL,
        OBSAND VARCHAR(200),
        PERCAND NUMERICDN NOT NULL,
        DATAAND DATE NOT NULL,
        HORAAND TIME NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDITCONTRATOANDPK PRIMARY KEY (CODCONTR, CODITCONTR, SEQAND, CODFILIAL, CODEMP));

/* Table: VDITCONTRATOFOR, Owner: SYSDBA */
CREATE TABLE VDITCONTRATOFOR (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCONTR INTEGER NOT NULL,
        CODITCONTR SMALLINT NOT NULL,
        SEQICF SMALLINT NOT NULL,
        CODEMPFR INTEGER NOT NULL,
        CODFILIALFR SMALLINT NOT NULL,
        CODFOR INTEGER NOT NULL,
        VLRAPAGFOR DECIMAL(15, 5) DEFAULT 0 NOT NULL,
        DTPREVINIFOR DATE,
        DTPREVFINFOR DATE,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT VARCHAR(128) DEFAULT USER NOT NULL,
CONSTRAINT VDITCONTRATOFORPK PRIMARY KEY (CODCONTR, CODITCONTR, SEQICF));

/* Table: VDITCUSTOORC, Owner: SYSDBA */
CREATE TABLE VDITCUSTOORC (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODORC INTEGER NOT NULL,
        CODITORC INTEGER NOT NULL,
        TIPOORC CHAR(1) NOT NULL,
        VLRPRECOULTCP NUMERICDN NOT NULL,
        VLRCUSTOMPM NUMERICDN NOT NULL,
        VLRCUSTOPEPS NUMERICDN NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDITCUSTOORCPK PRIMARY KEY (CODORC, CODITORC, TIPOORC, CODFILIAL, CODEMP));

/* Table: VDITCUSTOVENDA, Owner: SYSDBA */
CREATE TABLE VDITCUSTOVENDA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        TIPOVENDA CHAR(1) DEFAULT 'V' NOT NULL,
        CODVENDA INTEGER NOT NULL,
        CODITVENDA INTEGER NOT NULL,
        VLRPRECOULTCP NUMERICDN NOT NULL,
        VLRCUSTOMPM NUMERICDN NOT NULL,
        VLRCUSTOPEPS NUMERICDN NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDITCUSTOVENDAPK PRIMARY KEY (CODVENDA, CODITVENDA, TIPOVENDA, CODFILIAL, CODEMP));

/* Table: VDITDETORC, Owner: SYSDBA */
CREATE TABLE VDITDETORC (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        TIPOORC CHAR(1) DEFAULT 'O' NOT NULL,
        CODORC INTEGER NOT NULL,
        SEQDETORC SMALLINT NOT NULL,
        CODEMPGO INTEGER NOT NULL,
        CODFILIALGO SMALLINT NOT NULL,
        CODGO INTEGER NOT NULL,
        SEQITGO SMALLINT NOT NULL,
        TEXTOITDETORC VARCHAR(2000) NOT NULL,
        ITENSDETORC CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT VARCHAR(128) DEFAULT USER,
CONSTRAINT VDITDETORCPK PRIMARY KEY (CODORC, TIPOORC, SEQDETORC, CODFILIAL, CODEMP));

/* Table: VDITGRUPORC, Owner: SYSDBA */
CREATE TABLE VDITGRUPORC (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODGO INTEGER NOT NULL,
        SEQITGO SMALLINT NOT NULL,
        DESCITGO VARCHAR(2000) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT VARCHAR(128) DEFAULT USER,
CONSTRAINT VDITGRUPORCPK PRIMARY KEY (CODGO, SEQITGO, CODFILIAL, CODEMP));

/* Table: VDITKIT, Owner: SYSDBA */
CREATE TABLE VDITKIT (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODKIT INTEGER NOT NULL,
        SEQITKIT SMALLINT NOT NULL,
        CODEMPPD INTEGER NOT NULL,
        CODFILIALPD SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        REFPROD VARCHAR(20) NOT NULL,
        QTDITKIT NUMERICDN              DEFAULT 0 NOT NULL,
        PRECOITKIT NUMERICDN              DEFAULT 0 NOT NULL,
        VLRTOTITKIT NUMERICDN              DEFAULT 0 NOT NULL,
        EMMANUT CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDITKITPK PRIMARY KEY (CODKIT, SEQITKIT, CODFILIAL, CODEMP));

/* Table: VDITORCAMENTO, Owner: SYSDBA */
CREATE TABLE VDITORCAMENTO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        TIPOORC CHAR(1) DEFAULT 'O' NOT NULL,
        CODORC INTEGER NOT NULL,
        CODITORC INTEGER NOT NULL,
        CODEMPPD INTEGER NOT NULL,
        CODFILIALPD SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        CODEMPAX INTEGER NOT NULL,
        CODFILIALAX SMALLINT NOT NULL,
        CODALMOX INTEGER NOT NULL,
        QTDITORC NUMERICDN  DEFAULT 0 NOT NULL,
        QTDAPROVITORC NUMERICDN  DEFAULT 0,
        QTDAFATITORC NUMERICDN   DEFAULT 0 NOT NULL,
        QTDFATITORC NUMERICDN   DEFAULT 0 NOT NULL,
        PRECOITORC NUMERICDN  DEFAULT 0 NOT NULL,
        PERCDESCITORC NUMERICDN  DEFAULT 0,
        VLRDESCITORC NUMERICDN  DEFAULT 0,
        VLRLIQITORC NUMERICDN  DEFAULT 0,
        VLRPRODITORC NUMERICDN  DEFAULT 0,
        REFPROD VARCHAR(20),
        NUMAUTORIZORC CHAR(15),
        ACEITEITORC CHAR(1) DEFAULT 'N' NOT NULL,
        APROVITORC CHAR(1) DEFAULT 'N' NOT NULL,
        EMITITORC CHAR(1) DEFAULT 'N' NOT NULL,
        VENCAUTORIZORC DATE,
        STRDESCITORC CHAR(50),
        OBSITORC VARCHAR(10000),
        STATUSITORC CHAR(2) DEFAULT 'OA',
        CODEMPPE INTEGER,
        CODFILIALPE SMALLINT,
        CODPE INTEGER,
        DIASPE SMALLINT,
        EMMANUT CHAR(1),
        CODEMPLG INTEGER,
        CODFILIALLG INTEGER,
        CODLOG INTEGER,
        CODEMPLE INTEGER,
        CODFILIALLE SMALLINT,
        CODLOTE VARCHAR(20),
        SITENTITORC CHAR(1) DEFAULT 'N' NOT NULL,
        SITTERMRITORC CHAR(1) DEFAULT 'E' NOT NULL,
        CANCITORC CHAR(1) DEFAULT 'N' NOT NULL,
        FATITORC CHAR(1) DEFAULT 'N' NOT NULL,
        VLRCOMISITORC NUMERICDN  DEFAULT 0,
        PERCCOMISITORC NUMERIC(9, 2) DEFAULT 0,
        VLRFRETEITORC NUMERICDN  DEFAULT 0,
        DTAPROVITORC DATE,
        SITPRODITORC CHAR(2) DEFAULT 'NP' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDITORCAMENTOPK PRIMARY KEY (CODORC, CODITORC, TIPOORC, CODFILIAL, CODEMP));

/* Table: VDITREGRACOMIS, Owner: SYSDBA */
CREATE TABLE VDITREGRACOMIS (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODREGRCOMIS INTEGER NOT NULL,
        SEQITRC SMALLINT NOT NULL,
        CODEMPTV INTEGER NOT NULL,
        CODFILIALTV SMALLINT NOT NULL,
        CODTIPOVEND INTEGER NOT NULL,
        OBRIGITRC CHAR(1) DEFAULT 'S' NOT NULL,
        PERCCOMISITRC DECIMAL(7, 3) DEFAULT 0 NOT NULL,
        IDUSUALT CHAR(8) DEFAULT USER NOT NULL,
        CODEMPVD INTEGER,
        CODFILIALVD SMALLINT,
        CODVEND INTEGER,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
CONSTRAINT VDITREGRACOMISPK PRIMARY KEY (CODREGRCOMIS, SEQITRC, CODFILIAL, CODEMP));

/* Table: VDITROMANEIO, Owner: SYSDBA */
CREATE TABLE VDITROMANEIO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODROMA INTEGER NOT NULL,
        CODITROMA INTEGER NOT NULL,
        CODEMPVA INTEGER NOT NULL,
        CODFILIALVA SMALLINT NOT NULL,
        TIPOVENDA CHAR(1) DEFAULT 'V' NOT NULL,
        CODVENDA INTEGER NOT NULL,
        DTPREVITROMA DATE NOT NULL,
        FLAG CHAR(1) DEFAULT 'N',
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDITROMANEIO PRIMARY KEY (CODITROMA, CODROMA, CODFILIAL, CODEMP));

/* Table: VDITVENDA, Owner: SYSDBA */
CREATE TABLE VDITVENDA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        TIPOVENDA CHAR(1) DEFAULT 'V' NOT NULL,
        CODVENDA INTEGER NOT NULL,
        CODITVENDA INTEGER NOT NULL,
        CODEMPNT INTEGER NOT NULL,
        CODFILIALNT SMALLINT NOT NULL,
        CODNAT CHAR(4) NOT NULL,
        CODEMPPD INTEGER NOT NULL,
        CODFILIALPD SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        CODEMPLE INTEGER,
        CODFILIALLE SMALLINT,
        CODLOTE VARCHAR(20),
        CODEMPAX INTEGER NOT NULL,
        CODFILIALAX SMALLINT NOT NULL,
        CODALMOX INTEGER NOT NULL,
        QTDITVENDA NUMERICDN NOT NULL,
        QTDITVENDACANC NUMERICDN,
        PRECOITVENDA NUMERICDN NOT NULL,
        PERCDESCITVENDA NUMERICDN,
        VLRDESCITVENDA NUMERICDN,
        PERCICMSITVENDA NUMERICDN,
        VLRBASEICMSITVENDA NUMERICDN,
        VLRICMSITVENDA NUMERICDN,
        PERCIPIITVENDA NUMERICDN,
        VLRBASEIPIITVENDA NUMERICDN,
        VLRIPIITVENDA NUMERICDN,
        VLRLIQITVENDA NUMERICDN,
        PERCCOMISITVENDA NUMERICDN,
        VLRCOMISITVENDA NUMERICDN,
        VLRADICITVENDA NUMERICDN,
        PERCISSITVENDA NUMERICDN,
        VLRISSITVENDA NUMERICDN,
        VLRFRETEITVENDA NUMERICDN,
        VLRPRODITVENDA NUMERICDN,
        VLRISENTASITVENDA NUMERICDN,
        VLROUTRASITVENDA NUMERICDN,
        REFPROD VARCHAR(20),
        VLRBASEISSITVENDA NUMERICDN              DEFAULT 0,
        VLRBASEICMSBRUTITVENDA NUMERICDN              
DEFAULT 0,
        VLRBASEICMSSTITVENDA NUMERICDN,
        VLRICMSSTITVENDA NUMERICDN,
        VLRBASECOMISITVENDA NUMERICDN,
        MARGEMVLAGRITVENDA NUMERICDN,
        OBSITVENDA VARCHAR(10000),
        ORIGFISC CHAR(1),
        CODEMPTT INTEGER,
        CODFILIALTT INTEGER,
        CODTRATTRIB CHAR(2),
        TIPOFISC CHAR(2),
        TIPOST CHAR(2),
        CODEMPME INTEGER,
        CODFILIALME SMALLINT,
        CODMENS INTEGER,
        STRDESCITVENDA CHAR(50),
        QTDDEVITVENDA NUMERICDN              DEFAULT 0,
        CODEMPLG INTEGER,
        CODFILIALLG SMALLINT,
        CODLOG INTEGER,
        CANCITVENDA CHAR(1),
        CODEMPPE INTEGER,
        CODFILIALPE SMALLINT,
        CODPE INTEGER,
        DIASPE SMALLINT,
        CODEMPCV INTEGER,
        CODFILIALCV SMALLINT,
        CODCONV INTEGER,
        CODEMPIF INTEGER,
        CODFILIALIF INTEGER,
        CODFISC CHAR(13),
        CODITFISC INTEGER,
        CODEMPCP INTEGER,
        CODFILIALCP SMALLINT,
        CODCOMPRA INTEGER,
        CODITCOMPRA INTEGER,
        CODEMPVR INTEGER,
        CODFILIALVR SMALLINT,
        TIPOVENDAVR CHAR(1),
        CODVENDAVR INTEGER,
        CODITVENDAVR INTEGER,
        CODEMPNS INTEGER,
        CODFILIALNS SMALLINT,
        NUMSERIETMP VARCHAR(30),
        VLRBASEICMSSTRETITVENDA NUMERICDN,
        VLRICMSSTRETITVENDA NUMERICDN,
        CALCSTCM CHAR(1) DEFAULT 'N',
        EMMANUT CHAR(1) DEFAULT 'N',
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDITVENDAPK PRIMARY KEY (CODVENDA, CODITVENDA, TIPOVENDA, CODFILIAL, CODEMP));

/* Table: VDITVENDAITVENDA, Owner: SYSDBA */
CREATE TABLE VDITVENDAITVENDA (ID BIGINT NOT NULL,
        CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        TIPOVENDA CHAR(1) DEFAULT 'V' NOT NULL,
        CODVENDA INTEGER NOT NULL,
        CODITVENDA INTEGER NOT NULL,
        CODEMPVO INTEGER NOT NULL,
        CODFILIALVO SMALLINT NOT NULL,
        TIPOVENDAVO CHAR(1) DEFAULT 'V' NOT NULL,
        CODVENDAVO INTEGER NOT NULL,
        CODITVENDAVO INTEGER NOT NULL,
        QTDITVENDA DECIMAL(15, 5) DEFAULT 0 NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT VARCHAR(128) DEFAULT USER,
CONSTRAINT VDITVENDAITVENDAPK PRIMARY KEY (ID));

/* Table: VDITVENDASERIE, Owner: SYSDBA */
CREATE TABLE VDITVENDASERIE (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODVENDA INTEGER NOT NULL,
        TIPOVENDA CHAR(1) NOT NULL,
        CODITVENDA INTEGER NOT NULL,
        SEQITSERIE INTEGER NOT NULL,
        CODEMPPD INTEGER,
        CODFILIALPD SMALLINT,
        CODPROD INTEGER,
        NUMSERIE VARCHAR(30),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDITVENDASERIEPK PRIMARY KEY (CODVENDA, CODITVENDA, TIPOVENDA, SEQITSERIE, CODFILIAL, CODEMP));

/* Table: VDITVENDAVDITCONTR, Owner: SYSDBA */
CREATE TABLE VDITVENDAVDITCONTR (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        TIPOVENDA CHAR(1) DEFAULT 'V' NOT NULL,
        CODVENDA INTEGER NOT NULL,
        CODITVENDA INTEGER NOT NULL,
        CODEMPCT INTEGER NOT NULL,
        CODFILIALCT SMALLINT NOT NULL,
        CODCONTR INTEGER NOT NULL,
        CODITCONTR SMALLINT NOT NULL,
        DTINIAPURA DATE NOT NULL,
        DTFINAPURA DATE NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT VARCHAR(128) DEFAULT USER,
CONSTRAINT VDITVENDAVDITCONPK PRIMARY KEY (CODVENDA, CODITVENDA, TIPOVENDA, CODFILIAL, CODEMP));

/* Table: VDKIT, Owner: SYSDBA */
CREATE TABLE VDKIT (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODKIT INTEGER NOT NULL,
        CODEMPPD INTEGER NOT NULL,
        CODFILIALPD SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        REFPROD VARCHAR(20) NOT NULL,
        QTDKIT NUMERICDN              DEFAULT 0 NOT NULL,
        PRECOKIT NUMERICDN              DEFAULT 0 NOT NULL,
        VLRTOTKIT NUMERICDN              DEFAULT 0 NOT NULL,
        EMMANUT CHAR(1) DEFAULT 'N' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDKITPK PRIMARY KEY (CODKIT, CODFILIAL, CODEMP));

/* Table: VDLOGSITCONTR, Owner: SYSDBA */
CREATE TABLE VDLOGSITCONTR (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCONTR INTEGER NOT NULL,
        SEQLOG INTEGER NOT NULL,
        SITCONTR CHAR(2) NOT NULL,
        DESCSITCONTR VARCHAR(2000),
        DTPREVFIN DATE,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDLOGSITCONTRPK PRIMARY KEY (CODCONTR, SEQLOG, CODFILIAL, CODEMP));

/* Table: VDMODCONTR, Owner: SYSDBA */
CREATE TABLE VDMODCONTR (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODMODCONTR INTEGER NOT NULL,
        DESCMODCONTR CHAR(80) NOT NULL,
        LAYOUTMODCONTR VARCHAR(100) NOT NULL,
        TPMODCONTR CHAR(1) DEFAULT 'O' NOT NULL,
        CODEMPBO INTEGER,
        CODFILIALBO SMALLINT,
        CODBANCO CHAR(3),
        CODEMPCB INTEGER,
        CODFILIALCB SMALLINT,
        CODCARTCOB CHAR(3),
        TEXTO1 VARCHAR(10000),
        TEXTO2 VARCHAR(10000),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDMODCONTRPK PRIMARY KEY (CODMODCONTR, CODFILIAL, CODEMP));

/* Table: VDMOTORISTA, Owner: SYSDBA */
CREATE TABLE VDMOTORISTA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODMOT INTEGER NOT NULL,
        CNH CHAR(11) NOT NULL,
        CODPAIS SMALLINT,
        CODMUNIC CHAR(7),
        SIGLAUF CHAR(2),
        NOMEMOT VARCHAR(100) NOT NULL,
        CPFMOT CHAR(11),
        ENDMOT CHAR(50),
        NUMMOT INTEGER,
        COMPLMOT CHAR(20),
        BAIRMOT CHAR(30),
        CEPMOT CHAR(8),
        FONEMOT CHAR(12),
        CELMOT VARCHAR(9),
        DDDMOT CHAR(4),
        CONJUGEMOT VARCHAR(100),
        NRODEPENDMOT SMALLINT DEFAULT 0,
        RGMOT CHAR(13),
        SSPMOT CHAR(10),
        NROPISMOT VARCHAR(20),
        OBSMOT VARCHAR(1000),
        EMAILMOT VARCHAR(60),
        CODEMPTN INTEGER,
        CODFILIALTN SMALLINT,
        CODTRAN INTEGER,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDMOTORISTAPK PRIMARY KEY (CODMOT, CODFILIAL, CODEMP));

/* Table: VDOBSCLI, Owner: SYSDBA */
CREATE TABLE VDOBSCLI (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCLI INTEGER NOT NULL,
        SEQOBSCLI INTEGER NOT NULL,
        DTOBSCLI DATE NOT NULL,
        HOBSCLI TIME NOT NULL,
        TXTOBSCLI VARCHAR(10000) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDOBSCLIPK PRIMARY KEY (CODCLI, SEQOBSCLI, CODFILIAL, CODEMP));

/* Table: VDORCAMENTO, Owner: SYSDBA */
CREATE TABLE VDORCAMENTO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        TIPOORC CHAR(1) DEFAULT 'O' NOT NULL,
        CODORC INTEGER NOT NULL,
        CODEMPAE INTEGER,
        CODFILIALAE SMALLINT,
        CODATEND INTEGER,
        CODEMPCV INTEGER,
        CODFILIALCV SMALLINT,
        CODCONV INTEGER,
        DTORC DATE NOT NULL,
        DTVENCORC DATE NOT NULL,
        VLRPRODORC NUMERICDN  DEFAULT 0,
        PERCDESCORC NUMERICDN  DEFAULT 0,
        VLRDESCORC NUMERICDN  DEFAULT 0,
        PERCADICORC NUMERIC(15, 5) DEFAULT 0,
        VLRADICORC NUMERICDN  DEFAULT 0,
        VLRDESCITORC NUMERICDN  DEFAULT 0,
        VLRLIQORC NUMERICDN  DEFAULT 0,
        STATUSORC CHAR(2) NOT NULL,
        OBSORC VARCHAR(10000),
        CODPLANOPAG INTEGER,
        CODFILIALPG INTEGER,
        CODEMPPG INTEGER,
        TXT01 CHAR(20),
        CODEMPVD INTEGER NOT NULL,
        CODFILIALVD SMALLINT NOT NULL,
        CODVEND INTEGER NOT NULL,
        CODEMPCL INTEGER NOT NULL,
        CODFILIALCL SMALLINT NOT NULL,
        CODCLI INTEGER NOT NULL,
        CODTPCONV INTEGER,
        CODFILIALTC INTEGER,
        CODEMPTC INTEGER,
        PRAZOENTORC SMALLINT,
        EMMANUT CHAR(1),
        CODCLCOMIS INTEGER,
        CODEMPCM SMALLINT,
        CODFILIALCM INTEGER,
        CODEMPTN INTEGER,
        CODFILIALTN SMALLINT,
        CODTRAN INTEGER,
        TIPOFRETE CHAR(1),
        ADICFRETE CHAR(1),
        VLRFRETEORC NUMERICDN  DEFAULT 0,
        VLRCOMISORC NUMERICDN  DEFAULT 0,
        CODEMPTM INTEGER,
        CODFILIALTM SMALLINT,
        CODTIPOMOV INTEGER,
        DTAPROVORC DATE,
        DTPREVENTORC DATE,
        HPREVENTORC TIME,
        JUSTIFICCANCORC VARCHAR(500),
        ACORC VARCHAR(80),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDORCAMENTOPK PRIMARY KEY (CODORC, TIPOORC, CODFILIAL, CODEMP));

/* Table: VDPRAZOENT, Owner: SYSDBA */
CREATE TABLE VDPRAZOENT (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODPE INTEGER NOT NULL,
        DESCPE CHARMIDDLEDN NOT NULL,
        DIASPE SMALLINT DEFAULT 0 NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDPRAZOENTPK PRIMARY KEY (CODPE, CODFILIAL, CODEMP));

/* Table: VDPRECOPROD, Owner: SYSDBA */
CREATE TABLE VDPRECOPROD (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        CODPRECOPROD INTEGER NOT NULL,
        CODEMPTB INTEGER NOT NULL,
        CODFILIALTB SMALLINT NOT NULL,
        CODTAB INTEGER NOT NULL,
        CODEMPCC INTEGER,
        CODFILIALCC SMALLINT,
        CODCLASCLI INTEGER,
        CODEMPPG INTEGER,
        CODFILIALPG SMALLINT,
        CODPLANOPAG INTEGER,
        PRECOPROD NUMERICDN NOT NULL,
        TIPOPRECOPROD CHAR(1) DEFAULT 'B',
        DTALTPRECO DATE,
        HALTPRECO TIME,
        PRECOANT NUMERICDN,
        IDUSUALTPRECO CHAR(8),
        ATIVOPRECOPROD CHAR(1) DEFAULT 'S' NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDPRECOPRODPK PRIMARY KEY (CODPRECOPROD, CODPROD, CODFILIAL, CODEMP));

/* Table: VDPREVTRIBITORC, Owner: SYSDBA */
CREATE TABLE VDPREVTRIBITORC (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        TIPOORC CHAR(1) DEFAULT 'O' NOT NULL,
        CODORC INTEGER NOT NULL,
        CODITORC INTEGER NOT NULL,
        VLRICMSITORC NUMERICDN,
        VLRIPIITORC NUMERICDN,
        VLRPISITORC NUMERICDN,
        VLRCOFINSITORC NUMERICDN,
        VLRIRITORC NUMERICDN,
        VLRCSOCIALITORC NUMERICDN,
        VLRISSITORC NUMERICDN,
        VLRSIMPLESITORC NUMERICDN,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDPREVTRIBITORCPK PRIMARY KEY (CODORC, CODITORC, TIPOORC, CODFILIAL, CODEMP));

/* Table: VDREGCOMISDESC, Owner: SYSDBA */
CREATE TABLE VDREGCOMISDESC (CODEMP INTEGER NOT NULL,
        CODFILIAL INTEGER NOT NULL,
        CODREGCOMISDESC SMALLINT NOT NULL,
        DESCREGCOMISDESC VARCHAR(100),
        DESCONTO NUMERIC(15, 2),
        COMISSAO NUMERIC(15, 2),
        DTINS DATE DEFAULT 'now',
        HINS TIME DEFAULT 'now',
        IDUSUINS CHAR(8) DEFAULT USER,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDREGCOMISDESCPK PRIMARY KEY (CODEMP, CODFILIAL, CODREGCOMISDESC));

/* Table: VDREGRACOMIS, Owner: SYSDBA */
CREATE TABLE VDREGRACOMIS (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODREGRCOMIS INTEGER NOT NULL,
        DESCREGRCOMIS CHAR(50) NOT NULL,
        IDUSUALT CHAR(8) DEFAULT USER NOT NULL,
        CODEMPSC INTEGER,
        CODFILIALSC SMALLINT,
        CODSECAO VARCHAR(13),
        PERCCOMISGERAL NUMERICDN,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
CONSTRAINT VDREGRACOMISPK PRIMARY KEY (CODREGRCOMIS, CODFILIAL, CODEMP));

/* Table: VDREMCONSIG, Owner: SYSDBA */
CREATE TABLE VDREMCONSIG (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCONSIG INTEGER NOT NULL,
        CODREMCO SMALLINT NOT NULL,
        CODEMPPD INTEGER NOT NULL,
        CODFILIALPD SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        QTDSAIDA NUMERICDN NOT NULL,
        QTDDEVOL NUMERICDN,
        QTDTROCA NUMERICDN,
        QTDBONIF NUMERICDN,
        PRECO NUMERICDN NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDREMCONSIGPK PRIMARY KEY (CODCONSIG, CODREMCO, CODFILIAL, CODEMP));

/* Table: VDROMANEIO, Owner: SYSDBA */
CREATE TABLE VDROMANEIO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODROMA INTEGER NOT NULL,
        DATAROMA DATE NOT NULL,
        DTSAIDAROMA DATE NOT NULL,
        DTPREVROMA DATE NOT NULL,
        DTENTREGAROMA DATE,
        STATUSROMA CHAR(2) NOT NULL,
        CODEMPTN INTEGER,
        CODFILIALTN SMALLINT,
        CODTRAN INTEGER,
        CODEMPEX INTEGER,
        CODFILIALEX SMALLINT,
        TICKET INTEGER,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDROMANEIOPK PRIMARY KEY (CODROMA, CODFILIAL, CODEMP));

/* Table: VDSETOR, Owner: SYSDBA */
CREATE TABLE VDSETOR (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODSETOR INTEGER NOT NULL,
        DESCSETOR CHAR(40) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDSETORPK PRIMARY KEY (CODSETOR, CODFILIAL, CODEMP));

/* Table: VDSETORROTA, Owner: SYSDBA */
CREATE TABLE VDSETORROTA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODSETOR INTEGER NOT NULL,
        SEQUENCIA INTEGER NOT NULL,
        CODEMPCL INTEGER NOT NULL,
        CODFILIALCL SMALLINT NOT NULL,
        CODCLI INTEGER NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDSETORROTAPK PRIMARY KEY (CODEMP, CODFILIAL, CODSETOR, SEQUENCIA));

/* Table: VDSTATUSORC, Owner: SYSDBA */
CREATE TABLE VDSTATUSORC (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        TIPOORC CHAR(1) NOT NULL,
        CODORC INTEGER NOT NULL,
        CODEMPTB INTEGER NOT NULL,
        CODFILIALTB SMALLINT NOT NULL,
        CODTB SMALLINT NOT NULL,
        CODITTB SMALLINT NOT NULL,
        DTASTORC DATE DEFAULT 'today' NOT NULL,
        HORASTORC TIME DEFAULT 'now' NOT NULL,
        MOTIVOSTORC VARCHAR(10000),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDSTATUSORCPK PRIMARY KEY (CODORC, TIPOORC, CODFILIAL, CODEMP, CODITTB, CODTB, CODFILIALTB, CODEMPTB));

/* Table: VDTABPRECO, Owner: SYSDBA */
CREATE TABLE VDTABPRECO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTAB INTEGER NOT NULL,
        DESCTAB CHAR(40) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDTABPRECOPK PRIMARY KEY (CODTAB, CODFILIAL, CODEMP));

/* Table: VDTEF, Owner: SYSDBA */
CREATE TABLE VDTEF (CODEMP INTEGER NOT NULL,
        CODFILIAL INTEGER NOT NULL,
        TIPOVENDA CHAR(1) NOT NULL,
        CODVENDA INTEGER NOT NULL,
        NSUTEF CHAR(20) NOT NULL,
        REDETEF CHAR(30),
        DTTRANSTEF DATE,
        VLRTEF NUMERIC(15, 3),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDTEFPK PRIMARY KEY (CODVENDA, NSUTEF, TIPOVENDA, CODFILIAL, CODEMP));

/* Table: VDTIPOCLI, Owner: SYSDBA */
CREATE TABLE VDTIPOCLI (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTIPOCLI INTEGER NOT NULL,
        DESCTIPOCLI CHAR(40) NOT NULL,
        CHEQTIPOCLI CHAR(1) DEFAULT 'N' NOT NULL,
        FISTIPOCLI CHAR(1) DEFAULT 'N' NOT NULL,
        JURTIPOCLI CHAR(1) DEFAULT 'N' NOT NULL,
        FILTIPOCLI CHAR(1) DEFAULT 'N' NOT NULL,
        LOCTRABTIPOCLI CHAR(1) DEFAULT 'N' NOT NULL,
        REFCOMLTIPOCLI CHAR(1) DEFAULT 'N' NOT NULL,
        BANCTIPOCLI CHAR(1) DEFAULT 'N' NOT NULL,
        REFPESTIPOCLI CHAR(1) DEFAULT 'N' NOT NULL,
        CONJTIPOCLI CHAR(1) DEFAULT 'N' NOT NULL,
        VEICTIPOCLI CHAR(1) DEFAULT 'N' NOT NULL,
        IMOVTIPOCLI CHAR(1) DEFAULT 'N' NOT NULL,
        TERRATIPOCLI CHAR(1) DEFAULT 'N' NOT NULL,
        PESAUTCPTIPOCLI CHAR(1) DEFAULT 'N' NOT NULL,
        AVALTIPOCLI CHAR(1) DEFAULT 'N' NOT NULL,
        SOCIOTIPOCLI CHAR(1) DEFAULT 'N' NOT NULL,
        PRODRURALTIPOCLI CHAR(1) DEFAULT 'N' NOT NULL,
        WEB CHAR(1) DEFAULT 'N' NOT NULL,
        SIGLATIPOCLI CHAR(3),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDTIPOCLIPK PRIMARY KEY (CODTIPOCLI, CODFILIAL, CODEMP));

/* Table: VDTIPOVEND, Owner: SYSDBA */
CREATE TABLE VDTIPOVEND (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTIPOVEND INTEGER NOT NULL,
        DESCTIPOVEND CHAR(50) NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS VARCHAR(128) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now' NOT NULL,
        HALT TIME DEFAULT 'now' NOT NULL,
        IDUSUALT VARCHAR(128) DEFAULT USER NOT NULL,
CONSTRAINT VDTIPOVENDPK PRIMARY KEY (CODTIPOVEND, CODFILIAL, CODEMP));

/* Table: VDTRANSP, Owner: SYSDBA */
CREATE TABLE VDTRANSP (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTRAN INTEGER NOT NULL,
        RAZTRAN CHAR(50) NOT NULL,
        NOMETRAN CHAR(40) NOT NULL,
        CNPJTRAN CHAR(14),
        CPFTRAN CHAR(11),
        INSCTRAN VARCHAR(20),
        ENDTRAN CHAR(50),
        NUMTRAN INTEGER,
        COMPLTRAN CHAR(20),
        BAIRTRAN CHAR(30),
        CIDTRAN CHAR(30),
        CEPTRAN CHAR(8),
        FONETRAN CHAR(12),
        FAXTRAN VARCHAR(9),
        UFTRAN CHAR(2),
        TIPOTRAN CHAR(1) DEFAULT 'T',
        CELTRAN VARCHAR(9),
        CONTTRAN CHAR(40),
        DDDFONETRAN CHAR(4),
        DDDFAXTRAN CHAR(4),
        DDDCELTRAN CHAR(4),
        CODMUNIC CHAR(7),
        SIGLAUF CHAR(2),
        CODPAIS SMALLINT,
        CODEMPUC INTEGER,
        CODFILIALUC SMALLINT,
        CODUNIFCOD INTEGER,
        CODEMPFR INTEGER,
        CODFILIALFR SMALLINT,
        CODFOR INTEGER,
        CONJUGETRAN CHAR(50),
        CODEMPBO INTEGER,
        CODFILIALBO SMALLINT,
        CODBANCO CHAR(3),
        AGENCIATRAN CHAR(10),
        NUMCONTATRAN CHAR(10),
        PLACATRAN CHAR(7),
        NRODEPENDTRAN SMALLINT DEFAULT 0,
        RGTRAN CHAR(13),
        SSPTRAN CHAR(10),
        CODGPS CHAR(4),
        NROPISTRAN VARCHAR(20),
        OBSTRAN VARCHAR(10000),
        EMAILTRAN VARCHAR(60),
        EMAILNFETRAN VARCHAR(60),
        RNTCTRAN VARCHAR(20),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDTRANSPPK PRIMARY KEY (CODTRAN, CODFILIAL, CODEMP));

/* Table: VDTRANSPMOT, Owner: SYSDBA */
CREATE TABLE VDTRANSPMOT (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTRAN INTEGER NOT NULL,
        CODEMPMT INTEGER NOT NULL,
        CODFILIALMT SMALLINT NOT NULL,
        CODMOT INTEGER NOT NULL,
CONSTRAINT VDTRANSPMOTPK PRIMARY KEY (CODTRAN, CODFILIAL, CODEMP, CODMOT, CODFILIALMT, CODEMPMT));

/* Table: VDTRANSPVEIC, Owner: SYSDBA */
CREATE TABLE VDTRANSPVEIC (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODTRAN INTEGER NOT NULL,
        CODEMPVE INTEGER NOT NULL,
        CODFILIALVE SMALLINT NOT NULL,
        CODVEIC INTEGER NOT NULL,
CONSTRAINT VDTRANSPVEICPK PRIMARY KEY (CODTRAN, CODFILIAL, CODEMP, CODVEIC, CODFILIALVE, CODEMPVE));

/* Table: VDVEICULO, Owner: SYSDBA */
CREATE TABLE VDVEICULO (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODVEIC INTEGER NOT NULL,
        PLACA CHAR(7) NOT NULL,
        RENAVAM CHAR(12),
        CODPAIS SMALLINT,
        CODMUNIC CHAR(7),
        SIGLAUF CHAR(2),
        FABRICANTE VARCHAR(100),
        MODELO VARCHAR(250),
        DESCCOR CHAR(60),
        CODCOR INTEGER,
        OBS VARCHAR(1000),
        ANOFABRIC INTEGER,
        ANOMODELO INTEGER,
        CODEMPTN INTEGER,
        CODFILIALTN SMALLINT,
        CODTRAN INTEGER,
        RNTC VARCHAR(20),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDVEICULOPK PRIMARY KEY (CODVEIC, CODFILIAL, CODEMP));

/* Table: VDVENDA, Owner: SYSDBA */
CREATE TABLE VDVENDA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        TIPOVENDA CHAR(1) DEFAULT 'V' NOT NULL,
        CODVENDA INTEGER NOT NULL,
        SUBTIPOVENDA CHAR(2) DEFAULT 'NF' NOT NULL,
        CODEMPVD INTEGER,
        CODFILIALVD SMALLINT,
        CODVEND INTEGER,
        CODEMPCL INTEGER NOT NULL,
        CODFILIALCL SMALLINT NOT NULL,
        CODCLI INTEGER NOT NULL,
        CODEMPPG INTEGER NOT NULL,
        CODFILIALPG SMALLINT NOT NULL,
        CODPLANOPAG INTEGER NOT NULL,
        CODEMPSE INTEGER NOT NULL,
        CODFILIALSE SMALLINT NOT NULL,
        SERIE CHAR(4) NOT NULL,
        CODEMPTM INTEGER NOT NULL,
        CODFILIALTM SMALLINT NOT NULL,
        CODTIPOMOV INTEGER NOT NULL,
        CODEMPCX INTEGER,
        CODFILIALCX SMALLINT,
        CODCAIXA INTEGER,
        DOCVENDA INTEGER NOT NULL,
        DTSAIDAVENDA DATE NOT NULL,
        DTEMITVENDA DATE NOT NULL,
        DTCOMPVENDA DATE NOT NULL,
        CODEMPRM INTEGER,
        CODFILIALRM SMALLINT,
        TICKET INTEGER,
        VLRPRODVENDA NUMERICDN,
        PERCDESCVENDA NUMERICDN,
        VLRDESCVENDA NUMERICDN,
        VLRDESCITVENDA NUMERICDN,
        VLRVENDA NUMERICDN,
        VLRBASEICMSVENDA NUMERICDN,
        VLRICMSVENDA NUMERICDN,
        CALCICMSVENDA CHAR(1) DEFAULT 'N',
        IMPICMSVENDA CHAR(1) DEFAULT 'N',
        VLRISENTASVENDA NUMERICDN,
        VLROUTRASVENDA NUMERICDN,
        VLRBASEIPIVENDA NUMERICDN,
        VLRLIQVENDA NUMERICDN,
        PERCCOMISVENDA NUMERIC(9, 2),
        VLRCOMISVENDA NUMERICDN,
        STATUSVENDA CHAR(2) NOT NULL,
        VLRFRETEVENDA NUMERICDN,
        VLRADICVENDA NUMERICDN,
        VLRIPIVENDA NUMERICDN,
        CALCIPIVENDA CHAR(1) DEFAULT 'N',
        IMPIPIVENDA CHAR(1) DEFAULT 'N',
        OBSVENDA VARCHAR(10000),
        CODEMPBO INTEGER,
        CODFILIALBO SMALLINT,
        CODBANCO CHAR(3),
        CODEMPTC INTEGER,
        CODFILIALTC SMALLINT,
        CODTIPOCOB INTEGER,
        VLRBASEISSVENDA NUMERICDN              DEFAULT 0,
        VLRISSVENDA NUMERICDN              DEFAULT 0,
        CALCISSVENDA CHAR(1) DEFAULT 'N',
        IMPIISSVENDA CHAR(1) DEFAULT 'N',
        IMPNOTAVENDA VARCHAR(10000) DEFAULT 'N',
        FLAG CHAR(1) DEFAULT 'N',
        CODCLASCOMIS CHAR(1),
        VLRPISVENDA NUMERICDN              DEFAULT 0,
        CALCPISVENDA CHAR(1) DEFAULT 'N',
        IMPPISVENDA CHAR(1) DEFAULT 'N',
        VLRCOFINSVENDA NUMERICDN              DEFAULT 0,
        CALCCOFINSVENDA CHAR(1) DEFAULT 'N',
        IMPCOFINSVENDA CHAR(1) DEFAULT 'N',
        VLRIRVENDA NUMERICDN              DEFAULT 0,
        CALCIRVENDA CHAR(1) DEFAULT 'N',
        IMPIRVENDA CHAR(1) DEFAULT 'N',
        VLRCSOCIALVENDA NUMERICDN              DEFAULT 0,
        CALCCSOCIALVENDA CHAR(1) DEFAULT 'N',
        IMPCSOCIALVENDA CHAR(1) DEFAULT 'N',
        PERCMCOMISVENDA NUMERIC(7, 3) DEFAULT 0,
        CODEMPCM INTEGER,
        CODFILIALCM INTEGER,
        CODCLCOMIS INTEGER,
        CODEMPCB INTEGER,
        CODFILIALCB SMALLINT,
        CODCARTCOB CHAR(3),
        PEDCLIVENDA CHAR(10),
        VLRICMSSTVENDA NUMERICDN,
        VLRBASEICMSSTVENDA NUMERICDN,
        EMMANUT CHAR(1) DEFAULT 'N',
        BLOQVENDA CHAR(1) DEFAULT 'N' NOT NULL,
        VLRICMSSIMPLES NUMERICDN,
        PERCICMSSIMPLES NUMERIC(5, 2),
        VLRBASEPISVENDA NUMERICDN,
        VLRBASECOFINSVENDA NUMERICDN,
        VLRBASECOMIS NUMERICDN,
        CHAVENFEVENDA CHAR(44),
        CODEMPCA INTEGER,
        CODFILIALCA SMALLINT,
        NUMCONTA CHAR(10),
        OBSREC VARCHAR(250),
        INFCOMPL VARCHAR(10000),
        SITDOC CHAR(2),
        OBSNFE VARCHAR(10000),
        DESCIPIVENDA CHAR(1),
        CODEMPOP INTEGER,
        CODFILIALOP SMALLINT,
        SEQOP SMALLINT,
        CODOP INTEGER,
        LOCALSERV CHAR(1) DEFAULT 'P' NOT NULL,
        NROATUALIZADO CHAR(1) DEFAULT 'N' NOT NULL,
        CNF BIGINT DEFAULT 0,
        SITCOMPLVENDA CHAR(1) DEFAULT 'N' NOT NULL,
        MOTIVOCANCVENDA VARCHAR(255),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDVENDAPK PRIMARY KEY (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP));

/* Table: VDVENDACOMIS, Owner: SYSDBA */
CREATE TABLE VDVENDACOMIS (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        TIPOVENDA CHAR(1) DEFAULT 'V' NOT NULL,
        CODVENDA INTEGER NOT NULL,
        SEQVC SMALLINT NOT NULL,
        CODEMPRC INTEGER NOT NULL,
        CODFILIALRC SMALLINT NOT NULL,
        CODREGRCOMIS INTEGER NOT NULL,
        SEQITRC INTEGER NOT NULL,
        CODEMPVD INTEGER,
        CODFILIALVD SMALLINT,
        CODVEND INTEGER,
        PERCVC NUMERIC(6, 3) DEFAULT 0 NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDVENDACOMISPK PRIMARY KEY (CODVENDA, TIPOVENDA, SEQVC, CODFILIAL, CODEMP));

/* Table: VDVENDACONSIG, Owner: SYSDBA */
CREATE TABLE VDVENDACONSIG (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODCONSIG INTEGER NOT NULL,
        CODVENDACO SMALLINT NOT NULL,
        CODEMPCL INTEGER NOT NULL,
        CODFILIALCL SMALLINT NOT NULL,
        CODCLI INTEGER NOT NULL,
        CODEMPPD INTEGER NOT NULL,
        CODFILIALPD SMALLINT NOT NULL,
        CODPROD INTEGER NOT NULL,
        PRECO NUMERICDN NOT NULL,
        PRECOVENDA NUMERICDN,
        QTDVENDACO NUMERICDN              DEFAULT 0.0 NOT NULL,
        QTDTROCA NUMERICDN              DEFAULT 0.0 NOT NULL,
        QTDBONIF NUMERICDN              DEFAULT 0.0 NOT NULL,
        DESCONTO NUMERICDN,
        RECEBIDO CHAR(1) DEFAULT 'N' NOT NULL,
        CODEMPPG INTEGER NOT NULL,
        CODFILIALPG SMALLINT NOT NULL,
        CODPLANOPAG INTEGER NOT NULL,
        CODEMPVD INTEGER,
        CODFILIALVD SMALLINT,
        TIPOVENDA CHAR(1),
        CODVENDA INTEGER,
        CODITVENDA INTEGER,
        CODEMPSL INTEGER,
        CODFILIALSL SMALLINT,
        CODLANCA INTEGER,
        CODSUBLANCA INTEGER,
        CODEMPSC INTEGER,
        CODFILIALSC SMALLINT,
        CODLANCASC INTEGER,
        CODSUBLANCASC INTEGER,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDVENDACONSIGPK PRIMARY KEY (CODCONSIG, CODVENDACO, CODFILIAL, CODEMP));

/* Table: VDVENDAENTREGA, Owner: SYSDBA */
CREATE TABLE VDVENDAENTREGA (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        TIPOVENDA CHAR(1) DEFAULT 'V' NOT NULL,
        CODVENDA INTEGER NOT NULL,
        DTENTREGA DATE DEFAULT 'now' NOT NULL,
        OBSENTREGA VARCHAR(1000),
        RECEBEDOR VARCHAR(200),
        ENTREGADOR VARCHAR(200),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDVENDAENTREGAPK PRIMARY KEY (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP));

/* Table: VDVENDAORC, Owner: SYSDBA */
CREATE TABLE VDVENDAORC (CODEMP INTEGER NOT NULL,
        CODFILIAL INTEGER NOT NULL,
        TIPOVENDA CHAR(1) NOT NULL,
        CODVENDA INTEGER NOT NULL,
        CODITVENDA INTEGER NOT NULL,
        CODEMPOR INTEGER NOT NULL,
        CODFILIALOR INTEGER NOT NULL,
        TIPOORC CHAR(1) NOT NULL,
        CODORC INTEGER NOT NULL,
        CODITORC INTEGER NOT NULL,
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
CONSTRAINT VDVENDAORCPK PRIMARY KEY (CODVENDA, CODITVENDA, TIPOVENDA, CODFILIAL, CODEMP, CODORC, CODITORC, TIPOORC, CODFILIALOR, CODEMPOR));

/* Table: VDVENDEDOR, Owner: SYSDBA */
CREATE TABLE VDVENDEDOR (CODEMP INTEGER NOT NULL,
        CODFILIAL SMALLINT NOT NULL,
        CODVEND INTEGER NOT NULL,
        NOMEVEND CHAR(40),
        ENDVEND CHAR(50),
        NUMVEND INTEGER,
        COMPLVEND CHAR(20),
        BAIRVEND CHAR(30),
        CIDVEND CHAR(30),
        CEPVEND CHAR(8),
        UFVEND CHAR(2),
        FONEVEND CHAR(12),
        FAXVEND CHAR(8),
        EMAILVEND CHAR(50),
        PERCCOMVEND NUMERIC(7, 3),
        COMIPIVEND CHAR(1),
        CODEMPPN INTEGER,
        CODFILIALPN SMALLINT,
        CODPLAN CHAR(13),
        CPFVEND CHAR(11),
        RGVEND CHAR(13),
        CNPJVEND CHAR(14),
        INSCVEND VARCHAR(20),
        CELVEND VARCHAR(12),
        CODEMPSE INTEGER,
        CODFILIALSE INTEGER,
        CODSETOR INTEGER,
        CODEMPCM INTEGER,
        CODFILIALCM INTEGER,
        CODCLCOMIS INTEGER,
        CODFORNVEND CHAR(13),
        CODFUNC INTEGER,
        CODEMPFU INTEGER,
        CODFILIALFU SMALLINT,
        CODEMPTV INTEGER,
        CODFILIALTV SMALLINT,
        CODTIPOVEND INTEGER,
        DDDFONEVEND CHAR(4),
        DDDFAXVEND CHAR(4),
        DDDCELVEND CHAR(4),
        SSPVEND CHAR(10),
        OBSVEND VARCHAR(500),
        ATIVOCOMIS CHAR(1) DEFAULT 'S' NOT NULL,
        IMGASSVEND BLOB SUB_TYPE 0 SEGMENT SIZE 80,
        CODEMPCA INTEGER,
        CODFILIALCA SMALLINT,
        NUMCONTA CHAR(10),
        CODEMPSC INTEGER,
        CODFILIALSC SMALLINT,
        CODSECAO VARCHAR(13),
        DTINS DATE DEFAULT 'now' NOT NULL,
        HINS TIME DEFAULT 'now' NOT NULL,
        IDUSUINS CHAR(8) DEFAULT USER NOT NULL,
        DTALT DATE DEFAULT 'now',
        HALT TIME DEFAULT 'now',
        IDUSUALT CHAR(8) DEFAULT USER,
        VLRABONO NUMERICDN,
        VLRDESCONTO NUMERICDN,
CONSTRAINT VDVENDEDORPK PRIMARY KEY (CODVEND, CODFILIAL, CODEMP));

/*  Index definitions for all user tables */
CREATE INDEX ATATENDIMENTOIDX01 ON ATATENDIMENTO (DATAATENDO, HORAATENDO, HORAATENDOFIN, CODATEND);
CREATE INDEX ATCONVENIADOIDX01 ON ATCONVENIADO (ICARDCONV, NRVIACONV);
CREATE INDEX CPFORNECEDIDX01 ON CPFORNECED (RAZFOR);
CREATE INDEX CPPRODFORIDX01 ON CPPRODFOR (REFPRODFOR, CODFILIAL, CODEMP);
CREATE INDEX CPTIPOFORICX01 ON CPTIPOFOR (DESCTIPOFOR);
CREATE INDEX CRCHAMADOIDXEQRECMERC ON CRCHAMADO (CODEMPOS, CODFILIALOS, TICKET);
CREATE INDEX EQETIQPRODIDX01 ON EQETIQPROD (NRCONEXAO, CODPROD);
CREATE UNIQUE INDEX EQEXPEDAMOSTRAGEMIDX01 ON EQEXPEDAMOSTRAGEM (SEQAMOSTRAGEM);
CREATE INDEX EQMOVPRODIDX01 ON EQMOVPROD (CODLOTE, CODPROD);
CREATE INDEX EQMOVPRODIDX02 ON EQMOVPROD (CODPROD, DTMOVPROD);
CREATE INDEX EQPRODUTOIDX02 ON EQPRODUTO (DESCPROD);
CREATE UNIQUE INDEX EQPRODUTOIDXREFPROD ON EQPRODUTO (REFPROD, CODEMP, CODFILIAL);
CREATE UNIQUE INDEX EQRECAMOSTRAGEMIDX01 ON EQRECAMOSTRAGEM (SEQAMOSTRAGEM);
CREATE INDEX EQRECMERCIDXDTENT ON EQRECMERC (DTENT);
CREATE INDEX EQUNIDADEIDX01 ON EQUNIDADE (DESCUNID);
CREATE INDEX FNBANCOIDX01 ON FNBANCO (NOMEBANCO);
CREATE INDEX FNCCIDX01 ON FNCC (DESCCC);
CREATE INDEX FNCCIDX02 ON FNCC (CODREDCC, CODEMP, CODFILIAL);
CREATE INDEX FNLANCADATA ON FNLANCA (DATALANCA, CODREC);
CREATE INDEX FNLANCAIDX01 ON FNLANCA (DATALANCA, CODFILIAL, CODEMP);
CREATE INDEX FNPLANEJAMENTOIDX01 ON FNPLANEJAMENTO (DESCPLAN);
CREATE INDEX FNPLANEJAMENTOIDXCODRED ON FNPLANEJAMENTO (CODREDPLAN, CODFILIAL, CODEMP);
CREATE INDEX FNPLANOPAGIDX01 ON FNPLANOPAG (DESCPLANOPAG);
CREATE INDEX FNRECEBERDATAREC ON FNRECEBER (DATAREC);
CREATE INDEX FNSUBLANCAIDX01 ON FNSUBLANCA (DATASUBLANCA, CODSUBLANCA, CODLANCA, CODFILIAL, CODEMP);
CREATE INDEX FNSUBLANCAIDXDTCOMP ON FNSUBLANCA (DTCOMPSUBLANCA);
CREATE INDEX FNSUBLANCAIDXDTSUBLANCA ON FNSUBLANCA (CODPLAN, DATASUBLANCA, CODLANCA, CODFILIAL, CODEMP);
CREATE INDEX FNTIPOCOBIDX01 ON FNTIPOCOB (DESCTIPOCOB);
CREATE INDEX LFLIVROFISCALIDXEMIT ON LFLIVROFISCAL (CODEMITLF, CODFILIALET, CODEMPET);
CREATE INDEX LFNBMIDX001 ON LFNBM (DESCNBM);
CREATE INDEX LFNCMIDX001 ON LFNCM (DESCNCM);
CREATE INDEX PPOPDTEMITOP ON PPOP (DTEMITOP);
CREATE INDEX PPOPDTFABROP ON PPOP (DTFABROP);
CREATE INDEX PPOPENTRADAIDX ON PPOPENTRADA (DTENT);
CREATE INDEX RHEMPREGADORIDX01 ON RHEMPREGADOR (NOMEEMPR);
CREATE INDEX SGCNAEIDX01 ON SGCNAE (DESCCNAE);
CREATE UNIQUE INDEX SGDEBUG_IDX1 ON SGDEBUG (SEQ);
CREATE INDEX SGLOGIDX01 ON SGLOG (DATALOG);
CREATE INDEX SGLOGIDX02 ON SGLOG (TIPOLOG);
CREATE INDEX SGMUNICIPIOIDXNOME ON SGMUNICIPIO (NOMEMUNIC);
CREATE INDEX SGUFIDX01 ON SGUF (NOMEUF);
CREATE INDEX SGUFIDX02 ON SGUF (NOMECURTO);
CREATE UNIQUE INDEX TKCONFEMAILIDX1 ON TKCONFEMAIL (EMAILREMET, CODEMP, CODFILIAL);
CREATE INDEX TKTIPOCONTICX01 ON TKTIPOCONT (DESCTIPOCONT);
CREATE INDEX VDCLIENTEIDX01 ON VDCLIENTE (NOMECLI);
CREATE INDEX VDCLIENTEIDX02 ON VDCLIENTE (RAZCLI);
CREATE INDEX VDCLIENTEIDX03 ON VDCLIENTE (CODPESQ, CODEMPPQ, CODFILIALPQ);
CREATE INDEX VDCOMISSAOIDX01 ON VDCOMISSAO (CODREC, NPARCITREC);
CREATE INDEX VDETIQCLIIDX01 ON VDETIQCLI (CODCLI, NRCONEXAO);
CREATE INDEX VDITORCAMENTOIDXSTITORC ON VDITORCAMENTO (STATUSITORC);
CREATE INDEX VDITORCAMENTOVENCAUT ON VDITORCAMENTO (VENCAUTORIZORC);
CREATE INDEX VDITVENDAIDX01 ON VDITVENDA (CODVENDAVR, CODITVENDAVR, TIPOVENDAVR, CODFILIAL, CODEMP);
CREATE INDEX VDORCAMENTOIDXSTORC ON VDORCAMENTO (STATUSORC);
CREATE INDEX VDSETORIDX01 ON VDSETOR (DESCSETOR);
CREATE INDEX VDTIPOCLIIDX01 ON VDTIPOCLI (DESCTIPOCLI);
CREATE INDEX VDTRANSPIDX01 ON VDTRANSP (RAZTRAN);
CREATE INDEX VDVENDAIDX01 ON VDVENDA (DTEMITVENDA);
CREATE INDEX VDVENDAIDX02 ON VDVENDA (DTSAIDAVENDA);
CREATE INDEX VDVENDEDORIDX01 ON VDVENDEDOR (NOMEVEND);

ALTER TABLE ATATENDENTE ADD CONSTRAINT ATATENDENTEFKRHEMPR FOREIGN KEY (MATEMPR, CODFILIALEP, CODEMPEP) REFERENCES RHEMPREGADO (MATEMPR, CODFILIAL, CODEMP);

ALTER TABLE ATATENDENTE ADD CONSTRAINT ATATENDENTEFKSGFIL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE ATATENDENTE ADD CONSTRAINT ATATENDENTEFKSGUSU FOREIGN KEY (IDUSU, CODFILIALUS, CODEMPUS) REFERENCES SGUSUARIO (IDUSU, CODFILIAL, CODEMP);

ALTER TABLE ATATENDENTE ADD CONSTRAINT ATATENDENTEFKVDVEN FOREIGN KEY (CODVEND, CODFILIALVE, CODEMPVE) REFERENCES VDVENDEDOR (CODVEND, CODFILIAL, CODEMP);

ALTER TABLE ATATENDIMENTO ADD CONSTRAINT ATATENDIMENTOCRTAR FOREIGN KEY (CODTAREFA, CODFILIALTA, CODEMPTA) REFERENCES CRTAREFA (CODTAREFA, CODFILIAL, CODEMP);

ALTER TABLE ATATENDIMENTO ADD CONSTRAINT ATATENDIMENTOFKATA FOREIGN KEY (CODATEND, CODFILIALAE, CODEMPAE) REFERENCES ATATENDENTE (CODATEND, CODFILIAL, CODEMP);

ALTER TABLE ATATENDIMENTO ADD CONSTRAINT ATATENDIMENTOFKATC FOREIGN KEY (CODCONV, CODFILIALCV, CODEMPCV) REFERENCES ATCONVENIADO (CODCONV, CODFILIAL, CODEMP);

ALTER TABLE ATATENDIMENTO ADD CONSTRAINT ATATENDIMENTOFKATE FOREIGN KEY (CODESPEC, CODFILIALEA, CODEMPEA) REFERENCES ATESPECATEND (CODESPEC, CODFILIAL, CODEMP);

ALTER TABLE ATATENDIMENTO ADD CONSTRAINT ATATENDIMENTOFKATT FOREIGN KEY (CODTPATENDO, CODFILIALTO, CODEMPTO) REFERENCES ATTIPOATENDO (CODTPATENDO, CODFILIAL, CODEMP);

ALTER TABLE ATATENDIMENTO ADD CONSTRAINT ATATENDIMENTOFKCHAMADO FOREIGN KEY (CODCHAMADO, CODFILIALCH, CODEMPCH) REFERENCES CRCHAMADO (CODCHAMADO, CODFILIAL, CODEMP);

ALTER TABLE ATATENDIMENTO ADD CONSTRAINT ATATENDIMENTOFKCLAT FOREIGN KEY (CODCLASATENDO, CODFILIALCA, CODEMPCA) REFERENCES ATCLASATENDO (CODCLASATENDO, CODFILIAL, CODEMP);

ALTER TABLE ATATENDIMENTO ADD CONSTRAINT ATATENDIMENTOFKCTR FOREIGN KEY (CODCONTR, CODITCONTR, CODFILIALCT, CODEMPCT) REFERENCES VDITCONTRATO (CODCONTR, CODITCONTR, CODFILIAL, CODEMP);

ALTER TABLE ATATENDIMENTO ADD CONSTRAINT ATATENDIMENTOFKSET FOREIGN KEY (CODSETAT, CODFILIALSA, CODEMPSA) REFERENCES ATSETOR (CODSETAT, CODFILIAL, CODEMP);

ALTER TABLE ATATENDIMENTO ADD CONSTRAINT ATATENDIMENTOFKSGF FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE ATATENDIMENTO ADD CONSTRAINT ATATENDIMENTOFKSGU FOREIGN KEY (IDUSU, CODFILIALUS, CODEMPUS) REFERENCES SGUSUARIO (IDUSU, CODFILIAL, CODEMP);

ALTER TABLE ATATENDIMENTO ADD CONSTRAINT ATATENDIMENTOFKVDCLI FOREIGN KEY (CODCLI, CODFILIALCL, CODEMPCL) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE ATATENDIMENTOITREC ADD CONSTRAINT ATATENDIRECFKVITREC FOREIGN KEY (CODREC, NPARCITREC, CODFILIALIR, CODEMPIR) REFERENCES FNITRECEBER (CODREC, NPARCITREC, CODFILIAL, CODEMP) ON DELETE CASCADE;

ALTER TABLE ATATENDIMENTOITREC ADD CONSTRAINT ATATENDITRECFKATE FOREIGN KEY (CODATENDO, CODFILIAL, CODEMP) REFERENCES ATATENDIMENTO (CODATENDO, CODFILIAL, CODEMP) ON DELETE CASCADE;

ALTER TABLE ATATENDIMENTOORC ADD CONSTRAINT ATATENDIMENORFKATA FOREIGN KEY (CODATENDO, CODFILIAL, CODEMP) REFERENCES ATATENDIMENTO (CODATENDO, CODFILIAL, CODEMP);

ALTER TABLE ATATENDIMENTOORC ADD CONSTRAINT ATATENDIMENORFKVDO FOREIGN KEY (CODORC, TIPOORC, CODFILIALOC, CODEMPOC) REFERENCES VDORCAMENTO (CODORC, TIPOORC, CODFILIAL, CODEMP);

ALTER TABLE ATATENDOAGENDA ADD CONSTRAINT ATATENDOAGENDAFKAG FOREIGN KEY (CODATENDO, CODFILIAL, CODEMP) REFERENCES ATATENDIMENTO (CODATENDO, CODFILIAL, CODEMP);

ALTER TABLE ATATENDOAGENDA ADD CONSTRAINT ATATENDOAGENDAFKAT FOREIGN KEY (CODAGE, TIPOAGE, CODAGD, CODFILIALAG, CODEMPAG) REFERENCES SGAGENDA (CODAGE, TIPOAGE, CODAGD, CODFILIAL, CODEMP);

ALTER TABLE ATATRIBUICAO ADD CONSTRAINT ATATRIBUICAOFKSGFI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE ATCLASATENDO ADD CONSTRAINT ATCLASATENDFKSGFIL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE ATCONVATRIB ADD CONSTRAINT ATCONVATRIBFKATATR FOREIGN KEY (CODATRIB, CODFILIALAB, CODEMPAB) REFERENCES ATATRIBUICAO (CODATRIB, CODFILIAL, CODEMP);

ALTER TABLE ATCONVATRIB ADD CONSTRAINT ATCONVATRIBFKATCON FOREIGN KEY (CODCONV, CODFILIAL, CODEMP) REFERENCES ATCONVENIADO (CODCONV, CODFILIAL, CODEMP);

ALTER TABLE ATCONVATRIBTB ADD CONSTRAINT ATCONVATRIBTBFKATC FOREIGN KEY (CODCONV, SEQCONVATRIB, CODFILIAL, CODEMP) REFERENCES ATCONVATRIB (CODCONV, SEQCONVATRIB, CODFILIAL, CODEMP);

ALTER TABLE ATCONVATRIBTB ADD CONSTRAINT ATCONVATRIBTBFKSGI FOREIGN KEY (CODITTB, CODTB, CODFILIALTB, CODEMPTB) REFERENCES SGITTABELA (CODITTB, CODTB, CODFILIAL, CODEMP);

ALTER TABLE ATCONVENIADO ADD CONSTRAINT ATCONVENIADOFKATEN FOREIGN KEY (CODENC, CODFILIALEC, CODEMPEC) REFERENCES ATENCAMINHADOR (CODENC, CODFILIAL, CODEMP);

ALTER TABLE ATCONVENIADO ADD CONSTRAINT ATCONVENIADOFKATTI FOREIGN KEY (CODTPCONV, CODFILIALTC, CODEMPTC) REFERENCES ATTIPOCONV (CODTPCONV, CODFILIAL, CODEMP);

ALTER TABLE ATCONVENIADO ADD CONSTRAINT ATCONVENIADOFKRHFU FOREIGN KEY (CODFUNC, CODFILIALFC, CODEMPFC) REFERENCES RHFUNCAO (CODFUNC, CODFILIAL, CODEMP);

ALTER TABLE ATCONVENIADO ADD CONSTRAINT ATCONVENIADOFKSGFI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE ATCONVENIADO ADD CONSTRAINT ATCONVENIADOFKSGGR FOREIGN KEY (CODGRI, CODFILIALGI, CODEMPGI) REFERENCES SGGRAUINST (CODGRI, CODFILIAL, CODEMP);

ALTER TABLE ATENCAMINHADOR ADD CONSTRAINT ATENCAMINHADORFKSG FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE ATMODATENDO ADD CONSTRAINT ATMODATENDOFKATC FOREIGN KEY (CODCONV, CODFILIALCV, CODEMPCV) REFERENCES ATCONVENIADO (CODCONV, CODFILIAL, CODEMP);

ALTER TABLE ATMODATENDO ADD CONSTRAINT ATMODATENDOFKATE FOREIGN KEY (CODESPEC, CODFILIALEA, CODEMPEA) REFERENCES ATESPECATEND (CODESPEC, CODFILIAL, CODEMP);

ALTER TABLE ATMODATENDO ADD CONSTRAINT ATMODATENDOFKATT FOREIGN KEY (CODTPATENDO, CODFILIALTO, CODEMPTO) REFERENCES ATTIPOATENDO (CODTPATENDO, CODFILIAL, CODEMP);

ALTER TABLE ATMODATENDO ADD CONSTRAINT ATMODATENDOFKCHAMADO FOREIGN KEY (CODCHAMADO, CODFILIALCH, CODEMPCH) REFERENCES CRCHAMADO (CODCHAMADO, CODFILIAL, CODEMP);

ALTER TABLE ATMODATENDO ADD CONSTRAINT ATMODATENDOFKCLAT FOREIGN KEY (CODCLASATENDO, CODFILIALCA, CODEMPCA) REFERENCES ATCLASATENDO (CODCLASATENDO, CODFILIAL, CODEMP);

ALTER TABLE ATMODATENDO ADD CONSTRAINT ATMODATENDOFKCTR FOREIGN KEY (CODCONTR, CODITCONTR, CODFILIALCT, CODEMPCT) REFERENCES VDITCONTRATO (CODCONTR, CODITCONTR, CODFILIAL, CODEMP);

ALTER TABLE ATMODATENDO ADD CONSTRAINT ATMODATENDOFKSET FOREIGN KEY (CODSETAT, CODFILIALSA, CODEMPSA) REFERENCES ATSETOR (CODSETAT, CODFILIAL, CODEMP);

ALTER TABLE ATMODATENDO ADD CONSTRAINT ATMODATENDOFKSGF FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE ATMODATENDO ADD CONSTRAINT ATMODATENDOFKVDCLI FOREIGN KEY (CODCLI, CODFILIALCL, CODEMPCL) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE ATSETOR ADD CONSTRAINT ATSETORFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE ATSETORATENDENTE ADD CONSTRAINT ATSETORATENDFKATAT FOREIGN KEY (CODATEND, CODFILIALAE, CODEMPAE) REFERENCES ATATENDENTE (CODATEND, CODFILIAL, CODEMP);

ALTER TABLE ATSETORATENDENTE ADD CONSTRAINT ATSETORATENDFKATSE FOREIGN KEY (CODSETAT, CODFILIAL, CODEMP) REFERENCES ATSETOR (CODSETAT, CODFILIAL, CODEMP);

ALTER TABLE ATTIPOATEND ADD CONSTRAINT ATTIPOATENDFKSGFIL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE ATTIPOATENDO ADD CONSTRAINT ATTIPOATENDOFKSGFI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE ATTIPOATENDO ADD CONSTRAINT ATTIPOATENDOFLUXO FOREIGN KEY (CODFLUXO, CODFILIALFX, CODEMPFX) REFERENCES SGFLUXO (CODFLUXO, CODFILIAL, CODEMP);

ALTER TABLE ATTIPOATENDOSETOR ADD CONSTRAINT ATTIPOATDOSETFKATS FOREIGN KEY (CODSETAT, CODFILIALST, CODEMPST) REFERENCES ATSETOR (CODSETAT, CODFILIAL, CODEMP);

ALTER TABLE ATTIPOATENDOSETOR ADD CONSTRAINT ATTIPOATDOSETFKATT FOREIGN KEY (CODTPATENDO, CODFILIAL, CODEMP) REFERENCES ATTIPOATENDO (CODTPATENDO, CODFILIAL, CODEMP);

ALTER TABLE ATTIPOCONV ADD CONSTRAINT ATTIPOCONVFKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE CPCOMPRA ADD CONSTRAINT CPCOMPRAFKCPFORNEC FOREIGN KEY (CODFOR, CODFILIALFR, CODEMPFR) REFERENCES CPFORNECED (CODFOR, CODFILIAL, CODEMP);

ALTER TABLE CPCOMPRA ADD CONSTRAINT CPCOMPRAFKCPIMPORTACAO FOREIGN KEY (CODIMP, CODFILIALIM, CODEMPIM) REFERENCES CPIMPORTACAO (CODIMP, CODFILIAL, CODEMP);

ALTER TABLE CPCOMPRA ADD CONSTRAINT CPCOMPRAFKCPSOLICI FOREIGN KEY (CODSOL, CODFILIALSOL, CODEMPSOL) REFERENCES CPSOLICITACAO (CODSOL, CODFILIAL, CODEMP);

ALTER TABLE CPCOMPRA ADD CONSTRAINT CPCOMPRAFKEQRECMERC FOREIGN KEY (TICKET, CODFILIALRM, CODEMPRM) REFERENCES EQRECMERC (TICKET, CODFILIAL, CODEMP);

ALTER TABLE CPCOMPRA ADD CONSTRAINT CPCOMPRAFKEQTIPOMO FOREIGN KEY (CODTIPOMOV, CODFILIALTM, CODEMPTM) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE CPCOMPRA ADD CONSTRAINT CPCOMPRAFKFNBANCO FOREIGN KEY (CODBANCO, CODFILIALBO, CODEMPBO) REFERENCES FNBANCO (CODBANCO, CODFILIAL, CODEMP);

ALTER TABLE CPCOMPRA ADD CONSTRAINT CPCOMPRAFKFNCC FOREIGN KEY (CODCC, ANOCC, CODFILIALCC, CODEMPCC) REFERENCES FNCC (CODCC, ANOCC, CODFILIAL, CODEMP);

ALTER TABLE CPCOMPRA ADD CONSTRAINT CPCOMPRAFKFNCONTA FOREIGN KEY (NUMCONTA, CODFILIALCT, CODEMPCT) REFERENCES FNCONTA (NUMCONTA, CODFILIAL, CODEMP);

ALTER TABLE CPCOMPRA ADD CONSTRAINT CPCOMPRAFKFNPLANEJAMENTO FOREIGN KEY (CODPLAN, CODFILIALPN, CODEMPPN) REFERENCES FNPLANEJAMENTO (CODPLAN, CODFILIAL, CODEMP);

ALTER TABLE CPCOMPRA ADD CONSTRAINT CPCOMPRAFKFNPLANOP FOREIGN KEY (CODPLANOPAG, CODFILIALPG, CODEMPPG) REFERENCES FNPLANOPAG (CODPLANOPAG, CODFILIAL, CODEMP);

ALTER TABLE CPCOMPRA ADD CONSTRAINT CPCOMPRAFKFNTIPOCOB FOREIGN KEY (CODTIPOCOB, CODFILIALTC, CODEMPTC) REFERENCES FNTIPOCOB (CODTIPOCOB, CODFILIAL, CODEMP);

ALTER TABLE CPCOMPRA ADD CONSTRAINT CPCOMPRAFKORDCOMPRA FOREIGN KEY (CODEMPOC, CODFILIALOC, CODORDCP) REFERENCES CPORDCOMPRA (CODEMP, CODFILIAL, CODORDCP);

ALTER TABLE CPCOMPRA ADD CONSTRAINT CPCOMPRAFKPPOP FOREIGN KEY (CODOP, SEQOP, CODFILIALOP, CODEMPOP) REFERENCES PPOP (CODOP, SEQOP, CODFILIAL, CODEMP) ON DELETE SET NULL;

ALTER TABLE CPCOMPRA ADD CONSTRAINT CPCOMPRAFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE CPCOMPRA ADD CONSTRAINT CPCOMPRAFKVDTRANS FOREIGN KEY (CODTRAN, CODFILIALTN, CODEMPTN) REFERENCES VDTRANSP (CODTRAN, CODFILIAL, CODEMP);

ALTER TABLE CPCOMPRAPED ADD CONSTRAINT CPCOMPRAPEDFKCPCOMPRA FOREIGN KEY (CODCOMPRA, CODITCOMPRA, CODFILIAL, CODEMP) REFERENCES CPITCOMPRA (CODCOMPRA, CODITCOMPRA, CODFILIAL, CODEMP) ON UPDATE CASCADE;

ALTER TABLE CPCOMPRAPED ADD CONSTRAINT CPCOMPRAPEDFKCPCOMPRAPED FOREIGN KEY (CODCOMPRAPC, CODITCOMPRAPC, CODFILIALPC, CODEMPPC) REFERENCES CPITCOMPRA (CODCOMPRA, CODITCOMPRA, CODFILIAL, CODEMP) ON UPDATE CASCADE;

ALTER TABLE CPCOMPRASOL ADD CONSTRAINT CPCOMPRASOLFKCPITSO FOREIGN KEY (CODSOL, CODITSOL, CODFILIALSL, CODEMPSL) REFERENCES CPITSOLICITACAO (CODSOL, CODITSOL, CODFILIAL, CODEMP);

ALTER TABLE CPCOMPRAVENDA ADD CONSTRAINT CPCOMPRAVENDAFKCPI FOREIGN KEY (CODCOMPRA, CODITCOMPRA, CODFILIAL, CODEMP) REFERENCES CPITCOMPRA (CODCOMPRA, CODITCOMPRA, CODFILIAL, CODEMP) ON UPDATE CASCADE;

ALTER TABLE CPCOMPRAVENDA ADD CONSTRAINT CPCOMPRAVENDAFKVDI FOREIGN KEY (CODVENDA, CODITVENDA, TIPOVENDA, CODFILIALVD, CODEMPVD) REFERENCES VDITVENDA (CODVENDA, CODITVENDA, TIPOVENDA, CODFILIAL, CODEMP) ON UPDATE CASCADE;

ALTER TABLE CPCOTACAO ADD CONSTRAINT CPCOTACAOFKFNPLANOPAG FOREIGN KEY (CODPLANOPAG, CODFILIALPP, CODEMPPP) REFERENCES FNPLANOPAG (CODPLANOPAG, CODFILIAL, CODEMP);

ALTER TABLE CPDEVOLUCAO ADD CONSTRAINT CPDEVOLUCAOFKITCOMPRA FOREIGN KEY (CODCOMPRA, CODITCOMPRA, CODFILIALVD, CODEMPVD) REFERENCES CPITCOMPRA (CODCOMPRA, CODITCOMPRA, CODFILIAL, CODEMP) ON UPDATE CASCADE ON DELETE CASCADE;

ALTER TABLE CPDEVOLUCAO ADD CONSTRAINT CPDEVOLUCAOFKITVENDA FOREIGN KEY (CODVENDA, CODITVENDA, TIPOVENDA, CODFILIAL, CODEMP) REFERENCES VDITVENDA (CODVENDA, CODITVENDA, TIPOVENDA, CODFILIAL, CODEMP) ON UPDATE CASCADE ON DELETE CASCADE;

ALTER TABLE CPEQUIVCFOP ADD CONSTRAINT CPEQUIVCFOPFKLFNAN FOREIGN KEY (CODNATND, CODFILIALND, CODEMPND) REFERENCES LFNATOPER (CODNAT, CODFILIAL, CODEMP);

ALTER TABLE CPEQUIVCFOP ADD CONSTRAINT CPEQUIVCFOPFKLFNAT FOREIGN KEY (CODNAT, CODFILIAL, CODEMP) REFERENCES LFNATOPER (CODNAT, CODFILIAL, CODEMP);

ALTER TABLE CPFORNECED ADD CONSTRAINT CPFORNECEDFKCPTIPO FOREIGN KEY (CODTIPOFOR, CODFILIALTF, CODEMPTF) REFERENCES CPTIPOFOR (CODTIPOFOR, CODFILIAL, CODEMP);

ALTER TABLE CPFORNECED ADD CONSTRAINT CPFORNECEDFKFNBANC FOREIGN KEY (CODBANCO, CODFILIALBO, CODEMPBO) REFERENCES FNBANCO (CODBANCO, CODFILIAL, CODEMP);

ALTER TABLE CPFORNECED ADD CONSTRAINT CPFORNECEDFKFNHIST FOREIGN KEY (CODHIST, CODFILIALHP, CODEMPHP) REFERENCES FNHISTPAD (CODHIST, CODFILIAL, CODEMP);

ALTER TABLE CPFORNECED ADD CONSTRAINT CPFORNECEDFKLFTIPOFISC FOREIGN KEY (CODFISCFOR, CODFILIALFF, CODEMPFF) REFERENCES LFTIPOFISCCLI (CODFISCCLI, CODFILIAL, CODEMP);

ALTER TABLE CPFORNECED ADD CONSTRAINT CPFORNECEDFKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE CPFORNECED ADD CONSTRAINT CPFORNECEDFKSGMUNIC FOREIGN KEY (CODMUNIC, SIGLAUF, CODPAIS) REFERENCES SGMUNICIPIO (CODMUNIC, SIGLAUF, CODPAIS);

ALTER TABLE CPFORNECED ADD CONSTRAINT CPFORNECEDFKSGUNIFCOD FOREIGN KEY (CODUNIFCOD, CODFILIALUC, CODEMPUC) REFERENCES SGUNIFCOD (CODUNIFCOD, CODFILIAL, CODEMP);

ALTER TABLE CPFRETECP ADD CONSTRAINT CPFRETECPFKCPCOMPRA FOREIGN KEY (CODCOMPRA, CODFILIAL, CODEMP) REFERENCES CPCOMPRA (CODCOMPRA, CODFILIAL, CODEMP);

ALTER TABLE CPFRETECP ADD CONSTRAINT CPFRETECPFKVDTRANS FOREIGN KEY (CODTRAN, CODFILIALTN, CODEMPTN) REFERENCES VDTRANSP (CODTRAN, CODFILIAL, CODEMP);

ALTER TABLE CPHOMOLOGFOR ADD CONSTRAINT CPHOMOLOGFORFKFOR FOREIGN KEY (CODFOR, CODFILIAL, CODEMP) REFERENCES CPFORNECED (CODFOR, CODFILIAL, CODEMP);

ALTER TABLE CPIMPORTACAO ADD CONSTRAINT CPIMPORTACAOFKCPIMP FOREIGN KEY (CODIMPOI, CODFILIALOI, CODEMPOI) REFERENCES CPIMPORTACAO (CODIMP, CODFILIAL, CODEMP);

ALTER TABLE CPIMPORTACAO ADD CONSTRAINT CPIMPORTACAOFKFNPLANOPAG FOREIGN KEY (CODPLANOPAG, CODFILIALPG, CODEMPPG) REFERENCES FNPLANOPAG (CODPLANOPAG, CODFILIAL, CODEMP);

ALTER TABLE CPIMPORTACAO ADD CONSTRAINT CPIMPORTACAOFKFORNECED FOREIGN KEY (CODFOR, CODFILIALFR, CODEMPFR) REFERENCES CPFORNECED (CODFOR, CODFILIAL, CODEMP);

ALTER TABLE CPIMPORTACAO ADD CONSTRAINT CPIMPORTACAOFKMOEDA FOREIGN KEY (CODMOEDA, CODFILIALMI, CODEMPMI) REFERENCES FNMOEDA (CODMOEDA, CODFILIAL, CODEMP);

ALTER TABLE CPIMPORTACAOADIC ADD CONSTRAINT CPIMPORTACAOADICFKCPIMP FOREIGN KEY (CODIMP, CODFILIAL, CODEMP) REFERENCES CPIMPORTACAO (CODIMP, CODFILIAL, CODEMP) ON DELETE CASCADE;

ALTER TABLE CPIMPORTACAOADIC ADD CONSTRAINT CPIMPORTACAOADICFKNCM FOREIGN KEY (CODNCM) REFERENCES LFNCM (CODNCM);

ALTER TABLE CPIMPORTACAOCOMPL ADD CONSTRAINT CPIMPCOMPLFKCPIMP FOREIGN KEY (CODIMP, CODFILIAL, CODEMP) REFERENCES CPIMPORTACAO (CODIMP, CODFILIAL, CODEMP);

ALTER TABLE CPITCOMPRA ADD CONSTRAINT CPITCOMPRAFKCPCOMP FOREIGN KEY (CODCOMPRA, CODFILIAL, CODEMP) REFERENCES CPCOMPRA (CODCOMPRA, CODFILIAL, CODEMP);

ALTER TABLE CPITCOMPRA ADD CONSTRAINT CPITCOMPRAFKEQALMO FOREIGN KEY (CODALMOX, CODFILIALAX, CODEMPAX) REFERENCES EQALMOX (CODALMOX, CODFILIAL, CODEMP);

ALTER TABLE CPITCOMPRA ADD CONSTRAINT CPITCOMPRAFKEQLOTE FOREIGN KEY (CODLOTE, CODPROD, CODFILIALLE, CODEMPLE) REFERENCES EQLOTE (CODLOTE, CODPROD, CODFILIAL, CODEMP);

ALTER TABLE CPITCOMPRA ADD CONSTRAINT CPITCOMPRAFKEQPROD FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE CPITCOMPRA ADD CONSTRAINT CPITCOMPRAFKEQSERIETMP FOREIGN KEY (NUMSERIETMP, CODPROD, CODFILIALNS, CODEMPNS) REFERENCES EQSERIE (NUMSERIE, CODPROD, CODFILIAL, CODEMP);

ALTER TABLE CPITCOMPRA ADD CONSTRAINT CPITCOMPRAFKLFITCLFISCAL FOREIGN KEY (CODEMPIF, CODFILIALIF, CODFISC, CODITFISC) REFERENCES LFITCLFISCAL (CODEMP, CODFILIAL, CODFISC, CODITFISC) ON DELETE SET NULL;

ALTER TABLE CPITCOMPRA ADD CONSTRAINT CPITCOMPRAFKLFNATO FOREIGN KEY (CODNAT, CODFILIALNT, CODEMPNT) REFERENCES LFNATOPER (CODNAT, CODFILIAL, CODEMP);

ALTER TABLE CPITCOMPRAITCOMPRA ADD CONSTRAINT CPITCOMPITCFKITCP1 FOREIGN KEY (CODCOMPRA, CODITCOMPRA, CODFILIAL, CODEMP) REFERENCES CPITCOMPRA (CODCOMPRA, CODITCOMPRA, CODFILIAL, CODEMP);

ALTER TABLE CPITCOMPRAITCOMPRA ADD CONSTRAINT CPITCOMPITCFKITCP2 FOREIGN KEY (CODCOMPRACO, CODITCOMPRACO, CODFILIALCO, CODEMPCO) REFERENCES CPITCOMPRA (CODCOMPRA, CODITCOMPRA, CODFILIAL, CODEMP);

ALTER TABLE CPITCOMPRASERIE ADD CONSTRAINT CPITCOMPRASERIEFKSERIE FOREIGN KEY (NUMSERIE, CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQSERIE (NUMSERIE, CODPROD, CODFILIAL, CODEMP);

ALTER TABLE CPITIMPORTACAO ADD CONSTRAINT CPITIMPORTACAOFKCPIMPORT FOREIGN KEY (CODIMP, CODFILIAL, CODEMP) REFERENCES CPIMPORTACAO (CODIMP, CODFILIAL, CODEMP);

ALTER TABLE CPITIMPORTACAO ADD CONSTRAINT CPITIMPORTACAOFKEQPRODUTO FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE CPITIMPORTACAO ADD CONSTRAINT CPITIMPORTACAOFKEQUNIDADE FOREIGN KEY (CODUNID, CODFILIALUN, CODEMPUN) REFERENCES EQUNIDADE (CODUNID, CODFILIAL, CODEMP);

ALTER TABLE CPITIMPORTACAO ADD CONSTRAINT CPITIMPORTACAOFKITCLFISCAL FOREIGN KEY (CODEMPCF, CODFILIALCF, CODFISC, CODITFISC) REFERENCES LFITCLFISCAL (CODEMP, CODFILIAL, CODFISC, CODITFISC);

ALTER TABLE CPITIMPORTACAO ADD CONSTRAINT CPITIMPORTACAOFKLFNCM FOREIGN KEY (CODNCM) REFERENCES LFNCM (CODNCM);

ALTER TABLE CPITORDCOMPRA ADD CONSTRAINT CPITORDCOMPRAFKORDCOMPRA FOREIGN KEY (CODEMP, CODFILIAL, CODORDCP) REFERENCES CPORDCOMPRA (CODEMP, CODFILIAL, CODORDCP) ON DELETE CASCADE;

ALTER TABLE CPITORDCOMPRA ADD CONSTRAINT CPITORDCOMPRAFKPRODUTO FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE CPITORDCOMPRAPE ADD CONSTRAINT CPITORDCOMPRAPECPITORDCOMPRA FOREIGN KEY (CODEMP, CODFILIAL, CODORDCP, CODITORDCP) REFERENCES CPITORDCOMPRA (CODEMP, CODFILIAL, CODORDCP, CODITORDCP) ON DELETE CASCADE;

ALTER TABLE CPITSOLICITACAO ADD CONSTRAINT CPITSOLICITFKCPSOL FOREIGN KEY (CODSOL, CODFILIAL, CODEMP) REFERENCES CPSOLICITACAO (CODSOL, CODFILIAL, CODEMP);

ALTER TABLE CPITSOLICITACAO ADD CONSTRAINT CPITSOLICITFKEQALM FOREIGN KEY (CODALMOX, CODFILIALAM, CODEMPAM) REFERENCES EQALMOX (CODALMOX, CODFILIAL, CODEMP);

ALTER TABLE CPITSOLICITACAO ADD CONSTRAINT CPITSOLICITFKEQPRO FOREIGN KEY (CODPROD, CODFILIAL, CODEMP) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE CPITSOLITSOL ADD CONSTRAINT CPITSOLFKCPITSOLI FOREIGN KEY (CODSOL, CODITSOL, CODFILIAL, CODEMP) REFERENCES CPITSOLICITACAO (CODSOL, CODITSOL, CODFILIAL, CODEMP);

ALTER TABLE CPITSOLITSOL ADD CONSTRAINT CPITSOLFKCPITSOLN FOREIGN KEY (CODSOLN, CODITSOLN, CODFILIALSN, CODEMPSN) REFERENCES CPITSOLICITACAO (CODSOL, CODITSOL, CODFILIAL, CODEMP);

ALTER TABLE CPITSUMSOL ADD CONSTRAINT CPITSUMSOLFKCPITSO FOREIGN KEY (CODSOL, CODITSOL, CODFILIALSC, CODEMPSC) REFERENCES CPITSOLICITACAO (CODSOL, CODITSOL, CODFILIAL, CODEMP);

ALTER TABLE CPORDCOMPRA ADD CONSTRAINT CPORDCOMPRAFKCPFORNECED FOREIGN KEY (CODFOR, CODFILIALFR, CODEMPFR) REFERENCES CPFORNECED (CODFOR, CODFILIAL, CODEMP);

ALTER TABLE CPORDCOMPRA ADD CONSTRAINT CPORDCOMPRAFKFNPLANOPAG FOREIGN KEY (CODPLANOPAG, CODFILIALPG, CODEMPPG) REFERENCES FNPLANOPAG (CODPLANOPAG, CODFILIAL, CODEMP);

ALTER TABLE CPPRODFOR ADD CONSTRAINT CPPRODFORFKCPFORNE FOREIGN KEY (CODFOR, CODFILIALFR, CODEMPFR) REFERENCES CPFORNECED (CODFOR, CODFILIAL, CODEMP);

ALTER TABLE CPPRODFOR ADD CONSTRAINT CPPRODFORFKEQPROD FOREIGN KEY (CODPROD, CODFILIAL, CODEMP) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE CPRATEIO ADD CONSTRAINT CPRATEIOFKCPCOMPRA FOREIGN KEY (CODCOMPRA, CODFILIAL, CODEMP) REFERENCES CPCOMPRA (CODCOMPRA, CODFILIAL, CODEMP);

ALTER TABLE CPRATEIO ADD CONSTRAINT CPRATEIOFKFNCC FOREIGN KEY (CODCC, ANOCC, CODFILIALCC, CODEMPCC) REFERENCES FNCC (CODCC, ANOCC, CODFILIAL, CODEMP);

ALTER TABLE CPRATEIO ADD CONSTRAINT CPRATEIOFKFNPLANEJ FOREIGN KEY (CODPLAN, CODFILIALFN, CODEMPFN) REFERENCES FNPLANEJAMENTO (CODPLAN, CODFILIAL, CODEMP);

ALTER TABLE CPSOLICITACAO ADD CONSTRAINT CPSOLICITACAOFKFNC FOREIGN KEY (CODCC, ANOCC, CODFILIALCC, CODEMPCC) REFERENCES FNCC (CODCC, ANOCC, CODFILIAL, CODEMP);

ALTER TABLE CPSOLICITACAO ADD CONSTRAINT CPSOLICITACAOFKSGF FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE CPSOLICITACAO ADD CONSTRAINT CPSOLICITACAOFKSGU FOREIGN KEY (IDUSU, CODFILIALUU, CODEMPUU) REFERENCES SGUSUARIO (IDUSU, CODFILIAL, CODEMP);

ALTER TABLE CPSUMSOL ADD CONSTRAINT CPSUMSOLFKEQPRODUT FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE CPTABFOR ADD CONSTRAINT CPTABFORFKCPFORNEC FOREIGN KEY (CODFOR, CODFILIAL, CODEMP) REFERENCES CPFORNECED (CODFOR, CODFILIAL, CODEMP);

ALTER TABLE CPTABFOR ADD CONSTRAINT CPTABFORFKEQPRODUT FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE CPTIPOFOR ADD CONSTRAINT CPTIPOFORFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE CRCHAMADO ADD CONSTRAINT CRCHAMADOFKATEND FOREIGN KEY (CODATEND, CODFILIALAE, CODEMPAE) REFERENCES ATATENDENTE (CODATEND, CODFILIAL, CODEMP);

ALTER TABLE CRCHAMADO ADD CONSTRAINT CRCHAMADOFKCRTIPOCHAMADO FOREIGN KEY (CODTPCHAMADO, CODFILIALTC, CODEMPTC) REFERENCES CRTIPOCHAMADO (CODTPCHAMADO, CODFILIAL, CODEMP);

ALTER TABLE CRCHAMADO ADD CONSTRAINT CRCHAMADOFKEQRECMERCITOS FOREIGN KEY (TICKET, CODITRECMERC, CODITOS, CODFILIALOS, CODEMPOS) REFERENCES EQITRECMERCITOS (TICKET, CODITRECMERC, CODITOS, CODFILIAL, CODEMP);

ALTER TABLE CRCHAMADO ADD CONSTRAINT CRCHAMADOFKQUALIFIC FOREIGN KEY (CODFILIALQL, CODEMPQL, CODQUALIFIC) REFERENCES CRQUALIFICACAO (CODFILIAL, CODEMP, CODQUALIFIC);

ALTER TABLE CRCHAMADO ADD CONSTRAINT CRCHAMADOFKVDCLIENTE FOREIGN KEY (CODCLI, CODFILIALCL, CODEMPCL) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE CRCHAMADO ADD CONSTRAINT CRCHAMADOFKVDITCON FOREIGN KEY (CODCONTR, CODITCONTR, CODFILIALCT, CODEMPCT) REFERENCES VDITCONTRATO (CODCONTR, CODITCONTR, CODFILIAL, CODEMP);

ALTER TABLE CRCHAMADOANEXO ADD CONSTRAINT CRCHAMADOANEXOFKCHAMADO FOREIGN KEY (CODCHAMADO, CODFILIAL, CODEMP) REFERENCES CRCHAMADO (CODCHAMADO, CODFILIAL, CODEMP) ON DELETE CASCADE;

ALTER TABLE CRFEEDBACK ADD CONSTRAINT CRFEEDBACKFKCRFIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE CRFEEDBACK ADD CONSTRAINT CRFEEDBACKFKCRMOTI FOREIGN KEY (ID_MOTIVO) REFERENCES CRMOTIVOFB (ID);

ALTER TABLE CRFEEDBACK ADD CONSTRAINT CRFEEDBACKFKPESSO FOREIGN KEY (EMAILPESSOA, CODFILIALPE, CODEMPPE) REFERENCES CRPESSOA (EMAILPESSOA, CODFILIAL, CODEMP);

ALTER TABLE CRFICHAAVAL ADD CONSTRAINT CRFICHAAVALFKCRMO FOREIGN KEY (CODMOTAVAL, CODFILIALMA, CODEMPMA) REFERENCES CRMOTIVOAVAL (CODMOTAVAL, CODFILIAL, CODEMP);

ALTER TABLE CRFICHAAVAL ADD CONSTRAINT CRFICHAAVALFKTKCTO FOREIGN KEY (CODCTO, CODFILIALCO, CODEMP) REFERENCES TKCONTATO (CODCTO, CODFILIAL, CODEMP);

ALTER TABLE CRFICHAAVAL ADD CONSTRAINT CRFICHAAVALFKVDVEN FOREIGN KEY (CODVEND, CODFILIALVD, CODEMPVD) REFERENCES VDVENDEDOR (CODVEND, CODFILIAL, CODEMP);

ALTER TABLE CRFICHAORC ADD CONSTRAINT CRFICHAORCFKCRITFI FOREIGN KEY (SEQFICHAAVAL, SEQITFICHAAVAL, CODFILIAL, CODEMP) REFERENCES CRITFICHAAVAL (SEQFICHAAVAL, SEQITFICHAAVAL, CODFILIAL, CODEMP) ON UPDATE CASCADE;

ALTER TABLE CRFICHAORC ADD CONSTRAINT CRFICHAORCFKVDORCA FOREIGN KEY (CODORC, CODITORC, TIPOORC, CODFILIALOR, CODEMPOR) REFERENCES VDITORCAMENTO (CODORC, CODITORC, TIPOORC, CODFILIAL, CODEMP);

ALTER TABLE CRITFICHAAVAL ADD CONSTRAINT CRITFICHAAVALFKAM FOREIGN KEY (CODAMBAVAL, CODFILIALAM, CODEMPAM) REFERENCES CRAMBIENTEAVAL (CODAMBAVAL, CODFILIAL, CODEMP);

ALTER TABLE CRITFICHAAVAL ADD CONSTRAINT CRITFICHAAVALFKPD FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE CRITFICHAAVAL ADD CONSTRAINT CRITFICHAAVALFKSQ FOREIGN KEY (SEQFICHAAVAL, CODFILIAL, CODEMP) REFERENCES CRFICHAAVAL (SEQFICHAAVAL, CODFILIAL, CODEMP);

ALTER TABLE CRITFICHAAVAL ADD CONSTRAINT CRITFICHAAVALFKVG1 FOREIGN KEY (CODVARG1, SEQITVARG1, CODFILIALV1, CODEMPV1) REFERENCES EQITVARGRADE (CODVARG, SEQITVARG, CODFILIAL, CODEMP);

ALTER TABLE CRITFICHAAVAL ADD CONSTRAINT CRITFICHAAVALFKVG2 FOREIGN KEY (CODVARG2, SEQITVARG2, CODFILIALV2, CODEMPV2) REFERENCES EQITVARGRADE (CODVARG, SEQITVARG, CODFILIAL, CODEMP);

ALTER TABLE CRITFICHAAVAL ADD CONSTRAINT CRITFICHAAVALFKVG3 FOREIGN KEY (CODVARG3, SEQITVARG3, CODFILIALV3, CODEMPV3) REFERENCES EQITVARGRADE (CODVARG, SEQITVARG, CODFILIAL, CODEMP);

ALTER TABLE CRITFICHAAVAL ADD CONSTRAINT CRITFICHAAVALFKVG4 FOREIGN KEY (CODVARG4, SEQITVARG4, CODFILIALV4, CODEMPV4) REFERENCES EQITVARGRADE (CODVARG, SEQITVARG, CODFILIAL, CODEMP);

ALTER TABLE CRITFICHAAVAL ADD CONSTRAINT CRITFICHAAVALFKVG5 FOREIGN KEY (CODVARG5, SEQITVARG5, CODFILIALV5, CODEMPV5) REFERENCES EQITVARGRADE (CODVARG, SEQITVARG, CODFILIAL, CODEMP);

ALTER TABLE CRITFICHAAVAL ADD CONSTRAINT CRITFICHAAVALFKVG6 FOREIGN KEY (CODVARG6, SEQITVARG6, CODFILIALV6, CODEMPV6) REFERENCES EQITVARGRADE (CODVARG, SEQITVARG, CODFILIAL, CODEMP);

ALTER TABLE CRITFICHAAVAL ADD CONSTRAINT CRITFICHAAVALFKVG7 FOREIGN KEY (CODVARG7, SEQITVARG7, CODFILIALV7, CODEMPV7) REFERENCES EQITVARGRADE (CODVARG, SEQITVARG, CODFILIAL, CODEMP);

ALTER TABLE CRITFICHAAVAL ADD CONSTRAINT CRITFICHAAVALFKVG8 FOREIGN KEY (CODVARG8, SEQITVARG8, CODFILIALV8, CODEMPV8) REFERENCES EQITVARGRADE (CODVARG, SEQITVARG, CODFILIAL, CODEMP);

ALTER TABLE CRMOTIVOFB ADD CONSTRAINT CRMOTIVOFBFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE CRTAREFA ADD CONSTRAINT CRTAREFAFKCRCHAMAD FOREIGN KEY (CODCHAMADO, CODFILIALCH, CODEMPCH) REFERENCES CRCHAMADO (CODCHAMADO, CODFILIAL, CODEMP);

ALTER TABLE CRTAREFA ADD CONSTRAINT CRTAREFAFKCRMARCAD FOREIGN KEY (CODMARCOR, CODFILIALMO, CODEMPMO) REFERENCES CRMARCADOR (CODMARCOR, CODFILIAL, CODEMP);

ALTER TABLE CRTAREFA ADD CONSTRAINT CRTAREFAFKCRTAREFA FOREIGN KEY (CODTAREFATA, CODFILIALTA, CODEMPTA) REFERENCES CRTAREFA (CODTAREFA, CODFILIAL, CODEMP);

ALTER TABLE CRTAREFA ADD CONSTRAINT CRTAREFAFKVDITCONTR FOREIGN KEY (CODCONTR, CODITCONTR, CODFILIALCT, CODEMPCT) REFERENCES VDITCONTRATO (CODCONTR, CODITCONTR, CODFILIAL, CODEMP);

ALTER TABLE CRTAREFAPER ADD CONSTRAINT CRTAREFAPERFKCRTAR FOREIGN KEY (CODTAREFA, CODFILIAL, CODEMP) REFERENCES CRTAREFA (CODTAREFA, CODFILIAL, CODEMP);

ALTER TABLE EQALMOX ADD CONSTRAINT EQALMOXFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE EQALMOXFILIAL ADD CONSTRAINT EQALMOXFILIALFKEQA FOREIGN KEY (CODALMOX, CODFILIAL, CODEMP) REFERENCES EQALMOX (CODALMOX, CODFILIAL, CODEMP);

ALTER TABLE EQALMOXFILIAL ADD CONSTRAINT EQALMOXFILIALFKSGF FOREIGN KEY (CODFILIALAF, CODEMPAF) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE EQCLIFOR ADD CONSTRAINT EQCLIFORFKVDCLIENT FOREIGN KEY (CODCLI, CODFILIAL, CODEMP) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE EQCLIFOR ADD CONSTRAINT EQCLIFORFKVDFORNEC FOREIGN KEY (CODFOR, CODFILIALFR, CODEMPFR) REFERENCES CPFORNECED (CODFOR, CODFILIAL, CODEMP);

ALTER TABLE EQCODALTPROD ADD CONSTRAINT EQCODALTPRODFKEQPR FOREIGN KEY (CODPROD, CODFILIAL, CODEMP) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE EQEXPEDAMOSTRAGEM ADD CONSTRAINT EQEXPEDAMOSTRAGEMFKEQITRECMERC FOREIGN KEY (TICKET, CODITEXPED, CODFILIAL, CODEMP) REFERENCES EQITEXPEDICAO (TICKET, CODITEXPED, CODFILIAL, CODEMP);

ALTER TABLE EQEXPEDICAO ADD CONSTRAINT EQEXPEDICAOFKEQALMOX FOREIGN KEY (CODALMOX, CODFILIALAX, CODEMPAX) REFERENCES EQALMOX (CODALMOX, CODFILIAL, CODEMP);

ALTER TABLE EQEXPEDICAO ADD CONSTRAINT EQEXPEDICAOFKMOTORISTA FOREIGN KEY (CODMOT, CODFILIALMT, CODEMPMT) REFERENCES VDMOTORISTA (CODMOT, CODFILIAL, CODEMP);

ALTER TABLE EQEXPEDICAO ADD CONSTRAINT EQEXPEDICAOFKPRODUTO FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE EQEXPEDICAO ADD CONSTRAINT EQEXPEDICAOFKTIPOEXPED FOREIGN KEY (CODTIPOEXPED, CODFILIALTE, CODEMPTE) REFERENCES EQTIPOEXPEDICAO (CODTIPOEXPED, CODFILIAL, CODEMP);

ALTER TABLE EQEXPEDICAO ADD CONSTRAINT EQEXPEDICAOFKTRANSP FOREIGN KEY (CODTRAN, CODFILIALTN, CODEMPTN) REFERENCES VDTRANSP (CODTRAN, CODFILIAL, CODEMP);

ALTER TABLE EQEXPEDICAO ADD CONSTRAINT EQEXPEDICAOFKVDROMANEIO FOREIGN KEY (CODROMA, CODFILIALRO, CODEMPRO) REFERENCES VDROMANEIO (CODROMA, CODFILIAL, CODEMP);

ALTER TABLE EQEXPEDICAO ADD CONSTRAINT EQEXPEDICAOFKVDVEICULO FOREIGN KEY (CODVEIC, CODFILIALVE, CODEMPVE) REFERENCES VDVEICULO (CODVEIC, CODFILIAL, CODEMP);

ALTER TABLE EQFATCONV ADD CONSTRAINT EQFATCONVFKEQPRODU FOREIGN KEY (CODPROD, CODFILIAL, CODEMP) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE EQFATCONV ADD CONSTRAINT EQFATCONVFKEQUNIDA FOREIGN KEY (CODUNID, CODFILIAL, CODEMP) REFERENCES EQUNIDADE (CODUNID, CODFILIAL, CODEMP);

ALTER TABLE EQFATCONV ADD CONSTRAINT EQFATCONVFKPPESTR FOREIGN KEY (CODPRODET, SEQEST, CODFILIALET, CODEMPET) REFERENCES PPESTRUTURA (CODPROD, SEQEST, CODFILIAL, CODEMP);

ALTER TABLE EQFATCONV ADD CONSTRAINT EQFATCONVFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE EQGRUPO ADD CONSTRAINT EQGRUPOFKEQGRUPO FOREIGN KEY (CODSUBGRUP, CODFILIAL, CODEMP) REFERENCES EQGRUPO (CODGRUP, CODFILIAL, CODEMP);

ALTER TABLE EQGRUPO ADD CONSTRAINT EQGRUPOFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE EQGUIATRAF ADD CONSTRAINT EQGUIATRAFFKCPCOMP FOREIGN KEY (CODCOMPRA, CODFILIAL, CODEMP) REFERENCES CPCOMPRA (CODCOMPRA, CODFILIAL, CODEMP);

ALTER TABLE EQINVPROD ADD CONSTRAINT EQINVPRODFKEQALMOX FOREIGN KEY (CODALMOX, CODFILIALAX, CODEMPAX) REFERENCES EQALMOX (CODALMOX, CODFILIAL, CODEMP);

ALTER TABLE EQINVPROD ADD CONSTRAINT EQINVPRODFKEQLOTE FOREIGN KEY (CODLOTE, CODPROD, CODFILIALLE, CODEMPLE) REFERENCES EQLOTE (CODLOTE, CODPROD, CODFILIAL, CODEMP);

ALTER TABLE EQINVPROD ADD CONSTRAINT EQINVPRODFKEQPRODU FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE EQINVPROD ADD CONSTRAINT EQINVPRODFKEQTIPOM FOREIGN KEY (CODTIPOMOV, CODFILIALTM, CODEMPTM) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE EQINVPROD ADD CONSTRAINT EQINVPRODFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE EQITEXPEDICAO ADD CONSTRAINT EQITEXPEDICAOFKEQEXPEDICAO FOREIGN KEY (TICKET, CODFILIAL, CODEMP) REFERENCES EQEXPEDICAO (TICKET, CODFILIAL, CODEMP);

ALTER TABLE EQITEXPEDICAO ADD CONSTRAINT EQITEXPEDICAOFKEQPRODUTO FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE EQITEXPEDICAO ADD CONSTRAINT EQITEXPEDICAOFKPROCEXPED FOREIGN KEY (CODTIPOEXPED, CODPROCEXPED, CODFILIALTE, CODEMPTE) REFERENCES EQPROCEXPED (CODTIPOEXPED, CODPROCEXPED, CODFILIAL, CODEMP);

ALTER TABLE EQITMODGRADE ADD CONSTRAINT EGITMODGRADEFKEQMO FOREIGN KEY (CODMODG, CODFILIAL, CODEMP) REFERENCES EQMODGRADE (CODMODG, CODFILIAL, CODEMP);

ALTER TABLE EQITMODGRADE ADD CONSTRAINT EGITMODGRADEFKEQVA FOREIGN KEY (CODVARG, CODFILIAL, CODEMP) REFERENCES EQVARGRADE (CODVARG, CODFILIAL, CODEMP);

ALTER TABLE EQITRECMERC ADD CONSTRAINT EQITRECMERCFKEQPROCESSO FOREIGN KEY (CODTIPORECMERC, CODPROCRECMERC, CODFILIALTP, CODEMPTP) REFERENCES EQPROCRECMERC (CODTIPORECMERC, CODPROCRECMERC, CODFILIAL, CODEMP);

ALTER TABLE EQITRECMERC ADD CONSTRAINT EQITRECMERCFKEQPRODUTO FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE EQITRECMERC ADD CONSTRAINT EQITRECMERCFKEQRECMERC FOREIGN KEY (TICKET, CODFILIAL, CODEMP) REFERENCES EQRECMERC (TICKET, CODFILIAL, CODEMP);

ALTER TABLE EQITRECMERC ADD CONSTRAINT EQITRECMERCFKEQSERIE FOREIGN KEY (NUMSERIE, CODPROD, CODFILIALNS, CODEMPNS) REFERENCES EQSERIE (NUMSERIE, CODPROD, CODFILIAL, CODEMP);

ALTER TABLE EQITRECMERC ADD CONSTRAINT EQITRECMERCFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE EQITRECMERCITCP ADD CONSTRAINT EQITRECMERCITCPFKITCOMPRA FOREIGN KEY (CODCOMPRA, CODITCOMPRA, CODFILIALCP, CODEMPCP) REFERENCES CPITCOMPRA (CODCOMPRA, CODITCOMPRA, CODFILIAL, CODEMP) ON DELETE CASCADE;

ALTER TABLE EQITRECMERCITCP ADD CONSTRAINT EQITRECMERCITCPFKITRECMERC FOREIGN KEY (TICKET, CODITRECMERC, CODFILIAL, CODEMP) REFERENCES EQITRECMERC (TICKET, CODITRECMERC, CODFILIAL, CODEMP) ON DELETE CASCADE;

ALTER TABLE EQITRECMERCITOS ADD CONSTRAINT EQITRECMERCITOSFKEQITRECM FOREIGN KEY (TICKET, CODITRECMERC, CODFILIAL, CODEMP) REFERENCES EQITRECMERC (TICKET, CODITRECMERC, CODFILIAL, CODEMP);

ALTER TABLE EQITRECMERCITOS ADD CONSTRAINT EQITRECMERCITOSFKEQPRODPD FOREIGN KEY (CODPRODPD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE EQITRECMERCITOS ADD CONSTRAINT EQITRECMERCITOSFKEQSERIE FOREIGN KEY (NUMSERIE, CODPRODPD, CODFILIALNS, CODEMPNS) REFERENCES EQSERIE (NUMSERIE, CODPROD, CODFILIAL, CODEMP);

ALTER TABLE EQITRECMERCITOS ADD CONSTRAINT EQITRECMERCITOSFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE EQITRECMERCITOSITORC ADD CONSTRAINT EQITRECMERCITOSITORCFKITRMITOS FOREIGN KEY (TICKET, CODITRECMERC, CODITOS, CODFILIAL, CODEMP) REFERENCES EQITRECMERCITOS (TICKET, CODITRECMERC, CODITOS, CODFILIAL, CODEMP);

ALTER TABLE EQITRECMERCITOSITORC ADD CONSTRAINT EQITRECMERCITOSITORCFKVDITORC FOREIGN KEY (CODORC, CODITORC, TIPOORC, CODFILIALOC, CODEMPOC) REFERENCES VDITORCAMENTO (CODORC, CODITORC, TIPOORC, CODFILIAL, CODEMP) ON DELETE CASCADE;

ALTER TABLE EQITRECMERCSERIE ADD CONSTRAINT EQITRECMERCFKSERIE FOREIGN KEY (NUMSERIE, CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQSERIE (NUMSERIE, CODPROD, CODFILIAL, CODEMP);

ALTER TABLE EQITRECMERCSERIE ADD CONSTRAINT EQITRECMERCSERIEFKITRECMERC FOREIGN KEY (TICKET, CODITRECMERC, CODFILIAL, CODEMP) REFERENCES EQITRECMERC (TICKET, CODITRECMERC, CODFILIAL, CODEMP) ON DELETE CASCADE;

ALTER TABLE EQITRMA ADD CONSTRAINT EQITRMAFKEQALMOX FOREIGN KEY (CODALMOX, CODFILIALAX, CODEMPAX) REFERENCES EQALMOX (CODALMOX, CODFILIAL, CODEMP);

ALTER TABLE EQITRMA ADD CONSTRAINT EQITRMAFKEQITRECMERCITOS FOREIGN KEY (TICKET, CODITRECMERC, CODITOS, CODFILIALOS, CODEMPOS) REFERENCES EQITRECMERCITOS (TICKET, CODITRECMERC, CODITOS, CODFILIAL, CODEMP) ON DELETE SET NULL;

ALTER TABLE EQITRMA ADD CONSTRAINT EQITRMAFKEQLOTE FOREIGN KEY (CODLOTE, CODPROD, CODFILIALLE, CODEMPLE) REFERENCES EQLOTE (CODLOTE, CODPROD, CODFILIAL, CODEMP);

ALTER TABLE EQITRMA ADD CONSTRAINT EQITRMAFKEQPRODUTO FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE EQITRMA ADD CONSTRAINT EQITRMAFKEQRMA FOREIGN KEY (CODRMA, CODFILIAL, CODEMP) REFERENCES EQRMA (CODRMA, CODFILIAL, CODEMP);

ALTER TABLE EQITSIMILAR ADD CONSTRAINT EQITSIMILARFKEQPRO FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE EQITSIMILAR ADD CONSTRAINT EQITSIMILARFKEQSIM FOREIGN KEY (CODSIM, CODFILIAL, CODEMP) REFERENCES EQSIMILAR (CODSIM, CODFILIAL, CODEMP);

ALTER TABLE EQITVARGRADE ADD CONSTRAINT EGITVARGRADEFKEQVA FOREIGN KEY (CODVARG, CODFILIAL, CODEMP) REFERENCES EQVARGRADE (CODVARG, CODFILIAL, CODEMP);

ALTER TABLE EQLANCTOEXP ADD CONSTRAINT EQLANCTOEXPFKEQTIP FOREIGN KEY (CODTIPOEXP, CODFILIALTE, CODEMPTE) REFERENCES EQTIPOEXP (CODTIPOEXP, CODFILIAL, CODEMP);

ALTER TABLE EQLANCTOEXP ADD CONSTRAINT EQLANCTOEXPFKSGFIL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE EQLANCTOEXP ADD CONSTRAINT EQLANCTOEXPFKVDCLI FOREIGN KEY (CODCLI, CODFILIALCL, CODEMPCL) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE EQLOCDESCARGA ADD CONSTRAINT EQLOCDESCARGAFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE EQLOTE ADD CONSTRAINT EQLOTEFKEQPRODUTO FOREIGN KEY (CODPROD, CODFILIAL, CODEMP) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE EQLOTE ADD CONSTRAINT EQLOTEFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE EQMARCA ADD CONSTRAINT EQMARCAFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE EQMODGRADE ADD CONSTRAINT EQMODGRADEFKEQPROD FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE EQMODGRADE ADD CONSTRAINT EQMODGRADEFKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE EQMOVEXP ADD CONSTRAINT EQMOVEXPFKEQTIPOEX FOREIGN KEY (CODTIPOEXP, CODFILIALTE, CODEMPTE) REFERENCES EQTIPOEXP (CODTIPOEXP, CODFILIAL, CODEMP);

ALTER TABLE EQMOVEXP ADD CONSTRAINT EQMOVEXPFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE EQMOVEXP ADD CONSTRAINT EQMOVEXPFKVDCLIENT FOREIGN KEY (CODCLI, CODFILIALCL, CODEMPCL) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE EQMOVPROD ADD CONSTRAINT EQMOVPRODFKCPITCOM FOREIGN KEY (CODCOMPRA, CODITCOMPRA, CODFILIALCP, CODEMPCP) REFERENCES CPITCOMPRA (CODCOMPRA, CODITCOMPRA, CODFILIAL, CODEMP) ON UPDATE CASCADE;

ALTER TABLE EQMOVPROD ADD CONSTRAINT EQMOVPRODFKEQALMOX FOREIGN KEY (CODALMOX, CODFILIALAX, CODEMPAX) REFERENCES EQALMOX (CODALMOX, CODFILIAL, CODEMP);

ALTER TABLE EQMOVPROD ADD CONSTRAINT EQMOVPRODFKEQINVPR FOREIGN KEY (CODINVPROD, CODFILIALIV, CODEMPIV) REFERENCES EQINVPROD (CODINVPROD, CODFILIAL, CODEMP);

ALTER TABLE EQMOVPROD ADD CONSTRAINT EQMOVPRODFKEQITRMA FOREIGN KEY (CODRMA, CODITRMA, CODFILIALRM, CODEMPRM) REFERENCES EQITRMA (CODRMA, CODITRMA, CODFILIAL, CODEMP);

ALTER TABLE EQMOVPROD ADD CONSTRAINT EQMOVPRODFKEQLOTE FOREIGN KEY (CODLOTE, CODPROD, CODFILIALLE, CODEMPLE) REFERENCES EQLOTE (CODLOTE, CODPROD, CODFILIAL, CODEMP);

ALTER TABLE EQMOVPROD ADD CONSTRAINT EQMOVPRODFKEQOP FOREIGN KEY (CODOP, SEQOP, CODFILIALOP, CODEMPOP) REFERENCES PPOP (CODOP, SEQOP, CODFILIAL, CODEMP) ON DELETE CASCADE;

ALTER TABLE EQMOVPROD ADD CONSTRAINT EQMOVPRODFKEQPRODU FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE EQMOVPROD ADD CONSTRAINT EQMOVPRODFKEQTIPOM FOREIGN KEY (CODTIPOMOV, CODFILIALTM, CODEMPTM) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE EQMOVPROD ADD CONSTRAINT EQMOVPRODFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE EQMOVPROD ADD CONSTRAINT EQMOVPRODFKVDITVEN FOREIGN KEY (CODVENDA, CODITVENDA, TIPOVENDA, CODFILIALVD, CODEMPVD) REFERENCES VDITVENDA (CODVENDA, CODITVENDA, TIPOVENDA, CODFILIAL, CODEMP) ON UPDATE CASCADE;

ALTER TABLE EQMOVSERIE ADD CONSTRAINT EQMOVSERIEFKCPITCOM FOREIGN KEY (CODCOMPRA, CODITCOMPRA, CODFILIALCP, CODEMPCP) REFERENCES CPITCOMPRA (CODCOMPRA, CODITCOMPRA, CODFILIAL, CODEMP) ON UPDATE CASCADE ON DELETE CASCADE;

ALTER TABLE EQMOVSERIE ADD CONSTRAINT EQMOVSERIEFKEQINVPR FOREIGN KEY (CODINVPROD, CODFILIALIV, CODEMPIV) REFERENCES EQINVPROD (CODINVPROD, CODFILIAL, CODEMP) ON DELETE CASCADE;

ALTER TABLE EQMOVSERIE ADD CONSTRAINT EQMOVSERIEFKEQITRMA FOREIGN KEY (CODRMA, CODITRMA, CODFILIALRM, CODEMPRM) REFERENCES EQITRMA (CODRMA, CODITRMA, CODFILIAL, CODEMP) ON DELETE CASCADE;

ALTER TABLE EQMOVSERIE ADD CONSTRAINT EQMOVSERIEFKEQOP FOREIGN KEY (CODOP, SEQOP, CODFILIALOP, CODEMPOP) REFERENCES PPOP (CODOP, SEQOP, CODFILIAL, CODEMP) ON DELETE CASCADE;

ALTER TABLE EQMOVSERIE ADD CONSTRAINT EQMOVSERIEFKEQRECMERC FOREIGN KEY (TICKET, CODITRECMERC, CODFILIALRC, CODEMPRC) REFERENCES EQITRECMERC (TICKET, CODITRECMERC, CODFILIAL, CODEMP) ON DELETE CASCADE;

ALTER TABLE EQMOVSERIE ADD CONSTRAINT EQMOVSERIEFKEQSERIE FOREIGN KEY (NUMSERIE, CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQSERIE (NUMSERIE, CODPROD, CODFILIAL, CODEMP) ON DELETE CASCADE;

ALTER TABLE EQMOVSERIE ADD CONSTRAINT EQMOVSERIEFKEQTIPOM FOREIGN KEY (CODTIPOMOV, CODFILIALTM, CODEMPTM) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP) ON DELETE CASCADE;

ALTER TABLE EQMOVSERIE ADD CONSTRAINT EQMOVSERIEFKRECMERC FOREIGN KEY (TICKET, CODFILIALRC, CODEMPRC) REFERENCES EQRECMERC (TICKET, CODFILIAL, CODEMP) ON DELETE CASCADE;

ALTER TABLE EQMOVSERIE ADD CONSTRAINT EQMOVSERIEFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP) ON DELETE CASCADE;

ALTER TABLE EQMOVSERIE ADD CONSTRAINT EQMOVSERIEFKVDITVEN FOREIGN KEY (CODVENDA, CODITVENDA, TIPOVENDA, CODFILIALVD, CODEMPVD) REFERENCES VDITVENDA (CODVENDA, CODITVENDA, TIPOVENDA, CODFILIAL, CODEMP) ON UPDATE CASCADE ON DELETE CASCADE;

ALTER TABLE EQPROCEXPED ADD CONSTRAINT EQPROCEXPEDFKEQTIPOEXPED FOREIGN KEY (CODTIPOEXPED, CODFILIAL, CODEMP) REFERENCES EQTIPOEXPEDICAO (CODTIPOEXPED, CODFILIAL, CODEMP);

ALTER TABLE EQPROCRECMERC ADD CONSTRAINT EQPROCRECMERCFKEQRECMERC FOREIGN KEY (CODTIPORECMERC, CODFILIAL, CODEMP) REFERENCES EQTIPORECMERC (CODTIPORECMERC, CODFILIAL, CODEMP);

ALTER TABLE EQPROCRECMERC ADD CONSTRAINT EQPROCRECMERCFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE EQPRODACESSO ADD CONSTRAINT EQPRODACESSOFKFNCC FOREIGN KEY (CODCC, ANOCC, CODFILIALCC, CODEMPCC) REFERENCES FNCC (CODCC, ANOCC, CODFILIAL, CODEMP);

ALTER TABLE EQPRODACESSO ADD CONSTRAINT EQPRODACESSOFKPVCA FOREIGN KEY (CODCAIXA, CODFILIALCX, CODEMPCX) REFERENCES PVCAIXA (CODCAIXA, CODFILIAL, CODEMP);

ALTER TABLE EQPRODPLAN ADD CONSTRAINT EQPRODPLANFKEQPROD FOREIGN KEY (CODPROD, CODFILIAL, CODEMP) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE EQPRODPLAN ADD CONSTRAINT EQPRODPLANFKFNCC FOREIGN KEY (CODCC, ANOCC, CODFILIALCC, CODEMPCC) REFERENCES FNCC (CODCC, ANOCC, CODFILIAL, CODEMP);

ALTER TABLE EQPRODPLAN ADD CONSTRAINT EQPRODPLANFKFNPLAN FOREIGN KEY (CODPLAN, CODFILIALPN, CODEMPPN) REFERENCES FNPLANEJAMENTO (CODPLAN, CODFILIAL, CODEMP);

ALTER TABLE EQPRODUTO ADD CONSTRAINT EQPRODUTOFKCRTIPOCHAMADO FOREIGN KEY (CODTPCHAMADO, CODFILIALTC, CODEMPTC) REFERENCES CRTIPOCHAMADO (CODTPCHAMADO, CODFILIAL, CODEMP);

ALTER TABLE EQPRODUTO ADD CONSTRAINT EQPRODUTOFKEQALMOX FOREIGN KEY (CODALMOX, CODFILIALAX, CODEMPAX) REFERENCES EQALMOX (CODALMOX, CODFILIAL, CODEMP);

ALTER TABLE EQPRODUTO ADD CONSTRAINT EQPRODUTOFKEQGRUPO FOREIGN KEY (CODGRUP, CODFILIALGP, CODEMPGP) REFERENCES EQGRUPO (CODGRUP, CODFILIAL, CODEMP);

ALTER TABLE EQPRODUTO ADD CONSTRAINT EQPRODUTOFKEQMARCA FOREIGN KEY (CODMARCA, CODFILIALMC, CODEMPMC) REFERENCES EQMARCA (CODMARCA, CODFILIAL, CODEMP);

ALTER TABLE EQPRODUTO ADD CONSTRAINT EQPRODUTOFKEQUNIDA FOREIGN KEY (CODUNID, CODFILIALUD, CODEMPUD) REFERENCES EQUNIDADE (CODUNID, CODFILIAL, CODEMP);

ALTER TABLE EQPRODUTO ADD CONSTRAINT EQPRODUTOFKFNCC FOREIGN KEY (CODCC, ANOCC, CODFILIALCC, CODEMPCC) REFERENCES FNCC (CODCC, ANOCC, CODFILIAL, CODEMP);

ALTER TABLE EQPRODUTO ADD CONSTRAINT EQPRODUTOFKFNMOEDA FOREIGN KEY (CODMOEDA, CODFILIALMA, CODEMPMA) REFERENCES FNMOEDA (CODMOEDA, CODFILIAL, CODEMP);

ALTER TABLE EQPRODUTO ADD CONSTRAINT EQPRODUTOFKLFCLFIS FOREIGN KEY (CODFISC, CODFILIALFC, CODEMPFC) REFERENCES LFCLFISCAL (CODFISC, CODFILIAL, CODEMP);

ALTER TABLE EQPRODUTO ADD CONSTRAINT EQPRODUTOFKSECAO FOREIGN KEY (CODSECAO, CODFILIALSC, CODEMPSC) REFERENCES EQSECAO (CODSECAO, CODFILIAL, CODEMP);

ALTER TABLE EQPRODUTO ADD CONSTRAINT EQPRODUTOFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE EQPRODUTO ADD CONSTRAINT EQPRODUTOFKVDPRAZO FOREIGN KEY (CODPE, CODFILIALPE, CODEMPPE) REFERENCES VDPRAZOENT (CODPE, CODFILIAL, CODEMP);

ALTER TABLE EQRECAMOSTRAGEM ADD CONSTRAINT EQRECAMOSTRAGEMFKEQITRECMERC FOREIGN KEY (TICKET, CODITRECMERC, CODFILIAL, CODEMP) REFERENCES EQITRECMERC (TICKET, CODITRECMERC, CODFILIAL, CODEMP);

ALTER TABLE EQRECMERC ADD CONSTRAINT EQRECMERCFKATATENDENTE FOREIGN KEY (CODATENDREC, CODFILIALAR, CODEMPAR) REFERENCES ATATENDENTE (CODATEND, CODFILIAL, CODEMP);

ALTER TABLE EQRECMERC ADD CONSTRAINT EQRECMERCFKCPFORNECED FOREIGN KEY (CODFOR, CODFILIALFR, CODEMPFR) REFERENCES CPFORNECED (CODFOR, CODFILIAL, CODEMP);

ALTER TABLE EQRECMERC ADD CONSTRAINT EQRECMERCFKEQALMOX FOREIGN KEY (CODALMOX, CODFILIALAX, CODEMPAX) REFERENCES EQALMOX (CODALMOX, CODFILIAL, CODEMP);

ALTER TABLE EQRECMERC ADD CONSTRAINT EQRECMERCFKEQPRODUTO FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE EQRECMERC ADD CONSTRAINT EQRECMERCFKEQTIPORECM FOREIGN KEY (CODTIPORECMERC, CODFILIALTR, CODEMPTR) REFERENCES EQTIPORECMERC (CODTIPORECMERC, CODFILIAL, CODEMP);

ALTER TABLE EQRECMERC ADD CONSTRAINT EQRECMERCFKSGBAIRRO FOREIGN KEY (CODBAIRRO, CODMUNIC, SIGLAUF, CODPAIS) REFERENCES SGBAIRRO (CODBAIRRO, CODMUNIC, SIGLAUF, CODPAIS);

ALTER TABLE EQRECMERC ADD CONSTRAINT EQRECMERCFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE EQRECMERC ADD CONSTRAINT EQRECMERCFKVDCLIENTE FOREIGN KEY (CODCLI, CODFILIALCL, CODEMPCL) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE EQRECMERC ADD CONSTRAINT EQRECMERCFKVDTRANSP FOREIGN KEY (CODTRAN, CODFILIALTN, CODEMPTN) REFERENCES VDTRANSP (CODTRAN, CODFILIAL, CODEMP);

ALTER TABLE EQRECMERC ADD CONSTRAINT EQRECMERCFKVDVENDEDOR FOREIGN KEY (CODVEND, CODFILIALVD, CODEMPVD) REFERENCES VDVENDEDOR (CODVEND, CODFILIAL, CODEMP);

ALTER TABLE EQRMA ADD CONSTRAINT EQRMAFKCTR FOREIGN KEY (CODCONTR, CODITCONTR, CODFILIALCT, CODEMPCT) REFERENCES VDITCONTRATO (CODCONTR, CODITCONTR, CODFILIAL, CODEMP);

ALTER TABLE EQRMA ADD CONSTRAINT EQRMAFKEQRECMERC FOREIGN KEY (TICKET, CODFILIALOS, CODEMPOS) REFERENCES EQRECMERC (TICKET, CODFILIAL, CODEMP);

ALTER TABLE EQRMA ADD CONSTRAINT EQRMAFKEQTIPOMOV FOREIGN KEY (CODTIPOMOV, CODFILIALTM, CODEMPTM) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE EQRMA ADD CONSTRAINT EQRMAFKFNCC FOREIGN KEY (CODCC, ANOCC, CODFILIALCC, CODEMPCC) REFERENCES FNCC (CODCC, ANOCC, CODFILIAL, CODEMP);

ALTER TABLE EQRMA ADD CONSTRAINT EQRMAFKPPOP FOREIGN KEY (CODOP, SEQOP, CODFILIALOF, CODEMPOF) REFERENCES PPOP (CODOP, SEQOP, CODFILIAL, CODEMP);

ALTER TABLE EQRMA ADD CONSTRAINT EQRMAFKPPOPFASE FOREIGN KEY (CODOP, SEQOP, SEQOF, CODFILIALOF, CODEMPOF) REFERENCES PPOPFASE (CODOP, SEQOP, SEQOF, CODFILIAL, CODEMP);

ALTER TABLE EQRMA ADD CONSTRAINT EQRMAFKSGUSUARIO FOREIGN KEY (IDUSU, CODFILIALUU, CODEMPUU) REFERENCES SGUSUARIO (IDUSU, CODFILIAL, CODEMP);

ALTER TABLE EQRMA ADD CONSTRAINT EQRMAFKSGUSUARIOAP FOREIGN KEY (IDUSUAPROV, CODFILIALUA, CODEMPUA) REFERENCES SGUSUARIO (IDUSU, CODFILIAL, CODEMP);

ALTER TABLE EQRMA ADD CONSTRAINT EQRMAFKSGUSUARIOEX FOREIGN KEY (IDUSUEXP, CODFILIALUE, CODEMPUE) REFERENCES SGUSUARIO (IDUSU, CODFILIAL, CODEMP);

ALTER TABLE EQRMAAL ADD CONSTRAINT EQRMAALFKEQRMA FOREIGN KEY (CODRMA, CODFILIAL, CODEMP) REFERENCES EQRMA (CODRMA, CODFILIAL, CODEMP);

ALTER TABLE EQRMAAL ADD CONSTRAINT EQRMAALFKSGUSUARIO FOREIGN KEY (IDUSU, CODFILIALUU, CODEMPUU) REFERENCES SGUSUARIO (IDUSU, CODFILIAL, CODEMP);

ALTER TABLE EQSALDOLOTE ADD CONSTRAINT EQSALDOLOTEFKEQALM FOREIGN KEY (CODALMOX, CODFILIALAX, CODEMPAX) REFERENCES EQALMOX (CODALMOX, CODFILIAL, CODEMP);

ALTER TABLE EQSALDOLOTE ADD CONSTRAINT EQSALDOLOTEFKEQLOT FOREIGN KEY (CODLOTE, CODPROD, CODFILIAL, CODEMP) REFERENCES EQLOTE (CODLOTE, CODPROD, CODFILIAL, CODEMP);

ALTER TABLE EQSALDOPROD ADD CONSTRAINT EQSOLDOPRODFKEQALM FOREIGN KEY (CODALMOX, CODFILIALAX, CODEMPAX) REFERENCES EQALMOX (CODALMOX, CODFILIAL, CODEMP);

ALTER TABLE EQSALDOPROD ADD CONSTRAINT EQSOLDOPRODFKEQPRO FOREIGN KEY (CODPROD, CODFILIAL, CODEMP) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE EQSERIE ADD CONSTRAINT EQSERIEFKEQPRODUTO FOREIGN KEY (CODPROD, CODFILIAL, CODEMP) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE EQSERIE ADD CONSTRAINT EQSERIEFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE EQTIPOEXP ADD CONSTRAINT EQTIPOEXPFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE EQTIPOEXPEDICAO ADD CONSTRAINT EQTIPOEXPEDFKEQPRODUTO FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE EQTIPOEXPEDICAO ADD CONSTRAINT EQTIPOEXPEDFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE EQTIPOEXPEDICAO ADD CONSTRAINT EQTIPOEXPEDICAOFKTIPOMOV FOREIGN KEY (CODTIPOMOV, CODFILIALTM, CODEMPTM) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE EQTIPOMOV ADD CONSTRAINT EQTIPOMOVFKEQTIPOC FOREIGN KEY (CODTIPOMOVTC, CODFILIALTC, CODEMPTC) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE EQTIPOMOV ADD CONSTRAINT EQTIPOMOVFKEQTIPOM FOREIGN KEY (CODTIPOMOVTM, CODFILIALTM, CODEMPTM) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE EQTIPOMOV ADD CONSTRAINT EQTIPOMOVFKFNPLANOPAG FOREIGN KEY (CODPLANOPAG, CODFILIALPP, CODEMPPP) REFERENCES FNPLANOPAG (CODPLANOPAG, CODFILIAL, CODEMP);

ALTER TABLE EQTIPOMOV ADD CONSTRAINT EQTIPOMOVFKLFMENSA FOREIGN KEY (CODMENS, CODFILIALMC, CODEMPMC) REFERENCES LFMENSAGEM (CODMENS, CODFILIAL, CODEMP);

ALTER TABLE EQTIPOMOV ADD CONSTRAINT EQTIPOMOVFKLFMODNO FOREIGN KEY (CODMODNOTA, CODFILIALMN, CODEMPMN) REFERENCES LFMODNOTA (CODMODNOTA, CODFILIAL, CODEMP);

ALTER TABLE EQTIPOMOV ADD CONSTRAINT EQTIPOMOVFKLFSERIE FOREIGN KEY (SERIE, CODFILIALSE, CODEMPSE) REFERENCES LFSERIE (SERIE, CODFILIAL, CODEMP);

ALTER TABLE EQTIPOMOV ADD CONSTRAINT EQTIPOMOVFKLFSERCO FOREIGN KEY (SERIEC, CODFILIALSC, CODEMPSC) REFERENCES LFSERIE (SERIE, CODFILIAL, CODEMP);

ALTER TABLE EQTIPOMOV ADD CONSTRAINT EQTIPOMOVFKMODDOCFISC FOREIGN KEY (CODMODDOCFISC, CODFILIALDF, CODEMPDF) REFERENCES LFMODDOCFISC (CODMODDOCFISC, CODFILIAL, CODEMP);

ALTER TABLE EQTIPOMOV ADD CONSTRAINT EQTIPOMOVFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE EQTIPOMOV ADD CONSTRAINT EQTIPOMOVFKVDREGRA FOREIGN KEY (CODREGRCOMIS, CODFILIALRC, CODEMPRC) REFERENCES VDREGRACOMIS (CODREGRCOMIS, CODFILIAL, CODEMP);

ALTER TABLE EQTIPOMOV ADD CONSTRAINT EQTIPOMOVFKVDTABPR FOREIGN KEY (CODTAB, CODFILIALTB, CODEMPTB) REFERENCES VDTABPRECO (CODTAB, CODFILIAL, CODEMP);

ALTER TABLE EQTIPOMOV ADD CONSTRAINT EQTIPOMOVFKVDTRANS FOREIGN KEY (CODTRAN, CODFILIALTN, CODEMPTN) REFERENCES VDTRANSP (CODTRAN, CODFILIAL, CODEMP);

ALTER TABLE EQTIPOMOVUSU ADD CONSTRAINT EQTIPOMOVUSUFKEQTI FOREIGN KEY (CODTIPOMOV, CODFILIAL, CODEMP) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE EQTIPOMOVUSU ADD CONSTRAINT EQTIPOMOVUSUFKSGUS FOREIGN KEY (IDUSU, CODFILIALUS, CODEMPUS) REFERENCES SGUSUARIO (IDUSU, CODFILIAL, CODEMP);

ALTER TABLE EQTIPORECMERC ADD CONSTRAINT EQTIPORECMERCFKEQPRODUTO FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE EQTIPORECMERC ADD CONSTRAINT EQTIPORECMERCFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE EQITTROCAREFPROD ADD CONSTRAINT EQITTROCAREFPFKEQTRO FOREIGN KEY (ID) REFERENCES EQTROCAREFPROD (ID);

ALTER TABLE EQITTROCAREFPROD ADD CONSTRAINT EQITTROCAREFPFKSGFIL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE EQITTROCARPLOG ADD CONSTRAINT EQITTROCARPFKEQITTRO FOREIGN KEY (ID_IT_TROCA) REFERENCES EQITTROCAREFPROD (ID_IT);

ALTER TABLE EQTROCAREFPROD ADD CONSTRAINT EQTROCAREFPRODFKSGFI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE EQUNIDADE ADD CONSTRAINT EQUNIDADEFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE EQVARGRADE ADD CONSTRAINT EQVARGRADEFKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE FNBANCO ADD CONSTRAINT FNBANCOFKFNMODBOLE FOREIGN KEY (CODMODBOL, CODFILIALMB, CODEMPMB) REFERENCES FNMODBOLETO (CODMODBOL, CODFILIAL, CODEMP);

ALTER TABLE FNBANCO ADD CONSTRAINT FNBANCOFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE FNBORDERO ADD CONSTRAINT FNBORDEROFKFNCONTA FOREIGN KEY (NUMCONTA, CODFILIALCC, CODEMPCC) REFERENCES FNCONTA (NUMCONTA, CODFILIAL, CODEMP);

ALTER TABLE FNBORDERO ADD CONSTRAINT FNBORDEROFKFNCONTABOR FOREIGN KEY (NUMCONTABOR, CODFILIALCB, CODEMPCB) REFERENCES FNCONTA (NUMCONTA, CODFILIAL, CODEMP);

ALTER TABLE FNBORDERO ADD CONSTRAINT FNBORDEROFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE FNCARTCOB ADD CONSTRAINT FNCARTCOBFKFNBANCO FOREIGN KEY (CODBANCO, CODFILIALBO, CODEMPBO) REFERENCES FNBANCO (CODBANCO, CODFILIAL, CODEMP);

ALTER TABLE FNCC ADD CONSTRAINT FNCCFKFNCC FOREIGN KEY (CODSUBCC, ANOSCC, CODFILIAL, CODEMP) REFERENCES FNCC (CODCC, ANOCC, CODFILIAL, CODEMP);

ALTER TABLE FNCC ADD CONSTRAINT FNCCFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE FNCHEQUE ADD CONSTRAINT FNCHEQUEFKFNBANCO FOREIGN KEY (CODBANC, CODFILIALBO, CODEMPBO) REFERENCES FNBANCO (CODBANCO, CODFILIAL, CODEMP);

ALTER TABLE FNCONTA ADD CONSTRAINT FNCONTAFKFNBANCO FOREIGN KEY (CODBANCO, CODFILIALBO, CODEMPBO) REFERENCES FNBANCO (CODBANCO, CODFILIAL, CODEMP);

ALTER TABLE FNCONTA ADD CONSTRAINT FNCONTAFKFNHISTPAD FOREIGN KEY (CODHIST, CODFILIALHP, CODEMPHP) REFERENCES FNHISTPAD (CODHIST, CODFILIAL, CODEMP);

ALTER TABLE FNCONTA ADD CONSTRAINT FNCONTAFKFNMOEDA FOREIGN KEY (CODMOEDA, CODFILIALMA, CODEMPMA) REFERENCES FNMOEDA (CODMOEDA, CODFILIAL, CODEMP);

ALTER TABLE FNCONTA ADD CONSTRAINT FNCONTAFKFNPLANEJA FOREIGN KEY (CODPLAN, CODFILIALPN, CODEMPPN) REFERENCES FNPLANEJAMENTO (CODPLAN, CODFILIAL, CODEMP);

ALTER TABLE FNCONTA ADD CONSTRAINT FNCONTAFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE FNCONTAUSU ADD CONSTRAINT FNCONTAUSUFKFNCONT FOREIGN KEY (NUMCONTA, CODFILIAL, CODEMP) REFERENCES FNCONTA (NUMCONTA, CODFILIAL, CODEMP);

ALTER TABLE FNCONTAUSU ADD CONSTRAINT FNCONTAUSUFKSGUSUA FOREIGN KEY (IDUSU, CODFILIALUS, CODEMPUS) REFERENCES SGUSUARIO (IDUSU, CODFILIAL, CODEMP);

ALTER TABLE FNCOTMOEDA ADD CONSTRAINT FNCOTMOEDAFKFNMOED FOREIGN KEY (CODMOEDA, CODFILIAL, CODEMP) REFERENCES FNMOEDA (CODMOEDA, CODFILIAL, CODEMP);

ALTER TABLE FNCOTMOEDA ADD CONSTRAINT FNCOTMOEDAFKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE FNFBNCLI ADD CONSTRAINT FNFBNCLIFKFNCONTA FOREIGN KEY (NUMCONTA, CODFILIALCA, CODEMPCA) REFERENCES FNCONTA (NUMCONTA, CODFILIAL, CODEMP);

ALTER TABLE FNFBNCLI ADD CONSTRAINT FNFBNCLIFKFNPLANEJ FOREIGN KEY (CODPLAN, CODFILIALPN, CODEMPPN) REFERENCES FNPLANEJAMENTO (CODPLAN, CODFILIAL, CODEMP);

ALTER TABLE FNFBNCLI ADD CONSTRAINT FNFBNCLIFKSGITPREF FOREIGN KEY (CODBANCO, TIPOFEBRABAN, CODFILIALBO, CODEMPBO, CODFILIALPF, CODEMPPF) REFERENCES SGITPREFERE6 (CODBANCO, TIPOFEBRABAN, CODFILIALBO, CODEMPBO, CODFILIAL, CODEMP);

ALTER TABLE FNFBNCLI ADD CONSTRAINT FNFBNCLIFKVDCLIENT FOREIGN KEY (CODCLI, CODFILIAL, CODEMP) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE FNFBNCODRET ADD CONSTRAINT FNFBNCODRETFKSGITP FOREIGN KEY (CODBANCO, TIPOFEBRABAN, CODFILIALBO, CODEMPBO, CODFILIAL, CODEMP) REFERENCES SGITPREFERE6 (CODBANCO, TIPOFEBRABAN, CODFILIALBO, CODEMPBO, CODFILIAL, CODEMP);

ALTER TABLE FNFBNREC ADD CONSTRAINT FNFBNRECFKFNITREC FOREIGN KEY (CODREC, NPARCITREC, CODFILIAL, CODEMP) REFERENCES FNITRECEBER (CODREC, NPARCITREC, CODFILIAL, CODEMP) ON DELETE CASCADE;

ALTER TABLE FNFBNREC ADD CONSTRAINT FNFBNRECFKSGITPREF FOREIGN KEY (CODBANCO, TIPOFEBRABAN, CODFILIALBO, CODEMPBO, CODFILIALPF, CODEMPPF) REFERENCES SGITPREFERE6 (CODBANCO, TIPOFEBRABAN, CODFILIALBO, CODEMPBO, CODFILIAL, CODEMP);

ALTER TABLE FNITBORDERO ADD CONSTRAINT FNITBORDEROFKBORDERO FOREIGN KEY (CODBOR, CODFILIAL, CODEMP) REFERENCES FNBORDERO (CODBOR, CODFILIAL, CODEMP);

ALTER TABLE FNITBORDERO ADD CONSTRAINT FNITBORDEROFKRECEBER FOREIGN KEY (CODREC, NPARCITREC, CODFILIALRC, CODEMPRC) REFERENCES FNITRECEBER (CODREC, NPARCITREC, CODFILIAL, CODEMP);

ALTER TABLE FNITFBNCODRET ADD CONSTRAINT FNITFBNCODREFKFNFBNCODRE FOREIGN KEY (CODRET, TIPOFEBRABAN, CODBANCO, CODFILIALBO, CODEMPBO, CODFILIAL, CODEMP) REFERENCES FNFBNCODRET (CODRET, TIPOFEBRABAN, CODBANCO, CODFILIALBO, CODEMPBO, CODFILIAL, CODEMP);

ALTER TABLE FNITMODBOLETO ADD CONSTRAINT FNITMODBOLETOFKCAR FOREIGN KEY (CODCARTCOB, CODFILIALCB, CODEMPCB, CODBANCO, CODFILIALBO, CODEMPBO) REFERENCES FNCARTCOB (CODCARTCOB, CODFILIAL, CODEMP, CODBANCO, CODFILIALBO, CODEMPBO);

ALTER TABLE FNITMODBOLETO ADD CONSTRAINT FNITMODBOLETOFKFNCONTA FOREIGN KEY (NUMCONTA, CODFILIALCT, CODEMPCT) REFERENCES FNCONTA (NUMCONTA, CODFILIAL, CODEMP);

ALTER TABLE FNITMODBOLETO ADD CONSTRAINT FNITMODBOLETOFKMOD FOREIGN KEY (CODMODBOL, CODFILIAL, CODEMP) REFERENCES FNMODBOLETO (CODMODBOL, CODFILIAL, CODEMP);

ALTER TABLE FNITPAGAR ADD CONSTRAINT FNITPAGARFKCONTRAT FOREIGN KEY (CODCONTR, CODITCONTR, CODFILIALCT, CODEMPCT) REFERENCES VDITCONTRATO (CODCONTR, CODITCONTR, CODFILIAL, CODEMP);

ALTER TABLE FNITPAGAR ADD CONSTRAINT FNITPAGARFKFNCONTA FOREIGN KEY (NUMCONTA, CODFILIALCA, CODEMPCA) REFERENCES FNCONTA (NUMCONTA, CODFILIAL, CODEMP);

ALTER TABLE FNITPAGAR ADD CONSTRAINT FNITPAGARFKFNPAGAR FOREIGN KEY (CODPAG, CODFILIAL, CODEMP) REFERENCES FNPAGAR (CODPAG, CODFILIAL, CODEMP);

ALTER TABLE FNITPAGAR ADD CONSTRAINT FNITPAGARFKFNPLANE FOREIGN KEY (CODPLAN, CODFILIALPN, CODEMPPN) REFERENCES FNPLANEJAMENTO (CODPLAN, CODFILIAL, CODEMP);

ALTER TABLE FNITPAGAR ADD CONSTRAINT FNITPAGARFKFNTPCOB FOREIGN KEY (CODTIPOCOB, CODFILIALTC, CODEMPTC) REFERENCES FNTIPOCOB (CODTIPOCOB, CODFILIAL, CODEMP);

ALTER TABLE FNITPAGAR ADD CONSTRAINT FNITPAGARFKSINAL FOREIGN KEY (CODSINAL, CODEMPSN, CODFILIALSN) REFERENCES FNSINAL (CODSINAL, CODEMP, CODFILIAL) ON DELETE SET NULL;

ALTER TABLE FNITPAGAR ADD CONSTRAINT FNITPAGARFKRHEMPRE FOREIGN KEY (MATEMPR, CODFILIALEM, CODEMPEM) REFERENCES RHEMPREGADO (MATEMPR, CODFILIAL, CODEMP);

ALTER TABLE FNITRECEBER ADD CONSTRAINT FNITRECEBERFKCARTC FOREIGN KEY (CODCARTCOB, CODFILIALCB, CODEMPCB, CODBANCO, CODFILIALBO, CODEMPBO) REFERENCES FNCARTCOB (CODCARTCOB, CODFILIAL, CODEMP, CODBANCO, CODFILIALBO, CODEMPBO);

ALTER TABLE FNITRECEBER ADD CONSTRAINT FNITRECEBERFKCONTR FOREIGN KEY (CODCONTR, CODITCONTR, CODFILIALCT, CODEMPCT) REFERENCES VDITCONTRATO (CODCONTR, CODITCONTR, CODFILIAL, CODEMP);

ALTER TABLE FNITRECEBER ADD CONSTRAINT FNITRECEBERFKFNBAN FOREIGN KEY (CODBANCO, CODFILIALBO, CODEMPBO) REFERENCES FNBANCO (CODBANCO, CODFILIAL, CODEMP);

ALTER TABLE FNITRECEBER ADD CONSTRAINT FNITRECEBERFKFNCON FOREIGN KEY (NUMCONTA, CODFILIALCA, CODEMPCA) REFERENCES FNCONTA (NUMCONTA, CODFILIAL, CODEMP);

ALTER TABLE FNITRECEBER ADD CONSTRAINT FNITRECEBERFKFNPLA FOREIGN KEY (CODPLAN, CODFILIALPN, CODEMPPN) REFERENCES FNPLANEJAMENTO (CODPLAN, CODFILIAL, CODEMP);

ALTER TABLE FNITRECEBER ADD CONSTRAINT FNITRECEBERFKFNREC FOREIGN KEY (CODREC, CODFILIAL, CODEMP) REFERENCES FNRECEBER (CODREC, CODFILIAL, CODEMP);

ALTER TABLE FNITRECEBER ADD CONSTRAINT FNITRECEBERFKFNTIP FOREIGN KEY (CODTIPOCOB, CODFILIALTC, CODEMPTC) REFERENCES FNTIPOCOB (CODTIPOCOB, CODFILIAL, CODEMP);

ALTER TABLE FNITRECEBER ADD CONSTRAINT FNITRECEBERFKSINAL FOREIGN KEY (CODSINAL, CODEMPSN, CODFILIALSN) REFERENCES FNSINAL (CODSINAL, CODEMP, CODFILIAL) ON DELETE SET NULL;

ALTER TABLE FNITRECEBER ADD CONSTRAINT FNITRECEBERFKRHEMP FOREIGN KEY (MATEMPR, CODFILIALEM, CODEMPEM) REFERENCES RHEMPREGADO (MATEMPR, CODFILIAL, CODEMP);

ALTER TABLE FNITRENEGREC ADD CONSTRAINT FNITRENEGRECFKFNITRECEBER FOREIGN KEY (CODREC, NPARCITREC, CODFILIALIR, CODEMPIR) REFERENCES FNITRECEBER (CODREC, NPARCITREC, CODFILIAL, CODEMP);

ALTER TABLE FNITTBJUROS ADD CONSTRAINT FNITTBJUROSFKFNTBJ FOREIGN KEY (CODTBJ, CODFILIAL, CODEMP) REFERENCES FNTBJUROS (CODTBJ, CODFILIAL, CODEMP);

ALTER TABLE FNLANCA ADD CONSTRAINT FNLANCAFKCPFORNECE FOREIGN KEY (CODFOR, CODFILIALFR, CODEMPFR) REFERENCES CPFORNECED (CODFOR, CODFILIAL, CODEMP);

ALTER TABLE FNLANCA ADD CONSTRAINT FNLANCAFKFNITPAGAR FOREIGN KEY (CODPAG, NPARCPAG, CODFILIALPG, CODEMPPG) REFERENCES FNITPAGAR (CODPAG, NPARCPAG, CODFILIAL, CODEMP);

ALTER TABLE FNLANCA ADD CONSTRAINT FNLANCAFKFNITRECEB FOREIGN KEY (CODREC, NPARCITREC, CODFILIALRC, CODEMPRC) REFERENCES FNITRECEBER (CODREC, NPARCITREC, CODFILIAL, CODEMP);

ALTER TABLE FNLANCA ADD CONSTRAINT FNLANCAFKFNPAGTOCO FOREIGN KEY (CODPCOMI, CODFILIALCI, CODEMPCI) REFERENCES FNPAGTOCOMI (CODPCOMI, CODFILIAL, CODEMP);

ALTER TABLE FNLANCA ADD CONSTRAINT FNLANCAFKFNPLANEJA FOREIGN KEY (CODPLAN, CODFILIALPN, CODEMPPN) REFERENCES FNPLANEJAMENTO (CODPLAN, CODFILIAL, CODEMP);

ALTER TABLE FNLANCA ADD CONSTRAINT FNLANCAFKFNSINAL FOREIGN KEY (CODSINAL, CODEMPSN, CODFILIALSN) REFERENCES FNSINAL (CODSINAL, CODEMP, CODFILIAL) ON DELETE SET NULL;

ALTER TABLE FNLANCA ADD CONSTRAINT FNLANCAFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE FNLANCA ADD CONSTRAINT FNLANCAFKVDCLIENTE FOREIGN KEY (CODCLI, CODFILIALCL, CODEMPCL) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE FNLANCA ADD CONSTRAINT FNLANCAFKVDCOMISSA FOREIGN KEY (CODCOMI, CODFILIAL, CODEMP) REFERENCES VDCOMISSAO (CODCOMI, CODFILIAL, CODEMP);

ALTER TABLE FNLIBCRED ADD CONSTRAINT FNLIBCREDFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE FNLIBCRED ADD CONSTRAINT FNLIBCREDFKSGUSUAR FOREIGN KEY (IDUSU, CODFILIALUS, CODEMPUS) REFERENCES SGUSUARIO (IDUSU, CODFILIAL, CODEMP);

ALTER TABLE FNLIBCRED ADD CONSTRAINT FNLIBCREDFKVDCLIEN FOREIGN KEY (CODCLI, CODFILIALCL, CODEMPCL) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE FNLIBCRED ADD CONSTRAINT VDLIBCREDFKVDVENDA FOREIGN KEY (CODVENDA, TIPOVENDA, CODFILIALVD, CODEMPVD) REFERENCES VDVENDA (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP);

ALTER TABLE FNMODBOLETO ADD CONSTRAINT FNMODBOLETOFKFNCON FOREIGN KEY (NUMCONTA, CODFILIALCC, CODEMPCC) REFERENCES FNCONTA (NUMCONTA, CODFILIAL, CODEMP);

ALTER TABLE FNMOEDA ADD CONSTRAINT FNMOEDAFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE FNMOVIMENTO ADD CONSTRAINT FNMOVIMENTOFKFNITPAG FOREIGN KEY (CODPAG, NPARCPAG, CODFILIALPG, CODEMPPG) REFERENCES FNITPAGAR (CODPAG, NPARCPAG, CODFILIAL, CODEMP);

ALTER TABLE FNMOVIMENTO ADD CONSTRAINT FNMOVIMENTOFKFNITREC FOREIGN KEY (CODREC, NPARCITREC, CODFILIALRC, CODEMPRC) REFERENCES FNITRECEBER (CODREC, NPARCITREC, CODFILIAL, CODEMP);

ALTER TABLE FNPAGAR ADD CONSTRAINT FNPAGARFKCPCOMPRA FOREIGN KEY (CODCOMPRA, CODFILIALCP, CODEMPCP) REFERENCES CPCOMPRA (CODCOMPRA, CODFILIAL, CODEMP);

ALTER TABLE FNPAGAR ADD CONSTRAINT FNPAGARFKCPFORNECE FOREIGN KEY (CODFOR, CODFILIALFR, CODEMPFR) REFERENCES CPFORNECED (CODFOR, CODFILIAL, CODEMP);

ALTER TABLE FNPAGAR ADD CONSTRAINT FNPAGARFKFNBANCO FOREIGN KEY (CODBANCO, CODFILIALBO, CODEMPBO) REFERENCES FNBANCO (CODBANCO, CODFILIAL, CODEMP);

ALTER TABLE FNPAGAR ADD CONSTRAINT FNPAGARFKFNCC FOREIGN KEY (CODCC, ANOCC, CODFILIALCC, CODEMPCC) REFERENCES FNCC (CODCC, ANOCC, CODFILIAL, CODEMP);

ALTER TABLE FNPAGAR ADD CONSTRAINT FNPAGARFKFNCONTA FOREIGN KEY (NUMCONTA, CODFILIALCA, CODEMPCA) REFERENCES FNCONTA (NUMCONTA, CODFILIAL, CODEMP);

ALTER TABLE FNPAGAR ADD CONSTRAINT FNPAGARFKFNPLANEJ FOREIGN KEY (CODPLAN, CODFILIALPN, CODEMPPN) REFERENCES FNPLANEJAMENTO (CODPLAN, CODFILIAL, CODEMP);

ALTER TABLE FNPAGAR ADD CONSTRAINT FNPAGARFKFNPLANOPA FOREIGN KEY (CODPLANOPAG, CODFILIALPG, CODEMPPG) REFERENCES FNPLANOPAG (CODPLANOPAG, CODFILIAL, CODEMP);

ALTER TABLE FNPAGAR ADD CONSTRAINT FNPAGARFKFNTIPOC FOREIGN KEY (CODTIPOCOB, CODFILIALTC, CODEMPTC) REFERENCES FNTIPOCOB (CODTIPOCOB, CODFILIAL, CODEMP);

ALTER TABLE FNPAGAR ADD CONSTRAINT FNPAGARFKORDCOMPRA FOREIGN KEY (CODEMPOC, CODFILIALOC, CODORDCP) REFERENCES CPORDCOMPRA (CODEMP, CODFILIAL, CODORDCP) ON DELETE CASCADE;

ALTER TABLE FNPAGAR ADD CONSTRAINT FNPAGARFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE FNPAGCHEQ ADD CONSTRAINT FNPAGCHEQFKCHEQUE FOREIGN KEY (SEQCHEQ, CODFILIALCH, CODEMPCH) REFERENCES FNCHEQUE (SEQCHEQ, CODFILIAL, CODEMP);

ALTER TABLE FNPAGCHEQ ADD CONSTRAINT FNPAGCHEQFKFNITPAG FOREIGN KEY (CODPAG, NPARCPAG, CODFILIAL, CODEMP) REFERENCES FNITPAGAR (CODPAG, NPARCPAG, CODFILIAL, CODEMP);

ALTER TABLE FNPAGTOCOMI ADD CONSTRAINT FNPAGTOCOMIFKFNCON FOREIGN KEY (NUMCONTA, CODFILIAL, CODEMP) REFERENCES FNCONTA (NUMCONTA, CODFILIAL, CODEMP);

ALTER TABLE FNPAGTOCOMI ADD CONSTRAINT FNPAGTOCOMIFKFNPLA FOREIGN KEY (CODPLAN, CODFILIALPN, CODEMPPN) REFERENCES FNPLANEJAMENTO (CODPLAN, CODFILIAL, CODEMP);

ALTER TABLE FNPAGTOCOMI ADD CONSTRAINT FNPAGTOCOMIFKSGFIL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE FNPARCPAG ADD CONSTRAINT FNPARCPAGFKFNPLANO FOREIGN KEY (CODPLANOPAG, CODFILIAL, CODEMP) REFERENCES FNPLANOPAG (CODPLANOPAG, CODFILIAL, CODEMP);

ALTER TABLE FNPLANEJAMENTO ADD CONSTRAINT FNPLANEJAMFKFNHIST FOREIGN KEY (CODHIST, CODFILIALHP, CODEMPHP) REFERENCES FNHISTPAD (CODHIST, CODFILIAL, CODEMP);

ALTER TABLE FNPLANEJAMENTO ADD CONSTRAINT FNPLANEJAMFKFNPLAN FOREIGN KEY (CODSUBPLAN, CODFILIAL, CODEMP) REFERENCES FNPLANEJAMENTO (CODPLAN, CODFILIAL, CODEMP);

ALTER TABLE FNPLANEJAMENTO ADD CONSTRAINT FNPLANEJAMFKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE FNPLANOPAG ADD CONSTRAINT FNPLANOPAGFKFNCC FOREIGN KEY (CODCC, ANOCC, CODFILIALCC, CODEMPCC) REFERENCES FNCC (CODCC, ANOCC, CODFILIAL, CODEMP);

ALTER TABLE FNPLANOPAG ADD CONSTRAINT FNPLANOPAGFKFNCONT FOREIGN KEY (NUMCONTA, CODFILIALCA, CODEMPCA) REFERENCES FNCONTA (NUMCONTA, CODFILIAL, CODEMP);

ALTER TABLE FNPLANOPAG ADD CONSTRAINT FNPLANOPAGFKFNPLAN FOREIGN KEY (CODPLAN, CODFILIALPN, CODEMPPN) REFERENCES FNPLANEJAMENTO (CODPLAN, CODFILIAL, CODEMP);

ALTER TABLE FNPLANOPAG ADD CONSTRAINT FNPLANOPAGFKFNTBJU FOREIGN KEY (CODTBJ, CODFILIALTBJ, CODEMPTBJ) REFERENCES FNTBJUROS (CODTBJ, CODFILIAL, CODEMP);

ALTER TABLE FNPLANOPAG ADD CONSTRAINT FNPLANOPAGFKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE FNRECEBER ADD CONSTRAINT FNRECEBERFKFNBANCO FOREIGN KEY (CODBANCO, CODFILIALBO, CODEMPBO) REFERENCES FNBANCO (CODBANCO, CODFILIAL, CODEMP);

ALTER TABLE FNRECEBER ADD CONSTRAINT FNRECEBERFKFNCARTC FOREIGN KEY (CODCARTCOB, CODFILIALCB, CODEMPCB, CODBANCO, CODFILIALBO, CODEMPBO) REFERENCES FNCARTCOB (CODCARTCOB, CODFILIAL, CODEMP, CODBANCO, CODFILIALBO, CODEMPBO);

ALTER TABLE FNRECEBER ADD CONSTRAINT FNRECEBERFKFNCC FOREIGN KEY (CODCC, ANOCC, CODFILIALCC, CODEMPCC) REFERENCES FNCC (CODCC, ANOCC, CODFILIAL, CODEMP);

ALTER TABLE FNRECEBER ADD CONSTRAINT FNRECEBERFKFNCONTA FOREIGN KEY (NUMCONTA, CODFILIALCA, CODEMPCA) REFERENCES FNCONTA (NUMCONTA, CODFILIAL, CODEMP);

ALTER TABLE FNRECEBER ADD CONSTRAINT FNRECEBERFKFNPLANEJ FOREIGN KEY (CODPLAN, CODFILIALPN, CODEMPPN) REFERENCES FNPLANEJAMENTO (CODPLAN, CODFILIAL, CODEMP);

ALTER TABLE FNRECEBER ADD CONSTRAINT FNRECEBERFKFNPLANO FOREIGN KEY (CODPLANOPAG, CODFILIALPG, CODEMPPG) REFERENCES FNPLANOPAG (CODPLANOPAG, CODFILIAL, CODEMP);

ALTER TABLE FNRECEBER ADD CONSTRAINT FNRECEBERFKFNRENEGREC FOREIGN KEY (CODRENEGREC, CODFILIALRR, CODEMPRR) REFERENCES FNRENEGREC (CODRENEGREC, CODFILIAL, CODEMP);

ALTER TABLE FNRECEBER ADD CONSTRAINT FNRECEBERFKFNTIPOC FOREIGN KEY (CODTIPOCOB, CODFILIALTC, CODEMPTC) REFERENCES FNTIPOCOB (CODTIPOCOB, CODFILIAL, CODEMP);

ALTER TABLE FNRECEBER ADD CONSTRAINT FNRECEBERFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE FNRECEBER ADD CONSTRAINT FNRECEBERFKVDCLIEN FOREIGN KEY (CODCLI, CODFILIALCL, CODEMPCL) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE FNRECEBER ADD CONSTRAINT FNRECEBERFKVDVENDA FOREIGN KEY (CODVENDA, TIPOVENDA, CODFILIALVA, CODEMPVA) REFERENCES VDVENDA (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP);

ALTER TABLE FNRECEBER ADD CONSTRAINT FNRECEBERFKVDVENDE FOREIGN KEY (CODVEND, CODFILIALVD, CODEMPVD) REFERENCES VDVENDEDOR (CODVEND, CODFILIAL, CODEMP);

ALTER TABLE FNRENEGREC ADD CONSTRAINT FNRENEGRECFKFNPLANOPAG FOREIGN KEY (CODPLANOPAG, CODFILIALPG, CODEMPPG) REFERENCES FNPLANOPAG (CODPLANOPAG, CODFILIAL, CODEMP) ON DELETE CASCADE;

ALTER TABLE FNRESTRICAO ADD CONSTRAINT FNRESTRICAOFKFNTIP FOREIGN KEY (CODTPRESTR, CODFILIAL, CODEMP) REFERENCES FNTIPORESTR (CODTPRESTR, CODFILIAL, CODEMP);

ALTER TABLE FNRESTRICAO ADD CONSTRAINT FNRESTRICAOFKVDCLI FOREIGN KEY (CODCLI, CODFILIAL, CODEMP) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE FNSALDOLANCA ADD CONSTRAINT FNSALDOLANCAFKFNPL FOREIGN KEY (CODPLAN, CODFILIALPN, CODEMPPN) REFERENCES FNPLANEJAMENTO (CODPLAN, CODFILIAL, CODEMP);

ALTER TABLE FNSALDOLANCA ADD CONSTRAINT FNSALDOLANCAFKSGFI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE FNSUBLANCA ADD CONSTRAINT FNSUBLANCAFKCPFORN FOREIGN KEY (CODFOR, CODFILIALFR, CODEMPFR) REFERENCES CPFORNECED (CODFOR, CODFILIAL, CODEMP);

ALTER TABLE FNSUBLANCA ADD CONSTRAINT FNSUBLANCAFKCTR FOREIGN KEY (CODCONTR, CODITCONTR, CODFILIALCT, CODEMPCT) REFERENCES VDITCONTRATO (CODCONTR, CODITCONTR, CODFILIAL, CODEMP);

ALTER TABLE FNSUBLANCA ADD CONSTRAINT FNSUBLANCAFKFNCC FOREIGN KEY (CODCC, ANOCC, CODFILIALCC, CODEMPCC) REFERENCES FNCC (CODCC, ANOCC, CODFILIAL, CODEMP);

ALTER TABLE FNSUBLANCA ADD CONSTRAINT FNSUBLANCAFKFNITPA FOREIGN KEY (CODPAG, NPARCPAG, CODFILIALPG, CODEMPPG) REFERENCES FNITPAGAR (CODPAG, NPARCPAG, CODFILIAL, CODEMP);

ALTER TABLE FNSUBLANCA ADD CONSTRAINT FNSUBLANCAFKFNITRE FOREIGN KEY (CODREC, NPARCITREC, CODFILIALRC, CODEMPRC) REFERENCES FNITRECEBER (CODREC, NPARCITREC, CODFILIAL, CODEMP);

ALTER TABLE FNSUBLANCA ADD CONSTRAINT FNSUBLANCAFKFNLANC FOREIGN KEY (CODLANCA, CODFILIAL, CODEMP) REFERENCES FNLANCA (CODLANCA, CODFILIAL, CODEMP);

ALTER TABLE FNSUBLANCA ADD CONSTRAINT FNSUBLANCAFKFNPLAN FOREIGN KEY (CODPLAN, CODFILIALPN, CODEMPPN) REFERENCES FNPLANEJAMENTO (CODPLAN, CODFILIAL, CODEMP);

ALTER TABLE FNSUBLANCA ADD CONSTRAINT FNSUBLANCAFKVDCLIE FOREIGN KEY (CODCLI, CODFILIALCL, CODEMPCL) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE FNSUBLANCA ADD CONSTRAINT FNSUBLANCAFKRHEMPR FOREIGN KEY (MATEMPR, CODFILIALEM, CODEMPEM) REFERENCES RHEMPREGADO (MATEMPR, CODFILIAL, CODEMP);

ALTER TABLE FNTBJUROS ADD CONSTRAINT FNTBJUROSFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE FNTIPOCOB ADD CONSTRAINT FNTIPOCOBFKFNTALON FOREIGN KEY (NUMCONTA, SEQTALAO, CODFILIAL, CODEMP) REFERENCES FNTALAOCHEQ (NUMCONTA, SEQTALAO, CODFILIAL, CODEMP);

ALTER TABLE FNTIPOCOB ADD CONSTRAINT FNTIPOCOBFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE LFCLFISCAL ADD CONSTRAINT LFCLFISCALFKLFNATOPER FOREIGN KEY (CODIGO, CST) REFERENCES SPNATOPER (CODIGO, CST);

ALTER TABLE LFCLFISCAL ADD CONSTRAINT LFCLFISCALFKLFNCM FOREIGN KEY (CODNCM, CODNBM) REFERENCES LFNCMNBM (CODNCM, CODNBM);

ALTER TABLE LFCLFISCAL ADD CONSTRAINT LFCLFISCALFKLFREGR FOREIGN KEY (CODREGRA, CODFILIALRA, CODEMPRA) REFERENCES LFREGRAFISCAL (CODREGRA, CODFILIAL, CODEMP);

ALTER TABLE LFCLFISCAL ADD CONSTRAINT LFCLFISCALFKLFSERVICO FOREIGN KEY (CODSERV) REFERENCES LFSERVICO (CODSERV);

ALTER TABLE LFCLFISCAL ADD CONSTRAINT LFCLFISCALFKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE LFCSOSN ADD CONSTRAINT LFCSOSNFKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE LFFRETE ADD CONSTRAINT LFFRETEFKEQEXPEDICAO FOREIGN KEY (TICKETEX, CODFILIALEX, CODEMPEX) REFERENCES EQEXPEDICAO (TICKET, CODFILIAL, CODEMP);

ALTER TABLE LFFRETE ADD CONSTRAINT LFFRETEFKEQRECMERC FOREIGN KEY (TICKET, CODFILIALRM, CODEMPRM) REFERENCES EQRECMERC (TICKET, CODFILIAL, CODEMP);

ALTER TABLE LFFRETE ADD CONSTRAINT LFFRETEFKEQTIPOMOV FOREIGN KEY (CODTIPOMOV, CODFILIALTM, CODEMPTM) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE LFFRETE ADD CONSTRAINT LFFRETEFKFNPAGAR FOREIGN KEY (CODPAG, CODFILIALPA, CODEMPPA) REFERENCES FNPAGAR (CODPAG, CODFILIAL, CODEMP);

ALTER TABLE LFFRETE ADD CONSTRAINT LFFRETEFKLFNATOP FOREIGN KEY (CODNAT, CODFILIALNT, CODEMPNT) REFERENCES LFNATOPER (CODNAT, CODFILIAL, CODEMP);

ALTER TABLE LFFRETE ADD CONSTRAINT LFFRETEFKSGUNIFCODD FOREIGN KEY (CODDESTINAT, CODFILIALDE, CODEMPDE) REFERENCES SGUNIFCOD (CODUNIFCOD, CODFILIAL, CODEMP);

ALTER TABLE LFFRETE ADD CONSTRAINT LFFRETEFKSGUNIFCODR FOREIGN KEY (CODREMET, CODFILIALRE, CODEMPRE) REFERENCES SGUNIFCOD (CODUNIFCOD, CODFILIAL, CODEMP);

ALTER TABLE LFFRETE ADD CONSTRAINT LFFRETEFKTRATTRIB FOREIGN KEY (CODTRATTRIB, CODFILIALTT, CODEMPTT) REFERENCES LFTRATTRIB (CODTRATTRIB, CODFILIAL, CODEMP);

ALTER TABLE LFFRETE ADD CONSTRAINT LFFRETEFKVDTRANS FOREIGN KEY (CODTRAN, CODFILIALTN, CODEMPTN) REFERENCES VDTRANSP (CODTRAN, CODFILIAL, CODEMP);

ALTER TABLE LFFRETECOMPRA ADD CONSTRAINT CPFRETEFKCPCOMPRA FOREIGN KEY (CODCOMPRA, CODFILIAL, CODEMP) REFERENCES CPCOMPRA (CODCOMPRA, CODFILIAL, CODEMP);

ALTER TABLE LFFRETECOMPRA ADD CONSTRAINT CPFRETEFKLFFRETE FOREIGN KEY (CODFRETE, CODFILIAL, CODEMP) REFERENCES LFFRETE (CODFRETE, CODFILIAL, CODEMP);

ALTER TABLE LFFRETEVENDA ADD CONSTRAINT LFFRETEFKLFFRETE FOREIGN KEY (CODFRETE, CODFILIAL, CODEMP) REFERENCES LFFRETE (CODFRETE, CODFILIAL, CODEMP);

ALTER TABLE LFFRETEVENDA ADD CONSTRAINT VDFRETEVEFKVDVENDA FOREIGN KEY (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP) REFERENCES VDVENDA (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP);

ALTER TABLE LFITCALCCUSTO ADD CONSTRAINT LFITCALCCFKLFCALCC FOREIGN KEY (CODCALC, CODFILIAL, CODEMP) REFERENCES LFCALCCUSTO (CODCALC, CODFILIAL, CODEMP);

ALTER TABLE LFITCLFISCAL ADD CONSTRAINT LFITCLFISCALFKCSOSN FOREIGN KEY (CSOSN, CODFILIALCN, CODEMPCN) REFERENCES LFCSOSN (CSOSN, CODFILIAL, CODEMP);

ALTER TABLE LFITCLFISCAL ADD CONSTRAINT LFITCLFISCALFKEQTIPOMOV FOREIGN KEY (CODTIPOMOV, CODFILIALTM, CODEMPTM) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE LFITCLFISCAL ADD CONSTRAINT LFITCLFISCALFKLFCL FOREIGN KEY (CODFISC, CODFILIAL, CODEMP) REFERENCES LFCLFISCAL (CODFISC, CODFILIAL, CODEMP);

ALTER TABLE LFITCLFISCAL ADD CONSTRAINT LFITCLFISCALFKLFME FOREIGN KEY (CODMENS, CODFILIALME, CODEMPME) REFERENCES LFMENSAGEM (CODMENS, CODFILIAL, CODEMP);

ALTER TABLE LFITCLFISCAL ADD CONSTRAINT LFITCLFISCALFKLFREGRAFISCAL FOREIGN KEY (CODREGRA, CODFILIALRA, CODEMPRA) REFERENCES LFREGRAFISCAL (CODREGRA, CODFILIAL, CODEMP);

ALTER TABLE LFITCLFISCAL ADD CONSTRAINT LFITCLFISCALFKLFTI FOREIGN KEY (CODFISCCLI, CODFILIALFC, CODEMPFC) REFERENCES LFTIPOFISCCLI (CODFISCCLI, CODFILIAL, CODEMP);

ALTER TABLE LFITCLFISCAL ADD CONSTRAINT LFITCLFISCALFKLFTR FOREIGN KEY (CODTRATTRIB, CODFILIALTT, CODEMPTT) REFERENCES LFTRATTRIB (CODTRATTRIB, CODFILIAL, CODEMP);

ALTER TABLE LFITCLFISCAL ADD CONSTRAINT LFITCLFISCALFKSGUF FOREIGN KEY (SIGLAUF, CODPAIS) REFERENCES SGUF (SIGLAUF, CODPAIS);

ALTER TABLE LFITCLFISCAL ADD CONSTRAINT LFITCLSFISCALFKLFCALCCUSTO FOREIGN KEY (CODCALC, CODFILIALCC, CODEMPCC) REFERENCES LFCALCCUSTO (CODCALC, CODFILIAL, CODEMP);

ALTER TABLE LFITCLFISCAL ADD CONSTRAINT LFITCLSFISCALFKLFSITTRIBCOF FOREIGN KEY (CODSITTRIBCOF, IMPSITTRIBCOF, CODFILIALSC, CODEMPSC) REFERENCES LFSITTRIB (CODSITTRIB, IMPSITTRIB, CODFILIAL, CODEMP);

ALTER TABLE LFITCLFISCAL ADD CONSTRAINT LFITCLSFISCALFKLFSITTRIBIPI FOREIGN KEY (CODSITTRIBIPI, IMPSITTRIBIPI, CODFILIALSI, CODEMPSI) REFERENCES LFSITTRIB (CODSITTRIB, IMPSITTRIB, CODFILIAL, CODEMP);

ALTER TABLE LFITCLFISCAL ADD CONSTRAINT LFITCLSFISCALFKLFSITTRIBISS FOREIGN KEY (CODSITTRIBISS, IMPSITTRIBISS, CODFILIALIS, CODEMPIS) REFERENCES LFSITTRIB (CODSITTRIB, IMPSITTRIB, CODFILIAL, CODEMP);

ALTER TABLE LFITCLFISCAL ADD CONSTRAINT LFITCLSFISCALFKLFSITTRIBPIS FOREIGN KEY (CODSITTRIBPIS, IMPSITTRIBPIS, CODFILIALSP, CODEMPSP) REFERENCES LFSITTRIB (CODSITTRIB, IMPSITTRIB, CODFILIAL, CODEMP);

ALTER TABLE LFITCOMPRA ADD CONSTRAINT LFITCOMPRAFKCPITCOMPRA FOREIGN KEY (CODCOMPRA, CODITCOMPRA, CODFILIAL, CODEMP) REFERENCES CPITCOMPRA (CODCOMPRA, CODITCOMPRA, CODFILIAL, CODEMP) ON UPDATE CASCADE ON DELETE CASCADE;

ALTER TABLE LFITNATOPER ADD CONSTRAINT LFITNATOPERFKLFTAB FOREIGN KEY (UFTI, CODFILIALTI, CODEMPTI) REFERENCES LFTABICMS (UFTI, CODFILIAL, CODEMP);

ALTER TABLE LFITREGRAFISCAL ADD CONSTRAINT LFITREGRAFISFKEQTI FOREIGN KEY (CODTIPOMOV, CODFILIALTM, CODEMPTM) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE LFITREGRAFISCAL ADD CONSTRAINT LFITREGRAFISFKLFNA FOREIGN KEY (CODNAT, CODFILIAL, CODEMP) REFERENCES LFNATOPER (CODNAT, CODFILIAL, CODEMP);

ALTER TABLE LFITREGRAFISCAL ADD CONSTRAINT LFITREGRAFISFKLFRE FOREIGN KEY (CODREGRA, CODFILIAL, CODEMP) REFERENCES LFREGRAFISCAL (CODREGRA, CODFILIAL, CODEMP);

ALTER TABLE LFITVENDA ADD CONSTRAINT LFITVENDAFKLFSITTRIBCOF FOREIGN KEY (CODSITTRIBCOF, IMPSITTRIBCOF, CODFILIALSC, CODEMPSC) REFERENCES LFSITTRIB (CODSITTRIB, IMPSITTRIB, CODFILIAL, CODEMP);

ALTER TABLE LFITVENDA ADD CONSTRAINT LFITVENDAFKLFSITTRIBIPI FOREIGN KEY (CODSITTRIBIPI, IMPSITTRIBIPI, CODFILIALSI, CODEMPSI) REFERENCES LFSITTRIB (CODSITTRIB, IMPSITTRIB, CODFILIAL, CODEMP);

ALTER TABLE LFITVENDA ADD CONSTRAINT LFITVENDAFKLFSITTRIBPIS FOREIGN KEY (CODSITTRIBPIS, IMPSITTRIBPIS, CODFILIALSP, CODEMPSP) REFERENCES LFSITTRIB (CODSITTRIB, IMPSITTRIB, CODFILIAL, CODEMP);

ALTER TABLE LFITVENDA ADD CONSTRAINT LFITVENDAFKVDITVENDA FOREIGN KEY (CODVENDA, CODITVENDA, TIPOVENDA, CODFILIAL, CODEMP) REFERENCES VDITVENDA (CODVENDA, CODITVENDA, TIPOVENDA, CODFILIAL, CODEMP) ON UPDATE CASCADE ON DELETE CASCADE;

ALTER TABLE LFLIVROFISCAL ADD CONSTRAINT LFLIVROFISCALFKLFN FOREIGN KEY (CODNAT, CODFILIALNT, CODEMPNT) REFERENCES LFNATOPER (CODNAT, CODFILIAL, CODEMP);

ALTER TABLE LFLIVROFISCAL ADD CONSTRAINT LFLIVROFISCALFKSGF FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE LFMODDOCFISC ADD CONSTRAINT LFMODDOCFISCFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE LFMODNOTA ADD CONSTRAINT LFMODNOTAFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE LFNATOPER ADD CONSTRAINT LFNATOPERFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE LFNCMNBM ADD CONSTRAINT LFNCMNBMFKLFNBM FOREIGN KEY (CODNBM) REFERENCES LFNBM (CODNBM);

ALTER TABLE LFNCMNBM ADD CONSTRAINT LFNCMNBMFKLFNCM FOREIGN KEY (CODNCM) REFERENCES LFNCM (CODNCM);

ALTER TABLE LFREGRAFISCAL ADD CONSTRAINT LFREGRAFISCALFKSGF FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE LFSERIE ADD CONSTRAINT LFSERIEFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE LFSITTRIB ADD CONSTRAINT LFSITTRIBFKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE LFTIPOFISCCLI ADD CONSTRAINT LFTIPOFISCCLIFKEQTIPOMOV FOREIGN KEY (CODTIPOMOVOC, CODFILIALOC, CODEMPOC) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE LFTRATTRIB ADD CONSTRAINT LFTRATTRIBFKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE MGPRODUTO ADD CONSTRAINT MGPRODUTOFKPROD FOREIGN KEY (CODPROD, CODFILIAL, CODEMP) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE NECONTINGENCIA ADD CONSTRAINT NECONTINGENCFKSGFI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE PEBATIDA ADD CONSTRAINT PEBATIDAFKEMPREGAD FOREIGN KEY (MATEMPR, CODFILIALEP, CODEMPEP) REFERENCES RHEMPREGADO (MATEMPR, CODFILIAL, CODEMP);

ALTER TABLE PEFALTA ADD CONSTRAINT PEFALTAFKEMPREGADO FOREIGN KEY (MATEMPR, CODFILIALEP, CODEMPEP) REFERENCES RHEMPREGADO (MATEMPR, CODFILIAL, CODEMP);

ALTER TABLE PPDISTRIB ADD CONSTRAINT PPDISTRIBFKPPESTFA FOREIGN KEY (CODPROD, SEQEST, SEQEF, CODFILIAL, CODEMP, CODFASE, CODFILIALFS, CODEMPFS) REFERENCES PPESTRUFASE (CODPROD, SEQEST, SEQEF, CODFILIAL, CODEMP, CODFASE, CODFILIALFS, CODEMPFS);

ALTER TABLE PPDISTRIB ADD CONSTRAINT PPDISTRIBFKPPESTRU FOREIGN KEY (CODPRODDE, SEQESTDE, CODFILIALDE, CODEMPDE) REFERENCES PPESTRUTURA (CODPROD, SEQEST, CODFILIAL, CODEMP);

ALTER TABLE PPESTRUANALISE ADD CONSTRAINT PPESTRUANALISEFKESTRUFASE FOREIGN KEY (CODPROD, SEQEST, SEQEF, CODFILIAL, CODEMP, CODFASE, CODFILIALFS, CODEMPFS) REFERENCES PPESTRUFASE (CODPROD, SEQEST, SEQEF, CODFILIAL, CODEMP, CODFASE, CODFILIALFS, CODEMPFS);

ALTER TABLE PPESTRUANALISE ADD CONSTRAINT PPESTRUANALISEFKTIPOANALISE FOREIGN KEY (CODTPANALISE, CODFILIALTA, CODEMPTA) REFERENCES PPTIPOANALISE (CODTPANALISE, CODFILIAL, CODEMP);

ALTER TABLE PPESTRUFASE ADD CONSTRAINT PPESTRUFASEFKESTRU FOREIGN KEY (CODPROD, SEQEST, CODFILIAL, CODEMP) REFERENCES PPESTRUTURA (CODPROD, SEQEST, CODFILIAL, CODEMP) ON DELETE CASCADE;

ALTER TABLE PPESTRUFASE ADD CONSTRAINT PPESTRUFASEFKPPEST FOREIGN KEY (CODPROD, SEQEST, CODFILIAL, CODEMP) REFERENCES PPESTRUTURA (CODPROD, SEQEST, CODFILIAL, CODEMP);

ALTER TABLE PPESTRUFASE ADD CONSTRAINT PPESTRUFASEFKPPFAS FOREIGN KEY (CODFASE, CODFILIALFS, CODEMPFS) REFERENCES PPFASE (CODFASE, CODFILIAL, CODEMP);

ALTER TABLE PPESTRUFASE ADD CONSTRAINT PPESTRUFASEFKPPTIP FOREIGN KEY (CODTPREC, CODFILIALTR, CODEMPTR) REFERENCES PPTIPOREC (CODTPREC, CODFILIAL, CODEMP);

ALTER TABLE PPESTRUFASE ADD CONSTRAINT PPESTRUFASEFKSGFIL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE PPESTRUTURA ADD CONSTRAINT PPESTRUTURAFKEQMOD FOREIGN KEY (CODMODLOTE, CODFILIALML, CODEMPML) REFERENCES EQMODLOTE (CODMODLOTE, CODFILIAL, CODEMP);

ALTER TABLE PPESTRUTURA ADD CONSTRAINT PPESTRUTURAFKEQPRO FOREIGN KEY (CODPROD, CODFILIAL, CODEMP) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE PPFASE ADD CONSTRAINT PPFASEFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE PPFOTOMTAN ADD CONSTRAINT VDFOTOMTANFKPPMETODOAN FOREIGN KEY (CODMTANALISE, CODFILIAL, CODEMP) REFERENCES PPMETODOANALISE (CODMTANALISE, CODFILIAL, CODEMP);

ALTER TABLE PPITESTRUTURA ADD CONSTRAINT PPITESTRUTURAFKEQP FOREIGN KEY (CODPRODPD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE PPITESTRUTURA ADD CONSTRAINT PPITESTRUTURAFKPPE FOREIGN KEY (CODPROD, SEQEST, SEQEF, CODFILIAL, CODEMP, CODFASE, CODFILIALFS, CODEMPFS) REFERENCES PPESTRUFASE (CODPROD, SEQEST, SEQEF, CODFILIAL, CODEMP, CODFASE, CODFILIALFS, CODEMPFS);

ALTER TABLE PPITESTRUTURASUBPROD ADD CONSTRAINT PPITESTRUTURASUBPRODFKEQP FOREIGN KEY (CODPRODPD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE PPITESTRUTURASUBPROD ADD CONSTRAINT PPITESTRUTURASUBPRODFKPPE FOREIGN KEY (CODPROD, SEQEST, SEQEF, CODFILIAL, CODEMP, CODFASE, CODFILIALFS, CODEMPFS) REFERENCES PPESTRUFASE (CODPROD, SEQEST, SEQEF, CODFILIAL, CODEMP, CODFASE, CODFILIALFS, CODEMPFS);

ALTER TABLE PPITOP ADD CONSTRAINT PPITOPFKCPCOMPRARETORNO FOREIGN KEY (CODCOMPRA, CODFILIALCP, CODEMPCP) REFERENCES CPCOMPRA (CODCOMPRA, CODFILIAL, CODEMP) ON DELETE SET NULL;

ALTER TABLE PPITOP ADD CONSTRAINT PPITOPFKEQLOTE FOREIGN KEY (CODLOTE, CODPROD, CODFILIALLE, CODEMPLE) REFERENCES EQLOTE (CODLOTE, CODPROD, CODFILIAL, CODEMP);

ALTER TABLE PPITOP ADD CONSTRAINT PPITOPFKEQPRODUTO FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE PPITOP ADD CONSTRAINT PPITOPFKPPFASE FOREIGN KEY (CODFASE, CODFILIALFS, CODEMPFS) REFERENCES PPFASE (CODFASE, CODFILIAL, CODEMP);

ALTER TABLE PPITOP ADD CONSTRAINT PPITOPFKPPOP FOREIGN KEY (CODOP, SEQOP, CODFILIAL, CODEMP) REFERENCES PPOP (CODOP, SEQOP, CODFILIAL, CODEMP);

ALTER TABLE PPITOP ADD CONSTRAINT PPITOPFKVDVENDAREMESSA FOREIGN KEY (CODVENDA, TIPOVENDA, CODFILIALVD, CODEMPVD) REFERENCES VDVENDA (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP) ON DELETE SET NULL;

ALTER TABLE PPITOP ADD CONSTRAINT PPOPFKPPOPACAOCORRET FOREIGN KEY (CODOP, SEQOP, SEQAC, CODFILIAL, CODEMP) REFERENCES PPOPACAOCORRET (CODOP, SEQOP, SEQAC, CODFILIAL, CODEMP);

ALTER TABLE PPITRETCP ADD CONSTRAINT PPITRETCPFKEQPRODUTO FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE PPITRETCP ADD CONSTRAINT PPITRETCPFKPPRETCP FOREIGN KEY (CODOP, SEQOP, CODFILIAL, CODEMP) REFERENCES PPRETCP (CODOP, SEQOP, CODFILIAL, CODEMP);

ALTER TABLE PPOP ADD CONSTRAINT PPOPFKEQALMOX FOREIGN KEY (CODALMOX, CODFILIALAX, CODEMPAX) REFERENCES EQALMOX (CODALMOX, CODFILIAL, CODEMP);

ALTER TABLE PPOP ADD CONSTRAINT PPOPFKEQLOTE FOREIGN KEY (CODLOTE, CODPROD, CODFILIALLE, CODEMPLE) REFERENCES EQLOTE (CODLOTE, CODPROD, CODFILIAL, CODEMP);

ALTER TABLE PPOP ADD CONSTRAINT PPOPFKEQOS FOREIGN KEY (TICKET, CODITRECMERC, CODITOS, CODFILIALOS, CODEMPOS) REFERENCES EQITRECMERCITOS (TICKET, CODITRECMERC, CODITOS, CODFILIAL, CODEMP);

ALTER TABLE PPOP ADD CONSTRAINT PPOPFKEQTIPOMOV FOREIGN KEY (CODTIPOMOV, CODFILIALTM, CODEMPTM) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE PPOP ADD CONSTRAINT PPOPFKITCOMPRA FOREIGN KEY (CODCOMPRA, CODITCOMPRA, CODFILIALCP, CODEMPCP) REFERENCES CPITCOMPRA (CODCOMPRA, CODITCOMPRA, CODFILIAL, CODEMP) ON UPDATE CASCADE ON DELETE SET NULL;

ALTER TABLE PPOP ADD CONSTRAINT PPOPFKPPESTRUTURA FOREIGN KEY (CODPROD, SEQEST, CODFILIALPD, CODEMPPD) REFERENCES PPESTRUTURA (CODPROD, SEQEST, CODFILIAL, CODEMP);

ALTER TABLE PPOP ADD CONSTRAINT PPOPFKPPOP FOREIGN KEY (CODOPM, SEQOPM, CODFILIALOPM, CODEMPOPM) REFERENCES PPOP (CODOP, SEQOP, CODFILIAL, CODEMP) ON DELETE SET NULL;

ALTER TABLE PPOPCQ ADD CONSTRAINT PPOPCQFKESTRUANALISE FOREIGN KEY (CODESTANALISE, CODFILIALEA, CODEMPEA) REFERENCES PPESTRUANALISE (CODESTANALISE, CODFILIAL, CODEMP);

ALTER TABLE PPOPCQ ADD CONSTRAINT PPOPCQFKPPOP FOREIGN KEY (CODOP, SEQOP, CODFILIAL, CODEMP) REFERENCES PPOP (CODOP, SEQOP, CODFILIAL, CODEMP);

ALTER TABLE PPOPCQ ADD CONSTRAINT PPOPCQFKPPOPACAOCORRET FOREIGN KEY (CODOP, SEQOP, SEQAC, CODFILIAL, CODEMP) REFERENCES PPOPACAOCORRET (CODOP, SEQOP, SEQAC, CODFILIAL, CODEMP);

ALTER TABLE PPOPENTRADA ADD CONSTRAINT PPOPENTRADAFKPPOP FOREIGN KEY (CODOP, SEQOP, CODFILIAL, CODEMP) REFERENCES PPOP (CODOP, SEQOP, CODFILIAL, CODEMP);

ALTER TABLE PPOPFASE ADD CONSTRAINT PPOPFASEFKPPFASE FOREIGN KEY (CODFASE, CODFILIALFS, CODEMPFS) REFERENCES PPFASE (CODFASE, CODFILIAL, CODEMP);

ALTER TABLE PPOPFASE ADD CONSTRAINT PPOPFASEFKPPOP FOREIGN KEY (CODOP, SEQOP, CODFILIAL, CODEMP) REFERENCES PPOP (CODOP, SEQOP, CODFILIAL, CODEMP) ON DELETE CASCADE;

ALTER TABLE PPOPFASE ADD CONSTRAINT PPOPFASEFKPPRECURS FOREIGN KEY (CODRECP, CODFILIALRP, CODEMPRP) REFERENCES PPRECURSO (CODRECP, CODFILIAL, CODEMP);

ALTER TABLE PPOPFASE ADD CONSTRAINT PPOPFASEFKPPTIPORE FOREIGN KEY (CODTPREC, CODFILIALTR, CODEMPTR) REFERENCES PPTIPOREC (CODTPREC, CODFILIAL, CODEMP);

ALTER TABLE PPOPITORC ADD CONSTRAINT PPOPITORCFKITORC FOREIGN KEY (CODORC, CODITORC, TIPOORC, CODFILIALOC, CODEMPOC) REFERENCES VDITORCAMENTO (CODORC, CODITORC, TIPOORC, CODFILIAL, CODEMP);

ALTER TABLE PPOPITORC ADD CONSTRAINT PPOPITORCFKPPOP FOREIGN KEY (CODOP, SEQOP, CODFILIAL, CODEMP) REFERENCES PPOP (CODOP, SEQOP, CODFILIAL, CODEMP) ON DELETE CASCADE;

ALTER TABLE PPOPSUBPROD ADD CONSTRAINT PPOPSUBPRODFKEQLOTE FOREIGN KEY (CODLOTE, CODPROD, CODFILIALLE, CODEMPLE) REFERENCES EQLOTE (CODLOTE, CODPROD, CODFILIAL, CODEMP);

ALTER TABLE PPOPSUBPROD ADD CONSTRAINT PPOPSUBPRODFKEQPRODUTO FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE PPOPSUBPROD ADD CONSTRAINT PPOPSUBPRODFKEQTIPOMOV FOREIGN KEY (CODTIPOMOV, CODFILIALTM, CODEMPTM) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE PPOPSUBPROD ADD CONSTRAINT PPOPSUBPRODFKPPFASE FOREIGN KEY (CODFASE, CODFILIALFS, CODEMPFS) REFERENCES PPFASE (CODFASE, CODFILIAL, CODEMP);

ALTER TABLE PPOPSUBPROD ADD CONSTRAINT PPOPSUBPRODFKPPOP FOREIGN KEY (CODOP, SEQOP, CODFILIAL, CODEMP) REFERENCES PPOP (CODOP, SEQOP, CODFILIAL, CODEMP) ON DELETE CASCADE;

ALTER TABLE PPPROCESSAOPTMP ADD CONSTRAINT PPPROCESSFKITORC FOREIGN KEY (CODORC, CODITORC, TIPOORC, CODFILIAL, CODEMP) REFERENCES VDITORCAMENTO (CODORC, CODITORC, TIPOORC, CODFILIAL, CODEMP);

ALTER TABLE PPPROCESSAOPTMP ADD CONSTRAINT PPPROCESSFKSGEST FOREIGN KEY (CODEST, CODFILIALET, CODEMPET) REFERENCES SGESTACAO (CODEST, CODFILIAL, CODEMP);

ALTER TABLE PPRECURSO ADD CONSTRAINT PPRECURSOFKPPTIPOR FOREIGN KEY (CODTPREC, CODFILIALTR, CODEMPTR) REFERENCES PPTIPOREC (CODTPREC, CODFILIAL, CODEMP);

ALTER TABLE PPRECURSO ADD CONSTRAINT PPRECURSOFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE PPRETCP ADD CONSTRAINT PPRETCPFKPPOP FOREIGN KEY (CODOP, SEQOP, CODFILIAL, CODEMP) REFERENCES PPOP (CODOP, SEQOP, CODFILIAL, CODEMP) ON DELETE CASCADE;

ALTER TABLE PPTIPOANALISE ADD CONSTRAINT PPTIPOANALISEFKEQUNIDA FOREIGN KEY (CODUNID, CODFILIALUD, CODEMPUD) REFERENCES EQUNIDADE (CODUNID, CODFILIAL, CODEMP);

ALTER TABLE PPTIPOANALISE ADD CONSTRAINT PPTIPOANALISEFKMTANALI FOREIGN KEY (CODMTANALISE, CODFILIALMA, CODEMPMA) REFERENCES PPMETODOANALISE (CODMTANALISE, CODFILIAL, CODEMP);

ALTER TABLE PPTIPOREC ADD CONSTRAINT PPTIPORECFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE PVCAIXA ADD CONSTRAINT PVCAIXAFKSGESTACAO FOREIGN KEY (CODEST, CODFILIALET, CODEMPET) REFERENCES SGESTACAO (CODEST, CODFILIAL, CODEMP);

ALTER TABLE PVCAIXAIMP ADD CONSTRAINT PVCAIXAIMPFKPVCAIX FOREIGN KEY (CODCAIXA, CODFILIAL, CODEMP) REFERENCES PVCAIXA (CODCAIXA, CODFILIAL, CODEMP);

ALTER TABLE PVCAIXAIMP ADD CONSTRAINT PVCAIXAIMPFKSGIMPR FOREIGN KEY (CODIMP, CODFILIAL, CODEMP) REFERENCES SGIMPRESSORA (CODIMP, CODFILIAL, CODEMP);

ALTER TABLE PVMOVCAIXA ADD CONSTRAINT PVMOVCAIXAFKSGUSUA FOREIGN KEY (IDUSU, CODFILIALUS, CODEMPUS) REFERENCES SGUSUARIO (IDUSU, CODFILIAL, CODEMP);

ALTER TABLE PVSEQUENCIA ADD CONSTRAINT PVSEQUENCIAFKPVCAI FOREIGN KEY (CODCAIXA, CODFILIAL, CODEMP) REFERENCES PVCAIXA (CODCAIXA, CODFILIAL, CODEMP);

ALTER TABLE RHAREA ADD CONSTRAINT RHAREAFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE RHCANDIDATO ADD CONSTRAINT RHCANDIDATOFKESTCIVIL FOREIGN KEY (CODESTCIVIL, CODFILIALES, CODEMPES) REFERENCES SGESTCIVIL (CODESTCIVIL, CODFILIAL, CODEMP);

ALTER TABLE RHCANDIDATO ADD CONSTRAINT RHCANDIDATOFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE RHCANDIDATOCARAC ADD CONSTRAINT RHCANDCAFKRHCAND FOREIGN KEY (CODCAND, CODFILIAL, CODEMP) REFERENCES RHCANDIDATO (CODCAND, CODFILIAL, CODEMP);

ALTER TABLE RHCANDIDATOCARAC ADD CONSTRAINT RHCANDFKRHCARACFK FOREIGN KEY (CODCARAC, CODFILIALCT, CODEMPCT) REFERENCES RHCARACTERISTICA (CODCARAC, CODFILIAL, CODEMP);

ALTER TABLE RHCANDIDATOCURSO ADD CONSTRAINT RHCANDCURSOFKRHCAND FOREIGN KEY (CODCAND, CODFILIAL, CODEMP) REFERENCES RHCANDIDATO (CODCAND, CODFILIAL, CODEMP);

ALTER TABLE RHCANDIDATOCURSO ADD CONSTRAINT RHCANDCURSOFKRHCURSO FOREIGN KEY (CODCURSO, CODFILIALCS, CODEMPCS) REFERENCES RHCURSO (CODCURSO, CODFILIAL, CODEMP);

ALTER TABLE RHCANDIDATOFUNC ADD CONSTRAINT RHCANDFUNCFKRHCAND FOREIGN KEY (CODCAND, CODFILIAL, CODEMP) REFERENCES RHCANDIDATO (CODCAND, CODFILIAL, CODEMP);

ALTER TABLE RHCANDIDATOFUNC ADD CONSTRAINT RHCANDFUNCFKRHFUNC FOREIGN KEY (CODFUNC, CODFILIALFC, CODEMPFC) REFERENCES RHFUNCAO (CODFUNC, CODFILIAL, CODEMP);

ALTER TABLE RHCANDIDATOSTATUS ADD CONSTRAINT RHCANDIDATOSTATUSFKRHCAND FOREIGN KEY (CODCAND, CODFILIAL, CODEMP) REFERENCES RHCANDIDATO (CODCAND, CODFILIAL, CODEMP);

ALTER TABLE RHCANDIDATOSTATUS ADD CONSTRAINT RHCANDIDATOSTATUSFKRHVAGA FOREIGN KEY (CODVAGA, CODFILIAL, CODEMP) REFERENCES RHVAGA (CODVAGA, CODFILIAL, CODEMP);

ALTER TABLE RHCARACTERISTICA ADD CONSTRAINT ATCARACTERFKSGFI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE RHCURSO ADD CONSTRAINT RHCURSOFKRHAREA FOREIGN KEY (CODAREA, CODFILIALAR, CODEMPAR) REFERENCES RHAREA (CODAREA, CODFILIAL, CODEMP);

ALTER TABLE RHCURSO ADD CONSTRAINT RHCURSOFKRHNIVELC FOREIGN KEY (CODNIVELCURSO, CODFILIALNC, CODEMPNC) REFERENCES RHNIVELCURSO (CODNIVELCURSO, CODFILIAL, CODEMP);

ALTER TABLE RHCURSO ADD CONSTRAINT RHCURSOFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE RHEMPREGADO ADD CONSTRAINT RHEMPREGADOFKRHDEP FOREIGN KEY (CODDEP, CODFILIALDP, CODEMPDP) REFERENCES RHDEPTO (CODDEP, CODFILIAL, CODEMP);

ALTER TABLE RHEMPREGADO ADD CONSTRAINT RHEMPREGADOFKRHFUN FOREIGN KEY (CODFUNC, CODFILIALFO, CODEMPFO) REFERENCES RHFUNCAO (CODFUNC, CODFILIAL, CODEMP);

ALTER TABLE RHEMPREGADO ADD CONSTRAINT RHEMPREGADOFKRHTUR FOREIGN KEY (CODTURNO, CODFILIALTO, CODEMPTO) REFERENCES RHTURNO (CODTURNO, CODFILIAL, CODEMP);

ALTER TABLE RHEMPREGADO ADD CONSTRAINT RHEMPREGADOSALFKRHEMPR FOREIGN KEY (MATEMPR, CODFILIAL, CODEMPDP) REFERENCES RHEMPREGADO (MATEMPR, CODFILIAL, CODEMP);

ALTER TABLE RHEMPREGADOBENEF ADD CONSTRAINT RHEMPREGBENEFFKRHBENEF FOREIGN KEY (CODBENEF, CODFILIALBN, CODEMPBN) REFERENCES RHBENEFICIO (CODBENEF, CODFILIAL, CODEMP);

ALTER TABLE RHEMPREGADOBENEF ADD CONSTRAINT RHEMPREGBENEFFKRHEMPR FOREIGN KEY (MATEMPR, CODFILIAL, CODEMP) REFERENCES RHEMPREGADO (MATEMPR, CODFILIAL, CODEMP);

ALTER TABLE RHEMPREGADOR ADD CONSTRAINT RHEMPREGADORFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE RHEMPREGADOSAL ADD CONSTRAINT RHEMPSALFKRHEMP FOREIGN KEY (MATEMPR, CODFILIAL, CODEMP) REFERENCES RHEMPREGADO (MATEMPR, CODFILIAL, CODEMP);

ALTER TABLE RHEXPEDIENTE ADD CONSTRAINT RHEXPEDIENTEFKRHTU FOREIGN KEY (CODTURNO, CODFILIAL, CODEMP) REFERENCES RHTURNO (CODTURNO, CODFILIAL, CODEMP);

ALTER TABLE RHEXPEDMES ADD CONSTRAINT RHEXPEDMESFKRHTURN FOREIGN KEY (CODTURNO, CODFILIAL, CODEMP) REFERENCES RHTURNO (CODTURNO, CODFILIAL, CODEMP);

ALTER TABLE RHNIVELCURSO ADD CONSTRAINT RHNIVELCURSOFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE RHPONTO ADD CONSTRAINT RHPONTOFKRHEMPR FOREIGN KEY (MATEMPR, CODFILIAL, CODEMP) REFERENCES RHEMPREGADO (MATEMPR, CODFILIAL, CODEMP);

ALTER TABLE RHVAGA ADD CONSTRAINT RHVAGAFKEMPR FOREIGN KEY (CODEMPR, CODFILIALEM, CODEMPEM) REFERENCES RHEMPREGADOR (CODEMPR, CODFILIAL, CODEMP);

ALTER TABLE RHVAGA ADD CONSTRAINT RHVAGAFKRHFUNC FOREIGN KEY (CODFUNC, CODFILIALFC, CODEMPFC) REFERENCES RHFUNCAO (CODFUNC, CODFILIAL, CODEMP);

ALTER TABLE RHVAGA ADD CONSTRAINT RHVAGAFKRHTURNO FOREIGN KEY (CODTURNO, CODFILIALTN, CODEMPTN) REFERENCES RHTURNO (CODTURNO, CODFILIAL, CODEMP);

ALTER TABLE RHVAGACANDIDATO ADD CONSTRAINT RHVAGACANDFKRHCAND FOREIGN KEY (CODCAND, CODFILIALCA, CODEMPCA) REFERENCES RHCANDIDATO (CODCAND, CODFILIAL, CODEMP);

ALTER TABLE RHVAGACANDIDATO ADD CONSTRAINT RHVAGACANDFKRHVAGA FOREIGN KEY (CODVAGA, CODFILIAL, CODEMP) REFERENCES RHVAGA (CODVAGA, CODFILIAL, CODEMP);

ALTER TABLE RHVAGACARACQUALI ADD CONSTRAINT RHVAGACTRQUALIFKRHCARAC FOREIGN KEY (CODCARAC, CODFILIALCT, CODEMPCT) REFERENCES RHCARACTERISTICA (CODCARAC, CODFILIAL, CODEMP);

ALTER TABLE RHVAGACARACQUALI ADD CONSTRAINT RHVAGACTRQUALIFKRHVAGA FOREIGN KEY (CODVAGA, CODFILIAL, CODEMP) REFERENCES RHVAGA (CODVAGA, CODFILIAL, CODEMP);

ALTER TABLE RHVAGACARACREST ADD CONSTRAINT RHVAGACTRESTFKRHCARAC FOREIGN KEY (CODCARAC, CODFILIALCT, CODEMPCT) REFERENCES RHCARACTERISTICA (CODCARAC, CODFILIAL, CODEMP);

ALTER TABLE RHVAGACARACREST ADD CONSTRAINT RHVAGACTRESTFKRHVAGA FOREIGN KEY (CODVAGA, CODFILIAL, CODEMP) REFERENCES RHVAGA (CODVAGA, CODFILIAL, CODEMP);

ALTER TABLE RHVAGACURSO ADD CONSTRAINT RHVAGACURFKRHCURSO FOREIGN KEY (CODCURSO, CODFILIALCS, CODEMPCS) REFERENCES RHCURSO (CODCURSO, CODFILIAL, CODEMP);

ALTER TABLE RHVAGACURSO ADD CONSTRAINT RHVAGACURFKRHVAGA FOREIGN KEY (CODVAGA, CODFILIAL, CODEMP) REFERENCES RHVAGA (CODVAGA, CODFILIAL, CODEMP);

ALTER TABLE RHVAGASTATUS ADD CONSTRAINT RHVAGASTATUSFKRHVAGA FOREIGN KEY (CODVAGA, CODFILIAL, CODEMP) REFERENCES RHVAGA (CODVAGA, CODFILIAL, CODEMP);

ALTER TABLE SGACESSOEU ADD CONSTRAINT SGACESSOEUFKSGFILI FOREIGN KEY (CODFILIALFL, CODEMPFL) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE SGACESSOEU ADD CONSTRAINT SGACESSOEUFKSGUSUA FOREIGN KEY (IDUSU, CODFILIAL, CODEMP) REFERENCES SGUSUARIO (IDUSU, CODFILIAL, CODEMP) ON DELETE CASCADE;

ALTER TABLE SGACESSOMG ADD CONSTRAINT SGACESSOMGFKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE SGACESSOMU ADD CONSTRAINT SGACESSOMUFKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE SGAGENDA ADD CONSTRAINT SGAGENDAFKSGAGENDA FOREIGN KEY (CODAGEAR, TIPOAGEAR, CODAGDAR, CODFILIALAR, CODEMPAR) REFERENCES SGAGENDA (CODAGE, TIPOAGE, CODAGD, CODFILIAL, CODEMP);

ALTER TABLE SGAGENDA ADD CONSTRAINT SGAGENDAFKSGAGENTE FOREIGN KEY (CODAGEEMIT, TIPOAGEEMIT, CODFILIALAE, CODEMPAE) REFERENCES SGAGENTE (CODAGE, TIPOAGE, CODFILIAL, CODEMP);

ALTER TABLE SGATRIBUICAO ADD CONSTRAINT SGATRIBUICAOFKSGFI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE SGATRIBUSU ADD CONSTRAINT SGATRIBUSUFKSGATRI FOREIGN KEY (IDATRIB, CODFILIAL, CODEMP) REFERENCES SGATRIBUICAO (IDATRIB, CODFILIAL, CODEMP);

ALTER TABLE SGATRIBUSU ADD CONSTRAINT SGATRIBUSUSGUSUARI FOREIGN KEY (IDUSU, CODFILIALUU, CODEMPUU) REFERENCES SGUSUARIO (IDUSU, CODFILIAL, CODEMP);

ALTER TABLE SGBAIRRO ADD CONSTRAINT SGBAIRROFKSGMUNIC FOREIGN KEY (CODMUNIC, SIGLAUF, CODPAIS) REFERENCES SGMUNICIPIO (CODMUNIC, SIGLAUF, CODPAIS);

ALTER TABLE SGCATIMG ADD CONSTRAINT SGCATIMGFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE SGCONEXAO ADD CONSTRAINT SGCONEXAOFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE SGCONEXAO ADD CONSTRAINT SGCONEXAOFKSGUSUAR FOREIGN KEY (IDUSU, CODFILIAL, CODEMP) REFERENCES SGUSUARIO (IDUSU, CODFILIAL, CODEMP);

ALTER TABLE SGEMPRESA ADD CONSTRAINT SGEMPRESAFKSGMUNIC FOREIGN KEY (CODMUNIC, SIGLAUF, CODPAIS) REFERENCES SGMUNICIPIO (CODMUNIC, SIGLAUF, CODPAIS);

ALTER TABLE SGEQVCLIFOR ADD CONSTRAINT SGEQVCLIFORFKCPFOR FOREIGN KEY (CODFOR, CODFILIALFR, CODEMPFR) REFERENCES CPFORNECED (CODFOR, CODFILIAL, CODEMP);

ALTER TABLE SGEQVCLIFOR ADD CONSTRAINT SGEQVCLIFORFKVDCLI FOREIGN KEY (CODCLI, CODFILIALCL, CODEMPCL) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE SGESTACAO ADD CONSTRAINT SGESTACAOFKSGPROXY FOREIGN KEY (CODPROXY, CODFILIALPX, CODEMPPX) REFERENCES SGPROXYWEB (CODPROXY, CODFILIAL, CODEMP);

ALTER TABLE SGESTACAOBAL ADD CONSTRAINT SGESTACAOBALFKSGES FOREIGN KEY (CODEST, CODFILIAL, CODEMP) REFERENCES SGESTACAO (CODEST, CODFILIAL, CODEMP);

ALTER TABLE SGESTACAOIMP ADD CONSTRAINT SGESTACAOIMPFKSGES FOREIGN KEY (CODEST, CODFILIAL, CODEMP) REFERENCES SGESTACAO (CODEST, CODFILIAL, CODEMP);

ALTER TABLE SGESTACAOIMP ADD CONSTRAINT SGESTACAOIMPFKSGIM FOREIGN KEY (CODIMP, CODFILIALIP, CODEMPIP) REFERENCES SGIMPRESSORA (CODIMP, CODFILIAL, CODEMP);

ALTER TABLE SGESTACAOIMP ADD CONSTRAINT SGESTACAOIMPFKSGPA FOREIGN KEY (CODPAPEL, CODFILIAL, CODEMP) REFERENCES SGPAPEL (CODPAPEL, CODFILIAL, CODEMP);

ALTER TABLE SGESTCIVIL ADD CONSTRAINT SGESTCIVILFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE SGFILIAL ADD CONSTRAINT SGFILIALFKCPFORNECED FOREIGN KEY (CODFOR, CODFILIALCO, CODEMPCO) REFERENCES CPFORNECED (CODFOR, CODFILIAL, CODEMP);

ALTER TABLE SGFILIAL ADD CONSTRAINT SGFILIALFKSGMUNIC FOREIGN KEY (CODMUNIC, SIGLAUF, CODPAIS) REFERENCES SGMUNICIPIO (CODMUNIC, SIGLAUF, CODPAIS);

ALTER TABLE SGFILIAL ADD CONSTRAINT SGFILIALFKSGUNIFCOD FOREIGN KEY (CODUNIFCOD, CODFILIALUC, CODEMPUC) REFERENCES SGUNIFCOD (CODUNIFCOD, CODFILIAL, CODEMP);

ALTER TABLE SGGRAUINST ADD CONSTRAINT SGGRAUINSTFKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE SGGRPUSU ADD CONSTRAINT SGGRPUSUFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE SGIMAGEM ADD CONSTRAINT SGIMAGEMFKSGCATIMG FOREIGN KEY (CODCATIMG, CODFILIALCI, CODEMPCI) REFERENCES SGCATIMG (CODCATIMG, CODFILIAL, CODEMP);

ALTER TABLE SGIMPRESSORA ADD CONSTRAINT SGIMPRESSORAFKSGFI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE SGITFLUXO ADD CONSTRAINT SGITFLUXOFKSGFLUXO FOREIGN KEY (CODFLUXO, CODFILIAL, CODEMP) REFERENCES SGFLUXO (CODFLUXO, CODFILIAL, CODEMP);

ALTER TABLE SGITFLUXO ADD CONSTRAINT SGITFLUXOFKSGPROCE FOREIGN KEY (CODPROC, CODFILIALPC, CODEMPPC) REFERENCES SGPROCESSO (CODPROC, CODFILIAL, CODEMP);

ALTER TABLE SGITPREFERE6 ADD CONSTRAINT SGITPREFERE6FKFNBA FOREIGN KEY (CODBANCO, CODFILIALBO, CODEMPBO) REFERENCES FNBANCO (CODBANCO, CODFILIAL, CODEMP);

ALTER TABLE SGITPREFERE6 ADD CONSTRAINT SGITPREFERE6FKFNCO FOREIGN KEY (NUMCONTA, CODFILIALCA, CODEMPCA) REFERENCES FNCONTA (NUMCONTA, CODFILIAL, CODEMP);

ALTER TABLE SGITPREFERE6 ADD CONSTRAINT SGITPREFERE6FKSGPR FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGPREFERE6 (CODFILIAL, CODEMP);

ALTER TABLE SGITPROCESSO ADD CONSTRAINT SGITPROCESSOFKSGPR FOREIGN KEY (CODPROC, CODFILIAL, CODEMP) REFERENCES SGPROCESSO (CODPROC, CODFILIAL, CODEMP);

ALTER TABLE SGITTABELA ADD CONSTRAINT SGITTABELAFKSGTABE FOREIGN KEY (CODTB, CODFILIAL, CODEMP) REFERENCES SGTABELA (CODTB, CODFILIAL, CODEMP);

ALTER TABLE SGLOG ADD CONSTRAINT SGLOGFKPVCAIXA FOREIGN KEY (CODCAIXA, CODFILIALCX, CODEMPCX) REFERENCES PVCAIXA (CODCAIXA, CODFILIAL, CODEMP);

ALTER TABLE SGLOG ADD CONSTRAINT SGLOGFKSGUSUARIO FOREIGN KEY (IDUSU, CODFILIALUS, CODEMPUS) REFERENCES SGUSUARIO (IDUSU, CODFILIAL, CODEMP);

ALTER TABLE SGMENU ADD CONSTRAINT SGMENUFKSGMODULO FOREIGN KEY (CODMODU, CODSIS) REFERENCES SGMODULO (CODMODU, CODSIS);

ALTER TABLE SGMENUOBJ ADD CONSTRAINT SGMENUOBJFKSGMENU FOREIGN KEY (CODMENU, CODMODU, CODSIS) REFERENCES SGMENU (CODMENU, CODMODU, CODSIS);

ALTER TABLE SGMENUOBJ ADD CONSTRAINT SGMENUOBJFKSGOBJET FOREIGN KEY (IDOBJ, CODEMP) REFERENCES SGOBJETO (IDOBJ, CODEMP);

ALTER TABLE SGMODETIQUETA ADD CONSTRAINT SGMODETIQUETAFKSGP FOREIGN KEY (CODPAPEL, CODFILIALPL, CODEMPPL) REFERENCES SGPAPEL (CODPAPEL, CODFILIAL, CODEMP);

ALTER TABLE SGMUNICIPIO ADD CONSTRAINT SGMUNICIPIOFKSGUF FOREIGN KEY (SIGLAUF, CODPAIS) REFERENCES SGUF (SIGLAUF, CODPAIS);

ALTER TABLE SGOBJETO ADD CONSTRAINT SGOBJETOFKSGEMPRES FOREIGN KEY (CODEMP) REFERENCES SGEMPRESA (CODEMP);

ALTER TABLE SGOBJETOTB ADD CONSTRAINT SGOBJETOTBFKSGOBJE FOREIGN KEY (IDOBJ, CODEMP) REFERENCES SGOBJETO (IDOBJ, CODEMP);

ALTER TABLE SGOBJETOTB ADD CONSTRAINT SGOBJETOTBFKSGTABE FOREIGN KEY (CODTB, CODFILIALTB, CODEMPTB) REFERENCES SGTABELA (CODTB, CODFILIAL, CODEMP);

ALTER TABLE SGPAPEL ADD CONSTRAINT SGPAPELFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FK2EQTIP FOREIGN KEY (CODTIPOMOV2, CODFILIALT2, CODEMPT2) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FK3EQTIP FOREIGN KEY (CODTIPOMOV3, CODFILIALT3, CODEMPT3) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FK4EQTIP FOREIGN KEY (CODTIPOMOV4, CODFILIALT4, CODEMPT4) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FK5EQTIP FOREIGN KEY (CODTIPOMOV5, CODFILIALT5, CODEMPT5) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FK6EQTIP FOREIGN KEY (CODTIPOMOV6, CODFILIALT6, CODEMPT6) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FK8EQTIP FOREIGN KEY (CODTIPOMOV8, CODFILIALT8, CODEMPT8) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FK9EQTIP FOREIGN KEY (CODTIPOMOV9, CODFILIALT9, CODEMPT9) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKCPFORN FOREIGN KEY (CODFOR, CODFILIALFR, CODEMPFR) REFERENCES CPFORNECED (CODFOR, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKCPTIPO FOREIGN KEY (CODTIPOFOR, CODFILIALTF, CODEMPTF) REFERENCES CPTIPOFOR (CODTIPOFOR, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKEQGRUP FOREIGN KEY (CODGRUP, CODFILIALGP, CODEMPGP) REFERENCES EQGRUPO (CODGRUP, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKEQMARC FOREIGN KEY (CODMARCA, CODFILIALMC, CODEMPMC) REFERENCES EQMARCA (CODMARCA, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKEQTIPO FOREIGN KEY (CODTIPOMOV, CODFILIALTM, CODEMPTM) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKFNHISTP FOREIGN KEY (CODHISTPAG, CODFILIALHISTPAG, CODEMPHISTPAG) REFERENCES FNHISTPAD (CODHIST, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKFNHISTR FOREIGN KEY (CODHISTREC, CODFILIALHISTREC, CODEMPHISTREC) REFERENCES FNHISTPAD (CODHIST, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKFNMOED FOREIGN KEY (CODMOEDA, CODFILIALMO, CODEMPMO) REFERENCES FNMOEDA (CODMOEDA, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKFNPLAN FOREIGN KEY (CODPLANOPAG, CODFILIALPG, CODEMPPG) REFERENCES FNPLANOPAG (CODPLANOPAG, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKFNTBJU FOREIGN KEY (CODTBJ, CODFILIALTJ, CODEMPTJ) REFERENCES FNTBJUROS (CODTBJ, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKLFMENS FOREIGN KEY (CODMENSORC, CODFILIALMENSORC, CODEMPMENSORC) REFERENCES LFMENSAGEM (CODMENS, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKLFMENS2 FOREIGN KEY (CODMENSICMSSIMPLES, CODFILIALMS, CODEMPMS) REFERENCES LFMENSAGEM (CODMENS, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKLFMENS3 FOREIGN KEY (CODMENSVENDA, CODFILIALME, CODEMPME) REFERENCES LFMENSAGEM (CODMENS, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKPLANCHEQUE FOREIGN KEY (CODPLANPC, CODFILIALPC, CODEMPPC) REFERENCES FNPLANEJAMENTO (CODPLAN, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKPLANDC FOREIGN KEY (CODPLANDC, CODFILIALDC, CODEMPDC) REFERENCES FNPLANEJAMENTO (CODPLAN, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKPLANDR FOREIGN KEY (CODPLANDR, CODFILIALDR, CODEMPDR) REFERENCES FNPLANEJAMENTO (CODPLAN, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKPLANJP FOREIGN KEY (CODPLANJP, CODFILIALJP, CODEMPJP) REFERENCES FNPLANEJAMENTO (CODPLAN, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKPLANJR FOREIGN KEY (CODPLANJR, CODFILIALJR, CODEMPJR) REFERENCES FNPLANEJAMENTO (CODPLAN, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKPLANOPAGSV FOREIGN KEY (CODPLANOPAGSV, CODFILIALSV, CODEMPSV) REFERENCES FNPLANOPAG (CODPLANOPAG, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKSGIMAG FOREIGN KEY (CODIMG, CODFILIALIG, CODEMPIG) REFERENCES SGIMAGEM (CODIMG, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKTIPOMOVIM FOREIGN KEY (CODTIPOMOVIM, CODFILIALIM, CODEMPIM) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKTIPOMOVORCSERV FOREIGN KEY (CODTIPOMOVS, CODFILIALTS, CODEMPTS) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKTPMOVIC FOREIGN KEY (CODTIPOMOVIC, CODFILIALIC, CODEMPIC) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKVDCLAS FOREIGN KEY (CODCLASCLI, CODFILIALCE, CODEMPCE) REFERENCES VDCLASCLI (CODCLASCLI, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKVDTABP FOREIGN KEY (CODTAB, CODFILIALTB, CODEMPTB) REFERENCES VDTABPRECO (CODTAB, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKVDTIPC FOREIGN KEY (CODTIPOCLI, CODFILIALTC, CODEMPTC) REFERENCES VDTIPOCLI (CODTIPOCLI, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE1 ADD CONSTRAINT SGPREFERE1FKVDTRAN FOREIGN KEY (CODTRAN, CODFILIALTN, CODEMPTN) REFERENCES VDTRANSP (CODTRAN, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE2 ADD CONSTRAINT SGPREFERE1FKVDVEND FOREIGN KEY (CODVEND, CODFILIALVD, CODEMPVD) REFERENCES VDVENDEDOR (CODVEND, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE2 ADD CONSTRAINT SGPREFERE2FK2ATTIP FOREIGN KEY (CODTPATENDO2, CODFILIALT2, CODEMPT2) REFERENCES ATTIPOATENDO (CODTPATENDO, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE2 ADD CONSTRAINT SGPREFERE2FK3ATTIP FOREIGN KEY (CODTPATENDO3, CODFILIALT3, CODEMPT3) REFERENCES ATTIPOATENDO (CODTPATENDO, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE2 ADD CONSTRAINT SGPREFERE2FKATATEN FOREIGN KEY (CODATEND, CODFILIALAE, CODEMPAE) REFERENCES ATATENDENTE (CODATEND, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE2 ADD CONSTRAINT SGPREFERE2FKATTIPO FOREIGN KEY (CODTPATENDO, CODFILIALTO, CODEMPTO) REFERENCES ATTIPOATENDO (CODTPATENDO, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE2 ADD CONSTRAINT SGPREFERE2FKSGITT2 FOREIGN KEY (CODITTBV, CODTBV, CODFILIALTV, CODEMPTV) REFERENCES SGITTABELA (CODITTB, CODTB, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE2 ADD CONSTRAINT SGPREFERE2FKSGITTA FOREIGN KEY (CODITTBA, CODTBA, CODFILIALTA, CODEMPTA) REFERENCES SGITTABELA (CODITTB, CODTB, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE2 ADD CONSTRAINT SGPREFERE2FKVDCLAS FOREIGN KEY (CODCLASCLI, CODFILIALCI, CODEMPCI) REFERENCES VDCLASCLI (CODCLASCLI, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE2 ADD CONSTRAINT SGPREFERE2FKVDTIPO FOREIGN KEY (CODTIPOCLI, CODFILIALTI, CODEMPTI) REFERENCES VDTIPOCLI (CODTIPOCLI, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE2 ADD CONSTRAINT SGPREFERE2FKVDVEND FOREIGN KEY (CODVEND, CODFILIALVD, CODEMPVD) REFERENCES VDVENDEDOR (CODVEND, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE3 ADD CONSTRAINT SGPREFERE3ATMODAP FOREIGN KEY (CODMODELAP, CODFILIALAP, CODEMPAP) REFERENCES ATMODATENDO (CODMODEL, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE3 ADD CONSTRAINT SGPREFERE3ATMODFI FOREIGN KEY (CODMODELFI, CODFILIALFI, CODEMPMI) REFERENCES ATMODATENDO (CODMODEL, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE3 ADD CONSTRAINT SGPREFERE3ATMODFJ FOREIGN KEY (CODMODELFJ, CODFILIALFJ, CODEMPFJ) REFERENCES ATMODATENDO (CODMODEL, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE3 ADD CONSTRAINT SGPREFERE3ATMODMC FOREIGN KEY (CODMODELMC, CODFILIALMC, CODEMPMC) REFERENCES ATMODATENDO (CODMODEL, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE3 ADD CONSTRAINT SGPREFERE3ATMODME FOREIGN KEY (CODMODELME, CODFILIALME, CODEMPME) REFERENCES ATMODATENDO (CODMODEL, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE3 ADD CONSTRAINT SGPREFERE3ATMODMI FOREIGN KEY (CODMODELMI, CODFILIALMI, CODEMPMI) REFERENCES ATMODATENDO (CODMODEL, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE3 ADD CONSTRAINT SGPREFERE3ATMODOR FOREIGN KEY (CODMODELOR, CODFILIALOR, CODEMPOR) REFERENCES ATMODATENDO (CODMODEL, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE3 ADD CONSTRAINT SGPREFERE3FKTKATCE FOREIGN KEY (CODATIVCE, CODFILIALCE, CODEMPCE) REFERENCES TKATIVIDADE (CODATIV, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE3 ADD CONSTRAINT SGPREFERE3FKTKATTE FOREIGN KEY (CODATIVTE, CODFILIALTE, CODEMPTE) REFERENCES TKATIVIDADE (CODATIV, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE3 ADD CONSTRAINT SGPREFERE3FKTKCON2 FOREIGN KEY (CODCONFEMAIL2, CODFILIALC2, CODEMPC2) REFERENCES TKCONFEMAIL (CODCONFEMAIL, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE3 ADD CONSTRAINT SGPREFERE3FKTKCONF FOREIGN KEY (CODCONFEMAIL, CODFILIALCF, CODEMPCF) REFERENCES TKCONFEMAIL (CODCONFEMAIL, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE3 ADD CONSTRAINT SGPREFERE3FKTKEMAI FOREIGN KEY (CODEMAILNC, CODFILIALNC, CODEMPNC) REFERENCES TKEMAIL (CODEMAIL, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE3 ADD CONSTRAINT SGPREFERE3FKTKEME2 FOREIGN KEY (CODEMAILEN2, CODFILIALE2, CODEMPE2) REFERENCES TKEMAIL (CODEMAIL, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE3 ADD CONSTRAINT SGPREFERE3FKTKEMEA FOREIGN KEY (CODEMAILEA, CODFILIALEA, CODEMPEA) REFERENCES TKEMAIL (CODEMAIL, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE3 ADD CONSTRAINT SGPREFERE3FKTKEMEC FOREIGN KEY (CODEMAILEC, CODFILIALEC, CODEMPEC) REFERENCES TKEMAIL (CODEMAIL, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE3 ADD CONSTRAINT SGPREFERE3FKTKEMEN FOREIGN KEY (CODEMAILEN, CODFILIALEN, CODEMPEN) REFERENCES TKEMAIL (CODEMAIL, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE3 ADD CONSTRAINT SGPREFERE3FKTKTIP1 FOREIGN KEY (CODTIPOCONT1, CODFILIALT1, CODEMPT1) REFERENCES TKTIPOCONT (CODTIPOCONT, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE3 ADD CONSTRAINT SGPREFERE3FKTKTIP2 FOREIGN KEY (CODTIPOCONT2, CODFILIALT2, CODEMPT2) REFERENCES TKTIPOCONT (CODTIPOCONT, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE3 ADD CONSTRAINT SGPREFERE3FKTKVARG1 FOREIGN KEY (CODVARG1, CODFILIALV1, CODEMPV1) REFERENCES EQVARGRADE (CODVARG, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE3 ADD CONSTRAINT SGPREFERE3FKTKVARG2 FOREIGN KEY (CODVARG2, CODFILIALV2, CODEMPV2) REFERENCES EQVARGRADE (CODVARG, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE3 ADD CONSTRAINT SGPREFERE3FKTKVARG3 FOREIGN KEY (CODVARG3, CODFILIALV3, CODEMPV3) REFERENCES EQVARGRADE (CODVARG, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE3 ADD CONSTRAINT SGPREFERE3FKTKVARG4 FOREIGN KEY (CODVARG4, CODFILIALV4, CODEMPV4) REFERENCES EQVARGRADE (CODVARG, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE3 ADD CONSTRAINT SGPREFERE3FKTKVARG5 FOREIGN KEY (CODVARG5, CODFILIALV5, CODEMPV5) REFERENCES EQVARGRADE (CODVARG, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE3 ADD CONSTRAINT SGPREFERE3FKTKVARG6 FOREIGN KEY (CODVARG6, CODFILIALV6, CODEMPV6) REFERENCES EQVARGRADE (CODVARG, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE3 ADD CONSTRAINT SGPREFERE3FKTKVARG7 FOREIGN KEY (CODVARG7, CODFILIALV7, CODEMPV7) REFERENCES EQVARGRADE (CODVARG, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE3 ADD CONSTRAINT SGPREFERE3FKTKVARG8 FOREIGN KEY (CODVARG8, CODFILIALV8, CODEMPV8) REFERENCES EQVARGRADE (CODVARG, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE3 ADD CONSTRAINT SGPREFERE3FKVDSETOR FOREIGN KEY (CODSETOR, CODFILIALSR, CODEMPSR) REFERENCES VDSETOR (CODSETOR, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE4 ADD CONSTRAINT SGPREFERE4FKEQPROD FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE4 ADD CONSTRAINT SGPREFERE4FKEQTIPO FOREIGN KEY (CODTIPOMOV, CODFILIALTM, CODEMPTM) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE4 ADD CONSTRAINT SGPREFERE4FKPLANOP FOREIGN KEY (CODPLANOPAG, CODFILIALPP, CODEMPPP) REFERENCES FNPLANOPAG (CODPLANOPAG, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE4 ADD CONSTRAINT SGPREFERE4FKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE4 ADD CONSTRAINT SGPREFERE4FKVDCLIE FOREIGN KEY (CODCLI, CODFILIALCL, CODEMPCL) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE5 ADD CONSTRAINT SGPREFERE5FKEQTIPO FOREIGN KEY (CODTIPOMOV, CODFILIALTM, CODEMPTM) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE5 ADD CONSTRAINT SGPREFERE5FKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE5 ADD CONSTRAINT SGPREFERE5FKTIPOMOVEN FOREIGN KEY (CODTIPOMOVEN, CODFILIALEN, CODEMPEN) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE5 ADD CONSTRAINT SGPREFERE5FKTIPOMOVRE FOREIGN KEY (CODTIPOMOVRE, CODFILIALRE, CODEMPRE) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE5 ADD CONSTRAINT SGPREFERE5FKTIPOMOVSP FOREIGN KEY (CODTIPOMOVSP, CODFILIALTS, CODEMPTS) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE7 ADD CONSTRAINT SGPREF7FKEQTIPMCO FOREIGN KEY (CODTIPOMOVCO, CODFILIALCO, CODEMPCO) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE7 ADD CONSTRAINT SGPREF7FKEQTIPMTP FOREIGN KEY (CODTIPOMOVTP, CODFILIALTP, CODEMPTP) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE7 ADD CONSTRAINT SGPREF7FKEQTIPMTV FOREIGN KEY (CODTIPOMOVTV, CODFILIALTV, CODEMPTV) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE7 ADD CONSTRAINT SGPREF7FKFNPLANCONSIG FOREIGN KEY (CODPLANCONSIG, CODFILIALPC, CODEMPPC) REFERENCES FNPLANEJAMENTO (CODPLAN, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE7 ADD CONSTRAINT SGPREF7FNPLANVDCONSIG FOREIGN KEY (CODPLANVDCONSIG, CODFILIALPV, CODEMPPV) REFERENCES FNPLANEJAMENTO (CODPLAN, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE8 ADD CONSTRAINT SGPREF8FKEQTIPOMOVTC FOREIGN KEY (CODTIPOMOVTC, CODFILIALTC, CODEMPTC) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE8 ADD CONSTRAINT SGPREF8FKEQTIPORECMERC FOREIGN KEY (CODTIPORECMERC, CODFILIALTR, CODEMPTR) REFERENCES EQTIPORECMERC (CODTIPORECMERC, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE8 ADD CONSTRAINT SGPREF8FKEQTIPORECMERCCM FOREIGN KEY (CODTIPORECMERCCM, CODFILIALCM, CODEMPCM) REFERENCES EQTIPORECMERC (CODTIPORECMERC, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE8 ADD CONSTRAINT SGPREF8FKEQTIPORECMERCOS FOREIGN KEY (CODTIPORECMERCOS, CODFILIALTO, CODEMPTO) REFERENCES EQTIPORECMERC (CODTIPORECMERC, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE8 ADD CONSTRAINT SGPREFERE8FKEQTIPOEXPED FOREIGN KEY (CODTIPOEXPED, CODFILIALTE, CODEMPTE) REFERENCES EQTIPOEXPEDICAO (CODTIPOEXPED, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE8 ADD CONSTRAINT SGPREFERE8FKEQTIPOMOVDS FOREIGN KEY (CODTIPOMOVDS, CODFILIALDS, CODEMPDS) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE8 ADD CONSTRAINT SGPREFERE8FKFNPLAN FOREIGN KEY (CODPLANOPAG, CODFILIALPP, CODEMPPP) REFERENCES FNPLANOPAG (CODPLANOPAG, CODFILIAL, CODEMP);

ALTER TABLE SGPREFERE8 ADD CONSTRAINT SGPREFERE8FKVDTRAN FOREIGN KEY (CODTRAN, CODFILIALTN, CODEMPTN) REFERENCES VDTRANSP (CODTRAN, CODFILIAL, CODEMP);

ALTER TABLE SGSEQUENCIA ADD CONSTRAINT SGSEQUENCIAFKSGFIL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE SGSQUID_LOG ADD CONSTRAINT SGSQUID_LOGPKAC FOREIGN KEY (ID_ACTION) REFERENCES SGSQUID_ACTION (ID);

ALTER TABLE SGSQUID_LOG ADD CONSTRAINT SGSQUID_LOGPKHI FOREIGN KEY (ID_HIER) REFERENCES SGSQUID_HIER (ID);

ALTER TABLE SGSQUID_LOG ADD CONSTRAINT SGSQUID_LOGPKME FOREIGN KEY (ID_METHOD) REFERENCES SGSQUID_METHOD (ID);

ALTER TABLE SGTABELA ADD CONSTRAINT SGTABELAFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE SGTRATARET ADD CONSTRAINT SGTRATARETFKSGITP2 FOREIGN KEY (CODPROCGT, SEQITPROCGT, CODFILIALGT, CODEMPGT) REFERENCES SGITPROCESSO (CODPROC, SEQITPROC, CODFILIAL, CODEMP);

ALTER TABLE SGTRATARET ADD CONSTRAINT SGTRATARETFKSGITPR FOREIGN KEY (CODPROC, SEQITPROC, CODFILIAL, CODEMP) REFERENCES SGITPROCESSO (CODPROC, SEQITPROC, CODFILIAL, CODEMP);

ALTER TABLE SGUF ADD CONSTRAINT SGUFFKSGPAIS FOREIGN KEY (CODPAIS) REFERENCES SGPAIS (CODPAIS);

ALTER TABLE SGUSUARIO ADD CONSTRAINT SGUSUARIOFKEQALMOX FOREIGN KEY (CODALMOX, CODFILIALAM, CODEMPAM) REFERENCES EQALMOX (CODALMOX, CODFILIAL, CODEMP);

ALTER TABLE SGUSUARIO ADD CONSTRAINT SGUSUARIOFKFNCC FOREIGN KEY (CODCC, ANOCC, CODFILIALCC, CODEMPCC) REFERENCES FNCC (CODCC, ANOCC, CODFILIAL, CODEMP);

ALTER TABLE SGUSUARIO ADD CONSTRAINT SGUSUARIOFKSGAGENT FOREIGN KEY (CODAGE, TIPOAGE, CODFILIALAE, CODEMPAE) REFERENCES SGAGENTE (CODAGE, TIPOAGE, CODFILIAL, CODEMP) ON DELETE CASCADE;

ALTER TABLE SGUSUARIO ADD CONSTRAINT SGUSUARIOFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE SGUSUARIO ADD CONSTRAINT SGUSUARIOFKSGGRPUS FOREIGN KEY (IDGRPUSU, CODFILIALIG, CODEMPIG) REFERENCES SGGRPUSU (IDGRPUSU, CODFILIAL, CODEMP);

ALTER TABLE SGUSUARIO ADD CONSTRAINT SGUSUARIOFKTKCONFE FOREIGN KEY (CODCONFEMAIL, CODFILIALCE, CODEMPCE) REFERENCES TKCONFEMAIL (CODCONFEMAIL, CODFILIAL, CODEMP);

ALTER TABLE SVAVALIACAO ADD CONSTRAINT SVAVALIACAOFKEQPRO FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE SVAVALIACAO ADD CONSTRAINT SVAVALIACAOFKSVITO FOREIGN KEY (CODOS, CODITOS, CODFILIAL, CODEMP) REFERENCES SVITOS (CODOS, CODITOS, CODFILIAL, CODEMP);

ALTER TABLE SVEXECUCAO ADD CONSTRAINT SVEXECUCAOFKEQPROD FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE SVEXECUCAO ADD CONSTRAINT SVEXECUCAOFKSVITOS FOREIGN KEY (CODOS, CODITOS, CODFILIAL, CODEMP) REFERENCES SVITOS (CODOS, CODITOS, CODFILIAL, CODEMP);

ALTER TABLE SVITOS ADD CONSTRAINT SVITOSFKEQPRODUTO FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE SVITOS ADD CONSTRAINT SVITOSFKSVOS FOREIGN KEY (CODOS, CODFILIAL, CODEMP) REFERENCES SVOS (CODOS, CODFILIAL, CODEMP);

ALTER TABLE SVOS ADD CONSTRAINT SVOSFKSVCONVENIADO FOREIGN KEY (CODCONV, CODFILIALCV, CODEMPCV) REFERENCES ATCONVENIADO (CODCONV, CODFILIAL, CODEMP);

ALTER TABLE SVOS ADD CONSTRAINT SVOSFKVDCLIENTE FOREIGN KEY (CODCLI, CODFILIALCL, CODEMPCL) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE TKCAMPANHACLI ADD CONSTRAINT TKCAMPANHACLIFKTKCAMP FOREIGN KEY (CODCAMP, CODFILIAL, CODEMP) REFERENCES TKCAMPANHA (CODCAMP, CODFILIAL, CODEMP);

ALTER TABLE TKCAMPANHACLI ADD CONSTRAINT TKCAMPANHACLIFKTKCLI FOREIGN KEY (CODCLI, CODFILIALCL, CODEMPCL) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE TKCAMPANHACTO ADD CONSTRAINT TKCAMPANHACTOFKTKCAMP FOREIGN KEY (CODCAMP, CODFILIAL, CODEMP) REFERENCES TKCAMPANHA (CODCAMP, CODFILIAL, CODEMP);

ALTER TABLE TKCAMPANHACTO ADD CONSTRAINT TKCAMPANHACTOFKTKCTO FOREIGN KEY (CODCTO, CODFILIALCO, CODEMPCO) REFERENCES TKCONTATO (CODCTO, CODFILIAL, CODEMP);

ALTER TABLE TKCAMPANHACTO ADD CONSTRAINT TKCAMPANHACTOFKVDCLI FOREIGN KEY (CODCLI, CODFILIALCL, CODEMPCL) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE TKCAMPANHAEMAIL ADD CONSTRAINT TKCAMPANHAEMAILFKTKCAMP FOREIGN KEY (CODCAMP, CODFILIAL, CODEMP) REFERENCES TKCAMPANHA (CODCAMP, CODFILIAL, CODEMP);

ALTER TABLE TKCAMPANHAEMAIL ADD CONSTRAINT TKCAMPANHAEMAILFKTKCTO FOREIGN KEY (CODEMAIL, CODFILIALEM, CODEMPEM) REFERENCES TKEMAIL (CODEMAIL, CODFILIAL, CODEMP);

ALTER TABLE TKCONTATO ADD CONSTRAINT TKCONTATOFKORIGCONT FOREIGN KEY (CODORIGCONT, CODFILIALOC, CODEMPOC) REFERENCES TKORIGCONT (CODORIGCONT, CODFILIAL, CODEMP);

ALTER TABLE TKCONTATO ADD CONSTRAINT TKCONTATOFKSETORCT FOREIGN KEY (CODSETORCTO, CODFILIALSO, CODEMPSO) REFERENCES TKSETORCTO (CODSETORCTO, CODFILIAL, CODEMP);

ALTER TABLE TKCONTATO ADD CONSTRAINT TKCONTATOFKSGMUNIC FOREIGN KEY (CODMUNIC, SIGLAUF, CODPAIS) REFERENCES SGMUNICIPIO (CODMUNIC, SIGLAUF, CODPAIS);

ALTER TABLE TKCONTATO ADD CONSTRAINT TKCONTATOFKTKTIPOCONT FOREIGN KEY (CODTIPOCONT, CODFILIALTO, CODEMPTO) REFERENCES TKTIPOCONT (CODTIPOCONT, CODFILIAL, CODEMP);

ALTER TABLE TKCONTATO ADD CONSTRAINT TKCONTATOFKTKTIPOI FOREIGN KEY (CODTPIMP, CODFILIALTI, CODEMPTI) REFERENCES TKTIPOIMP (CODTPIMP, CODFILIAL, CODEMP);

ALTER TABLE TKCONTATO ADD CONSTRAINT TKCONTATOFKVDSETOR FOREIGN KEY (CODSETOR, CODFILIALSR, CODEMPSR) REFERENCES VDSETOR (CODSETOR, CODFILIAL, CODEMP);

ALTER TABLE TKCONTATO ADD CONSTRAINT TKCONTATOFKVDTIPOC FOREIGN KEY (CODTIPOCLI, CODFILIALTC, CODEMPTC) REFERENCES VDTIPOCLI (CODTIPOCLI, CODFILIAL, CODEMP);

ALTER TABLE TKCONTATO ADD CONSTRAINT TKCONTATOFKVDVENDE FOREIGN KEY (CODVEND, CODFILIALVD, CODEMPVD) REFERENCES VDVENDEDOR (CODVEND, CODFILIAL, CODEMP);

ALTER TABLE TKCONTCLI ADD CONSTRAINT TKCONTCLIFKTKCONTATO FOREIGN KEY (CODCTO, CODFILIALCTO, CODEMPCTO) REFERENCES TKCONTATO (CODCTO, CODFILIAL, CODEMP);

ALTER TABLE TKCONTCLI ADD CONSTRAINT TKCONTCLIFKVDCLIENTE FOREIGN KEY (CODCLI, CODFILIALCLI, CODEMPCLI) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE TKCONTPESSOA ADD CONSTRAINT TKCONTPESSOAFKCTO FOREIGN KEY (CODCTO, CODFILIALCTO, CODEMPCTO) REFERENCES TKCONTATO (CODCTO, CODFILIAL, CODEMP) ON DELETE CASCADE;

ALTER TABLE TKCONTPESSOA ADD CONSTRAINT TKCONTPESSOAFKPES FOREIGN KEY (EMAILPESSOA, CODFILIALPE, CODEMPPE) REFERENCES CRPESSOA (EMAILPESSOA, CODFILIAL, CODEMP);

ALTER TABLE TKCTOATIV ADD CONSTRAINT TKCTOATIVFKTKATIVI FOREIGN KEY (CODATIV, CODFILIALAV, CODEMPAV) REFERENCES TKATIVIDADE (CODATIV, CODFILIAL, CODEMP);

ALTER TABLE TKCTOATIV ADD CONSTRAINT TKCTOATIVFKTKCONTA FOREIGN KEY (CODCTO, CODFILIAL, CODEMP) REFERENCES TKCONTATO (CODCTO, CODFILIAL, CODEMP);

ALTER TABLE TKCTOGRPINT ADD CONSTRAINT TKCTOGRPINTFKEQGRUPO FOREIGN KEY (CODGRUP, CODFILIALGP, CODEMPGP) REFERENCES EQGRUPO (CODGRUP, CODFILIAL, CODEMP);

ALTER TABLE TKCTOGRPINT ADD CONSTRAINT TKCTOGRPINTFKTKCTO FOREIGN KEY (CODCTO, CODFILIAL, CODEMP) REFERENCES TKCONTATO (CODCTO, CODFILIAL, CODEMP);

ALTER TABLE TKEMAIL ADD CONSTRAINT TKEMAILFKTKCONFEMAIL FOREIGN KEY (CODCONFEMAIL, CODFILIALCM, CODEMPCM) REFERENCES TKCONFEMAIL (CODCONFEMAIL, CODFILIAL, CODEMP);

ALTER TABLE TKHISTORICO ADD CONSTRAINT TKHISTORICOFKATATE FOREIGN KEY (CODATEND, CODFILIALAE, CODEMPAE) REFERENCES ATATENDENTE (CODATEND, CODFILIAL, CODEMP);

ALTER TABLE TKHISTORICO ADD CONSTRAINT TKHISTORICOFKTKCON FOREIGN KEY (CODCTO, CODFILIALCO, CODEMPCO) REFERENCES TKCONTATO (CODCTO, CODFILIAL, CODEMP);

ALTER TABLE TKHISTORICO ADD CONSTRAINT TKHISTORICOFKTKSITCAMP FOREIGN KEY (CODCAMP, SEQSITCAMP, TIPOCTO, CODFILIALCA, CODEMPCA) REFERENCES TKSITCAMP (CODCAMP, SEQSITCAMP, TIPOCTO, CODFILIAL, CODEMP);

ALTER TABLE TKHISTORICO ADD CONSTRAINT TKHISTORICOFKVDCLI FOREIGN KEY (CODCLI, CODFILIALCL, CODEMPCL) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE TKORIGCONT ADD CONSTRAINT TKORIGCONTFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE TKSITCAMP ADD CONSTRAINT TKSITCAMPFKTKCAMP FOREIGN KEY (CODCAMP, CODFILIAL, CODEMP) REFERENCES TKCAMPANHA (CODCAMP, CODFILIAL, CODEMP);

ALTER TABLE TKSITCAMP ADD CONSTRAINT TKSITCAMPFKTKCTO FOREIGN KEY (CODCTO, CODFILIALCO, CODEMPCO) REFERENCES TKCONTATO (CODCTO, CODFILIAL, CODEMP);

ALTER TABLE TKSITCAMP ADD CONSTRAINT TKSITCAMPFKVDCLI FOREIGN KEY (CODCLI, CODFILIALCL, CODEMPCL) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE TKTIPOCONT ADD CONSTRAINT TKTIPOCONTFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE VDAUXVENDA ADD CONSTRAINT VDAUXVENDAFKVDVEND FOREIGN KEY (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP) REFERENCES VDVENDA (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP);

ALTER TABLE VDCLASCLI ADD CONSTRAINT VDCLASCLIFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE VDCLIAUTP ADD CONSTRAINT VDCLIAUTPFKVDCLIEN FOREIGN KEY (CODCLI, CODFILIAL, CODEMP) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE VDCLICOMPL ADD CONSTRAINT VDCLICOMPLFKVDCLIE FOREIGN KEY (CODCLI, CODFILIAL, CODEMP) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE VDCLICONTAS ADD CONSTRAINT VDCLICONTASFKVDBAN FOREIGN KEY (CODBANCO, CODFILIALBC, CODEMPBC) REFERENCES FNBANCO (CODBANCO, CODFILIAL, CODEMP);

ALTER TABLE VDCLICONTAS ADD CONSTRAINT VDCLICONTASFKVDCLI FOREIGN KEY (CODCLI, CODFILIAL, CODEMP) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTEFKFNBANCO FOREIGN KEY (CODBANCO, CODFILIALBO, CODEMPBO) REFERENCES FNBANCO (CODBANCO, CODFILIAL, CODEMP);

ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTEFKFNCARTC FOREIGN KEY (CODCARTCOB, CODFILIALCB, CODEMPCB, CODBANCO, CODFILIALBO, CODEMPBO) REFERENCES FNCARTCOB (CODCARTCOB, CODFILIAL, CODEMP, CODBANCO, CODFILIALBO, CODEMPBO);

ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTEFKFNHISTP FOREIGN KEY (CODHIST, CODFILIALHP, CODEMPHP) REFERENCES FNHISTPAD (CODHIST, CODFILIAL, CODEMP);

ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTEFKFNPLANO FOREIGN KEY (CODPLANOPAG, CODFILIALPG, CODEMPPG) REFERENCES FNPLANOPAG (CODPLANOPAG, CODFILIAL, CODEMP);

ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTEFKFNTIPOB FOREIGN KEY (CODTIPOCOB, CODFILIALTC, CODEMPTC) REFERENCES FNTIPOCOB (CODTIPOCOB, CODFILIAL, CODEMP);

ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTEFKFNTIPOD FOREIGN KEY (CODTPCRED, CODFILIALTR, CODEMPTR) REFERENCES FNTIPOCRED (CODTPCRED, CODFILIAL, CODEMP);

ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTEFKLFTIPOF FOREIGN KEY (CODFISCCLI, CODFILIALFC, CODEMPFC) REFERENCES LFTIPOFISCCLI (CODFISCCLI, CODFILIAL, CODEMP);

ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTEFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTEFKSGITTAB FOREIGN KEY (CODITTBEC, CODTBEC, CODFILIALEC, CODEMPEC) REFERENCES SGITTABELA (CODITTB, CODTB, CODFILIAL, CODEMP);

ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTEFKSGMUNIC FOREIGN KEY (CODMUNIC, SIGLAUF, CODPAIS) REFERENCES SGMUNICIPIO (CODMUNIC, SIGLAUF, CODPAIS);

ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTEFKSGMUNICCOB FOREIGN KEY (CODMUNICCOB, SIGLAUFCOB, CODPAISCOB) REFERENCES SGMUNICIPIO (CODMUNIC, SIGLAUF, CODPAIS);

ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTEFKSGMUNICENT FOREIGN KEY (CODMUNICENT, SIGLAUFENT, CODPAISENT) REFERENCES SGMUNICIPIO (CODMUNIC, SIGLAUF, CODPAIS);

ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTEFKSGUNIFCOD FOREIGN KEY (CODUNIFCOD, CODFILIALUC, CODEMPUC) REFERENCES SGUNIFCOD (CODUNIFCOD, CODFILIAL, CODEMP);

ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTEFKVDCLASC FOREIGN KEY (CODCLASCLI, CODFILIALCC, CODEMPCC) REFERENCES VDCLASCLI (CODCLASCLI, CODFILIAL, CODEMP);

ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTEFKVDSETOR FOREIGN KEY (CODSETOR, CODFILIALSR, CODEMPSR) REFERENCES VDSETOR (CODSETOR, CODFILIAL, CODEMP);

ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTEFKVDTIPOC FOREIGN KEY (CODTIPOCLI, CODFILIALTI, CODEMPTI) REFERENCES VDTIPOCLI (CODTIPOCLI, CODFILIAL, CODEMP);

ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTEFKVDTRANS FOREIGN KEY (CODTRAN, CODFILIALTN, CODEMPTN) REFERENCES VDTRANSP (CODTRAN, CODFILIAL, CODEMP);

ALTER TABLE VDCLIENTE ADD CONSTRAINT VDCLIENTEFKVDVENDE FOREIGN KEY (CODVEND, CODFILIALVD, CODEMPVD) REFERENCES VDVENDEDOR (CODVEND, CODFILIAL, CODEMP);

ALTER TABLE VDCLIENTEFOR ADD CONSTRAINT VDCLIENTEFORFKCPFO FOREIGN KEY (CODFOR, CODFILIALFR, CODEMPFR) REFERENCES CPFORNECED (CODFOR, CODFILIAL, CODEMP);

ALTER TABLE VDCLIIMOV ADD CONSTRAINT VDCLIIMOVFKVDCLIEN FOREIGN KEY (CODCLI, CODFILIAL, CODEMP) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE VDCLIMETAVEND ADD CONSTRAINT VDCLIMETAVENDFKVDC FOREIGN KEY (CODCLI, CODFILIAL, CODEMP) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE VDCLIREFC ADD CONSTRAINT VDCLIREFCFKVDCLIEN FOREIGN KEY (CODCLI, CODFILIAL, CODEMP) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE VDCLIREFP ADD CONSTRAINT VDCLIREFPFKVDCLIEN FOREIGN KEY (CODCLI, CODFILIAL, CODEMP) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE VDCLISOCIOS ADD CONSTRAINT VDCLISOCIOSFKVDCLI FOREIGN KEY (CODCLI, CODFILIAL, CODEMP) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE VDCLITERRA ADD CONSTRAINT VDCLITERRAFKVDCLIE FOREIGN KEY (CODCLI, CODFILIAL, CODEMP) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE VDCLIVEIC ADD CONSTRAINT VDCLIVEICFKVDCLIEN FOREIGN KEY (CODCLI, CODFILIAL, CODEMP) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE VDCOMISSAO ADD CONSTRAINT VDCOMISFKVDVENDEDO FOREIGN KEY (CODVEND, CODFILIALVD, CODEMPVD) REFERENCES VDVENDEDOR (CODVEND, CODFILIAL, CODEMP);

ALTER TABLE VDCOMISSAO ADD CONSTRAINT VDCOMISSAOFKFNITRE FOREIGN KEY (CODREC, NPARCITREC, CODFILIALRC, CODEMPRC) REFERENCES FNITRECEBER (CODREC, NPARCITREC, CODFILIAL, CODEMP);

ALTER TABLE VDCOMISSAO ADD CONSTRAINT VDCOMISSAOFKFNPAGT FOREIGN KEY (CODPCOMI, CODFILIALCI, CODEMPCI) REFERENCES FNPAGTOCOMI (CODPCOMI, CODFILIAL, CODEMP);

ALTER TABLE VDCOMISSAO ADD CONSTRAINT VDCOMISSAOFKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE VDCOMISSAO ADD CONSTRAINT VDCOMISSAOFKVDVENDA FOREIGN KEY (CODVENDA, TIPOVENDA, CODFILIALVE, CODEMPVE) REFERENCES VDVENDA (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP);

ALTER TABLE VDCONSIGNACAO ADD CONSTRAINT VDCONSIGFKFNSUBLANCA FOREIGN KEY (CODSUBLANCA, CODLANCA, CODFILIALSL, CODEMPSL) REFERENCES FNSUBLANCA (CODSUBLANCA, CODLANCA, CODFILIAL, CODEMP) ON DELETE SET NULL;

ALTER TABLE VDCONSIGNACAO ADD CONSTRAINT VDCONSIGFKFNSUBLANCADEV FOREIGN KEY (CODSUBLANCASD, CODLANCASD, CODFILIALSD, CODEMPSD) REFERENCES FNSUBLANCA (CODSUBLANCA, CODLANCA, CODFILIAL, CODEMP) ON DELETE SET NULL;

ALTER TABLE VDCONSIGNACAO ADD CONSTRAINT VDCONSIGFKVDVEN FOREIGN KEY (CODVEND, CODFILIALVD, CODEMPVD) REFERENCES VDVENDEDOR (CODVEND, CODFILIAL, CODEMP);

ALTER TABLE VDCONTRATO ADD CONSTRAINT VDCONTRATOFKVDCLIENTE FOREIGN KEY (CODCLI, CODFILIALCL, CODEMPCL) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE VDCONTRATO ADD CONSTRAINT VDCONTRATOFKVDCONT FOREIGN KEY (CODCONTRSP, CODFILIALSP, CODEMPSP) REFERENCES VDCONTRATO (CODCONTR, CODFILIAL, CODEMP);

ALTER TABLE VDCONTRATO ADD CONSTRAINT VDCONTRATOFKVDMODCONT FOREIGN KEY (CODMODCONTR, CODFILIALMC, CODEMPMC) REFERENCES VDMODCONTR (CODMODCONTR, CODFILIAL, CODEMP);

ALTER TABLE VDCONTRORC ADD CONSTRAINT VDCONTRORCFKVDITCO FOREIGN KEY (CODCONTR, CODITCONTR, CODFILIAL, CODEMP) REFERENCES VDITCONTRATO (CODCONTR, CODITCONTR, CODFILIAL, CODEMP) ON UPDATE CASCADE ON DELETE CASCADE;

ALTER TABLE VDCONTRORC ADD CONSTRAINT VDCONTRORCFKVDITOR FOREIGN KEY (CODORC, CODITORC, TIPOORC, CODFILIALOR, CODEMPOR) REFERENCES VDITORCAMENTO (CODORC, CODITORC, TIPOORC, CODFILIAL, CODEMP);

ALTER TABLE VDDETORC ADD CONSTRAINT VDDETORCFKORCAMENT FOREIGN KEY (CODORC, TIPOORC, CODFILIAL, CODEMP) REFERENCES VDORCAMENTO (CODORC, TIPOORC, CODFILIAL, CODEMP);

ALTER TABLE VDFINCONTR ADD CONSTRAINT VDFINCONTRFKVDCONT FOREIGN KEY (CODCONTR, CODFILIAL, CODEMP) REFERENCES VDCONTRATO (CODCONTR, CODFILIAL, CODEMP);

ALTER TABLE VDFOTOPROD ADD CONSTRAINT VDFOTOPRODFKEQPROD FOREIGN KEY (CODPROD, CODFILIAL, CODEMP) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE VDFRETEVD ADD CONSTRAINT VDFRETEVDFKVDTRANS FOREIGN KEY (CODTRAN, CODFILIALTN, CODEMPTN) REFERENCES VDTRANSP (CODTRAN, CODFILIAL, CODEMP);

ALTER TABLE VDFRETEVD ADD CONSTRAINT VDFRETEVDFKVDVENDA FOREIGN KEY (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP) REFERENCES VDVENDA (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP);

ALTER TABLE VDGRUPORC ADD CONSTRAINT VDGRUPORCFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE VDITCONTRATO ADD CONSTRAINT VDITCONTRATOFKEQPRODPE FOREIGN KEY (CODPRODPE, CODFILIALPE, CODEMPPE) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE VDITCONTRATO ADD CONSTRAINT VDITCONTRATOFKEQPRODU FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE VDITCONTRATO ADD CONSTRAINT VDITCONTRATOFKVDCONTR FOREIGN KEY (CODCONTR, CODFILIAL, CODEMP) REFERENCES VDCONTRATO (CODCONTR, CODFILIAL, CODEMP);

ALTER TABLE VDITCONTRATOAND ADD CONSTRAINT VDITCONTRANDFKVDITCONTR FOREIGN KEY (CODCONTR, CODITCONTR, CODFILIAL, CODEMP) REFERENCES VDITCONTRATO (CODCONTR, CODITCONTR, CODFILIAL, CODEMP);

ALTER TABLE VDITCONTRATOFOR ADD CONSTRAINT VDITCONTRAFORFKFOR FOREIGN KEY (CODFOR, CODFILIALFR, CODEMP) REFERENCES CPFORNECED (CODFOR, CODFILIAL, CODEMP);

ALTER TABLE VDITCONTRATOFOR ADD CONSTRAINT VDITCONTRAFORFKVDI FOREIGN KEY (CODCONTR, CODITCONTR, CODFILIAL, CODEMP) REFERENCES VDITCONTRATO (CODCONTR, CODITCONTR, CODFILIAL, CODEMP);

ALTER TABLE VDITCUSTOORC ADD CONSTRAINT VDITCUSTOOCFKITORC FOREIGN KEY (CODORC, CODITORC, TIPOORC, CODFILIAL, CODEMP) REFERENCES VDITORCAMENTO (CODORC, CODITORC, TIPOORC, CODFILIAL, CODEMP) ON DELETE CASCADE;

ALTER TABLE VDITCUSTOVENDA ADD CONSTRAINT VDITCUSTOVDFKITVENDA FOREIGN KEY (CODVENDA, CODITVENDA, TIPOVENDA, CODFILIAL, CODEMP) REFERENCES VDITVENDA (CODVENDA, CODITVENDA, TIPOVENDA, CODFILIAL, CODEMP) ON UPDATE CASCADE ON DELETE CASCADE;

ALTER TABLE VDITDETORC ADD CONSTRAINT VDITDETORCFKVDDETO FOREIGN KEY (CODORC, TIPOORC, CODFILIAL, CODEMP) REFERENCES VDDETORC (CODORC, TIPOORC, CODFILIAL, CODEMP);

ALTER TABLE VDITDETORC ADD CONSTRAINT VDITDETORCFKVDITGO FOREIGN KEY (CODGO, SEQITGO, CODFILIALGO, CODEMPGO) REFERENCES VDITGRUPORC (CODGO, SEQITGO, CODFILIAL, CODEMP);

ALTER TABLE VDITGRUPORC ADD CONSTRAINT VDITGRUPORCFKVDGRU FOREIGN KEY (CODGO, CODFILIAL, CODEMP) REFERENCES VDGRUPORC (CODGO, CODFILIAL, CODEMP);

ALTER TABLE VDITKIT ADD CONSTRAINT VDITKITFKEQPRODUTO FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE VDITKIT ADD CONSTRAINT VDITKITFKVDKIT FOREIGN KEY (CODKIT, CODFILIAL, CODEMP) REFERENCES VDKIT (CODKIT, CODFILIAL, CODEMP);

ALTER TABLE VDITORCAMENTO ADD CONSTRAINT VDITORCAMENTOFKEQA FOREIGN KEY (CODALMOX, CODFILIALAX, CODEMPAX) REFERENCES EQALMOX (CODALMOX, CODFILIAL, CODEMP);

ALTER TABLE VDITORCAMENTO ADD CONSTRAINT VDITORCAMENTOFKEQL FOREIGN KEY (CODLOTE, CODPROD, CODFILIALLE, CODEMPLE) REFERENCES EQLOTE (CODLOTE, CODPROD, CODFILIAL, CODEMP);

ALTER TABLE VDITORCAMENTO ADD CONSTRAINT VDITORCAMENTOFKEQP FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE VDITORCAMENTO ADD CONSTRAINT VDITORCAMENTOFKSGL FOREIGN KEY (CODLOG, CODFILIALLG, CODEMPLG) REFERENCES SGLOG (CODLOG, CODFILIAL, CODEMP);

ALTER TABLE VDITORCAMENTO ADD CONSTRAINT VDITORCAMENTOFKVDO FOREIGN KEY (CODORC, TIPOORC, CODFILIAL, CODEMP) REFERENCES VDORCAMENTO (CODORC, TIPOORC, CODFILIAL, CODEMP);

ALTER TABLE VDITORCAMENTO ADD CONSTRAINT VDITORCAMENTOFKVDP FOREIGN KEY (CODPE, CODFILIALPE, CODEMPPE) REFERENCES VDPRAZOENT (CODPE, CODFILIAL, CODEMP);

ALTER TABLE VDITREGRACOMIS ADD CONSTRAINT VDITREGRACOMISFKRE FOREIGN KEY (CODREGRCOMIS, CODFILIAL, CODEMP) REFERENCES VDREGRACOMIS (CODREGRCOMIS, CODFILIAL, CODEMP);

ALTER TABLE VDITREGRACOMIS ADD CONSTRAINT VDITREGRACOMISFKTV FOREIGN KEY (CODTIPOVEND, CODFILIALTV, CODEMPTV) REFERENCES VDTIPOVEND (CODTIPOVEND, CODFILIAL, CODEMP);

ALTER TABLE VDITREGRACOMIS ADD CONSTRAINT VDITREGRACOMISFKVENDEDOR FOREIGN KEY (CODVEND, CODFILIALVD, CODEMPVD) REFERENCES VDVENDEDOR (CODVEND, CODFILIAL, CODEMP);

ALTER TABLE VDITROMANEIO ADD CONSTRAINT VDITROMANEIOFKVDRO FOREIGN KEY (CODROMA, CODFILIAL, CODEMP) REFERENCES VDROMANEIO (CODROMA, CODFILIAL, CODEMP);

ALTER TABLE VDITROMANEIO ADD CONSTRAINT VDITROMANEIOFKVDVE FOREIGN KEY (CODVENDA, TIPOVENDA, CODFILIALVA, CODEMPVA) REFERENCES VDVENDA (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP);

ALTER TABLE VDITVENDA ADD CONSTRAINT VDITVENDAFKATCONVE FOREIGN KEY (CODCONV, CODFILIALCV, CODEMPCV) REFERENCES ATCONVENIADO (CODCONV, CODFILIAL, CODEMP);

ALTER TABLE VDITVENDA ADD CONSTRAINT VDITVENDAFKCPITCOMPRA FOREIGN KEY (CODCOMPRA, CODITCOMPRA, CODFILIALCP, CODEMPCP) REFERENCES CPITCOMPRA (CODCOMPRA, CODITCOMPRA, CODFILIAL, CODEMP) ON UPDATE CASCADE ON DELETE SET NULL;

ALTER TABLE VDITVENDA ADD CONSTRAINT VDITVENDAFKEQALMOX FOREIGN KEY (CODALMOX, CODFILIALAX, CODEMPAX) REFERENCES EQALMOX (CODALMOX, CODFILIAL, CODEMP);

ALTER TABLE VDITVENDA ADD CONSTRAINT VDITVENDAFKEQLOTE FOREIGN KEY (CODLOTE, CODPROD, CODFILIALLE, CODEMPLE) REFERENCES EQLOTE (CODLOTE, CODPROD, CODFILIAL, CODEMP);

ALTER TABLE VDITVENDA ADD CONSTRAINT VDITVENDAFKEQPRODU FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE VDITVENDA ADD CONSTRAINT VDITVENDAFKEQSERIETMP FOREIGN KEY (NUMSERIETMP, CODPROD, CODFILIAL, CODEMP) REFERENCES EQSERIE (NUMSERIE, CODPROD, CODFILIAL, CODEMP);

ALTER TABLE VDITVENDA ADD CONSTRAINT VDITVENDAFKLFITCLFISCAL FOREIGN KEY (CODEMPIF, CODFILIALIF, CODFISC, CODITFISC) REFERENCES LFITCLFISCAL (CODEMP, CODFILIAL, CODFISC, CODITFISC) ON DELETE SET NULL;

ALTER TABLE VDITVENDA ADD CONSTRAINT VDITVENDAFKLFMENSA FOREIGN KEY (CODMENS, CODFILIALME, CODEMPME) REFERENCES LFMENSAGEM (CODMENS, CODFILIAL, CODEMP);

ALTER TABLE VDITVENDA ADD CONSTRAINT VDITVENDAFKLFNATOP FOREIGN KEY (CODNAT, CODFILIALNT, CODEMPNT) REFERENCES LFNATOPER (CODNAT, CODFILIAL, CODEMP);

ALTER TABLE VDITVENDA ADD CONSTRAINT VDITVENDAFKLFTRATT FOREIGN KEY (CODTRATTRIB, CODFILIALTT, CODEMPTT) REFERENCES LFTRATTRIB (CODTRATTRIB, CODFILIAL, CODEMP);

ALTER TABLE VDITVENDA ADD CONSTRAINT VDITVENDAFKSGLOG FOREIGN KEY (CODLOG, CODFILIALLG, CODEMPLG) REFERENCES SGLOG (CODLOG, CODFILIAL, CODEMP);

ALTER TABLE VDITVENDA ADD CONSTRAINT VDITVENDAFKVDPRAZO FOREIGN KEY (CODPE, CODFILIALPE, CODEMPPE) REFERENCES VDPRAZOENT (CODPE, CODFILIAL, CODEMP);

ALTER TABLE VDITVENDA ADD CONSTRAINT VDITVENDAFKVDVENDA FOREIGN KEY (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP) REFERENCES VDVENDA (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP);

ALTER TABLE VDITVENDAITVENDA ADD CONSTRAINT VDITVENDAFKITVEND1 FOREIGN KEY (CODVENDA, CODITVENDA, TIPOVENDA, CODFILIAL, CODEMP) REFERENCES VDITVENDA (CODVENDA, CODITVENDA, TIPOVENDA, CODFILIAL, CODEMP);

ALTER TABLE VDITVENDAITVENDA ADD CONSTRAINT VDITVENDAFKITVEND2 FOREIGN KEY (CODVENDAVO, CODITVENDAVO, TIPOVENDAVO, CODFILIALVO, CODEMPVO) REFERENCES VDITVENDA (CODVENDA, CODITVENDA, TIPOVENDA, CODFILIAL, CODEMP);

ALTER TABLE VDITVENDASERIE ADD CONSTRAINT VDITVENDASERIEFKSERIE FOREIGN KEY (NUMSERIE, CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQSERIE (NUMSERIE, CODPROD, CODFILIAL, CODEMP);

ALTER TABLE VDITVENDAVDITCONTR ADD CONSTRAINT VDITVENDACTFKVDCT FOREIGN KEY (CODCONTR, CODFILIALCT, CODEMPCT) REFERENCES VDCONTRATO (CODCONTR, CODFILIAL, CODEMP);

ALTER TABLE VDITVENDAVDITCONTR ADD CONSTRAINT VDITVENDACTFKVDITV FOREIGN KEY (CODVENDA, CODITVENDA, TIPOVENDA, CODFILIAL, CODEMP) REFERENCES VDITVENDA (CODVENDA, CODITVENDA, TIPOVENDA, CODFILIAL, CODEMP) ON UPDATE CASCADE;

ALTER TABLE VDKIT ADD CONSTRAINT VDKITFKEQPRODUTO FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE VDMODCONTR ADD CONSTRAINT VDMODCONTRFKCARTC FOREIGN KEY (CODCARTCOB, CODFILIALCB, CODEMPCB, CODBANCO, CODFILIALBO, CODEMPBO) REFERENCES FNCARTCOB (CODCARTCOB, CODFILIAL, CODEMP, CODBANCO, CODFILIALBO, CODEMPBO);

ALTER TABLE VDMODCONTR ADD CONSTRAINT VDMODCONTRFKFNBCO FOREIGN KEY (CODBANCO, CODFILIALBO, CODEMPBO) REFERENCES FNBANCO (CODBANCO, CODFILIAL, CODEMP);

ALTER TABLE VDMOTORISTA ADD CONSTRAINT VDMOTORISTAFKSGMUNIC FOREIGN KEY (CODMUNIC, SIGLAUF, CODPAIS) REFERENCES SGMUNICIPIO (CODMUNIC, SIGLAUF, CODPAIS);

ALTER TABLE VDMOTORISTA ADD CONSTRAINT VDMOTORISTAFKVDTRANSP FOREIGN KEY (CODTRAN, CODFILIALTN, CODEMPTN) REFERENCES VDTRANSP (CODTRAN, CODFILIAL, CODEMP);

ALTER TABLE VDOBSCLI ADD CONSTRAINT VDOBSCLIFKVDCLIENT FOREIGN KEY (CODCLI, CODFILIAL, CODEMP) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE VDORCAMENTO ADD CONSTRAINT VDORCAMENTFKVDTRAN FOREIGN KEY (CODTRAN, CODFILIALTN, CODEMPTN) REFERENCES VDTRANSP (CODTRAN, CODFILIAL, CODEMP);

ALTER TABLE VDORCAMENTO ADD CONSTRAINT VDORCAMENTOFKATATE FOREIGN KEY (CODATEND, CODFILIALAE, CODEMPAE) REFERENCES ATATENDENTE (CODATEND, CODFILIAL, CODEMP);

ALTER TABLE VDORCAMENTO ADD CONSTRAINT VDORCAMENTOFKATCON FOREIGN KEY (CODCONV, CODFILIALCV, CODEMPCV) REFERENCES ATCONVENIADO (CODCONV, CODFILIAL, CODEMP);

ALTER TABLE VDORCAMENTO ADD CONSTRAINT VDORCAMENTOFKATTIP FOREIGN KEY (CODTPCONV, CODFILIALTC, CODEMPTC) REFERENCES ATTIPOCONV (CODTPCONV, CODFILIAL, CODEMP);

ALTER TABLE VDORCAMENTO ADD CONSTRAINT VDORCAMENTOFKEQTIPOMOV FOREIGN KEY (CODTIPOMOV, CODFILIALTM, CODEMPTM) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE VDORCAMENTO ADD CONSTRAINT VDORCAMENTOFKFNPLA FOREIGN KEY (CODPLANOPAG, CODFILIALPG, CODEMPPG) REFERENCES FNPLANOPAG (CODPLANOPAG, CODFILIAL, CODEMP);

ALTER TABLE VDORCAMENTO ADD CONSTRAINT VDORCAMENTOFKVDCLC FOREIGN KEY (CODCLCOMIS, CODFILIALCM, CODEMPCM) REFERENCES VDCLCOMIS (CODCLCOMIS, CODFILIAL, CODEMP);

ALTER TABLE VDORCAMENTO ADD CONSTRAINT VDORCAMENTOFKVDCLI FOREIGN KEY (CODCLI, CODFILIALCL, CODEMPCL) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE VDORCAMENTO ADD CONSTRAINT VDORCAMENTOFKVDVEN FOREIGN KEY (CODVEND, CODFILIALVD, CODEMPVD) REFERENCES VDVENDEDOR (CODVEND, CODFILIAL, CODEMP);

ALTER TABLE VDPRECOPROD ADD CONSTRAINT VDPRECOPRODFKEQPRO FOREIGN KEY (CODPROD, CODFILIAL, CODEMP) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE VDPRECOPROD ADD CONSTRAINT VDPRECOPRODFKFNPLA FOREIGN KEY (CODPLANOPAG, CODFILIALPG, CODEMPPG) REFERENCES FNPLANOPAG (CODPLANOPAG, CODFILIAL, CODEMP);

ALTER TABLE VDPRECOPROD ADD CONSTRAINT VDPRECOPRODFKVDCLA FOREIGN KEY (CODCLASCLI, CODFILIALCC, CODEMPCC) REFERENCES VDCLASCLI (CODCLASCLI, CODFILIAL, CODEMP);

ALTER TABLE VDPRECOPROD ADD CONSTRAINT VDPRECOPRODFKVDTAB FOREIGN KEY (CODTAB, CODFILIALTB, CODEMPTB) REFERENCES VDTABPRECO (CODTAB, CODFILIAL, CODEMP);

ALTER TABLE VDPREVTRIBITORC ADD CONSTRAINT VDPREVITORCFKVDITORC FOREIGN KEY (CODORC, CODITORC, TIPOORC, CODFILIAL, CODEMP) REFERENCES VDITORCAMENTO (CODORC, CODITORC, TIPOORC, CODFILIAL, CODEMP) ON DELETE CASCADE;

ALTER TABLE VDREGCOMISDESC ADD CONSTRAINT VDREGCOMISDESCFKFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE VDREGRACOMIS ADD CONSTRAINT VDREGRACOMISFKEQSECAO FOREIGN KEY (CODSECAO, CODFILIALSC, CODEMPSC) REFERENCES EQSECAO (CODSECAO, CODFILIAL, CODEMP);

ALTER TABLE VDREMCONSIG ADD CONSTRAINT VDREMCONSIGFKEQPD FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP);

ALTER TABLE VDREMCONSIG ADD CONSTRAINT VDREMCONSIGFKVDCONSIG FOREIGN KEY (CODCONSIG, CODFILIAL, CODEMP) REFERENCES VDCONSIGNACAO (CODCONSIG, CODFILIAL, CODEMP);

ALTER TABLE VDROMANEIO ADD CONSTRAINT VDROMANEIOFKEQEXPEDICAO FOREIGN KEY (TICKET, CODFILIALEX, CODEMPEX) REFERENCES EQEXPEDICAO (TICKET, CODFILIAL, CODEMP);

ALTER TABLE VDROMANEIO ADD CONSTRAINT VDROMANEIOFKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE VDROMANEIO ADD CONSTRAINT VDROMANEIOFKVDTRANS FOREIGN KEY (CODTRAN, CODFILIALTN, CODEMPTN) REFERENCES VDTRANSP (CODTRAN, CODFILIAL, CODEMP);

ALTER TABLE VDSETOR ADD CONSTRAINT VDSETORFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE VDSETORROTA ADD CONSTRAINT VDSETORROTAFKCLIENTE FOREIGN KEY (CODCLI, CODFILIALCL, CODEMPCL) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE VDSTATUSORC ADD CONSTRAINT VDSTATUSORCFKSGITT FOREIGN KEY (CODITTB, CODTB, CODFILIALTB, CODEMPTB) REFERENCES SGITTABELA (CODITTB, CODTB, CODFILIAL, CODEMP);

ALTER TABLE VDSTATUSORC ADD CONSTRAINT VDSTATUSORCFKVDORC FOREIGN KEY (CODORC, TIPOORC, CODFILIAL, CODEMP) REFERENCES VDORCAMENTO (CODORC, TIPOORC, CODFILIAL, CODEMP);

ALTER TABLE VDTABPRECO ADD CONSTRAINT VDTABPRECOFKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE VDTEF ADD CONSTRAINT VDTEFFKVDVENDA FOREIGN KEY (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP) REFERENCES VDVENDA (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP);

ALTER TABLE VDTIPOCLI ADD CONSTRAINT VDTIPOCLIFKSGFILIA FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE VDTRANSP ADD CONSTRAINT VDTRANSPFKCPFORNECE FOREIGN KEY (CODFOR, CODFILIALFR, CODEMPFR) REFERENCES CPFORNECED (CODFOR, CODFILIAL, CODEMP);

ALTER TABLE VDTRANSP ADD CONSTRAINT VDTRANSPFKRHCODGPS FOREIGN KEY (CODGPS) REFERENCES RHCODGPS (CODGPS);

ALTER TABLE VDTRANSP ADD CONSTRAINT VDTRANSPFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE VDTRANSP ADD CONSTRAINT VDTRANSPFKSGMUNIC FOREIGN KEY (CODMUNIC, SIGLAUF, CODPAIS) REFERENCES SGMUNICIPIO (CODMUNIC, SIGLAUF, CODPAIS);

ALTER TABLE VDTRANSP ADD CONSTRAINT VDTRANSPFKSGUNIFCOD FOREIGN KEY (CODUNIFCOD, CODFILIALUC, CODEMPUC) REFERENCES SGUNIFCOD (CODUNIFCOD, CODFILIAL, CODEMP);

ALTER TABLE VDTRANSPMOT ADD CONSTRAINT VDTRANSPMOTFKMOT FOREIGN KEY (CODMOT, CODFILIALMT, CODEMPMT) REFERENCES VDMOTORISTA (CODMOT, CODFILIAL, CODEMP) ON DELETE CASCADE;

ALTER TABLE VDTRANSPMOT ADD CONSTRAINT VDTRANSPMOTFKTRANSP FOREIGN KEY (CODTRAN, CODFILIAL, CODEMP) REFERENCES VDTRANSP (CODTRAN, CODFILIAL, CODEMP) ON DELETE CASCADE;

ALTER TABLE VDTRANSPVEIC ADD CONSTRAINT VDTRANSPVEICFKTRANSP FOREIGN KEY (CODTRAN, CODFILIAL, CODEMP) REFERENCES VDTRANSP (CODTRAN, CODFILIAL, CODEMP) ON DELETE CASCADE;

ALTER TABLE VDTRANSPVEIC ADD CONSTRAINT VDTRANSPVEICFKVEICULO FOREIGN KEY (CODVEIC, CODFILIALVE, CODEMPVE) REFERENCES VDVEICULO (CODVEIC, CODFILIAL, CODEMP) ON DELETE CASCADE;

ALTER TABLE VDVEICULO ADD CONSTRAINT VDVEICULOFKSGMUNIC FOREIGN KEY (CODMUNIC, SIGLAUF, CODPAIS) REFERENCES SGMUNICIPIO (CODMUNIC, SIGLAUF, CODPAIS);

ALTER TABLE VDVEICULO ADD CONSTRAINT VDVEICULOFKVDTRANSP FOREIGN KEY (CODTRAN, CODFILIALTN, CODEMPTN) REFERENCES VDTRANSP (CODTRAN, CODFILIAL, CODEMP);

ALTER TABLE VDVENDA ADD CONSTRAINT VDVENDAFKCARTCOB FOREIGN KEY (CODCARTCOB, CODFILIALCB, CODEMPCB, CODBANCO, CODFILIALBO, CODEMPBO) REFERENCES FNCARTCOB (CODCARTCOB, CODFILIAL, CODEMP, CODBANCO, CODFILIALBO, CODEMPBO);

ALTER TABLE VDVENDA ADD CONSTRAINT VDVENDAFKEQRECMER FOREIGN KEY (TICKET, CODFILIALRM, CODEMPRM) REFERENCES EQRECMERC (TICKET, CODFILIAL, CODEMP);

ALTER TABLE VDVENDA ADD CONSTRAINT VDVENDAFKEQTIPOMOV FOREIGN KEY (CODTIPOMOV, CODFILIALTM, CODEMPTM) REFERENCES EQTIPOMOV (CODTIPOMOV, CODFILIAL, CODEMP);

ALTER TABLE VDVENDA ADD CONSTRAINT VDVENDAFKFNBANCO FOREIGN KEY (CODBANCO, CODFILIALBO, CODEMPBO) REFERENCES FNBANCO (CODBANCO, CODFILIAL, CODEMP);

ALTER TABLE VDVENDA ADD CONSTRAINT VDVENDAFKFNCONTA FOREIGN KEY (NUMCONTA, CODFILIALCA, CODEMPCA) REFERENCES FNCONTA (NUMCONTA, CODFILIAL, CODEMP);

ALTER TABLE VDVENDA ADD CONSTRAINT VDVENDAFKFNPLANOPA FOREIGN KEY (CODPLANOPAG, CODFILIALPG, CODEMPPG) REFERENCES FNPLANOPAG (CODPLANOPAG, CODFILIAL, CODEMP);

ALTER TABLE VDVENDA ADD CONSTRAINT VDVENDAFKFNTIPOCOB FOREIGN KEY (CODTIPOCOB, CODFILIALTC, CODEMPTC) REFERENCES FNTIPOCOB (CODTIPOCOB, CODFILIAL, CODEMP);

ALTER TABLE VDVENDA ADD CONSTRAINT VDVENDAFKLFSERIE FOREIGN KEY (SERIE, CODFILIALSE, CODEMPSE) REFERENCES LFSERIE (SERIE, CODFILIAL, CODEMP);

ALTER TABLE VDVENDA ADD CONSTRAINT VDVENDAFKPPOP FOREIGN KEY (CODOP, SEQOP, CODFILIALOP, CODEMPOP) REFERENCES PPOP (CODOP, SEQOP, CODFILIAL, CODEMP) ON DELETE SET NULL;

ALTER TABLE VDVENDA ADD CONSTRAINT VDVENDAFKPVCAIXA FOREIGN KEY (CODCAIXA, CODFILIALCX, CODEMPCX) REFERENCES PVCAIXA (CODCAIXA, CODFILIAL, CODEMP);

ALTER TABLE VDVENDA ADD CONSTRAINT VDVENDAFKSGFILIAL FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE VDVENDA ADD CONSTRAINT VDVENDAFKVDCLCOMIS FOREIGN KEY (CODCLCOMIS, CODFILIALCM, CODEMPCM) REFERENCES VDCLCOMIS (CODCLCOMIS, CODFILIAL, CODEMP);

ALTER TABLE VDVENDA ADD CONSTRAINT VDVENDAFKVDCLIENTE FOREIGN KEY (CODCLI, CODFILIALCL, CODEMPCL) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE VDVENDA ADD CONSTRAINT VDVENDAFKVDVENDEDO FOREIGN KEY (CODVEND, CODFILIALVD, CODEMPVD) REFERENCES VDVENDEDOR (CODVEND, CODFILIAL, CODEMP);

ALTER TABLE VDVENDACOMIS ADD CONSTRAINT VDVENDACOMISFKVDIT FOREIGN KEY (CODREGRCOMIS, SEQITRC, CODFILIALRC, CODEMPRC) REFERENCES VDITREGRACOMIS (CODREGRCOMIS, SEQITRC, CODFILIAL, CODEMP);

ALTER TABLE VDVENDACOMIS ADD CONSTRAINT VDVENDACOMISFKVEDA FOREIGN KEY (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP) REFERENCES VDVENDA (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP);

ALTER TABLE VDVENDACOMIS ADD CONSTRAINT VDVENDACOMISFKVEDO FOREIGN KEY (CODVEND, CODFILIALVD, CODEMPVD) REFERENCES VDVENDEDOR (CODVEND, CODFILIAL, CODEMP);

ALTER TABLE VDVENDACONSIG ADD CONSTRAINT VDVENDACONSIGFKEQPD FOREIGN KEY (CODPROD, CODFILIALPD, CODEMPPD) REFERENCES EQPRODUTO (CODPROD, CODFILIAL, CODEMP) ON DELETE SET NULL;

ALTER TABLE VDVENDACONSIG ADD CONSTRAINT VDVENDACONSIGFKFNPLP FOREIGN KEY (CODPLANOPAG, CODFILIALPG, CODEMPPG) REFERENCES FNPLANOPAG (CODPLANOPAG, CODFILIAL, CODEMP) ON DELETE SET NULL;

ALTER TABLE VDVENDACONSIG ADD CONSTRAINT VDVENDACONSIGFKFNSUBLANCA FOREIGN KEY (CODSUBLANCA, CODLANCA, CODFILIALSL, CODEMPSL) REFERENCES FNSUBLANCA (CODSUBLANCA, CODLANCA, CODFILIAL, CODEMP) ON DELETE SET NULL;

ALTER TABLE VDVENDACONSIG ADD CONSTRAINT VDVENDACONSIGFKFNSUBLANCASC FOREIGN KEY (CODSUBLANCASC, CODLANCASC, CODFILIALSC, CODEMPSC) REFERENCES FNSUBLANCA (CODSUBLANCA, CODLANCA, CODFILIAL, CODEMP) ON DELETE SET NULL;

ALTER TABLE VDVENDACONSIG ADD CONSTRAINT VDVENDACONSIGFKVDCL FOREIGN KEY (CODCLI, CODFILIALCL, CODEMPCL) REFERENCES VDCLIENTE (CODCLI, CODFILIAL, CODEMP);

ALTER TABLE VDVENDACONSIG ADD CONSTRAINT VDVENDACONSIGFKVDCO FOREIGN KEY (CODCONSIG, CODFILIAL, CODEMP) REFERENCES VDCONSIGNACAO (CODCONSIG, CODFILIAL, CODEMP);

ALTER TABLE VDVENDACONSIG ADD CONSTRAINT VDVENDACONSIGFKVDITVENDA FOREIGN KEY (CODVENDA, CODITVENDA, TIPOVENDA, CODFILIALVD, CODEMPVD) REFERENCES VDITVENDA (CODVENDA, CODITVENDA, TIPOVENDA, CODFILIAL, CODEMP) ON UPDATE CASCADE;

ALTER TABLE VDVENDAENTREGA ADD CONSTRAINT FKVDVENDAENTREGAVDVENDA FOREIGN KEY (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP) REFERENCES VDVENDA (CODVENDA, TIPOVENDA, CODFILIAL, CODEMP) ON DELETE CASCADE;

ALTER TABLE VDVENDAORC ADD CONSTRAINT VDVENDAORCFKVDITVE FOREIGN KEY (CODVENDA, CODITVENDA, TIPOVENDA, CODFILIAL, CODEMP) REFERENCES VDITVENDA (CODVENDA, CODITVENDA, TIPOVENDA, CODFILIAL, CODEMP) ON UPDATE CASCADE;

ALTER TABLE VDVENDAORC ADD CONSTRAINT VDVENDAORCFKVDORCA FOREIGN KEY (CODORC, CODITORC, TIPOORC, CODFILIALOR, CODEMPOR) REFERENCES VDITORCAMENTO (CODORC, CODITORC, TIPOORC, CODFILIAL, CODEMP);

ALTER TABLE VDVENDEDOR ADD CONSTRAINT VDVENDEDORFKEQSETOR FOREIGN KEY (CODSECAO, CODFILIALSC, CODEMPSC) REFERENCES EQSECAO (CODSECAO, CODFILIAL, CODEMP);

ALTER TABLE VDVENDEDOR ADD CONSTRAINT VDVENDEDORFKFNCONT FOREIGN KEY (NUMCONTA, CODFILIALCA, CODEMPCA) REFERENCES FNCONTA (NUMCONTA, CODFILIAL, CODEMP);

ALTER TABLE VDVENDEDOR ADD CONSTRAINT VDVENDEDORFKFNPLAN FOREIGN KEY (CODPLAN, CODFILIALPN, CODEMPPN) REFERENCES FNPLANEJAMENTO (CODPLAN, CODFILIAL, CODEMP);

ALTER TABLE VDVENDEDOR ADD CONSTRAINT VDVENDEDORFKRHFUNC FOREIGN KEY (CODFUNC, CODFILIALFU, CODEMPFU) REFERENCES RHFUNCAO (CODFUNC, CODFILIAL, CODEMP);

ALTER TABLE VDVENDEDOR ADD CONSTRAINT VDVENDEDORFKSGFILI FOREIGN KEY (CODFILIAL, CODEMP) REFERENCES SGFILIAL (CODFILIAL, CODEMP);

ALTER TABLE VDVENDEDOR ADD CONSTRAINT VDVENDEDORFKVDCLCO FOREIGN KEY (CODCLCOMIS, CODFILIALCM, CODEMPCM) REFERENCES VDCLCOMIS (CODCLCOMIS, CODFILIAL, CODEMP);

ALTER TABLE VDVENDEDOR ADD CONSTRAINT VDVENDEDORFKVDSETO FOREIGN KEY (CODSETOR, CODFILIALSE, CODEMPSE) REFERENCES VDSETOR (CODSETOR, CODFILIAL, CODEMP);

ALTER TABLE VDVENDEDOR ADD CONSTRAINT VDVENDEDORFKVDTIPO FOREIGN KEY (CODTIPOVEND, CODFILIALTV, CODEMPTV) REFERENCES VDTIPOVEND (CODTIPOVEND, CODFILIAL, CODEMP);

SET TERM ^ ;

CREATE OR ALTER  PROCEDURE EQCUSTOPRODSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODPROD INTEGER,
DTESTOQ DATE,
CTIPOCUSTO CHAR(1),
ICODEMPAX INTEGER,
SCODFILIALAX SMALLINT,
ICODALMOX INTEGER,
CCOMSALDO CHAR(10))
RETURNS (SLDPROD NUMERIC(15, 5),
CUSTOUNIT NUMERIC(15, 5),
CUSTOTOT NUMERIC(15, 5))
AS 
BEGIN SUSPEND; END ^

SET TERM ; ^

/* View: VWPROD_PRECO_CUSTO, Owner: SYSDBA */
CREATE VIEW VWPROD_PRECO_CUSTO (REFPROD, CODSECAO, DESCPROD, PRECOBASEPROD, CUSTO) AS





select pd.refprod, pd.codsecao, pd.descprod, pd.precobaseprod,
(case
when (select custounit from eqcustoprodsp(pd.codemp, pd.codfilial, pd.codprod,cast('today' as date),'M',pd.codempax, pd.codfilialax,pd.codalmox, null)) > 0
then (select custounit from eqcustoprodsp(pd.codemp, pd.codfilial, pd.codprod,cast('today' as date),'M',pd.codempax, pd.codfilialax,pd.codalmox, null))

else pd.custoinfoprod end) custo
from eqproduto pd

;

/* View: FNFLUXOCAIXAVW01, Owner: SYSDBA */
CREATE VIEW FNFLUXOCAIXAVW01 (ORDEM, TIPOLANCA, SUBTIPO, CODEMP, CODFILIAL, CODRECPAGLANC, NPARCRECPAGLANC, DTEMISSAO, DTCOMP, DTVENCTORECPAG, DOC, CODIGO, RAZAO, HISTORICO, VALOR) AS


select cast(1 as smallint) ordem,
'L' tipolanca,
(case when sl.codfor is null and sl.codcli is null then 'A' when sl.codfor is null then 'C' else 'F' end) subtipo,
sl.codemp, sl.codfilial, sl.codlanca codrecpaglanc, sl.codsublanca nparcrecpaglanc,
sl.dtcompsublanca dtemissao,
sl.dtcompsublanca dtcomp,
sl.datasublanca dtvenctorecpag,
l.doclanca doc,
(case when sl.codfor is null then sl.codcli else sl.codfor end) codigo,
(case when sl.codfor is null then cl.razcli else fl.razfor end) razao,
sl.histsublanca historico,
(sl.vlrsublanca*-1) valor
from fnlanca l, fnsublanca sl
left outer join vdcliente cl on
cl.codemp=sl.codempcl and cl.codfilial=sl.codfilialcl and cl.codcli=sl.codcli 
left outer join cpforneced fl on
fl.codemp=sl.codempfr and fl.codfilial=sl.codfilialfr and fl.codfor=sl.codfor
where l.codemp=sl.codemp and l.codfilial=sl.codfilial and l.codlanca=sl.codlanca and
sl.codpag is null and sl.codrec is null and sl.codsublanca<>0 and l.transflanca = 'N'
union all
select cast(2 as smallint) ordem,
'R' tipolanca,
'R' subtipo,
ir.codemp, ir.codfilial, ir.codrec codrecpaglanc, ir.nparcitrec nparcrecpaglanc,
r.datarec dtemissao,
ir.dtcompitrec dtcomp,
ir.dtvencitrec dtvenctorecpag,
ir.doclancaitrec doc,
r.codcli codigo,
c.razcli razao,
ir.obsitrec historico,
ir.vlrapagitrec valor
from fnreceber r, vdcliente c, fnitreceber ir
where ir.codemp=r.codemp and ir.codfilial=r.codfilial and ir.codrec=r.codrec and
c.codemp=r.codempcl and c.codfilial=r.codfilialcl and c.codcli=r.codcli and
ir.vlrapagitrec<>0 and ir.statusitrec not in ('CR')
union all
select cast(2 as smallint) ordem,
'R' tipolanca,
'L' subtipo,
ir.codemp, ir.codfilial, ir.codrec codrecpaglanc, ir.nparcitrec nparcrecpaglanc,
r.datarec dtemissao,
slr.dtcompsublanca dtcomp,
slr.datasublanca dtvenctorecpag,
lr.doclanca doc,
r.codcli codigo,
c.razcli razao,
slr.histsublanca historico,
slr.vlrsublanca*-1 valor
from fnreceber r, vdcliente c, fnitreceber ir, fnsublanca slr, fnlanca lr
where ir.codemp=r.codemp and ir.codfilial=r.codfilial and ir.codrec=r.codrec and
c.codemp=r.codempcl and c.codfilial=r.codfilialcl and c.codcli=r.codcli and
slr.codemprc=ir.codemp and slr.codfilialrc=ir.codfilial and slr.codrec=ir.codrec and slr.nparcitrec=ir.nparcitrec and
slr.codsublanca<>0 and
lr.codemp=slr.codemp and lr.codfilial=slr.codfilial and lr.codlanca=slr.codlanca and lr.transflanca = 'N'
union all
select cast(3 as smallint) ordem,
'P' tipolanca,
'P' subtipo,
ip.codemp, ip.codfilial, ip.codpag codrecpaglanc, ip.nparcpag nparcrecpaglanc,
p.datapag dtemissao,
ip.dtcompitpag dtcomp,
ip.dtvencitpag dtvenctorecpag,
ip.doclancaitpag doc,
f.codfor codigo,
f.razfor razao,
ip.obsitpag historico,
ip.vlrapagitpag*-1 valor
from fnpagar p, cpforneced f, fnitpagar ip
where ip.codemp=p.codemp and ip.codfilial=p.codfilial and ip.codpag=p.codpag and
f.codemp=p.codempfr and f.codfilial=p.codfilialfr and f.codfor=p.codfor and
ip.vlrapagitpag<>0 and ip.statusitpag not in ('CP')
union all
select cast(3 as smallint) ordem,
'P' tipolanca,
'L' subtipo,
ip.codemp, ip.codfilial, ip.codpag codrecpaglanc, ip.nparcpag nparcrecpaglanc,
p.datapag dtemissao,
slp.dtcompsublanca dtcomp,
slp.datasublanca dtvenctorecpag,
ip.doclancaitpag doc,
f.codfor codigo,
f.razfor razao,
slp.histsublanca historico,
slp.vlrsublanca*-1 valor
from fnpagar p, cpforneced f, fnitpagar ip, fnsublanca slp, fnlanca lp
where ip.codemp=p.codemp and ip.codfilial=p.codfilial and ip.codpag=p.codpag and
f.codemp=p.codempfr and f.codfilial=p.codfilialfr and f.codfor=p.codfor and
slp.codemppg=ip.codemp and slp.codfilialpg=ip.codfilial and slp.codpag=ip.codpag and slp.nparcpag=ip.nparcpag and slp.codsublanca<>0 and
lp.codemp=slp.codemp and lp.codfilial=slp.codfilial and lp.codlanca=slp.codlanca  and lp.transflanca = 'N'
;

CREATE VIEW FNRAZCLIVW01(
    CODEMPCL,
    CODFILIALCL,
    CODCLI,
    RAZCLI,
    CODEMPRC,
    CODFILIALRC,
    CODEMPSL,
    CODFILIALSL,
    CODEMPCP,
    CODFILIALCP,
    DATA,
    TIPO,
    TIPOSUBLANCA,
    DOC,
    VLRDEB,
    VLRCRED)
AS
-- Parcelas
select c.codemp codempcl, c.codfilial codfilialcl
, c.codcli, c.razcli
, r.codemp codemprc, r.codfilial codfilialrc
, null codempsl, null codfilialsl
, null codempcp, null codfilialcp
, r.datarec data
, 'Q' tipo, 'V' tiposublanca
, r.docrec doc, sum(ir.vlrparcitrec) vlrdeb, 0.00 vlrcred
from fnreceber r, vdcliente c, fnitreceber ir
where c.codemp=r.codempcl and c.codfilial=r.codfilialcl and c.codcli=r.codcli
and ir.codemp=r.codemp and ir.codfilial=r.codfilial and ir.codrec=r.codrec
group by 1, 2, 3, 4, 5, 6, 11, 14
union all
-- Pagamentos
select c.codemp codempcl, c.codfilial codfilialcl
, c.codcli, c.razcli
, null codemprc, null codfilialrc
, sl.codemp codempsl, sl.codfilial codfilialsl
, null codempcp, null codfilialcp
, sl.datasublanca data
, (case when sl.tiposublanca='P' then 'R' else 'X' end) tipo
, sl.tiposublanca, r.docrec doc
, (case when sl.tiposublanca in ('J','D','M') then sl.vlrsublanca*-1 else 0.00 end) vlrdeb,
sl.vlrsublanca vlrcred
from fnsublanca sl, fnreceber r, vdcliente c
where sl.codemprc=r.codemp and sl.codfilialrc=r.codfilial
and sl.codrec=r.codrec and c.codemp=r.codempcl and c.codfilial=r.codfilialcl
and c.codcli=r.codcli and sl.codsublanca<>0
union all
-- Cancelamento
select c.codemp codempcl, c.codfilial codfilialcl
, c.codcli, c.razcli
, r.codemp codemprc, r.codfilial codfilialrc
, null codempsl, null codfilialsl
, null codempcp, null codfilialcp
, ir.dtvencitrec data
, 'X' tipo, 'X' tiposublanca
, r.docrec doc, 0.00 vlrdeb, coalesce(sum(ir.vlrcancitrec),0)*-1 vlrcred
from fnreceber r, fnitreceber ir, vdcliente c
where r.codempcl=c.codemp and r.codfilialcl=c.codfilial and r.codcli=c.codcli
and ir.codemp=r.codemp and ir.codfilial=r.codfilial and ir.codrec=r.codrec
and ir.statusitrec in ('CR')
group by 1, 2, 3, 4, 5, 6, 11, 14
-- Devolues
union all
select c.codemp codempcl, c.codfilial codfilialcl
, c.codcli, c.razcli
, null codemprc, null codfilialrc
, null codempsl, null codfilialsl
, cp.codemp codempcp, cp.codfilial codfilialcp
, cp.dtentcompra data
, 'Z' tipo, 'Z' tiposublanca, cp.doccompra doc, 0.00 vlrdeb
, (cp.vlrliqcompra * -1) vlrcred
from cpcompra cp, eqtipomov tm, eqclifor cf, vdcliente c
where tm.codemp=cp.codemptm and tm.codfilial=cp.codfilialtm
and tm.codtipomov=cp.codtipomov and tm.estipomov='E' and tm.tipomov='DV'
and cf.codemp=c.codemp and cf.codfilial=c.codfilial and cf.codcli=c.codcli
and cp.codempfr=cf.codempfr and cp.codfilialfr=cf.codfilialfr and cp.codfor=cf.codfor
order by 3, 4, 11, 12, 14, 13
;

CREATE OR ALTER VIEW FNRAZFORVW01(
    CODEMPFR,
    CODFILIALFR,
    CODFOR,
    RAZFOR,
    CODEMPPG,
    CODFILIALPG,
    CODEMPSL,
    CODFILIALSL,
    CODEMPVD,
    CODFILIALVD,
    DATA,
    TIPO,
    TIPOSUBLANCA,
    DOC,
    VLRDEB,
    VLRCRED)
AS
-- Parcelas
select f.codemp codempfr, f.codfilial codfilialfr
, f.codfor codemit, f.razfor razemit
, p.codemp codemppg, p.codfilial codfilialpg
, null codempsl, null codfilialsl
, null codempvd, null codfilialvd
, p.datapag data
, 'C' tipo, 'C' tiposublanca
, p.docpag doc, 0.00 vlrdeb, sum(ip.vlrparcitpag) vlrcred
from fnpagar p, cpforneced f, fnitpagar ip
where f.codemp=p.codempfr and f.codfilial=p.codfilialfr and f.codfor=p.codfor
and ip.codemp=p.codemp and ip.codfilial=p.codfilial and ip.codpag=p.codpag
group by 1, 2, 3, 4, 5, 6, 11, 14
union all
-- Pagamentos
select f.codemp codempfr, f.codfilial codfilialfr
, f.codfor codemit, f.razfor razemit
, null codemppg, null codfilialpg
, sl.codemp codempsl, sl.codfilial codfilialsl
, null codempvd, null codfilialvd
, sl.datasublanca data
,  (case when sl.tiposublanca='P' then 'P' else 'X' end) tipo
, sl.tiposublanca, p.docpag doc
, sl.vlrsublanca vlrdeb, (case when sl.tiposublanca in ('J','D','M')
then sl.vlrsublanca else 0.00 end) vlrcred
from fnsublanca sl , cpforneced f, fnpagar p
where f.codemp=sl.codempfr and f.codfilial=sl.codfilialfr
and p.codemp=sl.codemppg and p.codfilial=sl.codfilialpg and p.codpag=sl.codpag
and f.codfor=sl.codfor and sl.codsublanca<>0 
union all
-- Cancelamento
select f.codemp codempfr, f.codfilial codfilialfr
, f.codfor, f.razfor
, p.codemp codemppg, p.codfilial codfilialpg
, null codempsl, null codfilialsl
, null codempvd, null codfilialvd
, ip.dtvencitpag data
, 'X' tipo, 'X' tiposublanca
, p.docpag doc, coalesce(sum(ip.vlrcancitpag),0) vlrdeb
, 0.00 vlrcred
from fnpagar p, fnitpagar ip, cpforneced f
where f.codemp=p.codempfr and f.codfilial=p.codfilialfr and p.codfor=f.codfor
and ip.codemp=p.codemp and ip.codfilial=p.codfilial and ip.codpag=p.codpag
and ip.statusitpag in ('CP')
group by 1, 2, 3, 4, 5, 6, 11, 14
union all
--  Devolues
select f.codemp codempfr, f.codfilial codfilialfr, f.codfor codemit, f.razfor razemit
, null codemppg, null codfilialpg
, null codempsl, null codfilialsl
, vd.codemp codempvd, vd.codfilialvd
, vd.dtemitvenda data
, 'Z' tipo, 'Z' tiposublanca, vd.docvenda doc, vd.vlrliqvenda vlrdeb, 0.00 vlrcred
from vdvenda vd, eqtipomov tm, eqclifor cf, cpforneced f
where tm.codemp=vd.codemptm and tm.codfilial=vd.codfilialtm and tm.codtipomov=vd.codtipomov
and tm.estipomov='S' and tm.tipomov='DV' and cf.codempfr=f.codemp and cf.codfilialfr=f.codfilial
and cf.codfor=f.codfor and vd.codempcl=cf.codemp and vd.codfilialcl=cf.codfilial
and vd.codcli=cf.codcli
;

/* View: TKCONTCLIVW01, Owner: SYSDBA */
CREATE VIEW TKCONTCLIVW01 (TIPOCTO, CODEMP, CODFILIAL, CODCTO, RAZCTO, NOMECTO, CONTCTO, EMAILCTO, OBSCTO, CODEMPTO, CODFILIALTO, CODTIPOCONT, CODEMPSR, CODFILIALSR, CODSETOR, CODEMPOC, CODFILIALOC, CODORIGCONT, CODEMPTI, CODFILIALTI, CODTIPOCLI, CODEMPCC, CODFILIALCC, CODCLASCLI, ATIVO, DTINS, DTALT, DTINSCC, DTALTCC) AS

select cast('O' as char(1)) tipocto,  co.codemp, co.codfilial, co.codcto,
co.razcto, co.nomecto, co.contcto, co.emailcto, co.obscto,
co.codempto, co.codfilialto, co.codtipocont,
co.codempsr, co.codfilialsr, co.codsetor,
co.codempoc, co.codfilialoc, co.codorigcont,
co.codempti, co.codfilialti, co.codtipocli,
cast(null as integer) codempcc, cast(null as smallint) codfilialcc, cast(null as integer) codclascli,
co.ativocto,
co.dtins, co.dtalt,
max(cc.dtins) dtinscc,
max(cc.dtalt) dtaltcc
from tkcontato co
left outer join tkcampanhacto cc on
cc.codempco=co.codemp and cc.codfilialco=co.codfilial and
cc.codcto=co.codcto
group by 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14
, 15, 16, 17, 18, 19, 20
, 21, 22, 23, 24, 25, 26, 27
;

/* View: TKCONTCLIVW02, Owner: SYSDBA */
CREATE VIEW TKCONTCLIVW02 (TIPOCTO, CODEMP, CODFILIAL, CODCTO, RAZCTO, NOMECTO, CONTCTO, EMAILCTO, OBSCTO, CODEMPTO, CODFILIALTO, CODTIPOCONT, CODEMPSR, CODFILIALSR, CODSETOR, CODEMPOC, CODFILIALOC, CODORIGCONT, CODEMPTI, CODFILIALTI, CODTIPOCLI, CODEMPCC, CODFILIALCC, CODCLASCLI, ATIVO, DTINS, DTALT, DTINSCC, DTALTCC) AS

select cast('C' as char(1)) tipocto, cl.codemp,  cl.codfilial, cl.codcli,
cl.razcli razcto, cl.nomecli nomecto, cl.contcli contcto, cl.emailcli emailcto, cl.obscli obscto,
cast(0 as integer) codempto, cast(0 as smallint) codfilialto, cast(0 as integer) codtipocont,
cl.codempsr, cl.codfilialsr, cl.codsetor,
cast(null as integer) codempoc, cast(null as smallint) codfilialoc, cast(null as integer) codorigcont,
cl.codempti, cl.codfilialti, cl.codtipocli,
cl.codempcc, cl.codfilialcc, cl.codclascli,
cl.ativocli,
cl.dtins, cl.dtalt,
max(cc.dtins) dtinscc,
max(cc.dtalt) dtaltcc
from vdcliente cl
left outer join tkcampanhacto cc on
cc.codempcl=cl.codemp and cc.codfilialcl=cl.codfilial and
cc.codcli=cl.codcli
group by 1,2, 3, 4, 5, 6, 7, 8, 9
, 10, 11, 12
, 13, 14 , 15, 16, 17, 18, 19, 20
, 21, 22, 23, 24, 25, 26, 27
;

/* View: TKCONTCLIVW03, Owner: SYSDBA */
CREATE VIEW TKCONTCLIVW03 (TIPOCTO, CODEMP, CODFILIAL, CODCTO, RAZCTO, NOMECTO, CONTCTO, EMAILCTO, OBSCTO, CODEMPTO, CODFILIALTO, CODTIPOCONT, CODEMPSR, CODFILIALSR, CODSETOR, CODEMPOC, CODFILIALOC, CODORIGCONT, CODEMPTI, CODFILIALTI, CODTIPOCLI, CODEMPCC, CODFILIALCC, CODCLASCLI, ATIVO, DTINS, DTALT, DTINSCC, DTALTCC) AS

select tipocto, codemp, codfilial, codcto
   , razcto, nomecto, contcto, emailcto, obscto
   , codempto, codfilialto, codtipocont
   , codempsr , codfilialsr, codsetor
   , codempoc, codfilialoc, codorigcont
   , codempti, codfilialti, codtipocli
   , codempcc, codfilialcc, codclascli
   , ativo
   , dtins,  dtalt, dtinscc, dtaltcc
   from tkcontclivw01
  union all
   select tipocto, codemp, codfilial, codcto
   , razcto, nomecto, contcto, emailcto, obscto
   , codempto, codfilialto, codtipocont
   , codempsr , codfilialsr, codsetor
   , codempoc, codfilialoc, codorigcont
   , codempti, codfilialti, codtipocli
   , codempcc, codfilialcc, codclascli
   , ativo
   , dtins,  dtalt, dtinscc, dtaltcc
      from tkcontclivw02
;

/* View: VDCONTRATOVW01, Owner: SYSDBA */
CREATE VIEW VDCONTRATOVW01 (IDX, INDICE, IDX01, IDX02, IDX03, IDX04, IDX05, TIPO, CODEMPCT, CODFILIALCT, CODCONTR
, DESCCONTR, CODEMPSC, CODFILIALSC, CODCONTRSC, DESCCONTRSC, CODITCONTR, DESCITCONTR, CODEMPTA, CODFILIALTA, CODTAREFA, DESCTAREFA
, CODEMPST, CODFILIALST, CODTAREFAST, DESCTAREFAST) AS


select 1 idx,
cast(ct.indexcontr as varchar(100)) indice,
ct.indexcontr idx01,
cast(0 as integer) idx02,
cast(0 as integer) idx03,
cast(0 as integer) idx04,
cast(0 as integer) idx05,
cast((case when ct.tpcontr='C' then 'CT' else 'PJ' end) as char(2))  tipo, ct.codemp codempct,
ct.codfilial codfilialct, ct.codcontr, ct.desccontr,
cast(null as  integer) codempsc, cast(null as smallint) codfilialsc,
cast(null as integer) codcontrsc, cast(null as char(80)) desccontrsc,
cast(null as smallint) coditcontr, cast(null as varchar(80)) descitcontr,
cast(null as integer) codempta,
cast(null as smallint) codfilialta,
cast(null as integer) codtarefa,
cast(null as varchar(100)) desctarefa,
cast(null as integer) codempst,
cast(null as smallint) codfilialst,
cast(null as integer) codtarefast,
cast(null as varchar(100)) desctarefast
from vdcontrato ct
where ct.tpcontr in ('C','P')
union all
select 1 idx,
cast(ct.indexcontr||'.'||sc.indexcontr as varchar(100)) indice,
ct.indexcontr idx01,
sc.indexcontr idx02,
cast(0 as integer) idx03,
cast(0 as integer) idx04,
cast(0 as integer) idx05,
cast((sc.tpcontr||ct.tpcontr) as char(2)) tipo, sc.codempsp codempct, sc.codfilialsp codfilialct, sc.codcontrsp codcontr, ct.desccontr,
sc.codemp codempsc, sc.codfilial codfilialsc, sc.codcontr codcontrsc, sc.desccontr desccontrsc,
cast(null as smallint) coditcontr, cast(null as varchar(80)) descitcontr,
cast(null as integer) codempta,
cast(null as smallint) codfilialta,
cast(null as integer) codtarefa,
cast(null as varchar(100)) desctarefa,
cast(null as integer) codempst,
cast(null as smallint) codfilialst,
cast(null as integer) codtarefast,
cast(null as varchar(100)) desctarefast
from vdcontrato sc, vdcontrato ct
where sc.tpcontr='S' and sc.codcontrsp is not null and
ct.codemp=sc.codempsp and ct.codfilial=sc.codfilialsp and ct.codcontr=sc.codcontrsp
union all
select 2 idx,
cast(ct.indexcontr||'.'||ic.indexitcontr as varchar(100)) indice,
ct.indexcontr idx01,
ic.indexitcontr idx02,
cast(0 as integer) idx03,
cast(0 as integer) idx04,
cast(0 as integer) idx05,
cast((case when ct.tpcontr='C' then 'IC' else 'IP' end) as char(2)) tipo, ct.codemp codempct,
ct.codfilial codfilialct, ct.codcontr, ct.desccontr,
cast(null as  integer) codempsc, cast(null as smallint) codfilialsc,
cast(null as integer) codcontrsc, cast(null as char(80) ) desccontrsc,
ic.coditcontr, ic.descitcontr,
cast(null as integer) codempta,
cast(null as smallint) codfilialta,
cast(null as integer) codtarefa,
cast(null as varchar(100)) desctarefa,
cast(null as integer) codempst,
cast(null as smallint) codfilialst,
cast(null as integer) codtarefast,
cast(null as varchar(100)) desctarefast
from vdcontrato ct, vditcontrato ic
where ct.tpcontr in ('C','P') and
ic.codemp=ct.codemp and ic.codfilial=ct.codfilial and ic.codcontr=ct.codcontr
union all
select 2 idx,
cast(ct.indexcontr||'.'||sc.indexcontr||'.'||ic.indexitcontr as varchar(100)) indice,
ct.indexcontr idx01,
sc.indexcontr idx02,
ic.indexitcontr idx03,
cast(0 as integer) idx04,
cast(0 as integer) idx05,
cast('IS' as char(2)) tipo, sc.codempsp codempct,
sc.codfilialsp codfilialct, sc.codcontrsp codcontr, ct.desccontr,
sc.codemp codempsc, sc.codfilial codfilialsc, sc.codcontr codcontrsc, sc.desccontr desccontrsc,
ic.coditcontr, ic.descitcontr,
cast(null as integer) codempta,
cast(null as smallint) codfilialta,
cast(null as integer) codtarefa,
cast(null as varchar(100)) desctarefa,
cast(null as integer) codempst,
cast(null as smallint) codfilialst,
cast(null as integer) codtarefast,
cast(null as varchar(100)) desctarefast
from vdcontrato sc, vdcontrato ct, vditcontrato ic
where sc.tpcontr='S' and sc.codcontrsp is not null and
ic.codemp=sc.codemp and ic.codfilial=sc.codfilial and ic.codcontr=sc.codcontr and
ct.codemp=sc.codempsp and ct.codfilial=sc.codfilialsp and ct.codcontr=sc.codcontrsp
union all
select 3 idx,
cast(ct.indexcontr||'.'||ic.indexitcontr||'.'||ta.indextarefa as varchar(100)) indice,
ct.indexcontr idx01,
ic.indexitcontr idx02,
ta.indextarefa idx03,
cast(0 as integer) idx04,
cast(0 as integer) idx05,
cast( 'TA' as char(2))  tipo, ct.codemp codempct,
ct.codfilial codfilialct, ct.codcontr, ct.desccontr desccontr,
cast(null as  integer) codempsc, cast(null as smallint) codfilialsc,
cast(null as integer) codcontrsc, cast(null as char(80)) desccontrsc,
ic.coditcontr, ic.descitcontr,
ta.codemp codempta,
ta.codfilial codfilialta,
ta.codtarefa,
ta.desctarefa,
cast(null as integer) codempst,
cast(null as smallint) codfilialst,
cast(null as integer) codtarefast,
cast(null as varchar(100)) desctarefast
from vdcontrato ct, vditcontrato ic, crtarefa ta
where ct.tpcontr in ('C','P') and
ic.codemp=ct.codemp and ic.codfilial=ct.codfilial and ic.codcontr=ct.codcontr and
ta.codempct=ic.codemp and ta.codfilialct=ic.codfilial and ta.codcontr=ic.codcontr and
ta.coditcontr=ic.coditcontr and ta.tipotarefa='T'
union all
select 3 idx,
cast(ct.indexcontr||'.'||sc.indexcontr||'.'||ic.indexitcontr||'.'||ta.indextarefa as varchar(100)) indice,
ct.indexcontr idx01,
sc.indexcontr idx02,
ic.indexitcontr idx03,
ta.indextarefa idx04,
cast(0 as integer) idx05,
cast('TA' as char(2)) tipo, sc.codempsp codempct, sc.codfilialsp codfilialct, sc.codcontrsp codcontr, ct.desccontr,
sc.codemp codempsc, sc.codfilial codfilialsc, sc.codcontr codcontrsc, sc.desccontr desccontrsc,
ic.coditcontr, ic.descitcontr,
ta.codemp codempta,
ta.codfilial codfilialta,
ta.codtarefa,
ta.desctarefa,
cast(null as integer) codempst,
cast(null as smallint) codfilialst,
cast(null as integer) codtarefast,
cast(null as varchar(100)) desctarefast
from vdcontrato sc, vdcontrato ct, vditcontrato ic, crtarefa ta
where sc.tpcontr='S' and sc.codcontrsp is not null and
ic.codemp=sc.codemp and ic.codfilial=sc.codfilial and ic.codcontr=sc.codcontr and
ct.codemp=sc.codempsp and ct.codfilial=sc.codfilialsp and ct.codcontr=sc.codcontrsp  and
ta.codempct=ic.codemp and ta.codfilialct=ic.codfilial and ta.codcontr=ic.codcontr and
ta.coditcontr=ic.coditcontr and ta.tipotarefa='T'
union all
select 4 idx,
cast(ct.indexcontr||'.'||ic.indexitcontr||'.'||ta.indextarefa||'.'||st.indextarefa as varchar(100)) indice,
ct.indexcontr idx01,
ic.indexitcontr idx02,
ta.indextarefa idx03,
st.indextarefa idx04,
cast( 0 as integer) indx05,
cast( 'ST' as char(2))  tipo, ct.codemp codempct,
ct.codfilial codfilialct, ct.codcontr, ct.desccontr desccontr,
cast(null as  integer) codempsc, cast(null as smallint) codfilialsc,
cast(null as integer) codcontrsc, cast(null as char(80)) desccontrsc,
ic.coditcontr, ic.descitcontr,
ta.codemp codempta,
ta.codfilial codfilialta,
ta.codtarefa,
ta.desctarefa,
st.codemp codempst,
st.codfilial codfilialst,
st.codtarefa codtarefast,
st.desctarefa desctarefast
from vdcontrato ct, vditcontrato ic, crtarefa ta, crtarefa st
where ct.tpcontr in ('C','P') and
ic.codemp=ct.codemp and ic.codfilial=ct.codfilial and ic.codcontr=ct.codcontr and
ta.codempct=ic.codemp and ta.codfilialct=ic.codfilial and ta.codcontr=ic.codcontr and
ta.coditcontr=ic.coditcontr and
st.codempta=ta.codemp and st.codfilialta=ta.codfilial and st.codtarefata=ta.codtarefa and
st.tipotarefa='S'
union all
select 4 idx,
cast(ct.indexcontr||'.'||sc.indexcontr||'.'||ic.indexitcontr||'.'||ta.indextarefa||'.'||st.indextarefa as varchar(100)) indice,
ct.indexcontr idx01,
sc.indexcontr idx02,
ic.indexitcontr idx03,
ta.indextarefa idx04,
st.indextarefa idx05,
cast('ST' as char(2)) tipo, sc.codempsp codempct, sc.codfilialsp codfilialct, sc.codcontrsp codcontr, ct.desccontr,
sc.codemp codempsc, sc.codfilial codfilialsc, sc.codcontr codcontrsc, sc.desccontr desccontrsc,
ic.coditcontr, ic.descitcontr,
ta.codemp codempta,
ta.codfilial codfilialta,
ta.codtarefa,
ta.desctarefa,
st.codemp codempst,
st.codfilial codfilialst,
st.codtarefa codtarefast,
st.desctarefa desctarefast
from vdcontrato sc, vdcontrato ct, vditcontrato ic, crtarefa ta, crtarefa st
where sc.tpcontr='S' and sc.codcontrsp is not null and
ic.codemp=sc.codemp and ic.codfilial=sc.codfilial and ic.codcontr=sc.codcontr and
ct.codemp=sc.codempsp and ct.codfilial=sc.codfilialsp and ct.codcontr=sc.codcontrsp  and
ta.codempct=ic.codemp and ta.codfilialct=ic.codfilial and ta.codcontr=ic.codcontr and
ta.coditcontr=ic.coditcontr and
st.codempta=ta.codemp and st.codfilialta=ta.codfilial and st.codtarefata=ta.codtarefa and
st.tipotarefa='S'
;

/* View: VWTMPCUSTOITRMA, Owner: SYSDBA */
CREATE VIEW VWTMPCUSTOITRMA (CODEMP, CODFILIAL, CODRMA, CODITRMA, CODPROD, CUSTODATA) AS


select ITR.CODEMP,ITR.CODFILIAL,ITR.CODRMA,ITR.CODITRMA,ITR.CODPROD,COALESCE((SELECT FIRST 1 MP.CUSTOMPMMOVPROD
    FROM EQMOVPROD MP
    WHERE MP.CODEMPPD=ITR.codemppd AND MP.CODFILIALPD=ITR.codfilialpd
    AND MP.CODPROD=ITR.codprod AND MP.dtmovprod <= rm.dtareqrma
    ORDER BY MP.DTMOVPROD DESC, MP.CODMOVPROD DESC),0) AS CUSTO
from eqitrma itr, eqrma rm where rm.codrma = itr.codrma;

/* View: PPLISTAOPVW01, Owner: SYSDBA */
CREATE VIEW PPLISTAOPVW01 (CODEMP, CODFILIAL, DTEMITOP, DTFABROP, CODOP, SEQOP, DESCEST, SITOP, TEMPOTOT, TEMPOFIN, FASEATUAL, TOTFASES, QTDSUG, QTDPREV, QTDFINAL, CODPROD, REFPROD, CODSECAO) AS



select op.codemp,op.codfilial,op.dtemitop, op.dtfabrop,op.codop, op.seqop, et.descest,op.sitop,
(select coalesce(sum( ef.tempoef ),0)
    from ppestrufase ef
    where
    ef.codemp=et.codemp and ef.codfilial=et.codfilial and ef.codprod=et.codprod and ef.seqest=et.seqest) as tempotot,
(select coalesce(sum( opf.tempoof ),0)
    from ppopfase opf
    where
    opf.codemp=op.codemp and opf.codfilial=op.codfilial and opf.codop=op.codop and opf.seqop=op.seqop
    and opf.sitfs='FN') as tempofin,
(select coalesce(min(opf.seqof),0) from ppopfase opf
    where
    opf.codemp=op.codemp and opf.codfilial=op.codfilial and opf.codop=op.codop and opf.seqop=op.seqop
    and opf.sitfs='PE') as faseatual,
(select count(*) from ppopfase opf
    where
    opf.codemp=op.codemp and opf.codfilial=op.codfilial and opf.codop=op.codop and opf.seqop=op.seqop) as totfases,
    op.qtdsugprodop,
    op.qtdprevprodop,
    op.qtdfinalprodop,
    pd.codprod, pd.refprod, pd.codsecao
from ppop op, ppestrutura et, eqproduto pd
where
et.codemp=op.codemppd and et.codfilial=op.codfilialpd and et.codprod=op.codprod and et.seqest=op.seqest
and pd.codemp=op.codemppd and pd.codfilial=op.codfilialpd and pd.codprod=op.codprod

;

/* View: EQCONFESTOQVW01, Owner: SYSDBA */
CREATE VIEW EQCONFESTOQVW01 (CODEMP, CODFILIAL, ATIVOPROD, DESCPROD, CODPROD, REFPROD, SLDLIQPROD, QTDINVP, QTDITCOMPRA, QTDFINALPRODOP, QTDEXPITRMA, QTDITVENDA, SLDMOVPROD, SLDLIQPRODAX) AS
SELECT P.CODEMP, P.CODFILIAL, P.ATIVOPROD, P.DESCPROD,P.CODPROD,P.REFPROD,P.SLDLIQPROD,
    COALESCE((SELECT SUM(QTDINVP)  FROM EQINVPROD IT WHERE IT.CODEMPPD=P.CODEMP AND
       IT.CODFILIALPD=P.CODFILIAL AND IT.CODPROD=P.CODPROD ),0) QTDINVP,
   COALESCE((SELECT SUM(QTDITCOMPRA)  FROM CPITCOMPRA IC, CPCOMPRA C, EQTIPOMOV TM
       WHERE IC.CODEMPPD=P.CODEMP AND IC.CODFILIALPD=P.CODFILIAL AND
       IC.CODPROD=P.CODPROD AND  C.CODCOMPRA=IC.CODCOMPRA AND
       C.CODEMP=IC.CODEMP AND C.CODFILIAL=IC.CODFILIAL AND  TM.CODTIPOMOV=C.CODTIPOMOV AND
       TM.CODEMP=C.CODEMPTM AND TM.CODFILIAL=C.CODFILIALTM AND TM.ESTOQTIPOMOV='S' ),0) QTDITCOMPRA,
   COALESCE((SELECT SUM(QTDFINALPRODOP) FROM PPOP O, EQTIPOMOV TM
      WHERE O.CODEMPPD=P.CODEMP AND O.CODFILIALPD=P.CODFILIAL AND O.CODPROD=P.CODPROD AND
      TM.CODTIPOMOV=O.CODTIPOMOV AND TM.CODEMP=O.CODEMPTM AND
      TM.CODFILIAL=O.CODFILIALTM  AND TM.ESTOQTIPOMOV='S' ),0) QTDFINALPRODOP,
   COALESCE((SELECT SUM(QTDEXPITRMA) FROM EQRMA R, EQITRMA IR, EQTIPOMOV TM  WHERE IR.CODEMPPD=P.CODEMP AND
      IR.CODFILIALPD=P.CODFILIAL AND IR.CODPROD=P.CODPROD AND  R.CODRMA=IR.CODRMA AND
      R.CODEMP=IR.CODEMP AND R.CODFILIAL=IR.CODFILIAL AND
      TM.CODTIPOMOV=R.CODTIPOMOV AND TM.CODEMP=R.CODEMPTM AND
      TM.CODFILIAL=R.CODFILIALTM  AND TM.ESTOQTIPOMOV='S' ),0) QTDEXPITRMA,
   COALESCE((SELECT SUM(QTDITVENDA) FROM VDITVENDA IV, VDVENDA V, EQTIPOMOV TM
      WHERE IV.CODEMPPD=P.CODEMP AND IV.CODFILIALPD=P.CODFILIAL AND IV.CODPROD=P.CODPROD AND
      V.CODVENDA=IV.CODVENDA AND V.TIPOVENDA=IV.TIPOVENDA AND
      V.CODEMP=IV.CODEMP AND V.CODFILIAL=IV.CODFILIAL AND
      (SUBSTR(V.STATUSVENDA,1,1) NOT IN ('C','N')) AND TM.CODTIPOMOV=V.CODTIPOMOV AND
      TM.CODEMP=V.CODEMPTM AND TM.CODFILIAL=V.CODFILIALTM  AND TM.ESTOQTIPOMOV='S' ),0) QTDITVENDA,
   COALESCE((SELECT FIRST 1 M.SLDMOVPROD FROM EQMOVPROD M WHERE M.CODEMPPD=P.CODEMP AND
      M.CODFILIALPD=P.CODFILIAL AND  M.CODPROD=P.CODPROD
      ORDER BY M.DTMOVPROD DESC, M.CODMOVPROD DESC ),0) SLDMOVPROD,
   COALESCE((SELECT SUM(SP.SLDLIQPROD) FROM EQSALDOPROD SP WHERE SP.CODEMP=P.CODEMP AND
      SP.CODFILIAL=P.CODFILIAL AND SP.CODPROD=P.CODPROD),0) SLDLIQPRODAX
   FROM EQPRODUTO P

;

/* View: VWCUSTOPROJ01, Owner: SYSDBA */
CREATE VIEW VWCUSTOPROJ01 (CODEMP, CODFILIAL, CODCLI, DATA, DESCCUSTO, CODCONTR, CODITCONTR, TPCONTR, VLRPREVREC, QTDCUSTO, VLRCUSTO, TIPOCUSTO) AS
select ad.codemp, ad.codfilial, ad.codcli, ad.dataatendo ,cast('Hora trabalhada - ' || rtrim(ae.nomeatend)  as varchar(200)) as desccusto, ad.codcontr
,ad.coditcontr, co.tpcontr ,ic.vlritcontr * ic.qtditcontr as vlrreceitaprev,
 ( ad.horaatendofin  - ad.horaatendo ) / 3600 as qtd , sa.custohoratrab as custo, 'M' as tipo
from
vditcontrato ic, atatendimento ad, atatendente ae, rhempregado em, rhempregadosal sa, vdcontrato co
where
ic.codemp=ad.codempct and ic.codfilial=ad.codfilialct and ic.codcontr=ad.codcontr and ic.coditcontr=ad.coditcontr and
co.codemp=ic.codemp and co.codfilial=ic.codfilial and co.codcontr=ic.codcontr and
ae.codemp=ad.codempae and ae.codfilial=ad.codfilialae and ae.codatend=ad.codatend and
em.codemp=ae.codempep and em.codfilial=ae.codfilialep and em.matempr=ae.matempr and
sa.codemp=em.codemp and sa.codfilial=em.codfilial and sa.matempr=em.matempr and sa.seqsal=
(
    select first 1 seqsal from rhempregadosal s1 where s1.codemp=em.codemp and
    s1.codfilial=em.codfilial and s1.matempr=em.matempr and
    s1.dtvigor < cast('today' as date) order by s1.dtvigor desc
)
-- Custos de outras despesas financeiras;
union
select sl.codemp, sl.codfilial, co.codcli, sl.datasublanca, cast(sl.histsublanca as varchar(200)) as desccusto, ic.codcontr, ic.coditcontr, co.tpcontr ,ic.vlritcontr * ic.qtditcontr as vlrreceitaprev,
1.00 as qtd, sl.vlrsublanca  as custo, 'F' as tipo
from
vditcontrato ic, vdcontrato co, fnsublanca sl, fnplanejamento pl
where
ic.codemp=sl.codempct and ic.codfilial=sl.codfilialct and ic.codcontr=sl.codcontr and ic.coditcontr=sl.coditcontr and
co.codemp=ic.codemp and co.codfilial=ic.codfilial and co.codcontr=ic.codcontr
and pl.codemp=sl.codemppn and pl.codfilial=sl.codfilialpn and pl.codplan=sl.codplan and pl.tipoplan='D'
union
--Custos de estoque
select ir.codemp, ir.codfilial, co.codcli, rma.dtaexprma, cast(pd.descprod as varchar(200)) as desccusto ,ic.codcontr, ic.coditcontr, co.tpcontr, ic.vlritcontr * ic.qtditcontr as vlrreceitaprev,
ir.qtdexpitrma as qtd, ir.precoitrma as custo, 'E' as tipo
from
vditcontrato ic, vdcontrato co, eqrma rma, eqitrma ir, eqproduto pd
where ic.codemp=rma.codempct and ic.codfilial=rma.codfilialct and ic.codcontr=rma.codcontr and ic.coditcontr=rma.coditcontr and
co.codemp=ic.codemp and co.codfilial=ic.codfilial and co.codcontr=ic.codcontr
and ir.codemp=rma.codemp and ir.codfilial=rma.codfilial and ir.codrma=rma.codrma and
pd.codemp=ir.codemppd and pd.codfilial=ir.codfilialpd and pd.codprod=ir.codprod and
ir.sitexpitrma='ET'

;

/* View: ATATENDIMENTOVW01, Owner: SYSDBA */
CREATE VIEW ATATENDIMENTOVW01 (CODEMP, CODFILIAL, CODATENDO, CODEMPAE, CODFILIALAE, CODATEND, NOMEATEND, PARTPREMIATEND
, CODEMPEP, CODFILIALEP, MATEMPR, COEMPEA, CODFILIALEA, CODESPEC, DESCESPEC, CODEMPCT, CODFILIALCT, CODCONTR, DESCCONTR
, CODITCONTR, CODEMPTA, CODFILIALTA, CODTAREFA, TPCOBCONTR, ANOATENDO, MESATENDO, QTDCONTR, QTDITCONTR, VLRITCONTR, VLRITCONTREXCED
, DTINICIO, STATUSATENDO, RAZCLI, NOMECLI, CODCLI, CODEMPCL, CODFILIALCL, CODEMPCH, CODFILIALCH, CODCHAMADO, DESCCHAMADO, CODEMPTO
, CODFILIALTO, CODTPATENDO, DESCTPATENDO, OBSATENDO, DATAATENDO, DATAATENDOFIN, HORAATENDO, HORAATENDOFIN, PGCOMIESPEC, COBCLIESPEC
, CONTMETAESPEC, MRELCOBESPEC, BHESPEC, TEMPOMINCOBESPEC, TEMPOMAXCOBESPEC, PERCCOMIESPEC, TOTALMIN, SITREVATENDO, SITCONTR
, DESCSITCONTR, DTPREVFIN, TIPOATENDO, DOCATENDO, CODEMPOC, CODFILIALOC, TIPOORC, CODORC
, IDUSUINS, DTINS, HINS, IDUSUALT, DTALT, HALT) AS
select a.codemp, a.codfilial, a.codatendo
  , a.codempae, a.codfilialae, a.codatend, ate.nomeatend, ate.partpremiatend, ate.codempep, codfilialep, matempr
  , a.codempea, a.codfilialea, a.codespec, e.descespec
  , a.codempct, a.codfilialct, a.codcontr, ct.desccontr, a.coditcontr 
  , a.codempta, a.codfilialta, a.codtarefa, ct.tpcobcontr
  , extract(year from a.dataatendo) anoatendo, extract(month from a.dataatendo) mesatendo
  , ( select sum(qtditcontr) from vditcontrato ics 
     where ics.codemp=a.codempct and ics.codfilial=a.codfilialct 
     and ics.codcontr=a.codcontr and ics.franquiaitcontr='S') qtdcontr 
  , ict.qtditcontr, ict.vlritcontr, ict.vlritcontrexced, ct.dtinicio
  , a.statusatendo, c.razcli, c.nomecli, c.codcli, c.codemp, c.codfilial
  , a.codempch, a.codfilialch, a.codchamado, ch.descchamado
  , a.codempto, a.codfilialto, a.codtpatendo, ta.desctpatendo
  , a.obsatendo, a.dataatendo, a.dataatendofin, a.horaatendo, a.horaatendofin
  , e.pgcomiespec, e.cobcliespec, e.contmetaespec, e.mrelcobespec, e.bhespec
  , e.tempomincobespec, e.tempomaxcobespec, e.perccomiespec, ((a.horaatendofin-a.horaatendo) / 60) TOTALMIN
  , a.sitrevatendo
  , ct.sitcontr, ct.descsitcontr, ct.dtprevfin, ta.tipoatendo, a.docatendo, atc.codempoc, atc.codfilialoc, atc.tipoorc, atc.codorc
  , a.idusuins, a.dtins, a.hins, a.idusualt, a.dtalt, a.halt
from  atatendimento a
inner join atatendente ate on
ate.codemp=a.codempae and ate.codfilial=a.codfilialae and ate.codatend=a.codatend
inner join vdcliente c on
c.codemp=a.codempcl and c.codfilial=a.codfilialcl and c.codcli=a.codcli
left outer join attipoatendo ta on
ta.codemp=a.codempto and ta.codfilial=a.codfilialto and ta.codtpatendo=a.codtpatendo
left outer join atespecatend e on
e.codemp=a.codempea and e.codfilial=a.codfilialea and e.codespec=a.codespec
left outer join crchamado ch on
ch.codemp=a.codempch and ch.codfilial=a.codfilialch and ch.codchamado=a.codchamado 
left outer join vdcontrato ct on
ct.codemp=a.codempct and ct.codfilial=a.codfilialct and ct.codcontr=a.codcontr
left outer join vditcontrato ict on
ict.codemp=a.codempct and ict.codfilial=a.codfilialct and ict.codcontr=a.codcontr and ict.coditcontr=a.coditcontr
left outer join atatendimentoorc atc on
atc.codemp=a.codemp and atc.codfilial=a.codfilial and atc.codatendo=a.codatendo
;

/* View: ATATENDIMENTOVW02, Owner: SYSDBA */
CREATE VIEW ATATENDIMENTOVW02 (CODEMP, CODFILIAL, CODATENDO, CODEMPAE, CODFILIALAE, CODATEND, NOMEATEND, PARTPREMIATEND
, CODEMPEP, CODFILIALEP, MATEMPR, CODEMPEA, CODFILIALEA, CODESPEC, DESCESPEC, CODEMPCT, CODFILIALCT, CODCONTR
, CODITCONTR, CODEMPTA, CODFILIALTA, CODTAREFA, TPCOBCONTR, ANOATENDO, MESATENDO, QTDCONTR, QTDITCONTR, VLRITCONTR
, VLRITCONTREXCED, DTINICIO, STATUSATENDO, RAZCLI, NOMECLI, CODCLI, CODEMPCL, CODFILIALCL, CODEMPCH, CODFILIALCH
, CODCHAMADO, DESCCHAMADO, CODEMPTO, CODFILIALTO, CODTPATENDO, DESCTPATENDO, OBSATENDO, DATAATENDO, DATAATENDOFIN
, HORAATENDO, HORAATENDOFIN, PGCOMIESPEC, COBCLIESPEC, CONTMETAESPEC, MRELCOBESPEC, BHESPEC, TEMPOMINCOBESPEC, TEMPOMAXCOBESPEC
, PERCCOMIESPEC, TOTALMIN, TOTALGERAL, TOTALMETA, TOTALCOMIS, TOTALCOBCLI, TOTALBH, SITREVATENDO, TIPOATENDO, DOCATENDO
, CODEMPOC, CODFILIALOC, TIPOORC, CODORC
, IDUSUINS, DTINS, HINS, IDUSUALT, DTALT, HALT) AS



select A.CODEMP, A.CODFILIAL, A.CODATENDO, 
A.CODEMPAE, A.CODFILIALAE, A.CODATEND, A.NOMEATEND, A.PARTPREMIATEND, A.CODEMPEP, CODFILIALEP, MATEMPR,
A.COEMPEA, A.CODFILIALEA, A.CODESPEC, A.DESCESPEC, 
 A.CODEMPCT, A.CODFILIALCT, A.CODCONTR,  A.CODITCONTR, A.CODEMPTA, A.CODFILIALTA, A.CODTAREFA, A.TPCOBCONTR,
 A.ANOATENDO, A.MESATENDO, A.QTDCONTR,
 A.QTDITCONTR, A.VLRITCONTR, A.VLRITCONTREXCED, A.DTINICIO,
 A.STATUSATENDO, A.RAZCLI, A.NOMECLI, A.CODCLI,
  A.CODEMPCL, A.CODFILIALCL, A.CODEMPCH, A.CODFILIALCH, A.CODCHAMADO, A.DESCCHAMADO,
  A.CODEMPTO, A.CODFILIALTO, A.CODTPATENDO,
   A.DESCTPATENDO, A.OBSATENDO, A.DATAATENDO, A.DATAATENDOFIN, A.HORAATENDO, A.HORAATENDOFIN,
    A.PGCOMIESPEC, A.COBCLIESPEC, A.CONTMETAESPEC, A.MRELCOBESPEC, A.BHESPEC, A.TEMPOMINCOBESPEC, A.TEMPOMAXCOBESPEC,
     A.PERCCOMIESPEC, A.TOTALMIN, 
  (a.totalmin) / 60  totalgeral, 
(( (case when a.contmetaespec='S' then (case when 
a.totalmin<a.tempomincobespec 
then a.tempomincobespec else 
(case when a.totalmin>a.tempomaxcobespec and a.tempomaxcobespec<>0 
then a.tempomaxcobespec else a.totalmin end) end)  else 0 end) 
)/60 ) totalmeta, 
(( (case when a.pgcomiespec='S' then (case when a.totalmin<a.tempomincobespec 
then a.tempomincobespec else 
(case when a.totalmin>a.tempomaxcobespec and a.tempomaxcobespec<>0 
then a.tempomaxcobespec else a.totalmin end) end)  else 0 end) 
)/60 ) totalcomis, 
(( (case when a.cobcliespec='S' and a.statusatendo<>'NC' then (case when a.totalmin<a.tempomincobespec 
then a.tempomincobespec else 
(case when a.totalmin>a.tempomaxcobespec and a.tempomaxcobespec<>0 
then a.tempomaxcobespec else a.totalmin end) end)  else 0 end) 
)/60 ) totalcobcli,
( (case when a.bhespec='S' then a.totalmin else 0 end)/60 ) totalbh,
a.sitrevatendo, a.tipoatendo, a.docatendo, a.codempoc, a.codfilialoc, a.tipoorc, a.codorc
, a.idusuins, a.dtins, a.hins, a.idusualt, a.dtalt, a.halt
from atatendimentovw01 a;

/* View: ATATENDIMENTOVW03, Owner: SYSDBA */
CREATE VIEW ATATENDIMENTOVW03 (CODEMP, CODFILIAL, CODATENDO, CODEMPAE, CODFILIALAE, CODATEND, NOMEATEND, PARTPREMIATEND, CODEMPEP, CODFILIALEP, MATEMPR, NOMEEMPR, DATAATENDO, HORAATENDO, HORAATENDOFIN, CODEMPTO, CODFILIALTO, CODTURNO, DESCTURNO, CODEMPEA, CODFILIALEA, CODESPEC, DESCESPEC, PERCCOMIESPEC, CODEMPCT, CODFILIALCT, CODCONTR, CODITCONTR, CODEMPTA, CODFILIALTA, CODTAREFA, TPCOBCONTR, ANOATENDO, MESATENDO, HORASEXPED, TOTALCOMIS, TOTALMIN, TOTALGERAL, TOTALBH, SITREVATENDO, TIPOATENDO, DOCATENDO, CODEMPOC, CODFILIALOC, TIPOORC, CODORC) AS



    select a.codemp, a.codfilial, a.codatendo, 
    a.codempae, a.codfilialae, a.codatend, a.nomeatend, a.partpremiatend,
     a.codempep, a.codfilialep, a.matempr, e.nomeempr,
     a.dataatendo, a.horaatendo, a.horaatendofin,
    e.codempto, e.codfilialto, e.codturno, t.descturno,
    a.codempea, a.codfilialea, a.codespec, a.descespec, a.perccomiespec,
    a.codempct, a.codfilialct, a.codcontr, a.coditcontr,
    a.codempta, a.codfilialta, a.codtarefa, 
    a.tpcobcontr,
    a.anoatendo, a.mesatendo, 
    x.horasexped, a.totalcomis, a.totalmin, a.totalgeral,
    ( a.totalbh * ( 1 +  
       ((case when extract(weekday from a.dataatendo)=6 then t.percbhtbsabturno 
          when extract(weekday from a.dataatendo)=0 then t.percbhtbdomturno
          when coalesce(f.trabfer,'N')='S' then t.percbhtbferturno
          else 0 end
       )/100 ) )
    ) totalbh,
    a.sitrevatendo, a.tipoatendo, a.docatendo, a.codempoc, a.codfilialoc, a.tipoorc, a.codorc
    from atatendimentovw02 a
    left outer join rhempregado e on
    e.codemp=a.codempep and e.codfilial=a.codfilialep and e.matempr=a.matempr
    left outer join rhturno t on
    t.codemp=e.codempto and t.codfilial=e.codfilialto and t.codturno=e.codturno
    left outer join rhexpedmes x on
    x.codemp=e.codempto and x.codfilial=e.codfilialto and x.codturno=e.codturno and 
    x.anoexped=extract(year from a.dataatendo) and x.mesexped=extract(month from a.dataatendo)
    left outer join sgferiado f on
    f.codemp=a.codemp and f.codfilial=a.codfilial and f.datafer=a.dataatendo;

/* View: ATATENDIMENTOVW04, Owner: SYSDBA */
CREATE VIEW ATATENDIMENTOVW04 (DATAATENDO, CODEMPCT, CODFILIALCT, CODCONTR, CODITCONTR, ANOATENDO, MESATENDO, TOTALHORASTRAB, CODEMPOC, CODFILIALOC, TIPOORC, CODORC) AS



select a.dataatendo, a.codempct, a.codfilialct, a.codcontr, a.coditcontr, a.anoatendo, a.mesatendo, sum(totalmin)/60 totalhorastrab, a.codempoc, a.codfilialoc, a.tipoorc, a.codorc
from atatendimentovw01 a
group by a.dataatendo, a.codempct, a.codfilialct, a.codcontr, a.coditcontr, a.anoatendo, a.mesatendo, a.codempoc, a.codfilialoc, a.tipoorc, a.codorc ;

/* View: ATATENDIMENTOVW05, Owner: SYSDBA */
CREATE VIEW ATATENDIMENTOVW05 (CODEMP, CODFILIAL, TIPOVENDA, CODVENDA, CODITVENDA, CODEMPCL, CODFILIALCL, CODCLI, SERIE, DOCVENDA, DTEMITVENDA, DTSAIDAVENDA, QTDITVENDA, PRECOITVENDA, VLRLIQITVENDA, CODEMPPD, CODFILIALPD, CODPROD, CODEMPCT, CODFILIALCT, CODCONTR, CODITCONTR, DTINIAPURA, DTFINAPURA) AS



select iv.codemp, iv.codfilial, iv.tipovenda, iv.codvenda, iv.coditvenda, 
v.codempcl, v.codfilialcl, v.codcli,
v.serie, v.docvenda, v.dtemitvenda, v.dtsaidavenda, iv.qtditvenda, iv.precoitvenda, iv.vlrliqitvenda,
iv.codemppd, iv.codfilialpd, iv.codprod,
ic.codempct, ic.codfilialct, ic.codcontr, ic.coditcontr, ic.dtiniapura, ic.dtfinapura 
from  vdvenda v, vditvenda iv
left outer join vditvendavditcontr ic
on ic.codemp=iv.codemp and ic.codfilial=iv.codfilial and ic.tipovenda=iv.tipovenda and 
ic.codvenda=iv.codvenda and ic.coditvenda=iv.coditvenda
where v.codemp=iv.codemp and v.codfilial=iv.codfilial and v.tipovenda=iv.tipovenda and 
v.codvenda=iv.codvenda and  
iv.qtditvenda is not null and 
iv.qtditvenda>0 ;

/* View: ATATENDIMENTOVW06, Owner: SYSDBA */
CREATE VIEW ATATENDIMENTOVW06 (CODEMP, CODFILIAL, CODATENDO, CODEMPAE, CODFILIALAE, CODATEND, NOMEATEND, CODEMPEP, CODFILIALEP, MATEMPR, NOMEEMPR, DATAATENDO, HORAATENDO, HORAATENDOFIN, CODEMPTO, CODFILIALTO, CODTURNO, DESCTURNO, CODEMPEA, CODFILIALEA, CODESPEC, DESCESPEC, PERCCOMIESPEC, CODEMPCT, CODFILIALCT, CODCONTR, CODITCONTR, TPCOBCONTR, ANOATENDO, MESATENDO, HORASEXPED, TOTALCOMIS, TOTALGERAL, TOTALBH, TOTALHORASTRAB, VLRLIQITVENDA, SITREVATENDO, CODEMPOC, CODFILIALOC, TIPOORC, CODORC) AS



select a.codemp, a.codfilial, a.codatendo, a.codempae, a.codfilialae, a.codatend, 
a.nomeatend, a.codempep, a.codfilialep, a.matempr, a.nomeempr, a.dataatendo, 
a.horaatendo, a.horaatendofin, a.codempto, a.codfilialto, a.codturno, a.descturno,
a.codempea, a.codfilialea, a.codespec, a.descespec, perccomiespec,
a.codempct, a.codfilialct, a.codcontr, a.coditcontr, a.tpcobcontr,
a.anoatendo, a.mesatendo, 
a.horasexped, a.totalcomis, a.totalgeral, a.totalbh,
 ( case when a.tpcobcontr='ES' then ( select s1.totalhorastrab from atatendimentovw04 s1
        where s1.codempct=a.codempct and s1.codfilialct=a.codfilialct and 
        s1.codcontr=a.codcontr and s1.coditcontr=a.coditcontr ) 
   else ( select s1.totalhorastrab from atatendimentovw04 s1
        where s1.codempct=a.codempct and s1.codfilialct=a.codfilialct and 
        s1.codcontr=a.codcontr and s1.coditcontr=a.coditcontr and 
        s1.anoatendo=a.anoatendo and s1.mesatendo=a.mesatendo ) end) totalhorastrab, 
  ( case when a.tpcobcontr='ES' then ( select s2.vlrliqitvenda from atatendimentovw05 s2
        where s2.codempct=a.codempct and s2.codfilialct=a.codfilialct and 
         s2.codcontr=a.codcontr and s2.coditcontr=a.coditcontr)
        else ( select s2.vlrliqitvenda from atatendimentovw05 s2
        where s2.codempct=a.codempct and s2.codfilialct=a.codfilialct and 
         s2.codcontr=a.codcontr and s2.coditcontr=a.coditcontr and
         a.dataatendo between s2.dtiniapura and s2.dtfinapura) end ) vlrliqitvenda,
   a.sitrevatendo, a.codempoc, a.codfilialoc, a.tipoorc, a.codorc
from atatendimentovw03 a;

/* View: ATATENDIMENTOVW07, Owner: SYSDBA */
CREATE VIEW ATATENDIMENTOVW07 (CODEMPCL, CODFILIALCL, CODCLI, RAZCLI, CODEMPCT, CODFILIALCT, CODCONTR, DESCCONTR, DESCSITCONTR, SITCONTR, TPCONTR, TPCOBCONTR, QTDCONTR, TOTHORAS) AS


select ct.codempcl, ct.codfilialcl, ct.codcli, cl.razcli,
 ct.codemp codempct, ct.codfilial codfilialct, ct.codcontr, ct.desccontr,
 ct.descsitcontr, ct.sitcontr, ct.tpcontr, ct.tpcobcontr,
 sum(it.qtditcontr) qtdcontr, sum((select sum( (a.horaatendofin-a.horaatendo) / 60/60) 
 from atatendimento a 
 where a.codempct=ct.codemp and a.codfilialct=ct.codfilial and a.codcontr=ct.codcontr and
 a.coditcontr=it.coditcontr
  ))  tothoras
 from vdcliente cl, vditcontrato it, vdcontrato ct
  where it.codemp=ct.codemp and it.codfilial=ct.codfilial and it.codcontr=ct.codcontr and
 cl.codemp=ct.codempcl and cl.codfilial=ct.codfilialcl and cl.codcli=ct.codcli 
  group by ct.codempcl, ct.codfilialcl, ct.codcli, cl.razcli,
 ct.codemp, ct.codfilial, ct.codcontr, ct.desccontr,
 ct.descsitcontr, ct.sitcontr, ct.tpcontr, ct.tpcobcontr
;

/* View: ATATENDIMENTOVW08, Owner: SYSDBA */
CREATE VIEW ATATENDIMENTOVW08 (DATAATENDO, DTFINCONTR, CODEMPAE, CODFILIALAE, CODATEND, NOMEATEND, CODEMPCT, CODFILIALCT, CODCONTR, CODITCONTR, DESCCONTR, DESCITCONTR, TPCOBCONTR, SITCONTR, TOTALCOMIS, CODEMPOC, CODFILIALOC, TIPOORC, CODORC) AS


select a.dataatendo, fn.dtfincontr, a.codempae, a.codfilialae, a.codatend, a.nomeatend,
a.codempct, a.codfilialct, a.codcontr, a.coditcontr, ct.desccontr, ic.descitcontr,
ct.tpcobcontr, ct.sitcontr,
sum(a.totalcomis) totalcomis, a.codempoc, a.codfilialoc, a.tipoorc, a.codorc
from atatendimentovw02 a, vditcontrato ic,  vdcontrato ct
left outer join vdfincontr fn
on fn.codemp=ct.codemp and fn.codfilial=ct.codfilial and
fn.codcontr=ct.codcontr
where ct.codemp=a.codempct and ct.codfilial=a.codfilialct and ct.codcontr=a.codcontr and
ic.codemp=a.codempct and ic.codfilial=a.codfilialct and ic.codcontr=a.codcontr and
ic.coditcontr=a.coditcontr and ct.recebcontr='S' and
( (ct.tpcobcontr='ES' and fn.dtfincontr is not null) or (ct.tpcobcontr='ME') )
group by a.dataatendo, fn.dtfincontr, a.codempae, a.codfilialae, a.codatend, a.nomeatend,
a.codempct, a.codfilialct, a.codcontr, a.coditcontr, ct.desccontr, ic.descitcontr,
ct.tpcobcontr, ct.sitcontr, a.codempoc, a.codfilialoc, a.tipoorc, a.codorc;

ALTER TABLE ATCONVENIADO ADD 
        CHECK (SEXOCONV IN ('M','F'));

ALTER TABLE VDTRANSP ADD 
        check (TIPOTRAN IN ('T','C','F','A'));

ALTER TABLE PVCAIXAIMP ADD 
        CONSTRAINT PVCAIXAIMPCK CHECK(IMPPAD IN ('S', 'N'));

ALTER TABLE RHEMPREGADOR ADD 
        CONSTRAINT RHEMPREGADOR01 CHECK(ATIVOEMPR IN ('S', 'N'));

ALTER TABLE SGPREFERE1 ADD 
        CONSTRAINT SGPREFERE1CK01 CHECK(usapedseq in ('S','N'));

ALTER TABLE SGPREFERE1 ADD 
        CONSTRAINT SGPREFERE1CK02 CHECK(tipoprecocusto in ('M','P'));

ALTER TABLE VDCLIENTE ADD 
        CONSTRAINT VDCLIENTECK01 CHECK(PESSOACLI IN ('F', 'J'));

ALTER TABLE VDCLIENTE ADD 
        CONSTRAINT VDCLIENTECK02 CHECK(ATIVOCLI IN ('S', 'N'));

/*  Exceptions */
CREATE EXCEPTION ATATENDIMENTOEX01 'Atendimento bloqueado!';
CREATE EXCEPTION ATATENDIMENTOEX02 'J existe(m) atendimento(s) para esta faixa de horrio !';
CREATE EXCEPTION CPCOMPRAEX03 'COMPRA NO PODE SER MAIS ALTERADA!';
CREATE EXCEPTION CPCOMPRAEX04 'VALOR DA COMPRA  DIFERENTE DO VALOR A RECEBER!';
CREATE EXCEPTION CPCOMPRAEX05 'Tipo de movimento no encontrado para gerao da compra.';
CREATE EXCEPTION CPITCOMPRAEX01 'PRODUTO NO PODE SER ALTERADO!';
CREATE EXCEPTION CPITCOMPRAEX02 'LOTE NO PODE SER ALTERADO!';
CREATE EXCEPTION CPITCOMPRAEX03 'Nmero de srie j registrado nessa compra!';
CREATE EXCEPTION CPITCOMPRAEX04 'No foi possvel encontrar natureza de operao para a compra!';
CREATE EXCEPTION CPITSOLICITACAO 'QUANTIDADE APROVADA MAIOR QUE A SOLICITADA!';
CREATE EXCEPTION CPITSOLICITACAOEX01 'PRODUTO NO PODE SER ALTERADO!';
CREATE EXCEPTION EQALMOX01 'ALMOXARIFADO NO PODE SER TROCADO!';
CREATE EXCEPTION EQINVPRODEX01 'O PRODUTO NO PODE SER ALTERADO!';
CREATE EXCEPTION EQINVPRODEX02 'O LOTE NO PODE SER ALTERADO!';
CREATE EXCEPTION EQINVPRODEX03 'A DATA NO PODE SER ALTERADA!';
CREATE EXCEPTION EQINVPRODEX04 'O ALMOXARIFADO NO PODE SER ALTERADO!';
CREATE EXCEPTION EQINVPRODEX05 'CDIGO DO LOTE  REQUERIDO';
CREATE EXCEPTION EQITRMA 'QUANTIDADE APROVADA MAIOR QUE A SOLICITADA!';
CREATE EXCEPTION EQITRMA01 'Item no pode ser excludo pois j est em andamento.';
CREATE EXCEPTION EQITRMA02 'Item no pode ser excludo pois foi criado por outro usurio.';
CREATE EXCEPTION EQLOTEEX01 'ESTOQUE DO LOTE ZERADO!';
CREATE EXCEPTION EQPRODUTOEX01 'ESTOQUE ZERADO!';
CREATE EXCEPTION EQSIMILAREX01 'Produto j foi agrupado!';
CREATE EXCEPTION EQTIPOMOVEX01 'MOVIMENTO DE COMPRA NO PODE TER TABELA DE PREO!';
CREATE EXCEPTION EQTIPOMOVEX02 'TABELA DE PREO EM BRANCO!';
CREATE EXCEPTION FNITPAGAREX01 'MOTIVO DO CANCELAMENTO EM BRANCO!';
CREATE EXCEPTION FNITPAGAREX02 'NO  PERMITIDO BAIXA PARCIAL DE TTULOS COM DESCONTO, MULTA OU JUROS !';
CREATE EXCEPTION FNITRECEBEREX01 'PARCELA J FOI PAGA!';
CREATE EXCEPTION FNITRECEBEREX02 'MOTIVO DO CANCELAMENTO EM BRANCO!';
CREATE EXCEPTION FNITRECEBEREX03 'NO  PERMITIDO BAIXA PARCIAL DE TTULOS COM DESCONTO, MULTA OU JUROS !';
CREATE EXCEPTION FNPAGAREX01 'PARCELA J FOI PAGA!';
CREATE EXCEPTION FNPLANEJAMENTO01 'Cdigo reduzido j foi definido, escolha outro cdigo.';
CREATE EXCEPTION FNRECEBEREX01 'Cliente inativo!';
CREATE EXCEPTION FNRECEBEREX02 'Cliente possui restries!';
CREATE EXCEPTION FNSALDOLANCAEX01 'O Caixa da data informada no permite novos lanamentos! Caixa fechado.';
CREATE EXCEPTION FNSUBLANCAEX01 'NO  POSSVEL ADICIONAR DOIS SUBLANAMENTOS PARA UMA TRANSFERNCIA!';
CREATE EXCEPTION FNSUBLANCAEX02 'CONTAS DE DESPESAS OU RECEITAS NO PODEM PARTICIPAR DE TRANSFERNCIAS!';
CREATE EXCEPTION FNSUBLANCAEX03 'CONTAS DE BANCOS OU CAIXAS S PODEM INTERAGIR EM TRANSFERNCIAS!';
CREATE EXCEPTION FNSUBLANCAEX04 'LANAMENTO COM VALOR ZERO!';
CREATE EXCEPTION FNSUBSLANCAEX01 'NO  POSSVEL ADICIONAR DOIS SUBLANAMENTOS PARA UMA TRANSFERNCIA!';
CREATE EXCEPTION FNSUBSLANCAEX02 'CONTAS DE DESPESAS OU RECEITAS NO PODEM PARTICIPAR DE TRANSFERNCIAS!';
CREATE EXCEPTION FNSUBSLANCAEX03 'CONTAS DE BANCOS OU CAIXAS S PODEM SE INTERAGIREM EM TRANSFERNCIAS!';
CREATE EXCEPTION PPESTRUFASE01 'J existe uma fase que finalizadora neste processo!';
CREATE EXCEPTION PPESTRUTURAEX01 'Estrutura no pode ser ativada, pois no possui uma fase finalizadora!';
CREATE EXCEPTION PPESTRUTURAEX02 'NO FOI POSSIVEL ATIVAR A ESTRUTURA, INSIRA UM SUBPRODUTO!';
CREATE EXCEPTION PPOPFASE 'Existem fases no concluidas para essa OP.';
CREATE EXCEPTION PVSEQCAIXA01 'FAIXA DE SEQUENCIA DO CAIXA NO DEFINIDA';
CREATE EXCEPTION PVSEQCAIXA02 'FAIXA DE SEQUENCIA DO CAIXA EXCEDIDA!';
CREATE EXCEPTION SGCONEXAOEX01 'Banco de dados est conectado com este usurio em outra filial!';
CREATE EXCEPTION SGCONEXAOEX02 'Usurio invlido.';
CREATE EXCEPTION SGFILIALEX01 'EMPRESA NO POSSUI MATRIZ!';
CREATE EXCEPTION SGFILIALEX02 'NO FOI POSSVEL ENCONTRAR FILIAL ATIVA PARA ESTE USURIO!';
CREATE EXCEPTION TKGERACAMANHACTO01 'No existe atendente vinculado ao usurio atual!';
CREATE EXCEPTION VDCLCOMISEX01 'PERCENTUAL TOTAL DE DISTRIBUIO INVLIDO!';
CREATE EXCEPTION VDCOMISSAOEX01 'COMISSAO JA FOI PAGA!';
CREATE EXCEPTION VDCOMISSAOEX02 'COMISSAO NAO FOI LIBERADA!';
CREATE EXCEPTION VDITVENDAEX01 'PRODUTO NO PODE SER ALTERADO!';
CREATE EXCEPTION VDITVENDAEX02 'LOTE NO PODE SER ALTERADO!';
CREATE EXCEPTION VDITVENDAEX03 'NO FOI POSSVEL ENCONTRAR A NATUREZA DA OPERAO PARA O TEM';
CREATE EXCEPTION VDITVENDAEX04 'Nmero de srie j registrado nessa venda!';
CREATE EXCEPTION VDITVENDAEX05 'Quantidade no pode ser alterada! Gerada por fat. parcial!';
CREATE EXCEPTION VDVENDAEX01 'ERRO LIVRE!!!!';
CREATE EXCEPTION VDVENDAEX02 'Venda no foi liberada!';
CREATE EXCEPTION VDVENDAEX03 'Valor ultrapassa o valor liberado!';
CREATE EXCEPTION VDVENDAEX04 'Valor ultrapassa o limite de crdito!';
CREATE EXCEPTION VDVENDAEX05 'ESTA VENDA FOI CANCELADA!';
CREATE EXCEPTION VDVENDAEX06 'O TOTAL DA NOTA NO CONFERE COM TOTAL DAS PARCELAS!';
CREATE EXCEPTION VDVENDAEX07 'VENDA BLOQUEADA !';
COMMIT WORK;
SET AUTODDL OFF;
SET TERM ^ ;

CREATE OR ALTER PROCEDURE PRO_RECURSIVO (IN_CHAVE VARCHAR(500))
RETURNS (OUT_CONTA INTEGER)
AS 
DECLARE VARIABLE V_ID BIGINT;
BEGIN

    V_ID = HASH(IN_CHAVE || '_' || CAST(CURRENT_TRANSACTION AS VARCHAR(1000)));

    SELECT CONTA FROM GTT_RECURSIVO WHERE ID = :V_ID INTO :OUT_CONTA;

    IF (OUT_CONTA IS NULL) THEN
    BEGIN
        OUT_CONTA = 0;
    END
    ELSE
    BEGIN
        OUT_CONTA = OUT_CONTA + 1;
    END

    UPDATE OR INSERT INTO GTT_RECURSIVO
    (
        ID,
        CONTA
    ) VALUES (
        :V_ID,
        :OUT_CONTA
    ) MATCHING (
        ID
    );

   SUSPEND;

END ^

/* Stored procedures */
CREATE PROCEDURE ARREDDOUBLE (DEVALOR NUMERIC(15, 5),
ICASASDEC INTEGER)
RETURNS (DERETORNO DOUBLE PRECISION)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE ATADICATENDIMENTOCLISP (ICODTIPOATENDO INTEGER,
ICODATEND INTEGER,
ICODSETOR INTEGER,
ICODEMP INTEGER,
ICODFILIAL INTEGER,
IDOC INTEGER,
DATAATENDO DATE,
DATAATENDOFIN DATE,
HORAATENDO TIME,
HORAATENDOFIN TIME,
OBSATENDO VARCHAR(10000),
CODEMPCL INTEGER,
CODFILIALCL SMALLINT,
CODCLI INTEGER,
CODEMPCT INTEGER,
CODFILIALCT INTEGER,
CODCONTR INTEGER,
CODITCONTR INTEGER,
CODREC INTEGER,
NPARCITREC INTEGER,
CODEMPCH INTEGER,
CODFILIALCH SMALLINT,
CODCHAMADO INTEGER,
OBSINTERNO VARCHAR(10000),
CONCLUICHAMADO CHAR(1),
CODEMPEA INTEGER,
CODFILIALEA SMALLINT,
CODESPEC INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE ATADICATENDIMENTOSP (ICODCONV INTEGER,
ICODTIPOATENDO INTEGER,
ICODATEND INTEGER,
ICODSETOR INTEGER,
VOBSATENDO VARCHAR(10000),
ICODEMP INTEGER,
ICODFILIAL INTEGER,
IDOC INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE ATATENDIMENTOIUSP (IU CHAR(1),
CODEMP INTEGER,
CODFILIAL SMALLINT,
CODATENDO INTEGER,
CODEMPTO INTEGER,
CODFILIALTO SMALLINT,
CODTPATENDO INTEGER,
CODEMPAE INTEGER,
CODFILIALAE SMALLINT,
CODATEND INTEGER,
CODEMPSA INTEGER,
CODFILIALSA SMALLINT,
CODSETOR INTEGER,
DOCATENDO INTEGER,
DATAATENDO DATE,
DATAATENDOFIN DATE,
HORAATENDO TIME,
HORAATENDOFIN TIME,
OBSATENDO VARCHAR(10000),
CODEMPCL INTEGER,
CODFILIALCL SMALLINT,
CODCLI INTEGER,
CODEMPCT INTEGER,
CODFILIALCT SMALLINT,
CODCONTR INTEGER,
CODITCONTR SMALLINT,
CODEMPIR INTEGER,
CODFILIALIR SMALLINT,
CODREC INTEGER,
NPARCITREC INTEGER,
CODEMPCH INTEGER,
CODFILIALCH SMALLINT,
CODCHAMADO INTEGER,
OBSINTERNO VARCHAR(10000),
CONCLUICHAMADO CHAR(1),
CODEMPEA INTEGER,
CODFILIALEA SMALLINT,
CODESPEC INTEGER,
CODEMPUS INTEGER,
CODFILIALUS SMALLINT,
IDUSU VARCHAR(128),
STATUSATENDO CHAR(2),
CODEMPTA INTEGER,
CODFILIALTA SMALLINT,
CODTAREFA INTEGER,
CODEMPOC INTEGER,
CODFILIALOC INTEGER,
TIPOORC CHAR(1),
CODORC INTEGER,
SITATENDO CHAR(2),
CODEMPAG INTEGER,
CODFILIALAG SMALLINT,
TIPOAGE CHAR(5),
CODAGE INTEGER,
CODAGD INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE ATBUSCAPRECOSP (ICODPROD INTEGER,
ICODCONV INTEGER,
ICODEMPCV INTEGER,
ICODFILIALCV SMALLINT,
ICODPLANOPAG INTEGER,
ICODEMPPG INTEGER,
ICODFILIALPG SMALLINT,
ICODEMP INTEGER,
ICODFILIAL SMALLINT)
RETURNS (PRECO NUMERIC(15, 5))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE ATRESUMOATENDOSP01 (CODEMPP INTEGER,
CODFILIALP SMALLINT,
CODCLIP INTEGER,
CODEMPCTP INTEGER,
CODFILIALCTP SMALLINT,
CODCONTRP INTEGER,
CODITCONTRP SMALLINT,
DTINIP DATE,
DTFIMP DATE)
RETURNS (ANO SMALLINT,
MES SMALLINT,
CODEMPCL INTEGER,
CODFILIALCL SMALLINT,
CODCLI INTEGER,
CODEMPCT INTEGER,
CODFILIALCT SMALLINT,
CODCONTR INTEGER,
QTDCONTR DECIMAL(15, 5),
DTINICIO DATE,
VALOR DECIMAL(15, 5),
VALOREXCEDENTE DECIMAL(15, 5),
QTDITCONTR DECIMAL(15, 5),
QTDHORAS DECIMAL(15, 2),
MESCOB INTEGER,
SALDOMESCOB DECIMAL(15, 5),
SALDOMES DECIMAL(15, 5),
SALDOPERIODO DECIMAL(15, 5),
EXCEDENTEMESCOB DECIMAL(15, 5),
EXCEDENTEPERIODO DECIMAL(15, 5),
EXCEDENTECOB DECIMAL(15, 5),
VALOREXCEDENTECOB DECIMAL(15, 5),
VALORTOTALCOB DECIMAL(15, 5),
VALORCONTR DECIMAL(15, 5),
EXCEDENTEMES DECIMAL(15, 5),
TOTFRANQUIAMES DECIMAL(15, 5))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE ATRESUMOATENDOSP02 (CODEMPCLP INTEGER,
CODFILIALCLP SMALLINT,
CODCLIP INTEGER,
CODEMPCTP INTEGER,
CODFILIALCTP SMALLINT,
CODCONTRP INTEGER,
CODITCONTRP SMALLINT,
DTINIP DATE,
DTFIMP DATE)
RETURNS (CODEMPCL INTEGER,
CODFILIALCL SMALLINT,
CODCLI INTEGER,
RAZCLI VARCHAR(60),
CODEMPCT INTEGER,
CODFILIALCT SMALLINT,
CODITCONTR INTEGER,
CODCONTR INTEGER,
DESCCONTR VARCHAR(100),
VLRHORA DECIMAL(15, 5),
VLRHORAEXCED DECIMAL(15, 5),
QTDCONTR DECIMAL(15, 5),
QTDITCONTR DECIMAL(15, 5),
VLRCOB DECIMAL(15, 5),
VLRCOBEXCED DECIMAL(15, 5),
VLRCOBTOT DECIMAL(15, 5),
MES SMALLINT,
ANO SMALLINT,
QTDHORAS DECIMAL(15, 5),
SALDOMES DECIMAL(15, 5),
EXCEDENTEMES DECIMAL(15, 5),
EXCEDENTEMESCOB DECIMAL(15, 5),
ACUMULO SMALLINT,
CDATAINI DATE)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE CPADICCOMPRAPEDSP (CODEMP INTEGER,
CODFILIAL SMALLINT,
CODCOMPRA INTEGER,
DOCCOMPRA INTEGER,
CODEMPTM INTEGER,
CODFILIALTM SMALLINT,
CODTIPOMOV INTEGER,
CODEMPFR INTEGER,
CODFILIALFR SMALLINT,
CODFOR INTEGER,
CODEMPPG INTEGER,
CODFILIALPG SMALLINT,
CODPLANOPAG INTEGER)
RETURNS (IRET INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE CPADICFORSP (CODEMP INTEGER,
CODFILIAL INTEGER,
CODFILIALCL INTEGER,
CODCLI INTEGER)
RETURNS (CODFOR INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE CPADICITCOMPRAPEDSP (CODEMP INTEGER,
CODFILIAL SMALLINT,
CODCOMPRA INTEGER,
CODEMPPC INTEGER,
CODFILIALPC SMALLINT,
CODCOMPRAPC INTEGER,
CODITCOMPRAPC INTEGER,
TPAGRUP CHAR(1),
QTDITCOMPRA FLOAT,
VLRDESCITCOMPRA NUMERIC(15, 5),
PRECOITCOMPRA NUMERIC(15, 5))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE CPADICITCOMPRARECMERCSP (CODEMP INTEGER,
CODFILIAL SMALLINT,
TICKET INTEGER,
CODEMPCP INTEGER,
CODFILIALCP SMALLINT,
CODCOMPRA INTEGER,
QTDITCOMPRA NUMERIC(15, 5))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE CPBLOQCOMPRASP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODCOMPRA INTEGER,
CBLOQCOMPRA CHAR(1))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE CPCOMPRASP01 (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
NQTD NUMERIC(15, 5),
NVLRTOT NUMERIC(15, 5),
NVLRICMS NUMERIC(15, 5),
ADICFRETE CHAR(1),
VLRFRETE NUMERIC(15, 5),
ADICADIC CHAR(1),
VLRADIC NUMERIC(15, 5))
RETURNS (NVLRCUSTO NUMERIC(15, 5))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE CPGERADEVOLUCAOSP (CODEMP INTEGER,
CODFILIAL SMALLINT,
CODCOMPRA INTEGER,
CODITCOMPRA SMALLINT,
CODEMPVD INTEGER,
CODFILIALVD SMALLINT,
CODVENDA INTEGER,
CODITVENDA INTEGER,
TIPOVENDA CHAR(2),
QTDDEV NUMERIC(15, 5))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE CPGERAENTRADASP (CODEMP INTEGER,
CODFILIAL INTEGER,
CODFILIALVD INTEGER,
TIPOVENDA CHAR(1),
CODVENDA INTEGER,
CITEM CHAR(1))
RETURNS (CODCOMPRA INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE CPGERAITENTRADASP (CODEMP INTEGER,
CODFILIAL INTEGER,
CODCOMPRA INTEGER,
CODFILIALVD INTEGER,
TIPOVENDA CHAR(1),
CODVENDA INTEGER,
CODITVENDA INTEGER,
QTDIT INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE CPITCOMPRASERIESP (TRANSACAO CHAR(1),
CODEMP INTEGER,
CODFILIAL SMALLINT,
CODCOMPRA INTEGER,
CODITCOMPRA SMALLINT,
CODEMPPD INTEGER,
CODFILIALPD SMALLINT,
CODPROD INTEGER,
NUMSERIETMP VARCHAR(30),
QTDITCOMPRA INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE CPREORGCOMPRASP (CODEMP INTEGER,
CODFILIAL SMALLINT,
CODCOMPRA INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE CPUPCOMPRAPEDSP (CODEMPCP INTEGER,
CODFILIALCP SMALLINT,
CODCOMPRACP INTEGER,
CODITCOMPRACP INTEGER,
CODEMPPC INTEGER,
CODFILIALPC SMALLINT,
CODCOMPRAPC INTEGER,
CODITCOMPRAPC INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE CRCARREGAPONTOSP (CODEMP INTEGER,
CODFILIAL SMALLINT,
IDUSU VARCHAR(128),
AFTELA CHAR(1),
TOLREGPONTO SMALLINT)
RETURNS (CARREGAPONTO CHAR(1),
DATAPONTO DATE,
HORAPONTO TIME,
CODEMPAE INTEGER,
CODFILIALAE SMALLINT,
CODATEND INTEGER,
CODEMPEP INTEGER,
CODFILIALEP SMALLINT,
MATEMPR INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE CRINSEREBATIDASP (CODEMP INTEGER,
CODFILIAL SMALLINT,
DTBAT DATE,
HBAT TIME,
CODEMPEP INTEGER,
CODFILIALEP SMALLINT,
MATEMPR INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE CRTOTAL01ISP (CODEMP INTEGER,
CODFILIAL INTEGER)
RETURNS (SEQTOT INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE CRTOTAL02TAREFASP (CODEMPTA INTEGER,
CODFILIALTA INTEGER,
CODTAREFA INTEGER,
HINIOLD TIME,
HFINOLD TIME,
HININEW TIME,
HFINNEW TIME)
RETURNS (HORAOLD DECIMAL(15, 2),
HORANEW DECIMAL(15, 2),
TEMPOFINOLD TIME,
TEMPOINIOLD TIME,
TEMPOFINNEW TIME,
TEMPOININEW TIME,
INTERVALOOLD INTEGER,
INTERVALONEW INTEGER,
TOTALMINOLD INTEGER,
TOTALMINNEW INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE EQACERTACUSTORMASP AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE EQADICPRODUTOSP (CODEMPPD INTEGER,
CODFILIALPD INTEGER,
CODPROD INTEGER,
DESCPROD VARCHAR(100),
DESCAUXPROD VARCHAR(40),
REFPROD VARCHAR(20),
CODFABPROD CHAR(15),
CODBARPROD CHAR(13),
CODEMPMG INTEGER,
CODFILIALMG SMALLINT,
CODMODG INTEGER,
DESCCOMPPROD VARCHAR(500),
PRECOBASE DECIMAL(15, 5),
ATUALIZAPROD CHAR(1))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE EQBUSCASIMILARSP (CODEMP INTEGER,
CODFILIAL CHAR(8),
IPROD INTEGER,
SREFPROD VARCHAR(20))
RETURNS (SRET CHAR(13),
IRET INTEGER,
CORIG CHAR(1),
ICODFOR INTEGER,
SRAZFOR CHAR(60),
NPRECO NUMERIC(15, 5),
SSIM CHAR(18),
SSIMMASTER CHAR(18))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE EQCALCPEPSSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODPROD INTEGER,
NSLDPROD NUMERIC(15, 5),
DTESTOQ DATE,
ICODEMPAX INTEGER,
SCODFILIALAX SMALLINT,
ICODALMOX INTEGER)
RETURNS (NCUSTOPEPS NUMERIC(15, 5))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE EQCOPIAPROD (ICODPROD INTEGER,
ICODEMP INTEGER,
ICODFILIAL INTEGER)
RETURNS (ICOD INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE OR ALTER  PROCEDURE EQCUSTOPRODSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODPROD INTEGER,
DTESTOQ DATE,
CTIPOCUSTO CHAR(1),
ICODEMPAX INTEGER,
SCODFILIALAX SMALLINT,
ICODALMOX INTEGER,
CCOMSALDO CHAR(10))
RETURNS (SLDPROD NUMERIC(15, 5),
CUSTOUNIT NUMERIC(15, 5),
CUSTOTOT NUMERIC(15, 5))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE EQGERARMAOSSP (CODEMPRM INTEGER,
CODFILIALRM INTEGER,
TICKET INTEGER,
CODITRECMERC SMALLINT)
RETURNS (CODRMA INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE EQGERARMASP (CODEMPOP INTEGER,
CODFILIALOP INTEGER,
CODOP INTEGER,
SEQOP SMALLINT)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE EQITRECMERCSERIESP (TRANSACAO CHAR(1),
CODEMP INTEGER,
CODFILIAL SMALLINT,
TICKET INTEGER,
CODITRECMERC SMALLINT,
CODEMPPD INTEGER,
CODFILIALPD SMALLINT,
CODPROD INTEGER,
NUMSERIETMP VARCHAR(30),
QTDITRECMERC INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE EQMOVPRODATEQSP (ICODEMPPD INTEGER,
SCODFILIALPD SMALLINT,
ICODPROD INTEGER,
ICODEMPLEOLD INTEGER,
SCODFILIALLEOLD SMALLINT,
CCODLOTEOLD VARCHAR(20),
ICODEMPLENEW INTEGER,
SCODFILIALLENEW SMALLINT,
CCODLOTENEW VARCHAR(20),
SOPERADOR SMALLINT,
NQTDMOVPRODOLD NUMERIC(15, 5),
NQTDMOVPRODNEW NUMERIC(15, 5),
ICODEMPAXOLD INTEGER,
SCODFILIALAXOLD SMALLINT,
ICODALMOXOLD INTEGER,
ICODEMPAXNEW INTEGER,
SCODFILIALAXNEW SMALLINT,
ICODALMOXNEW INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE EQMOVPRODCKCPSP (ICODEMPPD INTEGER,
SCODFILIALPD SMALLINT,
ICODPROD INTEGER,
ICODCOMPRA INTEGER,
ICODINVPROD INTEGER,
DDTMOVPROD DATE,
NQTDMOVPROD NUMERIC(15, 5),
NCUSTOMPMMOVPROD NUMERIC(15, 5))
RETURNS (DDTULTCPPROD DATE,
NQTDULTCPPROD NUMERIC(15, 5),
DDTMPMPROD DATE,
NCUSTOMPMPROD NUMERIC(15, 5))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE EQMOVPRODCKTMSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODTIPOMOV INTEGER,
ESTOQTIPOMOVPD CHAR(1))
RETURNS (CESTIPOMOV CHAR(1),
SOPERADOR SMALLINT)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE EQMOVPRODCKUTMSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODTIPOMOV INTEGER,
ICODEMPOLD INTEGER,
SCODFILIALOLD SMALLINT,
ICODTIPOMOVOLD INTEGER)
RETURNS (CALTTM CHAR(1))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE EQMOVPRODCSLDSP (ICODEMPTM INTEGER,
SCODFILIALTM SMALLINT,
ICODTIPOMOV INTEGER,
NQTDMOVPROD NUMERIC(15, 5),
NPRECOMOVPROD NUMERIC(15, 5),
NCUSTOMPMMOVPROD NUMERIC(15, 5),
NSLDMOVPROD NUMERIC(15, 5),
ESTOQTIPOMOVPD CHAR(1),
TIPONF CHAR(1))
RETURNS (NCUSTOMPM NUMERIC(15, 5),
NSALDO NUMERIC(15, 5),
CESTOQMOVPROD CHAR(1),
CTIPOMOVPROD CHAR(1),
SOPERADOR SMALLINT)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE EQMOVPRODDSP (ICODEMPPD INTEGER,
SCODFILIALPD SMALLINT,
ICODPROD INTEGER,
ICODEMPIV INTEGER,
SCODFILIALIV SMALLINT,
ICODINVPROD INTEGER,
ICODEMPCP INTEGER,
SCODFILIALCP SMALLINT,
ICODCOMPRA INTEGER,
SCODITCOMPRA SMALLINT,
ICODEMPVD INTEGER,
SCODFILIALVD SMALLINT,
CTIPOVENDA CHAR(1),
ICODVENDA INTEGER,
SCODITVENDA SMALLINT,
ICODEMPRM INTEGER,
SCODFILIALRM SMALLINT,
ICODRMA INTEGER,
SCODITRMA SMALLINT,
ICODEMPOP INTEGER,
SCODFILIALOP SMALLINT,
ICODOP INTEGER,
SSEQOP SMALLINT,
SSEQENTOP SMALLINT,
DDTMOVPROD DATE,
ICODEMPAX INTEGER,
SCODFILIALAX SMALLINT,
ICODALMOX INTEGER,
CMULTIALMOX CHAR(1),
SEQSUBPROD SMALLINT,
TIPONF CHAR(1))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE EQMOVPRODISP (ICODEMPPD INTEGER,
SCODFILIALPD SMALLINT,
ICODPROD INTEGER,
ICODEMPLE INTEGER,
SCODFILIALLE SMALLINT,
CCODLOTE VARCHAR(20),
ICODEMPTM INTEGER,
SCODFILIALTM SMALLINT,
ICODTIPOMOV INTEGER,
ICODEMPIV INTEGER,
SCODFILIALIV SMALLINT,
ICODINVPROD INTEGER,
ICODEMPCP INTEGER,
SCODFILIALCP SMALLINT,
ICODCOMPRA INTEGER,
SCODITCOMPRA SMALLINT,
ICODEMPVD INTEGER,
SCODFILIALVD SMALLINT,
CTIPOVENDA CHAR(1),
ICODVENDA INTEGER,
SCODITVENDA SMALLINT,
ICODEMPRM INTEGER,
SCODFILIALRM SMALLINT,
ICODRMA INTEGER,
SCODITRMA SMALLINT,
ICODEMPOP INTEGER,
SCODFILIALOP SMALLINT,
ICODOP INTEGER,
SSEQOP SMALLINT,
SSEQENTOP SMALLINT,
ICODEMPNT INTEGER,
SCODFILIALNT SMALLINT,
CCODNAT CHAR(4),
DDTMOVPROD DATE,
IDOCMOVPROD INTEGER,
CFLAG CHAR(1),
NQTDMOVPROD NUMERIC(15, 5),
NPRECOMOVPROD NUMERIC(15, 5),
ICODEMPAX INTEGER,
SCODFILIALAX SMALLINT,
ICODALMOX INTEGER,
CMULTIALMOX CHAR(1),
SEQSUBPROD SMALLINT,
ESTOQTIPOMOVPD CHAR(1),
TIPONF CHAR(1))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE EQMOVPRODIUDSP (CIUD CHAR(1),
ICODEMPPD INTEGER,
SCODFILIALPD SMALLINT,
ICODPROD INTEGER,
ICODEMPLE INTEGER,
SCODFILIALLE SMALLINT,
CCODLOTE VARCHAR(20),
ICODEMPTM INTEGER,
SCODFILIALTM SMALLINT,
ICODTIPOMOV INTEGER,
ICODEMPIV INTEGER,
SCODFILIALIV SMALLINT,
ICODINVPROD INTEGER,
ICODEMPCP INTEGER,
SCODFILIALCP SMALLINT,
ICODCOMPRA INTEGER,
SCODITCOMPRA SMALLINT,
ICODEMPVD INTEGER,
SCODFILIALVD SMALLINT,
CTIPOVENDA CHAR(1),
ICODVENDA INTEGER,
SCODITVENDA SMALLINT,
ICODEMPRM INTEGER,
SCODFILIALRM SMALLINT,
ICODRMA INTEGER,
SCODITRMA SMALLINT,
ICODEMPOP INTEGER,
SCODFILIALOP SMALLINT,
ICODOP INTEGER,
SSEQOP SMALLINT,
SSEQENTOP SMALLINT,
ICODEMPNT INTEGER,
SCODFILIALNT SMALLINT,
CCODNAT CHAR(4),
DDTMOVPROD DATE,
IDOCMOVPROD INTEGER,
CFLAG CHAR(1),
NQTDMOVPROD NUMERIC(15, 5),
NPRECOMOVPROD NUMERIC(15, 5),
ICODEMPAX INTEGER,
SCODFILIALAX SMALLINT,
ICODALMOX INTEGER,
SEQSUBPROD SMALLINT,
ESTOQTIPOMOVPD CHAR(1),
TIPONF CHAR(1))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE EQMOVPRODPRCSLDSP (SCODFILIAL SMALLINT,
ICODMOVPROD INTEGER,
ICODEMPPD INTEGER,
SCODFILIALPD SMALLINT,
ICODPROD INTEGER,
DDTMOVPROD DATE,
DDTMOVPRODPRC DATE,
NSLDMOVPROD NUMERIC(15, 5),
NCUSTOMPMMOVPROD NUMERIC(15, 5),
NSLDMOVPRODAX NUMERIC(15, 5),
NCUSTOMPMMOVPRODAX NUMERIC(15, 5),
ICODEMPAX INTEGER,
SCODFILIALAX SMALLINT,
ICODALMOX INTEGER,
CMULTIALMOX CHAR(1),
TIPONF CHAR(1))
RETURNS (NSLDPRC NUMERIC(15, 5),
NCUSTOMPMPRC NUMERIC(15, 5),
NSLDPRCAX NUMERIC(15, 5),
NCUSTOMPMPRCAX NUMERIC(15, 5),
ESTOQTIPOMOVPD CHAR(1))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE EQMOVPRODRETCODSP (ICODEMPIV INTEGER,
SCODFILIALIV SMALLINT,
ICODINVPROD INTEGER,
ICODEMPCP INTEGER,
SCODFILIALCP SMALLINT,
ICODCOMPRA INTEGER,
SCODITCOMPRA SMALLINT,
ICODEMPVD INTEGER,
SCODFILIALVD SMALLINT,
CTIPOVENDA CHAR(1),
ICODVENDA INTEGER,
SCODITVENDA SMALLINT,
ICODEMPRM INTEGER,
SCODFILIALRM SMALLINT,
ICODRMA INTEGER,
SCODITRMA SMALLINT,
ICODEMPOP INTEGER,
SCODFILIALOP SMALLINT,
ICODOP INTEGER,
SSEQOP SMALLINT,
SSEQOPENT SMALLINT,
SEQSUBPROD SMALLINT)
RETURNS (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODMOVPROD INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE EQMOVPRODSEQSP (ICODEMP INTEGER)
RETURNS (SCODFILIAL SMALLINT,
ICODMOVPROD INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE EQMOVPRODSLDSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODMOVPROD INTEGER,
ICODEMPPD INTEGER,
SCODFILIALPD SMALLINT,
ICODPROD INTEGER,
DDTMOVPROD DATE,
NCUSTOMPMMOVPROD NUMERIC(15, 5),
NCUSTOMPMMOVPRODAX NUMERIC(15, 5),
ICODEMPAX INTEGER,
SCODFILIALAX SMALLINT,
ICODALMOX INTEGER,
CMULTIALMOX CHAR(1))
RETURNS (NSALDO NUMERIC(15, 5),
NCUSTOMPM NUMERIC(15, 5),
ICODMOVPRODSLD INTEGER,
NSALDOAX NUMERIC(15, 5),
NCUSTOMPMAX NUMERIC(15, 5),
ICODMOVPRODSLDAX INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE EQMOVPRODUSP (ICODEMPPD INTEGER,
SCODFILIALPD SMALLINT,
ICODPROD INTEGER,
ICODEMPLE INTEGER,
SCODFILIALLE SMALLINT,
CCODLOTE VARCHAR(20),
ICODEMPTM INTEGER,
SCODFILIALTM SMALLINT,
ICODTIPOMOV INTEGER,
ICODEMPIV INTEGER,
SCODFILIALIV SMALLINT,
ICODINVPROD INTEGER,
ICODEMPCP INTEGER,
SCODFILIALCP SMALLINT,
ICODCOMPRA INTEGER,
SCODITCOMPRA SMALLINT,
ICODEMPVD INTEGER,
SCODFILIALVD SMALLINT,
CTIPOVENDA CHAR(1),
ICODVENDA INTEGER,
SCODITVENDA SMALLINT,
ICODEMPRM INTEGER,
SCODFILIALRM SMALLINT,
ICODRMA INTEGER,
SCODITRMA SMALLINT,
ICODEMPOP INTEGER,
SCODFILIALOP SMALLINT,
ICODOP INTEGER,
SSEQOP SMALLINT,
SSEQENTOP SMALLINT,
ICODEMPNT INTEGER,
SCODFILIALNT SMALLINT,
CCODNAT CHAR(4),
DDTMOVPROD DATE,
IDOCMOVPROD INTEGER,
CFLAG CHAR(1),
NQTDMOVPROD NUMERIC(15, 5),
NPRECOMOVPROD NUMERIC(15, 5),
ICODEMPAX INTEGER,
SCODFILIALAX SMALLINT,
ICODALMOX INTEGER,
CMULTIALMOX CHAR(1),
SEQSUBPROD BIGINT,
ESTOQTIPOMOVPD CHAR(1),
TIPONF CHAR(1))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE EQPRODUTOSP01 (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODPROD INTEGER,
ICODEMPAX INTEGER,
SCODFILIALAX SMALLINT,
ICODALMOX INTEGER)
RETURNS (NSALDO NUMERIC(15, 5),
NSALDOAX NUMERIC(15, 5),
NCUSTOMPM NUMERIC(15, 5),
NCUSTOPEPS NUMERIC(15, 5),
NCUSTOMPMAX NUMERIC(15, 5),
NCUSTOPEPSAX NUMERIC(15, 5),
NCUSTOINFO NUMERIC(15, 5),
NCUSTOUC NUMERIC(15, 5))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE EQREFPRODSP (CODEMP INTEGER,
CODFILIAL SMALLINT,
CODPROD INTEGER)
RETURNS (REFPROD VARCHAR(20))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE EQRELDEMANDASP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
SCODFILIALPD SMALLINT,
DDTINI DATE,
DDTFIM DATE)
RETURNS (CODMARCA CHAR(6),
CODGRUP CHAR(14),
CODPROD INTEGER,
REFPROD VARCHAR(20),
DESCPROD CHAR(100),
DESCGRUP CHAR(50),
SLDINI NUMERIC(15, 5),
VLRCOMPRAS NUMERIC(15, 5),
VLRDEVENT NUMERIC(15, 5),
VLROUTENT NUMERIC(15, 5),
VLRVENDAS NUMERIC(15, 5),
VLRDEVSAI NUMERIC(15, 5),
VLROUTSAI NUMERIC(15, 5),
SLDFIM NUMERIC(15, 5))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE EQRELGIROPROD (CODEMP INTEGER,
CODFILIAL INTEGER,
DATA_BASE DATE)
RETURNS (CODEMPPD INTEGER,
CODFILIALPD SMALLINT,
CODPROD INTEGER,
REFPROD VARCHAR(20),
CODFABPROD CHAR(15),
CODBARPROD CHAR(13),
DESCPROD VARCHAR(100),
CODEMPCP INTEGER,
CODFILIALCP SMALLINT,
CODCOMPRA INTEGER,
DOCCOMPRA INTEGER,
IDENTCONTAINER CHAR(20),
CODITCOMPRA SMALLINT,
DTULTCP DATE,
SALDOANT NUMERIC(15, 5),
QTDULTCP NUMERIC(15, 5),
QTDVENDIDA NUMERIC(15, 5),
SALDOATU NUMERIC(15, 5),
CODEMPGP INTEGER,
CODFILIALGP INTEGER,
CODGRUP CHAR(14))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE EQRELGIROPRODPERI (CODEMP INTEGER,
CODFILIAL INTEGER,
DATA_INI DATE,
DATA_FIM DATE)
RETURNS (CODEMPPD INTEGER,
CODFILIALPD SMALLINT,
CODPROD INTEGER,
REFPROD VARCHAR(20),
CODFABPROD CHAR(15),
CODBARPROD CHAR(13),
DESCPROD VARCHAR(100),
CODEMPCP INTEGER,
CODFILIALCP SMALLINT,
CODCOMPRA INTEGER,
DOCCOMPRA INTEGER,
IDENTCONTAINER CHAR(20),
CODITCOMPRA SMALLINT,
DTULTCP DATE,
SALDOANT NUMERIC(15, 5),
QTDULTCP NUMERIC(15, 5),
QTDVENDIDA NUMERIC(15, 5),
SALDOATU NUMERIC(15, 5),
CODEMPGP INTEGER,
CODFILIALGP INTEGER,
CODGRUP CHAR(14))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE EQRELINVPRODSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
CTIPOCUSTO CHAR(1),
ICODEMPGP INTEGER,
SCODFILIALGP SMALLINT,
CCODGRUP CHAR(14),
DDTESTOQ DATE,
ICODEMPAX INTEGER,
SCODFILIALAX SMALLINT,
ICODALMOX INTEGER)
RETURNS (CODPROD INTEGER,
REFPROD VARCHAR(20),
DESCPROD CHAR(100),
CODGRUP CHAR(14),
SALDO NUMERIC(15, 5),
CUSTO NUMERIC(15, 5),
VLRESTOQ NUMERIC(15, 5))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE EQRELPEPSSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
DTESTOQ DATE,
ICODEMPMC INTEGER,
SCODFILIALMC SMALLINT,
CCODMARCA CHAR(6),
ICODEMPGP INTEGER,
SCODFILIALGP SMALLINT,
CCODGRUP VARCHAR(14),
CTIPOCUSTO CHAR(1),
ICODEMPAX INTEGER,
SCODFILIALAX SMALLINT,
ICODALMOX INTEGER,
CLOTEPROD CHAR(1),
SOPRODSALDO CHAR(1))
RETURNS (CODPROD INTEGER,
REFPROD VARCHAR(20),
DESCPROD CHAR(100),
SLDPROD NUMERIC(15, 5),
CUSTOUNIT NUMERIC(15, 5),
CUSTOTOT NUMERIC(15, 5),
CODBARPROD CHAR(13),
CODFABPROD CHAR(15),
ATIVOPROD CHAR(1),
CODUNID CHAR(20),
TIPOPROD VARCHAR(2),
CODNCM VARCHAR(10),
EXTIPI CHAR(2),
COD_GEN CHAR(2),
CODSERV CHAR(5),
ALIQ_ICMS NUMERIC(9, 2),
CODNBM VARCHAR(12),
CODLOTE VARCHAR(20),
VENCTOLOTE DATE,
SLDLOTE NUMERIC(15, 5),
CODGRUP VARCHAR(14),
SIGLAGRUP VARCHAR(10))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE EQSALDOLOTEATEQSP (ICODEMPLEOLD INTEGER,
SCODFILIALLEOLD SMALLINT,
ICODPROD INTEGER,
CCODLOTEOLD VARCHAR(20),
ICODEMPLENEW INTEGER,
SCODFILIALLENEW SMALLINT,
CCODLOTENEW VARCHAR(20),
SOPERADOR SMALLINT,
NQTDMOVPRODOLD NUMERIC(15, 5),
NQTDMOVPRODNEW NUMERIC(15, 5),
ICODEMPAXOLD INTEGER,
SCODFILIALAXOLD SMALLINT,
ICODALMOXOLD INTEGER,
ICODEMPAXNEW INTEGER,
SCODFILIALAXNEW SMALLINT,
ICODALMOXNEW INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE EQSALDOPRODATEQSP (ICODEMPPD INTEGER,
SCODFILIALPD SMALLINT,
ICODPROD INTEGER,
SOPERADOR SMALLINT,
NQTDMOVPRODOLD NUMERIC(15, 5),
NQTDMOVPRODNEW NUMERIC(15, 5),
ICODEMPAXOLD INTEGER,
SCODFILIALAXOLD SMALLINT,
ICODALMOXOLD INTEGER,
ICODEMPAXNEW INTEGER,
SCODFILIALAXNEW SMALLINT,
ICODALMOXNEW INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE FNADICITRECEBERSP01 (CALTVLR CHAR(1),
ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODREC INTEGER,
INPARCITREC INTEGER,
NVLRDESCITREC NUMERIC(15, 5),
NVLRMULTAITREC NUMERIC(15, 5),
NVLRJUROSITREC NUMERIC(15, 5),
NVLRPARCITREC NUMERIC(15, 5),
NVLRPAGOITREC NUMERIC(15, 5),
DDTITREC DATE,
DDTCOMPITREC DATE,
DDTVENCITREC DATE,
CSTATUSITREC CHAR(2),
CFLAG CHAR(1),
ICODEMPBO INTEGER,
SCODFILIALBO SMALLINT,
CCODBANCO CHAR(3),
ICODEMPTC INTEGER,
SCODFILIALTC SMALLINT,
ICODTIPOCOB INTEGER,
ICODEMPCB INTEGER,
SCODFILIALCB SMALLINT,
CODCARTCOB CHAR(3),
NVLRCOMIITREC NUMERIC(15, 5),
OBSITREC VARCHAR(250),
CODEMPCA INTEGER,
CODFILIALCA SMALLINT,
NUMCONTA CHAR(10),
CODEMPPN INTEGER,
CODFILIALPN SMALLINT,
CODPLAN CHAR(13),
CODEMPCC INTEGER,
CODFILIALCC SMALLINT,
ANOCC SMALLINT,
CODCC CHAR(19),
VLRBASECOMIS NUMERIC(15, 5))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE FNADICLANCASP01 (ICODREC INTEGER,
INPARCITREC INTEGER,
PDVITREC CHAR(1),
SNUMCONTA CHAR(10),
ICODEMPCA INTEGER,
ICODFILIALCA INTEGER,
ICODCLI INTEGER,
ICODEMPCL INTEGER,
ICODFILIALCL INTEGER,
SCODPLAN CHAR(13),
ICODEMPPN INTEGER,
ICODFILIALPN INTEGER,
IANOCC INTEGER,
SCODCC CHAR(19),
ICODEMPCC INTEGER,
ICODFILIALCC INTEGER,
DDTCOMPITREC DATE,
DDTPAGOITREC DATE,
SDOCLANCAITREC VARCHAR(15),
SOBSITREC CHAR(250),
DVLRPAGOITREC NUMERIC(15, 5),
ICODEMP INTEGER,
ICODFILIAL SMALLINT,
DVLRPAGOJUROS NUMERIC(15, 5),
DVLRDESC NUMERIC(15, 5),
CODEMPCT INTEGER,
CODFILIALCT SMALLINT,
CODCONTR INTEGER,
CODITCONTR SMALLINT,
CODEMPEM INTEGER,
CODFILIALEM SMALLINT,
MATEMPR INTEGER
)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE FNADICLANCASP02 (ICODPAG INTEGER,
INPARCPAG INTEGER,
SNUMCONTA CHAR(10),
ICODEMPCA INTEGER,
ICODFILIALCA INTEGER,
ICODFOR INTEGER,
ICODEMPFR INTEGER,
ICODFILIALFR INTEGER,
SCODPLAN CHAR(13),
ICODEMPPN INTEGER,
ICODFILIALPN INTEGER,
IANOCC INTEGER,
SCODCC CHAR(19),
ICODEMPCC INTEGER,
ICODFILIALCC INTEGER,
DDTCOMPITPAG DATE,
DDTPAGOITPAG DATE,
SDOCLANCAITPAG VARCHAR(15),
SOBSITPAG CHAR(250),
DVLRPAGOITPAG NUMERIC(15, 5),
ICODEMP INTEGER,
ICODFILIAL SMALLINT,
DVLRJUROSPAG NUMERIC(15, 5),
DVLRDESC NUMERIC(15, 5),
CODEMPCT INTEGER,
CODFILIALCT SMALLINT,
CODCONTR INTEGER,
CODITCONTR SMALLINT,
CODEMPEM INTEGER,
CODFILIALEM SMALLINT,
MATEMPR INTEGER
)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE FNADICPAGARSP01 (CODCOMPRA INTEGER,
ICODEMPPG INTEGER,
ICODFILIALPG SMALLINT,
CODPLANOPAG INTEGER,
ICODEMPFR INTEGER,
ICODFILIALFR SMALLINT,
CODFOR INTEGER,
VLRLIQCOMPRA NUMERIC(18, 2),
DTSAIDACOMPRA DATE,
DTCOMPCOMPRA DATE,
DOCCOMPRA INTEGER,
ICODEMPBO INTEGER,
ICODFILIALBO SMALLINT,
CODBANCO CHAR(3),
FLAG CHAR(1),
ICODEMP INTEGER,
ICODFILIAL SMALLINT,
CODEMPTC INTEGER,
CODFILIALTC SMALLINT,
CODTIPOCOB INTEGER,
CODEMPCT INTEGER,
CODFILIALCT SMALLINT,
NUMCONTA CHAR(10),
CODEMPCC INTEGER,
CODFILIALCC SMALLINT,
ANOCC SMALLINT,
CODCC CHAR(19),
CODEMPPN INTEGER,
CODFILIALPN SMALLINT,
CODPLAN CHAR(13),
OBSPAG VARCHAR(250))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE FNADICPAGARSP02 (CODEMPOC INTEGER,
CODFILIALOC SMALLINT,
CODORDCP INTEGER,
CODEMPPP INTEGER,
CODFILIALPP SMALLINT,
CODPLANOPAG INTEGER,
CODEMPFR INTEGER,
CODFILIALFR SMALLINT,
CODFOR INTEGER,
OBSPAG VARCHAR(2000))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE FNADICRECEBERSP01 (TIPOVENDA CHAR(1),
CODVENDA INTEGER,
CODEMPTC INTEGER,
CODFILIALTC INTEGER,
CODTIPOCOB INTEGER,
CODEMPPG INTEGER,
CODFILIALPG SMALLINT,
CODPLANOPAG INTEGER,
CODEMPCL INTEGER,
CODFILIALCL SMALLINT,
CODCLI INTEGER,
CODEMPVD INTEGER,
CODFILIALVD SMALLINT,
CODVEND INTEGER,
VLRLIQVENDA NUMERIC(15, 5),
DTVENDA DATE,
DTCOMP DATE,
VLRCOMISVENDA NUMERIC(15, 5),
DOCVENDA INTEGER,
CODEMPBO INTEGER,
CODFILIALBO SMALLINT,
CODBANCO CHAR(3),
CODEMP INTEGER,
CODFILIAL SMALLINT,
CODEMPCB INTEGER,
CODFILIALCB SMALLINT,
CODCARTCOB CHAR(3),
CODEMPCA INTEGER,
CODFILIALCA SMALLINT,
NUMCONTA CHAR(10),
FLAG CHAR(1),
OBSREC VARCHAR(250),
VLRBASECOMIS NUMERIC(15, 5),
VLRRETENSAOISS NUMERIC(15, 5))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE FNCHECAPGTOATRASOSP (ICODCLI INTEGER,
ICODEMP INTEGER,
ICODFILIAL SMALLINT)
RETURNS (SRETORNO CHAR(1))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE FNCHECAPGTOSP (CODCLI INTEGER,
CODEMP INTEGER,
CODFILIAL SMALLINT,
BLOQVDPORATRASO CHAR(1),
NUMDIASBLOQ SMALLINT)
RETURNS (RETORNO VARCHAR(15))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE FNDELETARECEBERSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
CTIPOVENDA CHAR(1),
ICODVENDA INTEGER)
RETURNS (SDELETADO SMALLINT)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE FNESTORNACOMISSAOSP (CODEMP INTEGER,
CODFILIAL SMALLINT,
CODREC INTEGER,
NPARCITREC SMALLINT)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE FNGERAITRECEBERSP01 (CALTVLR CHAR(1),
ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODREC INTEGER,
ICODEMPPG INTEGER,
SCODFILIALPG SMALLINT,
ICODPLANOPAG INTEGER,
NVLRREC NUMERIC(15, 5),
DDATAREC DATE,
DDTCOMPREC DATE,
CFLAG CHAR(1),
ICODEMPBO INTEGER,
SCODFILIALBO SMALLINT,
CCODBANCO CHAR(3),
ICODEMPTC INTEGER,
SCODFILIALTC SMALLINT,
ICODTIPOCOB INTEGER,
ICODEMPCB INTEGER,
SCODFILIALCB SMALLINT,
CODCARTCOB CHAR(3),
NVLRCOMIREC NUMERIC(15, 5),
OBSREC VARCHAR(250),
CODEMPCA INTEGER,
CODFILIALCA SMALLINT,
NUMCONTA CHAR(10),
CODEMPPN INTEGER,
CODFILIALPN SMALLINT,
CODPLAN CHAR(13),
CODEMPCC INTEGER,
CODFILIALCC SMALLINT,
ANOCC INTEGER,
CODCC CHAR(19),
VLRBASECOMIS NUMERIC(15, 5))
RETURNS (I INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE FNGERASEQNOSSONUMERO (CODEMPBO INTEGER,
CODFILIALBO SMALLINT,
CODBANCO CHAR(3),
CODEMPCB INTEGER,
CODFILIALCB SMALLINT,
CODCARTCOB CHAR(3),
CODEMPCT INTEGER,
CODFILIALCT SMALLINT,
NUMCONTA CHAR(10))
RETURNS (SEQNOSSONUMERO INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE FNITRECEBERSP01 (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODREC INTEGER,
NVLRPARCREC NUMERIC(15, 5),
NVLRCOMIREC NUMERIC(15, 5),
INROPARCREC INTEGER,
CCLASCOMIS CHAR(1))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE FNLIBCREDSP (CODEMPVD INTEGER,
CODFILIALVD INTEGER,
TIPOVENDA CHAR(1),
CODVENDA INTEGER,
CODCLI INTEGER,
CODEMPCL INTEGER,
CODFILIALCL INTEGER,
VLRVENDA NUMERIC(15, 5),
VLRADIC NUMERIC(15, 2),
CODITEM INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE FNSALDOPLANSP (ICODEMPPN INTEGER,
ICODFILIALPN INTEGER,
SCODPLANANT CHAR(13),
DDATAANT DATE,
DVLRANT NUMERIC(15, 5),
SCODPLANATU CHAR(13),
DDATAATU DATE,
DVLRATU NUMERIC(15, 5))
RETURNS (SRETORNO CHAR(1))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE GERAEXPEDIENTESP (CODEMPFE INTEGER,
CODFILIALFE SMALLINT,
CODEMPTO INTEGER,
CODFILIALTO SMALLINT,
ANOEXP SMALLINT)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE GERAVISITASSP (NUMVISITAS INTEGER,
TIPOVISITA CHAR(10),
CODATEND INTEGER,
CODFILIALATEND INTEGER,
CODEMPATEND INTEGER,
CODCLI INTEGER,
CODFILIALCLI INTEGER,
CODEMPCLI INTEGER,
DATA DATE)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE LFBUSCAFISCALSP (CODEMP INTEGER,
CODFILIAL INTEGER,
CODPROD INTEGER,
CODEMPCF INTEGER,
CODFILIALCF INTEGER,
CODCF INTEGER,
CODEMPTM INTEGER,
CODFILIALTM SMALLINT,
CODTIPOMOV INTEGER,
TIPOBUSCA CHAR(2),
CODNAT CHAR(4),
CODEMPIFP INTEGER,
CODFILIALIFP SMALLINT,
CODFISCP CHAR(13),
CODITFISCP INTEGER)
RETURNS (ORIGFISC CHAR(1),
CODTRATTRIB CHAR(2),
REDFISC NUMERIC(9, 2),
TIPOFISC CHAR(2),
CODMENS INTEGER,
ALIQFISC NUMERIC(9, 2),
ALIQIPIFISC NUMERIC(9, 2),
TPREDICMSFISC CHAR(1),
TIPOST CHAR(2),
MARGEMVLAGR NUMERIC(15, 2),
CODEMPIF INTEGER,
CODFILIALIF SMALLINT,
CODFISC CHAR(13),
CODITFISC INTEGER,
ALIQFISCINTRA NUMERIC(9, 2),
ALIQPIS NUMERIC(9, 2),
ALIQCOFINS NUMERIC(9, 2),
ALIQCSOCIAL NUMERIC(9, 2),
ALIQIR NUMERIC(9, 2),
REDBASEST CHAR(1),
ALIQISS NUMERIC(6, 2),
ADICIPIBASEICMS CHAR(1),
CALCSTCM CHAR(1),
ALIQICMSSTCM NUMERIC(9, 2))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE LFBUSCAFISCALSP02 (CODEMP INTEGER,
CODFILIAL SMALLINT,
CODVENDA INTEGER,
TIPOVENDA CHAR(1),
CODITVENDA SMALLINT,
CODCOMPRA INTEGER,
CODITCOMPRA SMALLINT)
RETURNS (VLRBASEPIS NUMERIC(15, 5),
VLRBASECOFINS NUMERIC(15, 5),
VLRPIS NUMERIC(15, 5),
VLRCOFINS NUMERIC(15, 5),
VLRIR NUMERIC(15, 5),
VLRCSOCIAL NUMERIC(15, 5),
VLRIPIIT NUMERIC(15, 5),
VLRBASENCM DECIMAL(15, 5),
ALIQNACNCM DECIMAL(9, 2),
ALIQIMPNCM DECIMAL(9, 2),
VLRNACNCM DECIMAL(15, 2),
VLRIMPNCM DECIMAL(15, 2),
ORIGFISC CHAR(1))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE LFBUSCAICMSSP (CODNAT CHAR(4),
ESTCLI CHAR(2),
ICODEMP INTEGER,
ICODFILIAL SMALLINT)
RETURNS (PERCICMS NUMERIC(9, 2),
PERCICMSINTRA NUMERIC(9, 2))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE LFBUSCANATSP (FILIALATUAL INTEGER,
CODEMPPD INTEGER,
CODFILIALPD SMALLINT,
CODPROD INTEGER,
CODEMPCL INTEGER,
CODFILIALCL SMALLINT,
CODCLI INTEGER,
CODEMPFR INTEGER,
CODFILIALFR SMALLINT,
CODFOR INTEGER,
CODFILIALTM SMALLINT,
CODTIPOMOV INTEGER,
CODITFISC INTEGER)
RETURNS (CODNAT CHAR(4))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE LFBUSCAPREVTRIBORC (CODEMP INTEGER,
CODFILIAL INTEGER,
CODORC INTEGER,
TIPOORC CHAR(1),
CODITORC SMALLINT)
RETURNS (VLRICMS NUMERIC(15, 5),
VLRIPI NUMERIC(15, 5),
VLRPIS NUMERIC(15, 5),
VLRCOFINS NUMERIC(15, 5),
VLRIR NUMERIC(15, 5),
VLRCSOCIAL NUMERIC(15, 5),
VLRISS NUMERIC(15, 5))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE LFBUSCATRIBCOMPRA (CODEMP INTEGER,
CODFILIAL INTEGER,
CODCOMPRA INTEGER,
CODEMPPD INTEGER,
CODFILIALPD SMALLINT,
CODPROD INTEGER,
VLRLIQ NUMERIC(15, 5))
RETURNS (VLRBASEFUNRURAL NUMERIC(15, 5),
ALIQFUNRURAL NUMERIC(6, 2),
VLRFUNRURAL NUMERIC(15, 5),
CODEMPIF INTEGER,
CODFILIALIF SMALLINT,
CODFISC CHAR(13),
CODITFISC SMALLINT)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE LFCALCCUSTOSP01 (CODEMP INTEGER,
CODFILIAL SMALLINT,
CODCALC INTEGER,
QTDADE DECIMAL(15, 5),
VLRCUSTOP DECIMAL(15, 5),
VLRICMS DECIMAL(15, 5),
VLRIPI DECIMAL(15, 5),
VLRPIS DECIMAL(15, 5),
VLRCOFINS DECIMAL(15, 5),
VLRISS DECIMAL(15, 5),
VLRFUNRURAL DECIMAL(15, 5),
VLRII DECIMAL(15, 5),
VLRIR DECIMAL(15, 5),
VLRTXSISCOMEX DECIMAL(15, 5),
VLRICMSDIFERIDO DECIMAL(15, 5),
VLRICMSPRESUMIDO DECIMAL(15, 5),
VLRCOMPL DECIMAL(15, 5))
RETURNS (VLRCUSTO DECIMAL(15, 5))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE LFGERALFITCOMPRASP (CODEMP INTEGER,
CODFILIAL SMALLINT,
CODCOMPRA INTEGER,
CODITCOMPRA SMALLINT)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE LFGERALFITVENDASP (CODEMP INTEGER,
CODFILIAL SMALLINT,
CODVENDA INTEGER,
TIPOVENDA CHAR(2),
CODITVENDA SMALLINT)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE LFNOVODOCSP (SSERIE CHAR(4),
ICODEMP INTEGER,
ICODFILIAL SMALLINT)
RETURNS (DOC INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE LIMPACAMPO2SP (VTAB VARCHAR(30),
VCAMPO VARCHAR(30),
STAM SMALLINT)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE LIMPACAMPOSP (VTAB VARCHAR(30),
VCAMPO VARCHAR(30),
STAM SMALLINT)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE PPATUDISTOPSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODOP INTEGER,
SSEQOP SMALLINT,
NQTDDISTOLD NUMERIC(15, 5),
NQTDDISTNEW NUMERIC(15, 5))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE PPCUSTOPRODSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODPROD INTEGER,
DTESTOQ DATE,
CTIPOCUSTO CHAR(1),
ICODEMPAX INTEGER,
SCODFILIALAX SMALLINT,
ICODALMOX INTEGER,
CCOMSALDO CHAR(10))
RETURNS (CUSTOUNIT NUMERIC(15, 5),
SLDPROD NUMERIC(15, 5))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE PPGERAOP (TIPOPROCESS CHAR(1),
CODEMPOP INTEGER,
CODFILIALOP SMALLINT,
CODOP INTEGER,
SEQOP INTEGER,
CODEMPPD INTEGER,
CODFILIALPD SMALLINT,
CODPROD INTEGER,
CODEMPOC INTEGER,
CODFILIALOC SMALLINT,
CODORC INTEGER,
TIPOORC CHAR(1),
CODITORC SMALLINT,
QTDSUGPRODOP NUMERIC(15, 5),
DTFABROP DATE,
SEQEST SMALLINT,
CODEMPET INTEGER,
CODFILIALET SMALLINT,
CODEST SMALLINT,
AGRUPDATAAPROV CHAR(1),
AGRUPDTFABROP CHAR(1),
AGRUPCODCLI CHAR(1),
CODEMPCL INTEGER,
CODFILIALCL SMALLINT,
CODCLI INTEGER,
DATAAPROV DATE,
CODEMPCP INTEGER,
CODFILIALCP SMALLINT,
CODCOMPRA INTEGER,
CODITCOMPRA SMALLINT,
JUSTFICQTDPROD VARCHAR(500),
CODEMPPDENTRADA INTEGER,
CODFILIALPDENTRADA SMALLINT,
CODPRODENTRADA INTEGER,
QTDENTRADA NUMERIC(15, 5))
RETURNS (CODOPRET INTEGER,
SEQOPRET SMALLINT)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE PPGERAOPCQ (ICODEMP INTEGER,
ICODFILIAL SMALLINT,
ICODOP INTEGER,
ISEQOP SMALLINT)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE PPITOPSP01 (ICODEMP INTEGER,
ICODFILIAL SMALLINT,
ICODOP INTEGER,
ISEQOP SMALLINT)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE PPITOPSP02 (ICODEMP INTEGER,
ICODFILIAL SMALLINT,
ICODOP INTEGER,
ISEQOP SMALLINT)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE PPRELCUSTOSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
DTESTOQ DATE,
ICODEMPMC INTEGER,
SCODFILIALMC SMALLINT,
CCODMARCA CHAR(6),
ICODEMPGP INTEGER,
SCODFILIALGP SMALLINT,
CCODGRUP CHAR(14),
CTIPOCUSTO CHAR(1),
ICODEMPAX INTEGER,
SCODFILIALAX SMALLINT,
ICODALMOX INTEGER)
RETURNS (CODPROD INTEGER,
REFPROD VARCHAR(20),
DESCPROD CHAR(100),
TIPOPROD VARCHAR(2),
SLDPROD NUMERIC(15, 5),
CUSTOUNIT NUMERIC(15, 5),
CUSTOTOT NUMERIC(15, 5))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE PVABRECAIXASP (ICODCAIXA INTEGER,
SCODFILIAL SMALLINT,
ICODEMP INTEGER,
NVLRINICAIXA NUMERIC(15, 5),
DDTAMOV DATE,
ICODFILIALUS SMALLINT,
CIDUSU CHAR(8))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE PVADICMOVCAIXASP01 (ICODCAIXA INTEGER,
NVLRINICAIXA NUMERIC(18, 3),
ICODEMP INTEGER,
SCODFILIAL SMALLINT,
DDTAMOV DATE)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE PVFECHACAIXASP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODCAIXA INTEGER,
DDTAMOV DATE,
REDUZ CHAR(1),
ICODFILIALUS SMALLINT,
CIDUSU CHAR(8))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE PVFECHAVENDASP (ICODEMP INTEGER,
ICODFILIAL SMALLINT,
NVALOR NUMERIC(15, 5),
ITERM INTEGER,
DDTAMOV DATE,
CIDUSU CHAR(8))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE PVRETMOVCAIXASP (ICODCAIXA INTEGER,
ICODEMP INTEGER,
ICODFILIAL SMALLINT,
DDTAMOV DATE)
RETURNS (DDTAMOVRET DATE,
CTIPOMOV CHAR(1),
NVLRSLDMOV NUMERIC(15, 5),
CIDUSU CHAR(8))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE PVSANGRIASP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
NVALOR NUMERIC(18, 3),
ICODCAIXA INTEGER,
DDTAMOV DATE,
CIDUSU CHAR(8))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE PVSEQMOVCAIXASP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODCAIXA INTEGER,
DDTAMOV DATE)
RETURNS (INROMOV INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE PVSUPRIMENTOSP (ICODEMP INTEGER,
ICODFILIAL SMALLINT,
NVALOR NUMERIC(18, 3),
ITERM INTEGER,
DDTAMOV DATE,
CIDUSU CHAR(8))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE PVVALIDFAIXACAIXASP (ICODEMP INTEGER,
ICODFILIAL SMALLINT,
ICODCAIXA INTEGER,
NEWSEQINI INTEGER,
NEWSEQMAX INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE PVVERIFCAIXASP (ICODCAIXA INTEGER,
ICODEMP INTEGER,
SCODFILIAL SMALLINT,
DDTAMOV DATE,
SCODFILIALUS SMALLINT,
CIDUSU CHAR(8))
RETURNS (IRETORNO INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE RHLISTACANDVAGASP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODVAGA INTEGER,
ICODFUNC INTEGER)
RETURNS (CODCAND INTEGER,
NOMECAND CHAR(50),
FONECAND CHAR(12),
PRETENSAOSAL NUMERIC(15, 2),
QUALIFICACOES INTEGER,
RESTRICOES INTEGER,
CURSOS INTEGER,
EXPERIENCIA INTEGER,
STVAGACAND CHAR(2),
STCAND CHAR(2))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE RHLISTAVAGACANDSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODCAND INTEGER)
RETURNS (CODVAGA INTEGER,
NOMEEMPR CHAR(60),
CODFUNC INTEGER,
DESCFUNC VARCHAR(100),
FAIXASALINI NUMERIC(15, 2),
FAIXASALFIM NUMERIC(15, 2),
STVAGA CHAR(2),
QUALIFICACOES INTEGER,
RESTRICOES INTEGER,
CURSOS INTEGER,
STVAGACAND CHAR(2))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE SGAGENTEISP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
CTIPOAGE CHAR(5),
CDESCAGE CHAR(50))
RETURNS (CODAGE INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE SGAGENTEUIDSP (CIUD CHAR(1),
ICODEMP INTEGER,
CTIPOAGE CHAR(5),
ICODAGE INTEGER,
CDESCAGE CHAR(50))
RETURNS (CODEMP INTEGER,
CODFILIAL SMALLINT,
TIPOAGE CHAR(5),
CODAGE INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE SGAGENTEUSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
CTIPOAGE CHAR(5),
ICODAGE INTEGER,
CDESCAGE CHAR(50))
RETURNS (CODAGE INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE SGATUALIZABDSP (ICODEMP INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE SGCALCVENCSP (CODEMP INTEGER,
DTBASE DATE,
DTVENC DATE,
REGRVCTO CHAR(1),
RVSAB CHAR(1),
RVDOM CHAR(1),
RVFER CHAR(1),
RVDIA CHAR(1),
DIAVCTO SMALLINT,
DIASVCTO SMALLINT)
RETURNS (DTVENCRET DATE)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE SGDADOSINISP (ICODEMP INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE SGDEBUGSP (ROTINA VARCHAR(60),
TEXTO VARCHAR(1000))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE SGESTACAOIMPSP01 (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODEST INTEGER,
SNROIMP SMALLINT,
CPADIMP CHAR(1))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE SGFIMCONSP AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE SGGERACNFSP (TIPO VARCHAR(2),
CODEMP INTEGER,
CODFILIAL SMALLINT,
TIPOVENDA VARCHAR(2),
CODVENDA INTEGER,
CODEMPCP INTEGER,
CODFILIALCP SMALLINT,
CODCOMPRA INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE SGGRANTADMSP (ICODEMP INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE SGGRANTUSERSP AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE SGINICONSP (ICODEMP INTEGER,
CIDUSU CHAR(8),
ICODFILIALSEL SMALLINT,
ICODTERM SMALLINT)
RETURNS (SRET SMALLINT)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE SGLOGSP01 (CLASLOG CHAR(2),
TIPOLOG CHAR(3),
DESCLOG CHAR(60),
OBSLOG VARCHAR(1000))
RETURNS (CODFILIAL SMALLINT,
CODLOG INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE SGOBJETOATUALIZANIVELSP (CODEMP INTEGER)
RETURNS (IDOBJ VARCHAR(30),
NIVELOBJ SMALLINT)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE SGOBJETOINSTBSP (ICODEMP INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE SGRETCAIXA RETURNS (CODEMP INTEGER,
CODFILIAL SMALLINT,
CODTERM INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE SGRETFILIAL (ICODEMP INTEGER,
SNOMETAB CHAR(30))
RETURNS (ICODFILIAL SMALLINT)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE SGRETINFOUSU (CODEMP INTEGER,
IDUSU VARCHAR(128))
RETURNS (ANOCCUSU SMALLINT,
CODEMPCCUSU INTEGER,
CODFILIALCCUSU SMALLINT,
CODEMPUSU INTEGER,
CODFILIALUSU SMALLINT,
CODCCUSU CHAR(19),
IDUSUS CHAR(8),
ALMOXARIFE CHAR(1),
APROVARMA CHAR(2))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE SGRETMULTIALMOXSP (ICODEMP INTEGER)
RETURNS (CMULTIALMOX CHAR(1))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE SGRETMULTICOMISSP (ICODEMP INTEGER,
CODEMPTM INTEGER,
CODFILIALTM SMALLINT,
CODTIPOMOV INTEGER)
RETURNS (CMULTICOMIS CHAR(1))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE SGRETVERSAO RETURNS (VERSAO VARCHAR(30))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE SGSEQUENCE_IDSP (STABLE_NAME VARCHAR(128))
RETURNS (BISEQ BIGINT)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE SGSETAGENDASP (CODAGD INTEGER,
CODEMP INTEGER,
DTAINIAGD DATE,
HRINIAGD TIME,
DTAFIMAGD DATE,
HRFIMAGD TIME,
ASSUNTOAGD CHAR(50),
DESCAGD VARCHAR(10000),
CODFILIALTA SMALLINT,
CODTIPOAGD INTEGER,
PRIORAGD SMALLINT,
CODAGE INTEGER,
TIPOAGE CHAR(5),
CODFILIALAE SMALLINT,
CODAGEEMIT INTEGER,
TIPOAGEEMIT CHAR(5),
CAAGD CHAR(2),
SITAGD CHAR(2),
RESOLUCAOMOTIVO VARCHAR(10000),
CODAGDAR INTEGER,
DIATODO CHAR(1))
RETURNS (IRET INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE SGULTIMODIAMESSP (DTCALC DATE)
RETURNS (DTRET DATE)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE SGUPACESSOMUSP (ICODEMP INTEGER,
ICODFILIAL INTEGER,
SIDUSU CHAR(8),
ICODSIS INTEGER,
ICODMODU INTEGER,
ICODMENU INTEGER,
CTPACESSOMU CHAR(1))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE SGUPMENUSP01 (ICODSIS INTEGER,
CDESCSIS CHAR(200),
ICODMODU INTEGER,
CDESCMODU CHAR(200),
ICODMENU INTEGER,
CDESCMENU CHAR(200),
CNOMEMENU CHAR(200),
CACAOMENU CHAR(200),
ICODSISPAI INTEGER,
ICODMODUPAI INTEGER,
ICODMENUPAI INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE SGVALUES (TEXTO VARCHAR(100))
RETURNS (RESULT VARCHAR(100))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE SPGERANUM (ICODEMP INTEGER,
ICODFILIAL INTEGER,
STAB CHAR(2))
RETURNS (ISEQ INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE SPGERANUMPDV (ICODEMP INTEGER,
ICODFILIAL SMALLINT,
ICODCAIXA INTEGER)
RETURNS (ISEQ INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE TKCONTCLISP (CODEMP INTEGER,
CODFILIAL INTEGER,
CODCTO INTEGER,
CODFILIALTI INTEGER,
CODTIPOCLI INTEGER,
CODFILIALCC INTEGER,
CODCLASCLI INTEGER,
CODFILIALSR INTEGER,
CODSETOR INTEGER)
RETURNS (IRET INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE TKGERACAMPANHACTO (TIPOCTO CHAR(1),
CODEMPCA INTEGER,
CODFILIALCA SMALLINT,
CODCAMP CHAR(13),
CODEMPCO INTEGER,
CODFILIALCO SMALLINT,
CODCTO INTEGER,
CODEMPAT INTEGER,
CODFILIALAT SMALLINT,
CODATIV INTEGER,
SITHISTTK CHAR(2),
DESCHISTTK VARCHAR(1000))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE TKSETHISTSP (CODHISTTK INTEGER,
CODEMP INTEGER,
CODFILIALCO INTEGER,
CODCTO INTEGER,
CODFILIALCL INTEGER,
CODCLI INTEGER,
DESCHISTTK VARCHAR(10000),
CODFILIALAE INTEGER,
CODATEND INTEGER,
SITHISTTK CHAR(2),
DATAHISTTK DATE,
TIPOHISTTK CHAR(1))
RETURNS (IRET INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE VDADICCOMISSAOSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODREC INTEGER,
INPARCITREC INTEGER,
NVLRVENDACOMI NUMERIC(15, 5),
NVLRCOMI NUMERIC(15, 5),
DDATACOMI DATE,
DDTCOMPCOMI DATE,
DDTVENCCOMI DATE,
CTIPOCOMI CHAR(1),
CODEMPVD INTEGER,
CODFILIALVD SMALLINT,
CODVEND INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE VDADICITEMPDVSP (CODVENDA INTEGER,
CODEMP INTEGER,
CODFILIAL CHAR(8),
CODPROD INTEGER,
CODEMPPD INTEGER,
CODFILIALPD INTEGER,
QTDITVENDA NUMERIC(9, 5),
VLRPRECOITVENDA NUMERIC(18, 5),
VLRDESCITVENDA NUMERIC(18, 5),
PERCDESCITVENDA NUMERIC(15, 5),
VLRCOMISITVENDA NUMERIC(15, 5),
PERCCOMISITVENDA NUMERIC(15, 5),
SCODLOTE VARCHAR(20),
CODEMPLE INTEGER,
CODFILIALLE SMALLINT,
CODFILIALCV SMALLINT,
CODCONV INTEGER)
RETURNS (CODITVENDA INTEGER,
PERCICMSITVENDA NUMERIC(9, 2),
VLRBASEICMSITVENDA NUMERIC(18, 3),
VLRICMSITVENDA NUMERIC(18, 3),
VLRLIQITVENDA NUMERIC(18, 3),
TIPOFISC CHAR(2))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE VDADICITORCRECMERCSP (CODEMP INTEGER,
CODFILIAL SMALLINT,
TICKET INTEGER,
CODEMPOC INTEGER,
CODFILIALOC SMALLINT,
CODORC INTEGER,
COMPONENTES CHAR(1),
SERVICOS CHAR(1),
NOVOS CHAR(1))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE VDADICITVENDAORCSP (FILIALATUAL INTEGER,
ICODVENDA INTEGER,
ICODORC INTEGER,
ICODITORC INTEGER,
ICODFILIAL SMALLINT,
ICODEMP INTEGER,
STIPOVENDA CHAR(10),
TPAGRUP CHAR(1),
IQTDITVENDA NUMERIC(15, 5),
VLRDESCITVENDA NUMERIC(15, 5))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE VDADICVENDAORCSP (    codemp integer,
    codfilial smallint,
    codorc integer,
    codfilialvd integer,
    tipovenda char(1),
    codvenda integer,
    dtsaidavenda date)
RETURNS (IRET INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE VDATUDESCVENDAORCSP (CODEMPVD INTEGER,
CODFILIALVD SMALLINT,
TIPOVENDA CHAR(1),
CODVENDA INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE VDBAIXACOMISSAOSP (STIPO CHAR(1),
DINI DATE,
DFIM DATE,
ICODVEND INTEGER,
ICODEMPVD INTEGER,
ICODFILIALVD SMALLINT,
SCODCONTA CHAR(10),
ICODEMPCA INTEGER,
ICODFILIALCA SMALLINT,
SCODPLAN CHAR(13),
ICODEMPPN INTEGER,
ICODFILIALPN SMALLINT,
DDATA DATE,
IDOC INTEGER,
DVLR NUMERIC(15, 5),
SOBS CHAR(50),
ICODEMP INTEGER,
ICODFILIAL SMALLINT)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE VDBLOQVENDASP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
CTIPOVENDA CHAR(1),
ICODVENDA INTEGER,
CBLOQVENDA CHAR(1))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE VDBUSCACUSTOVENDASP (CODEMPVD INTEGER,
CODFILIALVD SMALLINT,
CODVENDA INTEGER,
TIPOVENDA CHAR(1),
CODEMPOC INTEGER,
CODFILIALOC INTEGER,
CODORC INTEGER,
TIPOORC CHAR(1),
CODITORC INTEGER)
RETURNS (VLRPROD NUMERIC(15, 5),
VLRDESC NUMERIC(15, 5),
VLRICMS NUMERIC(15, 5),
VLROUTRAS NUMERIC(15, 5),
VLRCOMIS NUMERIC(15, 5),
VLRADIC NUMERIC(15, 5),
VLRIPI NUMERIC(15, 5),
VLRPIS NUMERIC(15, 5),
VLRCOFINS NUMERIC(15, 5),
VLRIR NUMERIC(15, 5),
VLRCSOCIAL NUMERIC(15, 5),
VLRFRETE NUMERIC(15, 5),
TIPOFRETE CHAR(1),
ADICFRETE CHAR(1),
VLRCUSTOPEPS NUMERIC(15, 5),
VLRCUSTOMPM NUMERIC(15, 5),
VLRPRECOULTCP NUMERIC(15, 5))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE VDBUSCAPRECOSP (ICODPROD INTEGER,
ICODCLI INTEGER,
ICODEMPCL INTEGER,
ICODFILIALCL SMALLINT,
ICODPLANOPAG INTEGER,
ICODEMPPG INTEGER,
ICODFILIALPG SMALLINT,
ICODTIPOMOV INTEGER,
ICODEMPTM INTEGER,
ICODFILIALTM SMALLINT,
ICODEMP INTEGER,
ICODFILIAL SMALLINT)
RETURNS (PRECO NUMERIC(14, 5),
CODCLASCLIP INTEGER,
CODPLANOPAGP INTEGER,
CODPRECOPRODP INTEGER,
CODTABP INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE VDCLIENTEATIVOSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODCLI INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE VDCONTRATOTOTSP (CODEMPCT INTEGER,
CODFILIALCT SMALLINT,
CODCONTR INTEGER,
CODITCONTR INTEGER,
CODEMPSC INTEGER,
CODFILIALSC SMALLINT,
CODCONTRSC INTEGER,
CODEMPTA INTEGER,
CODFILIALTA SMALLINT,
CODTAREFA INTEGER,
CODEMPST INTEGER,
CODFILIALST SMALLINT,
CODTAREFAST INTEGER,
DATAINI DATE,
DATAFIM DATE)
RETURNS (TOTALPREVGERAL NUMERIC(15, 5),
TOTALPREVPER NUMERIC(15, 5),
TOTALGERAL NUMERIC(15, 5),
TOTALCOBCLIGERAL NUMERIC(15, 5),
TOTALANT NUMERIC(15, 5),
TOTALCOBCLIANT NUMERIC(15, 5),
TOTALPER NUMERIC(15, 5),
TOTALCOBCLIPER NUMERIC(15, 5),
SALDOANT NUMERIC(15, 5),
SALDOPER NUMERIC(15, 5))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE VDCOPIACLIENTE (ICODCLI INTEGER,
IDOCUMENTO VARCHAR(14),
ICODEMP INTEGER,
ICODFILIAL INTEGER)
RETURNS (ICOD INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE VDCOPIAORCSP (CODEMP INTEGER,
CODFILIAL INTEGER,
CODORC INTEGER,
CODFILIALCL INTEGER,
CODCLI INTEGER)
RETURNS (IRET INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE VDDESBAIXACOMISSAOSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODVEND INTEGER,
CORDEM CHAR(1),
DINI DATE,
DFIM DATE)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE VDESTORNACOMISSAOSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODEMPVD INTEGER,
SCODFILIALVD SMALLINT,
ICODVEND INTEGER,
DINI DATE,
DFIM DATE,
CORDEM CHAR(1))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE VDEVOLUVENDAS (ICODEMP SMALLINT,
ICODFILIAL SMALLINT,
DATAINI DATE,
DATAFIM DATE,
ICODTIPOCLI SMALLINT,
ICODCLI SMALLINT,
FILTRAVENDAS CHAR(1),
FATURADO CHAR(1),
FINANCEIRO CHAR(1),
EMITIDO CHAR(1))
RETURNS (VALOR NUMERIC(15, 5),
MES SMALLINT,
ANO SMALLINT)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE VDGERACOMISSAOSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODREC INTEGER,
INPARCITREC INTEGER,
NVLRCOMIITREC NUMERIC(15, 5),
DDTVENCITREC DATE)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE VDGERAESTORNOCOMISP AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE VDITVENDASERIESP (TRANSACAO CHAR(1),
CODEMP INTEGER,
CODFILIAL SMALLINT,
CODVENDA INTEGER,
TIPOVENDA CHAR(1),
CODITVENDA SMALLINT,
CODEMPPD INTEGER,
CODFILIALPD SMALLINT,
CODPROD INTEGER,
NUMSERIETMP VARCHAR(30),
QTDITVENDA INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE VDREORGVENDASP (CODEMP INTEGER,
CODFILIAL SMALLINT,
TIPOVENDA CHAR(1),
CODVENDA INTEGER)
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE VDRETULTVDCLIPROD (ICODEMP INTEGER,
ICODCLI INTEGER,
ICODFILIALVD SMALLINT,
ICODVEND INTEGER,
DTINI DATE,
DTFIM DATE,
CODEMPTIPOCL INTEGER,
CODFILIALTIPOCL SMALLINT,
CODTIPOCLI INTEGER)
RETURNS (RAZCLI_RET CHAR(60),
CODCLI_RET INTEGER,
DESCPROD_RET CHAR(50),
CODPROD_RET INTEGER,
DTEMITVENDA_RET DATE,
DOCVENDA_RET INTEGER,
SERIE_RET CHAR(4),
PRECOVENDA_RET NUMERIC(15, 4),
OBSITVENDA_RET VARCHAR(500),
REFPROD_RET VARCHAR(20),
QTDPROD_RET NUMERIC(15, 5))
AS 
BEGIN SUSPEND; END ^
CREATE PROCEDURE VDUPVENDAORCSP (ICODEMP INTEGER,
ICODFILIAL INTEGER,
ICODORC INTEGER,
ICODITORC INTEGER,
ICODFILIALVD INTEGER,
ICODVENDA INTEGER,
ICODITVENDA INTEGER,
STIPOVENDA CHAR(10))
AS 
BEGIN SUSPEND; END ^

ALTER PROCEDURE ARREDDOUBLE (DEVALOR NUMERIC(15, 5),
ICASASDEC INTEGER)
RETURNS (DERETORNO DOUBLE PRECISION)
AS 
 
 
 
DECLARE VARIABLE I INTEGER;
DECLARE VARIABLE J INTEGER;
begin
  /* Procedure Text */
  I=1;
  J=1;
  WHILE (:J<=:iCasasDec) DO
  BEGIN
     I = I * 10;
     J=J+1;
  END
  deRetorno = floor(deValor * i + 0.5) / i;
  suspend;
end ^

ALTER PROCEDURE ATADICATENDIMENTOCLISP (ICODTIPOATENDO INTEGER,
ICODATEND INTEGER,
ICODSETOR INTEGER,
ICODEMP INTEGER,
ICODFILIAL INTEGER,
IDOC INTEGER,
DATAATENDO DATE,
DATAATENDOFIN DATE,
HORAATENDO TIME,
HORAATENDOFIN TIME,
OBSATENDO VARCHAR(10000),
CODEMPCL INTEGER,
CODFILIALCL SMALLINT,
CODCLI INTEGER,
CODEMPCT INTEGER,
CODFILIALCT INTEGER,
CODCONTR INTEGER,
CODITCONTR INTEGER,
CODREC INTEGER,
NPARCITREC INTEGER,
CODEMPCH INTEGER,
CODFILIALCH SMALLINT,
CODCHAMADO INTEGER,
OBSINTERNO VARCHAR(10000),
CONCLUICHAMADO CHAR(1),
CODEMPEA INTEGER,
CODFILIALEA SMALLINT,
CODESPEC INTEGER)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

declare variable icodatendo integer;
declare variable ifilialatendo integer;
declare variable ifilialtipoatendo integer;
declare variable ifilialatend integer;
declare variable ifilialsetor integer;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'ATATENDIMENTO') INTO IFILIALATENDO;
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'ATTIPOATENDO') INTO IFILIALTIPOATENDO;
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'ATATENDENTE') INTO IFILIALATEND;
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'ATSETOR') INTO IFILIALSETOR;
  SELECT ISEQ FROM SPGERANUM(:ICODEMP,:IFILIALATENDO,'AT') INTO ICODATENDO;

  INSERT INTO ATATENDIMENTO (
    CODEMP,CODFILIAL,CODATENDO,CODEMPTO,
    CODFILIALTO,CODTPATENDO,CODEMPAE,
    CODFILIALAE,CODATEND,CODEMPSA,CODFILIALSA,
    CODSETAT,STATUSATENDO,IDUSU,CODEMPUS,CODFILIALUS,DOCATENDO, DATAATENDO,
    DATAATENDOFIN, HORAATENDO, HORAATENDOFIN, OBSATENDO, CODEMPCL, CODFILIALCL, CODCLI, CODEMPCT, CODFILIALCT,
    CODCONTR, CODITCONTR, CODEMPCH, CODFILIALCH, CODCHAMADO, obsinterno, CONCLUICHAMADO,
    CODEMPEA, CODFILIALEA, CODESPEC )

  VALUES
  (
    :ICODEMP,:IFILIALATENDO,:ICODATENDO,:ICODEMP,
    :IFILIALTIPOATENDO,:ICODTIPOATENDO,:ICODEMP,
    :IFILIALATEND,:ICODATEND,:ICODEMP,:IFILIALSETOR,
    :ICODSETOR,'AA',lower(USER),:ICODEMP,:ICODFILIAL,:IDOC,
    :DATAATENDO,:DATAATENDOFIN,:HORAATENDO,:HORAATENDOFIN,:OBSATENDO,:CODEMPCL,
    :CODFILIALCL,:CODCLI, :CODEMPCT, :CODFILIALCT, :CODCONTR, :CODITCONTR, :codempch,
    :codfilialch, :codchamado, :obsinterno, :CONCLUICHAMADO,
    :CODEMPEA, :CODFILIALEA, :CODESPEC
  );

  -- Caso o atendimento tenha vinculo com o contas a receber
  IF(CODREC IS NOT NULL AND NPARCITREC IS NOT NULL) THEN
  BEGIN
    INSERT INTO ATATENDIMENTOITREC (CODEMP,CODFILIAL,CODATENDO,CODEMPIR,CODFILIALIR,CODREC,NPARCITREC) VALUES
        (:ICODEMP,:ICODFILIAL,:ICODATENDO,:ICODEMP,:ICODFILIAL,:CODREC,:NPARCITREC);
  END



END ^

ALTER PROCEDURE ATADICATENDIMENTOSP (ICODCONV INTEGER,
ICODTIPOATENDO INTEGER,
ICODATEND INTEGER,
ICODSETOR INTEGER,
VOBSATENDO VARCHAR(10000),
ICODEMP INTEGER,
ICODFILIAL INTEGER,
IDOC INTEGER)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

DECLARE VARIABLE ICODATENDO INTEGER;
DECLARE VARIABLE IFILIALATENDO INTEGER;
DECLARE VARIABLE IFILIALCONV INTEGER;
DECLARE VARIABLE IFILIALTIPOATENDO INTEGER;
DECLARE VARIABLE IFILIALATEND INTEGER;
DECLARE VARIABLE IFILIALSETOR INTEGER;
DECLARE VARIABLE IFILIALPREF INTEGER;
DECLARE VARIABLE IFILIALVEND INTEGER;
DECLARE VARIABLE IFILIALORC INTEGER;
DECLARE VARIABLE ICODTPATENDOLEV INTEGER; /*TIPO DE ATENDIMENTO PARA LEVANTAMENTOS*/
DECLARE VARIABLE ICODORC INTEGER;
DECLARE VARIABLE ICODCLI INTEGER;
DECLARE VARIABLE ICODVEND INTEGER;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'ATATENDIMENTO') INTO IFILIALATENDO;
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'ATCONVENIADO') INTO IFILIALCONV;
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'ATTIPOATENDO') INTO IFILIALTIPOATENDO;
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'ATATENDENTE') INTO IFILIALATEND;
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'ATSETOR') INTO IFILIALSETOR;
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'VDORCAMENTO') INTO IFILIALORC;
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'SGPREFERE2') INTO IFILIALPREF;
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'VDVENDEDOR') INTO IFILIALVEND;
  SELECT ISEQ FROM SPGERANUM(:ICODEMP,:IFILIALATENDO,'AT') INTO ICODATENDO;
  SELECT CODTPATENDO FROM SGPREFERE2 WHERE CODEMP=:ICODEMP AND CODFILIAL=:IFILIALPREF INTO ICODTPATENDOLEV;
  INSERT INTO ATATENDIMENTO (
    CODEMP,CODFILIAL,CODATENDO,CODCONV,
    CODEMPCV,CODFILIALCV,CODEMPTO,
    CODFILIALTO,CODTPATENDO,CODEMPAE,
    CODFILIALAE,CODATEND,CODEMPSA,CODFILIALSA,
    CODSETAT,STATUSATENDO,OBSATENDO,IDUSU,CODEMPUS,CODFILIALUS,DOCATENDO)
  VALUES
  (
    :ICODEMP,:IFILIALATENDO,:ICODATENDO,:ICODCONV,
    :ICODEMP,:IFILIALCONV,:ICODEMP,
    :IFILIALTIPOATENDO,:ICODTIPOATENDO,:ICODEMP,
    :IFILIALATEND,:ICODATEND,:ICODEMP,:IFILIALSETOR,
    :ICODSETOR,'AA',:VOBSATENDO,lower(USER),:ICODEMP,:ICODFILIAL,:IDOC
  );
/*  SELECT CODORC FROM ATATENDIMENTOORC WHERE CODEMP=:ICODEMP
    AND CODFILIAL=:IFILIALORC AND CODORC=:IDOC INTO ICODORC;*/
  IF (ICODTIPOATENDO = ICODTPATENDOLEV/* AND ICODORC IS NULL*/) THEN
  BEGIN
    SELECT ISEQ FROM SPGERANUM(:ICODEMP,:IFILIALORC,'OC') INTO ICODORC;
    SELECT CODFILIALVD,CODVEND FROM SGPREFERE2 WHERE
      CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL INTO IFILIALVEND,ICODVEND;
    INSERT INTO VDORCAMENTO (CODEMP,CODFILIAL,TIPOORC,CODORC,CODEMPCV,CODFILIALCV,CODCONV,
        DTORC,DTVENCORC,STATUSORC,CODEMPVD,CODFILIALVD,CODVEND)
      VALUES
      (
        :ICODEMP,:IFILIALORC,'O',:ICODORC,:ICODEMP,:IFILIALCONV,:ICODCONV,
        CAST ('today' AS DATE),CAST ('today' AS DATE),'OA',:ICODEMP,:IFILIALVEND,:ICODVEND
      );


    INSERT INTO ATATENDIMENTOORC (CODEMP,CODFILIAL,CODATENDO,CODEMPOC,CODFILIALOC,TIPOORC,CODORC)
      VALUES
        (:ICODEMP,:IFILIALORC,:ICODATENDO,:ICODEMP,:IFILIALORC,'O',:ICODORC);

    UPDATE ATATENDIMENTO SET DOCATENDO = :IDOC WHERE
      CODEMP=:ICODEMP AND CODFILIAL=:IFILIALATENDO AND CODATENDO=:ICODATENDO;
  END

END ^

ALTER PROCEDURE ATATENDIMENTOIUSP (IU CHAR(1),
CODEMP INTEGER,
CODFILIAL SMALLINT,
CODATENDO INTEGER,
CODEMPTO INTEGER,
CODFILIALTO SMALLINT,
CODTPATENDO INTEGER,
CODEMPAE INTEGER,
CODFILIALAE SMALLINT,
CODATEND INTEGER,
CODEMPSA INTEGER,
CODFILIALSA SMALLINT,
CODSETOR INTEGER,
DOCATENDO INTEGER,
DATAATENDO DATE,
DATAATENDOFIN DATE,
HORAATENDO TIME,
HORAATENDOFIN TIME,
OBSATENDO VARCHAR(10000),
CODEMPCL INTEGER,
CODFILIALCL SMALLINT,
CODCLI INTEGER,
CODEMPCT INTEGER,
CODFILIALCT SMALLINT,
CODCONTR INTEGER,
CODITCONTR SMALLINT,
CODEMPIR INTEGER,
CODFILIALIR SMALLINT,
CODREC INTEGER,
NPARCITREC INTEGER,
CODEMPCH INTEGER,
CODFILIALCH SMALLINT,
CODCHAMADO INTEGER,
OBSINTERNO VARCHAR(10000),
CONCLUICHAMADO CHAR(1),
CODEMPEA INTEGER,
CODFILIALEA SMALLINT,
CODESPEC INTEGER,
CODEMPUS INTEGER,
CODFILIALUS SMALLINT,
IDUSU VARCHAR(128),
STATUSATENDO CHAR(2),
CODEMPTA INTEGER,
CODFILIALTA SMALLINT,
CODTAREFA INTEGER,
CODEMPOC INTEGER,
CODFILIALOC INTEGER,
TIPOORC CHAR(1),
CODORC INTEGER,
SITATENDO CHAR(2),
CODEMPAG INTEGER,
CODFILIALAG SMALLINT,
TIPOAGE CHAR(5),
CODAGE INTEGER,
CODAGD INTEGER)
AS 

declare variable horaatendors time;
declare variable horaatendofinrs time;
declare variable dataatendors date;
declare variable contorc integer;
BEGIN

  DATAATENDORS = NULL;

  SELECT FIRST 1 A.DATAATENDO, A.HORAATENDO, A.HORAATENDOFIN
    FROM ATATENDIMENTO A
    WHERE A.CODEMP=:CODEMP AND A.CODFILIAL=:CODFILIAL AND
        A.CODEMPAE=:CODEMPAE AND A.CODFILIALAE=:CODFILIALAE AND
        A.CODATEND=:CODATEND AND A.CODATENDO<>:CODATENDO AND
        A.DATAATENDO=:DATAATENDO AND ( (A.HORAATENDO BETWEEN :HORAATENDO+1 AND :HORAATENDOFIN-1 )
        OR (A.HORAATENDOFIN BETWEEN :HORAATENDO+1 AND :HORAATENDOFIN-1 ) )
    INTO :DATAATENDORS, :HORAATENDORS, :HORAATENDOFINRS ;

  if (DATAATENDORS IS NOT NULL) then
  begin
     exception atatendimentoex02 'Jah existe(m) lancamento(s) em '||:dataatendors||' - h.: '||
        :horaatendors||' - '||:horaatendofinrs;
  end

  if (IU = 'I') then
  begin
     SELECT ISEQ FROM SPGERANUM(:CODEMP,:CODFILIAL,'AT') INTO :CODATENDO;
     STATUSATENDO = 'AA';
     INSERT INTO ATATENDIMENTO (
        CODEMP,CODFILIAL,CODATENDO,CODEMPTO,
        CODFILIALTO,CODTPATENDO,CODEMPAE,
        CODFILIALAE,CODATEND,CODEMPSA,CODFILIALSA,
        CODSETAT,STATUSATENDO,
        CODEMPUS,CODFILIALUS, IDUSU,
        DOCATENDO, DATAATENDO,
        DATAATENDOFIN, HORAATENDO, HORAATENDOFIN, OBSATENDO, CODEMPCL, CODFILIALCL, CODCLI, CODEMPCT, CODFILIALCT,
        CODCONTR, CODITCONTR, CODEMPCH, CODFILIALCH, CODCHAMADO, obsinterno, CONCLUICHAMADO,
        CODEMPEA, CODFILIALEA, CODESPEC , CODEMPTA, CODFILIALTA, CODTAREFA, SITATENDO )

     VALUES (
        :CODEMP, :CODFILIAL, :CODATENDO,
        :CODEMPTO, :CODFILIALTO, :CODTPATENDO,
        :CODEMPAE, :CODFILIALAE,:CODATEND,
        :CODEMPSA,:CODFILIALSA, :CODSETOR,
        :STATUSATENDO ,
        :CODEMPUS, :CODFILIALUS, lower(:IDUSU),
        :DOCATENDO, :DATAATENDO, :DATAATENDOFIN, :HORAATENDO,
        :HORAATENDOFIN, :OBSATENDO,
        :CODEMPCL, :CODFILIALCL, :CODCLI,
        :CODEMPCT, :CODFILIALCT, :CODCONTR, :CODITCONTR,
        :CODEMPCH, :CODFILIALCH, :CODCHAMADO,
        :OBSINTERNO, :CONCLUICHAMADO,
        :CODEMPEA, :CODFILIALEA, :CODESPEC , :CODEMPTA, :CODFILIALTA, :CODTAREFA, :SITATENDO
     );
  -- Caso o atendimento tenha vinculo com o contas a receber
     if (CODREC IS NOT NULL AND NPARCITREC IS NOT NULL) then
     begin
        INSERT INTO ATATENDIMENTOITREC (CODEMP,CODFILIAL,CODATENDO,CODEMPIR,CODFILIALIR,CODREC,NPARCITREC) VALUES
                (:CODEMP,:CODFILIAL,:CODATENDO,:CODEMPIR,:CODFILIALIR,:CODREC,:NPARCITREC);
     end

       -- Caso o atendimento tenha vinculo com o contas a receber
     if ( CODORC IS NOT NULL AND TIPOORC IS NOT NULL) then
     begin
        INSERT INTO atatendimentoorc (CODEMP,CODFILIAL,CODATENDO,CODEMPOC,CODFILIALOC,TIPOORC,CODORC) VALUES
                (:CODEMP,:CODFILIAL,:CODATENDO,:CODEMPOC,:CODFILIALOC,:TIPOORC,:CODORC);
     end

     -- Caso o atendimento tenha vinculo com um agendamento
     if ( CODAGD IS NOT NULL AND TIPOAGE IS NOT NULL) then
     begin
       
        INSERT INTO ATATENDOAGENDA (CODEMP, CODFILIAL, CODATENDO, CODEMPAG, CODFILIALAG, TIPOAGE, CODAGE, CODAGD)
                 VALUES (:CODEMP, :CODFILIAL, :CODATENDO, :CODEMPAG, :CODFILIALAG, :TIPOAGE, :CODAGE, :CODAGD);
     end

  end
  else if (IU = 'U') then
  begin
        UPDATE ATATENDIMENTO SET
            CODATEND=:CODATEND, DATAATENDO=:DATAATENDO, HORAATENDO=:HORAATENDO, DATAATENDOFIN=:DATAATENDOFIN,
            HORAATENDOFIN=:HORAATENDOFIN, OBSATENDO=:OBSATENDO,CODEMPTO=:CODEMPTO, CODFILIALTO=:CODFILIALTO,
            CODTPATENDO=:CODTPATENDO,CODEMPSA=:CODEMPSA, CODFILIALSA=:CODFILIALSA, CODSETAT=:CODSETOR, CODEMPCH=:CODEMPCH,
            CODFILIALCH=:CODFILIALCH, CODCHAMADO=:CODCHAMADO, CODEMPCT=:CODEMPCT, CODFILIALCT=:CODFILIALCT,
            CODCONTR=:CODCONTR, CODITCONTR=:CODITCONTR, STATUSATENDO=:STATUSATENDO, OBSINTERNO=:OBSINTERNO,
            CONCLUICHAMADO=:CONCLUICHAMADO, CODEMPEA=:CODEMPEA, CODFILIALEA=:CODFILIALEA, CODESPEC=:CODESPEC,
            CODEMPTA=:CODEMPTA, CODFILIALTA=:CODFILIALTA, CODTAREFA=:CODTAREFA,
            CODEMPCL=:CODEMPCL, CODFILIALCL=:CODFILIALCL, CODCLI=:CODCLI, SITATENDO=:SITATENDO
        WHERE
            CODEMP=:CODEMP AND CODFILIAL=:CODFILIAL AND CODATENDO=:CODATENDO;

        SELECT COUNT(*) FROM ATATENDIMENTOORC WHERE CODEMP=:CODEMP AND CODFILIAL=:CODFILIAL AND CODATENDO=:CODATENDO
        INTO :CONTORC;

        if ( :CONTORC = 0 AND CODORC IS NOT NULL AND TIPOORC IS NOT NULL) then
        begin
           INSERT INTO atatendimentoorc (CODEMP,CODFILIAL,CODATENDO,CODEMPOC,CODFILIALOC,TIPOORC,CODORC) VALUES
                    (:CODEMP,:CODFILIAL,:CODATENDO,:CODEMPOC,:CODFILIALOC,:TIPOORC,:CODORC);
        end

                 -- Caso o atendimento tenha vinculo com um agendamento
         if ( CODAGD IS NOT NULL AND TIPOAGE IS NOT NULL) then
         begin
           
            INSERT INTO ATATENDOAGENDA (CODEMP, CODFILIAL, CODATENDO, CODEMPAG, CODFILIALAG, TIPOAGE, CODAGE, CODAGD)
                     VALUES (:CODEMP, :CODFILIAL, :CODATENDO, :CODEMPAG, :CODFILIALAG, :TIPOAGE, :CODAGE, :CODAGD);
         end
  end
END ^

ALTER PROCEDURE ATBUSCAPRECOSP (ICODPROD INTEGER,
ICODCONV INTEGER,
ICODEMPCV INTEGER,
ICODFILIALCV SMALLINT,
ICODPLANOPAG INTEGER,
ICODEMPPG INTEGER,
ICODFILIALPG SMALLINT,
ICODEMP INTEGER,
ICODFILIAL SMALLINT)
RETURNS (PRECO NUMERIC(15, 5))
AS 
 

DECLARE VARIABLE iCodTipoMov INTEGER;
  DECLARE VARIABLE iCodEmpTM INTEGER;
  DECLARE VARIABLE iCodFilialTM INTEGER;
  DECLARE VARIABLE iCodCli INTEGER;
  DECLARE VARIABLE iCodEmpCli INTEGER;
  DECLARE VARIABLE iCodFilialCli INTEGER;
BEGIN
  SELECT CODTIPOMOV2,CODEMPT2,CODFILIALT2 FROM SGPREFERE1 WHERE CODEMP=:ICODEMP
         AND CODFILIAL=:ICODFILIAL INTO iCodTipoMov,iCodEmpTM,iCodFilialTM;
  SELECT CODCLI,CODEMPCL,CODFILIALCL FROM ATCONVENIADO WHERE CODCONV=:ICODCONV
         AND CODEMP=:ICODEMPCV AND CODFILIAL=:ICODFILIALCV INTO iCodCli,iCodEmpCli,iCodFilialCli;

  SELECT PRECO FROM VDBUSCAPRECOSP(:ICODPROD,:iCodCli,:iCodEmpCli,:iCodFilialCli,:ICODPLANOPAG,:ICODEMPPG,
    :ICODFILIALPG,:iCodTipoMov,:iCodEmpTM,:iCodFilialTM,:ICODEMP,:ICODFILIAL) INTO PRECO;

  SUSPEND;
END ^

ALTER PROCEDURE ATRESUMOATENDOSP01 (CODEMPP INTEGER,
CODFILIALP SMALLINT,
CODCLIP INTEGER,
CODEMPCTP INTEGER,
CODFILIALCTP SMALLINT,
CODCONTRP INTEGER,
CODITCONTRP SMALLINT,
DTINIP DATE,
DTFIMP DATE)
RETURNS (ANO SMALLINT,
MES SMALLINT,
CODEMPCL INTEGER,
CODFILIALCL SMALLINT,
CODCLI INTEGER,
CODEMPCT INTEGER,
CODFILIALCT SMALLINT,
CODCONTR INTEGER,
QTDCONTR DECIMAL(15, 5),
DTINICIO DATE,
VALOR DECIMAL(15, 5),
VALOREXCEDENTE DECIMAL(15, 5),
QTDITCONTR DECIMAL(15, 5),
QTDHORAS DECIMAL(15, 2),
MESCOB INTEGER,
SALDOMESCOB DECIMAL(15, 5),
SALDOMES DECIMAL(15, 5),
SALDOPERIODO DECIMAL(15, 5),
EXCEDENTEMESCOB DECIMAL(15, 5),
EXCEDENTEPERIODO DECIMAL(15, 5),
EXCEDENTECOB DECIMAL(15, 5),
VALOREXCEDENTECOB DECIMAL(15, 5),
VALORTOTALCOB DECIMAL(15, 5),
VALORCONTR DECIMAL(15, 5),
EXCEDENTEMES DECIMAL(15, 5),
TOTFRANQUIAMES DECIMAL(15, 5))
AS 

begin
  saldoperiodo = 0;
 -- saldoperiodo2 = 0;
  saldomescob = 0;
  excedentemescob = 0;
  excedenteperiodo = 0;
--  excedenteperiodo2 = 0;
  excedentecob = 0;
  valorexcedentecob = 0;
  valortotalcob = 0;
  -- MES COBRANA
  mescob = extract(month from :dtfimp);
  -- DATA DO MS ANTERIOR A COBRANA
  --dtant = addmonth(:dtfimp, -1);
  -- MES ANTERIOR A COBRANA
 -- mesant = extract(month from :dtant);


  for select extract(year from a.dataatendo) ano
   , extract( month from a.dataatendo) mes
   , ct.codempcl, ct.codfilialcl, ct.codcli
   , ct.codemp codempct, ct.codfilial codfilialct, ct.codcontr
   , a.qtdcontr, a.dtinicio
    , avg((select avg(ic.vlritcontr) from vditcontrato ic
     where  ic.codemp=ct.codemp and ic.codfilial=ct.codfilial and ic.codcontr=ct.codcontr
     and coalesce(ic.franquiaitcontr,'N')='S' ) )  valor
   , avg((select avg(ic.vlritcontrexced) from vditcontrato ic
     where  ic.codemp=ct.codemp and ic.codfilial=ct.codfilial and ic.codcontr=ct.codcontr
     and coalesce(ic.franquiaitcontr,'N')='S' ) )  valorexcedente
   , avg((select sum(qtditcontr) from vditcontrato ic
     where  ic.codemp=ct.codemp and ic.codfilial=ct.codfilial and ic.codcontr=ct.codcontr
     and coalesce(ic.franquiaitcontr,'N')='S' ) )  qtditcontr
   , cast(sum(a.totalcobcli) as decimal(15,2)) qtdhoras
    from vdcontrato ct
    left outer join atatendimentovw02 a on
    a.codempcl=ct.codempcl and a.codfilialcl=ct.codfilialcl and a.codcli=ct.codcli
    and a.codempct=ct.codemp and a.codfilialct=ct.codfilial and a.codcontr=ct.codcontr
    and ( :coditcontrp=0 or a.coditcontr=:coditcontrp ) 
    and a.dataatendo between :dtinip  and
    :dtfimp and a.mrelcobespec='S'
    where
     ct.codempcl=:codempp and ct.codfilialcl=:codfilialp and ct.codcli=:codclip
    and ct.codemp=:codempctp and ct.codfilial=:codfilialctp  and ct.codcontr=:codcontrp
    and ct.recebcontr='S' and ct.tpcobcontr in ('ME','BI','AN') and ct.ativo='S'
    group by 1, 2, 3, 4, 5, 6, 7, 8, 9, 10
    order by 1 desc, 2 desc

   into :ano, :mes

   , :codempcl, :codfilialcl, :codcli
   , :codempct, :codfilialct, :codcontr, :qtdcontr, :dtinicio, :valor
   , :valorexcedente, :qtditcontr, :qtdhoras
   do
   begin
       /* Caso no existam lanamentos retornar ano e ms atual */
       if (:ano is null) then
          ano = extract(year from dtfimp);

       if (:mes is null) then
           mes = extract(month from dtfimp);

       -- TOTAL DE FRANQUIA NO MES
       totfranquiames = qtditcontr;

       -- SALDO MS
       if( :qtditcontr - :qtdhoras   > 0) then
           saldomes =  qtditcontr - qtdhoras;
       else
           saldomes = 0;

       -- VALOR CONTRATADO
       if (mes=mescob) then
          valorcontr = qtditcontr * valor;

       -- EXCEDENTE MES
       if( :qtdhoras < :qtditcontr ) then
          excedentemes = 0;
       else
          excedentemes = qtdhoras - qtditcontr;

       -- EXCEDENTE MES COBRANA
       if( (:qtdhoras > :qtditcontr) and (mes = mescob) ) then
          excedentemescob = excedentemes;

       if (mes=mescob) then
       begin
          --- SALDO DO MS DE COBRANA
          saldomescob = saldomescob + saldomes;
       end
       else
       begin
         -- SALDO DO PERODO
         saldoperiodo = saldoperiodo + saldomes;

         -- EXCEDENTE DO PERODO
          excedenteperiodo = excedenteperiodo + excedentemes;

       end 

   end

   -- EXCEDENTE COBRADO
   if( :excedenteperiodo - :saldoperiodo > 0) then
       excedentecob =  excedenteperiodo - saldoperiodo;
   else
       excedentecob = 0;

   if (excedentecob>0) then
      saldoperiodo = 0;

   saldoperiodo = saldoperiodo + saldomescob;
   excedentecob = excedentemescob;

   --VLRTOTAL =$V{QTDITCONTRCALC}.multiply($F{VALOR}).add($V{EXCEDENTECOB}.multiply( $V{VALOREXCEDENTE} ))

   -- VALOR A COBRAR EXCEDENTE
   valorexcedentecob = excedentecob * valorexcedente;
        
   -- VALOR TOTAL A COBRAR
   valortotalcob = (valorcontr) + (excedentecob * valorexcedente);

 -- saldoperiodo2 = 0;
  excedentemescob = 0;
  --excedenteperiodo2 = 0;

  for select extract(year from a.dataatendo) ano
   , extract( month from a.dataatendo) mes
   , ct.codempcl, ct.codfilialcl, ct.codcli
   , ct.codemp codempct, ct.codfilial codfilialct, ct.codcontr
   , a.qtdcontr, a.dtinicio
   , cast(sum(a.totalcobcli) as decimal(15,2)) qtdhoras
    from vdcontrato ct
    left outer join atatendimentovw02 a on
    a.codempcl=ct.codempcl and a.codfilialcl=ct.codfilialcl and a.codcli=ct.codcli
    and a.codempct=ct.codemp and a.codfilialct=ct.codfilial and a.codcontr=ct.codcontr
    and ( :coditcontrp=0 or a.coditcontr=:coditcontrp ) 
    and a.dataatendo between :dtinip  and
    :dtfimp and a.mrelcobespec='S'
    where
     ct.codempcl=:codempp and ct.codfilialcl=:codfilialp and ct.codcli=:codclip
    and ct.codemp=:codempctp and ct.codfilial=:codfilialctp  and ct.codcontr=:codcontrp
    and ct.recebcontr='S' and ct.tpcobcontr in ('ME','BI','AN') and ct.ativo='S'
    group by 1, 2, 3, 4, 5, 6, 7, 8, 9, 10
    order by 1 desc, 2 desc

   into :ano, :mes
   , :codempcl, :codfilialcl, :codcli
   , :codempct, :codfilialct, :codcontr
   , :qtdcontr, :dtinicio, :qtdhoras
   do
   begin
       /* Caso no existam lanamentos retornar ano e ms atual */
       if (:ano is null) then
          ano = extract(year from dtfimp);

       if (:mes is null) then
           mes = extract(month from dtfimp);

       -- TOTAL DE FRANQUIA NO MES
       totfranquiames = qtditcontr;

       -- SALDO MS
       if( :qtditcontr - :qtdhoras   > 0) then
           saldomes =  qtditcontr - qtdhoras;
       else
           saldomes = 0;

       -- VALOR CONTRATADO
       valorcontr = qtditcontr * valor;

       -- EXCEDENTE MES
       if( :qtdhoras < :qtditcontr ) then
          excedentemes = 0;
       else
          excedentemes = qtdhoras - qtditcontr;

       -- EXCEDENTE MES COBRANA
       if( (:qtdhoras < :qtditcontr)
       --or (mes <> mescob)
       ) then
          excedentemescob = 0;
       else
          excedentemescob = qtdhoras - qtditcontr;

       -- SALDO DO PERODO
--       saldoperiodo2 = saldoperiodo2 + saldomes;

       -- EXCEDENTE DO PERODO
  --     excedenteperiodo2 = excedenteperiodo2 + excedentemescob;

       --VLRTOTAL =$V{QTDITCONTRCALC}.multiply($F{VALOR}).add($V{EXCEDENTECOB}.multiply( $V{VALOREXCEDENTE} ))

       -- VALOR A COBRAR EXCEDENTE
--       valorexcedentecob = excedentecob * valorexcedente;
        
       -- VALOR TOTAL A COBRAR
--       valortotalcob = (qtditcontr * valor) + (excedentecob * valorexcedente);

      suspend;
   end


end ^

ALTER PROCEDURE ATRESUMOATENDOSP02 (CODEMPCLP INTEGER,
CODFILIALCLP SMALLINT,
CODCLIP INTEGER,
CODEMPCTP INTEGER,
CODFILIALCTP SMALLINT,
CODCONTRP INTEGER,
CODITCONTRP SMALLINT,
DTINIP DATE,
DTFIMP DATE)
RETURNS (CODEMPCL INTEGER,
CODFILIALCL SMALLINT,
CODCLI INTEGER,
RAZCLI VARCHAR(60),
CODEMPCT INTEGER,
CODFILIALCT SMALLINT,
CODITCONTR INTEGER,
CODCONTR INTEGER,
DESCCONTR VARCHAR(100),
VLRHORA DECIMAL(15, 5),
VLRHORAEXCED DECIMAL(15, 5),
QTDCONTR DECIMAL(15, 5),
QTDITCONTR DECIMAL(15, 5),
VLRCOB DECIMAL(15, 5),
VLRCOBEXCED DECIMAL(15, 5),
VLRCOBTOT DECIMAL(15, 5),
MES SMALLINT,
ANO SMALLINT,
QTDHORAS DECIMAL(15, 5),
SALDOMES DECIMAL(15, 5),
EXCEDENTEMES DECIMAL(15, 5),
EXCEDENTEMESCOB DECIMAL(15, 5),
ACUMULO SMALLINT,
CDATAINI DATE)
AS 

declare variable dtiniac date;
begin
  for select cl.codemp codempcl, cl.codfilial codfilialcl, cl.codcli, cl.razcli
    , ct.codemp codempct, ct.codfilial codfilialct, ct.codcontr, ct.desccontr, ct.dtinicio
    from vdcliente cl, vdcontrato ct
    where cl.codemp=:codempclp and cl.codfilial=:codfilialclp and (:codclip=0 or cl.codcli=:codclip)
       and ct.codemp=:codempctp and ct.codfilial=:codfilialctp and (:codcontrp=0 or ct.codcontr=:codcontrp)
       and ct.codempcl=cl.codemp and ct.codfilialcl=cl.codfilial and ct.codcli=cl.codcli
       and ct.ativo='S' and ct.tpcobcontr in ('ME','BI','AN') and ct.recebcontr='S'
     order by cl.razcli,  cl.codcli,  ct.codcontr
  into :codempcl, :codfilialcl, :codcli, :razcli
    , :codempct, :codfilialct, :codcontr, :desccontr, :cdataini
  do
  begin


--       and i.codemp=ct.codemp  and i.codfilial=ct.codfilial and i.codcontr=ct.codcontr and (:coditcontrp=0 or i.coditcontr=:coditcontrp)

  --vditcontrato i,

      select max(i.acumuloitcontr) from vditcontrato i
      where i.codemp=:codempct  and i.codfilial=:codfilialct and i.codcontr=:codcontr and (:coditcontrp=0 or i.coditcontr=:coditcontr)
      and i.acumuloitcontr is not null
      into :acumulo;
      if ( (:acumulo is null) or (:acumulo=0) ) then
      begin
        acumulo = 0;
        dtiniac = dtinip;
      end
      else
      begin
        dtiniac = dtinip;
        dtiniac = cast( addmonth(dtiniac, -1*acumulo) as date);
        if( dtiniac > dtinip ) then
         dtiniac = dtinip;
      end
      for select a.mes, a.ano, a.qtdcontr, a.valor, a.valorexcedente, a.qtditcontr, a.qtdhoras, a.valortotalcob
       , a.saldomes, a.excedentemes, a.excedentemescob, a.valorexcedentecob , a.valorcontr
         from atresumoatendosp01(:codempcl, :codfilialcl, :codcli
         , :codempct, :codfilialct, :codcontr, :coditcontrp, :dtiniac, :dtfimp) a
      into :mes, :ano, :qtdcontr, :vlrhora, :vlrhoraexced, :qtditcontr, :qtdhoras, :vlrcobtot
      , :saldomes, :excedentemes, :excedentemescob, :vlrcobexced, :vlrcob
      do
      begin
        
      suspend;
      end
  end
end ^

CREATE OR ALTER PROCEDURE CPADICCOMPRAPEDSP (
    codemp integer,
    codfilial smallint,
    codcompra integer,
    doccompra integer,
    codemptm integer,
    codfilialtm smallint,
    codtipomov integer,
    codempfr integer,
    codfilialfr smallint,
    codfor integer,
    codemppg integer,
    codfilialpg smallint,
    codplanopag integer,
    codempse integer,
    codfilialse smallint,
    serie char(4))
returns (
    iret integer)
as
declare variable statuscompra char(2);
begin

    --Buscando a srie da compra
    /*select tm.codempse, tm.codfilialse, tm.serie
    from eqtipomov tm
    where tm.codemp=:codemptm and tm.codfilial=:codfilialtm and tm.codtipomov=:codtipomov
    into :codempse, :codfilialse, :serie;
    */
    --Definio do status da compra
    statuscompra = 'P1';

    --Buscando doccompra 
    -- select doc from lfnovodocsp(:serie, :codempse , :codfilialse) into doccompra;

    insert into cpcompra (
    codemp, codfilial, codcompra, codemppg, codfilialpg, codplanopag, codempfr, codfilialfr, codfor,
    codempse, codfilialse, serie, codemptm, codfilialtm, codtipomov, doccompra, dtentcompra, dtemitcompra, statuscompra, calctrib )
    values (
    :codemp, :codfilial, :codcompra, :codemppg, :codfilialpg, :codplanopag, :codempfr, :codfilialfr, :codfor,
    :codempse, :codfilialse, :serie, :codemptm, :codfilialtm, :codtipomov, :doccompra,
    cast('today' as date), cast('today' as date), :statuscompra, 'S' );

    iret = :codcompra;

    suspend;

end^

ALTER PROCEDURE CPADICFORSP (CODEMP INTEGER,
CODFILIAL INTEGER,
CODFILIALCL INTEGER,
CODCLI INTEGER)
RETURNS (CODFOR INTEGER)
AS 
DECLARE VARIABLE CODTIPOFOR INTEGER;
DECLARE VARIABLE CODFILIALTF INTEGER;
DECLARE VARIABLE CODFILIALFR INTEGER;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(:CODEMP,'CPFORNECED') INTO CODFILIALFR;
  SELECT P.CODTIPOFOR,P.CODFILIALTF FROM SGPREFERE1 P WHERE P.CODEMP=:CODEMP
    AND P.CODFILIAL=:CODFILIAL INTO CODTIPOFOR,CODFILIALTF;
  SELECT MAX(CODFOR)+1 FROM CPFORNECED WHERE CODEMP=:CODEMP
    AND CODFILIAL=:CODFILIALFR INTO CODFOR;
  INSERT INTO CPFORNECED (CODEMP,CODFILIAL,CODFOR,RAZFOR,CODEMPTF,CODFILIALTF,
                        CODTIPOFOR,CODEMPBO,CODFILIALBO,CODBANCO,NOMEFOR,
                        DATAFOR,ATIVOFOR,PESSOAFOR,CNPJFOR,CPFFOR,INSCFOR,
                        RGFOR,ENDFOR,NUMFOR,COMPLFOR,BAIRFOR,CEPFOR,CIDFOR,
                        UFFOR,CONTFOR,FONEFOR,FAXFOR,AGENCIAFOR,CONTAFOR,
                        EMAILFOR,OBSFOR,CELFOR,CLIFOR)
                 SELECT :CODEMP,:CODFILIALFR,:CODFOR,RAZCLI,:CODEMP,:CODFILIALTF,
                        :CODTIPOFOR,NULL,NULL,NULL,NOMECLI,
                        DATACLI,ATIVOCLI,PESSOACLI,CNPJCLI,CPFCLI,INSCCLI,
                        RGCLI,ENDCLI,NUMCLI,COMPLCLI,BAIRCLI,CEPCLI,CIDCLI,
                        UFCLI,CONTCLI,FONECLI,FAXCLI,NULL,NULL,
                        EMAILCLI,OBSCLI,CELCLI,'C' FROM VDCLIENTE WHERE
                        CODCLI=:CODCLI AND CODFILIAL=:CODFILIALCL AND
                        CODEMP=:CODEMP;
  SUSPEND;
END ^

ALTER PROCEDURE CPADICITCOMPRAPEDSP (CODEMP INTEGER,
CODFILIAL SMALLINT,
CODCOMPRA INTEGER,
CODEMPPC INTEGER,
CODFILIALPC SMALLINT,
CODCOMPRAPC INTEGER,
CODITCOMPRAPC INTEGER,
TPAGRUP CHAR(1),
QTDITCOMPRA FLOAT,
VLRDESCITCOMPRA NUMERIC(15, 5),
PRECOITCOMPRA NUMERIC(15, 5))
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

declare variable codemptm integer;
declare variable codfilialtm smallint;
declare variable codtipomov integer;
declare variable codempfr integer;
declare variable codfilialfr smallint;
declare variable codfor integer;
declare variable coditcompra integer;
declare variable codemppd integer;
declare variable codfilialpd smallint;
declare variable codprod integer;
declare variable refprod varchar(20);
declare variable percdescitcompra numeric(15,5);
declare variable vlrliqitcompra numeric(15,5);
declare variable codempax integer;
declare variable codfilialax smallint;
declare variable codalmox integer;
declare variable codlote varchar(20);
declare variable cloteprod char(1);
declare variable uffor char(2);
declare variable codempnt integer;
declare variable codfilialnt smallint;
declare variable codnat char(4);
declare variable tipofisc char(2);
declare variable percred numeric(9,2);
declare variable codtrattrib char(2);
declare variable origfisc char(1);
declare variable codmens smallint;
declare variable percicmsitcompra numeric(9,2);
declare variable codempif integer;
declare variable codfilialif smallint;
declare variable codfisc char(13);
declare variable coditfisc integer;
declare variable tipost char(2);
declare variable margemvlagr numeric(15,5);
declare variable percipiitcompra numeric(9,2);
declare variable percicmsst numeric(9,2);
declare variable tpredicms char(1);
declare variable redbaseicmsst char(1);
declare variable vlrproditcompra numeric(15,5);
declare variable vlrbaseipiitcompra numeric(15,5);
declare variable vlripiitcompra numeric(15,5);
declare variable vlrbaseicmsitcompra numeric(15,5);
declare variable vlricmsitcompra numeric(15,5);
declare variable vlrbaseicmsbrutitcompra numeric(15,5);
declare variable vlrisentasitcompra numeric(15,5);
declare variable vlroutrasitcompra numeric(15,5);
declare variable vlrbaseicmsstitcompra numeric(15,5);
declare variable vlricmsstitcompra numeric(15,5);
begin

-- Inicializao de variaveis

    select icodfilial from sgretfilial(:codemp, 'LFNATOPER') into :codfilialnt;

    select cp.codemptm, cp.codfilialtm, cp.codtipomov, cp.codempfr,  cp.codfilialfr, cp.codfor, coalesce(fr.siglauf, fr.uffor) uffor
    from cpcompra cp, cpforneced fr
    where cp.codcompra=:codcompra and cp.codfilial=:codfilial and cp.codemp=:codemp and
    fr.codemp=cp.codempfr and fr.codfilial=cp.codfilialfr and fr.codfor=cp.codfor
    into :codemptm, :codfilialtm, :codtipomov, :codempfr, :codfilialfr, :codfor, :uffor ;

-- Busca sequencia de numerao do tem de compra

    select coalesce(max(coditcompra),0)+1 from cpitcompra where codcompra=:codcompra and codfilial=:codfilial and codemp=:codemp
    into :coditcompra;

-- Informaes do item do pedido de compra

    select it.codemppd, it.codfilialpd, it.codprod, it.percdescitcompra, it.vlrliqitcompra, it.vlrproditcompra, it.refprod,
    it.codempax, it.codfilialax, it.codalmox, it.codlote, pd.cloteprod
    from cpitcompra it, eqproduto pd
    where it.coditcompra=:coditcomprapc and it.codcompra=:codcomprapc and it.codfilial=:codfilialpc and it.codemp=:codemppc
    and pd.codemp=it.codemppd and pd.codfilial=it.codfilialpd and pd.codprod=it.codprod
    into :codemppd, :codfilialpd, :codprod, :percdescitcompra, :vlrliqitcompra, :vlrproditcompra, :refprod,
    :codempax, :codfilialax, :codalmox, :codlote, :cloteprod;

-- Buscando a natureza de operao para o tem de compra

    select codnat from lfbuscanatsp(:codfilial, :codemp, :codfilialpd, :codprod, null, null, null, :codempfr, :codfilialfr, :codfor,
    :codfilialtm, :codtipomov, null)
    into :codnat;
    
    if (:codnat is null) then
    begin
        exception cpitcompraex04 ' produto:' || :refprod; -- NO FOI POSSVEL ENCONTRAR A NATUREZA DA OPERAO PARA O TEM
    end

-- Busca informaes fiscais para o tem de compra

    select tipofisc,redfisc,codtrattrib,origfisc,codmens,aliqfisc,codempif,codfilialif,codfisc,coditfisc,tipost,margemvlagr,
    aliqipifisc,aliqfiscintra,tpredicmsfisc,redbasest
    from lfbuscafiscalsp(:codemppd, :codfilialpd, :codprod, :codempfr,:codfilialfr, :codfor,
    :codemptm, :codfilialtm, :codtipomov, 'CP', :codnat,null,null,null,null)
    into :tipofisc, :percred, :codtrattrib, :origfisc, :codmens, :percicmsitcompra, :codempif, :codfilialif, :codfisc, :coditfisc, :tipost,
    :margemvlagr, :percipiitcompra, :percicmsst, :tpredicms, :redbaseicmsst;
    
-- Inicializando valores

    vlrproditcompra = :precoitcompra * :qtditcompra;
    vlrliqitcompra = :vlrproditcompra - :vlrdescitcompra;
    vlrbaseipiitcompra = 0;
    vlrbaseicmsitcompra = 0;
    vlricmsitcompra = 0;
    vlripiitcompra = 0;

    if (:percicmsitcompra = 0 or :percicmsitcompra is null) then
    begin
        select coalesce(percicms, 0) from lfbuscaicmssp (:codnat, :uffor,:codemp, :codfilial) into :percicmsst;
    end

    if (:percred is null) then
    begin
        percred = 0;
    end

    if(percred>0) then
    begin
        if(:tpredicms='B') then
        begin
            vlrbaseicmsitcompra = (:vlrproditcompra - :vlrdescitcompra) - ( (:vlrproditcompra - :vlrdescitcompra) * ( :percred / 100 ) );
        end
        else if(:tpredicms='V') then
        begin
            vlricmsitcompra = (:vlrbaseicmsitcompra * ( :percicmsitcompra / 100 )) -  ( (:vlrbaseicmsitcompra * ( :percicmsitcompra / 100 ) * ( :percred / 100 ) )) ;
        end
    end
    else
    begin
        vlrbaseicmsitcompra = :vlrproditcompra - :vlrdescitcompra;
        vlricmsitcompra = :vlrbaseicmsitcompra * ( :percicmsitcompra / 100 );
    end

    vlrbaseipiitcompra = :vlrproditcompra - :vlrdescitcompra;
    vlrbaseicmsbrutitcompra = :vlrproditcompra - :vlrdescitcompra;
    vlripiitcompra = :vlrbaseipiitcompra * ( :percipiitcompra / 100 );

-- **** Calculo dos tributos ***

    -- Se produto for isento de ICMS
    if (:tipofisc = 'II') then
    begin
        vlrisentasitcompra = :vlrliqitcompra;
        vlrbaseicmsitcompra = 0;
        percicmsitcompra = 0;
        vlricmsitcompra = 0;
        vlroutrasitcompra = 0;
    end
    -- Se produto for de Substituio Tributria
    else if (:tipofisc = 'FF') then
    begin
        if (:tipost = 'SI' ) then -- Contribuinte Substitudo
        begin
            vlroutrasitcompra = :vlrliqitcompra;
            vlrbaseicmsitcompra = 0;
            percicmsitcompra = 0;
            vlricmsitcompra = 0;
            vlrisentasitcompra = 0;
        end
        else if (:tipost = 'SU' ) then -- Contribuinte Substituto
        begin

            if( (:percicmsst is null) or (:percicmsst=0) ) then
            begin
                select coalesce(percicmsintra,0) from lfbuscaicmssp (:codnat,:uffor,:codemp,:codfilial)
                into :percicmsst;
            end

            if(percred>0 and redbaseicmsst='S') then
            begin
            -- Quando h reduo na base do icms st , deve usar o valor da base do icms proprio como parametro
               vlrbaseicmsstitcompra = (  (coalesce(:margemvlagr,0) + 100) / 100 )  * (  (coalesce(:vlrbaseicmsitcompra,0) ) + (coalesce(:vlripiitcompra,0)) );
            end
            else
            begin
                -- Quando no h reduo na base do icms st deve usar o valor da base bruto (rem reduo)
                vlrbaseicmsstitcompra = (  (coalesce(:margemvlagr,0) + 100) / 100 )  * (  (coalesce(:vlrbaseicmsbrutitcompra,0) ) + (coalesce(:vlripiitcompra,0)) );
            end

            vlroutrasitcompra = 0;
            vlrisentasitcompra = 0;
            vlricmsstitcompra = ( (:vlrbaseicmsstitcompra * :percicmsst) / 100 ) - (:vlricmsitcompra) ;

        end
    end

    -- Se produto no for tributado e no isento

    else if (:tipofisc = 'NN') then
    begin
        vlroutrasitcompra = :vlrliqitcompra;
        vlrbaseicmsitcompra = 0;
        percicmsitcompra = 0;
        vlricmsitcompra = 0;
        vlrisentasitcompra = 0;
    end

    -- Se produto for tributado integralmente

    else if (:tipofisc = 'TT') then
    begin
        vlroutrasitcompra = 0;
        vlrisentasitcompra = 0;
    end

    -- Inserindo dados na tabela de tens de compra

    if ( :tpagrup <> 'F' ) then
    begin

        insert into cpitcompra (codemp, codfilial, codcompra, coditcompra, codempnt, codfilialnt, codnat, codemppd,
        codfilialpd, codprod, codemple, codfilialle, codlote, qtditcompra, precoitcompra, percdescitcompra,vlrdescitcompra,
        percicmsitcompra,vlrbaseicmsitcompra,vlricmsitcompra,percipiitcompra,vlrbaseipiitcompra,vlripiitcompra,vlrliqitcompra,
        vlrproditcompra,refprod, codempax,codfilialax,codalmox, codempif,codfilialif,codfisc,coditfisc,vlrisentasitcompra, vlroutrasitcompra)
        values (:codemp, :codfilial, :codcompra, :coditcompra, :codemp, :codfilialnt, :codnat, :codemp,:codfilialpd, :codprod,
        :codemp, :codfilialpd, :codlote, :qtditcompra, :precoitcompra,:percdescitcompra,:vlrdescitcompra,:percicmsitcompra,:vlrbaseicmsitcompra,
        :vlricmsitcompra, :percipiitcompra, :vlrbaseipiitcompra, :vlripiitcompra, :vlrliqitcompra,:vlrproditcompra,:refprod,
        :codempax, :codfilialax, :codalmox, :codempif, :codfilialif, :codfisc, :coditfisc, :vlrisentasitcompra,:vlroutrasitcompra
        );
    end

-- Atualizando informaes de vnculo

    execute procedure cpupcomprapedsp(:codemp, :codfilial,:codcompra, :coditcompra, :codemppc, :codfilialpc, :codcomprapc, :coditcomprapc);

end ^

ALTER PROCEDURE CPADICITCOMPRARECMERCSP (CODEMP INTEGER,
CODFILIAL SMALLINT,
TICKET INTEGER,
CODEMPCP INTEGER,
CODFILIALCP SMALLINT,
CODCOMPRA INTEGER,
QTDITCOMPRA NUMERIC(15, 5))
AS 

declare variable usaprecocot char(1);
declare variable codemppd integer;
declare variable codfilialpd integer;
declare variable codprod integer;
declare variable codprodant integer;
declare variable coditrecmerc integer;
declare variable codnat char(4);
declare variable codfilialtm smallint;
declare variable codtipomov integer;
declare variable codempfr integer;
declare variable codfilialfr smallint;
declare variable codfor integer;
declare variable codempax integer;
declare variable codfilialax smallint;
declare variable codalmox integer;
declare variable precoitcompra numeric(15,5);
declare variable aprovpreco char(1);
declare variable codemppp integer;
declare variable codfilialpp smallint;
declare variable codplanopag integer;
declare variable vlrproditcompra numeric(15,5);
declare variable qtditrecmerc numeric(15,5);
declare variable codempns integer;
declare variable codfilialns smallint;
declare variable numserietmp varchar(30);
declare variable percprecocoletacp numeric(15,5);
declare variable permititemrepcp char(1);
declare variable trocaqtd char(1);
begin
    
    -- Carregamdo variaveis
    aprovpreco = 'N';

    -- Verificando se  para buscar as quantidades
    if ( (qtditcompra is null) or (qtditcompra=0)) then
       trocaqtd = 'S';
    else 
       trocaqtd = 'N';
    
    
    -- Buscando preferncias
    select coalesce(p1.usaprecocot,'N') usaprecocot
    from sgprefere1 p1
    where p1.codemp=:codemp and p1.codfilial=:codfilial
    into :usaprecocot;
    
    -- Buscando preferncias GMS
    select coalesce(p8.percprecocoletacp,100) percprecocoletacp
    , coalesce(permititemrepcp, 'N') 
    from sgprefere8 p8
    where p8.codemp=:codemp and p8.codfilial=:codfilial
    into :percprecocoletacp, :permititemrepcp;

    -- Buscando informaes da compra
    select cp.codfilialtm, cp.codtipomov,
    cp.codempfr, cp.codfilialfr, cp.codfor,
    cp.codemppg, cp.codfilialpg, cp.codplanopag
    from cpcompra cp
    where cp.codemp=:codempcp and cp.codfilial=:codfilialcp and cp.codcompra=:codcompra
    into :codfilialtm,  :codtipomov, :codempfr, :codfilialfr, :codfor, :codemppp, :codfilialpp, :codplanopag;

    for select ir.codemppd, ir.codfilialpd, ir.codprod, ir.coditrecmerc, ir.qtditrecmerc,
        ir.codempns, ir.codfilialns, ir.numserie
        from eqitrecmerc ir
        where
        ir.codemp=:codemp and ir.codfilial=:codfilial and ir.ticket=:ticket
        into :codemppd, :codfilialpd, :codprod, :coditrecmerc, :qtditrecmerc,
        :codempns, :codfilialns, :numserietmp
        do
        begin
            if (:trocaqtd='S') then
                 qtditcompra = 0;  
            if(:permititemrepcp='S' or :codprod <> :codprodant or :codprodant is null) then
            begin

                -- Buscando a natureza da operao
                select codnat from lfbuscanatsp(:codfilial,:codemp,:codfilialpd,:codprod,:codemp,null,null,
                :codempfr,:codfilialfr,:codfor,:codfilialtm,:codtipomov,null)
                into :codnat;

                -- Buscando informaes do produto
                select pd.codempax, pd.codfilialax, pd.codalmox from eqproduto pd
                where pd.codemp=:codemppd and pd.codfilial=:codfilialpd and pd.codprod=:codprod
                into :codempax, :codfilialax, :codalmox;

                -- Buscando preo da ultima compra
--                select custounit from eqcustoprodsp(:codemppd, :codfilialpd, :codprod,
--                cast('today' as date),'U',:codempax, :codfilialax, :codalmox,'N')
--                into :precoultcp;

                -- Se deve buscar preo de cotao.
                if( 'S' = :usaprecocot) then
                begin
                    -- Deve implementar ipi, vlrliq etc... futuramente...
                    select first 1 ct.precocot
                    from cpcotacao ct, cpsolicitacao sl, cpitsolicitacao iso
                    left outer join eqrecmerc rm on
                    rm.codemp=:codemp and rm.codfilial=:codfilial and rm.ticket=:ticket
                    where
                    iso.codemp = sl.codemp and iso.codfilial=sl.codfilial and iso.codsol=sl.codsol
                    and ct.codemp=iso.codemp and ct.codfilial=iso.codfilial and ct.codsol=iso.codsol and ct.coditsol=iso.coditsol
                    and iso.codemppd=:codemppd and iso.codfilialpd=:codfilialpd and iso.codprod=:codprod
                    and ct.codempfr=:codempfr and ct.codfilialfr=:codfilialfr and ct.codfor=:codfor
                    and (ct.dtvalidcot>=cast('today' as date) and (ct.dtcot<=cast('today' as date)))
                    and ct.sititsol not in ('EF','CA')

                    and ( (ct.rendacot = rm.rendaamostragem) or ( coalesce(ct.usarendacot,'N') = 'N') )

                    and ( (ct.codemppp=:codemppp and ct.codfilialpp=:codfilialpp and ct.codplanopag=:codplanopag)
                       or (ct.codplanopag is null))

                    order by ct.dtcot desc
                    into :precoitcompra;

                    if(:precoitcompra is not null) then
                    begin
                        -- Indica que o preo  aprovado (cotado anteriormente);
                        aprovpreco = 'S';
                    end
                end

                -- Se no conseguiu obter o preo das cotaes
                if(precoitcompra is null) then
                begin
                    -- Buscando preo de compra da tabela de custos de produtos
                    select custounit from eqcustoprodsp(:codemppd, :codfilialpd, :codprod,
                    cast('today' as date),'M',:codempax, :codfilialax, :codalmox,'N')
                    into :precoitcompra;

                end

                -- verifica se quantidade est zerada (coleta) se estiver preechida (trata-se de uma pesagem)
                if ( (qtditcompra is null) or (qtditcompra = 0) ) then 
                begin
                    qtditcompra = qtditrecmerc;
                end

                if ( ( :percprecocoletacp is not null) and (:percprecocoletacp<>100) ) then
                begin
                   precoitcompra = cast( :precoitcompra / 100 * :percprecocoletacp as decimal(15,5) ); 
                end
                 
                vlrproditcompra = :precoitcompra * qtditcompra;

                -- Inserir itens
                
                insert into cpitcompra (
                codemp, codfilial, codcompra, coditcompra,
                codemppd, codfilialpd, codprod,
                codempnt, codfilialnt, codnat,
                codempax, codfilialax, codalmox,
                qtditcompra, precoitcompra, aprovpreco, vlrproditcompra,
                codempns, codfilialns, numserietmp)
                values (:codempcp, :codfilialcp, :codcompra, :coditrecmerc,
                :codemppd, :codfilialpd, :codprod,
                :codemp,:codfilial,:codnat,
                :codempax,:codfilialax,:codalmox,
                :qtditcompra, :precoitcompra, :aprovpreco, :vlrproditcompra,
                :codempns, :codfilialns,  :numserietmp) ;

                -- Inserindo vnculo entre compra e recebimento

                insert into eqitrecmercitcp(codemp, codfilial, ticket, coditrecmerc, codempcp, codfilialcp, codcompra, coditcompra)
                values(:codemp,:codfilial,:ticket,:coditrecmerc,:codempcp,:codfilialcp,:codcompra,:coditrecmerc);

                codprodant = codprod;

            end
        end



  --  suspend;
end ^

ALTER PROCEDURE CPBLOQCOMPRASP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODCOMPRA INTEGER,
CBLOQCOMPRA CHAR(1))
AS 
 
 

begin
  /* Stored procedure de bloqueio e desbloqueio de venda*/
  UPDATE CPCOMPRA SET EMMANUT='S', BLOQCOMPRA=:CBLOQCOMPRA WHERE CODEMP=:ICODEMP AND
     CODFILIAL=:SCODFILIAL AND CODCOMPRA=:ICODCOMPRA;
  UPDATE CPCOMPRA SET EMMANUT='N' WHERE CODEMP=:ICODEMP AND
     CODFILIAL=:SCODFILIAL AND CODCOMPRA=:ICODCOMPRA;
  suspend;
end ^

ALTER PROCEDURE CPCOMPRASP01 (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
NQTD NUMERIC(15, 5),
NVLRTOT NUMERIC(15, 5),
NVLRICMS NUMERIC(15, 5),
ADICFRETE CHAR(1),
VLRFRETE NUMERIC(15, 5),
ADICADIC CHAR(1),
VLRADIC NUMERIC(15, 5))
RETURNS (NVLRCUSTO NUMERIC(15, 5))
AS 

declare variable icasasdec integer;
declare variable ccustosicms char(1);
begin
  /* Procedure Text */
  if (NQTD!=0) then
  begin
    SELECT CUSTOSICMS,CASASDECFIN FROM SGPREFERE1 WHERE CODEMP=:iCodEmp
       AND CODFILIAL=:sCodFilial INTO :cCustoSICMS, :iCasasDec;
    if (iCasasDec is null) then
       iCasasDec = 2;
    if (cCustoSICMS IS NULL) then
       cCustoSICMS = 'N';
    if (cCustoSICMS='S') then
    begin
       select deRetorno
         from arredDouble( (:NVLRTOT - :NVLRICMS) / :NQTD , :ICASASDEC  )
         into :NVLRCUSTO;
    end
    else
    begin
       select deRetorno
         from arredDouble( :NVLRTOT / :NQTD , :ICASASDEC )
         into :NVLRCUSTO;
    end
    -- Adicionando o frete ao valor de custo do item
    if (:adicfrete = 'S' ) then
    begin
        select deRetorno from arredDouble( :nvlrcusto + :vlrfrete, :icasasdec)
          into :nvlrcusto;
    end
    -- Adiconando valores adicionais ao custo do item
    if (:adicadic = 'S') then
    begin
         select deRetorno from arredDouble( :nvlrcusto + :vlradic, :icasasdec)
         into :nvlrcusto;
    end
  end
  else
  begin
    NVLRCUSTO = 0;
  end
  suspend;
end ^

ALTER PROCEDURE CPGERADEVOLUCAOSP (CODEMP INTEGER,
CODFILIAL SMALLINT,
CODCOMPRA INTEGER,
CODITCOMPRA SMALLINT,
CODEMPVD INTEGER,
CODFILIALVD SMALLINT,
CODVENDA INTEGER,
CODITVENDA INTEGER,
TIPOVENDA CHAR(2),
QTDDEV NUMERIC(15, 5))
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

begin

    -- Limpando vnculo anterior

    delete from cpdevolucao
    where codemp=:codemp and codfilial=:codfilial and codcompra=:codcompra
    and coditcompra=:coditcompra and codempvd=:codempvd and codfilialvd=:codfilialvd
    and codvenda=:codvenda and coditvenda=:coditvenda and tipovenda=:tipovenda;

    -- Inserindo novo vnculo de devoluo
    if(:CODCOMPRA is not null and :CODITCOMPRA is not null) then
    begin
        insert into cpdevolucao
        (codemp, codfilial, codcompra, coditcompra, qtddev,
         codempvd, codfilialvd, codvenda, tipovenda, coditvenda )
        values
        (:codemp, :codfilial, :codcompra, :coditcompra, :qtddev,
         :codempvd, :codfilialvd, :codvenda, :tipovenda, :coditvenda);
    end
  suspend;
end ^

ALTER PROCEDURE CPGERAENTRADASP (CODEMP INTEGER,
CODFILIAL INTEGER,
CODFILIALVD INTEGER,
TIPOVENDA CHAR(1),
CODVENDA INTEGER,
CITEM CHAR(1))
RETURNS (CODCOMPRA INTEGER)
AS 
DECLARE VARIABLE STATUSVENDA CHAR(2);
DECLARE VARIABLE CODCLI INTEGER;
DECLARE VARIABLE CODFILIALCL INTEGER;
DECLARE VARIABLE CODFILIALCP INTEGER;
DECLARE VARIABLE CODTIPOMOV INTEGER;
DECLARE VARIABLE CODFILIALTM INTEGER;
DECLARE VARIABLE SERIE INTEGER;
DECLARE VARIABLE CODFILIALSE INTEGER;
DECLARE VARIABLE DOC INTEGER;
DECLARE VARIABLE CODFOR INTEGER;
DECLARE VARIABLE CODFILIALFR INTEGER;
DECLARE VARIABLE CODITVENDA INTEGER;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(:CODEMP,'CPFORNECED') INTO CODFILIALFR;
  SELECT ICODFILIAL FROM SGRETFILIAL(:CODEMP,'CPCOMPRA') INTO CODFILIALCP;
  SELECT ICODFILIAL FROM SGRETFILIAL(:CODEMP,'VDCLINTE') INTO CODFILIALCL;

  SELECT ISEQ FROM SPGERANUM(:CODEMP,:CODFILIAL,'CP') INTO CODCOMPRA;

  SELECT CODCLI,CODFILIALCL,STATUSVENDA FROM VDVENDA WHERE CODVENDA=:CODVENDA AND TIPOVENDA=:TIPOVENDA
    AND CODEMP=:CODEMP AND CODFILIAL=:CODFILIAL INTO CODCLI,CODFILIALCL,STATUSVENDA;
  IF (SUBSTRING (STATUSVENDA FROM 1 FOR 1) IN ('C','N') ) THEN
    EXCEPTION VDVENDAEX05;
  
  SELECT CODFOR FROM CPADICFORSP(:CODEMP,:CODFILIAL,:CODFILIALCL,:CODCLI) INTO CODFOR;

  SELECT P.CODTIPOMOV5,P.CODFILIALT5,
    T.SERIE,T.CODFILIALSE FROM SGPREFERE1 P, EQTIPOMOV T WHERE P.CODEMP=:CODEMP
    AND P.CODFILIAL=:CODFILIAL AND T.CODTIPOMOV=P.CODTIPOMOV5 AND
    T.CODEMP=P.CODEMPT5 AND T.CODFILIAL=P.CODFILIALT5
    INTO CODTIPOMOV,CODFILIALTM,SERIE,CODFILIALSE;

  SELECT * FROM LFNOVODOCSP(:SERIE,:CODEMP,:CODFILIALSE) INTO DOC;

  INSERT INTO CPCOMPRA (CODEMP,CODFILIAL,CODCOMPRA,CODEMPPG,CODFILIALPG,CODPLANOPAG,
                        CODEMPFR,CODFILIALFR,CODFOR,CODEMPSE,CODFILIALSE,SERIE,
                        CODEMPTM,CODFILIALTM,CODTIPOMOV,DOCCOMPRA,DTENTCOMPRA,DTEMITCOMPRA)
                 SELECT :CODEMP,:CODFILIAL,:CODCOMPRA,CODEMPPG,CODFILIALPG,CODPLANOPAG,
                        :CODEMP,:CODFILIALFR,:CODFOR,:CODEMP,:CODFILIALSE,:SERIE,
                        CODEMP,:CODFILIALTM,:CODTIPOMOV,:DOC,DTSAIDAVENDA,DTEMITVENDA FROM
                        VDVENDA WHERE CODEMP=:CODEMP AND CODFILIAL=:CODFILIALVD AND
                        CODVENDA=:CODVENDA AND TIPOVENDA=:TIPOVENDA;
  IF (CITEM = 'S') THEN
    EXECUTE PROCEDURE CPGERAITENTRADASP(:CODEMP,:CODFILIALCP,:CODCOMPRA,:CODFILIALVD,:TIPOVENDA,:CODVENDA,NULL,NULL);
    
  UPDATE VDVENDA SET STATUSVENDA='DV' WHERE TIPOVENDA=:TIPOVENDA AND CODVENDA=:CODVENDA
    AND CODEMP=:CODEMP AND CODFILIAL=:CODFILIALVD;
  
  SUSPEND;
END ^

ALTER PROCEDURE CPGERAITENTRADASP (CODEMP INTEGER,
CODFILIAL INTEGER,
CODCOMPRA INTEGER,
CODFILIALVD INTEGER,
TIPOVENDA CHAR(1),
CODVENDA INTEGER,
CODITVENDA INTEGER,
QTDIT INTEGER)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

declare variable coditcompra integer;
declare variable codfilialtm integer;
declare variable codtipomov integer;
declare variable codfilialfr integer;
declare variable codfor integer;
declare variable codnat char(4);
declare variable codfilialnt integer;
declare variable percicmsitcompra numeric(9,2);
declare variable codfilialpd integer;
declare variable codprod integer;
declare variable codfilialle integer;
declare variable codlote varchar(20);
declare variable qtditvenda numeric(18,3);
declare variable qtddevitvenda numeric(18,3);
declare variable precoitvenda numeric(18,3);
declare variable percdescitvenda numeric(15,5);
declare variable vlrdescitvenda numeric(18,3);
declare variable percicmsitvenda numeric(9,2);
declare variable vlrbaseicmsitvenda numeric(18,3);
declare variable vlricmsitvenda numeric(18,3);
declare variable percipiitvenda numeric(9,2);
declare variable vlrbaseipiitvenda numeric(18,3);
declare variable vlripiitvenda numeric(18,3);
declare variable vlrliqitvenda numeric(18,3);
declare variable vlradicitvenda numeric(18,3);
declare variable vlrfreteitvenda numeric(18,3);
declare variable vlrisentasitvenda numeric(18,3);
declare variable vlroutrasitvenda numeric(18,3);
declare variable vlrproditvenda numeric(18,3);
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(:CODEMP,'LFNATOPER') INTO CODFILIALNT;
  SELECT CODFOR,CODFILIALFR,CODTIPOMOV,CODFILIALTM FROM CPCOMPRA WHERE CODCOMPRA=:CODCOMPRA
    AND CODEMP=:CODEMP AND CODFILIAL=:CODFILIAL INTO
    :CODFOR,:CODFILIALFR,:CODTIPOMOV,:CODFILIALTM;
  FOR SELECT CODITVENDA,CODFILIALPD,CODPROD,CODFILIALLE,CODLOTE,
             QTDITVENDA,PRECOITVENDA,PERCDESCITVENDA,VLRDESCITVENDA,PERCICMSITVENDA,
             VLRBASEICMSITVENDA,VLRICMSITVENDA,PERCIPIITVENDA,VLRBASEIPIITVENDA,
             VLRIPIITVENDA,VLRLIQITVENDA,VLRADICITVENDA,VLRFRETEITVENDA,VLRISENTASITVENDA,
             VLROUTRASITVENDA,VLRPRODITVENDA,VLRPRODITVENDA FROM VDITVENDA WHERE
             CODEMP=:CODEMP AND CODFILIAL=:CODFILIALVD AND CODVENDA=:CODVENDA AND TIPOVENDA=:TIPOVENDA AND
             (:CODITVENDA IS NULL OR CODITVENDA=:CODITVENDA)
             ORDER BY CODITVENDA INTO CODITCOMPRA,CODFILIALPD,CODPROD,CODFILIALLE,CODLOTE,
             QTDITVENDA,PRECOITVENDA,PERCDESCITVENDA,VLRDESCITVENDA,PERCICMSITVENDA,
             VLRBASEICMSITVENDA,VLRICMSITVENDA,PERCIPIITVENDA,VLRBASEIPIITVENDA,
             VLRIPIITVENDA,VLRLIQITVENDA,VLRADICITVENDA,VLRFRETEITVENDA,VLRISENTASITVENDA,
             VLROUTRASITVENDA,VLRPRODITVENDA,VLRPRODITVENDA DO
  BEGIN
      IF (QTDIT IS NULL) THEN
        QTDIT = QTDITVENDA;
      SELECT SUM(QTDDEV) FROM CPCOMPRAVENDA WHERE TIPOVENDA=:TIPOVENDA
        AND CODVENDA=:CODVENDA AND CODITVENDA=:CODITVENDA
        AND CODEMP=:CODEMP AND CODFILIAL=:CODFILIAL INTO QTDDEVITVENDA;
      IF (QTDIT > QTDITVENDA OR QTDIT+QTDDEVITVENDA > QTDITVENDA) THEN
        EXCEPTION VDVENDAEX01 'O ITEM: '||CAST(CODITVENDA AS CHAR(3))||' DO PEDIDO: '||
          CAST(CODVENDA AS CHAR(6))||' JA FOI DEVOLVIDO!';
        
      SELECT CODNAT FROM LFBUSCANATSP (:CODFILIAL,:CODEMP,:CODFILIALPD,:CODPROD,NULL,NULL,NULL,
                                   :CODEMP,:CODFILIALFR,:CODFOR,:CODFILIALTM,:CODTIPOMOV,null) INTO CODNAT;

      INSERT INTO CPITCOMPRA (CODEMP,CODFILIAL,CODCOMPRA,CODITCOMPRA,CODEMPPD,CODFILIALPD,CODPROD,
                              CODEMPLE,CODFILIALLE,CODLOTE,CODEMPNT,CODFILIALNT,CODNAT,QTDITCOMPRA,
                              PRECOITCOMPRA,PERCDESCITCOMPRA,VLRDESCITCOMPRA,PERCICMSITCOMPRA,
                              VLRBASEICMSITCOMPRA,VLRICMSITCOMPRA,PERCIPIITCOMPRA,VLRBASEIPIITCOMPRA,
                              VLRIPIITCOMPRA,VLRLIQITCOMPRA,VLRADICITCOMPRA,VLRFRETEITCOMPRA,
                              VLRISENTASITCOMPRA,VLROUTRASITCOMPRA,VLRPRODITCOMPRA,CUSTOITCOMPRA)
                       VALUES (:CODEMP,:CODFILIAL,:CODCOMPRA,:CODITCOMPRA,:CODEMP,:CODFILIALPD,:CODPROD,
                              :CODEMP,:CODFILIALLE,:CODLOTE,:CODEMP,:CODFILIALNT,:CODNAT,:QTDIT,
                              :PRECOITVENDA,:PERCDESCITVENDA,:VLRDESCITVENDA,:PERCICMSITVENDA,
                              :VLRBASEICMSITVENDA,:VLRICMSITVENDA,:PERCIPIITVENDA,:VLRBASEIPIITVENDA,
                              :VLRIPIITVENDA,:VLRLIQITVENDA,:VLRADICITVENDA,:VLRFRETEITVENDA,
                              :VLRISENTASITVENDA,:VLROUTRASITVENDA,:VLRPRODITVENDA,:VLRPRODITVENDA);

      INSERT INTO CPCOMPRAVENDA(CODEMP,CODFILIAL,CODCOMPRA,CODITCOMPRA,CODEMPVD,
                                CODFILIALVD,TIPOVENDA,CODVENDA,CODITVENDA,QTDDEV)
                       VALUES (:CODEMP,:CODFILIAL,:CODCOMPRA,:CODITCOMPRA,:CODEMP,
                               :CODFILIALVD,:TIPOVENDA,:CODVENDA,:CODITCOMPRA,:QTDIT);
  END
  SUSPEND;
END ^

ALTER PROCEDURE CPITCOMPRASERIESP (TRANSACAO CHAR(1),
CODEMP INTEGER,
CODFILIAL SMALLINT,
CODCOMPRA INTEGER,
CODITCOMPRA SMALLINT,
CODEMPPD INTEGER,
CODFILIALPD SMALLINT,
CODPROD INTEGER,
NUMSERIETMP VARCHAR(30),
QTDITCOMPRA INTEGER)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

declare variable seqitserie integer;
declare variable serieprod char(1);
begin
        
    -- Buscando informaes do produto
    select pd.serieprod from eqproduto pd
    where pd.codemp = :codemppd and pd.codfilial = :codfilialpd and pd.codprod = :codprod
    into :serieprod;
    
    -- Se o produto usa srie...
    if(serieprod = 'S') then
    begin
    
        -- Buscando ultimo item de srie inserido...
        select coalesce(max(seqitserie),0) from cpitcompraserie
        where codemp=:codemp and codfilial=:codfilial and codcompra=:codcompra and coditcompra=:coditcompra
        into :seqitserie;
    
        -- Se for uma transao de Insero...
        if( 'I' = :transacao) then
        begin
            -- Inserindo itens, enquanto a sequencia for menor ou igual  quantidade de itens
            while (seqitserie < qtditcompra) do
            begin
                seqitserie = seqitserie + 1;

                -- Se a quantidade no for unitria
                if(qtditcompra > 1) then
                begin
                    insert into cpitcompraserie
                    (codemp, codfilial, codcompra,  coditcompra, seqitserie )
                    values
                    (:codemp, :codfilial, :codcompra, :coditcompra, :seqitserie);
                end
                -- Se for apenas um item, deve inserir o numero se srie digitado na tela...
                else if(qtditcompra = 1 and :numserietmp is not null) then
                begin
                    insert into cpitcompraserie
                    (codemp, codfilial, codcompra,  coditcompra, seqitserie, codemppd, codfilialpd, codprod, numserie )
                    values
                    (:codemp, :codfilial, :codcompra, :coditcompra, :seqitserie, :codemppd, :codfilialpd, :codprod, :numserietmp );
                end
            end
        end
        -- Se for uma transao de Deleo, deve excluir todas os tens gerados.
        else if('D' = :transacao) then
        begin
            delete from cpitcompraserie itcs
            where
            itcs.codemp = :codemp and itcs.codfilial = :codfilial and itcs.codcompra = :codcompra and itcs.coditcompra = :coditcompra;
        end
        -- Se for uma transao de Update, deve excluir os excessos ou incluir os faltantes...
        else if('U' = :transacao) then
        begin

            if(seqitserie > qtditcompra) then
            begin

                delete from cpitcompraserie itcs
                where
                itcs.codemp = :codemp and itcs.codfilial = :codfilial and itcs.codcompra = :codcompra and itcs.coditcompra = :coditcompra
                and itcs.seqitserie > :qtditcompra;
            
            end
            else
            begin
            
                execute procedure cpitcompraseriesp( 'I', :codemp, :codfilial, :codcompra, :coditcompra, :codemppd, :codfilialpd, :codprod, :numserietmp, :qtditcompra);

            end

        end

    end


end ^

ALTER PROCEDURE CPREORGCOMPRASP (CODEMP INTEGER,
CODFILIAL SMALLINT,
CODCOMPRA INTEGER)
AS 
 

declare variable coditcomprainc smallint;
declare variable coditcompra smallint;
begin
  coditcomprainc = 1;
  for select coditcompra from cpitcompra it
    where it.codemp=:codemp and it.codfilial=:codfilial and
       it.codcompra=:codcompra
       order by it.coditcompra
       into :coditcompra do
  begin
    if (coditcompra>coditcomprainc) then
    begin
        update cpitcompra set emmanut='S', coditcompra=:coditcomprainc
            where codemp=:codemp and codfilial=:codfilial and
                codcompra=:codcompra and coditcompra=:coditcompra;
    end
    coditcomprainc = coditcomprainc + 1;
  end
  update cpitcompra set emmanut='N'
      where codemp=:codemp and codfilial=:codfilial and
         codcompra=:codcompra and emmanut='S';
end ^

ALTER PROCEDURE CPUPCOMPRAPEDSP (CODEMPCP INTEGER,
CODFILIALCP SMALLINT,
CODCOMPRACP INTEGER,
CODITCOMPRACP INTEGER,
CODEMPPC INTEGER,
CODFILIALPC SMALLINT,
CODCOMPRAPC INTEGER,
CODITCOMPRAPC INTEGER)
AS 
 
 
declare variable nroitensemitidos integer;
declare variable nroitens integer;
begin

    -- Atualizando os status de emisso do item do pedido de compra
    update cpitcompra set emititcompra='S' where coditcompra=:coditcomprapc
    and codcompra=:codcomprapc and codemp=:codemppc and codfilial=:codfilialcp;

    -- Contando o numero de tens do pedido de compra que j esto emitidos
    select count(*) from cpitcompra where codcompra=:codcomprapc and codemp=:codemppc and codfilial=:codfilialpc and emititcompra='S'
    into :nroitensemitidos;

    -- Contando o numero total de itens do pedido de compra
    select count(*) from cpitcompra where codcompra=:codcomprapc and codemp=:codemppc and codfilial=:codfilialpc
    into :nroitens;

    -- Se todos os tens j foram emitidos
    if (:nroitensemitidos = nroitens) then
    begin
        update cpcompra set statuscompra='ET' where codemp=:codemppc and codfilial=:codfilialpc and codcompra=:codcomprapc;
    end
    -- Se apenas alguns itens foram emitidos
    else if (:nroitensemitidos > 0) then
    begin
        update cpcompra set statuscompra='EP' where codemp=:codemppc and codfilial=:codfilialpc and codcompra=:codcomprapc;
    end

    insert into cpcompraped (codemp, codfilial, codcompra, coditcompra,
    codemppc, codfilialpc, codcomprapc, coditcomprapc)
    values (
    :codempcp, :codfilialcp, :codcompracp, :coditcompracp,
    :codemppc, :codfilialpc, :codcomprapc, :coditcomprapc);

end ^

ALTER PROCEDURE CRCARREGAPONTOSP (CODEMP INTEGER,
CODFILIAL SMALLINT,
IDUSU VARCHAR(128),
AFTELA CHAR(1),
TOLREGPONTO SMALLINT)
RETURNS (CARREGAPONTO CHAR(1),
DATAPONTO DATE,
HORAPONTO TIME,
CODEMPAE INTEGER,
CODFILIALAE SMALLINT,
CODATEND INTEGER,
CODEMPEP INTEGER,
CODFILIALEP SMALLINT,
MATEMPR INTEGER)
AS 
 

declare variable contabat smallint;
declare variable hiniturno time;
declare variable hiniintturno time;
declare variable hfimintturno time;
declare variable hfimturno time;
declare variable tolregpontoseg smallint;
declare variable umahoraseg smallint;
declare variable duashorasseg smallint;
begin
  if ( tolregponto is null) then
  begin
     tolregponto = 20;
  end
  tolregpontoseg = tolregponto * 60;
  umahoraseg = 60 * 60;
  duashorasseg = umahoraseg * 2;


  dataponto = cast('today' as date);
  horaponto = cast('now' as time);
  carregaponto = 'N';
  select 'S' carregaponto, ae.codemp, ae.codfilial, ae.codatend,
    ae.codempep, ae.codfilialep, ae.matempr,
    t.hiniturno, t.hiniintturno, t.hfimintturno, t.hfimturno
    from atatendente ae, rhempregado ep, rhturno t
    where ae.codempus=:codemp and ae.codfilialus=:codfilial and ae.idusu=:idusu and
    ep.codemp=ae.codempep and ep.codfilial=ae.codfilialep and ep.matempr=ae.matempr and
    t.codemp=ep.codempto and t.codfilial=ep.codfilialto and t.codturno=ep.codturno
    into :carregaponto, :codempae, :codfilialae, :codatend,
    :codempep, :codfilialep, :matempr,
    :hiniturno, :hiniintturno, :hfimintturno, :hfimturno;
  if (carregaponto='S') then
  begin
     -- Verificao do ponto
     select count(*)
       from pebatida b
       where b.codempep=:codempep and b.codfilialep=:codfilialep and
       b.matempr=:matempr and b.dtbat=:dataponto
       into :contabat;
     if ( (contabat is not null) and (contabat>0) ) then
     begin
         -- Tratamento no caso de tela de abertura
         if (aftela='A') then
         begin
            -- Se o nmero de batidas for mpar, no deve carregar a tela de registro.
            if ( mod(contabat, 2)>0 ) then
            begin
               carregaponto = 'N';
            end
            else
            begin
              -- Verifica a tolerncia de 20 minutos para batida do ponto e
              -- horrio para incio de turno adicional (1 hora aps fim do turno).
              if  ( ( not (:horaponto between (:hiniturno-:tolregpontoseg) and (:hiniturno+:tolregpontoseg) ) ) and
                    ( not (:horaponto between (:hfimintturno-:tolregpontoseg) and (:hfimintturno+:tolregpontoseg) ) ) and
                    ( not (:horaponto > (:hfimturno+:umahoraseg) ) )   )  then
              begin
                carregaponto = 'N';
              end
            end
         end
         -- Tratamento no caso de tela de fechamento
         else if (aftela='F') then
         begin
           -- Se for tela de fechamento e j tiver uma ou mais batidas e o nmero de
           -- batidas for par, no precisa carregar a tela de registro
           if ( (mod(contabat,2)=0)) then
           begin
             --execute procedure sgdebugsp 'crcarregapontosp', 'Entrou no mod-conta-bat=0';
             carregaponto = 'N';
           end
           else
           begin
             --execute procedure sgdebugsp 'crcarregapontosp', 'Entrou no if - horaponto='||:horaponto||' - hiniintturo:'||:hiniintturno||' - hfimturno:'||:hfimturno||' - cp:'||:carregaponto;
             
             -- Se no estiver entre o horrio de fechamento do primeiro turno (tolerncia de 20 minutos)
             -- e no estiver no intervalo de fechamento de turno (tolerncia de 20 mintuos).
             -- horrio para fim de turno adicional (2 horas aps fim do turno).
            -- execute procedure sgdebugsp 'crcarregapontosp', 'hiniintturno-totregponto'||(:hiniintturno-:tolregponto);

             if  ( ( not (:horaponto between (:hiniintturno-:tolregpontoseg) and (:hiniintturno+:tolregpontoseg) ) ) and
                   ( not (:horaponto between (:hfimturno-:tolregpontoseg) and (:hfimturno+:tolregpontoseg) ) ) and
                   ( not (:horaponto > (:hfimturno+:duashorasseg ) ) ) ) then
             begin
               carregaponto = 'N';
             end
           end
         end
     end
  end

  suspend;
end ^

ALTER PROCEDURE CRINSEREBATIDASP (CODEMP INTEGER,
CODFILIAL SMALLINT,
DTBAT DATE,
HBAT TIME,
CODEMPEP INTEGER,
CODFILIALEP SMALLINT,
MATEMPR INTEGER)
AS 
 

begin
  insert into pebatida (codemp, codfilial, dtbat, hbat, codempep, codfilialep, matempr)
     valUes (:codemp, :codfilial, :dtbat, :hbat, :codempep, :codfilialep, :matempr) ;
  suspend;
end ^

ALTER PROCEDURE CRTOTAL01ISP (CODEMP INTEGER,
CODFILIAL INTEGER)
RETURNS (SEQTOT INTEGER)
AS 
 

declare variable codfilialtt smallint;
begin
  select icodfilial from sgretfilial(:codemp, 'CRTOTAL')
    into :codfilialtt;
  select iseq from spgeranum(:codemp, :codfilialtt, 'TT')
    into :seqtot;
  insert into crtotal (codemp, codfilial, seqtot)
    values(:codemp, :codfilialtt, :seqtot);
  suspend;
end ^

ALTER PROCEDURE CRTOTAL02TAREFASP (CODEMPTA INTEGER,
CODFILIALTA INTEGER,
CODTAREFA INTEGER,
HINIOLD TIME,
HFINOLD TIME,
HININEW TIME,
HFINNEW TIME)
RETURNS (HORAOLD DECIMAL(15, 2),
HORANEW DECIMAL(15, 2),
TEMPOFINOLD TIME,
TEMPOINIOLD TIME,
TEMPOFINNEW TIME,
TEMPOININEW TIME,
INTERVALOOLD INTEGER,
INTERVALONEW INTEGER,
TOTALMINOLD INTEGER,
TOTALMINNEW INTEGER)
AS 
 

begin
  intervaloold = hfinold - hiniold;
  intervalonew = hfinnew - hininew;
  totalminold = intervaloold / 60;
  totalminnew = intervalonew / 60;
  horaold = cast( totalminold as decimal(15,2)) / 60;
  horanew = cast( totalminnew as decimal(15,2)) / 60;
  tempoiniold = hiniold;
  tempofinold = hfinold;
  tempoininew = hininew;
  tempofinnew = hfinnew;
  suspend;
end ^

ALTER PROCEDURE EQACERTACUSTORMASP AS 
 
 
DECLARE VARIABLE ICODRMA INTEGER;
DECLARE VARIABLE ICODFILIAL INTEGER;
DECLARE VARIABLE CUSTODATA NUMERIC(15,2);
DECLARE VARIABLE ICODITRMA INTEGER;
DECLARE VARIABLE ICODEMP INTEGER;
begin
   for select vw.codemp,vw.codfilial,vw.codrma, vw.coditrma, vw.custodata
   from vwtmpcustoitrma vw INTO ICODEMP,ICODFILIAL,ICODRMA,ICODITRMA,CUSTODATA
   do
   begin
      update eqitrma itr set itr.precoitrma=:CUSTODATA
      where itr.codemp=:ICODEMP AND itr.codfilial = :ICODFILIAL
      and itr.codrma = :ICODRMA and itr.coditrma=:ICODITRMA;
   END
  suspend;
end ^

ALTER PROCEDURE EQADICPRODUTOSP (CODEMPPD INTEGER,
CODFILIALPD INTEGER,
CODPROD INTEGER,
DESCPROD VARCHAR(100),
DESCAUXPROD VARCHAR(40),
REFPROD VARCHAR(20),
CODFABPROD CHAR(15),
CODBARPROD CHAR(13),
CODEMPMG INTEGER,
CODFILIALMG SMALLINT,
CODMODG INTEGER,
DESCCOMPPROD VARCHAR(500),
PRECOBASE DECIMAL(15, 5),
ATUALIZAPROD CHAR(1))
AS 

declare variable codnovo integer;
declare variable codalmox integer;
declare variable codempax integer;
declare variable codfilialax integer;
declare variable codmoeda char(4);
declare variable codempma integer;
declare variable codfilialma integer;
declare variable codunid varchar(20);
declare variable codempud integer;
declare variable codfilialud integer;
declare variable codfisc char(13);
declare variable codempfc integer;
declare variable codfilialfc integer;
declare variable codmarca char(6);
declare variable codempmc integer;
declare variable codfilialmc integer;
declare variable codgrup char(10);
declare variable codempgp integer;
declare variable codfilialgp integer;
declare variable tipoprod varchar(2);
declare variable cvprod char(1);
declare variable cloteprod char(1);
declare variable comisprod numeric(15,5);
declare variable pesoliqprod numeric(15,5);
declare variable pesobrutprod numeric(15,5);
declare variable qtdminprod numeric(15,5);
declare variable qtdmaxprod numeric(15,5);
declare variable refprodsel varchar(20);
BEGIN
  BEGIN
    BEGIN
      codnovo = CAST(REFPROD AS INTEGER);
/*Se no conseguir converter para int causa uma excesso e entra neste bloco: */
      WHEN ANY DO
      BEGIN
        SELECT MAX(CODPROD) FROM EQPRODUTO
           WHERE CODEMP=:CODEMPPD AND CODFILIAL=:CODFILIALPD INTO :codnovo;
        if (codnovo is null) then
           codnovo = 0;
        codnovo = codnovo + 1;
      END
    END
    SELECT CODALMOX,CODEMPAX,CODFILIALAX,CODMOEDA,CODEMPMA,CODFILIALMA,CODUNID
           ,CODEMPUD,CODFILIALUD,CODFISC,CODEMPFC,CODFILIALFC,CODMARCA
           ,CODEMPMC,CODFILIALMC,CODGRUP,CODEMPGP,CODFILIALGP,TIPOPROD
           ,CVPROD,CLOTEPROD,COMISPROD,PESOLIQPROD,PESOBRUTPROD,QTDMINPROD
           ,QTDMAXPROD
           FROM EQPRODUTO WHERE CODPROD=:Codprod
           AND CODEMP=:CODEMPPD AND CODFILIAL=:CODFILIALPD
           INTO
           :CODALMOX,:CODEMPAX,:CODFILIALAX,:CODMOEDA,:CODEMPMA,:CODFILIALMA,:CODUNID
           ,:CODEMPUD,:CODFILIALUD,:CODFISC,:CODEMPFC,:CODFILIALFC,:CODMARCA
           ,:CODEMPMC,:CODFILIALMC,:CODGRUP,:CODEMPGP,:CODFILIALGP,:TIPOPROD
           ,:CVPROD,:CLOTEPROD,:COMISPROD,:PESOLIQPROD,:PESOBRUTPROD,:QTDMINPROD,
           :QTDMAXPROD;

    select refprod from eqproduto where codemp=:codemppd and codfilial=:codfilialpd and refprod=:refprod into :refprodsel;

    if( (:ATUALIZAPROD = 'S') AND (coalesce(:refprodsel, '' ) = :refprod )) then
    begin
        update eqproduto p set p.descprod=:descprod, p.desccompprod=:desccompprod, p.descauxprod=:descauxprod, p.precobaseprod=:precobase
        where codemp=:codemppd and codfilial=:codfilialpd and refprod=:refprod;
    end
    else if (coalesce(:refprodsel, '' ) <> :refprod ) then
    begin
        INSERT INTO EQPRODUTO (CODEMP,CODFILIAL,CODPROD,REFPROD,CODALMOX,CODEMPAX,CODFILIALAX,CODMOEDA,CODEMPMA
              ,CODFILIALMA,CODUNID,CODEMPUD,CODFILIALUD,CODFISC,CODEMPFC,CODFILIALFC,CODMARCA,CODEMPMC,CODFILIALMC
              ,CODGRUP,CODEMPGP,CODFILIALGP,TIPOPROD,CVPROD,DESCPROD,DESCAUXPROD,CLOTEPROD,CODBARPROD,CODFABPROD
              ,COMISPROD,PESOLIQPROD,PESOBRUTPROD,QTDMINPROD,QTDMAXPROD,PRECOBASEPROD
              ,CODEMPOG, CODFILIALOG, CODPRODOG, CODEMPMG, CODFILIALMG, CODMODG, DESCCOMPPROD)
               VALUES (
                      :CODEMPPD,:CODFILIALPD,:Codnovo,:RefProd,:CODALMOX,:CODEMPAX,:CODFILIALAX,:CODMOEDA,:CODEMPMA,:CODFILIALMA
                      ,:CODUNID,:CODEMPUD,:CODFILIALUD,:CODFISC,:CODEMPFC,:CODFILIALFC,:CODMARCA,:CODEMPMC,:CODFILIALMC
                      ,:CODGRUP,:CODEMPGP,:CODFILIALGP,:TIPOPROD,:CVPROD,:Descprod,:DescAuxprod,:CLOTEPROD,:Codbarprod,:Codfabprod
                      ,:COMISPROD,:PESOLIQPROD,:PESOBRUTPROD,:QTDMINPROD,:QTDMAXPROD,:PRECOBASE
                      ,:CODEMPPD, :CODFILIALPD, :CODPROD, :CODEMPMG, :CODFILIALMG, :CODMODG, :DESCCOMPPROD
               );
        INSERT INTO VDPRECOPROD (CODEMP,CODFILIAL,CODPROD,CODPRECOPROD,CODCLASCLI,CODEMPCC,CODFILIALCC,CODTAB,CODEMPTB,CODFILIALTB,CODPLANOPAG,CODEMPPG,CODFILIALPG,PRECOPROD)
               SELECT :CODEMPPD,:CODFILIALPD,:Codnovo,CODPRECOPROD,CODCLASCLI,CODEMPCC,CODFILIALCC,
                      CODTAB,CODEMPTB,CODFILIALTB,CODPLANOPAG,CODEMPPG,CODFILIALPG,PRECOPROD FROM VDPRECOPROD WHERE CODPROD=:Codprod
                      AND CODEMP=:CODEMPPD AND CODFILIAL=:CODFILIALPD;
    end
  END
--  SUSPEND;
END ^

ALTER PROCEDURE EQBUSCASIMILARSP (CODEMP INTEGER,
CODFILIAL CHAR(8),
IPROD INTEGER,
SREFPROD VARCHAR(20))
RETURNS (SRET CHAR(13),
IRET INTEGER,
CORIG CHAR(1),
ICODFOR INTEGER,
SRAZFOR CHAR(60),
NPRECO NUMERIC(15, 5),
SSIM CHAR(18),
SSIMMASTER CHAR(18))
AS 
 
 

declare variable sfk char(21);
declare variable sbusca char(21);
BEGIN
/*  IF (IPROD IS NULL) THEN
  BEGIN
    SELECT CODPROD FROM EQPRODUTO WHERE CODEMP=:CODEMP
      AND CODFILIAL=:CODFILIAL AND REFPROD=:SREFPROD
      INTO IPROD;
    SBUSCA = CAST(SREFPROD AS CHAR(21));
  END
  ELSE
  BEGIN
    SBUSCA = CAST(IPROD AS VARCHAR(21));
  END
  FOR SELECT 'S',S.REFPRODSIM,S.REFPRODSIMFK,CAST(NULL AS INTEGER),
    CAST(NULL AS CHAR(50)),CAST(NULL AS NUMERIC(15, 5)),
    S.CODPROD,(SELECT P.REFPROD FROM EQPRODUTO P WHERE P.CODPROD=S.CODPROD
    AND P.CODEMP=S.CODEMP AND P.CODFILIAL=S.CODFILIAL)
    FROM EQSIMILAR S WHERE
    (S.CODPROD = :IPROD OR S.REFPRODSIM = :SBUSCA)
    AND S.CODEMP=:CODEMP AND S.CODFILIAL=:CODFILIAL INTO
    CORIG,SSIM,SFK,ICODFOR,SRAZFOR,NPRECO,IRET,SRET DO
  BEGIN
    SSIMMASTER = SSIM;
    SUSPEND;
    FOR SELECT 'K',S.REFPRODSIM,S.REFPRODSIMFK,CAST(NULL AS INTEGER),
      CAST(NULL AS CHAR(50)),CAST(NULL AS NUMERIC(15, 5)),
      S.CODPROD,(SELECT P.REFPROD FROM EQPRODUTO P WHERE P.CODPROD=S.CODPROD
      AND P.CODEMP=S.CODEMP AND P.CODFILIAL=S.CODFILIAL)
      FROM EQSIMILAR S WHERE
      (S.REFPRODSIMFK = :SFK OR S.CODPROD=:IRET) AND NOT S.REFPRODSIM=:SSIMMASTER
      AND S.CODEMP=:CODEMP AND S.CODFILIAL=:CODFILIAL INTO
      CORIG,SSIM,SFK,ICODFOR,SRAZFOR,NPRECO,IRET,SRET DO
    BEGIN
      SUSPEND;
    END
  END

  FOR SELECT 'C',C.REFPRODFOR,C.CODFOR,F.RAZFOR,CAST(NULL AS NUMERIC(15, 5)),
    P.CODPROD,(SELECT P.REFPROD FROM EQPRODUTO P WHERE P.CODPROD=C.CODPROD
    AND P.CODEMP=C.CODEMP AND P.CODFILIAL=C.CODFILIAL)
    FROM CPPRODFOR C, EQPRODUTO P, CPFORNECED F
    WHERE (C.CODPROD = :IPROD OR C.REFPRODFOR = :SBUSCA)
    AND C.CODEMP=:CODEMP AND C.CODFILIAL=:CODFILIAL AND P.CODEMP=C.CODEMP
    AND P.CODFILIAL=C.CODFILIAL AND P.CODPROD=C.CODPROD
    AND F.CODEMP=C.CODEMP AND F.CODFILIAL=C.CODFILIAL
    AND F.CODFOR=C.CODFOR
    UNION
    SELECT 'T',T.REFPRODTFOR,T.CODFOR,F.RAZFOR,T.PRECOPRODTFOR,
    (SELECT P.CODPROD FROM EQPRODUTO P WHERE P.CODEMP=T.CODEMPPD
    AND P.CODFILIAL=T.CODFILIALPD AND P.CODPROD=T.CODPROD),
    (SELECT P.REFPROD FROM EQPRODUTO P WHERE P.CODPROD=T.CODPROD
    AND P.CODEMP=T.CODEMP AND P.CODFILIAL=T.CODFILIAL)
    FROM CPTABFOR T, CPFORNECED F
    WHERE T.REFPRODTFOR = :SBUSCA AND T.CODEMP=:CODEMP
    AND T.CODFILIAL=:CODFILIAL AND F.CODEMP=T.CODEMP
    AND F.CODFILIAL=T.CODFILIAL AND F.CODFOR=T.CODFOR INTO
    CORIG,SSIM,ICODFOR,SRAZFOR,NPRECO,SRET,IRET DO
  BEGIN
    SUSPEND;
  END */
END ^

ALTER PROCEDURE EQCALCPEPSSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODPROD INTEGER,
NSLDPROD NUMERIC(15, 5),
DTESTOQ DATE,
ICODEMPAX INTEGER,
SCODFILIALAX SMALLINT,
ICODALMOX INTEGER)
RETURNS (NCUSTOPEPS NUMERIC(15, 5))
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

declare variable dttemp date;
declare variable ncusto numeric(15,5);
declare variable nqtd numeric(15,5);
declare variable nresto numeric(15,5);
declare variable ncustotot numeric(15,5);
declare variable nsldtmp numeric(15,5);
begin
  /* Procedure que retorna o clculo do custo peps */
  NCUSTO = 0;
  NCUSTOTOT = 0;
  NRESTO = 0;
  NCUSTOPEPS = 0;
  IF ( (NSLDPROD IS NOT NULL) AND (NSLDPROD != 0) ) THEN
  BEGIN
      NSLDTMP = NSLDPROD;
      FOR SELECT MP.DTMOVPROD, coalesce(MP.QTDMOVPROD,0),coalesce(MP.PRECOMOVPROD,0)
        FROM EQMOVPROD MP, EQTIPOMOV TM
         WHERE MP.CODEMPPD=:ICODEMP AND MP.CODFILIALPD=:SCODFILIAL AND MP.CODPROD=:ICODPROD AND
           MP.CODEMPTM=TM.CODEMP AND MP.CODFILIALTM=TM.CODFILIAL AND MP.CODTIPOMOV=TM.CODTIPOMOV AND
           MP.TIPOMOVPROD IN ('E','I') AND TM.TIPOMOV IN ('IV','CP','PC') AND
           MP.DTMOVPROD<=:DTESTOQ  AND
           ( (:ICODALMOX IS NULL) OR
             (MP.CODEMPAX=:ICODEMPAX AND MP.CODFILIALAX=:SCODFILIALAX AND
             MP.CODALMOX=:ICODALMOX)
           )
         ORDER BY MP.DTMOVPROD DESC, MP.CODMOVPROD DESC
         INTO :DTTEMP,:NQTD,:NCUSTO DO
      BEGIN
         NRESTO = NSLDTMP - NQTD;
         IF (NRESTO<=0) THEN
         BEGIN
           NCUSTOTOT = NCUSTOTOT + (NCUSTO * (NQTD+NRESTO) );
           BREAK;
         END
         ELSE
         BEGIN
           NCUSTOTOT = NCUSTOTOT + (NCUSTO * NQTD);
           NSLDTMP = NSLDTMP - NQTD;
         END
      END
      if( (:nsldprod is not null and :nsldprod>0) and (:ncustotot is not null and :ncustotot>0) ) then
          NCUSTOPEPS = NCUSTOTOT / NSLDPROD;
      else
          ncustopeps = 0;
  END
  suspend;
end ^

ALTER PROCEDURE EQCOPIAPROD (ICODPROD INTEGER,
ICODEMP INTEGER,
ICODFILIAL INTEGER)
RETURNS (ICOD INTEGER)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

declare variable inovocod integer;
BEGIN
  SELECT MAX(CODPROD)+1 FROM EQPRODUTO
    WHERE CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL INTO INOVOCOD;
  INSERT INTO EQPRODUTO
      (CODPROD,CODEMP,CODFILIAL,DESCPROD,REFPROD,CODEMPAX,
      CODFILIALAX,CODALMOX,CODEMPMA,CODFILIALMA,CODMOEDA,CODEMPUD,
      CODFILIALUD,CODUNID,CODEMPFC,CODFILIALFC,CODFISC,CODEMPMC,
      CODFILIALMC,CODMARCA,DESCAUXPROD,TIPOPROD,CVPROD,CODEMPGP,
      CODFILIALGP,CODGRUP,CODBARPROD,CLOTEPROD,CODFABPROD,
      COMISPROD,PESOLIQPROD,PESOBRUTPROD,QTDMINPROD,QTDMAXPROD,
      PRECOBASEPROD,ATIVOPROD,DESCCOMPPROD)
    SELECT :INOVOCOD,:ICODEMP,:ICODFILIAL,DESCPROD,:INOVOCOD,CODEMPAX,
      CODFILIALAX,CODALMOX,CODEMPMA,CODFILIALMA,CODMOEDA,CODEMPUD,
      CODFILIALUD,CODUNID,CODEMPFC,CODFILIALFC,CODFISC,CODEMPMC,
      CODFILIALMC,CODMARCA,DESCAUXPROD,TIPOPROD,CVPROD,CODEMPGP,
      CODFILIALGP,CODGRUP,CODBARPROD,CLOTEPROD,CODFABPROD,COMISPROD,
      PESOLIQPROD,PESOBRUTPROD,QTDMINPROD,QTDMAXPROD,PRECOBASEPROD,
      ATIVOPROD,DESCCOMPPROD FROM
      EQPRODUTO WHERE CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL AND
      CODPROD=:ICODPROD;

    INSERT INTO VDPRECOPROD (CODEMP,CODFILIAL,CODPROD,CODPRECOPROD,
        CODEMPTB,CODFILIALTB,CODTAB,CODEMPCC,CODFILIALCC,CODCLASCLI,
        CODEMPPG,CODFILIALPG,CODPLANOPAG,PRECOPROD)
      SELECT CODEMP,CODFILIAL,:INOVOCOD,CODPRECOPROD,
        CODEMPTB,CODFILIALTB,CODTAB,CODEMPCC,CODFILIALCC,CODCLASCLI,
        CODEMPPG,CODFILIALPG,CODPLANOPAG,PRECOPROD FROM VDPRECOPROD
        WHERE CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL AND
          CODPROD=:ICODPROD;

    INSERT INTO EQFATCONV (CODEMP,CODFILIAL,CODPROD,CODUNID,FATCONV)
      SELECT CODEMP,CODFILIAL,:INOVOCOD,CODUNID,FATCONV FROM EQFATCONV
        WHERE CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL AND CODPROD=:ICODPROD;

    INSERT INTO CPPRODFOR (CODEMP,CODFILIAL,CODPROD,CODFOR,REFPRODFOR)
      SELECT CODEMP,CODFILIAL,:INOVOCOD,CODFOR,REFPRODFOR FROM CPPRODFOR
        WHERE CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL AND CODPROD=:ICODPROD;
        
    /* se for outro produto o lote provavelmente ser outro tambm */
    /*INSERT INTO EQLOTE (CODEMP,CODFILIAL,CODPROD,CODLOTE,VENCTOLOTE,
        SLDLOTE,SLDRESLOTE,SLDCONSIGLOTE,SLDLIQLOTE,DINILOTE)
      SELECT CODEMP,CODFILIAL,:INOVOCOD,CODLOTE,VENCTOLOTE,
        SLDLOTE,SLDRESLOTE,SLDCONSIGLOTE,SLDLIQLOTE,DINILOTE FROM EQLOTE
        WHERE CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL AND CODPROD=:ICODPROD;*/
        
    INSERT INTO VDFOTOPROD (CODEMP,CODFILIAL,CODPROD,CODFOTOPROD,DESCFOTOPROD,
        TIPOFOTOPROD,LARGFOTOPROD,ALTFOTOPROD,FOTOPROD)
      SELECT CODEMP,CODFILIAL,:INOVOCOD,CODFOTOPROD,DESCFOTOPROD,
        TIPOFOTOPROD,LARGFOTOPROD,ALTFOTOPROD,FOTOPROD FROM VDFOTOPROD
        WHERE CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL AND CODPROD=:ICODPROD;
   ICOD = INOVOCOD;
   SUSPEND;
END ^

ALTER PROCEDURE EQCUSTOPRODSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODPROD INTEGER,
DTESTOQ DATE,
CTIPOCUSTO CHAR(1),
ICODEMPAX INTEGER,
SCODFILIALAX SMALLINT,
ICODALMOX INTEGER,
CCOMSALDO CHAR(10))
RETURNS (SLDPROD NUMERIC(15, 5),
CUSTOUNIT NUMERIC(15, 5),
CUSTOTOT NUMERIC(15, 5))
AS 

declare variable precobase numeric(15,5);
declare variable custompm numeric(15,5);
begin
  /* Retorna o custo unitrio do produto */
  IF (CTIPOCUSTO IS NULL) then
     CTIPOCUSTO = 'P';

     -- Se o almoxarifado no for selecionado, deve buscar o saldo geral
    if(:icodalmox is null) then
    begin
   --      execute procedure sgdebugsp 'eqcustoprosp','inicio do custo por almoxarifado';

        SELECT P.PRECOBASEPROD,
            (SELECT FIRST 1 M.SLDMOVPROD
             FROM EQMOVPROD M
             WHERE M.CODEMPPD=P.CODEMP AND
               M.CODFILIAL=P.CODFILIAL AND
               M.CODPROD=P.CODPROD AND
               M.DTMOVPROD<=:DTESTOQ
             ORDER BY P.CODPROD, M.DTMOVPROD DESC , M.CODMOVPROD DESC
             ) ,
            (SELECT FIRST 1 M.CUSTOMPMMOVPROD
             FROM EQMOVPROD M
             WHERE M.CODEMPPD=P.CODEMP AND
               M.CODFILIAL=P.CODFILIAL AND
               M.CODPROD=P.CODPROD AND
               M.DTMOVPROD<=:DTESTOQ
             ORDER BY P.CODPROD, M.DTMOVPROD DESC , M.CODMOVPROD DESC
            )
            FROM EQPRODUTO P
            WHERE P.CODEMP = :ICODEMP AND P.CODFILIAL = :SCODFILIAL AND P.CODPROD=:ICODPROD
            INTO :PRECOBASE, :SLDPROD, :CUSTOMPM;
  --       execute procedure sgdebugsp 'eqcustoprosp','aps custo mpm';

    end
    else
    begin

   --     execute procedure sgdebugsp 'eqcustoprosp','inicio do custo geral';

        SELECT P.PRECOBASEPROD,
            (SELECT FIRST 1 M.SLDMOVPRODAX
             FROM EQMOVPROD M
             WHERE M.CODEMPPD=P.CODEMP AND M.CODFILIAL=P.CODFILIAL AND M.CODPROD=P.CODPROD AND M.DTMOVPROD<=:DTESTOQ
                and ( (:icodalmox is null) or ( m.codempax=:icodempax and m.codfilial=:scodfilialax and m.codalmox=:icodalmox) )
             ORDER BY P.CODPROD, M.DTMOVPROD DESC , M.CODMOVPROD DESC
         ) ,
         (SELECT FIRST 1 M.CUSTOMPMMOVPROD
         FROM EQMOVPROD M
         WHERE M.CODEMPPD=P.CODEMP AND
               M.CODFILIAL=P.CODFILIAL AND
               M.CODPROD=P.CODPROD AND
               M.DTMOVPROD<=:DTESTOQ
               and ( (:icodalmox is null) or ( m.codempax=:icodempax and m.codfilial=:scodfilialax and m.codalmox=:icodalmox) )
         ORDER BY P.CODPROD, M.DTMOVPROD DESC , M.CODMOVPROD DESC
         )
       FROM EQPRODUTO P
       WHERE P.CODEMP = :ICODEMP AND P.CODFILIAL = :SCODFILIAL AND
          P.CODPROD=:ICODPROD
       INTO :PRECOBASE, :SLDPROD, :CUSTOMPM;

  --     execute procedure sgdebugsp 'eqcustoprosp','aps o custo geral';

    end


  CUSTOUNIT = 0;
  CUSTOTOT = 0;
  IF (SLDPROD IS NULL) THEN
        SLDPROD = 0;
  IF ( (SLDPROD!=0) OR (CCOMSALDO!='S') ) THEN
  BEGIN
      -- Custo PEPS
      IF (CTIPOCUSTO='P') THEN
      BEGIN

         SELECT NCUSTOPEPS FROM EQCALCPEPSSP(:ICODEMP,:SCODFILIAL,:ICODPROD,
            :SLDPROD,:DTESTOQ, :ICODEMPAX, :SCODFILIALAX, :ICODALMOX)
            INTO :CUSTOUNIT;
         IF (CUSTOUNIT!=0) THEN
            CUSTOTOT = CUSTOUNIT*SLDPROD;
    --     execute procedure sgdebugsp 'eqcustoprosp','aps custo PEPS';

      END
      -- Custo MPM
      ELSE IF (CTIPOCUSTO='M') THEN
      BEGIN
         CUSTOUNIT = CUSTOMPM;
         IF (CUSTOUNIT IS NULL) THEN
            CUSTOUNIT = 0;
          CUSTOTOT = CUSTOUNIT*SLDPROD;
    --     execute procedure sgdebugsp 'eqcustoprosp','aps custo MPM';

      END
      -- Preo Base
      ELSE IF (CTIPOCUSTO='B') THEN
      BEGIN
         CUSTOUNIT = PRECOBASE;
         IF (CUSTOUNIT IS NULL) THEN
            CUSTOUNIT = 0;
          CUSTOTOT = CUSTOUNIT*SLDPROD;
      --    execute procedure sgdebugsp 'eqcustoprosp','aps precobase';

      END
      -- Preo da Ultima Compra
      else if (CTIPOCUSTO='U') then
      begin
        select first 1 ic.custoitcompra from cpitcompra ic, cpcompra cp
            where cp.codemp=:icodemp and cp.codfilial=:scodfilial and cp.dtentcompra<=:dtestoq
            and ic.codemp=cp.codemp and ic.codfilial=cp.codfilial and ic.codcompra=cp.codcompra
            and ic.codemppd=:icodemp and ic.codfilialpd=:scodfilial and ic.codprod=:icodprod
            and ( (:icodalmox is null) or ( ic.codempax=:icodempax and ic.codfilial=:scodfilialax and ic.codalmox=:icodalmox) )
            order by cp.dtentcompra desc
            into :CUSTOUNIT;

            if (CUSTOUNIT IS NULL) THEN
                CUSTOUNIT = :CUSTOMPM;
         -- execute procedure sgdebugsp 'eqcustoprosp','aps ltima compra';

      end

  END
  SUSPEND;
end ^

ALTER PROCEDURE EQGERARMAOSSP (CODEMPRM INTEGER,
CODFILIALRM INTEGER,
TICKET INTEGER,
CODITRECMERC SMALLINT)
RETURNS (CODRMA INTEGER)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

declare variable coditos smallint;
declare variable idusu1 char(8);
declare variable codfilialrma smallint;
declare variable codfilialpd smallint;
declare variable coditrma integer;
declare variable refprod varchar(20);
declare variable codtipomov1 integer;
declare variable codccusu1 char(19);
declare variable codfilialccusu1 smallint;
declare variable codfilialtm1 smallint;
declare variable codfilialtm smallint;
declare variable codemppd integer;
declare variable codprod integer;
declare variable codfilialle smallint;
declare variable custompmit numeric(15,5);
declare variable codlote varchar(20);
declare variable codalmox integer;
declare variable qtd numeric(15,2);
declare variable codfilialax smallint;
declare variable codfilialusu1 smallint;
declare variable anoccusu1 smallint;
declare variable statusaprovrmager char(2) = 'PE';
declare variable statusrmager char(2);
declare variable qtdaprov numeric(15,5) = 0;
begin


    -- buscando centro de custo do usurio atual
    select codfilialusu,codfilialccusu,codccusu,anoccusu,idusus
    from sgretinfousu(:codemprm, user)
    into :CODFILIALUSU1,:CODFILIALCCUSU1,:CODCCUSU1,:ANOCCUSU1,:IDUSU1;

    -- Buscando filial da rma
    SELECT ICODFILIAL FROM sgretfilial(:CODEMPRM,'EQRMA')
    into :codfilialrma;

    -- Buscando filial do lote
    SELECT ICODFILIAL FROM sgretfilial(:CODEMPRM,'EQLOTE')
    into :codfilialle;

    -- Buscando filial do tipo de movimento
    SELECT ICODFILIAL FROM sgretfilial(:CODEMPRM,'EQTIPOMOV')
    into :codfilialtm;

    -- buscando tipo de movimento para RMA
    select codfilialt8,codtipomov8 from sgprefere1
    where codemp=:codemprm and codfilial=:codfilialrm
    into :codfilialtm1,:codtipomov1;

    -- Buscado a situao pardro para RMA
    select coalesce(SITRMAOP,'PE') from sgprefere5 where codemp=:codemprm and
    codfilial=(select icodfilial from sgretfilial(:codemprm,'SGPREFERE5'))
    into :statusrmager;

    if(:statusrmager is null) then
    begin
       statusrmager = 'PE';
    end

    -- Carregando quantidade aprovada...
    QTDAPROV = 0;
    STATUSAPROVRMAGER = 'PE';

    -- Buscando cdigo novo cdigo de RMA.
    select coalesce((max(codrma)+1),1) from
    eqrma where codemp=:codemprm and codfilial=:codfilialrma
    into :codrma;

    -- Inserindo nova RMA
    insert into eqrma (codemp,codfilial,codrma,
                     codempuu,codfilialuu,idusu,
                     codempua,codfilialua,idusuaprov,
                     codempue,codfilialue,idusuexp,
                     codemptm,codfilialtm,codtipomov,
                     codempcc,codfilialcc,anocc,codcc,
                     dtareqrma,dtaaprovrma,dtaexprma,
                     sitrma,sitaprovrma,sitexprma,
                     codempos,codfilialos,ticket,coditrecmerc,motivorma)
                     values
                     (:codemprm,:codfilialrma,:codrma,
                      :codemprm, :codfilialusu1,:idusu1,
                      null,null,null,
                      null,null,null,
                      :codemprm, :codfilialtm1, :codtipomov1,
                      :codemprm,:codfilialccusu1,:anoccusu1,:codccusu1,
                      cast('now' AS DATE),null,null,
                      :STATUSRMAGER,:STATUSAPROVRMAGER,'PE',
                      :codemprm,:codfilialrm,:ticket,:coditrecmerc,
                      'REQUISIO GERADA PARA ATENDIMENTO  OS:'|| :ticket
    );

    -- Loop nos itens de Ordem de Servio.

    for select os.coditrecmerc, os.coditos, os.codemppd, os.codfilialpd, os.refprodpd, os.codprodpd, os.qtditos,
    (select ncustompm from eqprodutosp01(os.codemppd, os.codfilialpd, os.codprodpd,null,null,null)) custompmit
    from eqitrecmercitos os
    where os.codemp=:codemprm and os.codfilial=:codfilialrm and os.ticket=:ticket
--    and ( (os.coditrecmerc=:coditrecmerc) or (:coditrecmerc is null) )
    and os.gerarma='S'
    into :coditrecmerc, :coditos, :codemppd, :codfilialpd, :refprod, :codprod, :qtd, :custompmit
    do

    begin

       select coalesce((max(coditrma)+1),1) from eqitrma
       where codemp=:codemprm and codfilial=:codfilialrma and codrma=:codrma
       into :coditrma;

       if(:statusrmager='AF') then
       begin
         STATUSAPROVRMAGER = 'AT';
         QTDAPROV = :qtd;
       end

       insert into eqitrma (CODEMP,CODFILIAL,CODRMA,CODITRMA,
                            CODEMPPD,CODFILIALPD,CODPROD,REFPROD,
                            QTDITRMA,QTDAPROVITRMA,QTDEXPITRMA,PRECOITRMA,
                            CODEMPLE,CODFILIALLE,CODLOTE,
                            CODEMPAX,CODFILIALAX,CODALMOX,
                            SITITRMA,SITAPROVITRMA,SITEXPITRMA,
                            CODEMPOS,CODFILIALOS,TICKET,CODITRECMERC,CODITOS
                            )
                            values
                            (:codemprm,:codfilialrma,:codrma, :coditrma,
                            :codemprm,:codfilialpd,
                            :codprod, :refprod, :qtd, :qtdaprov, 0, :custompmit, :codemprm,
                            :codfilialle,:codlote,
                            :codemprm,:codfilialax,:codalmox,
                            :statusrmager,:statusaprovrmager,'PE',
                            :codemprm, :codfilialrm, :ticket, :coditrecmerc,:coditos
                            );

        update eqitrecmercitos os set os.gerarma='N', os.statusitos='EC'
        where os.codemp=:codemprm and os.codfilial=:codfilialrm and os.ticket=:ticket
        and os.coditrecmerc=:coditrecmerc and os.coditos=:coditos;

        suspend;

   end
end ^

ALTER PROCEDURE EQGERARMASP (CODEMPOP INTEGER,
CODFILIALOP INTEGER,
CODOP INTEGER,
SEQOP SMALLINT)
AS 
declare variable seqof smallint;
declare variable idusu1 char(8);
declare variable seqitop integer;
declare variable coditrma integer;
declare variable refprod varchar(20);
declare variable codrma integer;
declare variable codtipomov1 integer;
declare variable codccusu1 char(19);
declare variable codfilialccusu1 smallint;
declare variable codfilialpd smallint;
declare variable codfilialtm1 smallint;
declare variable codprod integer;
declare variable codfilialle smallint;
declare variable custompmit numeric(15,5);
declare variable codlote varchar(20);
declare variable codalmox integer;
declare variable qtd numeric(15,2);
declare variable codfilialax smallint;
declare variable codfilialusu1 smallint;
declare variable anoccusu1 smallint;
declare variable statusaprovrmager char(2) = 'PE';
declare variable statusrmager char(2);
declare variable codfilialfase smallint;
declare variable qtdaprov numeric(15,5) = 0;
declare variable codfase integer;
declare variable codempos integer;
declare variable codfilialos smallint;
declare variable ticket integer;
declare variable coditrecmerc integer;
declare variable coditos integer;
begin

    -- Buscando informaes do usurio
    select codfilialusu,codfilialccusu,codccusu,anoccusu,idusus
    from sgretinfousu(:codempop, user)
    into :CODFILIALUSU1,:CODFILIALCCUSU1,:CODCCUSU1,:ANOCCUSU1,:IDUSU1;

    -- Buscando preferencias de tipo de movimento para OP
    select codfilialt8,codtipomov8
    from sgprefere1 where codemp=:CODEMPOP and codfilial=(select icodfilial from sgretfilial(:CODEMPOP, 'SGPREFERE1'))
    into :CODFILIALTM1,:CODTIPOMOV1;

    --Buscando informaes da OP.
    select op.codempos, op.codfilialos, op.ticket, op.coditrecmerc, op.coditos
    from  ppop op
    where op.codemp=:codempop and op.codfilial=:codfilialop and op.codop=:codop and op.seqop=:seqop
    into :codempos, :codfilialos, :ticket, :coditrecmerc, :coditos;

    -- Buscando preferencias para gerao de RMA
    select coalesce(SITRMAOP,'PE') from sgprefere5 where codemp=:CODEMPOP and
    codfilial=(select icodfilial from sgretfilial(:CODEMPOP,'SGPREFERE5'))
    into :STATUSRMAGER;

    QTDAPROV = 0;
    STATUSAPROVRMAGER = 'PE';

    for select codfilialfs,codfase,seqof from ppopfase opf
        where opf.codemp=:CODEMPOP and opf.codfilial=:CODFILIALOP and
        opf.codop=:CODOP and  opf.seqop=:SEQOP and
        (select count(1) from ppitop it
        where it.codemp=:CODEMPOP and it.codfilial=:CODFILIALOP and
        it.codempfs=opf.codempfs and it.codfilialfs=opf.codfilialfs and
        it.codfase=opf.codfase and it.gerarma='S' and
        it.codop=:CODOP and it.seqop=:SEQOP) > 0
        into :codfilialfase,:codfase,:SEQOF do
    begin
        select coalesce((max(codrma)+1),1)
        from eqrma
        where codemp=:CODEMPOP and codfilial=:CODFILIALOP into :CODRMA;

        insert into eqrma (codemp,codfilial,codrma,
                     codempuu,codfilialuu,idusu,
                     codempua,codfilialua,idusuaprov,
                     codempue,codfilialue,idusuexp,
                     codemptm,codfilialtm,codtipomov,
                     codempcc,codfilialcc,anocc,codcc,
                     dtareqrma,dtaaprovrma,dtaexprma,
                     sitrma,sitaprovrma,sitexprma,
                     codempof,codfilialof,codop,seqop,seqof,
                     motivorma, codempos, codfilialos, ticket, coditrecmerc)
                     values
                     (:CODEMPOP,(SELECT ICODFILIAL FROM sgretfilial(:CODEMPOP,'EQRMA')),:CODRMA,
                      :CODEMPOP, :CODFILIALUSU1,:IDUSU1,
                      null,null,null,
                      null,null,null,
                      :CODEMPOP,(SELECT ICODFILIAL FROM sgretfilial(:CODEMPOP,'EQTIPOMOV')),
                      :CODTIPOMOV1,
                      :CODEMPOP,:CODFILIALCCUSU1,:ANOCCUSU1,:CODCCUSU1,
                      cast('now' AS DATE),null,null,
                      :STATUSRMAGER,:STATUSAPROVRMAGER,'PE',
                      :CODEMPOP,:CODFILIALOP,:CODOP,:SEQOP,:SEQOF,
                      'REQUISIO GERADA PARA ATENDIMENTO  OP:'||:CODOP||' SEQ:'||:SEQOP||' - FASE:'||:CODFASE,
                      :codempos, :codfilialos, :ticket, :coditrecmerc
        );

        for select it.seqitop,it.codfilialpd,it.codprod,it.refprod,it.qtditop-coalesce(it.qtdcopiaitop,0),it.codfilialle,it.codlote,
            (select ncustompm from eqprodutosp01(it.codemppd,it.codfilialpd,it.codprod,null,null,null)),
            (SELECT CODFILIALAX FROM EQPRODUTO WHERE CODEMP=it.codemppd and codfilial=it.codfilialpd and codprod=it.codprod),
            (SELECT CODALMOX FROM EQPRODUTO WHERE CODEMP=it.codemppd and codfilial=it.codfilialpd and codprod=it.codprod)
            from ppitop it, eqproduto pd
            where
            pd.codemp=it.codemppd and pd.codfilial=it.codfilialpd and pd.codprod=it.codprod
            and it.codemp=:CODEMPOP and it.codfilial=:CODFILIALOP
            and it.codop=:CODOP and it.seqop=:SEQOP and it.codempfs=:CODEMPOP
            and it.codfilialfs=:CODFILIALFASE
            and it.codfase = :CODFASE and it.gerarma='S'
            and (('S'=(select ratauto from sgprefere5 where codemp=it.codemp and codfilial=it.codfilial))
            and (it.qtditop-coalesce(it.qtdcopiaitop, 0))<=(SELECT L.SLDLOTE FROM EQLOTE L
                                                            WHERE L.CODEMP=it.codemple AND L.CODFILIAL=it.codfilialle AND
                                                            L.CODPROD=it.codprod AND L.CODLOTE=it.codlote)
            or pd.cloteprod = 'N'
                                                            )
            into :SEQITOP, :CODFILIALPD,:CODPROD,:REFPROD,:QTD,
            :CODFILIALLE,:CODLOTE,:CUSTOMPMIT,:CODFILIALAX,:CODALMOX  DO
        begin
            select coalesce((max(coditrma)+1),1) from eqitrma
            where codemp=:CODEMPOP and codfilial=:CODFILIALOP and
            codrma=:CODRMA into :coditrma;

            if(:STATUSRMAGER='AF')then
            begin
                STATUSAPROVRMAGER = 'AT';
                QTDAPROV = :QTD;
            end

            insert into eqitrma (CODEMP,CODFILIAL,CODRMA,CODITRMA,
                            CODEMPPD,CODFILIALPD,CODPROD,REFPROD,
                            QTDITRMA,QTDAPROVITRMA,QTDEXPITRMA,PRECOITRMA,
                            CODEMPLE,CODFILIALLE,CODLOTE,
                            CODEMPAX,CODFILIALAX,CODALMOX,
                            SITITRMA,SITAPROVITRMA,SITEXPITRMA,
                            codempos, codfilialos, ticket, coditrecmerc, coditos
                            )
                            values
                            (:CODEMPOP,(SELECT ICODFILIAL FROM sgretfilial(:CODEMPOP,'EQITRMA')),:CODRMA,
                            :coditrma,
                            :CODEMPOP,(SELECT ICODFILIAL FROM sgretfilial(:CODEMPOP,'EQPRODUTO')),
                            :CODPROD,:REFPROD,:QTD,:QTDAPROV,0,:CUSTOMPMIT,:CODEMPOP,(SELECT ICODFILIAL FROM sgretfilial(:CODEMPOP,'EQLOTE')),:CODLOTE,
                            :CODEMPOP,:CODFILIALAX,:CODALMOX,
                            :STATUSRMAGER,:STATUSAPROVRMAGER,'PE',
                            :codempop, :codfilialos, :ticket, :coditrecmerc, :coditos
                            );

            update ppitop it set it.gerarma='N' where it.CODEMP=:CODEMPOP AND
                it.CODFILIAL=:CODFILIALOP AND
                it.codop=:CODOP and it.seqop=:SEQOP and it.seqitop=:seqitop;

        end

    end

    suspend;

end ^

ALTER PROCEDURE EQITRECMERCSERIESP (TRANSACAO CHAR(1),
CODEMP INTEGER,
CODFILIAL SMALLINT,
TICKET INTEGER,
CODITRECMERC SMALLINT,
CODEMPPD INTEGER,
CODFILIALPD SMALLINT,
CODPROD INTEGER,
NUMSERIETMP VARCHAR(30),
QTDITRECMERC INTEGER)
AS 
 
 
 
declare variable seqitserie integer;
declare variable serieprod char(1);
begin
        
    -- Buscando informaes do produto
    select pd.serieprod from eqproduto pd
    where pd.codemp = :codemppd and pd.codfilial = :codfilialpd and pd.codprod = :codprod
    into :serieprod;
    
    -- Se o produto usa srie...
    if(serieprod = 'S') then
    begin
    
        -- Buscando ultimo item de srie inserido...
        select coalesce(max(seqitserie),0) from eqitrecmercserie
        where codemp=:codemp and codfilial=:codfilial and ticket=:ticket and coditrecmerc=:coditrecmerc
        into :seqitserie;
    
        -- Se for uma transao de Insero...
        if( 'I' = :transacao) then
        begin
            -- Inserindo itens, enquanto a sequencia for menor ou igual  quantidade de itens
            while (seqitserie < qtditrecmerc) do
            begin
                seqitserie = seqitserie + 1;

                -- Se a quantidade no for unitria
                if(qtditrecmerc > 1) then
                begin
                    insert into eqitrecmercserie
                    (codemp, codfilial, ticket,  coditrecmerc, seqitserie )
                    values
                    (:codemp, :codfilial, :ticket, :coditrecmerc, :seqitserie);
                end
                -- Se for apenas um item, deve inserir o numero se srie digitado na tela...
                else if(qtditrecmerc = 1 and :numserietmp is not null) then
                begin
                    insert into eqitrecmercserie
                    (codemp, codfilial, ticket,  coditrecmerc, seqitserie, codemppd, codfilialpd, codprod, numserie )
                    values
                    (:codemp, :codfilial, :ticket, :coditrecmerc, :seqitserie, :codemppd, :codfilialpd, :codprod, :numserietmp );
                end
            end
        end
        -- Se for uma transao de Deleo, deve excluir todas os tens gerados.
        else if('D' = :transacao) then
        begin
            delete from eqitrecmercserie itcs
            where
            itcs.codemp = :codemp and itcs.codfilial = :codfilial and itcs.ticket = :ticket and itcs.coditrecmerc = :coditrecmerc;
        end
        -- Se for uma transao de Update, deve excluir os excessos ou incluir os faltantes...
        else if('U' = :transacao) then
        begin

            if(seqitserie > qtditrecmerc) then
            begin

                delete from eqitrecmercserie itcs
                where
                itcs.codemp = :codemp and itcs.codfilial = :codfilial and itcs.ticket = :ticket and itcs.coditrecmerc = :coditrecmerc
                and itcs.seqitserie > :qtditrecmerc;
            
            end
            else
            begin
            
--                execute procedure cpitcompraseriesp( 'I', :codemp, :codfilial, :codcompra, :coditcompra, :codemppd, :codfilialpd, :codprod, :numserietmp, :qtditcompra);

            end

        end

    end


end ^

ALTER PROCEDURE EQMOVPRODATEQSP (ICODEMPPD INTEGER,
SCODFILIALPD SMALLINT,
ICODPROD INTEGER,
ICODEMPLEOLD INTEGER,
SCODFILIALLEOLD SMALLINT,
CCODLOTEOLD VARCHAR(20),
ICODEMPLENEW INTEGER,
SCODFILIALLENEW SMALLINT,
CCODLOTENEW VARCHAR(20),
SOPERADOR SMALLINT,
NQTDMOVPRODOLD NUMERIC(15, 5),
NQTDMOVPRODNEW NUMERIC(15, 5),
ICODEMPAXOLD INTEGER,
SCODFILIALAXOLD SMALLINT,
ICODALMOXOLD INTEGER,
ICODEMPAXNEW INTEGER,
SCODFILIALAXNEW SMALLINT,
ICODALMOXNEW INTEGER)
AS 
DECLARE VARIABLE CCLOTEPROD CHAR(1);
DECLARE VARIABLE ICODALMOX INTEGER;
DECLARE VARIABLE ICODEMPAX INTEGER;
DECLARE VARIABLE SCODFILIALAX SMALLINT;
begin
  /* Procedure de atualizao do estoque */
  UPDATE EQPRODUTO SET SLDPROD = SLDPROD+((:NQTDMOVPRODNEW-:NQTDMOVPRODOLD)*:SOPERADOR)
            WHERE CODPROD=:ICODPROD AND CODEMP=:ICODEMPPD AND CODFILIAL=:SCODFILIALPD;

  SELECT CLOTEPROD, CODALMOX,CODEMPAX,CODFILIALAX FROM EQPRODUTO
     WHERE CODPROD = :ICODPROD AND CODEMP=:ICODEMPPD AND CODFILIAL = :SCODFILIALPD
      INTO :CCLOTEPROD, :ICODALMOX, :ICODEMPAX, :SCODFILIALAX;

  EXECUTE PROCEDURE EQSALDOPRODATEQSP(:ICODEMPPD, :SCODFILIALPD, :ICODPROD, :SOPERADOR,
   :NQTDMOVPRODOLD, :NQTDMOVPRODNEW, :ICODEMPAXOLD, :SCODFILIALAXOLD, :ICODALMOXOLD,
   :ICODEMPAXNEW, :SCODFILIALAXNEW, :ICODALMOXNEW);

  IF (CCLOTEPROD = 'S') THEN
  BEGIN
    IF (CCODLOTENEW IS NULL) THEN
    BEGIN
      EXCEPTION EQPRODUTOEX01 'ESTE MOVIMENTO PRECISA DE UM LOTE!';
    END
    ELSE
    BEGIN
       EXECUTE PROCEDURE EQSALDOLOTEATEQSP(:ICODEMPLEOLD, :SCODFILIALLEOLD, :ICODPROD, :CCODLOTEOLD,
          :ICODEMPLENEW, :SCODFILIALLENEW, :CCODLOTENEW, :SOPERADOR, :NQTDMOVPRODOLD, :NQTDMOVPRODNEW,
          :ICODEMPAXOLD, :SCODFILIALAXOLD, :ICODALMOXOLD, :ICODEMPAXNEW, :SCODFILIALAXNEW, :ICODALMOXNEW);
    END
  END

  suspend;
end ^

ALTER PROCEDURE EQMOVPRODCKCPSP (ICODEMPPD INTEGER,
SCODFILIALPD SMALLINT,
ICODPROD INTEGER,
ICODCOMPRA INTEGER,
ICODINVPROD INTEGER,
DDTMOVPROD DATE,
NQTDMOVPROD NUMERIC(15, 5),
NCUSTOMPMMOVPROD NUMERIC(15, 5))
RETURNS (DDTULTCPPROD DATE,
NQTDULTCPPROD NUMERIC(15, 5),
DDTMPMPROD DATE,
NCUSTOMPMPROD NUMERIC(15, 5))
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

begin
  /* Procedure para checar data da ltima compra */
  NCUSTOMPMPROD = 0;
  if (NCUSTOMPMMOVPROD IS NULL) then
     NCUSTOMPMMOVPROD = 0;
  if ( (ICODINVPROD IS NOT NULL) OR (ICODCOMPRA IS NOT NULL) ) then
  begin
     SELECT DTULTCPPROD,QTDULTCPPROD,DTMPMPROD, CUSTOMPMPROD FROM EQPRODUTO WHERE CODPROD=:ICODPROD
          AND CODEMP=:ICODEMPPD AND CODFILIAL = :SCODFILIALPD
          INTO :DDTULTCPPROD, :NQTDULTCPPROD, :DDTMPMPROD, :NCUSTOMPMPROD;
      if (NQTDULTCPPROD IS NULL) then
         NQTDULTCPPROD = 0;
      if (NCUSTOMPMPROD IS NULL) then
         NCUSTOMPMPROD = 0;
      if ( ICODCOMPRA IS NOT NULL ) then
      begin
         if ( (DDTMOVPROD>DDTULTCPPROD) OR (DDTULTCPPROD IS NULL) ) then
         begin
             DDTULTCPPROD = DDTMOVPROD;
             NQTDULTCPPROD = NQTDMOVPROD;
         end
      end
      if ( ( ICODINVPROD IS NOT NULL) OR (ICODCOMPRA IS NOT NULL) ) then
      begin
         if ( (DDTMOVPROD>=DDTMPMPROD OR DDTMPMPROD IS NULL) AND
              (NCUSTOMPMMOVPROD>0)  ) then
         begin
            DDTMPMPROD = DDTMOVPROD;
            NCUSTOMPMPROD = NCUSTOMPMMOVPROD;
         end
      end
  end


  suspend;
end ^

ALTER PROCEDURE EQMOVPRODCKTMSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODTIPOMOV INTEGER,
ESTOQTIPOMOVPD CHAR(1))
RETURNS (CESTIPOMOV CHAR(1),
SOPERADOR SMALLINT)
AS 
 
DECLARE VARIABLE CESTOQTIPOMOV CHAR(1);
begin
  /* Verifique se  para contar estoque */
  SELECT TM.ESTIPOMOV, TM.ESTOQTIPOMOV FROM EQTIPOMOV TM WHERE TM.CODEMP=:ICODEMP AND
     TM.CODFILIAL = :SCODFILIAL AND TM.CODTIPOMOV = :ICODTIPOMOV
     INTO :CESTIPOMOV, :CESTOQTIPOMOV;
  SOPERADOR = 0;
  if ((ESTOQTIPOMOVPD='S') and (CESTOQTIPOMOV='S')) then
  begin
     if (CESTIPOMOV='S') then
        SOPERADOR = -1;
     else
        SOPERADOR = 1;
  end
  suspend;
end ^

ALTER PROCEDURE EQMOVPRODCKUTMSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODTIPOMOV INTEGER,
ICODEMPOLD INTEGER,
SCODFILIALOLD SMALLINT,
ICODTIPOMOVOLD INTEGER)
RETURNS (CALTTM CHAR(1))
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

DECLARE VARIABLE CESTIPOMOV CHAR(1);
DECLARE VARIABLE CESTOQTIPOMOV CHAR(1);
DECLARE VARIABLE CESTIPOMOVOLD CHAR(1);
DECLARE VARIABLE CESTOQTIPOMOVOLD CHAR(1);
begin
  /* Verifica se h alterao no tipo de movimento para reprocessamento de estoque */
  CALTTM = 'N';
  SELECT TM.ESTIPOMOV, TM.ESTOQTIPOMOV FROM EQTIPOMOV TM
     WHERE TM.CODEMP=:ICODEMP AND TM.CODFILIAL=:SCODFILIAL
      AND TM.CODTIPOMOV=:ICODTIPOMOV
     INTO :CESTIPOMOV, :CESTOQTIPOMOV;

  SELECT TM.ESTIPOMOV, TM.ESTOQTIPOMOV FROM EQTIPOMOV TM
     WHERE TM.CODEMP=:ICODEMPOLD AND TM.CODFILIAL=:SCODFILIALOLD
      AND TM.CODTIPOMOV=:ICODTIPOMOVOLD
     INTO :CESTIPOMOVOLD, :CESTOQTIPOMOVOLD;

  if ( (CESTIPOMOV!=CESTIPOMOVOLD) OR (CESTOQTIPOMOV!=CESTOQTIPOMOVOLD) OR
       (CESTIPOMOVOLD IS NULL) OR (CESTOQTIPOMOVOLD IS NULL)  ) then
     CALTTM = 'S';
  suspend;
end ^

ALTER PROCEDURE EQMOVPRODCSLDSP (ICODEMPTM INTEGER,
SCODFILIALTM SMALLINT,
ICODTIPOMOV INTEGER,
NQTDMOVPROD NUMERIC(15, 5),
NPRECOMOVPROD NUMERIC(15, 5),
NCUSTOMPMMOVPROD NUMERIC(15, 5),
NSLDMOVPROD NUMERIC(15, 5),
ESTOQTIPOMOVPD CHAR(1),
TIPONF CHAR(1))
RETURNS (NCUSTOMPM NUMERIC(15, 5),
NSALDO NUMERIC(15, 5),
CESTOQMOVPROD CHAR(1),
CTIPOMOVPROD CHAR(1),
SOPERADOR SMALLINT)
AS 

begin
  /* Procedure que retorna o clculo de custo e saldo */
  NCUSTOMPM = 0;
  NSALDO = 0;
  SELECT CESTIPOMOV, SOPERADOR
     FROM EQMOVPRODCKTMSP( :ICODEMPTM, :SCODFILIALTM, :ICODTIPOMOV, :ESTOQTIPOMOVPD)
     INTO :CTIPOMOVPROD, :SOPERADOR;
  if (SOPERADOR=0) then
  begin
     CESTOQMOVPROD = 'N';
     NSALDO = NSLDMOVPROD;
  end
  else
  begin  /* verifica se  para controlar estoque */
     CESTOQMOVPROD = 'S';
     NSALDO = NSLDMOVPROD + CAST ( (NQTDMOVPROD * SOPERADOR) AS NUMERIC(15, 5) );
  end
  if ( (NSALDO >= NSLDMOVPROD) AND (NSALDO > 0) AND (SOPERADOR>0 OR CTIPOMOVPROD='E') ) then
  begin
    if ( (NSLDMOVPROD * NCUSTOMPMMOVPROD)  <= 0) then
       NCUSTOMPM = NPRECOMOVPROD;
    else
    begin
       if (tiponf='C') then
          NCUSTOMPM = cast(NPRECOMOVPROD * NQTDMOVPROD / NSLDMOVPROD as numeric(15,5) ) + NCUSTOMPMMOVPROD   ;
       else
          NCUSTOMPM = ( cast(NSLDMOVPROD * NCUSTOMPMMOVPROD as numeric(15,5) ) +
          cast(NQTDMOVPROD * NPRECOMOVPROD as numeric(15,5)) ) / (NSLDMOVPROD + NQTDMOVPROD) ;
    end
  end
  else
      NCUSTOMPM = NCUSTOMPMMOVPROD;

  suspend;
end ^

ALTER PROCEDURE EQMOVPRODDSP (ICODEMPPD INTEGER,
SCODFILIALPD SMALLINT,
ICODPROD INTEGER,
ICODEMPIV INTEGER,
SCODFILIALIV SMALLINT,
ICODINVPROD INTEGER,
ICODEMPCP INTEGER,
SCODFILIALCP SMALLINT,
ICODCOMPRA INTEGER,
SCODITCOMPRA SMALLINT,
ICODEMPVD INTEGER,
SCODFILIALVD SMALLINT,
CTIPOVENDA CHAR(1),
ICODVENDA INTEGER,
SCODITVENDA SMALLINT,
ICODEMPRM INTEGER,
SCODFILIALRM SMALLINT,
ICODRMA INTEGER,
SCODITRMA SMALLINT,
ICODEMPOP INTEGER,
SCODFILIALOP SMALLINT,
ICODOP INTEGER,
SSEQOP SMALLINT,
SSEQENTOP SMALLINT,
DDTMOVPROD DATE,
ICODEMPAX INTEGER,
SCODFILIALAX SMALLINT,
ICODALMOX INTEGER,
CMULTIALMOX CHAR(1),
SEQSUBPROD SMALLINT,
TIPONF CHAR(1))
AS 
 
declare variable icodemp integer;
declare variable scodfilial smallint;
declare variable icodmovprod integer;
declare variable nsldmovprod numeric(15,5);
declare variable ncustompmmovprod numeric(15,5);
declare variable nsldmovprodax numeric(15,5);
declare variable ncustompmmovprodax numeric(15,5);
begin
  /* Procedure de deleo da tabela eqmovprod */
  SELECT ICODEMP, SCODFILIAL, ICODMOVPROD
  FROM EQMOVPRODRETCODSP(:ICODEMPIV, :SCODFILIALIV, :ICODINVPROD, :ICODEMPCP,
    :SCODFILIALCP, :ICODCOMPRA, :SCODITCOMPRA, :ICODEMPVD, :SCODFILIALVD,
    :CTIPOVENDA, :ICODVENDA, :SCODITVENDA, :ICODEMPRM, :SCODFILIALRM, :ICODRMA,
    :SCODITRMA, :ICODEMPOP,  :SCODFILIALOP,  :ICODOP, :SSEQOP, :sseqentop, :seqsubprod)
    INTO :ICODEMP, :SCODFILIAL, :ICODMOVPROD;

  SELECT NSALDO, NCUSTOMPM, NSALDOAX, NCUSTOMPMAX
  FROM EQMOVPRODSLDSP(:ICODEMP, :SCODFILIAL, :ICODMOVPROD,
   :ICODEMPPD, :SCODFILIALPD, :ICODPROD, :DDTMOVPROD, 0, 0,
   :ICODEMPAX, :SCODFILIALAX, :ICODALMOX, :CMULTIALMOX)
     INTO :NSLDMOVPROD, :NCUSTOMPMMOVPROD, :NSLDMOVPRODAX, :NCUSTOMPMMOVPRODAX  ;

  /* DELETAR EQMOVPROD */
  DELETE FROM EQMOVPROD WHERE CODEMP=:ICODEMP AND CODFILIAL=:SCODFILIAL
    AND CODMOVPROD=:ICODMOVPROD;

  /* REPROCESSAR ESTOQUE */
  SELECT NSLDPRC, NCUSTOMPMPRC, NSLDPRCAX, NCUSTOMPMPRCAX
    FROM EQMOVPRODPRCSLDSP( :SCODFILIAL, :ICODMOVPROD, :ICODEMPPD,
      :SCODFILIALPD, :ICODPROD, :DDTMOVPROD, null, :NSLDMOVPROD, :NCUSTOMPMMOVPROD,
      :NSLDMOVPRODAX, :NCUSTOMPMMOVPRODAX, :ICODEMPAX, :SCODFILIALAX, :ICODALMOX,
      :CMULTIALMOX, :TIPONF)
    INTO :NSLDMOVPROD, :NCUSTOMPMMOVPROD, :NSLDMOVPRODAX, :NCUSTOMPMMOVPRODAX;

  /* ATUALIZA CUSTO NO CADASTRO DE PRODUTOS
   OPERADOR 1 PARA EFETUAR A ATUALIZAO SEMPRE
  EXECUTE PROCEDURE EQMOVPRODATCUSTSP( 1, :ICODEMP, :SCODFILIAL,
   :ICODMOVPROD,  :SCODFILIALPD, :ICODPROD, :DDTMOVPROD, 0);
   */

  suspend;
end ^

ALTER PROCEDURE EQMOVPRODISP (ICODEMPPD INTEGER,
SCODFILIALPD SMALLINT,
ICODPROD INTEGER,
ICODEMPLE INTEGER,
SCODFILIALLE SMALLINT,
CCODLOTE VARCHAR(20),
ICODEMPTM INTEGER,
SCODFILIALTM SMALLINT,
ICODTIPOMOV INTEGER,
ICODEMPIV INTEGER,
SCODFILIALIV SMALLINT,
ICODINVPROD INTEGER,
ICODEMPCP INTEGER,
SCODFILIALCP SMALLINT,
ICODCOMPRA INTEGER,
SCODITCOMPRA SMALLINT,
ICODEMPVD INTEGER,
SCODFILIALVD SMALLINT,
CTIPOVENDA CHAR(1),
ICODVENDA INTEGER,
SCODITVENDA SMALLINT,
ICODEMPRM INTEGER,
SCODFILIALRM SMALLINT,
ICODRMA INTEGER,
SCODITRMA SMALLINT,
ICODEMPOP INTEGER,
SCODFILIALOP SMALLINT,
ICODOP INTEGER,
SSEQOP SMALLINT,
SSEQENTOP SMALLINT,
ICODEMPNT INTEGER,
SCODFILIALNT SMALLINT,
CCODNAT CHAR(4),
DDTMOVPROD DATE,
IDOCMOVPROD INTEGER,
CFLAG CHAR(1),
NQTDMOVPROD NUMERIC(15, 5),
NPRECOMOVPROD NUMERIC(15, 5),
ICODEMPAX INTEGER,
SCODFILIALAX SMALLINT,
ICODALMOX INTEGER,
CMULTIALMOX CHAR(1),
SEQSUBPROD SMALLINT,
ESTOQTIPOMOVPD CHAR(1),
TIPONF CHAR(1))
AS 
 
declare variable scodfilial smallint;
declare variable icodmovprod integer;
declare variable cestoqmovprod char(1);
declare variable ctipomovprod char(1);
declare variable nsldmovprod numeric(15,5);
declare variable ncustompmmovprod numeric(15,5);
declare variable soperador smallint;
declare variable nsldmovprodax numeric(15,5);
declare variable ncustompmmovprodax numeric(15,5);
begin
  /* Procedure de insero na tabela eqmovprod */

  SELECT NSALDO, NCUSTOMPM, NSALDOAX, NCUSTOMPMAX FROM EQMOVPRODSLDSP(null, null, null, :ICODEMPPD,
     :SCODFILIALPD, :ICODPROD, :DDTMOVPROD, :NPRECOMOVPROD, :NPRECOMOVPROD,
     :ICODEMPAX, :SCODFILIALAX, :ICODALMOX, :CMULTIALMOX )
     INTO :NSLDMOVPROD, :NCUSTOMPMMOVPROD, :NSLDMOVPRODAX, :NCUSTOMPMMOVPRODAX ;

  /* Verifica se haver mudana de saldo*/
  SELECT NSALDO, NCUSTOMPM, CESTOQMOVPROD, CTIPOMOVPROD, SOPERADOR FROM EQMOVPRODCSLDSP(:ICODEMPTM, :SCODFILIALTM,
      :ICODTIPOMOV, :NQTDMOVPROD, :NPRECOMOVPROD, :NCUSTOMPMMOVPROD, :NSLDMOVPROD, :ESTOQTIPOMOVPD, :TIPONF)
      INTO :NSLDMOVPROD, :NCUSTOMPMMOVPROD, :CESTOQMOVPROD, :CTIPOMOVPROD, :SOPERADOR;

  if (CMULTIALMOX='N') then
  begin
     NSLDMOVPRODAX = NSLDMOVPROD;
     NCUSTOMPMMOVPRODAX = NCUSTOMPMMOVPROD;
  end
  else
  begin
      SELECT NSALDO, NCUSTOMPM FROM EQMOVPRODCSLDSP(:ICODEMPTM, :SCODFILIALTM,
          :ICODTIPOMOV, :NQTDMOVPROD, :NPRECOMOVPROD, :NCUSTOMPMMOVPRODAX, :NSLDMOVPRODAX, :ESTOQTIPOMOVPD, :TIPONF)
        INTO :NSLDMOVPRODAX, :NCUSTOMPMMOVPRODAX;
  end

  SELECT SCODFILIAL, ICODMOVPROD FROM EQMOVPRODSEQSP(:ICODEMPPD)
     INTO :SCODFILIAL, :ICODMOVPROD;  /* encontra o prximo cdigo e a filial*/

   INSERT INTO EQMOVPROD ( CODEMP, CODFILIAL, CODMOVPROD,
      CODEMPPD, CODFILIALPD , CODPROD , CODEMPLE ,
      CODFILIALLE , CODLOTE , CODEMPTM, CODFILIALTM,
      CODTIPOMOV, CODEMPIV , CODFILIALIV , CODINVPROD ,
      CODEMPCP , CODFILIALCP , CODCOMPRA , CODITCOMPRA , CODEMPVD ,
      CODFILIALVD , TIPOVENDA , CODVENDA , CODITVENDA , CODEMPRM ,
      CODFILIALRM , CODRMA , CODITRMA ,
      CODEMPOP, CODFILIALOP, CODOP, SEQOP, SEQENTOP,
      CODEMPNT , CODFILIALNT ,
      CODNAT , DTMOVPROD , DOCMOVPROD , FLAG , QTDMOVPROD ,
      PRECOMOVPROD, ESTOQMOVPROD, TIPOMOVPROD, SLDMOVPROD, CUSTOMPMMOVPROD,
      SLDMOVPRODAX, CUSTOMPMMOVPRODAX, CODEMPAX, CODFILIALAX, CODALMOX, seqsubprod )
   VALUES ( :ICODEMPPD, :SCODFILIAL, :ICODMOVPROD,
    :ICODEMPPD , :SCODFILIALPD , :ICODPROD , :ICODEMPLE ,
    :SCODFILIALLE , :CCODLOTE , :ICODEMPTM, :SCODFILIALTM,
    :ICODTIPOMOV, :ICODEMPIV , :SCODFILIALIV ,
    :ICODINVPROD , :ICODEMPCP , :SCODFILIALCP , :ICODCOMPRA ,
    :SCODITCOMPRA , :ICODEMPVD , :SCODFILIALVD , :CTIPOVENDA ,
    :ICODVENDA , :SCODITVENDA , :ICODEMPRM , :SCODFILIALRM ,
    :ICODRMA , :SCODITRMA , :ICODEMPOP, :SCODFILIALOP, :ICODOP, :SSEQOP, :sseqentop,
    :ICODEMPNT , :SCODFILIALNT , :CCODNAT ,
    :DDTMOVPROD , :IDOCMOVPROD , :CFLAG , :NQTDMOVPROD ,
    :NPRECOMOVPROD, :CESTOQMOVPROD, :CTIPOMOVPROD, :NSLDMOVPROD, :NCUSTOMPMMOVPROD,
    :NSLDMOVPRODAX,  :NCUSTOMPMMOVPRODAX, :ICODEMPAX, :SCODFILIALAX, :ICODALMOX, :seqsubprod );

  /* REPROCESSAR ESTOQUE */

  SELECT NSLDPRC, NCUSTOMPMPRC, NSLDPRCAX, NCUSTOMPMPRCAX
    FROM EQMOVPRODPRCSLDSP( :SCODFILIAL, :ICODMOVPROD, :ICODEMPPD,
     :SCODFILIALPD, :ICODPROD, :DDTMOVPROD, null, :NSLDMOVPROD, :NCUSTOMPMMOVPROD,
     :NSLDMOVPRODAX, :NCUSTOMPMMOVPRODAX, :ICODEMPAX, :SCODFILIALAX, :ICODALMOX,
     :CMULTIALMOX, :TIPONF)
    INTO :NSLDMOVPROD, :NCUSTOMPMMOVPROD, :NSLDMOVPRODAX, :NCUSTOMPMMOVPRODAX ;

 /* ATUALIZA O CUSTO NO CADASTRO DE PRODUTOS
   EXECUTE PROCEDURE EQMOVPRODATCUSTSP(:SOPERADOR, :ICODEMPPD, :SCODFILIAL,
    :ICODMOVPROD, :SCODFILIALPD, :ICODPROD, :DDTMOVPROD, :NCUSTOMPMMOVPROD); 
 */


  suspend;
end ^

ALTER PROCEDURE EQMOVPRODIUDSP (CIUD CHAR(1),
ICODEMPPD INTEGER,
SCODFILIALPD SMALLINT,
ICODPROD INTEGER,
ICODEMPLE INTEGER,
SCODFILIALLE SMALLINT,
CCODLOTE VARCHAR(20),
ICODEMPTM INTEGER,
SCODFILIALTM SMALLINT,
ICODTIPOMOV INTEGER,
ICODEMPIV INTEGER,
SCODFILIALIV SMALLINT,
ICODINVPROD INTEGER,
ICODEMPCP INTEGER,
SCODFILIALCP SMALLINT,
ICODCOMPRA INTEGER,
SCODITCOMPRA SMALLINT,
ICODEMPVD INTEGER,
SCODFILIALVD SMALLINT,
CTIPOVENDA CHAR(1),
ICODVENDA INTEGER,
SCODITVENDA SMALLINT,
ICODEMPRM INTEGER,
SCODFILIALRM SMALLINT,
ICODRMA INTEGER,
SCODITRMA SMALLINT,
ICODEMPOP INTEGER,
SCODFILIALOP SMALLINT,
ICODOP INTEGER,
SSEQOP SMALLINT,
SSEQENTOP SMALLINT,
ICODEMPNT INTEGER,
SCODFILIALNT SMALLINT,
CCODNAT CHAR(4),
DDTMOVPROD DATE,
IDOCMOVPROD INTEGER,
CFLAG CHAR(1),
NQTDMOVPROD NUMERIC(15, 5),
NPRECOMOVPROD NUMERIC(15, 5),
ICODEMPAX INTEGER,
SCODFILIALAX SMALLINT,
ICODALMOX INTEGER,
SEQSUBPROD SMALLINT,
ESTOQTIPOMOVPD CHAR(1),
TIPONF CHAR(1))
AS 
 
declare variable cmultialmox char(1);
begin
  /* Procedure que controle INSERT, UPDATE E DELETE da tabela eqmovprod */

  /* Linha incluida para passar como parmetro se  multi almoxarifado
      Como o objetivo de evitar I/O
  */
  SELECT CMULTIALMOX FROM SGRETMULTIALMOXSP(:ICODEMPPD) INTO :CMULTIALMOX;
  
  if (CIUD='I') then /* SE FOR INSERT */
     execute procedure EQMOVPRODISP( ICODEMPPD, SCODFILIALPD, ICODPROD,
         ICODEMPLE, SCODFILIALLE, CCODLOTE, ICODEMPTM, SCODFILIALTM, ICODTIPOMOV,
         ICODEMPIV, SCODFILIALIV, ICODINVPROD, ICODEMPCP, SCODFILIALCP, ICODCOMPRA,
         SCODITCOMPRA, ICODEMPVD, SCODFILIALVD, CTIPOVENDA, ICODVENDA, SCODITVENDA,
         ICODEMPRM, SCODFILIALRM, ICODRMA, SCODITRMA,
         ICODEMPOP, SCODFILIALOP, ICODOP, SSEQOP, sseqentop,
         ICODEMPNT, SCODFILIALNT,
         CCODNAT, DDTMOVPROD, IDOCMOVPROD, CFLAG, NQTDMOVPROD, NPRECOMOVPROD,
         ICODEMPAX, SCODFILIALAX, ICODALMOX, CMULTIALMOX, :seqsubprod, :estoqtipomovpd, :tiponf);
  else if (CIUD='U') then
     execute procedure EQMOVPRODUSP( ICODEMPPD, SCODFILIALPD, ICODPROD,
         ICODEMPLE, SCODFILIALLE, CCODLOTE, ICODEMPTM, SCODFILIALTM, ICODTIPOMOV,
         ICODEMPIV, SCODFILIALIV, ICODINVPROD, ICODEMPCP, SCODFILIALCP, ICODCOMPRA,
         SCODITCOMPRA, ICODEMPVD, SCODFILIALVD, CTIPOVENDA, ICODVENDA, SCODITVENDA,
         ICODEMPRM, SCODFILIALRM, ICODRMA, SCODITRMA,
         ICODEMPOP, SCODFILIALOP, ICODOP, SSEQOP, sseqentop,
         ICODEMPNT, SCODFILIALNT,
         CCODNAT, DDTMOVPROD, IDOCMOVPROD, CFLAG, NQTDMOVPROD, NPRECOMOVPROD,
         ICODEMPAX, SCODFILIALAX, ICODALMOX, CMULTIALMOX,:seqsubprod, :estoqtipomovpd, :tiponf);
  else if (CIUD='D') then
     execute procedure EQMOVPRODDSP( ICODEMPPD, SCODFILIALPD, ICODPROD, ICODEMPIV,
         SCODFILIALIV, ICODINVPROD, ICODEMPCP, SCODFILIALCP, ICODCOMPRA, SCODITCOMPRA,
         ICODEMPVD, SCODFILIALVD, CTIPOVENDA, ICODVENDA, SCODITVENDA,
         ICODEMPRM, SCODFILIALRM, ICODRMA, SCODITRMA,
         ICODEMPOP, SCODFILIALOP, ICODOP, SSEQOP, sseqentop,
         DDTMOVPROD, ICODEMPAX, SCODFILIALAX, ICODALMOX, CMULTIALMOX, :seqsubprod, :tiponf );
--  suspend;
end ^

ALTER PROCEDURE EQMOVPRODPRCSLDSP (SCODFILIAL SMALLINT,
ICODMOVPROD INTEGER,
ICODEMPPD INTEGER,
SCODFILIALPD SMALLINT,
ICODPROD INTEGER,
DDTMOVPROD DATE,
DDTMOVPRODPRC DATE,
NSLDMOVPROD NUMERIC(15, 5),
NCUSTOMPMMOVPROD NUMERIC(15, 5),
NSLDMOVPRODAX NUMERIC(15, 5),
NCUSTOMPMMOVPRODAX NUMERIC(15, 5),
ICODEMPAX INTEGER,
SCODFILIALAX SMALLINT,
ICODALMOX INTEGER,
CMULTIALMOX CHAR(1),
TIPONF CHAR(1))
RETURNS (NSLDPRC NUMERIC(15, 5),
NCUSTOMPMPRC NUMERIC(15, 5),
NSLDPRCAX NUMERIC(15, 5),
NCUSTOMPMPRCAX NUMERIC(15, 5),
ESTOQTIPOMOVPD CHAR(1))
AS 

declare variable icodemptm integer;
declare variable scodfilialtm smallint;
declare variable icodtipomov integer;
declare variable nqtdmovprod numeric(15,5);
declare variable nprecomovprod numeric(15,5);
declare variable icodmovprodprc integer;
declare variable cestoqmovprod char(1);
declare variable icodempaxprc integer;
declare variable scodfilialaxprc smallint;
declare variable icodalmoxprc integer;
begin
  /* Procedure de processamento de estoque */
  FOR SELECT MP.CODEMPTM, MP.CODFILIALTM, MP.CODTIPOMOV ,
    MP.QTDMOVPROD, MP.PRECOMOVPROD , MP.CODMOVPROD,
    MP.CODEMPAX, MP.CODFILIALAX, MP.CODALMOX, MP.ESTOQMOVPROD
    FROM EQMOVPROD MP
    WHERE MP.CODEMPPD=:ICODEMPPD AND MP.CODFILIALPD=:SCODFILIALPD AND
       MP.CODPROD=:ICODPROD AND MP.CODEMP=:ICODEMPPD AND MP.CODFILIAL=:SCODFILIAL AND
       ( (MP.DTMOVPROD = :DDTMOVPROD AND MP.CODMOVPROD > :ICODMOVPROD) OR
         (MP.DTMOVPROD>:DDTMOVPROD) ) AND  /* ALTEREI AQUI */
       ( (:DDTMOVPRODPRC IS NULL /* AND MP.CODMOVPROD!=:ICODMOVPROD */) OR
         (MP.DTMOVPROD = :DDTMOVPRODPRC AND MP.CODMOVPROD < :ICODMOVPROD) OR
         (MP.DTMOVPROD < :DDTMOVPRODPRC) )
    ORDER BY MP.DTMOVPROD, MP.CODMOVPROD
    INTO :ICODEMPTM, :SCODFILIALTM, :ICODTIPOMOV,
     :NQTDMOVPROD, :NPRECOMOVPROD, :ICODMOVPRODPRC,
     :ICODEMPAXPRC, :SCODFILIALAXPRC, :ICODALMOXPRC, :ESTOQTIPOMOVPD DO
  BEGIN
      SELECT NSALDO, NCUSTOMPM, CESTOQMOVPROD FROM EQMOVPRODCSLDSP(:ICODEMPTM, :SCODFILIALTM,
        :ICODTIPOMOV, :NQTDMOVPROD, :NPRECOMOVPROD, :NCUSTOMPMMOVPROD, :NSLDMOVPROD, :ESTOQTIPOMOVPD, :TIPONF)
      INTO :NSLDMOVPROD, :NCUSTOMPMMOVPROD, :CESTOQMOVPROD;
      if (CMULTIALMOX='N') then /* Se no for multi almoxarifado*/
      begin
         NSLDMOVPRODAX = NSLDMOVPROD;
         NCUSTOMPMMOVPRODAX = NCUSTOMPMMOVPROD;
         UPDATE EQMOVPROD SET SLDMOVPROD=:NSLDMOVPROD, CUSTOMPMMOVPROD=:NCUSTOMPMMOVPROD,
            SLDMOVPRODAX=:NSLDMOVPRODAX, CUSTOMPMMOVPRODAX=:NCUSTOMPMMOVPRODAX,
            ESTOQMOVPROD=:CESTOQMOVPROD
            WHERE CODEMP=:ICODEMPPD AND CODFILIAL=:SCODFILIAL AND CODMOVPROD=:ICODMOVPRODPRC;
      end
      else if (ICODEMPAX=ICODEMPAXPRC AND SCODFILIALAX=SCODFILIALAXPRC AND
          ICODALMOX=ICODALMOXPRC) then
          /* Se for multi almoxarifado e o cdigo do almoxarifado for o mesmo*/
      begin
        SELECT NSALDO, NCUSTOMPM FROM EQMOVPRODCSLDSP(:ICODEMPTM, :SCODFILIALTM,
            :ICODTIPOMOV, :NQTDMOVPROD, :NPRECOMOVPROD, :NCUSTOMPMMOVPRODAX, :NSLDMOVPRODAX, :ESTOQTIPOMOVPD, :TIPONF)
            INTO :NSLDMOVPRODAX, :NCUSTOMPMMOVPRODAX;
        UPDATE EQMOVPROD SET SLDMOVPROD=:NSLDMOVPROD, CUSTOMPMMOVPROD=:NCUSTOMPMMOVPROD,
            SLDMOVPRODAX=:NSLDMOVPRODAX, CUSTOMPMMOVPRODAX=:NCUSTOMPMMOVPRODAX,
            ESTOQMOVPROD=:CESTOQMOVPROD
            WHERE CODEMP=:ICODEMPPD AND CODFILIAL=:SCODFILIAL AND CODMOVPROD=:ICODMOVPRODPRC;
      end
      else /* Se for multi almoxarifado no atualiza almoxarifado diferente */
      begin
        UPDATE EQMOVPROD SET SLDMOVPROD=:NSLDMOVPROD, CUSTOMPMMOVPROD=:NCUSTOMPMMOVPROD,
            ESTOQMOVPROD=:CESTOQMOVPROD
            WHERE CODEMP=:ICODEMPPD AND CODFILIAL=:SCODFILIAL AND CODMOVPROD=:ICODMOVPRODPRC;
      end
      NSLDPRC = NSLDMOVPROD;
      NCUSTOMPMPRC = NCUSTOMPMMOVPROD;
      NSLDPRCAX = NSLDMOVPRODAX;
      NCUSTOMPMPRCAX = NCUSTOMPMMOVPRODAX;
  END
  suspend;
end ^

ALTER PROCEDURE EQMOVPRODRETCODSP (ICODEMPIV INTEGER,
SCODFILIALIV SMALLINT,
ICODINVPROD INTEGER,
ICODEMPCP INTEGER,
SCODFILIALCP SMALLINT,
ICODCOMPRA INTEGER,
SCODITCOMPRA SMALLINT,
ICODEMPVD INTEGER,
SCODFILIALVD SMALLINT,
CTIPOVENDA CHAR(1),
ICODVENDA INTEGER,
SCODITVENDA SMALLINT,
ICODEMPRM INTEGER,
SCODFILIALRM SMALLINT,
ICODRMA INTEGER,
SCODITRMA SMALLINT,
ICODEMPOP INTEGER,
SCODFILIALOP SMALLINT,
ICODOP INTEGER,
SSEQOP SMALLINT,
SSEQOPENT SMALLINT,
SEQSUBPROD SMALLINT)
RETURNS (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODMOVPROD INTEGER)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

begin
  /* Retorna o cdigo do movimento de estoque */
  if (ICODINVPROD IS NOT NULL) then
     SELECT MP.CODEMP, MP.CODFILIAL, MP.CODMOVPROD FROM EQMOVPROD MP
       WHERE MP.CODEMPIV=:ICODEMPIV AND MP.CODFILIALIV=:SCODFILIALIV
         AND MP.CODINVPROD=:ICODINVPROD
       INTO  :ICODEMP, :SCODFILIAL, :ICODMOVPROD;
  else if (ICODCOMPRA IS NOT NULL) then
     SELECT MP.CODEMP, MP.CODFILIAL, MP.CODMOVPROD FROM EQMOVPROD MP
       WHERE MP.CODEMPCP=:ICODEMPCP AND MP.CODFILIALCP=:SCODFILIALCP
         AND MP.CODCOMPRA=:ICODCOMPRA AND MP.CODITCOMPRA=:SCODITCOMPRA
       INTO  :ICODEMP, :SCODFILIAL, :ICODMOVPROD;
  else if (ICODVENDA IS NOT NULL) then
     SELECT MP.CODEMP, MP.CODFILIAL, MP.CODMOVPROD FROM EQMOVPROD MP
       WHERE MP.CODEMPVD=:ICODEMPVD AND MP.CODFILIALVD=:SCODFILIALVD
         AND MP.TIPOVENDA=:CTIPOVENDA AND MP.CODVENDA=:ICODVENDA
         AND MP.CODITVENDA=:SCODITVENDA
       INTO  :ICODEMP, :SCODFILIAL, :ICODMOVPROD;
  else if (ICODRMA IS NOT NULL) then
     SELECT MP.CODEMP, MP.CODFILIAL, MP.CODMOVPROD FROM EQMOVPROD MP
       WHERE MP.CODEMPRM=:ICODEMPRM AND MP.CODFILIALRM=:SCODFILIALRM
         AND MP.CODRMA=:ICODRMA AND MP.CODITRMA=:SCODITRMA
       INTO  :ICODEMP, :SCODFILIAL, :ICODMOVPROD;
  else if (ICODOP IS NOT NULL) then
     begin

        if( :sseqopent is not null ) then
        begin
            SELECT MP.CODEMP, MP.CODFILIAL, MP.CODMOVPROD FROM EQMOVPROD MP
            WHERE MP.CODEMPOP=:ICODEMPOP AND MP.CODFILIALOP=:SCODFILIALOP
            AND MP.CODOP=:ICODOP AND MP.SEQOP=:SSEQOP AND MP.seqentop=:sseqopent
            INTO  :ICODEMP, :SCODFILIAL, :ICODMOVPROD;
        end
        else if (:seqsubprod is not null) then
        begin
            SELECT MP.CODEMP, MP.CODFILIAL, MP.CODMOVPROD FROM EQMOVPROD MP
            WHERE MP.CODEMPOP=:ICODEMPOP AND MP.CODFILIALOP=:SCODFILIALOP
            AND MP.CODOP=:ICODOP AND MP.SEQOP=:SSEQOP AND MP.seqsubprod=:seqsubprod
            INTO  :ICODEMP, :SCODFILIAL, :ICODMOVPROD;

        end
        else
        begin
            SELECT MP.CODEMP, MP.CODFILIAL, MP.CODMOVPROD FROM EQMOVPROD MP
            WHERE MP.CODEMPOP=:ICODEMPOP AND MP.CODFILIALOP=:SCODFILIALOP
            AND MP.CODOP=:ICODOP AND MP.SEQOP=:SSEQOP and mp.seqentop is null and mp.seqsubprod is null
            INTO  :ICODEMP, :SCODFILIAL, :ICODMOVPROD;

        end
    end



  suspend;
end ^

ALTER PROCEDURE EQMOVPRODSEQSP (ICODEMP INTEGER)
RETURNS (SCODFILIAL SMALLINT,
ICODMOVPROD INTEGER)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

begin
  /* Busca o cdigo sequencial da tabela eqmovprod */
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP, 'EQMOVPROD') INTO :SCODFILIAL ;
  SELECT ISEQ FROM SPGERANUM(:ICODEMP, :SCODFILIAL, 'MP' ) INTO :ICODMOVPROD ;
  suspend;
end ^

ALTER PROCEDURE EQMOVPRODSLDSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODMOVPROD INTEGER,
ICODEMPPD INTEGER,
SCODFILIALPD SMALLINT,
ICODPROD INTEGER,
DDTMOVPROD DATE,
NCUSTOMPMMOVPROD NUMERIC(15, 5),
NCUSTOMPMMOVPRODAX NUMERIC(15, 5),
ICODEMPAX INTEGER,
SCODFILIALAX SMALLINT,
ICODALMOX INTEGER,
CMULTIALMOX CHAR(1))
RETURNS (NSALDO NUMERIC(15, 5),
NCUSTOMPM NUMERIC(15, 5),
ICODMOVPRODSLD INTEGER,
NSALDOAX NUMERIC(15, 5),
NCUSTOMPMAX NUMERIC(15, 5),
ICODMOVPRODSLDAX INTEGER)
AS 
 
begin
  /* Procedure que busca saldo e custo mdio */
  NSALDO = 0;
  NCUSTOMPM = 0;
  if (NCUSTOMPMMOVPROD IS NULL) then
     NCUSTOMPMMOVPROD = 0;
  if (ICODMOVPROD IS NULL) then
     SELECT FIRST 1 M.SLDMOVPROD, M.CUSTOMPMMOVPROD, M.CODMOVPROD
        FROM EQMOVPROD M
        WHERE M.CODEMPPD = :ICODEMPPD AND
          M.CODFILIALPD = :SCODFILIALPD AND
          M.CODPROD = :ICODPROD AND
          M.DTMOVPROD <= :DDTMOVPROD
        ORDER BY M.DTMOVPROD DESC, M.CODMOVPROD DESC
        INTO :NSALDO, :NCUSTOMPM, :ICODMOVPRODSLD;
   else
     SELECT FIRST 1 M.SLDMOVPROD, M.CUSTOMPMMOVPROD, M.CODMOVPROD
        FROM EQMOVPROD M
        WHERE M.CODEMP = :ICODEMP AND
          M.CODFILIAL = :SCODFILIAL AND
          M.CODEMPPD = :ICODEMPPD AND
          M.CODFILIALPD = :SCODFILIALPD AND
          M.CODPROD = :ICODPROD AND
          ( (M.DTMOVPROD = :DDTMOVPROD AND M.CODMOVPROD < :ICODMOVPROD ) OR
            (M.DTMOVPROD < :DDTMOVPROD ) )
        ORDER BY M.DTMOVPROD DESC, M.CODMOVPROD DESC
        INTO :NSALDO, :NCUSTOMPM, :ICODMOVPRODSLD;
  if (NSALDO IS NULL) then
     NSALDO = 0;
  if (NCUSTOMPM IS NULL) then
     NCUSTOMPM = NCUSTOMPMMOVPROD;

  if (CMULTIALMOX='N') then
  begin
      NSALDOAX = NSALDO;
      NCUSTOMPMAX = NCUSTOMPM;
      ICODMOVPRODSLDAX = ICODMOVPRODSLD;
  end
  else
  begin
      NSALDOAX = 0;
      NCUSTOMPMAX = 0;
      if (NCUSTOMPMMOVPRODAX IS NULL) then
         NCUSTOMPMMOVPRODAX = 0;
      if (ICODMOVPROD IS NULL) then
         SELECT FIRST 1 M.SLDMOVPRODAX, M.CUSTOMPMMOVPROD, M.CODMOVPROD
            FROM EQMOVPROD M
            WHERE M.CODEMPPD = :ICODEMPPD AND
              M.CODFILIALPD = :SCODFILIALPD AND
              M.CODPROD = :ICODPROD AND
              M.DTMOVPROD <= :DDTMOVPROD AND
              M.CODEMPAX = :ICODEMPAX AND
              M.CODFILIALAX = :SCODFILIALAX AND
              M.CODALMOX= :ICODALMOX
            ORDER BY M.DTMOVPROD DESC, M.CODMOVPROD DESC
            INTO :NSALDOAX, :NCUSTOMPMAX, :ICODMOVPRODSLDAX;
       else
         SELECT FIRST 1 M.SLDMOVPRODAX, M.CUSTOMPMMOVPROD, M.CODMOVPROD
            FROM EQMOVPROD M
            WHERE M.CODEMP = :ICODEMP AND
              M.CODFILIAL = :SCODFILIAL AND
              M.CODEMPPD = :ICODEMPPD AND
              M.CODFILIALPD = :SCODFILIALPD AND
              M.CODPROD = :ICODPROD AND
              M.CODEMPAX = :ICODEMPAX AND
              M.CODFILIALAX = :SCODFILIALAX AND
              M.CODALMOX = :ICODALMOX AND
              ( (M.DTMOVPROD = :DDTMOVPROD AND M.CODMOVPROD < :ICODMOVPROD ) OR
                (M.DTMOVPROD < :DDTMOVPROD ) )
            ORDER BY M.DTMOVPROD DESC, M.CODMOVPROD DESC
            INTO :NSALDOAX, :NCUSTOMPMAX, :ICODMOVPRODSLDAX;
      if (NSALDOAX IS NULL) then
         NSALDOAX = 0;
      if (NCUSTOMPMAX IS NULL) then
         NCUSTOMPMAX = NCUSTOMPMMOVPROD;
  end
  suspend;
end ^

ALTER PROCEDURE EQMOVPRODUSP (ICODEMPPD INTEGER,
SCODFILIALPD SMALLINT,
ICODPROD INTEGER,
ICODEMPLE INTEGER,
SCODFILIALLE SMALLINT,
CCODLOTE VARCHAR(20),
ICODEMPTM INTEGER,
SCODFILIALTM SMALLINT,
ICODTIPOMOV INTEGER,
ICODEMPIV INTEGER,
SCODFILIALIV SMALLINT,
ICODINVPROD INTEGER,
ICODEMPCP INTEGER,
SCODFILIALCP SMALLINT,
ICODCOMPRA INTEGER,
SCODITCOMPRA SMALLINT,
ICODEMPVD INTEGER,
SCODFILIALVD SMALLINT,
CTIPOVENDA CHAR(1),
ICODVENDA INTEGER,
SCODITVENDA SMALLINT,
ICODEMPRM INTEGER,
SCODFILIALRM SMALLINT,
ICODRMA INTEGER,
SCODITRMA SMALLINT,
ICODEMPOP INTEGER,
SCODFILIALOP SMALLINT,
ICODOP INTEGER,
SSEQOP SMALLINT,
SSEQENTOP SMALLINT,
ICODEMPNT INTEGER,
SCODFILIALNT SMALLINT,
CCODNAT CHAR(4),
DDTMOVPROD DATE,
IDOCMOVPROD INTEGER,
CFLAG CHAR(1),
NQTDMOVPROD NUMERIC(15, 5),
NPRECOMOVPROD NUMERIC(15, 5),
ICODEMPAX INTEGER,
SCODFILIALAX SMALLINT,
ICODALMOX INTEGER,
CMULTIALMOX CHAR(1),
SEQSUBPROD BIGINT,
ESTOQTIPOMOVPD CHAR(1),
TIPONF CHAR(1))
AS 
 
declare variable icodemp integer;
declare variable scodfilial smallint;
declare variable icodmovprod integer;
declare variable nsldprc numeric(15,5);
declare variable ncustompmprc numeric(15,5);
declare variable nsldprcax numeric(15,5);
declare variable ncustompmprcax numeric(15,5);
declare variable nsldlc numeric(15,5);
declare variable ncustompmlc numeric(15,5);
declare variable nsldlcax numeric(15,5);
declare variable ncustompmlcax numeric(15,5);
declare variable ddtmovprodold date;
declare variable nprecomovprodold numeric(15,5);
declare variable nqtdmovprodold numeric(15,5);
declare variable icodemptmold integer;
declare variable scodfilialtmold smallint;
declare variable icodtipomovold integer;
declare variable calttm char(1);
declare variable ddtprc date;
declare variable ddtprcate date;
declare variable cestoqmovprod char(1);
begin
  /* Procedure de atualizao da tabela eqmovprod */

  DDTPRCATE = NULL; /* At onde deve ser processando o estoque */
 /* localiza movprod */

-- execute procedure sgdebugsp('antes da atualizao...','no inicio');

  SELECT ICODEMP, SCODFILIAL, ICODMOVPROD
    FROM EQMOVPRODRETCODSP(:ICODEMPIV, :SCODFILIALIV, :ICODINVPROD, :ICODEMPCP,
      :SCODFILIALCP, :ICODCOMPRA, :SCODITCOMPRA, :ICODEMPVD, :SCODFILIALVD,
      :CTIPOVENDA, :ICODVENDA, :SCODITVENDA, :ICODEMPRM, :SCODFILIALRM,
      :ICODRMA, :SCODITRMA, :ICODEMPOP, :SCODFILIALOP, :ICODOP, :SSEQOP, :sseqentop, :seqsubprod)
    INTO :ICODEMP, :SCODFILIAL, :ICODMOVPROD;

--  traz valores antigos

  SELECT MP.CODEMPTM, MP.CODFILIALTM, MP.CODTIPOMOV, MP.DTMOVPROD,
       MP.PRECOMOVPROD, MP.QTDMOVPROD  FROM EQMOVPROD MP
     WHERE MP.CODEMP=:ICODEMP AND MP.CODFILIAL=:SCODFILIAL AND MP.CODMOVPROD=:ICODMOVPROD
     INTO :ICODEMPTMOLD, :SCODFILIALTMOLD, :ICODTIPOMOVOLD, :DDTMOVPRODOLD,
       :NPRECOMOVPRODOLD, :NQTDMOVPRODOLD;

   /* abaixo verificao se a alterao de tipo de movimento mexe no estoque */
   SELECT CALTTM FROM EQMOVPRODCKUTMSP(:ICODEMPTM, :SCODFILIALTM, :ICODTIPOMOV,
      :ICODEMPTMOLD, :SCODFILIALTMOLD, :ICODTIPOMOVOLD) INTO :CALTTM;

   /* verifica se h relevncia para reprocessamento */
   if ( (DDTMOVPROD!=DDTMOVPRODOLD) OR (CALTTM='S') OR
        (NPRECOMOVPROD!=NPRECOMOVPRODOLD) OR (NQTDMOVPROD!=NQTDMOVPRODOLD) ) then
   begin

   -- execute procedure sgdebugsp('entrou no if','1');


      if ( DDTMOVPRODOLD IS NULL) then
         DDTMOVPRODOLD = DDTMOVPROD; /* garantir que a data antiga no e nula; */
      /* verifica qual data  menor para reprocessamento */
      if ( DDTMOVPROD<=DDTMOVPRODOLD ) then
      begin

     -- execute procedure sgdebugsp('entrou no if','2');

          DDTPRC = DDTMOVPROD;
          if (DDTMOVPROD=DDTMOVPRODOLD) then
             DDTPRCATE = null;
          else
             DDTPRCATE = DDTMOVPRODOLD;
/*          verifica lanamento anterior e traz custo e saldo */
          SELECT NSALDO, NCUSTOMPM, NSALDOAX, NCUSTOMPMAX
             FROM EQMOVPRODSLDSP(:ICODEMP, :SCODFILIAL, :ICODMOVPROD, :ICODEMPPD,
             :SCODFILIALPD, :ICODPROD, :DDTPRC, :NPRECOMOVPROD, :NPRECOMOVPROD,
             :ICODEMPAX, :SCODFILIALAX, :ICODALMOX, :CMULTIALMOX)
             INTO :NSLDPRC, :NCUSTOMPMPRC, :NSLDPRCAX, :NCUSTOMPMPRCAX ;

          /* verifica se havera mudana de saldo */
          SELECT NSALDO, NCUSTOMPM, CESTOQMOVPROD
              FROM EQMOVPRODCSLDSP(:ICODEMPTM, :SCODFILIALTM,
              :ICODTIPOMOV, :NQTDMOVPROD, :NPRECOMOVPROD, :NCUSTOMPMPRC, :NSLDPRC, :ESTOQTIPOMOVPD, :TIPONF)
              INTO :NSLDPRC, :NCUSTOMPMPRC, :CESTOQMOVPROD;
          if (CMULTIALMOX='N') then
          begin
              NSLDPRCAX = NSLDPRC;
              NCUSTOMPMPRCAX = NCUSTOMPMPRC;
          end
          else
          begin
          SELECT NSALDO, NCUSTOMPM
              FROM EQMOVPRODCSLDSP(:ICODEMPTM, :SCODFILIALTM,
              :ICODTIPOMOV, :NQTDMOVPROD, :NPRECOMOVPROD, :NCUSTOMPMPRCAX, :NSLDPRCAX, :ESTOQTIPOMOVPD, :TIPONF)
              INTO :NSLDPRCAX, :NCUSTOMPMPRCAX;
          end
          NCUSTOMPMLC = NCUSTOMPMPRC;
          NSLDLC = NSLDPRC;
          NCUSTOMPMLCAX = NCUSTOMPMPRCAX;
          NSLDLCAX = NSLDPRCAX;
      end
      else
      begin
          DDTPRC = DDTMOVPRODOLD;
          DDTPRCATE = DDTMOVPROD;
          /* verifica lanamento anterior e traz custo e saldo */

       --   execute procedure sgdebugsp('entrou no else','3');

          SELECT NSALDO, NCUSTOMPM, NSALDOAX, NCUSTOMPMAX
             FROM EQMOVPRODSLDSP(:ICODEMP, :SCODFILIAL, :ICODMOVPROD, :ICODEMPPD,
             :SCODFILIALPD, :ICODPROD, :DDTPRC, 0, 0,
             :ICODEMPAX, :SCODFILIALAX, :ICODALMOX, :CMULTIALMOX)
             INTO :NSLDPRC, :NCUSTOMPMPRC, :NSLDPRCAX, :NCUSTOMPMPRCAX ;

          /* verifica lanamento anterior e traz custo e saldo */
          SELECT NSALDO, NCUSTOMPM, NSALDOAX, NCUSTOMPMAX
             FROM EQMOVPRODSLDSP(:ICODEMP, :SCODFILIAL, :ICODMOVPROD, :ICODEMPPD,
             :SCODFILIALPD, :ICODPROD, :DDTMOVPROD, :NCUSTOMPMLC, :NCUSTOMPMLCAX,
             :ICODEMPAX, :SCODFILIALAX, :ICODALMOX, :CMULTIALMOX)
             INTO :NSLDLC, :NCUSTOMPMLC, :NSLDLCAX, :NCUSTOMPMLCAX ;

          /* verifica se havera mudana de saldo */
          SELECT NSALDO, NCUSTOMPM, CESTOQMOVPROD
              FROM EQMOVPRODCSLDSP(:ICODEMPTM, :SCODFILIALTM,
              :ICODTIPOMOV, (:NQTDMOVPROD-:NQTDMOVPRODOLD), :NPRECOMOVPROD,
              :NCUSTOMPMLC, :NSLDLC, :ESTOQTIPOMOVPD, :TIPONF)
              INTO :NSLDLC, :NCUSTOMPMLC, :CESTOQMOVPROD;
          if (CMULTIALMOX='N') then
          begin
             NSLDLCAX = NSLDLC;
             NCUSTOMPMLCAX = NCUSTOMPMLC;
          end
          else
          begin
              SELECT NSALDO, NCUSTOMPM
                  FROM EQMOVPRODCSLDSP(:ICODEMPTM, :SCODFILIALTM,
                  :ICODTIPOMOV, (:NQTDMOVPROD-:NQTDMOVPRODOLD), :NPRECOMOVPROD,
                  :NCUSTOMPMLCAX, :NSLDLCAX, :ESTOQTIPOMOVPD, :TIPONF)
                  INTO :NSLDLCAX, :NCUSTOMPMLCAX;
          end

      end

       SELECT NSLDPRC, NCUSTOMPMPRC, NSLDPRCAX, NCUSTOMPMPRCAX
        FROM EQMOVPRODPRCSLDSP( :SCODFILIAL, :ICODMOVPROD, :ICODEMPPD,
          :SCODFILIALPD, :ICODPROD, :DDTPRC, :DDTPRCATE, :NSLDPRC,
          :NCUSTOMPMPRC, :NSLDPRCAX, :NCUSTOMPMPRCAX,
          :ICODEMPAX, :SCODFILIALAX, :ICODALMOX, :CMULTIALMOX, :TIPONF)
        INTO :NSLDPRC, :NCUSTOMPMPRC, :NSLDPRCAX, :NCUSTOMPMPRCAX;

      UPDATE EQMOVPROD SET DTMOVPROD=:DDTMOVPROD,
         QTDMOVPROD=:NQTDMOVPROD, PRECOMOVPROD=:NPRECOMOVPROD,
         SLDMOVPROD=:NSLDLC, CUSTOMPMMOVPROD=:NCUSTOMPMLC,
         SLDMOVPRODAX=:NSLDLCAX, CUSTOMPMMOVPRODAX=:NCUSTOMPMLCAX,
         FLAG=:CFLAG, CODEMPNT=:ICODEMPNT, CODFILIALNT=:SCODFILIALNT,
         CODNAT=:CCODNAT, DOCMOVPROD=:IDOCMOVPROD, CODEMPTM=:ICODEMPTM,
         CODFILIALTM=:SCODFILIALTM, CODTIPOMOV=:ICODTIPOMOV, CODEMPLE=:ICODEMPLE,
         CODFILIALLE=:SCODFILIALLE, CODLOTE=:CCODLOTE, ESTOQMOVPROD=:CESTOQMOVPROD ,
         CODEMPAX=:ICODEMPAX, CODFILIALAX=:SCODFILIALAX, CODALMOX=:ICODALMOX
        WHERE CODEMP=:ICODEMP AND CODFILIAL=:SCODFILIAL AND CODMOVPROD=:ICODMOVPROD;
   end
   else /*  caso no tenha nenhuma alterao relevnte para processamento */

  --  execute procedure sgdebugsp('antes do reprocessamento','5SG');

      UPDATE EQMOVPROD SET FLAG=:CFLAG, CODEMPNT=:ICODEMPNT, CODFILIALNT=:SCODFILIALNT,
         CODNAT=:CCODNAT, DOCMOVPROD=:IDOCMOVPROD, CODEMPTM=:ICODEMPTM,
         CODFILIALTM=:SCODFILIALTM, CODTIPOMOV=:ICODTIPOMOV, CODEMPLE=:ICODEMPLE,
         CODFILIALLE=:SCODFILIALLE, CODLOTE=:CCODLOTE,
         CODEMPAX=:ICODEMPAX, CODFILIALAX=:SCODFILIALAX, CODALMOX=:ICODALMOX
        WHERE CODEMP=:ICODEMP AND CODFILIAL=:SCODFILIAL AND CODMOVPROD=:ICODMOVPROD;
end ^

ALTER PROCEDURE EQPRODUTOSP01 (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODPROD INTEGER,
ICODEMPAX INTEGER,
SCODFILIALAX SMALLINT,
ICODALMOX INTEGER)
RETURNS (NSALDO NUMERIC(15, 5),
NSALDOAX NUMERIC(15, 5),
NCUSTOMPM NUMERIC(15, 5),
NCUSTOPEPS NUMERIC(15, 5),
NCUSTOMPMAX NUMERIC(15, 5),
NCUSTOPEPSAX NUMERIC(15, 5),
NCUSTOINFO NUMERIC(15, 5),
NCUSTOUC NUMERIC(15, 5))
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

declare variable ddtmovprod date;
declare variable ddtmovprodax date;
begin

    /* Procedure que retorna saldos e custos para a tela de cadastro de produtos */
    SELECT FIRST 1 MP.DTMOVPROD, MP.SLDMOVPROD , MP.CUSTOMPMMOVPROD
    FROM EQMOVPROD MP
    WHERE MP.CODEMPPD=:ICODEMP AND MP.CODFILIALPD=:SCODFILIAL AND MP.CODPROD=:ICODPROD
    ORDER BY MP.DTMOVPROD DESC, MP.CODMOVPROD DESC
    INTO :DDTMOVPROD, :NSALDO, :NCUSTOMPM;

    SELECT FIRST 1 MP.DTMOVPROD, MP.SLDMOVPRODAX, MP.CUSTOMPMMOVPRODAX
    FROM EQMOVPROD MP
    WHERE MP.CODEMPPD=:ICODEMP AND MP.CODFILIALPD=:SCODFILIAL AND MP.CODPROD=:ICODPROD
    ORDER BY MP.DTMOVPROD DESC, MP.CODMOVPROD DESC
    INTO :DDTMOVPRODAX, :NSALDOAX, :NCUSTOMPMAX;

    SELECT P.NCUSTOPEPS  FROM EQCALCPEPSSP(:ICODEMP, :SCODFILIAL,
    :ICODPROD, :NSALDO, :DDTMOVPROD, null, null, null ) P
    INTO :NCUSTOPEPS;

    SELECT P.NCUSTOPEPS  FROM EQCALCPEPSSP(:ICODEMP, :SCODFILIAL,
    :ICODPROD, :NSALDO, :DDTMOVPRODAX, :ICODEMPAX, :SCODFILIALAX,
    :ICODALMOX ) P
    INTO :NCUSTOPEPSAX;

    select p.custoinfoprod from eqproduto p
    where p.codemp=:icodemp and p.codfilial=:scodfilial and p.codprod=:icodprod
    into :ncustoinfo;

    select custounit from eqcustoprodsp(:icodemp, :scodfilial, :icodprod,
    cast('today' as date),'U',:icodempax, :scodfilialax, :icodalmox, 'N' )
    into :ncustouc;

    if(:ncustompm is null) then
    begin
        ncustompm = :ncustoinfo;
    end

    if(:ncustopeps is null) then
    begin
        ncustopeps = :ncustoinfo;
    end

    suspend;

end ^

ALTER PROCEDURE EQREFPRODSP (CODEMP INTEGER,
CODFILIAL SMALLINT,
CODPROD INTEGER)
RETURNS (REFPROD VARCHAR(20))
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

begin
  /* Procedure Text */
  SELECT REFPROD FROM EQPRODUTO WHERE CODPROD=:CODPROD AND
     CODEMP=:CODEMP AND CODFILIAL=:CODFILIAL INTO :REFPROD;
  suspend;
end ^

ALTER PROCEDURE EQRELDEMANDASP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
SCODFILIALPD SMALLINT,
DDTINI DATE,
DDTFIM DATE)
RETURNS (CODMARCA CHAR(6),
CODGRUP CHAR(14),
CODPROD INTEGER,
REFPROD VARCHAR(20),
DESCPROD CHAR(100),
DESCGRUP CHAR(50),
SLDINI NUMERIC(15, 5),
VLRCOMPRAS NUMERIC(15, 5),
VLRDEVENT NUMERIC(15, 5),
VLROUTENT NUMERIC(15, 5),
VLRVENDAS NUMERIC(15, 5),
VLRDEVSAI NUMERIC(15, 5),
VLROUTSAI NUMERIC(15, 5),
SLDFIM NUMERIC(15, 5))
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

begin
  /* Stored procedure de relatrio de demanda */
  FOR SELECT P.CODMARCA, P.CODGRUP,P.CODPROD,
     P.REFPROD, P.DESCPROD,G.DESCGRUP,
     (SELECT FIRST 1 SLDMOVPROD FROM EQMOVPROD MP
      WHERE MP.CODEMP=:ICODEMP AND MP.CODFILIAL=:SCODFILIAL AND
         MP.CODEMPPD=P.CODEMP AND MP.CODFILIALPD=P.CODFILIAL AND
         MP.CODPROD=P.CODPROD AND MP.DTMOVPROD<:DDTINI
         ORDER BY MP.DTMOVPROD DESC, MP.CODMOVPROD DESC ) SLDINI,
     (SELECT SUM(MP.QTDMOVPROD)
         FROM EQMOVPROD MP, EQTIPOMOV TM
         WHERE TM.CODEMP=MP.CODEMPTM AND TM.CODFILIAL=MP.CODFILIALTM AND
           TM.CODTIPOMOV=MP.CODTIPOMOV AND MP.CODPROD=P.CODPROD AND
           MP.CODEMPPD=P.CODEMP AND MP.CODFILIALPD=P.CODFILIAL AND
           MP.DTMOVPROD BETWEEN :DDTINI AND :DDTFIM AND MP.ESTOQMOVPROD='S' AND
           TM.TIPOMOV IN ('CP','PC') AND TM.ESTIPOMOV = 'E') VLRCOMPRAS,
     (SELECT SUM(MP.QTDMOVPROD)
         FROM EQMOVPROD MP, EQTIPOMOV TM
         WHERE TM.CODEMP=MP.CODEMPTM AND TM.CODFILIAL=MP.CODFILIALTM AND
           TM.CODTIPOMOV=MP.CODTIPOMOV AND MP.CODPROD=P.CODPROD AND
           MP.CODEMPPD=P.CODEMP AND MP.CODFILIALPD=P.CODFILIAL AND
           MP.DTMOVPROD BETWEEN :DDTINI AND :DDTFIM AND MP.ESTOQMOVPROD='S' AND
           TM.TIPOMOV ='DV' AND TM.ESTIPOMOV = 'E') VLRDEVENT,
     (SELECT SUM(MP.QTDMOVPROD)
         FROM EQMOVPROD MP , EQTIPOMOV TM
         WHERE TM.CODEMP=MP.CODEMPTM AND TM.CODFILIAL=MP.CODFILIALTM AND
           TM.CODTIPOMOV=MP.CODTIPOMOV AND MP.CODPROD=P.CODPROD AND
           MP.CODEMPPD=P.CODEMP AND MP.CODFILIALPD=P.CODFILIAL AND
           MP.DTMOVPROD BETWEEN :DDTINI AND :DDTFIM AND MP.ESTOQMOVPROD='S' AND
           TM.TIPOMOV NOT IN ('CP','PC','DV') AND TM.ESTIPOMOV IN ('E','I')) VLROUTENT,
     (SELECT SUM(MP.QTDMOVPROD)
         FROM EQMOVPROD MP, EQTIPOMOV TM
         WHERE TM.CODEMP=MP.CODEMPTM AND TM.CODFILIAL=MP.CODFILIALTM AND
           TM.CODTIPOMOV=MP.CODTIPOMOV AND MP.CODPROD=P.CODPROD AND
           MP.CODEMPPD=P.CODEMP AND MP.CODFILIALPD=P.CODFILIAL AND
           MP.DTMOVPROD BETWEEN :DDTINI AND :DDTFIM AND MP.ESTOQMOVPROD='S' AND
           TM.TIPOMOV IN ('VD','PV') AND TM.ESTIPOMOV = 'S') VLRVENDAS,
     (SELECT SUM(MP.QTDMOVPROD)
         FROM EQMOVPROD MP, EQTIPOMOV TM
         WHERE TM.CODEMP=MP.CODEMPTM AND TM.CODFILIAL=MP.CODFILIALTM AND
           TM.CODTIPOMOV=MP.CODTIPOMOV AND MP.CODPROD=P.CODPROD AND
           MP.CODEMPPD=P.CODEMP AND MP.CODFILIALPD=P.CODFILIAL AND
           MP.DTMOVPROD BETWEEN :DDTINI AND :DDTFIM AND MP.ESTOQMOVPROD='S' AND
           TM.TIPOMOV ='DV' AND TM.ESTIPOMOV = 'S') VLRDEVSAI,
     (SELECT SUM(MP.QTDMOVPROD)
        FROM EQMOVPROD MP, EQTIPOMOV TM
         WHERE TM.CODEMP=MP.CODEMPTM AND TM.CODFILIAL=MP.CODFILIALTM AND
           TM.CODTIPOMOV=MP.CODTIPOMOV AND MP.CODPROD=P.CODPROD AND
           MP.CODEMPPD=P.CODEMP AND MP.CODFILIALPD=P.CODFILIAL AND
           MP.DTMOVPROD BETWEEN :DDTINI AND :DDTFIM AND MP.ESTOQMOVPROD='S' AND
           TM.TIPOMOV NOT IN ('VD','PV','DV') AND TM.ESTIPOMOV = 'S') VLROUTSAI
     FROM EQPRODUTO P, EQGRUPO G
         WHERE G.CODGRUP=P.CODGRUP AND G.CODEMP=P.CODEMPGP AND
           G.CODFILIAL=P.CODFILIALGP AND P.CODEMP=:ICODEMP AND
           P.CODFILIAL=:SCODFILIALPD AND P.ATIVOPROD='S'
     INTO :CODMARCA, :CODGRUP, :CODPROD, :REFPROD, :DESCPROD, :DESCGRUP,
        :SLDINI, :VLRCOMPRAS, :VLRDEVENT,  :VLROUTENT,
         :VLRVENDAS, :VLRDEVSAI, :VLROUTSAI DO
     BEGIN
        if (SLDINI IS NULL) then
           SLDINI = 0;
        if (VLROUTSAI IS NULL) then
           VLROUTSAI = 0;
        if (VLROUTENT IS NULL) then
           VLROUTENT = 0;
        if (VLRDEVSAI IS NULL) then
           VLRDEVSAI = 0;
        if (VLRDEVENT IS NULL) then
           VLRDEVENT = 0;
        if (VLRCOMPRAS IS NULL) then
           VLRCOMPRAS = 0;
        if (VLRVENDAS IS NULL) then
           VLRVENDAS = 0;
        SLDFIM = SLDINI + VLRCOMPRAS + VLRDEVENT + VLROUTENT -
           VLRVENDAS - VLRDEVSAI - VLROUTSAI;
        suspend;
     END
end ^

ALTER PROCEDURE EQRELGIROPROD (CODEMP INTEGER,
CODFILIAL INTEGER,
DATA_BASE DATE)
RETURNS (CODEMPPD INTEGER,
CODFILIALPD SMALLINT,
CODPROD INTEGER,
REFPROD VARCHAR(20),
CODFABPROD CHAR(15),
CODBARPROD CHAR(13),
DESCPROD VARCHAR(100),
CODEMPCP INTEGER,
CODFILIALCP SMALLINT,
CODCOMPRA INTEGER,
DOCCOMPRA INTEGER,
IDENTCONTAINER CHAR(20),
CODITCOMPRA SMALLINT,
DTULTCP DATE,
SALDOANT NUMERIC(15, 5),
QTDULTCP NUMERIC(15, 5),
QTDVENDIDA NUMERIC(15, 5),
SALDOATU NUMERIC(15, 5),
CODEMPGP INTEGER,
CODFILIALGP INTEGER,
CODGRUP CHAR(14))
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

begin

    -- Buscando produtos ativos
    for
        select pd.codemp, pd.codfilial, pd.codprod, pd.descprod, refprod, codfabprod, codbarprod,
        codempgp, codfilialgp, codgrup
        from eqproduto pd
        where pd.ativoprod='S' and pd.codemp=:codemp and pd.codfilial=:codfilial
        into codemppd, codfilialpd, codprod, descprod, refprod, codfabprod, codbarprod,
        codempgp, codfilialgp, codgrup
    do
    begin

        -- Buscando a ultima compra do produto
        codempcp = null;
        codfilialcp = null;
        codcompra = null;
        coditcompra = null;
        dtultcp = null;
        qtdultcp = 0;
        doccompra = null;
        identcontainer = null;

        select first 1 itc.codemp, itc.codfilial, itc.codcompra, itc.coditcompra, cp.dtentcompra, itc.qtditcompra, cp.doccompra, cp.identcontainer
        from cpcompra cp, cpitcompra itc
        where
        itc.codemp=cp.codemp and itc.codfilial=cp.codfilial and itc.codcompra=cp.codcompra and
        itc.codemppd=:codemppd and itc.codfilialpd=:codfilialpd and itc.codprod=:codprod and
        cp.dtentcompra < :data_base
        order by cp.dtentcompra desc
        into codempcp, codfilialcp, codcompra, coditcompra, dtultcp, qtdultcp, doccompra, identcontainer;

        -- Buscando a ultima compra do produto

        qtdvendida = 0;

        select coalesce(sum(itv.qtditvenda),0)
        from vdvenda vd, vditvenda itv, eqtipomov tm
        where
        itv.codemp=vd.codemp and itv.codfilial=vd.codfilial and itv.codvenda=vd.codvenda and itv.tipovenda=vd.tipovenda and
        itv.codemppd=:codemppd and itv.codfilialpd=:codfilialpd and itv.codprod=:codprod and
        vd.dtsaidavenda between :data_base - 30 and :data_base and
        tm.codemp=vd.codemptm and tm.codfilial=vd.codfilialtm and tm.codtipomov=vd.codtipomov and
        tm.estoqtipomov='S'
        into :qtdvendida;

        -- Buscando saldo anterior

        saldoant = 0;

        select first 1 mp.sldmovprod
        from eqmovprod mp
        where mp.codemp=:codemp and mp.codfilial=:codfilial and mp.codemppd=:codemppd and mp.codfilialpd=:codfilialpd
        and mp.codprod=:codprod and mp.dtmovprod<:dtultcp
        order by mp.dtmovprod desc, mp.codmovprod desc
        into saldoant;

        -- Buscando saldo atual
        saldoatu = 0;

        select first 1 mp.sldmovprod
        from eqmovprod mp
        where mp.codemp=:codemp and mp.codfilial=:codfilial and mp.codemppd=:codemppd and mp.codfilialpd=:codfilialpd
        and mp.codprod=:codprod and mp.dtmovprod<=:data_base
        order by mp.dtmovprod desc, mp.codmovprod desc
        into saldoatu;

        suspend;

    end

end ^

ALTER PROCEDURE EQRELGIROPRODPERI (CODEMP INTEGER,
CODFILIAL INTEGER,
DATA_INI DATE,
DATA_FIM DATE)
RETURNS (CODEMPPD INTEGER,
CODFILIALPD SMALLINT,
CODPROD INTEGER,
REFPROD VARCHAR(20),
CODFABPROD CHAR(15),
CODBARPROD CHAR(13),
DESCPROD VARCHAR(100),
CODEMPCP INTEGER,
CODFILIALCP SMALLINT,
CODCOMPRA INTEGER,
DOCCOMPRA INTEGER,
IDENTCONTAINER CHAR(20),
CODITCOMPRA SMALLINT,
DTULTCP DATE,
SALDOANT NUMERIC(15, 5),
QTDULTCP NUMERIC(15, 5),
QTDVENDIDA NUMERIC(15, 5),
SALDOATU NUMERIC(15, 5),
CODEMPGP INTEGER,
CODFILIALGP INTEGER,
CODGRUP CHAR(14))
AS 
 
 

begin

    -- Buscando produtos ativos
    for
        select pd.codemp, pd.codfilial, pd.codprod, pd.descprod, refprod, codfabprod, codbarprod,
        codempgp, codfilialgp, codgrup
        from eqproduto pd
        where pd.ativoprod='S' and pd.codemp=:codemp and pd.codfilial=:codfilial
        into codemppd, codfilialpd, codprod, descprod, refprod, codfabprod, codbarprod,
        codempgp, codfilialgp, codgrup
    do
    begin

        -- Buscando a ultima compra do produto
        codempcp = null;
        codfilialcp = null;
        codcompra = null;
        coditcompra = null;
        dtultcp = null;
        qtdultcp = 0;
        doccompra = null;
        identcontainer = null;

        select first 1 itc.codemp, itc.codfilial, itc.codcompra, itc.coditcompra, cp.dtentcompra, itc.qtditcompra, cp.doccompra, cp.identcontainer
        from cpcompra cp, cpitcompra itc
        where
        itc.codemp=cp.codemp and itc.codfilial=cp.codfilial and itc.codcompra=cp.codcompra and
        itc.codemppd=:codemppd and itc.codfilialpd=:codfilialpd and itc.codprod=:codprod and
        cp.dtentcompra < :data_fim
        order by cp.dtentcompra desc
        into codempcp, codfilialcp, codcompra, coditcompra, dtultcp, qtdultcp, doccompra, identcontainer;

        -- Buscando a ultima compra do produto

        qtdvendida = 0;

        select coalesce(sum(itv.qtditvenda),0)
        from vdvenda vd, vditvenda itv, eqtipomov tm
        where
        itv.codemp=vd.codemp and itv.codfilial=vd.codfilial and itv.codvenda=vd.codvenda and itv.tipovenda=vd.tipovenda and
        itv.codemppd=:codemppd and itv.codfilialpd=:codfilialpd and itv.codprod=:codprod and
        vd.dtsaidavenda between :data_ini and :data_fim and
        tm.codemp=vd.codemptm and tm.codfilial=vd.codfilialtm and tm.codtipomov=vd.codtipomov and
        tm.estoqtipomov='S'
        into :qtdvendida;

        -- Buscando saldo anterior

        saldoant = 0;

        select first 1 mp.sldmovprod
        from eqmovprod mp
        where mp.codemp=:codemp and mp.codfilial=:codfilial and mp.codemppd=:codemppd and mp.codfilialpd=:codfilialpd
        and mp.codprod=:codprod and mp.dtmovprod<:dtultcp
        order by mp.dtmovprod desc, mp.codmovprod desc
        into saldoant;

        -- Buscando saldo atual
        saldoatu = 0;

        select first 1 mp.sldmovprod
        from eqmovprod mp
        where mp.codemp=:codemp and mp.codfilial=:codfilial and mp.codemppd=:codemppd and mp.codfilialpd=:codfilialpd
        and mp.codprod=:codprod and mp.dtmovprod<=:data_fim
        order by mp.dtmovprod desc, mp.codmovprod desc
        into saldoatu;

        suspend;

    end

end ^

ALTER PROCEDURE EQRELINVPRODSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
CTIPOCUSTO CHAR(1),
ICODEMPGP INTEGER,
SCODFILIALGP SMALLINT,
CCODGRUP CHAR(14),
DDTESTOQ DATE,
ICODEMPAX INTEGER,
SCODFILIALAX SMALLINT,
ICODALMOX INTEGER)
RETURNS (CODPROD INTEGER,
REFPROD VARCHAR(20),
DESCPROD CHAR(100),
CODGRUP CHAR(14),
SALDO NUMERIC(15, 5),
CUSTO NUMERIC(15, 5),
VLRESTOQ NUMERIC(15, 5))
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

declare variable cmultialmox char(1);
declare variable ncustompm numeric(15,5);
begin
  /* Relatrio de estoque */
  SELECT CMULTIALMOX FROM SGRETMULTIALMOXSP(:ICODEMP) INTO :CMULTIALMOX;

  if (CCODGRUP IS NOT NULL) then
  begin
     CCODGRUP = rtrim(CCODGRUP);
     if (strlen(CCODGRUP)<14) then
        CCODGRUP = CCODGRUP || '%';
  end
  FOR SELECT P.CODPROD, P.REFPROD, P.DESCPROD, P.CODGRUP
    FROM EQPRODUTO P
    WHERE P.CODEMP=:ICODEMP AND P.CODFILIAL=:SCODFILIAL AND
          ( ( :CCODGRUP IS NULL ) OR
            (P.CODGRUP LIKE :CCODGRUP AND P.CODEMPGP=:ICODEMPGP AND
             P.CODFILIALGP=:SCODFILIALGP) )
    INTO :CODPROD, :REFPROD, :DESCPROD, :CODGRUP DO
  BEGIN
     SELECT NSALDO, NCUSTOMPM FROM EQMOVPRODSLDSP(null, null, null, :ICODEMP,
        :SCODFILIAL, :CODPROD, :DDTESTOQ, 0, 0,
        :ICODEMPAX, :SCODFILIALAX, :ICODALMOX, :CMULTIALMOX)
       INTO :SALDO, :NCUSTOMPM;
     if (CTIPOCUSTO='M') then
        CUSTO = NCUSTOMPM;
     else
        SELECT NCUSTOPEPS FROM EQCALCPEPSSP(:ICODEMP, :SCODFILIAL, :CODPROD,
          :SALDO, :DDTESTOQ, :ICODEMPAX, :SCODFILIALAX, :ICODALMOX)
        INTO :CUSTO;
     VLRESTOQ = CUSTO * SALDO;
     SUSPEND;
  END
end ^

ALTER PROCEDURE EQRELPEPSSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
DTESTOQ DATE,
ICODEMPMC INTEGER,
SCODFILIALMC SMALLINT,
CCODMARCA CHAR(6),
ICODEMPGP INTEGER,
SCODFILIALGP SMALLINT,
CCODGRUP VARCHAR(14),
CTIPOCUSTO CHAR(1),
ICODEMPAX INTEGER,
SCODFILIALAX SMALLINT,
ICODALMOX INTEGER,
CLOTEPROD CHAR(1),
SOPRODSALDO CHAR(1))
RETURNS (CODPROD INTEGER,
REFPROD VARCHAR(20),
DESCPROD CHAR(100),
SLDPROD NUMERIC(15, 5),
CUSTOUNIT NUMERIC(15, 5),
CUSTOTOT NUMERIC(15, 5),
CODBARPROD CHAR(13),
CODFABPROD CHAR(15),
ATIVOPROD CHAR(1),
CODUNID CHAR(20),
TIPOPROD VARCHAR(2),
CODNCM VARCHAR(10),
EXTIPI CHAR(2),
COD_GEN CHAR(2),
CODSERV CHAR(5),
ALIQ_ICMS NUMERIC(9, 2),
CODNBM VARCHAR(12),
CODLOTE VARCHAR(20),
VENCTOLOTE DATE,
SLDLOTE NUMERIC(15, 5),
CODGRUP VARCHAR(14),
SIGLAGRUP VARCHAR(10))
AS 

begin

  /* procedure text */

  if (icodempgp is not null) then
  begin
    if (strlen(rtrim(ccodgrup))<14) then
       ccodgrup = rtrim(ccodgrup)||'%';
  end

  if (ctipocusto is null) then
     ctipocusto = 'P';

  if (:cloteprod = 'S') then
  begin
        for select p.codprod,p.refprod,p.descprod, p.codbarprod
            , p.codfabprod, p.ativoprod, p.codunid, p.tipoprod
            , fc.codncm, fc.extipi
            , substring(fc.codncm from 1 for 2) cod_gen
            , fc.codserv,
            (select first 1 ifc.aliqfisc from lfitclfiscal ifc where ifc.codemp=fc.codemp and ifc.codfilial=fc.codfilial and
            ifc.geralfisc='S' and ifc.noufitfisc='S' and ifc.ativoitfisc='S') aliq_icms
            , fc.codnbm, lt.codlote, lt.venctolote, lt.sldlote, p.codgrup, gp.siglagrup
        from eqproduto p
        left outer join lfclfiscal fc
            on fc.codemp=p.codempfc and fc.codfilial=p.codfilialfc and fc.codfisc=p.codfisc
        left outer join eqlote lt
            on lt.codemp=p.codemp and lt.codfilial=p.codfilial and lt.codprod=p.codprod
        left outer join eqgrupo gp
            on gp.codemp=p.codemp and gp.codfilial=p.codfilial and gp.codgrup=p.codgrup

        where p.codemp = :icodemp and p.codfilial = :scodfilial and
            ( (:icodempmc is null) or (p.codempmc=:icodempmc and p.codfilialmc=:scodfilialmc and
             p.codmarca=:ccodmarca) ) and
            ((:icodempgp is null) or (p.codempgp=:icodempgp and p.codfilialgp=:scodfilialgp and
             p.codgrup like :ccodgrup) )
        order by p.codprod
    
        into :codprod, :refprod, :descprod, :codbarprod, :codfabprod
            , :ativoprod, :codunid, :tipoprod
            , :codncm, :extipi, :cod_gen, :codserv, :aliq_icms, :codnbm, :codlote, :venctolote, :sldlote, :codgrup, :siglagrup do
    
        begin
            select sldprod, custounit, custotot from eqcustoprodsp(:icodemp,
                 :scodfilial, :codprod, :dtestoq, :ctipocusto, :icodempax,
                 :scodfilialax, :icodalmox, 'S')
            into :sldprod, :custounit, :custotot;
            if (:soprodsaldo='N' or  :sldprod <> 0) then
                suspend;
        end
  end
  else
  begin
        for select p.codprod,p.refprod,p.descprod, p.codbarprod
            , p.codfabprod, p.ativoprod, p.codunid, p.tipoprod
            , fc.codncm, fc.extipi
            , substring(fc.codncm from 1 for 2) cod_gen
            , fc.codserv,
            (select first 1 ifc.aliqfisc from lfitclfiscal ifc where ifc.codemp=fc.codemp and ifc.codfilial=fc.codfilial and
            ifc.geralfisc='S' and ifc.noufitfisc='S' and ifc.ativoitfisc='S') aliq_icms
            , fc.codnbm
        from eqproduto p
        left outer join lfclfiscal fc
            on fc.codemp=p.codempfc and fc.codfilial=p.codfilialfc and fc.codfisc=p.codfisc
        where p.codemp = :icodemp and p.codfilial = :scodfilial and
            ( (:icodempmc is null) or (p.codempmc=:icodempmc and p.codfilialmc=:scodfilialmc and
             p.codmarca=:ccodmarca) ) and
            ((:icodempgp is null) or (p.codempgp=:icodempgp and p.codfilialgp=:scodfilialgp and
             p.codgrup like :ccodgrup) )
        order by p.codprod
    
        into :codprod, :refprod, :descprod, :codbarprod, :codfabprod
            , :ativoprod, :codunid, :tipoprod
            , :codncm, :extipi, :cod_gen, :codserv, :aliq_icms, :codnbm do
    
        begin
            select sldprod, custounit, custotot from eqcustoprodsp(:icodemp,
                 :scodfilial, :codprod, :dtestoq, :ctipocusto, :icodempax,
                 :scodfilialax, :icodalmox, 'S')
            into :sldprod, :custounit, :custotot;
            if (:soprodsaldo='N' or  sldprod <> 0) then
                suspend;
        end
  end 


end ^

ALTER PROCEDURE EQSALDOLOTEATEQSP (ICODEMPLEOLD INTEGER,
SCODFILIALLEOLD SMALLINT,
ICODPROD INTEGER,
CCODLOTEOLD VARCHAR(20),
ICODEMPLENEW INTEGER,
SCODFILIALLENEW SMALLINT,
CCODLOTENEW VARCHAR(20),
SOPERADOR SMALLINT,
NQTDMOVPRODOLD NUMERIC(15, 5),
NQTDMOVPRODNEW NUMERIC(15, 5),
ICODEMPAXOLD INTEGER,
SCODFILIALAXOLD SMALLINT,
ICODALMOXOLD INTEGER,
ICODEMPAXNEW INTEGER,
SCODFILIALAXNEW SMALLINT,
ICODALMOXNEW INTEGER)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

DECLARE VARIABLE ICODPRODSLD INTEGER;
begin
  /* Procedure de atualizao do estoque  na tabela de saldos de lotes por almoxarifado*/

  SELECT CODPROD FROM EQSALDOLOTE
     WHERE CODEMP=:ICODEMPLENEW AND CODFILIAL=:SCODFILIALLENEW AND CODPROD=:ICODPROD AND
        CODLOTE=:CCODLOTENEW AND CODEMPAX=:ICODEMPAXNEW AND 
        CODFILIALAX=:SCODFILIALAXNEW AND CODALMOX=:ICODALMOXNEW
     INTO :ICODPRODSLD;
  IF (ICODPRODSLD IS NULL) THEN
  BEGIN
     INSERT INTO EQSALDOLOTE (CODEMP, CODFILIAL, CODPROD, CODLOTE, CODEMPAX, CODFILIALAX, CODALMOX)
       VALUES (:ICODEMPLENEW, :SCODFILIALLENEW, :ICODPROD, :CCODLOTENEW, :ICODEMPAXNEW, :SCODFILIALAXNEW,
         :ICODALMOXNEW);
     NQTDMOVPRODOLD = 0;
  END

  IF ( (ICODALMOXOLD IS NULL) OR (CCODLOTEOLD IS NULL) ) THEN
    NQTDMOVPRODOLD = 0;
  ELSE IF ( (ICODEMPAXOLD!=ICODEMPAXNEW) OR (SCODFILIALAXOLD!=SCODFILIALAXNEW) OR
            (ICODALMOXOLD!=ICODALMOXNEW) OR (CCODLOTEOLD!=CCODLOTENEW) OR
            (ICODEMPLEOLD!=ICODEMPLENEW) OR (SCODFILIALLEOLD!=SCODFILIALLENEW) ) THEN
  BEGIN
      IF ((CCODLOTEOLD!=CCODLOTENEW) OR (ICODEMPLEOLD!=ICODEMPLENEW) OR
          (SCODFILIALLEOLD!=SCODFILIALLENEW) ) THEN
      BEGIN
         UPDATE EQLOTE SET SLDLOTE = SLDLOTE+((0-:NQTDMOVPRODOLD)*:SOPERADOR)
            WHERE CODLOTE=:CCODLOTEOLD AND CODPROD=:ICODPROD
            AND CODEMP=:ICODEMPLEOLD AND CODFILIAL=:SCODFILIALLEOLD;
      END
      UPDATE EQSALDOLOTE SET SLDLOTE = SLDLOTE+((0-:NQTDMOVPRODOLD)*:SOPERADOR)
         WHERE CODPROD=:ICODPROD AND CODLOTE=:CCODLOTEOLD AND CODALMOX = :ICODALMOXOLD
           AND CODEMPAX = :ICODEMPAXOLD AND CODFILIALAX = :SCODFILIALAXOLD
           AND CODEMP=:ICODEMPLEOLD AND CODFILIAL=:SCODFILIALLEOLD; 
      NQTDMOVPRODOLD=0;
  END
  UPDATE EQLOTE SET SLDLOTE = SLDLOTE+((:NQTDMOVPRODNEW-:NQTDMOVPRODOLD)*:SOPERADOR)
        WHERE CODLOTE=:CCODLOTENEW AND CODPROD=:ICODPROD
         AND CODEMP=:ICODEMPLENEW AND CODFILIAL=:SCODFILIALLENEW;
  UPDATE EQSALDOLOTE SET SLDLOTE = SLDLOTE+((:NQTDMOVPRODNEW-:NQTDMOVPRODOLD)*:SOPERADOR)
         WHERE CODPROD=:ICODPROD AND CODLOTE=:CCODLOTENEW AND CODALMOX = :ICODALMOXNEW
           AND CODEMPAX = :ICODEMPAXNEW AND CODFILIALAX = :SCODFILIALAXNEW
           AND CODEMP=:ICODEMPLENEW AND CODFILIAL=:SCODFILIALLENEW;
  suspend;
end ^

ALTER PROCEDURE EQSALDOPRODATEQSP (ICODEMPPD INTEGER,
SCODFILIALPD SMALLINT,
ICODPROD INTEGER,
SOPERADOR SMALLINT,
NQTDMOVPRODOLD NUMERIC(15, 5),
NQTDMOVPRODNEW NUMERIC(15, 5),
ICODEMPAXOLD INTEGER,
SCODFILIALAXOLD SMALLINT,
ICODALMOXOLD INTEGER,
ICODEMPAXNEW INTEGER,
SCODFILIALAXNEW SMALLINT,
ICODALMOXNEW INTEGER)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

DECLARE VARIABLE ICODPRODSLD INTEGER;
begin
  /* Procedure de atualizao do estoque  na tabela de saldos por almoxarifado*/
  SELECT CODPROD FROM EQSALDOPROD
     WHERE CODEMP=:ICODEMPPD AND CODFILIAL=:SCODFILIALPD AND CODPROD=:ICODPROD AND
        CODEMPAX=:ICODEMPAXNEW AND CODFILIALAX=:SCODFILIALAXNEW AND CODALMOX=:ICODALMOXNEW
     INTO :ICODPRODSLD;
  IF (ICODPRODSLD IS NULL) THEN
  BEGIN
     INSERT INTO EQSALDOPROD (CODEMP, CODFILIAL, CODPROD, CODEMPAX, CODFILIALAX, CODALMOX)
       VALUES (:ICODEMPPD, :SCODFILIALPD, :ICODPROD, :ICODEMPAXNEW, :SCODFILIALAXNEW,
         :ICODALMOXNEW);
     NQTDMOVPRODOLD = 0;
  END

  IF (ICODALMOXOLD IS NULL) THEN
    NQTDMOVPRODOLD = 0;
  ELSE IF ( (ICODEMPAXOLD!=ICODEMPAXNEW) OR (SCODFILIALAXOLD!=SCODFILIALAXNEW) OR
            (ICODALMOXOLD!=ICODALMOXNEW) ) THEN
  BEGIN
      UPDATE EQSALDOPROD SET SLDPROD = SLDPROD+((0-:NQTDMOVPRODOLD)*:SOPERADOR)
         WHERE CODPROD=:ICODPROD AND CODALMOX = :ICODALMOXOLD
           AND CODEMPAX = :ICODEMPAXOLD AND CODFILIALAX = :SCODFILIALAXOLD
           AND CODEMP=:ICODEMPPD AND CODFILIAL=:SCODFILIALPD;
      NQTDMOVPRODOLD=0;
  END
  UPDATE EQSALDOPROD SET SLDPROD = SLDPROD+((:NQTDMOVPRODNEW-:NQTDMOVPRODOLD)*:SOPERADOR)
         WHERE CODPROD=:ICODPROD AND CODALMOX = :ICODALMOXNEW
           AND CODEMPAX = :ICODEMPAXNEW AND CODFILIALAX = :SCODFILIALAXNEW
           AND CODEMP=:ICODEMPPD AND CODFILIAL=:SCODFILIALPD;
  suspend;
end ^

ALTER PROCEDURE FNADICITRECEBERSP01 (CALTVLR CHAR(1),
ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODREC INTEGER,
INPARCITREC INTEGER,
NVLRDESCITREC NUMERIC(15, 5),
NVLRMULTAITREC NUMERIC(15, 5),
NVLRJUROSITREC NUMERIC(15, 5),
NVLRPARCITREC NUMERIC(15, 5),
NVLRPAGOITREC NUMERIC(15, 5),
DDTITREC DATE,
DDTCOMPITREC DATE,
DDTVENCITREC DATE,
CSTATUSITREC CHAR(2),
CFLAG CHAR(1),
ICODEMPBO INTEGER,
SCODFILIALBO SMALLINT,
CCODBANCO CHAR(3),
ICODEMPTC INTEGER,
SCODFILIALTC SMALLINT,
ICODTIPOCOB INTEGER,
ICODEMPCB INTEGER,
SCODFILIALCB SMALLINT,
CODCARTCOB CHAR(3),
NVLRCOMIITREC NUMERIC(15, 5),
OBSITREC VARCHAR(250),
CODEMPCA INTEGER,
CODFILIALCA SMALLINT,
NUMCONTA CHAR(10),
CODEMPPN INTEGER,
CODFILIALPN SMALLINT,
CODPLAN CHAR(13),
CODEMPCC INTEGER,
CODFILIALCC SMALLINT,
ANOCC SMALLINT,
CODCC CHAR(19),
VLRBASECOMIS NUMERIC(15, 5))
AS 
 
 
 
declare variable inparcitrecold integer;
declare variable doclancaitrec varchar(15);
begin
   SELECT ir.doclancaitrec,ir.NPARCITREC FROM FNITRECEBER IR WHERE IR.CODEMP=:ICODEMP AND
     IR.CODFILIAL=:SCODFILIAL AND IR.CODREC=:ICODREC AND
     IR.NPARCITREC=:INPARCITREC INTO :doclancaitrec, :INPARCITRECOLD;

   IF (INPARCITRECOLD IS NULL) THEN
     /* Faz insero na tabela de parcelas do contas a receber */
      INSERT INTO FNITRECEBER(CODEMP,CODFILIAL,CODREC,NPARCITREC,VLRDESCITREC,VLRMULTAITREC,
              VLRJUROSITREC,VLRPARCITREC,VLRPAGOITREC,DTITREC, DTCOMPITREC, DTVENCITREC,
              STATUSITREC,FLAG,CODEMPBO,CODFILIALBO,CODBANCO,
              CODEMPTC, CODFILIALTC, CODTIPOCOB,
              CODEMPCB, CODFILIALCB, CODCARTCOB, VLRCOMIITREC, OBSITREC, CODEMPCA,CODFILIALCA,NUMCONTA,dtprevitrec,
              codemppn, codfilialpn, codplan, codempcc, codfilialcc, anocc, codcc, vlrbasecomis, doclancaitrec)
              VALUES
             (:ICODEMP,:SCODFILIAL,:ICODREC,:INPARCITREC,:NVLRDESCITREC,:NVLRMULTAITREC,
             :NVLRJUROSITREC,:NVLRPARCITREC,:NVLRPAGOITREC, :DDTITREC, :DDTCOMPITREC, :DDTVENCITREC,
             :CSTATUSITREC,:CFLAG,:ICODEMPBO,:SCODFILIALBO,:CCODBANCO,
             :ICODEMPTC, :SCODFILIALTC, :ICODTIPOCOB,
             :ICODEMPCB, :SCODFILIALCB, :CODCARTCOB, :NVLRCOMIITREC, :OBSITREC, :codempca, :codfilialca, :numconta,:ddtvencitrec,
             :codemppn, :codfilialpn, :codplan, :codempcc, :codfilialcc, :anocc, :codcc,:vlrbasecomis,:doclancaitrec );
   ELSE
   BEGIN
       SELECT VLRDESCITREC, VLRMULTAITREC, VLRJUROSITREC, VLRPAGOITREC, STATUSITREC
       FROM FNITRECEBER
       WHERE CODEMP=:ICODEMP AND CODFILIAL=:SCODFILIAL AND CODREC=:ICODREC AND
            NPARCITREC=:INPARCITREC
       INTO :NVLRDESCITREC, :NVLRMULTAITREC, :NVLRJUROSITREC, :NVLRPAGOITREC, :CSTATUSITREC;

       IF (CALTVLR='S') THEN /* Flag que indica se  para mudar os valores do contas a receber */
       BEGIN

           UPDATE FNITRECEBER SET ALTUSUITREC='N',VLRDESCITREC=:NVLRDESCITREC,VLRMULTAITREC=:NVLRMULTAITREC,
                  VLRJUROSITREC=:NVLRJUROSITREC,VLRPARCITREC=:NVLRPARCITREC,
                  VLRPAGOITREC=:NVLRPAGOITREC,DTITREC=:DDTITREC,STATUSITREC=:CSTATUSITREC,
                  FLAG=:CFLAG,CODEMPBO=:ICODEMPBO,CODFILIALBO=:SCODFILIALBO,
                  CODBANCO=:CCODBANCO,CODEMPTC=:ICODEMPTC, CODFILIALTC=:SCODFILIALTC, 
                  CODTIPOCOB=:ICODTIPOCOB,
                  CODEMPCB=:ICODEMPCB, CODFILIALCB=:SCODFILIALCB, CODCARTCOB=:CODCARTCOB,
                  VLRCOMIITREC=:NVLRCOMIITREC, CODEMPCA=:codempca, codfilialca=:codfilialca, numconta=:numconta,
                  vlrbasecomis=:vlrbasecomis, obsitrec=:obsitrec
            WHERE CODEMP=:ICODEMP AND CODFILIAL=:SCODFILIAL AND CODREC=:ICODREC AND
                NPARCITREC=:INPARCITREC;
       END
       ELSE
           UPDATE FNITRECEBER SET ALTUSUITREC='N',DTITREC=:DDTITREC,
                  STATUSITREC=:CSTATUSITREC, FLAG=:CFLAG,CODEMPBO=:ICODEMPBO,
                  CODFILIALBO=:SCODFILIALBO,CODBANCO=:CCODBANCO,CODEMPTC=:ICODEMPTC,
                  CODFILIALTC=:SCODFILIALTC, CODTIPOCOB=:ICODTIPOCOB,
                  CODEMPCB=:ICODEMPCB, CODFILIALCB=:SCODFILIALCB, CODCARTCOB=:CODCARTCOB,
                  VLRCOMIITREC=:NVLRCOMIITREC, obsitrec=:obsitrec
            WHERE CODEMP=:ICODEMP AND CODFILIAL=:SCODFILIAL AND CODREC=:ICODREC AND
                NPARCITREC=:INPARCITREC;
  END
 -- suspend;
end ^

ALTER PROCEDURE FNADICLANCASP01 (ICODREC INTEGER,
INPARCITREC INTEGER,
PDVITREC CHAR(1),
SNUMCONTA CHAR(10),
ICODEMPCA INTEGER,
ICODFILIALCA INTEGER,
ICODCLI INTEGER,
ICODEMPCL INTEGER,
ICODFILIALCL INTEGER,
SCODPLAN CHAR(13),
ICODEMPPN INTEGER,
ICODFILIALPN INTEGER,
IANOCC INTEGER,
SCODCC CHAR(19),
ICODEMPCC INTEGER,
ICODFILIALCC INTEGER,
DDTCOMPITREC DATE,
DDTPAGOITREC DATE,
SDOCLANCAITREC VARCHAR(15),
SOBSITREC CHAR(250),
DVLRPAGOITREC NUMERIC(15, 5),
ICODEMP INTEGER,
ICODFILIAL SMALLINT,
DVLRPAGOJUROS NUMERIC(15, 5),
DVLRDESC NUMERIC(15, 5),
CODEMPCT INTEGER,
CODFILIALCT SMALLINT,
CODCONTR INTEGER,
CODITCONTR SMALLINT,
CODEMPEM INTEGER,
CODFILIALEM SMALLINT,
MATEMPR INTEGER
)
AS 
declare variable icodlanca integer;
declare variable scodplanconta char(13);
declare variable icodemppconta integer;
declare variable icodfilialpconta integer;
declare variable cflag char(1);
declare variable ifiliallanca integer;
declare variable tipolanca char(1);
declare variable codempjr integer;
declare variable codfilialjr smallint;
declare variable codplanjr char(13);
declare variable codempdc integer;
declare variable codfilialdc smallint;
declare variable codplandc char(13);
declare variable codsublanca smallint = 1;
BEGIN
    SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'FNLANCA') INTO IFILIALLANCA;

    SELECT CODPLAN,CODEMPPN,CODFILIALPN FROM FNCONTA WHERE NUMCONTA = :SNUMCONTA
        AND CODEMP=:ICODEMPCA AND CODFILIAL=:ICODFILIALCA INTO :sCodPlanConta,:iCodEmpPConta,:iCodFilialPConta;

    SELECT ISEQ FROM SPGERANUM(:ICODEMP,:IFILIALLANCA,'LA') INTO ICODLANCA;

    SELECT FLAG FROM FNRECEBER WHERE CODREC=:ICODREC
        AND CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL INTO :cFlag;

    SELECT CODEMPJR,CODFILIALJR,CODPLANJR,CODEMPDC,CODFILIALDC,CODPLANDC FROM SGPREFERE1
        WHERE CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL
        INTO :CODEMPJR,:CODFILIALJR,:CODPLANJR,:CODEMPDC,:CODFILIALDC,:CODPLANDC;


    IF (ICODCLI IS NULL) THEN
        TIPOLANCA = 'A';
    ELSE
        TIPOLANCA = 'C';

    if ( (DVLRPAGOJUROS IS NULL) OR (:CODPLANJR IS NULL)  ) then
        DVLRPAGOJUROS = 0;
    else
        DVLRPAGOITREC = DVLRPAGOITREC - DVLRPAGOJUROS;

    if (DVLRDESC IS NULL  OR (:CODPLANDC IS NULL) ) then
        DVLRDESC = 0;
    else
        DVLRPAGOITREC = DVLRPAGOITREC + DVLRDESC;


    INSERT INTO FNLANCA (TIPOLANCA,CODEMP,CODFILIAL,CODLANCA,CODEMPRC,CODFILIALRC,CODREC,NPARCITREC,CODEMPPN,CODFILIALPN,CODPLAN, 
        DTCOMPLANCA, DATALANCA, DOCLANCA,HISTBLANCA,DTPREVLANCA,VLRLANCA,FLAG,CODEMPCL,CODFILIALCL,CODCLI,PDVITREC)
        VALUES (:TIPOLANCA,:ICODEMP,:IFILIALLANCA,:iCodLanca,:ICODEMP,:ICODFILIAL,:ICODREC,:iNParcItRec,:iCodEmpPConta,:iCodFilialPConta,
                :sCodPlanConta,:dDtCompItRec, :dDtPagoItRec,:sDocLancaItRec,:sObsItRec,:dDtPagoItRec,0,:cFlag,:ICODEMPCL,:ICODFILIALCL,:ICODCLI,:PDVITREC
        );

    INSERT INTO FNSUBLANCA (CODEMP,CODFILIAL,CODLANCA,CODSUBLANCA,CODEMPCL,CODFILIALCL,CODCLI,CODEMPPN,CODFILIALPN,CODPLAN,
                CODEMPRC, CODFILIALRC, CODREC, NPARCITREC,
                CODEMPCC, CODFILIALCC,ANOCC,CODCC,ORIGSUBLANCA, DTCOMPSUBLANCA, DATASUBLANCA,DTPREVSUBLANCA,VLRSUBLANCA,FLAG, CODEMPCT, CODFILIALCT, CODCONTR, CODITCONTR
                , CODEMPEM, CODFILIALEM, MATEMPR)
        VALUES (:ICODEMP,:IFILIALLANCA,:iCodLanca,:CODSUBLANCA,:ICODEMPCL,:ICODFILIALCL,:ICODCLI,:ICODEMPPN,:ICODFILIALPN,:SCODPLAN,
                :ICODEMP, :ICODFILIAL, :ICODREC, :INPARCITREC,
                :ICODEMPCC,:ICODFILIALCC,:IANOCC,:SCODCC,'S',:dDtCompItRec,:dDtPagoItRec,:dDtPagoItRec,:dVlrPagoItRec*-1,:cFlag, :codempct, :codfilialct, :codcontr, :coditcontr
                , :codempem, :codfilialem, :matempr
        );

    -- Lanamento dos juros em conta distinta.

    IF(DVLRPAGOJUROS > 0) THEN
    BEGIN

        CODSUBLANCA = CODSUBLANCA + 1;

        INSERT INTO FNSUBLANCA (CODEMP,CODFILIAL,CODLANCA,CODSUBLANCA,CODEMPCL,CODFILIALCL,CODCLI,CODEMPPN,CODFILIALPN,CODPLAN,
                 CODEMPRC, CODFILIALRC, CODREC, NPARCITREC,
                  CODEMPCC, CODFILIALCC,ANOCC,CODCC,ORIGSUBLANCA,DTCOMPSUBLANCA,DATASUBLANCA,DTPREVSUBLANCA,VLRSUBLANCA,FLAG, TIPOSUBLANCA, CODEMPCT, CODFILIALCT, CODCONTR, CODITCONTR
                  , CODEMPEM, CODFILIALEM, MATEMPR)
        VALUES (:ICODEMP,:IFILIALLANCA,:iCodLanca,:CODSUBLANCA,:ICODEMPCL,:ICODFILIALCL,:ICODCLI,:CODEMPJR,:CODFILIALJR,:CODPLANJR,
                :ICODEMP, :ICODFILIAL, :ICODREC, :INPARCITREC,
                :ICODEMPCC, :ICODFILIALCC,:IANOCC,:SCODCC,'S',:dDtCompItRec,:dDtPagoItRec,:dDtPagoItRec,:DVLRPAGOJUROS*-1,:cFlag, 'J', :codempct, :codfilialct, :codcontr, :coditcontr
                , :codempem, :codfilialem, :matempr
        );

    END

    -- Lanamento do desconto em conta distinta.

    IF(DVLRDESC > 0) THEN
    BEGIN

        CODSUBLANCA = CODSUBLANCA + 1;

        INSERT INTO FNSUBLANCA (CODEMP,CODFILIAL,CODLANCA,CODSUBLANCA,CODEMPCL,CODFILIALCL,CODCLI,CODEMPPN,CODFILIALPN,CODPLAN,
             CODEMPRC, CODFILIALRC, CODREC, NPARCITREC,
             CODEMPCC, CODFILIALCC,ANOCC,CODCC,ORIGSUBLANCA,DTCOMPSUBLANCA,DATASUBLANCA,DTPREVSUBLANCA,VLRSUBLANCA,FLAG, TIPOSUBLANCA
             , CODEMPCT, CODFILIALCT, CODCONTR, CODITCONTR
             , CODEMPEM, CODFILIALEM, MATEMPR)
        VALUES (:ICODEMP,:IFILIALLANCA,:iCodLanca,:CODSUBLANCA,:ICODEMPCL,:ICODFILIALCL,:ICODCLI,:CODEMPDC,:CODFILIALDC,:CODPLANDC,
               :ICODEMP, :ICODFILIAL, :ICODREC, :INPARCITREC,
             :ICODEMPCC, :ICODFILIALCC,:IANOCC,:SCODCC,'S',:dDtCompItRec,:dDtPagoItRec,:dDtPagoItRec,:DVLRDESC,:cFlag, 'D'
             , :codempct, :codfilialct, :codcontr, :coditcontr
             , :codempem, :codfilialem, :matempr
        );

    END


END ^

ALTER PROCEDURE FNADICLANCASP02 (ICODPAG INTEGER,
INPARCPAG INTEGER,
SNUMCONTA CHAR(10),
ICODEMPCA INTEGER,
ICODFILIALCA INTEGER,
ICODFOR INTEGER,
ICODEMPFR INTEGER,
ICODFILIALFR INTEGER,
SCODPLAN CHAR(13),
ICODEMPPN INTEGER,
ICODFILIALPN INTEGER,
IANOCC INTEGER,
SCODCC CHAR(19),
ICODEMPCC INTEGER,
ICODFILIALCC INTEGER,
DDTCOMPITPAG DATE,
DDTPAGOITPAG DATE,
SDOCLANCAITPAG VARCHAR(15),
SOBSITPAG CHAR(250),
DVLRPAGOITPAG NUMERIC(15, 5),
ICODEMP INTEGER,
ICODFILIAL SMALLINT,
DVLRJUROSPAG NUMERIC(15, 5),
DVLRDESC NUMERIC(15, 5),
CODEMPCT INTEGER,
CODFILIALCT SMALLINT,
CODCONTR INTEGER,
CODITCONTR SMALLINT,
CODEMPEM INTEGER,
CODFILIALEM SMALLINT,
MATEMPR INTEGER
)
AS 

declare variable icodlanca integer;
declare variable scodplanconta char(13);
declare variable icodemppconta integer;
declare variable icodfilialpconta integer;
declare variable cflag char(1);
declare variable ifiliallanca integer;
declare variable tipolanca char(1);
declare variable codempjp integer;
declare variable codfilialjp smallint;
declare variable codplanjp char(13);
declare variable codempdr integer;
declare variable codfilialdr smallint;
declare variable codplandr char(13);
declare variable codsublanca smallint = 1;
BEGIN

    SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'FNLANCA')
    INTO IFILIALLANCA;

    SELECT CODPLAN,CODEMP,CODFILIAL FROM FNCONTA
    WHERE NUMCONTA=:sNumConta AND CODEMP=:ICODEMPCA AND CODFILIAL=:ICODFILIALCA
    INTO :sCodPlanConta,:iCodEmpPConta,:iCodFilialPConta;

    SELECT ISEQ FROM SPGERANUM(:iCODEMP,:IFILIALLANCA,'LA')
    INTO :iCodLanca;

    SELECT FLAG FROM FNPAGAR
    WHERE CODPAG=:iCodPag AND CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL
    INTO :cFlag;

    SELECT CODEMPJP,CODFILIALJP,CODPLANJP,CODEMPDR,CODFILIALDR,CODPLANDR
    FROM SGPREFERE1
    WHERE CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL
    INTO :CODEMPJP,:CODFILIALJP,:CODPLANJP,:CODEMPDR,:CODFILIALDR,:CODPLANDR;

    IF (ICODFOR IS NULL) THEN
        TIPOLANCA = 'A';
      ELSE
        TIPOLANCA = 'F';

    if ( (DVLRJUROSPAG IS NULL) OR (:CODPLANJP IS NULL)  ) then
        DVLRJUROSPAG = 0;
    else
        DVLRPAGOITPAG = DVLRPAGOITPAG - DVLRJUROSPAG;

    if (DVLRDESC IS NULL  OR (:CODPLANDR IS NULL) ) then
        DVLRDESC = 0;
    else
        DVLRPAGOITPAG = DVLRPAGOITPAG + DVLRDESC;

    INSERT INTO FNLANCA (TIPOLANCA,CODEMP,CODFILIAL,CODLANCA,CODEMPPG,CODFILIALPG,CODPAG,
                         NPARCPAG,CODEMPPN,CODFILIALPN,CODPLAN,DTCOMPLANCA,DATALANCA,DOCLANCA,
                         HISTBLANCA,DTPREVLANCA,VLRLANCA,FLAG, CODEMPFR, CODFILIALFR, CODFOR)
         VALUES (:TIPOLANCA,:ICODEMP,:IFILIALLANCA,:iCodLanca,:ICODEMP,:ICODFILIAL,:iCodPag,
                 :iNParcPag,:iCodEmpPConta,:iCodFilialPConta,:sCodPlanConta, :dDtCompItPag, :dDtPagoItPag,:sDocLancaItPag,
                 :sObsItPag,:dDtPagoItPag,0,:cFlag, :ICODEMPFR, :ICODFILIALFR, :ICODFOR
         );

    INSERT INTO FNSUBLANCA (CODEMP,CODFILIAL,CODLANCA,CODSUBLANCA,CODEMPFR,CODFILIALFR,CODFOR,CODEMPPN,CODFILIALPN, CODPLAN,
        CODEMPPG, CODFILIALPG, CODPAG, NPARCPAG,
        CODEMPCC,CODFILIALCC,ANOCC,CODCC,ORIGSUBLANCA,DTCOMPSUBLANCA,DATASUBLANCA,DTPREVSUBLANCA,VLRSUBLANCA,FLAG,
        CODEMPCT, CODFILIALCT, CODCONTR, CODITCONTR, CODEMPEM, CODFILIALEM, MATEMPR)
        VALUES (:ICODEMP,:IFILIALLANCA,:iCodLanca,:CODSUBLANCA,:ICODEMPFR,:ICODFILIALFR,:ICODFOR,:ICODEMPPN,:ICODFILIALPN, :sCodplan,
        :ICODEMP,:ICODFILIAL,:iCodPag, :iNParcPag,
        :ICODEMPCC,:ICODFILIALCC,:IANOCC,:SCODCC,'E',:dDtCompItPag,:dDtPagoItPag,:dDtPagoItPag,:dVlrPagoItPag,:cFlag,
        :codempct, :codfilialct, :codcontr, :coditcontr, :codempem, :codfilialem, :matempr);

    -- Lanamento dos juros em conta distinta.

    IF(DVLRJUROSPAG >0) THEN
    BEGIN

        CODSUBLANCA = CODSUBLANCA + 1;

        INSERT INTO FNSUBLANCA (CODEMP,CODFILIAL,CODLANCA,CODSUBLANCA,CODEMPFR,CODFILIALFR,CODFOR,
             CODEMPPN,CODFILIALPN,CODPLAN,CODEMPCC,CODFILIALCC,ANOCC,CODCC,ORIGSUBLANCA,DTCOMPSUBLANCA,DATASUBLANCA,DTPREVSUBLANCA,VLRSUBLANCA,
             CODEMPPG, CODFILIALPG, CODPAG, NPARCPAG, FLAG, TIPOSUBLANCA
             , CODEMPCT, CODFILIALCT, CODCONTR, CODITCONTR, CODEMPEM, CODFILIALEM, MATEMPR
             )
            VALUES (:ICODEMP,:IFILIALLANCA,:iCodLanca,:CODSUBLANCA,:ICODEMPFR,:ICODFILIALFR,:ICODFOR,
            :CODEMPJP,:CODFILIALJP,:CODPLANJP,:ICODEMPCC,:ICODFILIALCC,:IANOCC,:SCODCC,'E',:dDtCompItPag,:dDtPagoItPag,:dDtPagoItPag,:DVLRJUROSPAG,
            :ICODEMP, :ICODFILIAL, :iCodPag, :iNParcPag,:cFlag, 'J'
            , :codempct, :codfilialct, :codcontr, :coditcontr, :codempem, :codfilialem, :matempr
            );

    END

    -- Lanamento de desconto em conta distinta.

    IF(DVLRDESC >0) THEN
    BEGIN

        CODSUBLANCA = CODSUBLANCA + 1;

        INSERT INTO FNSUBLANCA (CODEMP,CODFILIAL,CODLANCA,CODSUBLANCA,CODEMPFR,CODFILIALFR,CODFOR,
        CODEMPPN,CODFILIALPN,CODPLAN,CODEMPCC,CODFILIALCC,ANOCC,CODCC,ORIGSUBLANCA,DTCOMPSUBLANCA,DATASUBLANCA,DTPREVSUBLANCA,VLRSUBLANCA,
              CODEMPPG, CODFILIALPG, CODPAG, NPARCPAG, FLAG, TIPOSUBLANCA
              , CODEMPCT, CODFILIALCT, CODCONTR, CODITCONTR, CODEMPEM, CODFILIALEM, MATEMPR)
            VALUES (:ICODEMP,:IFILIALLANCA,:iCodLanca,:CODSUBLANCA,:ICODEMPFR,:ICODFILIALFR,:ICODFOR,
             :CODEMPDR,:CODFILIALDR,:CODPLANDR,:ICODEMPCC,:ICODFILIALCC,:IANOCC,:SCODCC,'E',:dDtCompItPag,:dDtPagoItPag,:dDtPagoItPag,:DVLRDESC*-1
             ,:ICODEMP, :ICODFILIAL, :iCodPag, :iNParcPag, :cFlag, 'D'
             ,:codempct, :codfilialct, :codcontr, :coditcontr, :codempem, :codfilialem, :matempr
             );

    END

END ^

ALTER PROCEDURE FNADICPAGARSP01 (CODCOMPRA INTEGER,
ICODEMPPG INTEGER,
ICODFILIALPG SMALLINT,
CODPLANOPAG INTEGER,
ICODEMPFR INTEGER,
ICODFILIALFR SMALLINT,
CODFOR INTEGER,
VLRLIQCOMPRA NUMERIC(18, 2),
DTSAIDACOMPRA DATE,
DTCOMPCOMPRA DATE,
DOCCOMPRA INTEGER,
ICODEMPBO INTEGER,
ICODFILIALBO SMALLINT,
CODBANCO CHAR(3),
FLAG CHAR(1),
ICODEMP INTEGER,
ICODFILIAL SMALLINT,
CODEMPTC INTEGER,
CODFILIALTC SMALLINT,
CODTIPOCOB INTEGER,
CODEMPCT INTEGER,
CODFILIALCT SMALLINT,
NUMCONTA CHAR(10),
CODEMPCC INTEGER,
CODFILIALCC SMALLINT,
ANOCC SMALLINT,
CODCC CHAR(19),
CODEMPPN INTEGER,
CODFILIALPN SMALLINT,
CODPLAN CHAR(13),
OBSPAG VARCHAR(250))
AS 
 
 
declare variable icodpagar integer;
declare variable ifilialpagar integer;
declare variable numparcs integer;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'FNPAGAR') INTO IFILIALPAGAR;
  SELECT ISEQ FROM SPGERANUM(:ICODEMP,:IFILIALPAGAR,'PA') INTO ICODPAGAR;
  SELECT COALESCE(PARCPLANOPAG,0) FROM FNPLANOPAG WHERE CODEMP=:icodemppg AND CODFILIAL=:icodfilialpg AND codplanopag=:codplanopag
  INTO NUMPARCS;

  IF(numparcs>0) THEN
  BEGIN
      INSERT INTO FNPAGAR (CODEMP,CODFILIAL,CODPAG,CODPLANOPAG,CODEMPPG,CODFILIALPG,CODFOR,CODEMPFR,
                          CODFILIALFR,CODCOMPRA,CODEMPCP,CODFILIALCP,VLRPAG,
                          VLRDESCPAG,VLRMULTAPAG,VLRJUROSPAG,VLRPARCPAG,VLRPAGOPAG,
                          VLRAPAGPAG,DATAPAG, DTCOMPPAG, STATUSPAG,DOCPAG,CODBANCO,CODEMPBO,CODFILIALBO,FLAG,
                          CODEMPTC, CODFILIALTC, CODTIPOCOB,
                          codempca, codfilialca,  numconta, codempcc, codfilialcc, anocc, codcc, codemppn, codfilialpn, codplan, obspag)
                          VALUES (
                                 :ICODEMP,:IFILIALPAGAR,:ICODPAGAR,:CodPlanoPag,:ICODEMPPG,:ICODFILIALPG,:CodFor,:ICODEMPFR,
                                 :ICODFILIALFR,:CodCompra,:ICODEMP,:ICODFILIAL,:VlrLiqCompra,
                                 0,0,0,:VlrLiqCompra,0,:VlrLiqCompra,:dtSaidaCompra, :DTCOMPCOMPRA, 'P1',:DocCompra,
                                 :CodBanco,:ICODEMPBO,:ICODFILIALBO,:FLAG,
                                 :CODEMPTC, :CODFILIALTC, :CODTIPOCOB,
                                 :codempct, :codfilialct, :numconta, :codempcc, :codfilialcc, :anocc, :codcc, :codemppn, :codfilialpn, :codplan, :obspag
                          );
   END
END ^

ALTER PROCEDURE FNADICPAGARSP02 (CODEMPOC INTEGER,
CODFILIALOC SMALLINT,
CODORDCP INTEGER,
CODEMPPP INTEGER,
CODFILIALPP SMALLINT,
CODPLANOPAG INTEGER,
CODEMPFR INTEGER,
CODFILIALFR SMALLINT,
CODFOR INTEGER,
OBSPAG VARCHAR(2000))
AS 
 

declare variable codpag integer;
declare variable codfilialpag integer;
declare variable numparcs integer;
declare variable valor decimal(15,5);
declare variable data date;

BEGIN     
    
    -- Buscando filial para tabela FNPAGAR
    select icodfilial from sgretfilial( :codemppp, 'FNPAGAR' ) into :codfilialpag;

    -- Gerando cdigo do pagamento
    select iseq from spgeranum( :codemppp, :codfilialpag, 'PA') into :codpag;

    -- Consultando nmero de parcelas do plano de pagamento
    select coalesce( parcplanopag, 0 ) from fnplanopag
        where codemp=:codemppp and codfilial=:codfilialpp and codplanopag=:codplanopag
        into :numparcs;

    -- Limpando empenhos anteriores
    delete from fnpagar pg where pg.codempoc=:codempoc and pg.codfilialoc=:codfilialoc and pg.codordcp=:codordcp;

    -- Precorre tabela de previses de entrega para gerar os empenhos no contas a pagar.
    for select pe.dtitpe data, sum(( io.vlrliqapitordcp/io.qtdapitordcp ) * cast(pe.qtditpe-pe.qtditentpe as decimal(8,2))) valor
        from cpitordcompra io, cpitordcomprape pe
        where
            io.codemp=:codempoc and io.codfilial=:codfilialoc and io.codordcp=:codordcp and
            pe.codemp=io.codemp and pe.codfilial=io.codfilial and pe.codordcp=io.codordcp and pe.coditordcp=io.coditordcp and
            (pe.qtditpe-pe.qtditentpe) >0
        group by pe.dtitpe
        order by pe.dtitpe
        into data, :valor

        do begin
                    
            -- Se existirem parcelas a gerar.

            if( numparcs>0 ) then
            begin

                insert into fnpagar (
                    codemp, codfilial, codpag,
                    codemppg, codfilialpg, codplanopag,
                    codempfr, codfilialfr, codfor,
                    codempoc, codfilialoc, codordcp,
                    vlrpag, vlrparcpag, vlrapagpag,
                    datapag, dtcomppag, statuspag, docpag, obspag )
                values (
                    :codempoc, :codfilialpag, :codpag,
                    :codemppp, :codfilialpp, :codplanopag,
                    :codempfr, :codfilialfr, :codfor,
                    :codempoc, :codfilialoc, :codordcp,
                    :valor, :valor, :valor,
                    :data, :data, 'P1', :codordcp, substring(:obspag from 1 for 250)
                );

                 -- Gerando cdigo do pagamento
                 select iseq from spgeranum( :codemppp, :codfilialpag, 'PA') into :codpag;

            end
     end

END ^

ALTER PROCEDURE FNADICRECEBERSP01 (TIPOVENDA CHAR(1),
CODVENDA INTEGER,
CODEMPTC INTEGER,
CODFILIALTC INTEGER,
CODTIPOCOB INTEGER,
CODEMPPG INTEGER,
CODFILIALPG SMALLINT,
CODPLANOPAG INTEGER,
CODEMPCL INTEGER,
CODFILIALCL SMALLINT,
CODCLI INTEGER,
CODEMPVD INTEGER,
CODFILIALVD SMALLINT,
CODVEND INTEGER,
VLRLIQVENDA NUMERIC(15, 5),
DTVENDA DATE,
DTCOMP DATE,
VLRCOMISVENDA NUMERIC(15, 5),
DOCVENDA INTEGER,
CODEMPBO INTEGER,
CODFILIALBO SMALLINT,
CODBANCO CHAR(3),
CODEMP INTEGER,
CODFILIAL SMALLINT,
CODEMPCB INTEGER,
CODFILIALCB SMALLINT,
CODCARTCOB CHAR(3),
CODEMPCA INTEGER,
CODFILIALCA SMALLINT,
NUMCONTA CHAR(10),
FLAG CHAR(1),
OBSREC VARCHAR(250),
VLRBASECOMIS NUMERIC(15, 5),
VLRRETENSAOISS NUMERIC(15, 5))
AS 
 
 
 
declare variable codrec integer;
declare variable codfilialrc smallint;
declare variable parcplanopag integer;
BEGIN
  SELECT R.CODREC,R.CODFILIAL FROM FNRECEBER R
     WHERE R.CODEMPVA=:CODEMP AND R.CODFILIALVA=:CODFILIAL AND
       R.TIPOVENDA=:TIPOVENDA AND R.CODVENDA=:CODVENDA
     INTO :CODREC,:CODFILIALRC;
  SELECT PARCPLANOPAG FROM FNPLANOPAG WHERE CODEMP=:CODEMPPG AND
     CODFILIAL=:CODFILIALPG AND CODPLANOPAG=:CODPLANOPAG
     INTO :PARCPLANOPAG;

  IF ( (CODREC IS NULL) AND (PARCPLANOPAG>0) ) THEN
  BEGIN
     SELECT ICODFILIAL FROM SGRETFILIAL(:CODEMP,'FNRECEBER') INTO :CODFILIALRC;
     SELECT ISEQ FROM SPGERANUM(:CODEMP,:CODFILIALRC,'RC') INTO :CODREC;

     -- Caso haja retenso de ISS deve
     if(coalesce(:vlrretensaoiss,0)>0) then
     begin
        vlrliqvenda = vlrliqvenda - vlrretensaoiss;
     end

     INSERT INTO FNRECEBER (CODEMP,CODFILIAL,CODREC, CODTIPOCOB, CODEMPTC, CODFILIALTC,
              CODPLANOPAG,CODEMPPG,CODFILIALPG,CODCLI,
              CODEMPCL,CODFILIALCL,CODVEND,CODEMPVD,CODFILIALVD,TIPOVENDA,CODVENDA,
              CODEMPVA,CODFILIALVA,VLRREC,
              VLRDESCREC,VLRMULTAREC,VLRJUROSREC,VLRPARCREC,VLRPAGOREC,
              VLRAPAGREC,DATAREC, DTCOMPREC, STATUSREC,VLRCOMIREC,DOCREC,CODBANCO,CODEMPBO,CODFILIALBO,
              CODEMPCB, CODFILIALCB, CODCARTCOB, CODEMPCA, CODFILIALCA, NUMCONTA,
              FLAG, OBSREC, vlrbasecomis)
              VALUES (
                     :CODEMP, :CODFILIALRC, :CODREC, :CODTIPOCOB, :CODEMPTC, :CODFILIALTC,
                     :CodPlanoPag, :CODEMPPG, :CODFILIALPG, :CodCli,
                     :CODEMPCL, :CODFILIALCL, :CodVend, :CODEMPVD, :CODFILIALVD, :TIPOVENDA, :CodVenda,
                     :CODEMP, :CODFILIAL, :VlrLiqVenda,
                     0,0,0,:VlrLiqVenda,0,:VlrLiqVenda,:dtVenda, :dtComp, 'R1',
                     :VlrComisVenda,:DocVenda,:CodBanco,:CODEMPBO,:CODFILIALBO,
                     :CODEMPCB, :CODFILIALCB, :CODCARTCOB, 
                     :CODEMPCA, :CODFILIALCA, :NUMCONTA,
                     :FLAG, :OBSREC,:vlrbasecomis
              );
  END
  ELSE IF (CODREC IS NOT NULL) THEN
  BEGIN
    IF (PARCPLANOPAG>0) THEN
    BEGIN
        UPDATE FNRECEBER SET ALTUSUREC='N',
              CODTIPOCOB=:CODTIPOCOB, CODEMPTC=:CODEMPTC, CODFILIALTC=:CODFILIALTC,
              CODPLANOPAG=:CodPlanoPag, CODEMPPG=:CODEMPPG, CODFILIALPG=:CODFILIALPG,
              CODCLI=:CodCli, CODEMPCL=:CODEMPCL, CODFILIALCL=:CODFILIALCL,
              CODVEND=:CodVend, CODEMPVD=:CODEMPVD, CODFILIALVD=:CODFILIALVD,
              VLRREC=:VlrLiqVenda, VLRDESCREC=0, VLRMULTAREC=0, VLRJUROSREC=0,
              VLRPARCREC=:VlrLiqVenda, VLRPAGOREC=0, VLRAPAGREC=:VlrLiqVenda,
              DATAREC=:dtVenda, VLRCOMIREC=:VlrComisVenda,
              /* STATUSREC='R1' */
              DOCREC=:DocVenda, 
              CODEMPBO=:CODEMPBO, CODFILIALBO=:CODFILIALBO, CODBANCO=:CODBANCO,
              CODEMPCB=:CODEMPCB, CODFILIALCB=:CODFILIALCB, CODCARTCOB=:CODCARTCOB,
              CODEMPCA=:CODEMPCA, CODFILIALCA=:CODFILIALCA, NUMCONTA=:NUMCONTA,
              FLAG=:FLAG, vlrbasecomis=:vlrbasecomis
             WHERE CODREC=:CODREC AND CODEMP=:CODEMP AND CODFILIAL=:CODFILIALRC;

        UPDATE FNITRECEBER SET ALTUSUITREC='S', /* Atualiza os itens de contas a */
         /* receber para ajustar automaticamente os valores no cabealho */
              CODEMPBO=:CODEMPBO, CODFILIALBO=:CODFILIALBO, CODBANCO=:CODBANCO,
              CODEMPCB=:CODEMPCB, CODFILIALCB=:CODFILIALCB, CODCARTCOB=:CODCARTCOB,
              CODEMPCA=:CODEMPCA, CODFILIALCA=:CODFILIALCA, NUMCONTA=:NUMCONTA
             WHERE CODREC=:CODREC AND CODEMP=:CODEMP AND CODFILIAL=:CODFILIALRC;
     END
     ELSE
     BEGIN
         DELETE FROM FNRECEBER WHERE CODREC=:CODREC AND CODEMP=:CODEMP AND
            CODFILIAL=:CODFILIALRC;
     END
   END

END ^

ALTER PROCEDURE FNCHECAPGTOATRASOSP (ICODCLI INTEGER,
ICODEMP INTEGER,
ICODFILIAL SMALLINT)
RETURNS (SRETORNO CHAR(1))
AS 
 
declare variable ilinhas integer;
declare variable ifilialreceber integer;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'FNRECEBER') INTO IFILIALRECEBER;
  SELECT COUNT(*) FROM FNITRECEBER IT WHERE CODREC
         IN (
            SELECT CODREC FROM FNRECEBER REC WHERE REC.CODCLI = :iCodCli
                   AND REC.CODEMPCL=:ICODEMP AND REC.CODFILIALCL=:ICODFILIAL
                   AND REC.CODREC = IT.CODREC
                   AND CODEMP=IT.CODEMP AND CODFILIAL=IT.CODFILIAL
         )
         AND STATUSITREC in ('R1') AND IT.dtvencitrec < cast('today' as date)
         AND IT.CODEMP=:ICODEMP AND IT.CODFILIAL=:IFILIALRECEBER INTO iLinhas;
  IF (iLinhas > 0) THEN
    sRetorno = 'S';
  ELSE
    sRetorno = 'N';
  SUSPEND;
END ^

ALTER PROCEDURE FNCHECAPGTOSP (CODCLI INTEGER,
CODEMP INTEGER,
CODFILIAL SMALLINT,
BLOQVDPORATRASO CHAR(1),
NUMDIASBLOQ SMALLINT)
RETURNS (RETORNO VARCHAR(15))
AS 
 
DECLARE VARIABLE LINHAS INTEGER;
DECLARE VARIABLE CODFILIALRC INTEGER;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(:CODEMP,'FNRECEBER') INTO :CODFILIALRC;
  SELECT COUNT(*) FROM FNITRECEBER IR, FNRECEBER R
     WHERE R.CODEMPCL=:CODEMP AND R.CODFILIALCL=:CODFILIAL AND R.CODCLI=:CODCLI 
       AND IR.CODEMP=R.CODEMP AND IR.CODFILIAL=R.CODFILIAL AND IR.CODREC=R.CODREC
       AND IR.STATUSITREC IN ('R1','RL')
       AND IR.CODEMP=:CODEMP AND IR.CODFILIAL=:CODFILIALRC 
       INTO :LINHAS;
  IF (LINHAS > 0) THEN
  BEGIN
    RETORNO = 'N';
    IF (BLOQVDPORATRASO = 'S' ) THEN
    BEGIN
       SELECT COUNT(*) FROM FNITRECEBER IR, FNRECEBER R
          WHERE R.CODEMPCL=:CODEMP AND R.CODFILIALCL=:CODFILIAL AND R.CODCLI=:CODCLI 
          AND IR.CODEMP=R.CODEMP AND IR.CODFILIAL=R.CODFILIAL AND IR.CODREC=R.CODREC
          AND IR.STATUSITREC IN ('R1')
          AND IR.CODEMP=:CODEMP AND IR.CODFILIAL=:CODFILIALRC
          AND ( IR.DTVENCITREC + :NUMDIASBLOQ ) < CAST( 'TODAY' as DATE)   
          INTO :LINHAS;
       IF (LINHAS>0) THEN 
          RETORNO = 'N='||:LINHAS;
    END
  END
  ELSE
    RETORNO = 'S';
  SUSPEND;
END ^

ALTER PROCEDURE FNDELETARECEBERSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
CTIPOVENDA CHAR(1),
ICODVENDA INTEGER)
RETURNS (SDELETADO SMALLINT)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

DECLARE VARIABLE ICONTADOR INTEGER;
begin
  /* Procedure Text */
  SELECT COUNT(*) FROM FNRECEBER R, FNLANCA L
    WHERE R.CODVENDA=:ICODVENDA AND R.TIPOVENDA=:CTIPOVENDA AND
     R.CODEMPVA=:ICODEMP AND R.CODFILIALVA=:SCODFILIAL AND
     L.CODEMPRC=R.CODEMP AND L.CODFILIALRC=R.CODFILIAL AND
     L.CODREC=R.CODREC
    INTO :ICONTADOR;
  IF (ICONTADOR IS NULL) THEN
     ICONTADOR = 0;
  IF (ICONTADOR=0) THEN
  BEGIN
     SDELETADO = 1;
     DELETE FROM FNRECEBER WHERE CODVENDA=:ICODVENDA AND TIPOVENDA=:CTIPOVENDA AND
       CODEMPVA=:ICODEMP AND CODFILIALVA=:SCODFILIAL;
  END
  ELSE
  BEGIN
     SDELETADO = 0;
  END
  suspend;
end ^

ALTER PROCEDURE FNESTORNACOMISSAOSP (CODEMP INTEGER,
CODFILIAL SMALLINT,
CODREC INTEGER,
NPARCITREC SMALLINT)
AS 

declare variable vlrvendacomi numeric(15,5);
declare variable vlrcomi numeric(15,5);
declare variable datacomi date;
declare variable dtcompcomi date;
declare variable dtvenccomi date;
declare variable tipocomi char(1);
declare variable statuscomi char(2);
declare variable dtatual date;
declare variable dtvencitrec date;
declare variable codempvd integer;
declare variable codfilialvd smallint;
declare variable codvend integer;
begin
  /* Procedure Text */
  dtatual = cast( 'now' as date);

  select first 1 c.statuscomi, c.tipocomi, c.codempvd, c.codfilialvd, c.codvend
  , c.vlrvendacomi, c.vlrcomi, c.datacomi, c.dtcompcomi, ir.dtvencitrec , c.dtvenccomi
  from vdcomissao c, fnitreceber ir
  where c.codemprc=:codemp and c.codfilialrc=:codfilial and c.codrec=:codrec and c.nparcitrec=:nparcitrec and tipocomi='R'
  and ir.codemp=c.codemprc and ir.codfilial=c.codfilialrc and ir.codrec=c.codrec and ir.nparcitrec=c.nparcitrec
  and c.statuscomi<>'CE'
  order by c.codcomi desc
  into :statuscomi, :tipocomi, :codempvd, :codfilialvd,  :codvend
  , :vlrvendacomi, :vlrcomi, :datacomi, :dtcompcomi, :dtvencitrec, :dtvenccomi;

  if (statuscomi not in ('CP') ) then
  begin
      update vdcomissao c set c.statuscomi='C1'
      where c.codemprc=:codemp and c.codfilialrc=:codfilial and c.codrec=:codrec and c.nparcitrec=:nparcitrec
      and tipocomi='R' and statuscomi not in ('CP','CE');
  end
  else if (statuscomi in ('CP') ) then
  begin
      vlrcomi = vlrcomi * -1; /* Transforma o valor da comisso em negativo */
      /* para gerar estorno */
      execute procedure vdadiccomissaosp(:codemp,:codfilial,:codrec,
         :nparcitrec, :vlrvendacomi, :vlrcomi, :datacomi , :dtcompcomi, :dtvenccomi,
         :tipocomi, :codempvd, :codfilialvd, : codvend );

     -- execute vdadiccomissaosp
  end

  /*UPDATE VDCOMISSAO SET STATUSCOMI='C1'
              WHERE CODREC=new.CODREC AND NPARCITREC=new.NPARCITREC
              AND CODEMPRC = new.CODEMP AND CODFILIALRC=new.CODFILIAL
              AND CODEMP=new.CODEMP AND CODFILIAL=:SCODFILIALCI
              AND STATUSCOMI NOT IN ('CE') AND TIPOCOMI='R';
    */
--  FOR SELECT C.CODCOMI,C.CODEMPRC, C.CODFILIALRC , C.CODREC, C.NPARCITREC,
--      C.VLRVENDACOMI, C.VLRCOMI, C.DATACOMI , C.DTCOMPCOMI, C.DTVENCCOMI,
--      C.TIPOCOMI, C.STATUSCOMI , IR.STATUSITREC, IR.DTVENCITREC
--    FROM VDCOMISSAO C, FNITRECEBER IR, FNRECEBER R
--    WHERE C.CODEMP=:CODEMP AND C.CODFILIAL=:CODFILIAL AND
--       IR.CODEMP=C.CODEMPRC AND IR.CODFILIAL=C.CODFILIALRC AND
--       IR.CODREC=C.CODREC AND IR.NPARCITREC=C.NPARCITREC AND
--       R.CODEMP=C.CODEMPRC AND R.CODFILIAL=C.CODFILIALRC AND
--       R.CODREC=C.CODREC
       --AND R.CODEMPVD=:CODEMPVD
       --AND
       --R.CODFILIALVD=:CODFILIALVD
       --AND R.CODVEND=:CODVEND AND
       --and ( (:CORDEM = 'V')  OR (C.DATACOMI BETWEEN :DINI AND :DFIM) ) AND
       --( (:CORDEM = 'E')  OR (C.DTVENCCOMI BETWEEN :DINI AND :DFIM) ) AND
--       and C.STATUSCOMI IN ('C2','CP') AND
--       IR.STATUSITREC NOT IN ('RP') AND
--       NOT EXISTS(SELECT * FROM VDCOMISSAO C2 /* Sub-select para verificar a */
          /* existencia de estorno anterior. */
--         WHERE C2.CODEMPRC=C.CODEMPRC AND C2.CODFILIALRC=C.CODFILIALRC AND
--         C2.CODREC=C.CODREC AND C2.NPARCITREC=C.NPARCITREC AND
--         C2.TIPOCOMI=C.TIPOCOMI AND C2.STATUSCOMI IN ('CE') )
--    INTO :CODCOMI, :CODEMP, :CODFILIAL, :CODREC, :NPARCITREC, :VLRVENDACOMI,
--      :VLRCOMI, :DATACOMI, :DTCOMPCOMI, :DTVENCCOMI, :TIPOCOMI, :STATUSCOMI, :STATUSITREC,
--      :DTVENCITREC
--  DO
--  BEGIN
--     IF ( (DTATUAL>DTVENCITREC) AND (STATUSCOMI='C2') ) THEN
     /* Caso a data atual seja maior que a data de vencimento e a */
     /* comisso no esteja paga, passa o status da comisso para no */
     /* liberada. */
--     BEGIN
--        UPDATE VDCOMISSAO SET STATUSCOMI='C1'
--          WHERE CODEMP=:CODEMP AND CODFILIAL=:CODFILIAL AND
--            CODCOMI=:CODCOMI;
--     END
--     ELSE IF ( (DTATUAL>DTVENCITREC) AND (STATUSCOMI='CP') ) THEN
     /* Caso a comisso esteja paga e a parcela esteja vencida, */
     /* gera um estorno da comisso. */
--     BEGIN
--        VLRCOMI = VLRCOMI * -1; /* Transforma o valor da comisso em negativo */
        /* para gerar estorno */
     --   EXECUTE PROCEDURE vdadiccomissaosp(:CODEMP,:CODFILIAL,:CODREC,
       --   :NPARCITREC, :VLRVENDACOMI, :VLRCOMI, :DATACOMI , :DTCOMPCOMI, :DTVENCITREC,
         -- :TIPOCOMI, :codempvd, :codfilialvd, : codvend );
--     END
--  END
 -- suspend;
end ^

ALTER PROCEDURE FNGERAITRECEBERSP01 (CALTVLR CHAR(1),
ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODREC INTEGER,
ICODEMPPG INTEGER,
SCODFILIALPG SMALLINT,
ICODPLANOPAG INTEGER,
NVLRREC NUMERIC(15, 5),
DDATAREC DATE,
DDTCOMPREC DATE,
CFLAG CHAR(1),
ICODEMPBO INTEGER,
SCODFILIALBO SMALLINT,
CCODBANCO CHAR(3),
ICODEMPTC INTEGER,
SCODFILIALTC SMALLINT,
ICODTIPOCOB INTEGER,
ICODEMPCB INTEGER,
SCODFILIALCB SMALLINT,
CODCARTCOB CHAR(3),
NVLRCOMIREC NUMERIC(15, 5),
OBSREC VARCHAR(250),
CODEMPCA INTEGER,
CODFILIALCA SMALLINT,
NUMCONTA CHAR(10),
CODEMPPN INTEGER,
CODFILIALPN SMALLINT,
CODPLAN CHAR(13),
CODEMPCC INTEGER,
CODFILIALCC SMALLINT,
ANOCC INTEGER,
CODCC CHAR(19),
VLRBASECOMIS NUMERIC(15, 5))
RETURNS (I INTEGER)
AS 
 
 
 
declare variable nperc numeric(15,5);
declare variable npercpag numeric(15,5);
declare variable nresto numeric(15,5);
declare variable inumparc integer;
declare variable idiaspag integer;
declare variable nrestocomi numeric(15,5);
declare variable nvlrcomiitrec numeric(15,5);
declare variable nvlritrec numeric(15,5);
declare variable regrvcto char(1);
declare variable rvsab char(1);
declare variable rvdom char(1);
declare variable rvfer char(1);
declare variable dtvencto date;
declare variable rvdia char(1);
declare variable dtbase date;
declare variable diavcto smallint;
declare variable casasdecfin smallint;
declare variable vlrbaseitcomis numeric(15,5);
declare variable restobasecomis numeric(15,5);
begin

    -- Inicializando variveis

    i = 0;
    nperc = 100;
    nresto = nvlrrec;
    nrestocomi = nvlrcomirec;
    dtbase = ddatarec;
    vlrbaseitcomis = vlrbasecomis;
    restobasecomis = vlrbasecomis;

    -- Buscando preferencias

    select casasdecfin from sgprefere1 where codemp=:icodemp and codfilial=:scodfilial
    into casasdecfin;

    -- Buscanco informaes do plano de pagamento
    select pp.parcplanopag, pp.regrvctoplanopag, pp.rvsabplanopag, pp.rvdomplanopag, pp.rvferplanopag, pp.rvdiaplanopag,
    pp.diavctoplanopag
    from fnplanopag pp
    where pp.codplanopag =:icodplanopag and pp.codemp=:icodemppg and pp.codfilial = :scodfilialpg
    into :inumparc, :regrvcto, :rvsab, :rvdom, :rvfer, :rvdia, :diavcto;

    -- Loop nas parcelas do plano de pagamento para gerao dos itens do contas a receber

    for select percpag, diaspag from fnparcpag
    where codplanopag=:icodplanopag and codemp=:icodemppg and codfilial =:scodfilialpg
    order by diaspag
    into :npercpag, :idiaspag
    do begin
        i = i+1;

        -- Calculando valor da parcela
        select v.deretorno from arreddouble(cast(:nvlrrec * :npercpag as numeric(15, 5))/:nperc, :casasdecfin ) v
        into :nvlritrec;

        nresto = nresto - nvlritrec;

        if (i = inumparc) then
        begin
            nvlritrec = nvlritrec + nresto;
        end

        -- Calculando o valor da comisso a pagar na parcela.
        select v.deretorno from arreddouble(cast(:nvlrcomirec * :npercpag as numeric(15, 5))/:nperc,:casasdecfin) v
        into :nvlrcomiitrec;

        nrestocomi = nrestocomi - nvlrcomiitrec;

        if (i = inumparc) then
        begin
            nvlrcomiitrec = nvlrcomiitrec + nrestocomi;
        end

         -- Calculando o valor da base da comisso especial a pagar na parcela.
        select v.deretorno from arreddouble(cast(:vlrbasecomis * :npercpag as numeric(15, 5))/:nperc,:casasdecfin) v
        into :vlrbaseitcomis;

        restobasecomis = restobasecomis - vlrbaseitcomis;

        if (i = inumparc) then
        begin
            vlrbaseitcomis = vlrbaseitcomis + restobasecomis;
        end

        -- Definindo o vencimento da parcela
        select c.dtvencret from sgcalcvencsp(:icodemp, :dtbase, :ddatarec + :idiaspag, :regrvcto,
        :rvsab, :rvdom, :rvfer, :rvdia, :diavcto, :idiaspag ) c
        into :dtvencto;

        dtbase = dtvencto;

        -- Execuntado procedimento que insere registros na tabela fnitreceber

        execute procedure fnadicitrecebersp01 (
        :caltvlr, :icodemp,:scodfilial,:icodrec,:i,0,0,0,:nvlritrec,0, :ddatarec, :ddtcomprec, :dtvencto,'R1',:cflag,
        :icodempbo,:scodfilialbo, :ccodbanco, :icodemptc, :scodfilialtc, :icodtipocob,
        :icodempcb, :scodfilialcb, :codcartcob, :nvlrcomiitrec, :obsrec, :codempca,
        :codfilialca, :numconta, :codemppn, :codfilialpn, :codplan, :codempcc, :codfilialcc, :anocc, :codcc, :vlrbaseitcomis);


    end
    suspend;
end ^

ALTER PROCEDURE FNGERASEQNOSSONUMERO (CODEMPBO INTEGER,
CODFILIALBO SMALLINT,
CODBANCO CHAR(3),
CODEMPCB INTEGER,
CODFILIALCB SMALLINT,
CODCARTCOB CHAR(3),
CODEMPCT INTEGER,
CODFILIALCT SMALLINT,
NUMCONTA CHAR(10))
RETURNS (SEQNOSSONUMERO INTEGER)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

begin
    
    seqnossonumero = 0;

    --Buscando sequencia atual;

    select first 1 coalesce(im.seqnossonumero,0)
    from fnitmodboleto im
    where im.codempcb=:codempcb and im.codfilialcb=:codfilialcb and im.codcartcob=:codcartcob
    and im.codempbo=:codempbo and im.codfilialbo=:codfilialbo and im.codbanco=:codbanco
    and im.codempct=:codempct and im.codfilialct=:codfilialct and im.numconta=:numconta
    into seqnossonumero;

    --Incrementando sequencia;

    seqnossonumero = seqnossonumero + 1;

    --Atualizando sequencia na tabela de itens de modelo

    update fnitmodboleto im set im.seqnossonumero=:seqnossonumero
    where im.codempcb=:codempcb and im.codfilialcb=:codfilialcb and im.codcartcob=:codcartcob
    and im.codempbo=:codempbo and im.codfilialbo=:codfilialbo and im.codbanco=:codbanco
    and im.codempct=:codempct and im.codfilialct=:codfilialct and im.numconta=:numconta;

    suspend;

end ^

ALTER PROCEDURE FNITRECEBERSP01 (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODREC INTEGER,
NVLRPARCREC NUMERIC(15, 5),
NVLRCOMIREC NUMERIC(15, 5),
INROPARCREC INTEGER,
CCLASCOMIS CHAR(1))
AS 
 
 
 
declare variable inparcitrec integer;
declare variable nvlrparcitrec numeric(15,5);
declare variable nperc numeric(10,6);
declare variable nvlrcomiitrec numeric(15,5);
declare variable nresto numeric(15,5);
declare variable dvencitrec date;
begin
    -- Procedure que atualiza a comisso na tabela ITRECEBER
    nResto = nVlrComiRec;

    for select nparcitrec, vlrparcitrec, dtvencitrec from fnitreceber
    where codemp=:icodemp and codfilial=:scodfilial and codrec=:icodrec
    order by nparcitrec
    into :inparcitrec , :nvlrparcitrec, :dvencitrec do

    begin
        nperc = nvlrparcitrec / nvlrparcrec;
        nvlrcomiitrec = cast( (nvlrcomirec * nperc) as numeric(15, 5) );
        nresto = nresto - nvlrcomiitrec;

        if (inparcitrec=inroparcrec) then
        begin
            nvlrcomiitrec = nvlrcomiitrec + nresto;
        end

        update fnitreceber ir set vlrcomiitrec=:nvlrcomiitrec where codemp=:icodemp and codfilial=:scodfilial
        and codrec=:icodrec and nparcitrec=:inparcitrec;

        if (cclascomis='S') then
            execute procedure vdgeracomissaosp(:icodemp, :scodfilial, :icodrec, :inparcitrec, :nvlrcomiitrec, :dvencitrec);
    end
    suspend;
end ^

ALTER PROCEDURE FNLIBCREDSP (CODEMPVD INTEGER,
CODFILIALVD INTEGER,
TIPOVENDA CHAR(1),
CODVENDA INTEGER,
CODCLI INTEGER,
CODEMPCL INTEGER,
CODFILIALCL INTEGER,
VLRVENDA NUMERIC(15, 5),
VLRADIC NUMERIC(15, 2),
CODITEM INTEGER)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

declare variable prefcred char(1);
declare variable codfilial integer;
declare variable vlrcredito numeric(15,5);
declare variable ecf char(1);
declare variable vlraberto numeric(15,5);
declare variable agrup char(1);
declare variable codempclip integer;
declare variable codfilialclip smallint;
declare variable codclip integer;
declare variable vlrdif numeric(15,2);
declare variable vlrautorizado numeric(15,2);
declare variable vlrpedidoant numeric(15,2);
declare variable vlrautorizadotot numeric(15,2);
begin
    select icodfilial from sgretfilial(:codempcl,'FNLIBCRED') into codfilial;
    select prefcred,lcredglobal from sgprefere1 where codemp=:codempcl and codfilial=:codfilial into prefcred, agrup;

    select first 1 cx.ecfcaixa from pvcaixa cx, sgconexao con, sgestacao est
        where est.codemp=con.codemp and est.codfilial=con.codfilial
            and est.codest=con.codterm AND cx.codfilialet=est.codfilial
            and cx.codempet=est.codemp AND cx.codest=est.codest
            and con.nrconexao=current_connection and conectado > 0
    into ecf;

    if (prefcred = 'N' or ecf='S') then /* No verificar */
        exit;
    else if (prefcred = 'L') then /*Liberar se no ultrapassar o crdito pr aprovado */
        begin

             if( :coditem is not null and :vlradic is not null  ) then
             begin
                select vi.vlrproditvenda from vditvenda vi where vi.codemp=:codempvd
                and vi.codfilial=:codfilialvd and vi.codvenda=:codvenda
                and vi.tipovenda=:tipovenda and vi.coditvenda=:coditem into :vlrdif;
             end

            vlrvenda = coalesce(vlrvenda,0) + ( coalesce(vlradic,0) - coalesce(:vlrdif,0) );

            /* busca informaes do cliente principal */
            select cli.codemppq, cli.codfilialpq, cli.codpesq
                from vdcliente cli
                where cli.codemp=:codempcl and cli.codfilial=:codfilialcl and cli.codcli=:codcli
            into codempclip, codfilialclip, codclip;

            if(agrup = 'S') then /* Verifica se deve agrupar despesas dos sub-clientes */
            begin
                /* BUSCA DE VALORES EM ABERTO */
                select coalesce(sum( (coalesce(it.vlrparcitrec,0)) - (coalesce(it.vlrpagoitrec,0)) ),0)
                    from fnreceber r, vdvenda v,fnitreceber it, vdcliente cl
                    where cl.codemppq=:codempclip and cl.codfilialpq=:codfilialclip and cl.codpesq=:codclip
                        and r.codempcl=cl.codemp and r.codfilialcl=cl.codfilial and r.codcli=cl.codcli
                        and (r.codempvd!=:codempvd or r.codfilialvd!=:codfilialvd or R.codvenda!=:codvenda or R.tipovenda!=:tipovenda) /* no deve contar com a venda atual */
                        and v.codemp=r.codempvd and v.codfilial=v.codfilialvd and v.codvenda=r.codvenda and v.tipovenda=r.tipovenda
                        and it.codemp=r.codemp and it.codfilial=r.codfilial and it.codrec=r.codrec and it.statusitrec not in ('RP')
                into vlraberto;

                /* BUSCA VALOR AUTORIZADO/LIBERADO */
                vlrautorizadotot = 0;
                for select lc.vlrautorizlcred,lc.vlrvendacred
                    from fnlibcred lc
                    where lc.codemp=:codempvd and lc.codfilial=:codfilialvd
                        and lc.codfilialvd=:codfilialvd and lc.codempcl=:codempcl
                        and lc.codfilialcl=:codfilialcl and lc.tipovenda=:tipovenda
                        and lc.codvenda=:codvenda and lc.dtavctolcred >= cast('today' as date)
                into :vlrautorizado, :vlrpedidoant do
                begin
                    vlrautorizadotot = :vlrautorizadotot + :vlrautorizado;
                end

                /* BUSCA DE LIMITE */
                select sum(coalesce(tc.vlrtpcred,0))
                    from fntipocred tc, vdcliente cl
                    where cl.codemppq=:codempclip and cl.codfilial=:codfilialcl and cl.codpesq=:codclip
                        and tc.codtpcred=cl.codtpcred and tc.codemp=cl.codemptr and tc.codfilial=cl.codfilialtr
                        and cast('today' as date) <= cl.dtvenctotr
                into vlrcredito;

                /* VALOR DO CREDITO  A SOMA DO CREDITO PR-FIXADO + O VALOR LIBERADO PARA O PEDIDO*/
                vlrcredito = vlrcredito + vlrautorizadotot;

            end
            else /* Caso no deva agrupar as despesas dos sub-clientes */
            begin

                /* BUSCA DE VALORES EM ABERTO */

                select coalesce(sum( (coalesce(it.vlrparcitrec,0)) - (coalesce(it.vlrpagoitrec,0)) ),0)
                    from fnreceber r, vdvenda v,fnitreceber it, vdcliente cl
                    where cl.codemp=:codempvd and cl.codfilial=:codfilialvd and cl.codcli=:codcli
                        and r.codempcl=cl.codemp and r.codfilialcl=cl.codfilial and r.codcli=cl.codcli
                        and (r.codempvd!=:codempvd or r.codfilialvd!=:codfilialvd or R.codvenda!=:codvenda or R.tipovenda!=:tipovenda) /* no deve contar com a venda atual */
                        and v.codemp=r.codempvd and v.codfilial=v.codfilialvd and v.codvenda=r.codvenda and v.tipovenda=r.tipovenda
                        and it.codemp=r.codemp and it.codfilial=r.codfilial and it.codrec=r.codrec and it.statusitrec not in ('RP')
                into vlraberto;

                /* BUSCA VALOR AUTORIZADO/LIBERADO */
                vlrautorizadotot = 0;
                for select lc.vlrautorizlcred,lc.vlrvendacred
                    from fnlibcred lc
                    where lc.codemp=:codempvd and lc.codfilial=:codfilialvd
                        and lc.codfilialvd=:codfilialvd and lc.codempcl=:codempcl
                        and lc.codfilialcl=:codfilialcl and lc.tipovenda=:tipovenda
                        and lc.codvenda=:codvenda and lc.dtavctolcred >= cast('today' as date)
                into :vlrautorizado, :vlrpedidoant do
                begin
                    vlrautorizadotot = :vlrautorizadotot + :vlrautorizado;
                end

                /* BUSCA DE LIMITE */
                select coalesce(tc.vlrtpcred,0)
                    from fntipocred tc, vdcliente cl
                    where cl.codcli=:codcli and cl.codemp=:codempcl
                        and cl.codfilial=:codfilialcl AND tc.codtpcred=cl.codtpcred
                        and tc.codemp=cl.codemptr and tc.codfilial=cl.codfilialtr
                        and cast('today' as date) <= cl.dtvenctotr
                into vlrcredito;
                
                /* VALOR DO CREDITO  A SOMA DO CREDITO PR-FIXADO + O VALOR LIBERADO PARA O PEDIDO*/
                vlrcredito = vlrcredito + vlrautorizadotot;

            end

            /* CASO J EXISTA UM VALOR AUTORIZADO E O VALOR DO PEDIDO NO AUMENTOU, NO DEVE BLOQUEAR A VENDA*/
            if(vlrautorizadotot>0 and vlrpedidoant>=vlrvenda) then
            begin
                exit;
            end
            else if (vlrcredito > 0) then
                begin
                    if ( (vlrvenda + vlraberto ) <= vlrcredito) then
                        exit;
                    else
                        exception vdvendaex04 'VENDA:' || cast(vlrvenda as char(15)) || 'AB.: ' || cast(vlraberto as char(15)) || 'CRED.:' || cast(vlrcredito as char(15));
                        /*Valor pre-aprovado insuficiente*/
                end
        end
    suspend;
end ^

ALTER PROCEDURE FNSALDOPLANSP (ICODEMPPN INTEGER,
ICODFILIALPN INTEGER,
SCODPLANANT CHAR(13),
DDATAANT DATE,
DVLRANT NUMERIC(15, 5),
SCODPLANATU CHAR(13),
DDATAATU DATE,
DVLRATU NUMERIC(15, 5))
RETURNS (SRETORNO CHAR(1))
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

DECLARE VARIABLE sCodPlan CHAR(13);
  DECLARE VARIABLE dDataSl DATE;
  DECLARE VARIABLE dTmp DATE;
  DECLARE VARIABLE dSaldoSl NUMERIC(15, 5);
  DECLARE VARIABLE dSaldoSlAnt NUMERIC(15, 5);
  DECLARE VARIABLE IFILIALSALDO INTEGER;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMPPN,'FNSALDOLANCA') INTO IFILIALSALDO;
  IF (dVlrAnt IS NULL) THEN
     dVlrAnt = 0;
  IF (dVlrAtu IS NULL) THEN
     dVlrAtu = 0;
  IF ((sCodPlanAnt IS NOT NULL) AND (rtrim(sCodPlanAnt) != '')) THEN
  BEGIN
    SELECT CODPLAN,DATASL,SALDOSL FROM FNSALDOLANCA WHERE CODPLAN=:sCodPlanAnt
           AND DATASL =: dDataAnt AND CODEMP=:ICODEMPPN AND CODFILIAL=:IFILIALSALDO
           AND CODEMP=:ICODEMPPN AND CODFILIAL=:ICODFILIALPN INTO sCodPlan,dDataSl,dSaldoSl;
    IF ((sCodPlan = sCodPlanAnt) AND (dDataSl = dDataAnt)) THEN
    BEGIN
      UPDATE FNSALDOLANCA SET SALDOSL =:dSaldoSl-:dVlrAnt WHERE CODPLAN=:sCodPlanAnt
             AND DATASL =:dDataAnt AND CODEMP=:ICODEMPPN AND CODFILIAL=:IFILIALSALDO
             AND CODEMP=:ICODEMPPN AND CODFILIAL=:ICODFILIALPN;
      FOR SELECT DATASL,SALDOSL FROM FNSALDOLANCA WHERE CODPLAN=:sCodplanAnt
          AND DATASL >:dDataAnt AND CODEMP=:ICODEMPPN AND CODFILIAL=:IFILIALSALDO
          AND CODEMP=:ICODEMPPN AND CODFILIAL=:ICODFILIALPN INTO :dTmp,:dSaldoSlAnt DO
      BEGIN
         if (:dSaldoSlAnt IS NULL) THEN
            dSaldoSlAnt = 0;
         UPDATE FNSALDOLANCA SET SALDOSL = :dSaldoSlAnt-:dVlrAnt WHERE CODPLAN=:sCodplanAnt
                AND DATASL =:dTmp AND CODEMP=:ICODEMPPN AND CODFILIAL=:IFILIALSALDO
                AND CODEMP=:ICODEMPPN AND CODFILIAL=:ICODFILIALPN;
        SUSPEND;
      END
    END
    ELSE
    BEGIN
      SELECT SALDOSL FROM FNSALDOLANCA WHERE CODPLAN=:sCodPlanAnt
             AND DATASL<:dDataAnt AND CODEMP=:ICODEMPPN AND CODFILIAL=:IFILIALSALDO
             AND CODEMP=:ICODEMPPN AND CODFILIAL=:ICODFILIALPN INTO dSaldoSlAnt;
      IF (dSaldoSlAnt IS NULL) THEN
          dSaldoSlAnt = 0;
      INSERT INTO FNSALDOLANCA (CODEMP,CODFILIAL,CODPLAN,CODFILIALPN,CODEMPPN,DATASL,PREVSL,SALDOSL)
             VALUES (
                    :ICODEMPPN,:IFILIALSALDO,:sCodPlanAnt,:ICODEMPPN,:ICODFILIALPN,:dDataAnt,0,:dSaldoSlAnt-:dVlrAnt
             );
      FOR SELECT DATASL,SALDOSL FROM FNSALDOLANCA WHERE CODPLAN=:sCodplanAnt
                 AND DATASL >:dDataAnt AND CODEMP=:ICODEMPPN AND CODFILIAL=:IFILIALSALDO
                 AND CODEMP=:ICODEMPPN AND CODFILIAL=:ICODFILIALPN INTO :dTmp,:dSaldoSlAnt DO
      BEGIN
        if (:dSaldoSlAnt IS NULL) THEN
           dSaldoSlAnt = 0;
        UPDATE FNSALDOLANCA SET SALDOSL = :dSaldoSlAnt-:dVlrAnt WHERE CODPLAN=:sCodplanAnt
               AND DATASL =:dTmp AND CODEMP=:ICODEMPPN AND CODFILIAL=:IFILIALSALDO
               AND CODEMP=:ICODEMPPN AND CODFILIAL=:ICODFILIALPN;
        SUSPEND;
      END
    END
  END
  IF ( (sCodPlanAtu IS NOT NULL) AND (rtrim(sCodPlanAtu) != '')) THEN
  BEGIN
    SELECT CODPLAN,DATASL,SALDOSL FROM FNSALDOLANCA WHERE CODPLAN=:sCodPlanAtu
           AND DATASL =: dDataAtu AND CODEMP=:ICODEMPPN AND CODFILIAL=:IFILIALSALDO
  AND CODEMP=:ICODEMPPN AND CODFILIAL=:ICODFILIALPN INTO sCodPlan,dDataSl,dSaldoSl;
    IF ((sCodPlan = sCodPlanAtu) AND (dDataSl = dDataAtu)) THEN
    BEGIN
      UPDATE FNSALDOLANCA SET SALDOSL =:dSaldoSl+:dVlrAtu WHERE CODPLAN=:sCodPlanAtu
             AND DATASL =:dDataAtu AND CODEMP=:ICODEMPPN AND CODFILIAL=:IFILIALSALDO
             AND CODEMP=:ICODEMPPN AND CODFILIAL=:ICODFILIALPN;
      FOR SELECT DATASL,SALDOSL FROM FNSALDOLANCA WHERE CODPLAN=:sCodplanAtu
                 AND DATASL >:dDataAtu AND CODEMP=:ICODEMPPN AND CODFILIAL=:IFILIALSALDO
                 AND CODEMP=:ICODEMPPN AND CODFILIAL=:ICODFILIALPN INTO :dTmp,:dSaldoSlAnt DO
      BEGIN
        if (:dSaldoSlAnt IS NULL) THEN
           dSaldoSlAnt = 0;
        UPDATE FNSALDOLANCA SET SALDOSL = :dSaldoSlAnt+:dVlrAtu WHERE CODPLAN=:sCodplanAtu
               AND DATASL =:dTmp AND CODEMP=:ICODEMPPN AND CODFILIAL=:IFILIALSALDO
               AND CODEMP=:ICODEMPPN AND CODFILIAL=:ICODFILIALPN;
        SUSPEND;
      END
    END
    ELSE
    BEGIN
      SELECT SALDOSL FROM FNSALDOLANCA WHERE CODPLAN=:sCodPlanAtu
             AND DATASL<:dDataAtu AND CODEMP=:ICODEMPPN AND CODFILIAL=:IFILIALSALDO
             AND CODEMP=:ICODEMPPN AND CODFILIAL=:ICODFILIALPN INTO dSaldoSlAnt;
      IF (dSaldoSlAnt IS NULL) THEN
          dSaldoSlAnt = 0;
      INSERT INTO FNSALDOLANCA (CODEMP,CODFILIAL,CODPLAN,CODEMPPN,CODFILIALPN,DATASL,PREVSL,SALDOSL)
             VALUES (
                    :ICODEMPPN,:IFILIALSALDO,:sCodPlanAtu,:ICODEMPPN,:ICODFILIALPN,:dDataAtu,0,:dSaldoSlAnt+:dVlrAtu
             );
      FOR SELECT DATASL,SALDOSL FROM FNSALDOLANCA WHERE CODPLAN=:sCodplanAtu
                 AND DATASL >:dDataAtu AND CODEMP=:ICODEMPPN AND CODFILIAL=:IFILIALSALDO
                 AND CODEMP=:ICODEMPPN AND CODFILIAL=:ICODFILIALPN INTO :dTmp,:dSaldoSlAnt DO
      BEGIN
        if (:dSaldoSlAnt IS NULL) THEN
           dSaldoSlAnt = 0;
        UPDATE FNSALDOLANCA SET SALDOSL = :dSaldoSlAnt+:dVlrAtu WHERE CODPLAN=:sCodplanAtu
               AND DATASL =:dTmp AND CODEMP=:ICODEMPPN AND CODFILIAL=:IFILIALSALDO
               AND CODEMP=:ICODEMPPN AND CODFILIAL=:ICODFILIALPN;
        SUSPEND;
      END
    END
  END
  SUSPEND;
END ^

ALTER PROCEDURE GERAEXPEDIENTESP (CODEMPFE INTEGER,
CODFILIALFE SMALLINT,
CODEMPTO INTEGER,
CODFILIALTO SMALLINT,
ANOEXP SMALLINT)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
DECLARE VARIABLE codturno smallint; 
DECLARE VARIABLE dataini date;
DECLARE VARIABLE datafer date;
DECLARE VARIABLE mesexped smallint;
DECLARE VARIABLE anotmp smallint;
DECLARE VARIABLE horasexped decimal(15,5);
DECLARE VARIABLE trabsabturno char(1);
DECLARE VARIABLE trabdomturno char(1);
DECLARE VARIABLE diasemana smallint;
BEGIN
   dataini = null;
   FOR SELECT T.CODTURNO, T.TRABSABTURNO, T.TRABDOMTURNO, 
     ((T.HINIINTTURNO-T.HINITURNO)+(T.HFIMTURNO-T.HFIMINTTURNO))/60/60 HORASEXPED 
     FROM RHTURNO T
     WHERE T.CODEMP=:codempto and T.CODFILIAL=:codfilialto
     INTO :codturno, :trabsabturno, :trabdomturno, :horasexped DO 
   begin
      DELETE FROM RHEXPEDIENTE 
        WHERE CODEMP=:codempto and CODFILIAL=:codfilialto and CODTURNO=:codturno and ANOEXPED=:anoexp;
      DELETE FROM RHEXPEDMES
        WHERE CODEMP=:codempto and CODFILIAL=:codfilialto and CODTURNO=:codturno and ANOEXPED=:anoexp;
      dataini = cast( '01.01.'||cast(:anoexp as char(4)) as date);  
      anotmp = anoexp; 
      WHILE ( :anotmp=:anoexp )  DO 
      begin
         DATAFER=NULL;
         -- Verificao de sbados e domingos
         -- Expresso weekday retorna 0 para domingo e 6 para sbado
         diasemana = extract(weekday from :dataini);
         if ( ( (:trabsabturno='S') or (:diasemana<>6) ) and ( (:trabdomturno='S') or (:diasemana<>0) ) )  then
         begin
            --exception VDVENDAEX01 'Teste'||:dataini;

            SELECT F.DATAFER FROM SGFERIADO F
              WHERE F.CODEMP=:codempfe and F.CODFILIAL=:codfilialfe and F.DATAFER=:dataini and F.TRABFER='S' 
              INTO :DATAFER;
            if ( (:datafer is null) or (:datafer<>:dataini)) then
            begin
               mesexped = extract( month from :dataini);
               INSERT INTO RHEXPEDIENTE 
                        (CODEMP, CODFILIAL, CODTURNO, DTEXPED, ANOEXPED, MESEXPED, HORASEXPED)
                 VALUES (:codempto, :codfilialto, :codturno, :dataini, :anoexp, :mesexped, :horasexped);
            end
         end
         DATAINI=:DATAINI+1;
         anotmp = EXTRACT( YEAR FROM :DATAINI); 
      end
      INSERT INTO RHEXPEDMES( CODEMP, CODFILIAL, CODTURNO, ANOEXPED, MESEXPED, HORASEXPED )
        SELECT CODEMP, CODFILIAL, CODTURNO, ANOEXPED, MESEXPED, SUM(HORASEXPED) HORASEXPED
        FROM RHEXPEDIENTE 
        WHERE CODEMP=:codempto and CODFILIAL=:codfilialto and CODTURNO=:codturno and 
           ANOEXPED=:anoexp
        GROUP BY CODEMP, CODFILIAL, CODTURNO, ANOEXPED, MESEXPED;
   end
   suspend;
END ^

ALTER PROCEDURE GERAVISITASSP (NUMVISITAS INTEGER,
TIPOVISITA CHAR(10),
CODATEND INTEGER,
CODFILIALATEND INTEGER,
CODEMPATEND INTEGER,
CODCLI INTEGER,
CODFILIALCLI INTEGER,
CODEMPCLI INTEGER,
DATA DATE)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

begin
INSERT INTO tkhistorico (CODEMP,CODFILIAL,CODHISTTK,DESCHISTTK,SITHISTTK,DATAHISTTK,HORAHISTTK,CODEMPCL,CODFILIALCL,CODCLI,CODEMPAE,CODFILIALAE,CODATEND,TIPOHISTTK)
VALUES(4,1,coalesce((SELECT MAX(CODHISTTK) from tkhistorico)+1,1),'VISITA','EF',:DATA,(CAST('now' AS TIME)),:CODEMPCLI,:CODFILIALCLI,:CODCLI,:CODEMPATEND,:CODFILIALATEND,:CODATEND,:TIPOVISITA);
suspend;
end ^

ALTER PROCEDURE LFBUSCAFISCALSP (CODEMP INTEGER,
CODFILIAL INTEGER,
CODPROD INTEGER,
CODEMPCF INTEGER,
CODFILIALCF INTEGER,
CODCF INTEGER,
CODEMPTM INTEGER,
CODFILIALTM SMALLINT,
CODTIPOMOV INTEGER,
TIPOBUSCA CHAR(2),
CODNAT CHAR(4),
CODEMPIFP INTEGER,
CODFILIALIFP SMALLINT,
CODFISCP CHAR(13),
CODITFISCP INTEGER)
RETURNS (ORIGFISC CHAR(1),
CODTRATTRIB CHAR(2),
REDFISC NUMERIC(9, 2),
TIPOFISC CHAR(2),
CODMENS INTEGER,
ALIQFISC NUMERIC(9, 2),
ALIQIPIFISC NUMERIC(9, 2),
TPREDICMSFISC CHAR(1),
TIPOST CHAR(2),
MARGEMVLAGR NUMERIC(15, 2),
CODEMPIF INTEGER,
CODFILIALIF SMALLINT,
CODFISC CHAR(13),
CODITFISC INTEGER,
ALIQFISCINTRA NUMERIC(9, 2),
ALIQPIS NUMERIC(9, 2),
ALIQCOFINS NUMERIC(9, 2),
ALIQCSOCIAL NUMERIC(9, 2),
ALIQIR NUMERIC(9, 2),
REDBASEST CHAR(1),
ALIQISS NUMERIC(6, 2),
ADICIPIBASEICMS CHAR(1),
CALCSTCM CHAR(1),
ALIQICMSSTCM NUMERIC(9, 2))
AS 

declare variable noestcf char(1);
declare variable codfisccf integer;
declare variable codempfccf integer;
declare variable codfilialfccf integer;
declare variable ufcf char(2);
declare variable uffilial char(2);
begin

    -- Se for uma busca para venda
    if(:tipobusca='VD') then
    begin
    select coalesce(siglauf,ufcli),codempfc,codfilialfc,codfisccli
        from vdcliente
        where codemp=:codempcf and codfilial=:codfilialcf and codcli=:codcf
        into ufcf,codempfccf,codfilialfccf,codfisccf;
        end
    -- Se for uma busca para compra
    else if(:tipobusca='CP') then
    begin
        select coalesce(siglauf,uffor),codempff,codfilialff,codfiscfor
        from cpforneced fr
        where codemp=:codempcf and codfilial=:codfilialcf and codfor=:codcf
            into ufcf,codempfccf,codfilialfccf,codfisccf;
    end

    --Busca o estado da Filial
    select siglauf from sgfilial where codemp=:codemp and codfilial=:codfilial
    into uffilial;

    --Compara estado da filial com estado do cliente ou fornecedor
    if(uffilial=ufcf) then
    begin
        NOESTCF='S';
    end
    else
    begin
        NOESTCF='N';
    end

    -- Se o tem de classificao fiscal no foi informado deve realizar as buscas para descobrir...
    if(coditfiscp is null) then
    begin

       /*Primeira busca, mais especfica para o tipo fiscal do cliente ou fornecedor e estado de destino da mercadoria*/

        for select it.origfisc,it.codtrattrib,it.redfisc,it.aliqfisc,it.tipofisc,it.codmens,it.aliqipifisc,
                   it.tpredicmsfisc,it.tipost,it.margemvlagr,it.codemp,it.codfilial,it.codfisc,it.coditfisc,
                   it.aliqfiscintra,it.aliqpisfisc,it.aliqcofinsfisc,it.aliqcsocialfisc,it.aliqirfisc, it.redbasest
                   ,coalesce(it.aliqissfisc, f.percissfilial ), it.adicipibaseicms, it.calcstcm, it.aliqicmsstcm
            from lfitclfiscal it, eqproduto p, sgfilial f
            where p.codprod=:codprod and p.codfilial=:codfilial and p.codemp=:codemp and it.codemp=p.codempfc
                and it.codfilial=p.codfilialfc and it.codfisc=p.codfisc and it.noufitfisc=:noestcf
                and ((it.codtipomov=:codtipomov and it.codemptm=:codemptm and it.codfilial=:codfilialtm) or (it.codtipomov is null))
                and  ((it.codfisccli=:codfisccf and it.codempfc=:codempfccf and it.codfilialfc=:codfilialfccf) or (it.codfisccli is null))
                and it.siglauf=:ufcf and it.tipousoitfisc=:tipobusca
                and f.codemp=:codemp and f.codfilial=:codfilial
                and it.ativoitfisc='S'
            order by it.codtipomov desc, it.codfisccli desc
        into origfisc,codtrattrib,redfisc,aliqfisc,tipofisc,codmens,aliqipifisc,tpredicmsfisc,tipost,margemvlagr,
            codempif,codfilialif,codfisc,coditfisc,aliqfiscintra,aliqpis,aliqcofins,aliqcsocial,aliqir, redbasest
            , :aliqiss, :adicipibaseicms, :calcstcm, :aliqicmsstcm
        do
        begin
            -- Definio do ICMS
            -- caso no tenha encontrato aliquota de icms e tratamento tributrio no for (isento, isento ou n.trib, n.trib., suspenso)
    
            if(codtrattrib not in ('40','30','41','50') and (aliqfisc is null or aliqfisc=0 ) ) then
            begin
                select coalesce(percicms,0) from lfbuscaicmssp (:codnat,:ufcf,:codemp,:codfilial)
                into aliqfisc;
            end

            suspend;
            exit;
        end

        /* Segunda busca, mais especfica para o tipo fiscal do cliente*/
        for select it.origfisc,it.codtrattrib,it.redfisc,it.aliqfisc,it.tipofisc,it.codmens,it.aliqipifisc,
                   it.tpredicmsfisc,it.tipost,it.margemvlagr,it.codemp,it.codfilial,it.codfisc,it.coditfisc,
                   it.aliqfiscintra,it.aliqpisfisc,it.aliqcofinsfisc,it.aliqcsocialfisc,it.aliqirfisc, it.redbasest
                   ,coalesce(it.aliqissfisc, f.percissfilial), it.adicipibaseicms, it.calcstcm, it.aliqicmsstcm
            from lfitclfiscal it, eqproduto p, sgfilial f
            where p.codprod=:codprod and p.codfilial=:codfilial and p.codemp=:codemp and it.codemp=p.codempfc
                and it.codfilial=p.codfilialfc and it.codfisc=p.codfisc and it.noufitfisc=:noestcf
                and (((it.codtipomov=:codtipomov and it.codemptm=:codemptm and it.codfilial=:codfilialtm) or (it.codtipomov is null))
                and   (it.codfisccli=:codfisccf and it.codempfc=:codempfccf and it.codfilialfc=:codfilialfccf))
                and ( it.siglauf=:ufcf or it.siglauf is null )
                and it.tipousoitfisc=:tipobusca
                and f.codemp=:codemp and f.codfilial=:codfilial
                and it.ativoitfisc='S'
            order by it.coditfisc
        into origfisc,codtrattrib,redfisc,aliqfisc,tipofisc,codmens,aliqipifisc,tpredicmsfisc,tipost,margemvlagr,
            codempif,codfilialif,codfisc,coditfisc,aliqfiscintra,aliqpis,aliqcofins,aliqcsocial,aliqir, redbasest
            , aliqiss, :adicipibaseicms, :calcstcm, :aliqicmsstcm
        do
        begin

            -- Definio do ICMS
            -- caso no tenha encontrato aliquota de icms e tratamento tributrio no for (isento, isento ou n.trib, n.trib., suspenso)

            if(codtrattrib not in ('40','30','41','50') and (aliqfisc is null or aliqfisc=0 ) ) then
            begin
                select coalesce(percicms,0) from lfbuscaicmssp (:codnat,:ufcf,:codemp,:codfilial)
                into aliqfisc;
            end

            suspend;
            exit;
        end

        /* Terceira busca, mais genrica, pega excees sem tipo de movimento e tipo fiscal do cliente,
          s  executada quando a SELECT acima no retornar nenhum valor. */
        for select it.origfisc,it.codtrattrib,it.redfisc,it.aliqfisc,it.tipofisc,it.codmens,it.aliqipifisc,it.tpredicmsfisc,
            it.tipost,it.margemvlagr,it.codemp,it.codfilial,it.codfisc,it.coditfisc,it.aliqfiscintra,it.aliqpisfisc,
            it.aliqcofinsfisc,it.aliqcsocialfisc,it.aliqirfisc, it.redbasest,coalesce(it.aliqissfisc, f.percissfilial)
            , it.adicipibaseicms, it.calcstcm, it.aliqicmsstcm
            from lfitclfiscal it, eqproduto p, sgfilial f
            where
                p.codprod=:codprod and p.codfilial=:codfilial and p.codemp=:codemp and
                it.codemp=p.codempfc and it.codfilial=p.codfilialfc and it.codfisc=p.codfisc and
                it.noufitfisc=:noestcf and
                ( (it.codtipomov=:codtipomov and it.codemptm=:codemptm and it.codfilial=:codfilialtm) or
                  (it.codfisccli=:codfisccf and it.codempfc=:codempfccf and it.codfilialfc=:codfilialfccf) or
                  (it.codfisccli is null and it.codtipomov is null) ) 
                   and ( it.siglauf=:ufcf or it.siglauf is null )
                   and it.tipousoitfisc=:tipobusca
                   and f.codemp=:codemp and f.codfilial=:codfilial
                   and it.ativoitfisc='S'
            order by it.coditfisc
            into origfisc,codtrattrib,redfisc,aliqfisc,tipofisc,codmens,aliqipifisc,tpredicmsfisc,tipost,margemvlagr,
                codempif,codfilialif,codfisc,coditfisc,aliqfiscintra,aliqpis,aliqcofins,aliqcsocial,aliqir, redbasest
                , aliqiss, :adicipibaseicms, :calcstcm, :aliqicmsstcm
        do
        begin
            -- Definio do ICMS
            -- caso no tenha encontrato aliquota de icms e tratamento tributrio no for (isento, isento ou n.trib, n.trib., suspenso)

            if(codtrattrib not in ('40','30','41','50') and (aliqfisc is null or aliqfisc=0 ) ) then
            begin
                select coalesce(percicms,0) from lfbuscaicmssp (:codnat,:ufcf,:codemp,:codfilial)
                into aliqfisc;
            end

        suspend;
            exit;
        end

        /*Quarta busca, mais genrica, sem filtros por tipo de movimento e tipo fiscal.
        s  executada quando as SELECTS acima no retornarem nenhum valor.*/
        select f.origfisc,f.codtrattrib,f.redfisc,f.aliqfisc,f.tipofisc, f.aliqipifisc, f.tpredicmsfisc, f.tipost, f.margemvlagr,
            f.codemp,f.codfilial,f.codfisc,f.coditfisc,f.aliqfiscintra,f.aliqpisfisc,f.aliqcofinsfisc,f.aliqcsocialfisc,f.aliqirfisc,f.redbasest
            ,coalesce(f.aliqissfisc, f1.percissfilial), f.adicipibaseicms, f.calcstcm, f.aliqicmsstcm
        from lfitclfiscal f, eqproduto p, sgfilial f1
        where
            p.codprod=:CODPROD and p.codfilial=:CODFILIAL and p.codemp=:CODEMP and
            f.codemp=p.codempfc and f.codfilial=p.codfilialfc and f.codfisc=p.codfisc and
            f.geralfisc='S' and f.tipousoitfisc=:tipobusca
            and f1.codemp=:codemp and f1.codfilial=:codfilial
            and f.ativoitfisc='S'
        into origfisc,codtrattrib,redfisc,aliqfisc,tipofisc,aliqipifisc,tpredicmsfisc,tipost,margemvlagr,
            codempif,codfilialif,codfisc,coditfisc,aliqfiscintra,aliqpis,aliqcofins,aliqcsocial,aliqir,redbasest
            ,aliqiss, :adicipibaseicms, :calcstcm, :aliqicmsstcm;
    
        -- Definio do ICMS
        -- caso no tenha encontrato aliquota de icms e tratamento tributrio no for (isento, isento ou n.trib, n.trib., suspenso)

        if(codtrattrib not in ('40','30','41','50') and (aliqfisc is null or aliqfisc=0 ) ) then
        begin
            select coalesce(percicms,0) from lfbuscaicmssp (:codnat,:ufcf,:codemp,:codfilial)
            into aliqfisc;
        end


        suspend;
    end
    -- Se o tem de classificao fiscal foi informado
    else if(coditfiscp is not null) then
    begin

       for select it.origfisc,it.codtrattrib,it.redfisc,it.aliqfisc,it.tipofisc,it.codmens,it.aliqipifisc,
            it.tpredicmsfisc,it.tipost,it.margemvlagr,it.codemp,it.codfilial,it.codfisc,it.coditfisc,
            it.aliqfiscintra,it.aliqpisfisc,it.aliqcofinsfisc,it.aliqcsocialfisc,it.aliqirfisc, it.redbasest
            ,coalesce(it.aliqissfisc,f.percissfilial), it.adicipibaseicms , it.calcstcm, it.aliqicmsstcm
            from lfitclfiscal it, sgfilial f
            where it.codemp=:codempifp and it.codfilial=:codfilialifp and it.codfisc=:codfiscp and it.coditfisc=:coditfiscp
             and f.codemp=:codemp and f.codfilial=:codfilial
             and it.ativoitfisc='S'
        into origfisc,codtrattrib,redfisc,aliqfisc,tipofisc,codmens,aliqipifisc,tpredicmsfisc,tipost,margemvlagr,
            codempif,codfilialif,codfisc,coditfisc,aliqfiscintra,aliqpis,aliqcofins,aliqcsocial,aliqir, redbasest
            , aliqiss, :adicipibaseicms, :calcstcm, :aliqicmsstcm
        do
        begin
            -- Definio do ICMS
            -- caso no tenha encontrato aliquota de icms e tratamento tributrio no for (isento, isento ou n.trib, n.trib., suspenso)
    
            if(codtrattrib not in ('40','30','41','50') and (aliqfisc is null or aliqfisc=0 ) ) then
            begin
                select coalesce(percicms,0) from lfbuscaicmssp (:codnat,:ufcf,:codemp,:codfilial)
                into aliqfisc;
            end

            suspend;
            exit;
        end

    end

end ^

ALTER PROCEDURE LFBUSCAFISCALSP02 (CODEMP INTEGER,
CODFILIAL SMALLINT,
CODVENDA INTEGER,
TIPOVENDA CHAR(1),
CODITVENDA SMALLINT,
CODCOMPRA INTEGER,
CODITCOMPRA SMALLINT)
RETURNS (VLRBASEPIS NUMERIC(15, 5),
VLRBASECOFINS NUMERIC(15, 5),
VLRPIS NUMERIC(15, 5),
VLRCOFINS NUMERIC(15, 5),
VLRIR NUMERIC(15, 5),
VLRCSOCIAL NUMERIC(15, 5),
VLRIPIIT NUMERIC(15, 5),
VLRBASENCM DECIMAL(15, 5),
ALIQNACNCM DECIMAL(9, 2),
ALIQIMPNCM DECIMAL(9, 2),
VLRNACNCM DECIMAL(15, 2),
VLRIMPNCM DECIMAL(15, 2),
ORIGFISC CHAR(1))
AS 
 

declare variable codempif integer;
declare variable codfilialif smallint;
declare variable codfisc char(13);
declare variable coditfisc integer;
declare variable codsittribpis char(2);
declare variable codsittribcof char(2);
declare variable vlrpisunidtrib numeric(15,5);
declare variable vlrcofunidtrib numeric(15,5);
declare variable vlrprodit numeric(15,5);
declare variable aliqpis numeric(6,2);
declare variable qtdit numeric(15,5);
declare variable aliqcofins numeric(6,2);
declare variable aliqir numeric(15,5);
declare variable aliqcsocial numeric(15,5);
declare variable vlrliqit numeric(15,5);
declare variable vlrfreteit numeric(15,5);
declare variable vlrdescit numeric(15,5);
begin

    vlrbasencm = 0;
    aliqnacncm = 0;
    aliqimpncm = 0;
    vlrnacncm = 0;
    vlrimpncm = 0;
    
    -- Busca de regra de classificao fiscal da venda
    if(codvenda is not null and codcompra is null) then
    begin

        select li.codsittribpis,li.codsittribcof,iv.vlrproditvenda,li.aliqpisfisc,li.vlrpisunidtrib,
        iv.qtditvenda,li.aliqcofinsfisc,coalesce(li.aliqirfisc,fi.percirfilial),coalesce(li.aliqcsocialfisc, fi.perccsocialfilial),
        iv.vlrliqitvenda, coalesce(iv.vlripiitvenda,0) vlripiitvenda, coalesce(iv.vlrfreteitvenda,0) vlrfreteitvenda,
        coalesce(iv.vlrdescitvenda,0) vlrdescitvenda, coalesce(nc.aliqnac,0) aliqnacncm, coalesce(nc.aliqimp,0) aliqimpncm,
        coalesce(iv.vlrliqitvenda,0) vlrbasencm, coalesce(li.origfisc,'0') origfisc
        from vditvenda iv left outer join lfitclfiscal li on
        li.codemp=iv.codempif and li.codfilial=iv.codfilialif and li.codfisc=iv.codfisc and li.coditfisc=iv.coditfisc
        left outer join sgfilial fi on
        fi.codemp=iv.codemp and fi.codfilial=iv.codfilial
        left outer join lfclfiscal cf on
        cf.codemp=li.codemp and cf.codfilial=li.codfilial and cf.codfisc=li.codfisc
        left outer join lfncm nc on
        nc.codncm=cf.codncm
        where
        iv.codemp=:codemp and iv.codfilial=:codfilial and iv.codvenda=:codvenda and iv.tipovenda=:tipovenda and iv.coditvenda=:coditvenda
        into
        :CODSITTRIBPIS,:CODSITTRIBCOF,:VLRPRODIT,:ALIQPIS,:VLRPISUNIDTRIB,:QTDIT
        ,:ALIQCOFINS,:ALIQIR,:ALIQCSOCIAL,:VLRLIQIT,:VLRIPIIT, :VLRFRETEIT, :VLRDESCIT
        ,:ALIQNACNCM, :ALIQIMPNCM, :VLRBASENCM, :ORIGFISC;
    end
    -- Busca de regra de classificao fiscal da compra
    else if(codvenda is null and codcompra is not null) then
    begin

       select li.codsittribpis,li.codsittribcof,ic.vlrproditcompra,li.aliqpisfisc,li.vlrpisunidtrib,
        ic.qtditcompra,li.aliqcofinsfisc,coalesce(li.aliqirfisc,fi.percirfilial),coalesce(li.aliqcsocialfisc, fi.perccsocialfilial),
        ic.vlrliqitcompra, coalesce(ic.vlripiitcompra,0) vlripiit, coalesce(ic.vlrfreteitcompra,0) vlrfreteit,
        coalesce(ic.vlrdescitcompra,0) vlrdescit
        from cpitcompra ic left outer join lfitclfiscal li on
        li.codemp=ic.codempif and li.codfilial=ic.codfilialif and li.codfisc=ic.codfisc and li.coditfisc=ic.coditfisc
        and li.ativoitfisc='S'
        left outer join sgfilial fi on
        fi.codemp=ic.codemp and fi.codfilial=ic.codfilial
        where
        ic.codemp=:codemp and ic.codfilial=:codfilial and ic.codcompra=:codcompra and ic.coditcompra=:coditcompra
        into
        :CODSITTRIBPIS,:CODSITTRIBCOF,:VLRPRODIT,:ALIQPIS,:VLRPISUNIDTRIB,:QTDIT,
        :ALIQCOFINS,:ALIQIR,:ALIQCSOCIAL,:VLRLIQIT,:VLRIPIIT, :VLRFRETEIT, :VLRDESCIT;

    end

    -- Definio do PIS

    if(:CODSITTRIBPIS in ('01','02','99')) then -- PIS Tributado pela alquota
    begin
        vlrbasepis = :vlrprodit - :vlrdescit; -- (Base do PIS = Valor total dos produtos - Implementar situaes distintas futuramente)
        vlrpis = (vlrbasepis * aliqpis) / 100;
    end
    else if (:CODSITTRIBPIS in ('03')) then -- PIS Tributado pela quantidade
    begin
        vlrpis = qtdit * vlrpisunidtrib;
    end

    -- Definio do COFINS

    if(:CODSITTRIBCOF in ('01','02','99')) then -- COFINS Tributado pela alquota
    begin
        vlrbasecofins = :vlrprodit - :vlrdescit; -- (Base do COFINS = Valor total dos produtos - Implementar situaes distintas futuramente)
        vlrcofins = (vlrbasecofins * aliqcofins) / 100;
    end
    else if (:CODSITTRIBPIS in ('03')) then -- COFINS Tributado pela quantidade
    begin
        vlrcofins = qtdit * vlrcofunidtrib;
    end

    -- Definio do IR

    vlrir = ((:VLRLIQIT + :VLRIPIIT + :VLRFRETEIT) * aliqir) / 100;

    -- Definio da CSocial

    vlrcsocial = ((:VLRLIQIT + :VLRIPIIT + :VLRFRETEIT) * aliqcsocial) / 100;
    
    if ( coalesce(:vlrbasencm,0)>0 ) then
    begin
       -- Clculo estimativo para lei de transparncia
       if (:origfisc in ('1','2','6','7')) then 
             vlrimpncm = :vlrbasencm * :aliqimpncm / 100;
       else
          vlrnacncm = :vlrbasencm * :aliqnacncm / 100;
    end 

  suspend;
end ^

ALTER PROCEDURE LFBUSCAICMSSP (CODNAT CHAR(4),
ESTCLI CHAR(2),
ICODEMP INTEGER,
ICODFILIAL SMALLINT)
RETURNS (PERCICMS NUMERIC(9, 2),
PERCICMSINTRA NUMERIC(9, 2))
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

DECLARE VARIABLE ESTEMP CHAR(2);
begin
    -- Buscando o estado de origem
    select coalesce(siglauf, uffilial) from sgfilial where codemp=:ICODEMP and codfilial=:ICODFILIAL
    into :EstEmp;

    -- Caso estado de origem e destino sejam o mesmo
    if (EstCli = EstEmp) then
    begin
        -- busca aliquota da tabela de CFOP
        select aliqenat, aliqenat from lfnatoper where codnat=:CodNat and codemp=:ICODEMP and codfilial=:ICODFILIAL
        into :PERCICMS, :PERCICMSINTRA;
    end
    else
    begin
        -- busca aliquota da tabela de icms para a natureza de operao informada.
        select ti.aliqti, ti.aliqintrati from lftabicms ti, lfitnatoper ino
        where ti.codemp = ino.codempti and ti.codfilial=ino.codfilialti and ti.ufti=ino.ufti and
        ino.codemp=:ICODEMP and ino.codfilial=:ICODFILIAL and ino.codnat=:CODNAT and ino.ufti=:ESTCLI
        into :PERCICMS, :PERCICMSINTRA;
    end

    -- Caso no tenha obtido a aliquota nas formas anteriores
    if (PERCICMS is null) then
    begin
        select aliqfnat,aliqenat from lfnatoper where codnat=:CODNAT and codemp=:ICODEMP and codfilial=:ICODFILIAL
        into :PERCICMS, :PERCICMSINTRA;
    end

  suspend;

end ^

ALTER PROCEDURE LFBUSCANATSP (FILIALATUAL INTEGER,
CODEMPPD INTEGER,
CODFILIALPD SMALLINT,
CODPROD INTEGER,
CODEMPCL INTEGER,
CODFILIALCL SMALLINT,
CODCLI INTEGER,
CODEMPFR INTEGER,
CODFILIALFR SMALLINT,
CODFOR INTEGER,
CODFILIALTM SMALLINT,
CODTIPOMOV INTEGER,
CODITFISC INTEGER)
RETURNS (CODNAT CHAR(4))
AS 
declare variable noest char(1);
declare variable cv char(1);
declare variable itmp integer;
begin

    -- Se o cdigo do fornecedor  nulo subintende-se que deve realizar a busca para uma venda usando a
    -- UF do cliente
    if (codfor is null) then
    begin
        -- Verifica se a UF do emitente (Filial)  igual o estado do destinatrio (Cliente) retorna >0 para dentro do estado
        select count(f.siglauf) from sgfilial f, vdcliente c
        where f.codemp=:codemppd and f.codfilial=:filialatual and c.codcli=:codcli and c.codemp=:codempcl
        and c.codfilial=:codfilialcl and f.siglauf=coalesce(c.siglauf,c.ufcli)
        into itmp;
        -- Atualiza varivel que indica se  compra ou venda para V (Venda)
        cv = 'V';
    end
    -- Se for uma busca de natureza de operao para compra (Busca pelo estado do fornecedor)
    else
    begin
        -- Verifica se a UF do emitente (Fornecedor)  igual o estado do destinatrio (Filial) retorna >0 para dentro do estado
        select count(f.siglauf) from sgfilial f, cpforneced fo
        where f.codemp=:codemppd and f.codfilial=:filialatual and fo.codfor=:codfor and fo.codemp=:codempfr
        and fo.codfilial=:codfilialfr and F.siglauf=coalesce(fo.uffor, fo.siglauf)
        into itmp;
        -- Atualiza varivel que indica se  compra ou venda para C (Compra)
        cv = 'C';
    end

    -- Verifica se transao  dentro ou fora do estado e atualiza a varivel NOEST
    if (itmp > 0) then
    begin
        noest='S';
    end
    else
    begin
        noest='N';
    end

    -- Primeira busca por CFOP na regra de CFOP
    select first 1 r.codnat from eqproduto p, lfitregrafiscal r, lfclfiscal c
    left outer join lfitclfiscal icf on
    icf.codemp=c.codemp and icf.codfilial=c.codfilial and icf.codfisc=c.codfisc and icf.coditfisc=:coditfisc
    and icf.ativoitfisc='S'
    where p.codprod=:codprod and p.codfilial=:codfilialpd and p.codemp=:codemppd
    and c.codfisc = p.codfisc and c.codfilial = p.codfilialfc and c.codemp = p.codempfc
    and r.codregra = coalesce(icf.codregra, c.codregra) and r.codfilial = c.codfilialra and r.codemp = c.codempra
    and r.codemptm=:codemppd and r.codfilialtm=:codfilialtm and r.codtipomov=:codtipomov
    and r.cvitrf=:cv and r.noufitrf=:noest
    into codnat;

    -- Se no localizou nenhum cfop na pesquisa anterior pega a primeira cfop
    -- para a classificao fiscal do produto na regra.
    if (codnat is null) then
    begin
        select first 1 r.codnat from eqproduto p, lfitregrafiscal r, lfclfiscal c
        left outer join lfitclfiscal icf on
        icf.codemp=c.codemp and icf.codfilial=c.codfilial and icf.codfisc=c.codfisc and icf.coditfisc=:coditfisc
        and icf.ativoitfisc='S'
        where p.codprod=:codprod and p.codfilial=:codfilialpd and p.codemp=:codemppd
        and c.codfisc=p.codfisc and c.codfilial=p.codfilialfc and c.codemp = p.codempfc and r.codregra = coalesce(icf.codregra, c.codregra)
        and r.codfilial = c.codfilialra and r.codemp = c.codempra
        and r.cvitrf=:cv and r.noufitrf=:noest
        order by r.codtipomov
        into codnat;
     end

    suspend;
end ^

ALTER PROCEDURE LFBUSCAPREVTRIBORC (CODEMP INTEGER,
CODFILIAL INTEGER,
CODORC INTEGER,
TIPOORC CHAR(1),
CODITORC SMALLINT)
RETURNS (VLRICMS NUMERIC(15, 5),
VLRIPI NUMERIC(15, 5),
VLRPIS NUMERIC(15, 5),
VLRCOFINS NUMERIC(15, 5),
VLRIR NUMERIC(15, 5),
VLRCSOCIAL NUMERIC(15, 5),
VLRISS NUMERIC(15, 5))
AS 
 
 
 
declare variable codempcl integer;
declare variable codfilialcl smallint;
declare variable codcli integer;
declare variable codemptm integer;
declare variable codfilialtm smallint;
declare variable codtipomov integer;
declare variable codempif integer;
declare variable codfilialif smallint;
declare variable codfisc char(13);
declare variable coditfisc smallint;
declare variable vlrbasepis numeric(15,5);
declare variable vlrbasecofins numeric(15,5);
declare variable vlrprod integer;
declare variable aliqpis numeric(6,2);
declare variable qtd numeric(15,5);
declare variable vlrpisunidtrib numeric(15,5);
declare variable codsittribcof char(2);
declare variable aliqcofins numeric(6,2);
declare variable vlrcofunidtrib numeric(15,5);
declare variable vlrliq numeric(15,5);
declare variable vlrfrete numeric(15,5);
declare variable codsittribipi char(2);
declare variable vlripiunidtrib numeric(15,5);
declare variable aliqipi numeric(6,2);
declare variable tpcalcipi char(1);
declare variable vlrbaseipi numeric(15,5);
declare variable aliqcsocial numeric(6,2);
declare variable aliqir numeric(6,2);
declare variable codemppd integer;
declare variable codfilialpd smallint;
declare variable codprod integer;
declare variable tipoprod varchar(2);
declare variable aliqiss numeric(6,2);
declare variable aliqicms numeric(6,2);
declare variable tpredicms char(1);
declare variable redicms numeric(15,5);
declare variable baseicms numeric(15,5);
declare variable codtrattrib char(2);
declare variable codsittribpis char(2);
declare variable ufcli char(2);
begin

    -- Inicializando variveis

    vlripi = 0;
    vlrfrete = 0;

    -- Buscando informaes no oramento (cliente e tipo de movimento)
    select oc.codempcl,oc.codfilialcl,oc.codcli,tm.codemptm,tm.codfilialtm,tm.codtipomovtm,coalesce(cl.siglauf,cl.ufcli)
    from vdorcamento oc, vdcliente cl, eqtipomov tm
    where oc.codemp=:codemp and oc.codfilial=:codfilial and oc.codorc=:codorc and oc.tipoorc=:tipoorc
    and cl.codemp=oc.codempcl and cl.codfilial=oc.codfilialcl and cl.codcli=oc.codcli
    and tm.codemp=oc.codemp and tm.codfilial=oc.codfilialtm and tm.codtipomov=oc.codtipomov
    into :codempcl, :codfilialcl, :codcli, :codemptm, :codfilialtm, :codtipomov, :ufcli;

    -- Buscando informaes do produto no item de oramento
    select io.codemppd, io.codfilialpd, io.codprod, io.vlrproditorc, io.qtditorc, io.vlrliqitorc, coalesce(io.vlrfreteitorc,0),
    pd.tipoprod

    from vditorcamento io, eqproduto pd
    where io.codemp=:codemp and io.codfilial=:codfilial and io.codorc=:codorc and io.tipoorc=:tipoorc and io.coditorc=:coditorc
    and pd.codemp=io.codemppd and pd.codfilial=io.codfilialpd and pd.codprod=io.codprod
    into :codemppd, :codfilialpd, :codprod, :vlrprod, :qtd, :vlrliq, :vlrfrete, :tipoprod;

    -- Buscando a regra de classificao para o tem
    select bf.codempif, bf.codfilialif, bf.codfisc, bf.coditfisc
    from lfbuscafiscalsp(:codemppd, :codfilialpd, :codprod, :codempcl, :codfilialcl, :codcli,
    :codemptm, :codfilialtm, :codtipomov, 'VD',null,null,null,null,null) bf
    into :codempif, :codfilialif, :codfisc, :coditfisc;

    -- Buscando informacoes fiscais na tabela de regras
    select cf.codsittribpis, cf.aliqpisfisc, cf.vlrpisunidtrib, cf.codsittribcof, cf.aliqcofinsfisc, cf.vlrcofunidtrib,
    cf.vlripiunidtrib, cf.aliqipifisc, cf.codsittribipi, cf.tpcalcipi,
    coalesce(cf.aliqcsocialfisc, fi.perccsocialfilial), coalesce(cf.aliqirfisc, fi.percirfilial), coalesce(cf.aliqissfisc, fi.percissfilial),
    cf.tpredicmsfisc, cf.redfisc, cf.codtrattrib
    from lfitclfiscal cf
    left outer join sgfilial fi on
    fi.codemp=:codemp and fi.codfilial=:codfilial
    where cf.codemp=:codempif and cf.codfilial=:codfilialif and cf.codfisc=:codfisc and cf.coditfisc=:coditfisc
    into :codsittribpis, :aliqpis, :vlrpisunidtrib, :codsittribcof, :aliqcofins, :vlrcofunidtrib,
    :vlripiunidtrib, :aliqipi, :codsittribipi,:tpcalcipi, :aliqcsocial, :aliqir, :aliqiss,
    :tpredicms, :redicms, :codtrattrib;

    -- Definio do IPI
    if(:codsittribipi not in ('52','53','54')) then -- IPI Tributado
    begin
        if(:tpcalcipi='P' and aliqipi is not null and aliqipi > 0) then -- Calculo pela aliquota
        begin
            vlrbaseipi = :vlrliq; -- (Base do IPI = Valor total dos produtos - Implementar situaes distintas futuramente)
            vlripi = (vlrbaseipi * aliqipi) / 100;
        end
        else if (vlripiunidtrib is not null and vlripiunidtrib > 0) then -- Calculo pela quantidade
        begin
            vlripi = qtd * vlripiunidtrib;
        end
    end

    -- Definio do PIS

    if(:codsittribpis in ('01','02','99') and aliqpis is not null and aliqpis > 0 ) then -- PIS Tributado pela alquota
    begin
        vlrbasepis = :vlrprod; -- (Base do PIS = Valor total dos produtos - Implementar situaes distintas futuramente)
        vlrpis = (vlrbasepis * aliqpis) / 100;
    end
    else if (:codsittribpis in ('03') and vlrpisunidtrib is not null and vlrpisunidtrib > 0) then -- PIS Tributado pela quantidade
    begin
        vlrpis = qtd * vlrpisunidtrib;
    end

    -- Definio do COFINS

    if(:codsittribcof in ('01','02','99') and aliqcofins is not null and aliqcofins > 0 ) then -- COFINS Tributado pela alquota
    begin
        vlrbasecofins = :vlrprod; -- (Base do COFINS = Valor total dos produtos - Implementar situaes distintas futuramente)
        vlrcofins = (vlrbasecofins * aliqcofins) / 100;
    end
    else if (:codsittribpis in ('03') and vlrcofunidtrib is not null and vlrcofunidtrib > 0) then -- COFINS Tributado pela quantidade
    begin
        vlrcofins = qtd * vlrcofunidtrib;
    end

    -- Definio do IR

    if(aliqir is not null and aliqir > 0) then
    begin
        vlrir = ((:vlrliq + :vlripi + :vlrfrete) * aliqir) / 100;
    end

    -- Definio da CSocial

    vlrcsocial = ((:vlrliq + :vlripi + :vlrfrete) * aliqcsocial) / 100;

    -- Definio do ISS se for um servio
    if (tipoprod = 'S') then
    begin
        if ( aliqiss is not null and aliqiss > 0 ) then
        begin
            vlriss = vlrliq * (aliqiss/100);
        end
    end

    -- Definio do ICMS
    -- Calcular icms quando aliquota maio que zero e tratamento tributrio no for (isento, isento ou n.trib, n.trib., suspenso)

    if(codtrattrib not in ('40','30','41','50')) then
    begin

        if(aliqicms is null) then
        begin
            select ti.aliqti from lftabicms ti
            where codemp=:codemp and codfilial=:codfilial and ufti=:ufcli
            into aliqicms;
        end

        if (redicms>0) then -- Com reduo
        begin
            if(tpredicms='B') then -- Reduo na base de clculo
            begin
                baseicms = vlrliq * ( 1 - (redicms / 100));
                vlricms = baseicms * (aliqicms / 100);
            end
            else -- Reduo no valor
            begin

                baseicms = vlrliq;
                vlricms = baseicms * ( aliqicms / 100 );
                vlricms = vlricms * (( 100 - redicms ) / 100);


            end
        end
        else -- Sem reduo
        begin

            baseicms = vlrliq;
            vlricms = baseicms * (aliqicms / 100);

        end

    end
  suspend;
end ^

ALTER PROCEDURE LFBUSCATRIBCOMPRA (CODEMP INTEGER,
CODFILIAL INTEGER,
CODCOMPRA INTEGER,
CODEMPPD INTEGER,
CODFILIALPD SMALLINT,
CODPROD INTEGER,
VLRLIQ NUMERIC(15, 5))
RETURNS (VLRBASEFUNRURAL NUMERIC(15, 5),
ALIQFUNRURAL NUMERIC(6, 2),
VLRFUNRURAL NUMERIC(15, 5),
CODEMPIF INTEGER,
CODFILIALIF SMALLINT,
CODFISC CHAR(13),
CODITFISC SMALLINT)
AS 
 
 
declare variable codempfr integer;
declare variable codfilialfr smallint;
declare variable codfor integer;
declare variable codemptm integer;
declare variable codfilialtm smallint;
declare variable codtipomov integer;
begin

    -- Inicializando variveis

    vlrfunrural = 0;

    -- Buscando informaes na compra (fornecedor e tipo de movimento)
    select cp.codempfr,cp.codfilialfr,cp.codfor,coalesce(tm.codemptm, tm.codemp)
    ,coalesce(tm.codfilialtm,tm.codfilial),coalesce(tm.codtipomovtm, tm.codtipomov)
    from cpcompra cp, cpforneced fr, eqtipomov tm
    where cp.codemp=:codemp and cp.codfilial=:codfilial and cp.codcompra=:codcompra
    and fr.codemp=cp.codempfr and fr.codfilial=cp.codfilialfr and fr.codfor=cp.codfor
    and tm.codemp=cp.codemp and tm.codfilial=cp.codfilialtm and tm.codtipomov=cp.codtipomov
    into :codempfr, :codfilialfr, :codfor, :codemptm, :codfilialtm, :codtipomov;

    -- Buscando a regra de classificao para o tem
    select bf.codempif, bf.codfilialif, bf.codfisc, bf.coditfisc
    from lfbuscafiscalsp(:codemppd, :codfilialpd, :codprod, :codempfr, :codfilialfr, :codfor, :codemptm, :codfilialtm, :codtipomov, 'CP',null,null,null,null,null) bf
    into :codempif, :codfilialif, :codfisc, :coditfisc;

    -- Buscando informacoes fiscais na tabela de regras
    select cf.aliqfunruralfisc
    from lfitclfiscal cf
    left outer join sgfilial fi on
    fi.codemp=:codemp and fi.codfilial=:codfilial
    where cf.codemp=:codempif and cf.codfilial=:codfilialif and cf.codfisc=:codfisc and cf.coditfisc=:coditfisc
    into :aliqfunrural;

    -- Definio do Funrural
    if(:aliqfunrural>0) then -- Reteno do funrural
    begin
        vlrbasefunrural = :vlrliq; -- (Base do Funrural = Valor total dos produtos - Implementar situaes distintas futuramente)
        vlrfunrural = (vlrbasefunrural * aliqfunrural) / 100;
    end


    suspend;
end ^

ALTER PROCEDURE LFCALCCUSTOSP01 (CODEMP INTEGER,
CODFILIAL SMALLINT,
CODCALC INTEGER,
QTDADE DECIMAL(15, 5),
VLRCUSTOP DECIMAL(15, 5),
VLRICMS DECIMAL(15, 5),
VLRIPI DECIMAL(15, 5),
VLRPIS DECIMAL(15, 5),
VLRCOFINS DECIMAL(15, 5),
VLRISS DECIMAL(15, 5),
VLRFUNRURAL DECIMAL(15, 5),
VLRII DECIMAL(15, 5),
VLRIR DECIMAL(15, 5),
VLRTXSISCOMEX DECIMAL(15, 5),
VLRICMSDIFERIDO DECIMAL(15, 5),
VLRICMSPRESUMIDO DECIMAL(15, 5),
VLRCOMPL DECIMAL(15, 5))
RETURNS (VLRCUSTO DECIMAL(15, 5))
AS 

declare variable siglacalc varchar(10);
declare variable operacao char(1);
declare variable vlrimposto decimal(15,5);
begin
  if (:vlrcustop is null) then
    vlrcusto = 0;
  else
    vlrcusto = vlrcustop;

  if (vlripi is null) then
   vlripi = 0;
  if (vlricms is null) then
   vlricms = 0;
  if (vlrpis is null) then
   vlrpis = 0;
  if (vlrcofins is null) then
   vlrcofins = 0;
  if (vlriss is null) then
   vlriss = 0;
  if (vlrfunrural is null) then
   vlrfunrural = 0;
  if (vlrii is null) then
   vlrii = 0;
  if (vlrir is null) then
   vlrir = 0;
  if (vlrtxsiscomex is null) then
   vlrtxsiscomex = 0;
  if (vlricmsdiferido is null) then
   vlricmsdiferido = 0;
  if (vlricmspresumido is null) then
   vlricmspresumido = 0;
  if (vlrcompl is null) then
   vlrcompl = 0; 

  for select ic.siglacalc, ic.operacaocalc
     from lfcalccusto c, lfitcalccusto ic
     where c.codemp=:codemp and c.codfilial=:codfilial and c.codcalc=:codcalc
       and ic.codemp=c.codemp and ic.codfilial=c.codfilial and ic.codcalc=c.codcalc
       into :siglacalc, :operacao do
  begin

     if (:siglacalc='IPI') then
       vlrimposto = vlripi;
     else if (:siglacalc='ICMS') then
       vlrimposto = vlricms;
     else if (:siglacalc='PIS') then
       vlrimposto = vlrpis;
     else if (:siglacalc='COFINS') then
       vlrimposto = vlrcofins;
     else if (:siglacalc='ISS') then
       vlrimposto = vlriss;
     else if (:siglacalc='FUNRURAL') then
       vlrimposto = vlrfunrural;
     else if (:siglacalc='II') then
       vlrimposto = vlrii;
     else if (:siglacalc='IR') then
       vlrimposto = vlrir;
     else if (:siglacalc='TXSISCOMEX') then
       vlrimposto = vlrtxsiscomex;
     else if (:siglacalc='ICMSDIF') then
       vlrimposto = vlricmsdiferido;
     else if (:siglacalc='ICMSPRES') then
       vlrimposto = vlricmspresumido;
     else if (:siglacalc='COMPL') then
       vlrimposto = vlrcompl;

     if (:operacao='+') then
        vlrcusto = vlrcusto + vlrimposto;
     else if (:operacao='-') then
        vlrcusto = vlrcusto - vlrimposto;
  end
  if (qtdade is not null and qtdade<>0) then
  begin
     -- Dividimos o total pela quantidade, multiplicamos o resultado novamente pela quantidade e dividimos pela quantidade, objetivando evitar dizima peridica.
     
      vlrcusto = cast( ( cast(vlrcusto as decimal(15,4)) / cast( qtdade as decimal(15,5) )  * cast( qtdade as decimal(15,5) ) ) as decimal(15,4) ) / cast( qtdade as decimal(15,5) ) ;
  end
  suspend;
end ^

ALTER PROCEDURE LFGERALFITCOMPRASP (CODEMP INTEGER,
CODFILIAL SMALLINT,
CODCOMPRA INTEGER,
CODITCOMPRA SMALLINT)
AS 
 
 
declare variable temitem char(1);
declare variable codempsp integer;
declare variable codfilialsp smallint;
declare variable impsittribpis char(2);
declare variable codsittribpis char(2);
declare variable aliqpisfisc numeric(15,5);
declare variable vlrbasepis numeric(15,5);
declare variable vlrpis numeric(15,5);
declare variable vlrpisunidtrib numeric(15,5);
declare variable codempsc integer;
declare variable codfilialsc smallint;
declare variable impsittribcof char(2);
declare variable codsittribcof char(2);
declare variable aliqcofins numeric(15,5);
declare variable vlrbasecofins numeric(15,5);
declare variable vlrcofins numeric(15,5);
declare variable vlrcofunidtrib numeric(15,5);
declare variable vlrbaseicmsstitcompra numeric(15,5);
declare variable vlricmsstitcompra numeric(15,5);
declare variable codempsi integer;
declare variable codfilialsi smallint;
declare variable impsittribipi char(2);
declare variable codsittribipi char(2);
declare variable vlripiunidtrib numeric(15,5);
declare variable modbcicms smallint;
declare variable modbcicmsst smallint;
declare variable redfisc numeric(9,2);
declare variable aliqfisc integer;
declare variable vlrir numeric(15,5);
declare variable vlrcsocial numeric(15,5);
declare variable uffor char(2);
declare variable percicmsst numeric(15,5);
declare variable codempif integer;
declare variable codfilialif smallint;
declare variable codfisc char(13);
declare variable coditfisc integer;
declare variable codnat char(4);
declare variable codtrattrib char(2);
declare variable origfisc char(1);
begin

    -- Inserindo informaes fiscais na tabela LFITCOMPRA

    select 'S'
    from lfitcompra
    where codemp=:codemp and codfilial=:codfilial and codcompra=:codcompra and coditcompra=:coditcompra
    into :temitem;

    select
    li.codempsp,li.codfilialsp,li.impsittribpis,li.codsittribpis,li.aliqpisfisc,bf.vlrbasepis,bf.vlrpis,li.vlrpisunidtrib,
    li.codempsc,li.codfilialsc,li.impsittribcof,li.codsittribcof,li.aliqcofinsfisc,bf.vlrbasecofins,bf.vlrcofins,li.vlrcofunidtrib,
    li.codempsi,li.codfilialsi,li.impsittribipi,li.codsittribipi,li.vlripiunidtrib,
    li.modbcicms,li.modbcicmsst,li.redfisc,li.aliqfisc,bf.vlrir,bf.vlrcsocial, li.codtrattrib, li.origfisc, ic.vlrbaseicmsstitcompra, ic.vlricmsstitcompra
    from lfbuscafiscalsp02(:CODEMP,:CODFILIAL,null,null,null,:codcompra,:coditcompra) bf
    left outer join cpitcompra ic on ic.codemp=:CODEMP and ic.codfilial=:CODFILIAL and ic.codcompra=:codcompra and ic.coditcompra=:coditcompra
    left outer join lfitclfiscal li on li.codemp=ic.codempif and li.codfilial=ic.codfilialif and li.codfisc=ic.codfisc and li.coditfisc=ic.coditfisc
    into
    :CODEMPSP,:CODFILIALSP,:IMPSITTRIBPIS,:CODSITTRIBPIS,:ALIQPISFISC,:VLRBASEPIS,:VLRPIS,:VLRPISUNIDTRIB,
    :CODEMPSC,:CODFILIALSC,:IMPSITTRIBCOF,:CODSITTRIBCOF,:ALIQCOFINS,:VLRBASECOFINS,:VLRCOFINS,:VLRCOFUNIDTRIB,
    :CODEMPSI,:CODFILIALSI,:IMPSITTRIBIPI,:CODSITTRIBIPI,:VLRIPIUNIDTRIB,
    :MODBCICMS,:MODBCICMSST,:REDFISC,:ALIQFISC,:VLRIR,:VLRCSOCIAL,:codtrattrib,:origfisc, :VLRBASEICMSSTITCOMPRA, :VLRICMSSTITCOMPRA;

    -- Buscando estado do fornecedor
    select coalesce(fr.siglauf,fr.uffor), ic.codempif, ic.codfilialif, ic.codfisc, ic.coditfisc, ic.codnat from cpforneced fr, cpcompra cp
    left outer join cpitcompra ic on ic.codemp=cp.codemp and ic.codfilial=cp.codfilial and ic.codcompra=cp.codcompra and ic.coditcompra=:coditcompra
    where cp.codemp=:codemp and cp.codfilial=:codfilial and cp.codcompra=:codcompra and
    fr.codemp=cp.codempfr and fr.codfilial=cp.codfilialfr and fr.codfor=cp.codfor
    into uffor,codempif, codfilialif, codfisc, coditfisc, codnat;

    -- Buscando aliquota do ICMS ST da tabela de classificao fiscal
    select coalesce(ic.aliqfiscintra,0) from lfitclfiscal ic
    where ic.codemp=:codempif and ic.codfilial=:codfilialif and ic.codfisc=:codfisc and ic.coditfisc=:coditfisc
    into PERCICMSST;

    -- Buscando aliquota do ICMS ST da tabela de alquotas (caso no encontre na busca naterior)
    if (percicmsst = 0) then
    begin
        select coalesce(PERCICMSINTRA,0) from lfbuscaicmssp (:codnat,:uffor,:codemp,:codfilial)
        into PERCICMSST;
    end

    if(:TEMITEM='S') then
    begin
            update lfitcompra set codempsp=:CODEMPSP,codfilialsp=:CODFILIALSP,impsittribpis=:IMPSITTRIBPIS,
            codsittribpis=:CODSITTRIBPIS,aliqpis=:ALIQPISFISC,vlrbasepis=:VLRBASEPIS,vlrpis=:VLRPIS,vlrpisunidtrib=:VLRPISUNIDTRIB,
            codempsc=:CODEMPSC,codfilialsc=:CODFILIALSC,impsittribcof=:IMPSITTRIBCOF,codsittribcof=:CODSITTRIBCOF,aliqcofins=:ALIQCOFINS,
            vlrbasecofins=:VLRBASECOFINS,vlrcofins=:VLRCOFINS,vlrcofunidtrib=:VLRCOFUNIDTRIB,
            codempsi=:CODEMPSI,codfilialsi=:CODFILIALSI,impsittribipi=:IMPSITTRIBIPI,codsittribipi=:CODSITTRIBIPI,vlripiunidtrib=:VLRIPIUNIDTRIB,
            modbcicms=:MODBCICMS,modbcicmsst=:MODBCICMSST,aliqredbcicms=:REDFISC,aliqredbcicmsst=:REDFISC,aliqicmsst=:percicmsst,
            vlrir=:VLRIR,vlrcsocial=:VLRCSOCIAL, vlrbaseicmsstitcompra=:vlrbaseicmsstitcompra, vlricmsstitcompra=:vlricmsstitcompra
            where codemp=:codemp and codfilial=:codfilial and codcompra=:codcompra and coditcompra=:coditcompra;
    end
    else
    begin
        insert into lfitcompra (codemp,codfilial,codcompra,coditcompra,
            codempsp,codfilialsp,impsittribpis,codsittribpis,aliqpis,vlrbasepis,vlrpis,vlrpisunidtrib,
            codempsc,codfilialsc,impsittribcof,codsittribcof,aliqcofins,vlrbasecofins,vlrcofins,vlrcofunidtrib,
            codempsi,codfilialsi,impsittribipi,codsittribipi,vlripiunidtrib,
            modbcicms,modbcicmsst,aliqredbcicms,aliqredbcicmsst,aliqicmsst,vlrir,vlrcsocial,codtrattrib,origfisc,
            vlrbaseicmsstitcompra, vlricmsstitcompra)
        values(:CODEMP,:CODFILIAL,:CODcompra,:CODITcompra,
        :CODEMPSP,:CODFILIALSP,:IMPSITTRIBPIS,:CODSITTRIBPIS,:ALIQPISFISC,:VLRBASEPIS,:VLRPIS,:VLRPISUNIDTRIB,
        :CODEMPSC,:CODFILIALSC,:IMPSITTRIBCOF,:CODSITTRIBCOF,:ALIQCOFINS,:VLRBASECOFINS,:VLRCOFINS,:VLRCOFUNIDTRIB,
        :CODEMPSI,:CODFILIALSI,:IMPSITTRIBIPI,:CODSITTRIBIPI,:VLRIPIUNIDTRIB,
        :MODBCICMS,:MODBCICMSST,:REDFISC,:REDFISC,:percicmsst,:VLRIR,:VLRCSOCIAL, :codtrattrib, :origfisc,
        :VLRBASEICMSSTITCOMPRA, :VLRICMSSTITCOMPRA );

    end
  suspend;
end ^

ALTER PROCEDURE LFGERALFITVENDASP (CODEMP INTEGER,
CODFILIAL SMALLINT,
CODVENDA INTEGER,
TIPOVENDA CHAR(2),
CODITVENDA SMALLINT)
AS 
 
 
declare variable temitem char(1);
declare variable codempsp integer;
declare variable codfilialsp smallint;
declare variable impsittribpis char(2);
declare variable codsittribpis char(2);
declare variable aliqpisfisc numeric(15,5);
declare variable vlrbasepis numeric(15,5);
declare variable vlrpis numeric(15,5);
declare variable vlrpisunidtrib numeric(15,5);
declare variable codempsc integer;
declare variable codfilialsc smallint;
declare variable impsittribcof char(2);
declare variable codsittribcof char(2);
declare variable aliqcofins numeric(15,5);
declare variable vlrbasecofins numeric(15,5);
declare variable vlrcofins numeric(15,5);
declare variable vlrcofunidtrib numeric(15,5);
declare variable codempsi integer;
declare variable codfilialsi smallint;
declare variable impsittribipi char(2);
declare variable codsittribipi char(2);
declare variable vlripiunidtrib numeric(15,5);
declare variable modbcicms smallint;
declare variable modbcicmsst smallint;
declare variable redfisc numeric(9,2);
declare variable aliqfisc integer;
declare variable vlrir numeric(15,5);
declare variable vlrcsocial numeric(15,5);
declare variable ufcli char(2);
declare variable percicmsst numeric(15,5);
declare variable vlrbasencm decimal(15,5);
declare variable aliqnacncm decimal(9,2);
declare variable aliqimpncm decimal(9,2);
declare variable vlrnacncm decimal(15,5);
declare variable vlrimpncm decimal(15,5);
declare variable codempif integer;
declare variable codfilialif smallint;
declare variable codfisc char(13);
declare variable coditfisc integer;
declare variable codnat char(4);
begin

    -- Inserindo informaes fiscais na tabela LFITVENDA

    select 'S'
    from lfitvenda
    where codemp=:codemp and codfilial=:codfilial and codvenda=:codvenda and tipovenda=:tipovenda and coditvenda=:coditvenda
    into :temitem;

    select
    li.codempsp,li.codfilialsp,li.impsittribpis,li.codsittribpis,li.aliqpisfisc,bf.vlrbasepis,bf.vlrpis,li.vlrpisunidtrib,
    li.codempsc,li.codfilialsc,li.impsittribcof,li.codsittribcof,li.aliqcofinsfisc,bf.vlrbasecofins,bf.vlrcofins,li.vlrcofunidtrib,
    li.codempsi,li.codfilialsi,li.impsittribipi,li.codsittribipi,li.vlripiunidtrib,
    li.modbcicms,li.modbcicmsst,li.redfisc,li.aliqfisc,bf.vlrir,bf.vlrcsocial
    , bf.vlrbasencm, bf.aliqnacncm, bf.aliqimpncm, bf.vlrnacncm, bf.vlrimpncm 
    from lfbuscafiscalsp02(:CODEMP,:CODFILIAL,:CODVENDA,:TIPOVENDA,:CODITVENDA, null, null) bf
    left outer join vditvenda iv on iv.codemp=:CODEMP and iv.codfilial=:CODFILIAL and iv.codvenda=:CODVENDA and iv.tipovenda=:TIPOVENDA and iv.coditvenda=:CODITVENDA
    left outer join lfitclfiscal li on li.codemp=iv.codempif and li.codfilial=iv.codfilialif and li.codfisc=iv.codfisc and li.coditfisc=iv.coditfisc
    into
    :CODEMPSP,:CODFILIALSP,:IMPSITTRIBPIS,:CODSITTRIBPIS,:ALIQPISFISC,:VLRBASEPIS,:VLRPIS,:VLRPISUNIDTRIB,
    :CODEMPSC,:CODFILIALSC,:IMPSITTRIBCOF,:CODSITTRIBCOF,:ALIQCOFINS,:VLRBASECOFINS,:VLRCOFINS,:VLRCOFUNIDTRIB,
    :CODEMPSI,:CODFILIALSI,:IMPSITTRIBIPI,:CODSITTRIBIPI,:VLRIPIUNIDTRIB,
    :MODBCICMS,:MODBCICMSST,:REDFISC,:ALIQFISC,:VLRIR,:VLRCSOCIAL
    , :vlrbasencm, :aliqnacncm, :aliqimpncm, :vlrnacncm, :vlrimpncm;


    -- Buscando estado do cliente
    select coalesce(cl.siglauf,cl.ufcli), iv.codempif, iv.codfilialif, iv.codfisc, iv.coditfisc, iv.codnat from vdcliente cl, vdvenda vd
    left outer join vditvenda iv on iv.codemp=vd.codemp and iv.codfilial=vd.codfilial and iv.codvenda=vd.codvenda and iv.tipovenda=vd.tipovenda and iv.coditvenda=:coditvenda
    where vd.codemp=:codemp and vd.codfilial=:codfilial and vd.codvenda=:codvenda and vd.tipovenda=:tipovenda and
    cl.codemp=vd.codempcl and cl.codfilial=vd.codfilialcl and cl.codcli=vd.codcli
    into ufcli,codempif, codfilialif, codfisc, coditfisc, codnat;

    -- Buscando aliquota do ICMS ST da tabela de classificao fiscal
    select coalesce(ic.aliqfiscintra,0) from lfitclfiscal ic
    where ic.codemp=:codempif and ic.codfilial=:codfilialif and ic.codfisc=:codfisc and ic.coditfisc=:coditfisc
    into PERCICMSST;

    -- Buscando aliquota do ICMS ST da tabela de alquotas (caso no encontre na busca naterior)
    if (percicmsst = 0) then
    begin
        select coalesce(PERCICMSINTRA,0) from lfbuscaicmssp (:codnat,:ufcli,:codemp,:codfilial)
        into PERCICMSST;
    end

    if(:TEMITEM='S') then
    begin
            update lfitvenda set codempsp=:CODEMPSP,codfilialsp=:CODFILIALSP,impsittribpis=:IMPSITTRIBPIS,
            codsittribpis=:CODSITTRIBPIS,aliqpis=:ALIQPISFISC,vlrbasepis=:VLRBASEPIS,vlrpis=:VLRPIS,vlrpisunidtrib=:VLRPISUNIDTRIB,
            codempsc=:CODEMPSC,codfilialsc=:CODFILIALSC,impsittribcof=:IMPSITTRIBCOF,codsittribcof=:CODSITTRIBCOF,aliqcofins=:ALIQCOFINS,
            vlrbasecofins=:VLRBASECOFINS,vlrcofins=:VLRCOFINS,vlrcofunidtrib=:VLRCOFUNIDTRIB,
            codempsi=:CODEMPSI,codfilialsi=:CODFILIALSI,impsittribipi=:IMPSITTRIBIPI,codsittribipi=:CODSITTRIBIPI,vlripiunidtrib=:VLRIPIUNIDTRIB,
            modbcicms=:MODBCICMS,modbcicmsst=:MODBCICMSST,aliqredbcicms=:REDFISC,aliqredbcicmsst=:REDFISC,aliqicmsst=:percicmsst,
            vlrir=:VLRIR,vlrcsocial=:VLRCSOCIAL
            , vlrbasencm=:vlrbasencm, aliqnacncm=:aliqnacncm, aliqimpncm=:aliqimpncm, vlrnacncm=:vlrnacncm, vlrimpncm=:vlrimpncm
            where codemp=:codemp and codfilial=:codfilial and codvenda=:codvenda and tipovenda=:tipovenda and coditvenda=:coditvenda;
    end
    else
    begin
        insert into lfitvenda (codemp,codfilial,codvenda,tipovenda,coditvenda,
            codempsp,codfilialsp,impsittribpis,codsittribpis,aliqpis,vlrbasepis,vlrpis,vlrpisunidtrib,
            codempsc,codfilialsc,impsittribcof,codsittribcof,aliqcofins,vlrbasecofins,vlrcofins,vlrcofunidtrib,
            codempsi,codfilialsi,impsittribipi,codsittribipi,vlripiunidtrib,
            modbcicms,modbcicmsst,aliqredbcicms,aliqredbcicmsst,aliqicmsst,vlrir,vlrcsocial
            , vlrbasencm, aliqnacncm, aliqimpncm, vlrnacncm, vlrimpncm)
        values(:CODEMP,:CODFILIAL,:CODVENDA,:TIPOVENDA,:CODITVENDA,
        :CODEMPSP,:CODFILIALSP,:IMPSITTRIBPIS,:CODSITTRIBPIS,:ALIQPISFISC,:VLRBASEPIS,:VLRPIS,:VLRPISUNIDTRIB,
        :CODEMPSC,:CODFILIALSC,:IMPSITTRIBCOF,:CODSITTRIBCOF,:ALIQCOFINS,:VLRBASECOFINS,:VLRCOFINS,:VLRCOFUNIDTRIB,
        :CODEMPSI,:CODFILIALSI,:IMPSITTRIBIPI,:CODSITTRIBIPI,:VLRIPIUNIDTRIB,
        :MODBCICMS,:MODBCICMSST,:REDFISC,:REDFISC,:percicmsst,:VLRIR,:VLRCSOCIAL
        , :vlrbasencm, :aliqnacncm, :aliqimpncm, :vlrnacncm, :vlrimpncm );

    end

  suspend;
end ^

ALTER PROCEDURE LFNOVODOCSP (SSERIE CHAR(4),
ICODEMP INTEGER,
ICODFILIAL SMALLINT)
RETURNS (DOC INTEGER)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

declare variable iseqserie integer;
declare variable icodfilialss smallint;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP, 'LFSEQSERIE')
     INTO :ICODFILIALSS;
  DOC = NULL;
  /* Utiliza o nmero sequencial do documento da tabela LFSERIE,
    para retrocompatibilidade */
  SELECT COALESCE(SS.DOCSERIE,S.SERIE) DOCSERIE, SS.SEQSERIE
     FROM LFSERIE S
     LEFT OUTER JOIN LFSEQSERIE SS
     ON SS.CODEMP=S.CODEMP AND
        SS.CODFILIAL=S.CODFILIAL AND SS.SERIE=S.SERIE AND
        SS.CODEMPSS=:ICODEMP AND SS.CODFILIALSS=:ICODFILIALSS
     WHERE S.SERIE=:SSERIE AND S.CODEMP=:ICODEMP AND
        S.CODFILIAL=:ICODFILIAL AND SS.ATIVSERIE='S'
     INTO :DOC, :ISEQSERIE;
  IF (:ISEQSERIE IS NULL) THEN
  BEGIN
     IF (:DOC IS NULL) THEN
        DOC = 0;
     DOC = DOC + 1;
     SELECT MAX(SEQSERIE) FROM LFSEQSERIE SS
        WHERE SS.CODEMP=:ICODEMP AND SS.CODFILIAL=:ICODFILIAL AND
            SS.CODEMPSS=:ICODEMP AND SS.CODFILIALSS=:ICODFILIALSS AND
            SS.SERIE=:SSERIE INTO :ISEQSERIE;
     IF (:ISEQSERIE IS NULL) THEN
         ISEQSERIE = 1;
     INSERT INTO LFSEQSERIE (CODEMP, CODFILIAL, SERIE,
         CODEMPSS, CODFILIALSS, SEQSERIE, DOCSERIE)
     VALUES (:ICODEMP, :ICODFILIAL, :SSERIE,
         :ICODEMP, :ICODFILIALSS, :ISEQSERIE, :DOC);
  END
  ELSE
  BEGIN
    DOC = DOC + 1;
  END
  UPDATE LFSEQSERIE SET DOCSERIE=:DOC
     WHERE SERIE=:SSERIE AND CODEMP=:ICODEMP AND
     CODFILIAL=:ICODFILIAL AND CODEMPSS=:ICODEMP AND
     CODFILIALSS=:ICODFILIALSS AND SEQSERIE=:ISEQSERIE;
  SUSPEND;
END ^

ALTER PROCEDURE LIMPACAMPO2SP (VTAB VARCHAR(30),
VCAMPO VARCHAR(30),
STAM SMALLINT)
AS 
declare variable s smallint;
declare variable vsql varchar(1000);
declare variable csep char(1);
begin
  /* Procedure Text */
  S = STAM;
  CSEP = ascii_char(39);
  WHILE (S >= 1) DO
  BEGIN
     VSQL = 'UPDATE '||VTAB||' SET '||VCAMPO||' = ';
     IF (S>1) THEN
     BEGIN
        VSQL = VSQL ||'SUBSTRING('||VCAMPO||' FROM 1 FOR '||(S-1)||') || ';
     END
     VSQL = VSQL || 'SUBSTRING('||VCAMPO||' FROM '||(S+1)||' FOR '||(STAM-S)||') ' ||
       'WHERE SUBSTRING('||VCAMPO||' FROM '||S||' FOR 1 '||
       ') NOT IN ('
       ||CSEP||'A'||CSEP||','||CSEP||'B'||CSEP||','||CSEP||'C'||CSEP||','
       ||CSEP||'D'||CSEP||','||CSEP||'E'||CSEP||','||CSEP||'F'||CSEP||','
       ||CSEP||'G'||CSEP||','||CSEP||'H'||CSEP||','||CSEP||'I'||CSEP||','
       ||CSEP||'J'||CSEP||','||CSEP||'K'||CSEP||','||CSEP||'L'||CSEP||','
       ||CSEP||'M'||CSEP||','||CSEP||'N'||CSEP||','||CSEP||'O'||CSEP||','
       ||CSEP||'P'||CSEP||','||CSEP||'Q'||CSEP||','||CSEP||'R'||CSEP||','
       ||CSEP||'S'||CSEP||','||CSEP||'T'||CSEP||','||CSEP||'U'||CSEP||','
       ||CSEP||'W'||CSEP||','||CSEP||'V'||CSEP||','||CSEP||'X'||CSEP||','
       ||CSEP||'Y'||CSEP||','||CSEP||'Z'||CSEP||')';
       S = S-1;
       EXECUTE STATEMENT VSQL ;
  END
  suspend;
end ^

ALTER PROCEDURE LIMPACAMPOSP (VTAB VARCHAR(30),
VCAMPO VARCHAR(30),
STAM SMALLINT)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

declare variable s smallint;
declare variable vsql varchar(1000);
declare variable csep char(1);
begin
  /* Procedure Text */
  S = STAM;
  CSEP = ascii_char(39);
  WHILE (S >= 1) DO
  BEGIN
     VSQL = 'UPDATE '||VTAB||' SET '||VCAMPO||' = ';
     IF (S>1) THEN
     BEGIN
        VSQL = VSQL ||'SUBSTRING('||VCAMPO||' FROM 1 FOR '||(S-1)||') || ';
     END
     VSQL = VSQL || 'SUBSTRING('||VCAMPO||' FROM '||(S+1)||' FOR '||(STAM-S)||') ' ||
       'WHERE SUBSTRING('||VCAMPO||' FROM '||S||' FOR 1 '||
       ') NOT IN ('
       ||CSEP||'0'||CSEP||','||CSEP||'1'||CSEP||','||CSEP||'2'||CSEP||','
       ||CSEP||'3'||CSEP||','||CSEP||'4'||CSEP||','||CSEP||'5'||CSEP||','
       ||CSEP||'6'||CSEP||','||CSEP||'7'||CSEP||','||CSEP||'8'||CSEP||','
       ||CSEP||'9'||CSEP||')';
       S = S-1;
       EXECUTE STATEMENT VSQL ;
  END
  suspend;
end ^

ALTER PROCEDURE PPATUDISTOPSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODOP INTEGER,
SSEQOP SMALLINT,
NQTDDISTOLD NUMERIC(15, 5),
NQTDDISTNEW NUMERIC(15, 5))
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

begin
  if (NQTDDISTOLD is null) then
     NQTDDISTOLD = 0;
  if (NQTDDISTNEW is null) then
     NQTDDISTNEW = 0;
  if (NQTDDISTOLD!=NQTDDISTNEW) then
     UPDATE PPOP SET QTDDISTPOP = QTDDISTPOP + (:NQTDDISTNEW-:NQTDDISTOLD)
        WHERE CODEMP=:ICODEMP AND CODFILIAL=:SCODFILIAL AND
          CODOP=:ICODOP AND SEQOP=:SSEQOP ;
  suspend;
end ^

ALTER PROCEDURE PPCUSTOPRODSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODPROD INTEGER,
DTESTOQ DATE,
CTIPOCUSTO CHAR(1),
ICODEMPAX INTEGER,
SCODFILIALAX SMALLINT,
ICODALMOX INTEGER,
CCOMSALDO CHAR(10))
RETURNS (CUSTOUNIT NUMERIC(15, 5),
SLDPROD NUMERIC(15, 5))
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

declare variable qtditest numeric(15,5);
declare variable seqest smallint;
declare variable tipoprod varchar(2);
declare variable custotot numeric(15,5);
declare variable codprodpd integer;
begin
  /* Retorna o custo unitrio do produto */
  IF (CTIPOCUSTO IS NULL) then
     CTIPOCUSTO = 'P';

  SELECT P.TIPOPROD
   FROM EQPRODUTO P
   WHERE P.CODEMP = :ICODEMP AND P.CODFILIAL = :SCODFILIAL AND
      P.CODPROD=:ICODPROD
   INTO :TIPOPROD;

  IF (TIPOPROD='F') THEN
  BEGIN
     SELECT SLDPROD FROM EQCUSTOPRODSP(:ICODEMP, :SCODFILIAL, :ICODPROD,
        :DTESTOQ, :CTIPOCUSTO,  :ICODEMPAX, :SCODFILIALAX, :ICODALMOX, 'N')
     INTO :SLDPROD;

     CUSTOTOT = 0;

     SELECT FIRST 1 E.SEQEST FROM PPESTRUTURA E
       WHERE E.CODEMP=:ICODEMP AND E.CODFILIAL=:SCODFILIAL AND E.CODPROD=:ICODPROD
       ORDER BY E.SEQEST INTO :SEQEST;

     FOR SELECT I.CODPRODPD,I.QTDITEST FROM  PPITESTRUTURA I
        WHERE I.CODEMP=:ICODEMP AND I.CODFILIAL=:SCODFILIAL AND
          I.CODPROD=:ICODPROD AND I.SEQEST=:SEQEST
        INTO :CODPRODPD, :QTDITEST DO
     BEGIN
         SELECT CUSTOUNIT FROM PPCUSTOPRODSP(:ICODEMP, :SCODFILIAL, :CODPRODPD, :DTESTOQ,
            :CTIPOCUSTO, :ICODEMPAX, :SCODFILIALAX, :ICODALMOX, :CCOMSALDO)
         INTO :CUSTOUNIT;
         CUSTOTOT = CUSTOTOT + ( CUSTOUNIT * QTDITEST)  ;
     END
  END
  ELSE
  BEGIN
     SELECT CUSTOUNIT,SLDPROD FROM EQCUSTOPRODSP(:ICODEMP, :SCODFILIAL, :ICODPROD,
        :DTESTOQ, :CTIPOCUSTO,  :ICODEMPAX, :SCODFILIALAX, :ICODALMOX, 'N')
     INTO :CUSTOTOT, :SLDPROD;
  END
  CUSTOUNIT = CUSTOTOT;
  SUSPEND;
end ^

ALTER PROCEDURE PPGERAOP (TIPOPROCESS CHAR(1),
CODEMPOP INTEGER,
CODFILIALOP SMALLINT,
CODOP INTEGER,
SEQOP INTEGER,
CODEMPPD INTEGER,
CODFILIALPD SMALLINT,
CODPROD INTEGER,
CODEMPOC INTEGER,
CODFILIALOC SMALLINT,
CODORC INTEGER,
TIPOORC CHAR(1),
CODITORC SMALLINT,
QTDSUGPRODOP NUMERIC(15, 5),
DTFABROP DATE,
SEQEST SMALLINT,
CODEMPET INTEGER,
CODFILIALET SMALLINT,
CODEST SMALLINT,
AGRUPDATAAPROV CHAR(1),
AGRUPDTFABROP CHAR(1),
AGRUPCODCLI CHAR(1),
CODEMPCL INTEGER,
CODFILIALCL SMALLINT,
CODCLI INTEGER,
DATAAPROV DATE,
CODEMPCP INTEGER,
CODFILIALCP SMALLINT,
CODCOMPRA INTEGER,
CODITCOMPRA SMALLINT,
JUSTFICQTDPROD VARCHAR(500),
CODEMPPDENTRADA INTEGER,
CODFILIALPDENTRADA SMALLINT,
CODPRODENTRADA INTEGER,
QTDENTRADA NUMERIC(15, 5))
RETURNS (CODOPRET INTEGER,
SEQOPRET SMALLINT)
AS 
 
 
declare variable codempax integer;
declare variable codfilialax smallint;
declare variable codalmox integer;
declare variable refprod varchar(20);
declare variable codemptm integer;
declare variable codfilialtm smallint;
declare variable codtipomov integer;
declare variable sitpadop char(2);
declare variable seqof smallint;
declare variable codempfs integer;
declare variable codfilialfs smallint;
declare variable codfase integer;
declare variable tempoefdias numeric(15,5);
declare variable tempoef numeric(15,5);
declare variable datafimprodant date;
declare variable hfimprodant time;
declare variable qtdfinalprodop numeric(15,5);
declare variable codtipomovtm integer;
declare variable sitpadopconv char(2);
declare variable codemprma integer;
declare variable codfilialrma smallint;
declare variable codrma integer;
declare variable coditrma smallint;
declare variable estdinamica char(1);
begin

    if(codop is null) then
    begin

        -- Busca novo cdigo para a OP caso no venha no parmetro.
        select coalesce(max(codop),0) + 1 from ppop where codemp=:codempop and codfilial=:codfilialop
        into :codop;

        -- Buscando informaes do produto e estrutura.

        select pd.codempax, pd.codfilialax, pd.codalmox, pd.refprod, es.estdinamica from eqproduto pd, ppestrutura es
        where pd.codemp=:codemppd and pd.codfilial=:codfilialpd and pd.codprod=:codprod
        and es.codemp=pd.codemp and es.codfilial=pd.codfilial and es.codprod=pd.codprod and es.seqest=:seqest
        into :codempax, :codfilialax, :codalmox, :refprod, :estdinamica;

        -- Buscando tipo de movimento para OP.
        select p5.codemptm, p5.codfilialtm, p5.codtipomov, coalesce(tm.codtipomovtm,p5.codtipomov), p5.sitpadop, p5.sitpadopconv
        from sgprefere5 p5, eqtipomov tm
        where p5.codemp=:codempop and p5.codfilial=:codfilialop and
        tm.codemp=p5.codemptm and tm.codfilial=p5.codfilialtm and tm.codtipomov=p5.codtipomov
        into :codemptm, :codfilialtm, :codtipomov, :codtipomovtm, :sitpadop, :sitpadopconv;

        -- Inserindo OP
        seqop = 0;

        if(sitpadop='FN' and tipoprocess in ('D','A')) then
        begin
            qtdfinalprodop = :qtdsugprodop;
            codtipomov = :codtipomovtm;
        end
        else if(sitpadopconv='FN' and tipoprocess='C') then
        begin
            qtdfinalprodop = :qtdsugprodop;
            codtipomov = :codtipomovtm;
        end
        else
        begin
            qtdfinalprodop = 0;
        end

        insert into ppop  (codemp, codfilial, codop, seqop,
                           codemppd, codfilialpd, codprod, seqest, refprod,
                           codempax, codfilialax, codalmox,
                           dtemitop, dtfabrop,
                           qtdsugprodop, qtdprevprodop, qtdfinalprodop,
                           codemple, codfilialle, codlote,
                           codemptm, codfilialtm, codtipomov,
                           sitop, codempcp, codfilialcp, codcompra, coditcompra, justficqtdprod, estdinamica)
        values ( :codempop, :codfilialop, :codop, :seqop,
                 :codemppd, :codfilialpd, :codprod, :seqest, :refprod,
                 :codempax, :codfilialax, :codalmox,
                 cast('today' as date), :dtfabrop,
                 :qtdsugprodop, :qtdsugprodop, :qtdfinalprodop, null,null,null, 
                 :codemptm, :codfilialtm, :codtipomov, :sitpadop,
                 :codempcp, :codfilialcp, :codcompra, :coditcompra, :justficqtdprod, :estdinamica

        );

        -- Caso o status padro da OP seja Finalizado
        if(:sitpadop='FN') then
        begin
            -- Inicializando variaveis
            datafimprodant = :dtfabrop;
            hfimprodant = cast('now' as time);

            -- Gerando RMAS

            execute procedure eqgerarmasp(:codempop,:codfilialop,:codop,:seqop);

            -- Finalizando Fases

            for select oe.codempfs, oe.codfilialfs, oe.codfase, oe.seqof
            from ppopfase oe, ppop op
            where oe.codemp=:codempop and oe.codfilial=:codfilialop and oe.codop=:codop and oe.seqop=:seqop and
            op.codemp=oe.codemp and op.codfilial=oe.codfilial and op.codop=oe.codop and op.seqop=oe.seqop
            order by oe.seqof
            into :codempfs, :codfilialfs, :codfase, :seqof do
            begin
                -- Buscando informaes da fase
                select ef.tempoef from ppestrufase ef
                where ef.codemp=:codempfs and ef.codfilial=:codfilialfs and ef.codfase=:codfase and
                ef.codemp=:codemppd and ef.codfilial=:codfilialpd and ef.codprod=:codprod and ef.seqest=:seqest
                into :tempoef;

                tempoefdias = (tempoef/3600) / 24; -- de segundos para dias...

                update ppopfase oe set oe.sitfs=:sitpadop, oe.obsfs='Fase finalizada automaticamente',
                oe.datainiprodfs=:datafimprodant, oe.hiniprodfs=:hfimprodant,
                oe.datafimprodfs=:datafimprodant + :tempoefdias, oe.hfimprodfs=:hfimprodant + :tempoef
                where oe.codemp=:codempop and oe.codfilial=:codfilialop and oe.codop=:codop and oe.seqop=:seqop and
                oe.seqof=:seqof;

                -- Carregando variveis para proximo registro
                datafimprodant = :datafimprodant + :tempoefdias;
                hfimprodant = :hfimprodant + :tempoef;

            end
        end

    end

    -- Caso o tipo de processamento seja Detalhado (uma OP por oramento)
    if(tipoprocess='D') then
    begin

        -- Caso o cdigo do oramento e cdigo da OP tenham sido informados (deve ocorrer no modo oramento ou a partir da segunda passagem do modo agrupado...
        if( (codorc is not null) and (codop is not null) ) then
        begin
            insert into ppopitorc (codemp, codfilial, codop, seqop, codempoc, codfilialoc, tipoorc, codorc, coditorc, qtdprod)
            values(:codempop, :codfilialop, :codop, :seqop, :codempoc, :codfilialoc, :tipoorc, :codorc, :coditorc, :qtdsugprodop);

            -- Caso a OP seja gerada j finalizada... deve mudar o status do item de oramento para produzido.
            if(sitpadop='FN') then
            begin
                update vditorcamento io set io.sitproditorc='PD'
                where io.codemp=:codempoc and io.codfilial=:codfilialoc and io.codorc=:codorc and io.coditorc=:coditorc and io.tipoorc=:tipoorc;
            end

        end
    end
    -- Caso o tipo de processamento seja Agrupado (uma OP para vrios oramentos)
    else if(tipoprocess='A') then
    begin

        for select pt.codemp,pt.codfilial, pt.codorc, pt.coditorc, pt.tipoorc, pt.dtfabrop, pt.qtdaprod
        from ppprocessaoptmp pt, vditorcamento io, vdorcamento oc
        where pt.codempet=:codempet and pt.codfilialet=:codfilialet and pt.codest=:codest
        and io.codemp=pt.codemp and io.codfilial=pt.codfilial and io.codorc=pt.codorc and io.coditorc=pt.coditorc and io.tipoorc=pt.tipoorc
        and oc.codemp=io.codemp and oc.codfilial=io.codfilial and oc.codorc=io.codorc and oc.tipoorc=io.tipoorc
        and (:agrupdataaprov='N' or io.dtaprovitorc=:dataaprov )
        and (:agrupdtfabrop='N' or pt.dtfabrop=:dtfabrop )
        and (:agrupcodcli='N' or (oc.codorc=:codcli and oc.codempcl=:codempcl and oc.codfilialcl=:codfilialcl) )
        and io.codemppd=:codemppd and io.codfilialpd=:codfilialpd and io.codprod=:codprod
        into :codempoc, :codfilialoc, :codorc, :coditorc, :tipoorc, :dtfabrop, :qtdsugprodop do
        begin

            insert into ppopitorc (codemp, codfilial, codop, seqop, codempoc, codfilialoc, tipoorc, codorc, coditorc, qtdprod)
            values(:codempop, :codfilialop, :codop, :seqop, :codempoc, :codfilialoc, :tipoorc, :codorc, :coditorc, :qtdsugprodop);

            -- Caso a OP seja gerada j finalizada... deve mudar o status do item de oramento para produzido.
            if(sitpadop='FN') then
            begin
                update vditorcamento io set io.sitproditorc='PD'
                where io.codemp=:codempoc and io.codfilial=:codfilialoc and io.codorc=:codorc and io.coditorc=:coditorc and io.tipoorc=:tipoorc;
            end

        end
    end

    -- Carregando parametros de sada
    codopret = :codop;
    seqopret = :seqop;

    suspend;

end ^

ALTER PROCEDURE PPGERAOPCQ (ICODEMP INTEGER,
ICODFILIAL SMALLINT,
ICODOP INTEGER,
ISEQOP SMALLINT)
AS 
 
declare variable iseqef smallint;
declare variable iseqopcq smallint;
declare variable icodempea integer;
declare variable icodfilialea smallint;
declare variable icodestanalise integer;
BEGIN

    SELECT COALESCE(MAX(SEQOPCQ),0)
        FROM PPOPCQ
            WHERE CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL
                AND CODOP=:ICODOP AND SEQOP=:ISEQOP
    INTO :ISEQOPCQ;

    FOR
        SELECT EA.SEQEF, EA.codemp,EA.codfilial,EA.codestanalise
            FROM PPESTRUANALISE EA, PPOP O, PPESTRUTURA E, ppfase f
            WHERE O.CODEMP=:iCodEmp AND O.CODFILIAL=:iCodFilial
                AND O.CODOP=:iCodOp AND O.SEQOP=:iSEQOP AND E.CODEMP=O.CODEMPPD
                AND E.CODFILIAL=O.CODFILIALPD AND E.CODPROD=O.CODPROD AND E.SEQEST=O.SEQEST
                AND EA.CODEMP=E.CODEMP AND EA.CODFILIAL=E.CODFILIAL AND EA.CODPROD=E.CODPROD
                AND EA.SEQEST=E.SEQEST
                and f.codemp=ea.codempfs and f.codfilial=ea.codfilialfs and f.codfase=ea.codfase
                and f.tipofase='CQ'
        INTO :iSeqEf, :ICODEMPEA,:ICODFILIALEA,:ICODESTANALISE
    DO
    BEGIN
        ISEQOPCQ = :ISEQOPCQ + 1;
        INSERT INTO PPOPCQ (CODEMP,CODFILIAL,CODOP,SEQOP,SEQOPCQ,
            CODEMPEA,CODFILIALEA,CODESTANALISE, SEQEF)
            VALUES (:iCodEmp,:iCodFilial,:iCodOp,:iSeqOp, :ISEQOPCQ,:ICODEMPEA,
                    :ICODFILIALEA,:ICODESTANALISE,:iseqef);
    END

END ^

ALTER PROCEDURE PPITOPSP01 (ICODEMP INTEGER,
ICODFILIAL SMALLINT,
ICODOP INTEGER,
ISEQOP SMALLINT)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

declare variable icodemppd integer;
declare variable icodfilialpd smallint;
declare variable gerarma char(1);
declare variable crefprod varchar(20);
declare variable icodprodpd integer;
declare variable nqtditop numeric(15,5);
declare variable icodemple integer;
declare variable icodfilialle smallint;
declare variable ccodlote varchar(20);
declare variable icodempfs integer;
declare variable icodfilialfs smallint;
declare variable icodfase integer;
declare variable icodemptr integer;
declare variable icodfilialtr smallint;
declare variable icodtprec integer;
declare variable icodemprp integer;
declare variable icodfilialrp smallint;
declare variable icodrecp integer;
declare variable dtempoof numeric(15,5);
declare variable iseqof smallint;
declare variable iseqppitop integer;
declare variable qtditest numeric(15,5);
declare variable qtdest numeric(15,5);
declare variable qtdprevprodop numeric(15,5);
declare variable qtdfixa char(1);
declare variable estdinamica char(1);
declare variable permiteajusteitop char(1);
declare variable iseqsubprod integer;
declare variable qtditestsp numeric(15,5);
declare variable codempts integer;
declare variable codfilialts smallint;
declare variable codtipomovsp integer;
declare variable tipoexterno char(10);
begin

    --Loop nas fases da estrutura para gerao da tabela de fases da OP.
    for select ef.seqef, ef.codempfs, ef.codfilialfs, ef.codfase, ef.codemptr, ef.codfilialtr, ef.codtprec, ef.tempoef, o.estdinamica
    from ppestrufase ef, ppop o, ppestrutura e
    where
        o.codemp=:icodemp and o.codfilial=:icodfilial and o.codop=:icodop and o.seqop=:iseqop and
        e.codemp=o.codemppd and e.codfilial=o.codfilialpd and e.codprod=o.codprod and e.seqest=o.seqest and
        ef.codemp=e.codemp and ef.codfilial=e.codfilial and ef.codprod=e.codprod and ef.seqest=E.seqest
    into
        :iseqof, :icodempfs, :icodfilialfs, :icodfase, :icodemptr, :icodfilialtr, :icodtprec, :dtempoof, :estdinamica
    do
    begin
        -- Buscando o primeiro recurso para insero na fase (provisrio)
        select first 1 codemp, codfilial, codrecp from pprecurso r
        where r.codemp=:icodemptr and r.codfilial=:icodfilialtr and r.codtprec=:icodtprec
        into :icodemprp, :icodfilialrp, :icodrecp;

        -- Inserindo na tabela de fase por op
        insert into
            ppopfase (
                codemp, codfilial, codop, seqop, seqof, codempfs, codfilialfs, codfase, codemprp, codfilialrp, codrecp, tempoof,
                codemptr, codfilialtr, codtprec
            )
            values (
                :icodemp, :icodfilial, :icodop, :iseqop, :iseqof, :icodempfs, :icodfilialfs,:icodfase, :icodemprp, :icodfilialrp,
                :icodrecp,:dtempoof, :icodemptr, :icodfilialtr, :icodtprec
            );
    end

    -- Se a estrutura no for dinmica, deve inserir os tens

    if(coalesce(:estdinamica,'N')='N'  ) then    
    begin

        iseqppitop = 0;

        for select
            ie.codemppd, ie.codfilialpd, ie.codprodpd, ie.refprodpd, ie.rmaautoitest, ie.codempfs, ie.codfilialfs, ie.codfase,
            ie.qtditest, e.qtdest, o.qtdprevprodop, ie.qtdfixa,
            (   select min(l.codlote) from eqlote l
                where
                l.codemp=e.codemp and l.codfilial=e.codfilial and l.codprod=e.codprod and l.sldliqlote > 0 and l.venctolote =
                (   select min( ls.venctolote ) from eqlote ls where ls.codprod=l.codprod and ls.codfilial=l.codfilial and
                    ls.codemp=l.codemp and ls.sldliqlote>0)) codlote, ie.permiteajusteitest, ie.tipoexterno
            from
                ppitestrutura ie, ppestrutura e, ppop o
            where
                ie.codemp=e.codemp and ie.codfilial=e.codfilial and ie.codprod=e.codprod and ie.seqest=e.seqest and
                o.codemppd=e.codemp and o.codfilialpd=e.codfilial and o.codprod=e.codprod and o.seqest=e.seqest and
                o.codemp=:icodemp and o.codfilial=:icodfilial and o.codop=:icodop and o.seqop=:iseqop
            order by ie.codfase, ie.seqef
        into
        :icodemppd, :icodfilialpd, :icodprodpd, :crefprod, :gerarma, :icodempfs, :icodfilialfs, :icodfase,
        :qtditest,:qtdest,:qtdprevprodop,:qtdfixa,:ccodlote,:permiteajusteitop,:tipoexterno
        do
        begin
            if (:ccodlote is null ) then
            begin
                icodemple = null;
                icodfilialle = null;
            end
            else
            begin
                icodemple = icodemppd;
                icodfilialle = icodfilialpd;
            end

            iseqppitop = :iseqppitop + 1;

            if ('S'=qtdfixa) then
            begin
                nqtditop = :qtditest;
            end
            else
            begin
                nqtditop = cast(:qtditest/:qtdest as numeric(15,5) ) * cast(:qtdprevprodop as numeric(15, 5));
            end

            insert into ppitop (
                codemp, codfilial, codop, seqop, seqitop, codemppd, codfilialpd, codprod, refprod,
                codempfs, codfilialfs, codfase, qtditop, gerarma, permiteajusteitop, tipoexterno
            )
            values (
                :icodemp, :icodfilial, :icodop, :iseqop, :iseqppitop, :icodemppd, :icodfilialpd,
                :icodprodpd, :crefprod,:icodempfs, :icodfilialfs, :icodfase, :nqtditop, :gerarma,
                :permiteajusteitop, :tipoexterno
            );

        end

        -- Inserindo tabela de subprodutos

        iseqsubprod = 0;

        -- Buscando tipo de movimento para subproducao
        select codempts, codfilialts, codtipomovsp from sgprefere5 where codemp=:icodemp and codfilial=:icodfilial
        into :codempts, :codfilialts, :codtipomovsp;

        for select
            ie.codemppd, ie.codfilialpd, ie.seqitestsp, ie.codprodpd, ie.refprodpd, ie.codempfs, ie.codfilialfs, ie.codfase,
            ie.qtditestsp, e.qtdest, o.qtdprevprodop, ie.qtdfixa,
            (   select min(l.codlote) from eqlote l
                where
                l.codemp=e.codemp and l.codfilial=e.codfilial and l.codprod=e.codprod and l.sldliqlote > 0 and l.venctolote =
                (   select min( ls.venctolote ) from eqlote ls where ls.codprod=l.codprod and ls.codfilial=l.codfilial and
                    ls.codemp=l.codemp and ls.sldliqlote>0)) codlote, fs.seqof
            from
                ppitestruturasubprod ie, ppestrutura e, ppop o, ppopfase fs
            where
                ie.codemp=e.codemp and ie.codfilial=e.codfilial and ie.codprod=e.codprod and ie.seqest=e.seqest and
                o.codemppd=e.codemp and o.codfilialpd=e.codfilial and o.codprod=e.codprod and o.seqest=e.seqest and
                o.codemp=:icodemp and o.codfilial=:icodfilial and o.codop=:icodop and o.seqop=:iseqop and
                fs.codemp=ie.codempfs and fs.codfilial=ie.codfilialfs and fs.codfase=ie.codfase and fs.codop=o.codop and fs.seqop=o.seqop
            order by ie.codfase, ie.seqef
        into
        :icodemppd, :icodfilialpd, :iseqsubprod, :icodprodpd, :crefprod, :icodempfs, :icodfilialfs, :icodfase,
        :qtditestsp,:qtdest,:qtdprevprodop,:qtdfixa,:ccodlote, :iseqof
        do
        begin

            if (:ccodlote is null ) then
            begin
                icodemple = null;
                icodfilialle = null;
            end
            else
            begin
                icodemple = icodemppd;
                icodfilialle = icodfilialpd;
            end

            iseqsubprod = :iseqsubprod + 1;

           insert into ppopsubprod (codemp, codfilial, codop, seqop, seqsubprod, codemppd, codfilialpd, codprod,
                refprod, qtditsp, codempfs, codfilialfs, codfase, codemple, codfilialle, codlote, seqof, codemptm, codfilialtm, codtipomov
           )
           values(
                :icodemp, :icodfilial,:icodop,:iseqop, :iseqsubprod, :icodemppd, :icodfilialpd, :icodprodpd,
                :crefprod, :qtditestsp, :icodempfs, :icodfilialfs, :icodfase, :icodemple, :icodfilialle, :ccodlote, :iseqof, :codempts, :codfilialts, :codtipomovsp
           );



        end


    end

end ^

ALTER PROCEDURE PPITOPSP02 (ICODEMP INTEGER,
ICODFILIAL SMALLINT,
ICODOP INTEGER,
ISEQOP SMALLINT)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

DECLARE VARIABLE NQTDITOP NUMERIC(15,5);
DECLARE VARIABLE ICODPRODPD INTEGER;
DECLARE VARIABLE ISEQITOP SMALLINT;
DECLARE VARIABLE ICODEMPPD INTEGER;
DECLARE VARIABLE ISEQPPITOP SMALLINT;
BEGIN
    FOR SELECT It.seqitop,
        CAST( IE.QTDITEST / E.QTDEST AS NUMERIC(15,5) ) * CAST(O.QTDFINALPRODOP AS NUMERIC(15, 5))
        FROM PPITESTRUTURA IE, PPESTRUTURA E, PPOP O, PPITOP IT
            WHERE IE.CODEMP=E.CODEMP AND IE.CODFILIAL=E.CODFILIAL AND
                IE.CODPROD=E.CODPROD AND IE.SEQEST=E.SEQEST AND
                O.CODEMPPD=E.CODEMP AND O.CODFILIALPD=E.CODFILIAL AND
                O.CODPROD=E.CODPROD AND O.SEQEST=E.SEQEST AND
                O.CODEMP=:ICODEMP AND O.CODFILIAL=:ICODFILIAL AND
                O.CODOP=:ICODOP AND O.SEQOP=:ISEQOP AND
                IT.codemp=O.CODEMP AND IT.CODFILIAL=O.CODFILIAL AND
                IT.codop=O.CODOP AND IT.seqop=O.seqop AND
                IE.codempfs=IT.codempfs AND IE.codfilial=IT.codfilialfs AND
                IE.codfase=IT.codfase and
                ie.codemppd=it.codemp and ie.codfilialpd=it.codfilial and
                ie.codprodpd=it.codprod and
                IE.qtdvariavel = 'S'
            INTO :ISEQITOP,:NQTDITOP
    DO
    BEGIN
        UPDATE PPITOP IOP SET QTDITOP=:NQTDITOP
            WHERE CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL AND IOP.codop=:ICODOP
                AND IOP.seqop=:ISEQOP AND IOP.seqitop=:ISEQITOP;

    END
   SUSPEND;
END ^

ALTER PROCEDURE PPRELCUSTOSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
DTESTOQ DATE,
ICODEMPMC INTEGER,
SCODFILIALMC SMALLINT,
CCODMARCA CHAR(6),
ICODEMPGP INTEGER,
SCODFILIALGP SMALLINT,
CCODGRUP CHAR(14),
CTIPOCUSTO CHAR(1),
ICODEMPAX INTEGER,
SCODFILIALAX SMALLINT,
ICODALMOX INTEGER)
RETURNS (CODPROD INTEGER,
REFPROD VARCHAR(20),
DESCPROD CHAR(100),
TIPOPROD VARCHAR(2),
SLDPROD NUMERIC(15, 5),
CUSTOUNIT NUMERIC(15, 5),
CUSTOTOT NUMERIC(15, 5))
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

begin
  /* Procedure Text */
  IF (ICODEMPGP IS NOT NULL) THEN
  BEGIN
    IF (STRLEN(RTRIM(CCODGRUP))<14) THEN
       CCODGRUP = RTRIM(CCODGRUP)||'%';
  END
  IF (CTIPOCUSTO IS NULL) then
     CTIPOCUSTO = 'P';

  FOR SELECT P.CODPROD,P.REFPROD,P.DESCPROD, P.TIPOPROD
   FROM EQPRODUTO P
   WHERE P.CODEMP = :ICODEMP AND P.CODFILIAL = :SCODFILIAL AND
   ( (:ICODEMPMC IS NULL) OR (P.CODEMPMC=:ICODEMPMC AND P.CODFILIALMC=:SCODFILIALMC AND
      P.CODMARCA=:CCODMARCA) ) AND
   ((:ICODEMPGP IS NULL) OR (P.CODEMPGP=:ICODEMPGP AND P.CODFILIALGP=:SCODFILIALGP AND
      P.CODGRUP LIKE :CCODGRUP) )
   INTO :CODPROD, :REFPROD, :DESCPROD, :TIPOPROD  DO
  BEGIN
     SELECT CUSTOUNIT,SLDPROD FROM PPCUSTOPRODSP(:ICODEMP,
        :SCODFILIAL, :CODPROD, :DTESTOQ, :CTIPOCUSTO, :ICODEMPAX,
        :SCODFILIALAX, :ICODALMOX, 'N')
       INTO :CUSTOUNIT, :SLDPROD;
     CUSTOTOT = CUSTOUNIT * SLDPROD;
     SUSPEND;
  END
end ^

ALTER PROCEDURE PVABRECAIXASP (ICODCAIXA INTEGER,
SCODFILIAL SMALLINT,
ICODEMP INTEGER,
NVLRINICAIXA NUMERIC(15, 5),
DDTAMOV DATE,
ICODFILIALUS SMALLINT,
CIDUSU CHAR(8))
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

DECLARE VARIABLE INROMOV INTEGER;
BEGIN
    SELECT INROMOV FROM PVSEQMOVCAIXASP(:ICODEMP, :SCODFILIAL, :ICODCAIXA, :DDTAMOV) INTO :INROMOV;

    INSERT INTO PVMOVCAIXA (CODCAIXA,CODFILIAL,CODEMP,DTAMOV,NROMOV,TIPOMOV,VLRSLDMOV,VLRMOV,CODEMPUS,CODFILIALUS,IDUSU) VALUES
      (:iCodCaixa,:sCodFilial,:iCodEmp,:DDTAMOV,:INROMOV,'A',:nVlrIniCaixa,:nVlrIniCaixa,:iCodEmp,:iCodFilialUs,:cIdUsu);
  SUSPEND;
END ^

ALTER PROCEDURE PVADICMOVCAIXASP01 (ICODCAIXA INTEGER,
NVLRINICAIXA NUMERIC(18, 3),
ICODEMP INTEGER,
SCODFILIAL SMALLINT,
DDTAMOV DATE)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

DECLARE VARIABLE ICODMOVCAIXA INTEGER;
BEGIN
  SELECT INROMOV FROM PVSEQMOVCAIXASP(:ICODEMP, :SCODFILIAL, :ICODCAIXA, :DDTAMOV) INTO :ICODMOVCAIXA;
  INSERT INTO PVMOVCAIXA (CODEMP,CODFILIAL,CODCAIXA,DTAMOV,NROMOV,TIPOMOV,VLRSLDMOV,VLRMOV)
         VALUES (
                :ICODEMP,:SCODFILIAL,:iCodCaixa,:DDTAMOV,
                :ICODMOVCAIXA,'A',:nVlrIniCaixa,:nVlrIniCaixa
         );
  SUSPEND;
END ^

ALTER PROCEDURE PVFECHACAIXASP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODCAIXA INTEGER,
DDTAMOV DATE,
REDUZ CHAR(1),
ICODFILIALUS SMALLINT,
CIDUSU CHAR(8))
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

DECLARE VARIABLE ICODMOVCAIXA INTEGER;
DECLARE VARIABLE STATUSFECHA CHAR(1);
BEGIN
  SELECT INROMOV FROM PVSEQMOVCAIXASP(:ICODEMP, :SCODFILIAL, :ICODCAIXA, :DDTAMOV) INTO :ICODMOVCAIXA;

  IF (REDUZ = 'S') THEN
    STATUSFECHA = 'Z';
  ELSE
    STATUSFECHA = 'F';


  INSERT INTO PVMOVCAIXA (CODEMP,CODFILIAL,CODCAIXA,DTAMOV,NROMOV,TIPOMOV,
                          VLRMOV,CODEMPUS,CODFILIALUS,IDUSU) VALUES (
                         :ICODEMP,:SCODFILIAL,:ICODCAIXA,:DDTAMOV,
                         :ICODMOVCAIXA,:STATUSFECHA,0,:ICODEMP,:ICODFILIALUS,:CIDUSU
                         );
  SUSPEND;
END ^

ALTER PROCEDURE PVFECHAVENDASP (ICODEMP INTEGER,
ICODFILIAL SMALLINT,
NVALOR NUMERIC(15, 5),
ITERM INTEGER,
DDTAMOV DATE,
CIDUSU CHAR(8))
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

DECLARE VARIABLE ICODMOVCAIXA INTEGER;
DECLARE VARIABLE IFILIALUSU SMALLINT;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'SGUSUARIO') INTO IFILIALUSU;
  /*SELECT ISEQ FROM SPGERANUM(:ICODEMP,:ICODFILIAL,'MC') INTO ICODMOVCAIXA;*/
  SELECT INROMOV FROM PVSEQMOVCAIXASP(:ICODEMP, :ICODFILIAL, :ITERM , :DDTAMOV) INTO :ICODMOVCAIXA;
  INSERT INTO PVMOVCAIXA (CODEMP,CODFILIAL,CODCAIXA,DTAMOV,NROMOV,TIPOMOV,VLRMOV,CODEMPUS,CODFILIALUS,IDUSU)
         VALUES (
                :ICODEMP,:ICODFILIAL,:ITERM,:DDTAMOV,
                :ICODMOVCAIXA,'V',:NVALOR,:ICODEMP,:IFILIALUSU,:CIDUSU
         );
  SUSPEND;
END ^

ALTER PROCEDURE PVRETMOVCAIXASP (ICODCAIXA INTEGER,
ICODEMP INTEGER,
ICODFILIAL SMALLINT,
DDTAMOV DATE)
RETURNS (DDTAMOVRET DATE,
CTIPOMOV CHAR(1),
NVLRSLDMOV NUMERIC(15, 5),
CIDUSU CHAR(8))
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

BEGIN
  SELECT DTAMOV,TIPOMOV,VLRSLDMOV,IDUSU FROM PVMOVCAIXA WHERE
         NROMOV = (
                  SELECT MAX(NROMOV) FROM PVMOVCAIXA WHERE
                         CODCAIXA=:ICODCAIXA
                         AND DTAMOV =:DDTAMOV
                         AND CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL
                  )
         AND CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL AND DTAMOV=:DDTAMOV AND CODCAIXA=:ICODCAIXA
         INTO :DDTAMOVRET, :CTIPOMOV, :NVLRSLDMOV, :CIDUSU;

  SUSPEND;
END ^

ALTER PROCEDURE PVSANGRIASP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
NVALOR NUMERIC(18, 3),
ICODCAIXA INTEGER,
DDTAMOV DATE,
CIDUSU CHAR(8))
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

DECLARE VARIABLE ICODMOVCAIXA INTEGER;
DECLARE VARIABLE IFILIALUSU INTEGER;
BEGIN
  if (NVALOR IS NULL) then
     NVALOR = 0;
  SELECT INROMOV FROM PVSEQMOVCAIXASP(:ICODEMP, :SCODFILIAL, :ICODCAIXA, :DDTAMOV) INTO :ICODMOVCAIXA;
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'SGUSUARIO') INTO IFILIALUSU;
  INSERT INTO PVMOVCAIXA (CODEMP,CODFILIAL,CODCAIXA,DTAMOV,NROMOV,TIPOMOV,VLRMOV,CODEMPUS,CODFILIALUS,IDUSU)
         VALUES (
                :ICODEMP,:SCODFILIAL,:ICODCAIXA,:DDTAMOV,
                :ICODMOVCAIXA,'S',:NVALOR*-1,:ICODEMP,:IFILIALUSU,:CIDUSU
         );
  SUSPEND;
END ^

ALTER PROCEDURE PVSEQMOVCAIXASP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODCAIXA INTEGER,
DDTAMOV DATE)
RETURNS (INROMOV INTEGER)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

begin
    SELECT NROMOV FROM PVSEQMOVCAIXA WHERE DTAMOV=:DDTAMOV AND CODCAIXA=:ICODCAIXA
          AND CODEMP=:ICODEMP AND CODFILIAL=:SCODFILIAL INTO :INROMOV;
    IF (INROMOV IS NULL) THEN
    BEGIN
       INROMOV = 1;
       INSERT INTO PVSEQMOVCAIXA (DTAMOV,CODCAIXA,CODEMP,CODFILIAL,NROMOV)
          VALUES (:DDTAMOV, :ICODCAIXA, :ICODEMP, :SCODFILIAL, :INROMOV);
    END
    ELSE
    BEGIN
       INROMOV = INROMOV + 1;
       UPDATE PVSEQMOVCAIXA SET NROMOV=:INROMOV WHERE DTAMOV=:DDTAMOV AND CODCAIXA=:ICODCAIXA AND
            CODEMP=:ICODEMP AND CODFILIAL=:SCODFILIAL;
    END

  suspend;
end ^

ALTER PROCEDURE PVSUPRIMENTOSP (ICODEMP INTEGER,
ICODFILIAL SMALLINT,
NVALOR NUMERIC(18, 3),
ITERM INTEGER,
DDTAMOV DATE,
CIDUSU CHAR(8))
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

DECLARE VARIABLE ICODMOVCAIXA INTEGER;
DECLARE VARIABLE IFILIALUSU INTEGER;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'SGUSUARIO') INTO IFILIALUSU;
  SELECT INROMOV FROM PVSEQMOVCAIXASP(:ICODEMP, :IFILIALUSU, :ITERM, :DDTAMOV) INTO :ICODMOVCAIXA;
  INSERT INTO PVMOVCAIXA (CODEMP,CODFILIAL,CODCAIXA,DTAMOV,NROMOV,TIPOMOV,VLRMOV,CODEMPUS,CODFILIALUS,IDUSU)
         VALUES (
                :ICODEMP,:ICODFILIAL,:ITERM,:DDTAMOV,
                :ICODMOVCAIXA,'U',:NVALOR,:ICODEMP,:IFILIALUSU,:CIDUSU
         );
  SUSPEND;
END ^

ALTER PROCEDURE PVVALIDFAIXACAIXASP (ICODEMP INTEGER,
ICODFILIAL SMALLINT,
ICODCAIXA INTEGER,
NEWSEQINI INTEGER,
NEWSEQMAX INTEGER)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

DECLARE VARIABLE ISEQINI INTEGER;
DECLARE VARIABLE ISEQMAX INTEGER;
DECLARE VARIABLE VARCODCAIXA INTEGER;
begin
  /* Procedure Text */
  FOR SELECT CODCAIXA FROM PVCAIXA WHERE CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL
     INTO :VARCODCAIXA DO
     BEGIN
        IF(:VARCODCAIXA<>:ICODCAIXA) THEN
           SELECT COALESCE(SEQINI,0),COALESCE(SEQMAX,0) FROM PVCAIXA
              WHERE CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL AND CODCAIXA=:VARCODCAIXA
              INTO :ISEQINI, :ISEQMAX;
           IF (((NEWSEQINI >= :ISEQINI) and (NEWSEQINI <= :ISEQMAX))
                 or ((NEWSEQMAX >= :ISEQINI) and (NEWSEQMAX <= :ISEQMAX)) ) THEN
              EXCEPTION PVSEQCAIXA01 'FAIXA DE SEQUENCIA INVALIDA!';
     END
  suspend;
end ^

ALTER PROCEDURE PVVERIFCAIXASP (ICODCAIXA INTEGER,
ICODEMP INTEGER,
SCODFILIAL SMALLINT,
DDTAMOV DATE,
SCODFILIALUS SMALLINT,
CIDUSU CHAR(8))
RETURNS (IRETORNO INTEGER)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

DECLARE VARIABLE CTMP CHAR(1);
DECLARE VARIABLE CIDUSUANT CHAR(8);
DECLARE VARIABLE SCODFILIALANT SMALLINT;
DECLARE VARIABLE DULTMOV DATE;
DECLARE VARIABLE INROMOV INTEGER;
BEGIN
  iRetorno = -1;
  SELECT FIRST 1 MC.TIPOMOV, MC.IDUSU, MC.CODFILIALUS, MC.DTAMOV, MC.NROMOV
    FROM PVMOVCAIXA MC
    WHERE MC.CODCAIXA=:ICODCAIXA  AND
       MC.CODEMP=:ICODEMP AND MC.CODFILIAL=:SCODFILIAL
    ORDER BY MC.DTAMOV DESC, MC.NROMOV DESC
    INTO :cTMP, :cIDUSUANT, :SCodFilialAnt, :DULTMOV, :INROMOV;

  if ( (DULTMOV IS NULL) OR (DDTAMOV = DULTMOV) ) then
  BEGIN
     if ( (cTMP IS NULL) OR (cTMP = 'F') ) then
     BEGIN
       iRetorno = 0; /*Caixa OK*/
       SUSPEND;
       EXIT;
     END
     else if (cTMP = 'Z') then
     BEGIN
       iRetorno = 11; /*Jah foi realizada reduoZ neste dia*/
       SUSPEND;
       EXIT;
     END
     else if (cTMP in ('A','S','U','V')) then
     BEGIN
       if ( (cIDUSU=cIDUSUANT) AND (SCodFilialUs=SCodFilialAnt) )then
          iRetorno = 1; /*Caixa aberto*/
       else
          iRetorno = 12; /* Caixa aberto por outro usuatio */
       SUSPEND;
       EXIT;
     END
  END
  else if (DDTAMOV > DULTMOV) then
  BEGIN
     if ( cTMP = 'F' ) then /* Caixa anterior fechado sem reduo Z */
     BEGIN                  /* O usurio dever digitar a leitura da memria fiscal */
       iRetorno = 2;
       SUSPEND;
       EXIT;
     END
     else if (cTMP = 'Z') then
     BEGIN
       iRetorno = 0; /* Caixa anterior fechado corretamente */
       SUSPEND;
       EXIT;
     END
     else /* Caixa anterior dever ser fechado */
     BEGIN
       iRetorno = 3; /* devera fechar o caixa*/
       SUSPEND;
       EXIT;
     END
  END
  ELSE
  BEGIN /*Tentativa de abertura de caixa retroativo*/
     iRetorno = 13;
  END
  SUSPEND;
END ^

ALTER PROCEDURE RHLISTACANDVAGASP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODVAGA INTEGER,
ICODFUNC INTEGER)
RETURNS (CODCAND INTEGER,
NOMECAND CHAR(50),
FONECAND CHAR(12),
PRETENSAOSAL NUMERIC(15, 2),
QUALIFICACOES INTEGER,
RESTRICOES INTEGER,
CURSOS INTEGER,
EXPERIENCIA INTEGER,
STVAGACAND CHAR(2),
STCAND CHAR(2))
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

begin
    for select cd.codcand, cd.nomecand, cd.fonecand, cd.pretensaosal,cd.stcand,
        (select count(*) from rhcandidatocarac ctq
            where ctq.codemp=cd.codemp and ctq.codfilial=cd.codfilial and ctq.codcand=cd.codcand
                and ctq.codcarac in
                    (select ctvq.codcarac from rhvagacaracquali ctvq
                        where ctvq.codemp=:icodemp and ctvq.codfilial=:scodfilial
                        and ctvq.codvaga=:icodvaga)
        ) as qualificacoes,
        (select count(*) from rhcandidatocarac ctr
            where ctr.codemp=cd.codemp and ctr.codfilial=cd.codfilial and ctr.codcand=cd.codcand
                and ctr.codcarac in
                    (select ctvr.codcarac from rhvagacaracrest ctvr
                        where ctvr.codemp=:icodemp and ctvr.codfilial=:scodfilial
                        and ctvr.codvaga=:icodvaga)
        ) as restricoes,
        (select count(*) from rhcandidatocurso cu
            where cu.codemp=cd.codemp and cu.codfilial=cd.codfilial and cu.codcand=cd.codcand
                and cu.codcurso in
                    (select vc.codcurso from rhvagacurso vc
                        where vc.codemp=:icodemp and vc.codfilial=:scodfilial
                            and vc.codvaga=:icodvaga )
        ) as cursos,
        (select count(*) from rhcandidatofunc fu
            where fu.codemp=cd.codemp and fu.codfilial=cd.codfilial and fu.codcand=cd.codcand
                and fu.codfunc=:icodfunc )
        as experiencia,
        coalesce(
            (select rv.stvagacand from rhvagacandidato rv
                where rv.codemp=:icodemp and rv.codfilial=:scodfilial and rv.codvaga=:icodvaga
                    and rv.codempca=cd.codemp and rv.codfilialca=cd.codfilial and rv.codcand=cd.codcand
            ),'DI'
        )

        from rhcandidato cd

    into :codcand, :nomecand, :fonecand, :pretensaosal, :stcand, :qualificacoes,
         :restricoes, :cursos, :experiencia, :stvagacand
    do
    begin
        suspend;
    end
end ^

ALTER PROCEDURE RHLISTAVAGACANDSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODCAND INTEGER)
RETURNS (CODVAGA INTEGER,
NOMEEMPR CHAR(60),
CODFUNC INTEGER,
DESCFUNC VARCHAR(100),
FAIXASALINI NUMERIC(15, 2),
FAIXASALFIM NUMERIC(15, 2),
STVAGA CHAR(2),
QUALIFICACOES INTEGER,
RESTRICOES INTEGER,
CURSOS INTEGER,
STVAGACAND CHAR(2))
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

begin
    for select vg.codvaga, empr.nomeempr, vg.codfunc, fu.descfunc, vg.faixasalini, vg.faixasalfim, vg.stvaga,
        (select count(*) from rhvagacaracquali ctq
            where ctq.codemp=vg.codemp and ctq.codfilial=vg.codfilial and ctq.codvaga=vg.codvaga
                and ctq.codcarac in
                    (select ctvq.codcarac from rhcandidatocarac ctvq
                        where ctvq.codemp=:icodemp and ctvq.codfilial=:scodfilial
                        and ctvq.codcand=:icodcand)
        ) as qualificacoes,
        (select count(*) from rhvagacaracrest ctr
            where ctr.codemp=vg.codemp and ctr.codfilial=vg.codfilial and ctr.codvaga=vg.codvaga
                and ctr.codcarac in
                    (select ctvr.codcarac from rhcandidatocarac ctvr
                        where ctvr.codemp=:icodemp and ctvr.codfilial=:scodfilial
                        and ctvr.codcand=:icodcand)
        ) as restricoes,
        (select count(*) from rhvagacurso cu
            where cu.codemp=vg.codemp and cu.codfilial=vg.codfilial and cu.codvaga=vg.codvaga
                and cu.codcurso in
                    (select cc.codcurso from rhcandidatocurso cc
                        where cc.codemp=:icodemp and cc.codfilial=:scodfilial
                            and cc.codcand=:icodcand )
        ) as cursos,
        coalesce(
            (select rv.stvagacand from rhvagacandidato rv
                where rv.codemp=:icodemp and rv.codfilial=:scodfilial and rv.codcand=:icodcand
                    and rv.codemp=vg.codemp and rv.codfilial=vg.codfilial and rv.codvaga=vg.codvaga
            ),'DI'
        )

        from rhvaga vg, rhempregador empr, rhfuncao fu
            where
            empr.codemp=vg.codempem and empr.codfilial=vg.codfilialem and empr.codempr=vg.codempr
            and fu.codemp=vg.codempfc and fu.codfilial=vg.codfilialfc and fu.codfunc=vg.codfunc
            
    into :codvaga, :nomeempr, :codfunc, :descfunc, :faixasalini, :faixasalfim, :stvaga,
         :qualificacoes, :restricoes, :cursos, :stvagacand
    do
    begin
        suspend;
    end
end ^

ALTER PROCEDURE SGAGENTEISP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
CTIPOAGE CHAR(5),
CDESCAGE CHAR(50))
RETURNS (CODAGE INTEGER)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

begin
  /* Procedure para inserir agente */
  SELECT MAX(CODAGE) FROM SGAGENTE
     WHERE CODEMP=:ICODEMP AND CODFILIAL=:SCODFILIAL AND
       TIPOAGE=:CTIPOAGE INTO :CODAGE;
  if (CODAGE IS NULL) then
     CODAGE = 1;
  else
     CODAGE = CODAGE+1;
  INSERT INTO SGAGENTE (CODEMP, CODFILIAL, TIPOAGE, CODAGE, DESCAGE)
     VALUES (:ICODEMP, :SCODFILIAL, :CTIPOAGE, :CODAGE, :CDESCAGE);
  suspend;
end ^

ALTER PROCEDURE SGAGENTEUIDSP (CIUD CHAR(1),
ICODEMP INTEGER,
CTIPOAGE CHAR(5),
ICODAGE INTEGER,
CDESCAGE CHAR(50))
RETURNS (CODEMP INTEGER,
CODFILIAL SMALLINT,
TIPOAGE CHAR(5),
CODAGE INTEGER)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

begin
  /* Procedure para inserir, atualizar e deletar AGENTES */
  CODEMP = ICODEMP;
  TIPOAGE = CTIPOAGE;
  SELECT ICODFILIAL FROM SGRETFILIAL(:CODEMP, 'SGAGENTE') INTO :CODFILIAL;
  if (CIUD='I') then
     SELECT CODAGE FROM SGAGENTEISP(:CODEMP, :CODFILIAL, :TIPOAGE, :CDESCAGE)
        INTO :CODAGE;
  else if (CIUD='U') then
     SELECT CODAGE FROM SGAGENTEUSP(:CODEMP, :CODFILIAL, :TIPOAGE, :ICODAGE, :CDESCAGE)
        INTO :CODAGE;
  else if (CIUD='D') then
  begin
     DELETE FROM SGAGENTE WHERE CODEMP=:CODEMP AND CODFILIAL=:CODFILIAL AND
        TIPOAGE=:TIPOAGE AND CODAGE=:ICODAGE;
     CODAGE=:ICODAGE;
  end
  suspend;
end ^

ALTER PROCEDURE SGAGENTEUSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
CTIPOAGE CHAR(5),
ICODAGE INTEGER,
CDESCAGE CHAR(50))
RETURNS (CODAGE INTEGER)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

DECLARE VARIABLE CDESCAGEOLD CHAR(50);
begin
  /* Procedure para atualizar AGENTE*/
  CODAGE = ICODAGE;
  SELECT DESCAGE FROM SGAGENTE WHERE CODEMP=:ICODEMP AND CODFILIAL=:SCODFILIAL
     AND TIPOAGE=:CTIPOAGE AND CODAGE=:ICODAGE INTO :CDESCAGEOLD;
  IF ( (CDESCAGEOLD IS NOT NULL ) AND (CDESCAGEOLD!=CDESCAGE) ) THEN
     UPDATE SGAGENTE SET DESCAGE=:CDESCAGE WHERE
        CODEMP=:ICODEMP AND CODFILIAL=:SCODFILIAL
           AND TIPOAGE=:CTIPOAGE AND CODAGE=:ICODAGE;
  suspend;
end ^

ALTER PROCEDURE SGATUALIZABDSP (ICODEMP INTEGER)
AS 
DECLARE VARIABLE ICODEMPTMP INTEGER;
begin
  if (ICODEMP IS NULL) then
     ICODEMP = 99;
  /*CTEMP = printLog('Entrou no atualizabdsp '||cast(ICODEMP AS CHAR(10)));*/

  EXECUTE PROCEDURE SGDADOSINISP(:ICODEMP);
  EXECUTE PROCEDURE SGGRANTUSERSP ;
  FOR SELECT CODEMP FROM SGEMPRESA INTO :ICODEMPTMP DO
  BEGIN
     EXECUTE PROCEDURE SGOBJETOINSTBSP(:ICODEMPTMP);
     EXECUTE PROCEDURE SGGRANTADMSP(:ICODEMPTMP);
  END
  suspend;
end ^

ALTER PROCEDURE SGCALCVENCSP (CODEMP INTEGER,
DTBASE DATE,
DTVENC DATE,
REGRVCTO CHAR(1),
RVSAB CHAR(1),
RVDOM CHAR(1),
RVFER CHAR(1),
RVDIA CHAR(1),
DIAVCTO SMALLINT,
DIASVCTO SMALLINT)
RETURNS (DTVENCRET DATE)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

declare variable maxloop smallint;
declare variable curloop smallint;
declare variable dttemp date;
declare variable valorinc smallint;
declare variable codfilial smallint;
declare variable curloop02 smallint;
begin
  DTVENCRET = DTVENC;

  -- Busca o codigo da filial que ser utilizado em duas regras
  if ( (REGRVCTO<>'N') and (RVFER = 'S') ) then
  begin
     SELECT ICODFILIAL FROM SGRETFILIAL(:CODEMP,'SGFERIADO') INTO :CODFILIAL;
  end

  -- Logica pra dia fixo
  if ( RVDIA = 'F' ) then
  begin
     MAXLOOP = 2;
     CURLOOP = 1;
     while ( CURLOOP<MAXLOOP ) do
     begin
        DTTEMP = DTVENCRET + ( 1 - EXTRACT(DAY FROM DTVENCRET) );
        DTTEMP = DTTEMP + DIAVCTO - 1;
        -- Objetivo do loop  voltar quando o dia fixo for no final do ms.
        while ( ( ( extract( month from DTVENCRET ) ) < ( extract( month from DTTEMP ) ) ) or
                ( ( extract( year from DTVENCRET ) ) < ( extract( year from DTTEMP ) ) ) ) do
        begin
           DTTEMP = DTTEMP - 1;
        end
        DTVENCRET = DTTEMP;
        if ( DTVENCRET<DTBASE ) then
        begin
           DTVENCRET = addmonth(DTVENCRET,1);
        end
        else
        begin
           break;
        end
        CURLOOP = CURLOOP + 1;
     end
  end
  -- Logica para ajustar dias uteis
  else if ( RVDIA = 'U' ) then
  begin
     while ( ( extract(month from DTVENCRET)<=extract(month from DTBASE) ) and
             ( extract(year from DTVENCRET)<=extract(year from DTBASE ) ) and
             ( DIASVCTO>0 ) ) do
     begin
        DTVENCRET = addmonth(DTVENCRET,1);
     end
     DTTEMP = DTVENCRET + ( 1 - EXTRACT(DAY FROM DTVENCRET) );
     DTVENCRET = DTTEMP;
     if (DIAVCTO<28) then -- Se for menor que dia 28 calcula o dia til
     begin                -- Caso contrrio vai ser o ltimo dia til.
        CURLOOP02 = 1;
        while (CURLOOP02<12) do
        begin
           CURLOOP = 1;
           MAXLOOP = DIAVCTO;
           while ( CURLOOP < MAXLOOP )  do
           begin
              DTTEMP = null;
              if (RVFER='S') then
              begin
                 SELECT DATAFER FROM SGFERIADO F
                   WHERE F.CODEMP=:CODEMP AND F.CODFILIAL=:CODFILIAL AND
                     F.DATAFER=:DTVENCRET AND F.BANCFER='S'
                       INTO :DTTEMP;
              end
              if ( ( (extract( weekday from DTVENCRET )=0) and (RVDOM='S')  ) or
                   ( (extract( weekday from DTVENCRET )=6) and (RVSAB='S')  ) or
                   ( (RVFER='S') and (DTVENCRET=DTTEMP) ) ) then
              begin
                 DTVENCRET = DTVENCRET + 1;
              end
              else
              begin

                 DTVENCRET = DTVENCRET + 1;
                 CURLOOP = CURLOOP + 1;
              end
           end
           if (DTVENCRET<=DTBASE) then
           begin
              DTTEMP = DTVENCRET + ( 1 - EXTRACT(DAY FROM DTVENCRET) );
              DTVENCRET = DTTEMP;
              while ( ( extract(month from DTVENCRET)<=extract(month from DTBASE) ) and
                  ( extract(year from DTVENCRET)<=extract(year from DTBASE ) ) ) do
              begin
                 DTVENCRET = addmonth(DTVENCRET,1);
              end
           end
           else
           begin
              break;
           end
           CURLOOP02 = CURLOOP02 + 1;
        end
     end
     else
     begin
        DTTEMP = addmonth(DTVENCRET,1);
        DTVENCRET = DTTEMP - 1;
     end
  end

--  if (extract(month from dtvencret)=8) then
--  begin
--     exception fnreceberex02 'VENCIMENTO: '||CAST(dtvencret AS CHAR(10))||'REGRAVCTO = ' || REGRVCTO || 'REGRA DIA '|| RVDIA;

--  end


  -- Logica para ajustar finais de semana e feriados
  if ( (REGRVCTO<>'N') ) then
  begin
     MAXLOOP = 30;
     CURLOOP = 1;
     if ( REGRVCTO='A' ) then
     begin
        VALORINC = -1;
     end
     else
     begin
        VALORINC = 1;
     end
     while (CURLOOP<MAXLOOP) do
     begin
        if ( ( (extract( weekday from dtvencret )=0) and (RVDOM='S')  ) or
             ( (extract( weekday from dtvencret )=6) and (RVSAB='S')  ) ) then
        begin
           DTVENCRET = DTVENCRET + VALORINC;
        end
        else if (RVFER='S') then
        begin
           DTTEMP = NULL;
           SELECT DATAFER FROM SGFERIADO F
             WHERE F.CODEMP=:CODEMP AND F.CODFILIAL=:CODFILIAL AND
               F.DATAFER=:DTVENCRET AND F.BANCFER='S'
                 INTO :DTTEMP;
           if ( (DTTEMP IS NOT NULL) AND (DTTEMP=DTVENCRET) ) then
           begin
             DTVENCRET = DTVENCRET + VALORINC;
           end
           else
           begin
             break;
           end
        end
        else
        begin
           break;
        end
        CURLOOP = CURLOOP + 1;
     end
  end
  suspend;
end ^

ALTER PROCEDURE SGDADOSINISP (ICODEMP INTEGER)
AS 

declare variable crole_name char(31);
declare variable inumemp integer;
declare variable cidgrpusu char(8);
declare variable cidusu char(8);
declare variable csql varchar(256);
begin
  /*CTEMP = printLog('Entrou em dados ini '||cast(ICODEMP AS CHAR(10)));*/
  SELECT CODEMP FROM SGEMPRESA WHERE CODEMP=:ICODEMP INTO :INUMEMP;
  IF (INUMEMP IS NULL) THEN
  BEGIN
   /* CTEMP = printLog('Empresa  nulo '||cast(ICODEMP AS CHAR(10))); */
     INSERT INTO SGEMPRESA (CODEMP,RAZEMP)
        VALUES (:ICODEMP,'EMPRESA '||CAST(:ICODEMP AS CHAR(10) ));
     INSERT INTO SGFILIAL (CODEMP, CODFILIAL, RAZFILIAL,
        NOMEFILIAL,MZFILIAL)
       VALUES (:ICODEMP,1,'EMPRESA'||CAST(:ICODEMP AS CHAR(10) )||' - MATRIZ',
        'EMPRESA'||CAST(:ICODEMP AS CHAR(10) )||' - MATRIZ' ,'S');
    /*CTEMP = printLog('Inseriu empresa e filial '||cast(ICODEMP AS CHAR(10)));*/
  END
  SELECT RDB$ROLE_NAME FROM RDB$ROLES
     WHERE RDB$ROLE_NAME='ADM'
       INTO :CROLE_NAME;
  IF (CROLE_NAME IS NULL) THEN
  BEGIN
     CSQL = 'CREATE ROLE ADM';
     EXECUTE STATEMENT CSQL;
  END
  /* CTEMP = printLog('cadastrou roles'); */
  FOR SELECT CODEMP FROM SGEMPRESA WHERE CODEMP=:ICODEMP INTO :INUMEMP DO
  BEGIN
  /* CTEMP = printLog('LOOP DE EMPRESA PARA CADASTRAR GRUPO'||CAST(INUMEMP AS CHAR(10)));*/

     SELECT IDGRPUSU FROM SGGRPUSU
       WHERE CODEMP=:INUMEMP AND IDGRPUSU='ADM'
         INTO :CIDGRPUSU;
     IF (CIDGRPUSU IS NULL) THEN
        INSERT INTO SGGRPUSU ( CODEMP, CODFILIAL, IDGRPUSU, NOMEGRPUSU)
          VALUES ( :INUMEMP, 1, 'ADM', 'ADMINISTRADOR' );
     SELECT IDUSU FROM SGUSUARIO
       WHERE CODEMP=:INUMEMP AND IDUSU='sysdba' AND CODFILIAL=1
         INTO :CIDUSU;
     IF (CIDUSU IS NULL) THEN
        INSERT INTO SGUSUARIO (CODEMP, CODFILIAL, IDUSU, NOMEUSU, IDGRPUSU)
          VALUES (:INUMEMP, 1, 'sysdba', 'ADMINISTRADOR DBA', 'ADM');
  /* CTEMP = printLog('CADASTROU USUARIOS');*/

  END

  suspend;
end ^

ALTER PROCEDURE SGDEBUGSP (ROTINA VARCHAR(60),
TEXTO VARCHAR(1000))
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

begin
  /* Procedure Text */
  INSERT INTO SGDEBUG (ROTINA, TEXTO)
     VALUES (:ROTINA, :TEXTO);
  suspend;
end ^

ALTER PROCEDURE SGESTACAOIMPSP01 (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODEST INTEGER,
SNROIMP SMALLINT,
CPADIMP CHAR(1))
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

begin
  /* Procedure que ajusta impressora padro */
  IF ( (CPADIMP IS NOT NULL) AND (CPADIMP='S') ) THEN
     UPDATE SGESTACAOIMP SET IMPPAD='N' WHERE CODEMP=:ICODEMP AND
        CODFILIAL=:SCODFILIAL AND CODEST=:ICODEST AND NROIMP!=:SNROIMP;
  suspend;
end ^

ALTER PROCEDURE SGFIMCONSP AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

DECLARE VARIABLE ICONECTADO INTEGER;
begin
  /* Procedure Text */
  SELECT CONECTADO FROM SGCONEXAO WHERE NRCONEXAO=CURRENT_CONNECTION INTO iConectado;
  if (iConectado is not null) then
     UPDATE SGCONEXAO SET CONECTADO=0
        WHERE NRCONEXAO=CURRENT_CONNECTION;
  suspend;
end ^

ALTER PROCEDURE SGGERACNFSP (TIPO VARCHAR(2),
CODEMP INTEGER,
CODFILIAL SMALLINT,
TIPOVENDA VARCHAR(2),
CODVENDA INTEGER,
CODEMPCP INTEGER,
CODFILIALCP SMALLINT,
CODCOMPRA INTEGER)
AS 

declare variable icnf bigint;
begin
   --execute procedure sgdebugsp 'sggeracnfsp', 'Entrou na procedure geracnf';
   SELECT BISEQ FROM SGSEQUENCE_IDSP('NCF') INTO :ICNF;
    
   if(TIPO='CP') THEN
   BEGIN
      --execute procedure sgdebugsp 'sggeracnfsp', 'PEGOU tipo CP e O ICNF: '||:ICNF;
      UPDATE CPCOMPRA set CNF=:ICNF WHERE CODEMP=:codempcp AND CODFILIAL=:codfilialcp AND CODCOMPRA=:CODCOMPRA;
   END
   ELSE IF(TIPO='VD') THEN
   BEGIN
      UPDATE VDVENDA set CNF=:ICNF WHERE CODEMP=:CODEMP AND CODFILIAL=:CODFILIAL AND
                        CODVENDA=:CODVENDA AND TIPOVENDA=:TIPOVENDA;
   END
   suspend;
end ^

ALTER PROCEDURE SGGRANTADMSP (ICODEMP INTEGER)
AS 

declare variable csql varchar(200);
declare variable cidobj char(30);
begin
  /* Procedure que d grant para o grupo ADM */

  FOR SELECT DISTINCT O.IDOBJ
  FROM SGOBJETO O, RDB$RELATION_CONSTRAINTS RC, RDB$RELATIONS R
    WHERE O.CODEMP=:ICODEMP AND O.TIPOOBJ='TB'
    AND R.RDB$RELATION_NAME = RC.RDB$RELATION_NAME
    AND RC.RDB$RELATION_NAME=O.IDOBJ
    INTO :CIDOBJ DO
  BEGIN
      CSQL = 'GRANT DELETE, INSERT, SELECT, UPDATE ON TABLE '||CIDOBJ||
        ' TO ROLE ADM';
      EXECUTE STATEMENT CSQL;
  END
  suspend;
end ^

ALTER PROCEDURE SGGRANTUSERSP AS 
 
DECLARE VARIABLE CIDGRPUSU CHAR(8);
DECLARE VARIABLE CIDUSU CHAR(8);
DECLARE VARIABLE CSQL VARCHAR(200);
begin
  FOR SELECT DISTINCT IDGRPUSU, IDUSU FROM SGUSUARIO
     INTO :CIDGRPUSU, :CIDUSU DO
  BEGIN
      CSQL = 'GRANT '||RTRIM(CIDGRPUSU)||' TO USER '||RTRIM(CIDUSU);
      EXECUTE STATEMENT CSQL;
  END
  suspend;
end ^

ALTER PROCEDURE SGINICONSP (ICODEMP INTEGER,
CIDUSU CHAR(8),
ICODFILIALSEL SMALLINT,
ICODTERM SMALLINT)
RETURNS (SRET SMALLINT)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

DECLARE VARIABLE ICONECTADO INTEGER;
DECLARE VARIABLE ICODFILIALSELCX SMALLINT;
DECLARE VARIABLE ICODEMPTMP INTEGER;
DECLARE VARIABLE ICODFILIAL SMALLINT;
begin
  /* Procedure para inicializao da conexo com o banco de dados */
  SRET = 0;
  if (ICODEMP IS NULL) then
     ICODEMP = 99;
  /*CTEMP = printLog('Vai verificar o usurio');*/
  CIDUSU = lower(CIDUSU);
  IF ( CIDUSU='sysdba' ) THEN
  BEGIN
/*     CTEMP = printLog('Usurio sysdba');*/

     SELECT CODEMP FROM SGEMPRESA WHERE CODEMP=:ICODEMP INTO :ICODEMPTMP;
     IF (ICODEMPTMP IS NULL) THEN
        EXECUTE PROCEDURE SGATUALIZABDSP(:ICODEMP);
  END
  SELECT CODFILIAL FROM SGUSUARIO WHERE IDUSU=:cIdUsu AND
      CODEMP=:ICODEMP  INTO :iCodFilial;
/*  CTEMP = printLog('O usurio  = '||cIdUsu); */

/*  CTEMP = printLog('Contador de usurios '||cIdUsu); */

  if (iCodFilial is null) then
    EXCEPTION SGCONEXAOEX02;

  if (iCodFilialSel is not null) then
  begin
      SRET = 1;
      SELECT CONECTADO, CODFILIALSEL FROM SGCONEXAO
        WHERE NRCONEXAO=CURRENT_CONNECTION INTO :iConectado, iCodFilialSelCX;
      if (iConectado is null) then
          INSERT INTO SGCONEXAO (NRCONEXAO, CODEMP,CODFILIAL,IDUSU,CODFILIALSEL,CONECTADO,CODTERM)
            VALUES (CURRENT_CONNECTION, :iCodemp, :iCodfilial, :cIdusu, :iCodfilialSel, 1, :iCodTerm);
      else
      begin
          if (iConectado<=0) then
             UPDATE SGCONEXAO SET CONECTADO=1, CODFILIALSEL=:iCodfilialSel, CODTERM = :iCodTerm,
               CODEMP=:iCodemp, CODFILIAL=:iCodfilial , IDUSU=:cIdUsu
               WHERE NRCONEXAO=CURRENT_CONNECTION;
          else
          begin
             if (not (iCodfilialSelCX=iCodfilialSel) ) then
                EXCEPTION SGCONEXAOEX01;
             else
                UPDATE SGCONEXAO SET CONECTADO=CONECTADO+1, CODTERM = :iCodTerm,
                   CODEMP=:iCodemp, CODFILIAL=:iCodfilial, IDUSU=:cIdUsu
                WHERE NRCONEXAO=CURRENT_CONNECTION;
          end
      end 
  end
  suspend;
end ^

ALTER PROCEDURE SGLOGSP01 (CLASLOG CHAR(2),
TIPOLOG CHAR(3),
DESCLOG CHAR(60),
OBSLOG VARCHAR(1000))
RETURNS (CODFILIAL SMALLINT,
CODLOG INTEGER)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

DECLARE VARIABLE IDUSU CHAR(8);
DECLARE VARIABLE CODEMP INTEGER;
DECLARE VARIABLE CODCAIXA INTEGER;
BEGIN
  SELECT CODEMP,CODFILIALSEL,CODTERM, IDUSU FROM SGCONEXAO WHERE NRCONEXAO=CURRENT_CONNECTION AND
    CONECTADO > 0 INTO CODEMP, CODFILIAL, CODCAIXA, IDUSU;
  SELECT ISEQ FROM SPGERANUM(:CODEMP,:CODFILIAL,'LG') INTO CODLOG;
  INSERT INTO SGLOG(CODEMP,CODFILIAL,CODLOG,CODEMPUS,CODFILIALUS,IDUSU,
               CLASLOG,TIPOLOG,CODEMPCX,CODFILIALCX,CODCAIXA,
        DESCLOG,OBSLOG) VALUES
              (:CODEMP,:CODFILIAL,:CODLOG,:CODEMP,:CODFILIAL,:IDUSU,
               :CLASLOG,:TIPOLOG,:CODEMP,:CODFILIAL,:CODCAIXA,
               :DESCLOG,:OBSLOG);
  SUSPEND;
END ^

ALTER PROCEDURE SGOBJETOATUALIZANIVELSP (CODEMP INTEGER)
RETURNS (IDOBJ VARCHAR(30),
NIVELOBJ SMALLINT)
AS 

declare variable sqltexto varchar(200);
declare variable contador smallint;
declare variable numregobj integer;
begin
  /* Nivel 0 */

   nivelobj = -1;
   update sgobjeto o set o.nivelobj=:nivelobj where codemp=:codemp;

   nivelobj = 0;

   while (:nivelobj<=100) do
   begin
       for select obj.idobj
           from sgobjeto obj
           where obj.codemp=:codemp and obj.nivelobj=-1
           into :idobj do
       begin
           contador = 0;
           select  count(*)
           from rdb$relation_constraints rc
              , rdb$relation_constraints rcpk
              , rdb$ref_constraints rf
           where
               rc.rdb$relation_name=:idobj
              and rc.rdb$constraint_type='FOREIGN KEY'
              and rc.rdb$constraint_name=rf.rdb$constraint_name
              and rcpk.rdb$constraint_name=rf.rdb$const_name_uq
              and not exists( select * from sgobjeto obj1
                where obj1.codemp=:codemp and obj1.idobj=rcpk.rdb$relation_name
                and rcpk.rdb$relation_name<>:idobj
                and rcpk.rdb$relation_name<>'SGFILIAL'
                and obj1.nivelobj>-1 and obj1.nivelobj<:nivelobj
              )
          -- group by 1
           into :contador;
           if (:contador is null or contador=0) then
           begin
              sqltexto = 'select count(*) from '||idobj;
              execute statement sqltexto into :numregobj;
              update sgobjeto
                 set nivelobj=:nivelobj
                 , numregobj=:numregobj
                 where codemp=:codemp and idobj=:idobj;

           end
       end
       nivelobj=nivelobj+1;
   end
   suspend;
   --INSERT INTO SGOBJETO (CODEMP,IDOBJ,DESCOBJ,TIPOOBJ,COMENTOBJ,USOMEOBJ,SIGLAOBJ)
     --  SELECT DISTINCT :ICODEMP, RC.RDB$RELATION_NAME, RC.RDB$RELATION_NAME,  'TB', RC.RDB$RELATION_NAME /*CAST(R.RDB$DESCRIPTION AS VARCHAR(10000)),
       --'S', SUBSTRING(RC.RDB$RELATION_NAME FROM 1 FOR 8)
--       FROM RDB$RELATION_CONSTRAINTS RC, RDB$RELATIONS R
  --     WHERE R.RDB$RELATION_NAME = RC.RDB$RELATION_NAME AND
    --   RC.RDB$RELATION_NAME NOT IN (SELECT IDOBJ FROM SGOBJETO O
--       WHERE O.TIPOOBJ='TB' AND O.IDOBJ=RC.RDB$RELATION_NAME);*/

end ^

ALTER PROCEDURE SGOBJETOINSTBSP (ICODEMP INTEGER)
AS 
begin

   INSERT INTO SGOBJETO (CODEMP,IDOBJ,DESCOBJ,TIPOOBJ,COMENTOBJ,USOMEOBJ,SIGLAOBJ)
       SELECT DISTINCT :ICODEMP, RC.RDB$RELATION_NAME, RC.RDB$RELATION_NAME,
        'TB', RC.RDB$RELATION_NAME /*CAST(R.RDB$DESCRIPTION AS VARCHAR(10000))*/, 'N', SUBSTRING(RC.RDB$RELATION_NAME FROM 1 FOR 8)
       FROM RDB$RELATION_CONSTRAINTS RC, RDB$RELATIONS R
       WHERE R.RDB$RELATION_NAME = RC.RDB$RELATION_NAME AND
       RC.RDB$RELATION_NAME NOT IN (SELECT IDOBJ FROM SGOBJETO O
       WHERE O.TIPOOBJ='TB' AND O.IDOBJ=RC.RDB$RELATION_NAME);

    suspend;
end ^

ALTER PROCEDURE SGRETCAIXA RETURNS (CODEMP INTEGER,
CODFILIAL SMALLINT,
CODTERM INTEGER)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

begin
  SELECT CODEMP, CODFILIALSEL, CODTERM FROM SGCONEXAO WHERE
    NRCONEXAO=CURRENT_CONNECTION AND CONECTADO > 0 INTO CODEMP, CODFILIAL,CODTERM;
  SUSPEND;
end ^

ALTER PROCEDURE SGRETFILIAL (ICODEMP INTEGER,
SNOMETAB CHAR(30))
RETURNS (ICODFILIAL SMALLINT)
AS 
 

DECLARE VARIABLE SEHME CHAR(1);
begin
  SELECT USOMEOBJ FROM SGOBJETO WHERE TIPOOBJ='TB' AND IDOBJ=:SNOMETAB AND CODEMP=:ICODEMP
    INTO sEhME;
  IF (sEhME = 'N') THEN
  BEGIN
    SELECT CODFILIALSEL FROM SGCONEXAO WHERE CODEMP=:ICODEMP AND
      NRCONEXAO=CURRENT_CONNECTION AND CONECTADO > 0 INTO ICODFILIAL;
  END
  ELSE
  BEGIN
    SELECT FL.CODFILIAL FROM SGFILIAL FL WHERE
      FL.CODEMP = :ICODEMP AND FL.MZFILIAL='S'
      INTO ICODFILIAL;
    IF (ICODFILIAL IS NULL) THEN
      EXCEPTION SGFILIALEX01;
  END
  IF (ICODFILIAL IS NULL) THEN
  BEGIN
    EXCEPTION SGFILIALEX02;
  END
  SUSPEND;
end ^

ALTER PROCEDURE SGRETINFOUSU (CODEMP INTEGER,
IDUSU VARCHAR(128))
RETURNS (ANOCCUSU SMALLINT,
CODEMPCCUSU INTEGER,
CODFILIALCCUSU SMALLINT,
CODEMPUSU INTEGER,
CODFILIALUSU SMALLINT,
CODCCUSU CHAR(19),
IDUSUS CHAR(8),
ALMOXARIFE CHAR(1),
APROVARMA CHAR(2))
AS 

begin
    select icodfilial from sgretfilial(:codemp, 'SGUSUARIO') into :codfilialusu;
    codempusu=:codemp;
    select first 1 u.codempcc, u.codfilialcc, u.anocc, u.codcc,
       u.idusu, u.almoxarifeusu, u.aprovrmausu
    from sgusuario u where lower(u.idusu)=lower(:idusu) and u.codemp=:codemp and u.codfilial=:codfilialusu
    into :codempccusu, :codfilialccusu, :anoccusu, :codccusu,
    :idusus, :almoxarife, :aprovarma;

    suspend;
end ^

ALTER PROCEDURE SGRETMULTIALMOXSP (ICODEMP INTEGER)
RETURNS (CMULTIALMOX CHAR(1))
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

DECLARE VARIABLE SCODFILIALPF SMALLINT;
begin
  /* Procedure Text */
  SELECT RF.ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'SGPREFERE1') RF
     INTO :SCODFILIALPF;
  SELECT MULTIALMOX FROM SGPREFERE1 WHERE CODEMP=:ICODEMP AND
     CODFILIAL=:SCODFILIALPF
     INTO :CMULTIALMOX;

/* Condio que evita null no valor do flag */
  CMULTIALMOX = coalesce(CMULTIALMOX,'N');

  suspend;
end ^

ALTER PROCEDURE SGRETMULTICOMISSP (ICODEMP INTEGER,
CODEMPTM INTEGER,
CODFILIALTM SMALLINT,
CODTIPOMOV INTEGER)
RETURNS (CMULTICOMIS CHAR(1))
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

declare variable scodfilialpf smallint;
declare variable cmulticomistm char(1);
begin
    select rf.icodfilial from sgretfilial(:icodemp, 'SGPREFERE1') rf
        into :scodfilialpf;

    /* Verifica se o mecanismo de multiplos comissionados est habilitado nas preferncias gerais */

    select pf.multicomis from sgprefere1 pf
        where pf.codemp=:icodemp and pf.codfilial=:scodfilialpf
    into :cmulticomis;

    /* Caso esteja habilitado nas preferncias, verifica se o tipo de movimento suporta multiplos comissionados */
    if(:cmulticomis = 'S') then
    begin

        select tm.mcomistipomov from eqtipomov tm
            where tm.codemp=:codemptm and tm.codfilial=:codfilialtm and tm.codtipomov=:codtipomov
        into :cmulticomistm;

        if(:cmulticomis is null or :cmulticomistm='N') then
        begin
            cmulticomis = 'N';
        end

    end

  cmulticomis = coalesce(cmulticomis,'N');

  suspend;
end ^

ALTER PROCEDURE SGRETVERSAO RETURNS (VERSAO VARCHAR(30))
AS 
begin
    versao = '1.2.6.7 (15/04/2014)';
    suspend;
end ^

ALTER PROCEDURE SGSEQUENCE_IDSP (STABLE_NAME VARCHAR(128))
RETURNS (BISEQ BIGINT)
AS 

begin
  --execute procedure sgdebugsp 'sggeracnfsp', 'Entrou na procedure SGSEQUENCE';
  BISEQ = NULL;
  SELECT SEQ_ID FROM SGSEQUENCE_ID
    WHERE TABLE_NAME=:sTABLE_NAME
    INTO :BISEQ;
   IF (BISEQ IS NULL) THEN
   BEGIN
     BISEQ = 1;
     INSERT INTO SGSEQUENCE_ID (TABLE_NAME,SEQ_ID)
            VALUES (:sTABLE_NAME, :BISEQ+1);
   END
   ELSE
   BEGIN
      UPDATE SGSEQUENCE_ID SET SEQ_ID=:BISEQ+1 WHERE
          TABLE_NAME=:sTABLE_NAME;
   END
   suspend;
end ^

ALTER PROCEDURE SGSETAGENDASP (CODAGD INTEGER,
CODEMP INTEGER,
DTAINIAGD DATE,
HRINIAGD TIME,
DTAFIMAGD DATE,
HRFIMAGD TIME,
ASSUNTOAGD CHAR(50),
DESCAGD VARCHAR(10000),
CODFILIALTA SMALLINT,
CODTIPOAGD INTEGER,
PRIORAGD SMALLINT,
CODAGE INTEGER,
TIPOAGE CHAR(5),
CODFILIALAE SMALLINT,
CODAGEEMIT INTEGER,
TIPOAGEEMIT CHAR(5),
CAAGD CHAR(2),
SITAGD CHAR(2),
RESOLUCAOMOTIVO VARCHAR(10000),
CODAGDAR INTEGER,
DIATODO CHAR(1))
RETURNS (IRET INTEGER)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

DECLARE VARIABLE IFILIALAGD INTEGER;
begin
  select ICODFILIAL from SGRETFILIAL(:CODEMP,'SGAGENDA') INTO IFILIALAGD;
  IF (CODAGD = 0) THEN
  BEGIN

    SELECT ISEQ FROM SPGERANUM(:CODEMP,:IFILIALAGD,'AG') INTO CODAGD;

    if(codagdar is not null ) then  -- Agendamento vinculado (repetio)
    begin
        insert into sgagenda (
            codemp, codfilial, codage, tipoage, codagd,
            dataagd, dtainiagd, hriniagd, dtafimagd, hrfimagd,
            assuntoagd, descagd, codempta, codfilialta, codtipoagd, prioragd, sitagd,
            codempae, codfilialae, codageemit, tipoageemit, caagd, resolucaomotivo,
            codempar,codfilialar,codagear,tipoagear,codagdar,diatodo)
        values (
            :codemp, :ifilialagd, :codage, :tipoage, :codagd,
            cast('today' as date), :dtainiagd, :hriniagd, :dtafimagd, :hrfimagd,
            :assuntoagd, :descagd, :codemp, :codfilialta, :codtipoagd, :prioragd, :sitagd,
            :codemp, :codfilialae, :codageemit, :tipoageemit, :caagd, :resolucaomotivo,
            :codemp,:ifilialagd,:codage,:tipoage,:codagdar,:diatodo
        );
    end
    else -- Agendamento simples, sem vnvulo (repetio)
    begin
        insert into sgagenda (
            CODEMP,CODFILIAL,CODAGE,TIPOAGE,CODAGD,
            DATAAGD,DTAINIAGD,HRINIAGD,DTAFIMAGD,HRFIMAGD,
            ASSUNTOAGD,DESCAGD,CODEMPTA,CODFILIALTA,CODTIPOAGD,PRIORAGD,SITAGD,
            CODEMPAE,CODFILIALAE,CODAGEEMIT,TIPOAGEEMIT,CAAGD, RESOLUCAOMOTIVO, DIATODO)
        values (
            :CODEMP,:IFILIALAGD,:CODAGE,:TIPOAGE,:CODAGD,
            CAST('today' AS DATE),:DTAINIAGD,:HRINIAGD,:DTAFIMAGD,:HRFIMAGD,
            :ASSUNTOAGD,:DESCAGD,:CODEMP,:CODFILIALTA,:CODTIPOAGD,:PRIORAGD,:SITAGD,
            :CODEMP,:CODFILIALAE,:CODAGEEMIT,:TIPOAGEEMIT,:CAAGD, :RESOLUCAOMOTIVO,:DIATODO

        );
    end
  end
  else
    update sgagenda set
      DTAINIAGD=:DTAINIAGD,HRINIAGD=:HRINIAGD,
      DTAFIMAGD=:DTAFIMAGD,HRFIMAGD=:HRFIMAGD,
      ASSUNTOAGD=:ASSUNTOAGD,DESCAGD=:DESCAGD,
      CODEMPTA=:CODEMP,CODFILIALTA=:CODFILIALTA,CODTIPOAGD=:CODTIPOAGD,
      PRIORAGD=:PRIORAGD,CAAGD=:CAAGD,
      SITAGD=:SITAGD,
      RESOLUCAOMOTIVO=:RESOLUCAOMOTIVO,
      codage=:codage, diatodo=:diatodo
      WHERE CODEMP=:CODEMP AND CODFILIAL=:IFILIALAGD
      AND CODAGD=:CODAGD AND TIPOAGE=:TIPOAGE;
  IRET = CODAGD;
  SUSPEND;
END ^

ALTER PROCEDURE SGULTIMODIAMESSP (DTCALC DATE)
RETURNS (DTRET DATE)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

begin
  DTRET = DTCALC + ( 1 - EXTRACT(DAY FROM DTCALC) );
  DTRET = addmonth( DTRET, 1);
  DTRET = DTRET - 1;
  suspend;
end ^

ALTER PROCEDURE SGUPACESSOMUSP (ICODEMP INTEGER,
ICODFILIAL INTEGER,
SIDUSU CHAR(8),
ICODSIS INTEGER,
ICODMODU INTEGER,
ICODMENU INTEGER,
CTPACESSOMU CHAR(1))
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

BEGIN
  DELETE FROM SGACESSOMU WHERE CODEMP = :ICODEMP
         AND CODFILIAL = :ICODFILIAL
         AND IDUSU = :SIDUSU
         AND CODSIS =:ICODSIS
         AND CODMODU =:ICODMODU
         AND CODMENU =:ICODMENU;
  INSERT INTO SGACESSOMU (CODEMP,CODFILIAL,IDUSU,CODSIS,CODMODU,CODMENU,TPACESSOMU)
         VALUES (
                :ICODEMP,
                :ICODFILIAL,
                :SIDUSU,
                :ICODSIS,
                :ICODMODU,
                :ICODMENU,
                :CTPACESSOMU
         );
  SUSPEND;
END ^

ALTER PROCEDURE SGUPMENUSP01 (ICODSIS INTEGER,
CDESCSIS CHAR(200),
ICODMODU INTEGER,
CDESCMODU CHAR(200),
ICODMENU INTEGER,
CDESCMENU CHAR(200),
CNOMEMENU CHAR(200),
CACAOMENU CHAR(200),
ICODSISPAI INTEGER,
ICODMODUPAI INTEGER,
ICODMENUPAI INTEGER)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

declare variable itmp integer;
begin
    
    -- Verifica se o j existe registro do sistema;
    select count(*) from sgsistema where codsis = :icodsis into :itmp;

    -- Se o sistema no existe deve inseri-lo
    if ( (itmp is null) or (itmp=0) ) then
    begin
        insert into sgsistema(codsis, descsis) values(:icodsis, :cdescsis);
    end
    else
    -- Atualiza descrio caso o sistema j exista
    begin
        update sgsistema si set si.descsis=:cdescsis where si.codsis=:icodsis;
    end

    -- Verifica se j existe registro do mdulo
    select count(*) from sgmodulo where codsis=:icodsis and codmodu = :icodmodu into :itmp;

    -- Se o modulo no existe deve inseri-lo
    if ( (itmp is null) or (itmp=0) ) then
    begin
        insert into sgmodulo(codsis, codmodu, descmodu) values(:icodsis, :icodmodu, :cdescmodu);
    end
    else
    -- Atualiza descrio caso o mdulo j exista
    begin
        update sgmodulo set descmodu=:cdescmodu where codsis=:icodsis and codmodu=:icodmodu;
    end

    -- Verifica se j existe registro do menu
    select count(*) from sgmenu where codsis =:icodsis and codmodu =:icodmodu and codmenu =:icodmenu into :itmp;

    -- Se o menu existir deve atualizar
    if ( (itmp is not null) and (itmp > 0) ) then
    begin
        update sgmenu set descmenu = :cdescmenu, acaomenu = :cacaomenu, codsispai = :icodsispai, codmodupai = :icodmodupai, codmenupai = :icodmenupai
        where codsis = :icodsis and codmodu = :icodmodu and codmenu = :icodmenu;
    end
    else
    -- se menu no existir, deve inseri-lo
    begin
        insert into sgmenu(codsis, codmodu, codmenu, descmenu, nomemenu, acaomenu, codsispai, codmodupai, codmenupai)
        values (:icodsis, :icodmodu, :icodmenu, :cdescmenu, :cnomemenu, :cacaomenu, :icodsispai, :icodmodupai, :icodmenupai );
    end

end ^

ALTER PROCEDURE SGVALUES (TEXTO VARCHAR(100))
RETURNS (RESULT VARCHAR(100))
AS 
 
 
 

begin
  RESULT = TEXTO;
  suspend;
end ^

ALTER PROCEDURE SPGERANUM (ICODEMP INTEGER,
ICODFILIAL INTEGER,
STAB CHAR(2))
RETURNS (ISEQ INTEGER)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

begin
  ISEQ = NULL;
  SELECT NROSEQ FROM SGSEQUENCIA
    WHERE CODEMP=:iCodEmp AND
      CODFILIAL=:iCodFilial AND
      SGTAB=:STAB INTO :ISEQ;
   IF (ISEQ IS NULL) THEN
   BEGIN
     INSERT INTO SGSEQUENCIA (CODEMP,CODFILIAL,SGTAB,NROSEQ)
            VALUES (:ICODEMP,:ICODFILIAL,:STAB,0);
     ISEQ = 1;
   END
   UPDATE SGSEQUENCIA SET NROSEQ=:ISEQ+1 WHERE
          CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL
          AND SGTAB=:STAB;
  SUSPEND;
end ^

ALTER PROCEDURE SPGERANUMPDV (ICODEMP INTEGER,
ICODFILIAL SMALLINT,
ICODCAIXA INTEGER)
RETURNS (ISEQ INTEGER)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

DECLARE VARIABLE ISEQINI INTEGER;
DECLARE VARIABLE ISEQMAX INTEGER;
begin
  /* Procedure Text */
  ISEQ = NULL;               
  SELECT SEQINI, SEQMAX FROM PVCAIXA
     WHERE CODEMP=:ICODEMP AND
        CODFILIAL=:ICODFILIAL AND
        CODCAIXA=:ICODCAIXA
        INTO :ISEQINI, :ISEQMAX;
  SELECT SEQCAIXA FROM PVSEQUENCIA
     WHERE CODEMP=:ICODEMP AND
        CODFILIAL=:ICODFILIAL AND
        CODCAIXA=:ICODCAIXA
        INTO :ISEQ;
  IF (ISEQ IS NULL) THEN
  BEGIN
     IF(ISEQINI IS NOT NULL AND ISEQMAX IS NOT NULL) THEN
     BEGIN
        INSERT INTO PVSEQUENCIA (CODEMP,CODFILIAL,CODCAIXA,SEQCAIXA)
           VALUES (:ICODEMP,:ICODFILIAL,:ICODCAIXA,:ISEQINI);
        ISEQ = :ISEQINI;
     END
     ELSE
        EXCEPTION PVSEQCAIXA01;
  END
  IF (ISEQ >=ISEQINI AND ISEQ < ISEQMAX)  THEN
     UPDATE PVSEQUENCIA SET SEQCAIXA=:ISEQ+1 WHERE
        CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL
        AND CODCAIXA=:ICODCAIXA;
  ELSE
     EXCEPTION PVSEQCAIXA02;
  suspend;
end ^

ALTER PROCEDURE TKCONTCLISP (CODEMP INTEGER,
CODFILIAL INTEGER,
CODCTO INTEGER,
CODFILIALTI INTEGER,
CODTIPOCLI INTEGER,
CODFILIALCC INTEGER,
CODCLASCLI INTEGER,
CODFILIALSR INTEGER,
CODSETOR INTEGER)
RETURNS (IRET INTEGER)
AS 

declare variable icodcli integer;
declare variable codfilialpf integer;
declare variable usuativcli char(1);
declare variable ifilialcli integer;
BEGIN
  SELECT MAX(CODCLI)+1 FROM VDCLIENTE WHERE CODEMP=:CODEMP AND CODFILIAL=:CODFILIAL INTO ICODCLI;
  SELECT ICODFILIAL FROM SGRETFILIAL(:CODEMP, 'VDCLIENTE') INTO IFILIALCLI;
  SELECT ICODFILIAL FROM SGRETFILIAL(:CODEMP, 'SGPREFERE1') INTO :CODFILIALPF;
  SELECT PF.USUATIVCLI FROM SGPREFERE1 PF WHERE CODEMP=:CODEMP AND CODFILIAL=:CODFILIALPF
    INTO :USUATIVCLI;
  
  INSERT INTO VDCLIENTE (CODEMP,CODFILIAL,CODCLI,RAZCLI,CODEMPCC,CODFILIALCC,CODCLASCLI,
  CODEMPVD,CODFILIALVD,CODVEND,CODEMPSR,CODFILIALSR,CODSETOR,NOMECLI,CODEMPTI,CODFILIALTI,
  CODTIPOCLI,DATACLI,PESSOACLI,ATIVOCLI,CNPJCLI,INSCCLI,CPFCLI,RGCLI,ENDCLI,NUMCLI,
  COMPLCLI,BAIRCLI,CIDCLI,UFCLI,CEPCLI,FONECLI,FAXCLI,EMAILCLI,CONTCLI,CTOCLI,
  CODPAIS, SIGLAUF, CODMUNIC, EDIFICIOCLI)
    SELECT :CODEMP,:IFILIALCLI,:ICODCLI,RAZCTO,:CODEMP,:CODFILIALCC,:CODCLASCLI,
    CODEMPVD,CODFILIALVD,CODVEND,:CODEMP,:CODFILIALSR,:CODSETOR,NOMECTO,:CODEMP,:CODFILIALTI,
    :CODTIPOCLI,DATACTO,PESSOACTO,(CASE WHEN COALESCE(:USUATIVCLI,'N')='S' THEN 'N' ELSE 'S' END),
    CNPJCTO,INSCCTO,CPFCTO,RGCTO,ENDCTO,NUMCTO,
    COMPLCTO,BAIRCTO,CIDCTO,UFCTO,CEPCTO,FONECTO,FAXCTO,EMAILCTO,CONTCTO,'O',
    CODPAIS, SIGLAUF, CODMUNIC, EDIFICIOCTO
  FROM TKCONTATO WHERE
    CODEMP=:CODEMP AND CODFILIAL=:CODFILIAL AND CODCTO=:CODCTO;
    
  INSERT INTO TKCONTCLI (CODEMPCTO, CODFILIALCTO, CODCTO, CODEMPCLI, CODFILIALCLI, CODCLI)
    VALUES (:CODEMP, :CODFILIAL, :CODCTO, :CODEMP, :IFILIALCLI, :ICODCLI);
  IRET = ICODCLI;
  
  SUSPEND;
END ^

ALTER PROCEDURE TKGERACAMPANHACTO (TIPOCTO CHAR(1),
CODEMPCA INTEGER,
CODFILIALCA SMALLINT,
CODCAMP CHAR(13),
CODEMPCO INTEGER,
CODFILIALCO SMALLINT,
CODCTO INTEGER,
CODEMPAT INTEGER,
CODFILIALAT SMALLINT,
CODATIV INTEGER,
SITHISTTK CHAR(2),
DESCHISTTK VARCHAR(1000))
AS 

declare variable seqcampcto integer; /* Cdigo do contato pra validao. */
declare variable seqsitcamp integer;
declare variable codfilialhi smallint;
declare variable codhisttk integer;
declare variable codempae integer;
declare variable codfilialae smallint;
declare variable codatend integer; /* Cdigo do atendente. */
declare variable codempus integer;
declare variable codfilialus smallint;
declare variable idusu char(8); /* Id do usurio */
begin

    select icodfilial from sgretfilial(:codempca,'TKHISTORICO') into codfilialhi;
    select iseq from spgeranum(:codempca,:codfilialhi,'HI') into codhisttk;
    select codempusu, codfilialusu, idusus from sgretinfousu(:codempca, user) where codempusu=:codempca into
            :codempus, :codfilialus, :idusu;

    select first 1 codemp, codfilial, codatend from atatendente
            where codempus=:codempus and codfilialus=:codfilialus and idusu=:idusu
    into codempae, codfilialae, codatend;

    if(:codatend is null) then
    begin
        exception TKGERACAMANHACTO01 ' - ID: ' || idusu || ' - User: '|| user ;
    end

    -- Verifica se o contato j foi vinculado  campanha

    if ( tipocto = 'O' ) then
    begin
       select max(seqcampcto) from tkcampanhacto cc
           where cc.codemp=:codempca and cc.codfilial=:codfilialca and cc.codcamp=:codcamp
           and cc.codempco=:codempco and cc.codfilialco=:codfilialco and cc.codcto=:codcto
           into :seqcampcto;
    end
    else
    begin
       select max(seqcampcto) from tkcampanhacto cc
           where cc.codemp=:codempca and cc.codfilial=:codfilialca and cc.codcamp=:codcamp
           and cc.codempcl=:codempco and cc.codfilialcl=:codfilialco and cc.codcli=:codcto
           into :seqcampcto;
    end

    if ( (:seqcampcto is null) or (:seqcampcto=0) ) then
    begin
       select max(coalesce(seqcampcto,0)+1) seqcampcto from tkcampanhacto cc
           where cc.codemp=:codempca and cc.codfilial=:codfilialca and cc.codcamp=:codcamp
           into :seqcampcto;
        if (seqcampcto is null) then
        begin
           seqcampcto = 1;
        end
        if ( tipocto = 'O' ) then
        begin
            insert into tkcampanhacto (codemp, codfilial, codcamp, seqcampcto, codempco, codfilialco, codcto)
                values(:codempca, :codfilialca, :codcamp, :seqcampcto, :codempco, :codfilialco, :codcto);
        end
        else 
        begin
            insert into tkcampanhacto (codemp, codfilial, codcamp, seqcampcto, codempcl, codfilialcl, codcli)
                values(:codempca, :codfilialca, :codcamp, :seqcampcto, :codempco, :codfilialco, :codcto);
               -- exception TKGERACAMANHACTO01 'teste';
        end

    end

    seqsitcamp = 0;
    select max(sc.seqsitcamp) from tksitcamp sc
            where sc.codemp=:codempca and sc.codfilial=:codfilialca and
                sc.codcamp=:codcamp and sc.tipocto=:tipocto
                into :seqsitcamp;

    if(:seqsitcamp is null) then
    begin
        seqsitcamp = 0;
    end

    seqsitcamp = seqsitcamp + 1;

    if ( tipocto = 'O' ) then
    begin
        insert into tksitcamp (codemp,codfilial,codcamp,codempco,codfilialco,codcto,seqsitcamp,
                codempav,codfilialav,codativ, tipocto)
            values (:codempca,:codfilialca,:codcamp,:codempco,:codfilialco,:codcto,:seqsitcamp,
                :codempat,:codfilialat ,:codativ, :tipocto );
    end
    else
    begin
        insert into tksitcamp (codemp,codfilial,codcamp,codempcl,codfilialcl,codcli,seqsitcamp,
                codempav,codfilialav,codativ, tipocto)
            values (:codempca,:codfilialca,:codcamp,:codempco,:codfilialco,:codcto,:seqsitcamp,
                :codempat,:codfilialat ,:codativ, :tipocto );
    end

    -- Inserindo histrico
    
    if ( tipocto = 'O' ) then 
    begin 
        insert into tkhistorico (codemp, codfilial,codhisttk,horahisttk,datahisttk,
                         codempco,codfilialco,codcto,deschisttk,codempae,codfilialae,codatend,
                         sithisttk,tipohisttk, tipocto)
            values (:codempca,:codfilialhi,:codhisttk,cast('now' as time),cast('now' as date),
                      :codempco,:codfilialco,:codcto,:deschisttk,:codempae,:codfilialae,:codatend,
                          :sithisttk,'C', :tipocto);
    end
    else
    begin
        insert into tkhistorico (codemp, codfilial,codhisttk,horahisttk,datahisttk,
                         codempcl,codfilialcl,codcli,deschisttk,codempae,codfilialae,codatend,
                         sithisttk,tipohisttk, tipocto)
            values (:codempca,:codfilialhi,:codhisttk,cast('now' as time),cast('now' as date),
                      :codempco,:codfilialco,:codcto,:deschisttk,:codempae,:codfilialae,:codatend,
                          :sithisttk,'C', :tipocto);
    end
   

end ^

ALTER PROCEDURE TKSETHISTSP (CODHISTTK INTEGER,
CODEMP INTEGER,
CODFILIALCO INTEGER,
CODCTO INTEGER,
CODFILIALCL INTEGER,
CODCLI INTEGER,
DESCHISTTK VARCHAR(10000),
CODFILIALAE INTEGER,
CODATEND INTEGER,
SITHISTTK CHAR(2),
DATAHISTTK DATE,
TIPOHISTTK CHAR(1))
RETURNS (IRET INTEGER)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

DECLARE VARIABLE IFILIALHIST INTEGER;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(:CODEMP,'TKHISTORICO') INTO IFILIALHIST;
  IF (TIPOHISTTK = '') THEN
  BEGIN
    TIPOHISTTK = 'H';
  END
  IF (CODHISTTK = 0) THEN
  BEGIN
    SELECT ISEQ FROM SPGERANUM(:CODEMP,:IFILIALHIST,'HI') INTO CODHISTTK;
    INSERT INTO TKHISTORICO(CODEMP,CODFILIAL,CODHISTTK,DATAHISTTK,HORAHISTTK,CODEMPCO,CODFILIALCO,
      CODCTO,CODEMPCL,CODFILIALCL,CODCLI,DESCHISTTK,CODEMPAE,CODFILIALAE,CODATEND,SITHISTTK,TIPOHISTTK)
      VALUES (:CODEMP,:IFILIALHIST,:CODHISTTK,:DATAHISTTK,CAST('now' AS TIME),:CODEMP,:CODFILIALCO,
      :CODCTO,:CODEMP,:CODFILIALCL,:CODCLI,:DESCHISTTK,:CODEMP,:CODFILIALAE,:CODATEND,:SITHISTTK,:TIPOHISTTK);
  END
  ELSE
  BEGIN
    UPDATE TKHISTORICO SET DATAHISTTK=:DATAHISTTK,CODEMPCO=:CODEMP,CODFILIALCO=:CODFILIALCO,
      CODCTO=:CODCTO,CODEMPCL=:CODEMP,CODFILIALCL=:CODFILIALCL,
      CODCLI=:CODCLI,DESCHISTTK=:DESCHISTTK,CODEMPAE=:CODEMP,
      CODFILIALAE=:CODFILIALAE,CODATEND=:CODATEND,SITHISTTK=:SITHISTTK,TIPOHISTTK=:TIPOHISTTK
      WHERE CODEMP=:CODEMP AND CODFILIAL=:IFILIALHIST AND CODHISTTK=:CODHISTTK;
    /*IF (NOT SITHISTTK IN ('AG')) THEN
      DELETE FROM SGAGENDA WHERE OBJORIGAGD='HISTO' AND CODEMPCH=:CODEMP AND
        CODFILIALCH=:IFILIALHIST AND CODCHAVE=:CODHISTTK; */
  END
  SUSPEND;
END ^

ALTER PROCEDURE VDADICCOMISSAOSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODREC INTEGER,
INPARCITREC INTEGER,
NVLRVENDACOMI NUMERIC(15, 5),
NVLRCOMI NUMERIC(15, 5),
DDATACOMI DATE,
DDTCOMPCOMI DATE,
DDTVENCCOMI DATE,
CTIPOCOMI CHAR(1),
CODEMPVD INTEGER,
CODFILIALVD SMALLINT,
CODVEND INTEGER)
AS 

declare variable scodfilialcs smallint;
declare variable icodcomi integer;
declare variable cstatuscomi char(2);
begin

    -- Se o valor for nulo ou 0 deve deletar a comisso j gerada
    if ( (nvlrcomi is null) or  (nvlrcomi=0) ) then
    begin

        delete from vdcomissao co
        where co.codemprc=:icodemp and co.codfilialrc=:scodfilial and co.codrec=:icodrec and co.nparcitrec=:inparcitrec and
        co.tipocomi=:ctipocomi and codempvd=:codempvd and codfilialvd=:codfilialvd and codvend=:codvend;

    end
    -- Caso seja um estorno de comisso
    else if (nvlrcomi<0) then
    begin

        -- Buscando a filial da tabela de comisses
        select icodfilial from sgretfilial(:icodemp,'VDCOMISSAO') into :scodfilialcs;

        -- Buscando novo numero para
        select max(codcomi) from vdcomissao where codemp=:icodemp and codfilialvd = :scodfilialcs into icodcomi;

        if (:icodcomi is null) then
            icodcomi = 1;
        else
            icodcomi = icodcomi + 1;

        -- Inserindo na tabela de comisses
        insert into vdcomissao (
            codemp, codfilial, codcomi, codempRc, codfilialrc, codrec, nparcitrec, vlrvendacomi, vlrcomi, datacomi,
            dtcompcomi, dtvenccomi, statuscomi, tipocomi, codempvd, codfilialvd, codvend )
        values (
            :icodemp, :scodfilialcs, :icodcomi, :icodemp, :scodfilial, :icodrec, :inparcitrec, :nvlrvendacomi, :nvlrcomi, :ddatacomi,
            :ddtcompcomi, :ddtvenccomi, 'CE', :ctipocomi, :codempvd, :codfilialvd,:codvend
            );

        -- Transforma o valor da comisso em positivo e programa para o proximo pagto.
        nvlrcomi = nvlrcomi * -1;

        icodcomi = icodcomi + 1;

        insert into vdcomissao (
            codemp, codfilial, codcomi, codemprc, codfilialrc, codrec, nparcitrec,
            vlrvendacomi, vlrcomi, datacomi, dtcompcomi,  dtvenccomi, statuscomi, tipocomi, codempvd, codfilialvd, codvend )
        values (
            :icodemp, :scodfilialcs, :icodcomi, :icodemp, :scodfilial, :icodrec, :inparcitrec,
            :nvlrvendacomi, :nvlrcomi, :ddatacomi, :ddtcompcomi, :ddtvenccomi, 'C1', :ctipocomi, :codempvd,:codfilialvd,:codvend
            );

    end
    else
    begin

        if (ctipocomi='F') then
            cstatuscomi = 'C2';
        else
            cstatuscomi = 'C1';

        -- Buscando a filial da tabela de comisses
        select icodfilial from sgretfilial( :icodemp, 'VDCOMISSAO') into :scodfilialcs;

        -- Buscando o cdigo da comisso j existente
        select codcomi from vdcomissao
        where codemp=:icodemp and codfilialrc=:scodfilial and codrec=:icodrec and nparcitrec=:inparcitrec and
        tipocomi=:ctipocomi and codempvd=:codempvd and codfilialvd=:codfilialvd and codvend=:codvend
        into :icodcomi;

        -- Caso j no exista a comisso deve inserir
        if (icodcomi is null) then
        begin
            --Buscando um novo cdigo
            select max(codcomi) from vdcomissao where codemp=:icodemp and codfilial = :scodfilialcs into icodcomi;

            if (:icodcomi is null) then
                icodcomi = 1;
            else
                icodcomi = icodcomi + 1;

            -- Inserindo na tabela de comisses
            insert into vdcomissao( codemp, codfilial, codcomi, codemprc, codfilialrc, codrec, nparcitrec,
            vlrvendacomi, vlrcomi, datacomi, dtcompcomi, dtvenccomi, statuscomi, tipocomi, codempvd, codfilialvd, codvend)
            values (
                :icodemp, :scodfilialcs, :icodcomi, :icodemp, :scodfilial, :icodrec, :inparcitrec,
                :nvlrvendacomi, :nvlrcomi, :ddatacomi, :ddtcompcomi, :ddtvenccomi, :cstatuscomi, :ctipocomi, :codempvd, :codfilialvd, :codvend
            );

        end
        -- Se encontrou a comisso atualiza
        else
        begin

            update vdcomissao set vlrvendacomi=:nvlrvendacomi, vlrcomi=:nvlrcomi, datacomi=:ddatacomi,
            dtvenccomi=:ddtvenccomi, statuscomi=:cstatuscomi
            where codemp=:icodemp and codfilial=:scodfilialcs and codcomi=:icodcomi and codempvd=:codempvd and
            codfilialvd=:codfilialvd and codvend=:codvend and statuscomi!='CP' ;

        end

    end
    suspend;
end ^

ALTER PROCEDURE VDADICITEMPDVSP (CODVENDA INTEGER,
CODEMP INTEGER,
CODFILIAL CHAR(8),
CODPROD INTEGER,
CODEMPPD INTEGER,
CODFILIALPD INTEGER,
QTDITVENDA NUMERIC(9, 5),
VLRPRECOITVENDA NUMERIC(18, 5),
VLRDESCITVENDA NUMERIC(18, 5),
PERCDESCITVENDA NUMERIC(15, 5),
VLRCOMISITVENDA NUMERIC(15, 5),
PERCCOMISITVENDA NUMERIC(15, 5),
SCODLOTE VARCHAR(20),
CODEMPLE INTEGER,
CODFILIALLE SMALLINT,
CODFILIALCV SMALLINT,
CODCONV INTEGER)
RETURNS (CODITVENDA INTEGER,
PERCICMSITVENDA NUMERIC(9, 2),
VLRBASEICMSITVENDA NUMERIC(18, 3),
VLRICMSITVENDA NUMERIC(18, 3),
VLRLIQITVENDA NUMERIC(18, 3),
TIPOFISC CHAR(2))
AS 
 
 
declare variable icodfilialnt smallint;
declare variable icodcli integer;
declare variable icodfilialcl integer;
declare variable icodtipomov integer;
declare variable icodfilialtm integer;
declare variable scodnat char(4);
declare variable sorigfisc char(1);
declare variable scodtrattrib char(2);
declare variable icodfilialtt smallint;
declare variable icodfilialme smallint;
declare variable icodmens smallint;
declare variable percipiitvenda numeric(9,2);
declare variable vlrbaseipiitvenda numeric(15,5);
declare variable vlripiitvenda numeric(15,5);
declare variable vlrproditvenda numeric(15,5);
declare variable srefprod varchar(20);
declare variable obsitorc varchar(500);
declare variable ufcli char(2);
declare variable ufflag char(1);
declare variable percred numeric(9,2);
begin

  SELECT MAX(CODITVENDA)+1 FROM VDITVENDA WHERE CODVENDA=:CODVENDA
    AND CODFILIAL=:CODFILIAL AND CODEMP=:CODEMP INTO CODITVENDA;

  IF (CODITVENDA IS NULL) THEN
    CODITVENDA = 1;

/*Informaes da Venda.:*/

  SELECT V.CODCLI,V.CODFILIALCL,C.UFCLI,V.CODTIPOMOV,V.CODFILIALTM FROM VDVENDA V, VDCLIENTE C
    WHERE V.CODEMP=:CODEMP AND V.CODFILIAL=:CODFILIAL
    AND V.CODVENDA=:CODVENDA AND V.TIPOVENDA='E' AND
    C.CODCLI=V.CODCLI AND C.CODEMP=V.CODEMPCL AND
    C.CODFILIAL=V.CODFILIALCL INTO ICODCLI,ICODFILIALCL,UFCLI,ICODTIPOMOV,ICODFILIALTM;


  UFFLAG = 'N';

  SELECT 'S' FROM SGFILIAL  WHERE CODEMP=:CODEMP
    AND CODFILIAL=:CODFILIAL AND UFFILIAL=:UFCLI INTO UFFLAG;


  SELECT ICODFILIAL FROM SGRETFILIAL(:CODEMP,'LFNATOPER') INTO ICODFILIALNT;
  SELECT ICODFILIAL FROM SGRETFILIAL(:CODEMP,'LFTRATTRIB') INTO ICODFILIALTT;
  SELECT ICODFILIAL FROM SGRETFILIAL(:CODEMP,'LFMENSAGEM') INTO ICODFILIALME;

  SELECT C.ALIQIPIFISC
      FROM EQPRODUTO P, LFITCLFISCAL C
         WHERE P.CODPROD=:CODPROD AND P.CODFILIAL=:CODFILIALPD
         AND P.CODEMP=:CODEMPPD AND C.CODFISC=P.CODFISC AND C.CODFILIAL=P.CODFILIALFC and
         C.geralfisc='S'
         AND C.CODEMP=P.CODEMPFC 
         and c.ativoitfisc='S'
         INTO PERCIPIITVENDA;

  SELECT CODNAT FROM
      LFBUSCANATSP(:CODFILIAL,:CODEMP,:CODFILIALPD,
                   :CODPROD,:CODEMP,:ICODFILIALCL,
                   :ICODCLI,NULL,NULL,NULL,:ICODFILIALTM,:ICODTIPOMOV,null)
      INTO SCODNAT;

  IF (SCODNAT IS NULL) THEN
      EXCEPTION VDITVENDAEX03;

  SELECT TIPOFISC,REDFISC,CODTRATTRIB,ORIGFISC,CODMENS,ALIQFISC FROM
      LFBUSCAFISCALSP(:CODEMP,:CODFILIALPD,:CODPROD,
                      :CODEMP,:ICODFILIALCL,:ICODCLI,
                      :CODEMP,:ICODTIPOMOV,:ICODFILIALTM, 'VD',:SCODNAT,null,null,null,null)
      INTO TIPOFISC,PERCRED,SCODTRATTRIB,SORIGFISC,ICODMENS,PERCICMSITVENDA;

  VLRPRODITVENDA = (QTDITVENDA*VLRPRECOITVENDA);
  VLRBASEIPIITVENDA = 0;
  VLRBASEICMSITVENDA = 0;
  VLRICMSITVENDA = 0;
  VLRIPIITVENDA = 0;
  IF (PERCIPIITVENDA IS NULL) THEN
     PERCIPIITVENDA = 0;

  IF ( TIPOFISC = 'II') THEN
  BEGIN
    PERCICMSITVENDA = 0;
    VLRICMSITVENDA = 0;
    VLRBASEICMSITVENDA = 0;
    PERCIPIITVENDA = 0;
    VLRIPIITVENDA = 0;
    VLRBASEIPIITVENDA = 0;
  END
  ELSE IF ( TIPOFISC = 'FF') THEN
  BEGIN
    PERCICMSITVENDA = 0;
    VLRICMSITVENDA = 0;
    VLRBASEICMSITVENDA = 0;
    PERCIPIITVENDA = 0;
    VLRIPIITVENDA = 0;
    VLRBASEIPIITVENDA = 0;
  END
  ELSE IF ( TIPOFISC = 'NN') THEN
  BEGIN
    PERCICMSITVENDA = 0;
    VLRICMSITVENDA = 0;
    VLRBASEICMSITVENDA = 0;
    PERCIPIITVENDA = 0;
    VLRIPIITVENDA = 0;
    VLRBASEIPIITVENDA = 0;
  END
  ELSE IF ( TIPOFISC = 'TT') THEN
  BEGIN
    IF (PERCICMSITVENDA = 0 OR PERCICMSITVENDA IS NULL) THEN
      SELECT PERCICMS FROM LFBUSCAICMSSP (:SCODNAT,:UFCLI,:CODEMP,:CODFILIAL) INTO PERCICMSITVENDA;
    IF (PERCRED IS NULL) THEN
      PERCRED = 0;
    VLRBASEICMSITVENDA = (VLRPRODITVENDA-VLRDESCITVENDA) - ((VLRPRODITVENDA-VLRDESCITVENDA)*(PERCRED/100));
    VLRBASEIPIITVENDA = VLRPRODITVENDA-VLRDESCITVENDA;
    VLRICMSITVENDA = VLRBASEICMSITVENDA*(PERCICMSITVENDA/100);
    VLRIPIITVENDA = VLRBASEIPIITVENDA*(PERCIPIITVENDA/100);
  END
  VLRLIQITVENDA= VLRPRODITVENDA+VLRIPIITVENDA-VLRDESCITVENDA;
  INSERT INTO VDITVENDA (
     CODEMP,CODFILIAL,TIPOVENDA,CODVENDA,CODITVENDA,
     CODEMPNT,CODFILIALNT,CODNAT,
     CODEMPPD,CODFILIALPD,CODPROD,
     CODEMPLE,CODFILIALLE,CODLOTE,
     QTDITVENDA,PRECOITVENDA,PERCDESCITVENDA,VLRDESCITVENDA,
     VLRCOMISITVENDA,PERCCOMISITVENDA,
     PERCICMSITVENDA,VLRBASEICMSITVENDA,VLRICMSITVENDA,
     PERCIPIITVENDA,VLRBASEIPIITVENDA,VLRIPIITVENDA,VLRLIQITVENDA,
     VLRPRODITVENDA,REFPROD,ORIGFISC,
     CODEMPTT,CODFILIALTT,CODTRATTRIB,TIPOFISC,
     CODEMPME,CODFILIALME,CODMENS,OBSITVENDA,
     CODEMPCV,CODFILIALCV,CODCONV) VALUES (
     :CODEMP,:CODFILIAL,'E',:CODVENDA,:CODITVENDA,
     :CODEMP,:ICODFILIALNT,:SCODNAT,
     :CODEMPPD,:CODFILIALPD,:CODPROD,
     :CODEMPLE,:CODFILIALLE,:SCODLOTE,
     :QTDITVENDA,:VLRPRECOITVENDA,:PERCDESCITVENDA,:VLRDESCITVENDA,
     :VLRCOMISITVENDA,:PERCCOMISITVENDA,
     :PERCICMSITVENDA,:VLRBASEICMSITVENDA,:VLRICMSITVENDA,
     :PERCIPIITVENDA,:VLRBASEIPIITVENDA,:VLRIPIITVENDA,:VLRLIQITVENDA,
     :VLRPRODITVENDA,:SREFPROD,:SORIGFISC,
     :CODEMP,:ICODFILIALTT,:SCODTRATTRIB,:TIPOFISC,
     :CODEMP,:ICODFILIALME,:ICODMENS,:OBSITORC,
     :CODEMP, :CODFILIALCV,:CODCONV);
  SUSPEND;
END ^

ALTER PROCEDURE VDADICITORCRECMERCSP (CODEMP INTEGER,
CODFILIAL SMALLINT,
TICKET INTEGER,
CODEMPOC INTEGER,
CODFILIALOC SMALLINT,
CODORC INTEGER,
COMPONENTES CHAR(1),
SERVICOS CHAR(1),
NOVOS CHAR(1))
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

declare variable codemppd integer;
declare variable codfilialpd integer;
declare variable codprod integer;
declare variable coditos integer;
declare variable coditorc integer;
declare variable codprodant integer;
declare variable coditrecmerc integer;
declare variable refprod varchar(20);
declare variable codemptm integer;
declare variable codfilialtm smallint;
declare variable codtipomov integer;
declare variable codempax integer;
declare variable codfilialax smallint;
declare variable codalmox integer;
declare variable precoitorc numeric(15,5);
declare variable qtditorc numeric(15,5);
declare variable codempcl integer;
declare variable codfilialcl smallint;
declare variable codcli integer;
declare variable codemppg integer;
declare variable codfilialpg smallint;
declare variable codplanopag integer;
declare variable gerachamado char(1);
declare variable obsitorc varchar(10000);
declare variable descprod char(100);
declare variable vlrliqitorc numeric(15,5);
declare variable vlrproditorc numeric(15,5);
declare variable usaprecopecaserv char(1);
declare variable codprodpeca integer;
declare variable garantia char(1);
declare variable codprodir integer;
declare variable refprodir varchar(20);
begin
    
    -- Buscando preferencias do GMS
    select coalesce(p8.usaprecopecaserv,'N') from sgprefere8 p8
    where p8.codemp=:codemp and p8.codfilial=:codfilial
    into :usaprecopecaserv;

    -- Buscando informaes do oramento
    select codempcl, codfilialcl, codcli, codemppg, codfilialpg, codplanopag, codemptm, codfilialtm, codtipomov
    from vdorcamento
    where codemp=:codempoc and codfilial=:codfilialoc and codorc=:codorc and tipoorc='O'
    into :codempcl, :codfilialcl, :codcli, :codemppg, :codfilialpg, :codplanopag, :codemptm, :codfilialtm, :codtipomov;

    -- Sendo um oramento para peas e mo-de-obra
    -- Deve gerar oramento dos tens de suplemento
    for select ir.codemppd, ir.codfilialpd, ir.codprodpd, ir.refprodpd, ir.coditrecmerc, ir.coditos, ir.qtditos,
        ir.gerachamado, pd.descprod, irm.codprod, irm.garantia, irm.codprod codprodir, irm.refprod refprodir
        from eqitrecmercitos ir, eqitrecmerc irm, eqproduto pd
        where
        irm.codemp=ir.codemp and irm.codfilial=ir.codfilial and irm.ticket=ir.ticket and irm.coditrecmerc=ir.coditrecmerc
        and pd.codemp=irm.codemppd and pd.codfilial=irm.codfilialpd and irm.codprod=pd.codprod
        and ir.codemp=:codemp and ir.codfilial=:codfilial and ir.ticket=:ticket and
        -- Filtrando componentes e servios
        (
           (ir.gerarma=:componentes and ir.gerarma='S') or
           (ir.gerachamado=:servicos and ir.gerachamado='S') or
           (ir.geranovo=:novos and ir.geranovo='S')
        )

        into :codemppd, :codfilialpd, :codprod, :refprod, :coditrecmerc, :coditos, :qtditorc,
             :gerachamado, :descprod, :codprodpeca, :garantia, :codprodir, :refprodir
        do
        begin

--            if(:codprod <> :codprodant or :codprodant is null) then
--            begin

                -- Verifica se  servio, sendo servio insere a descriao do produto
                -- consertado na descrio auxiliar do item de oramento
                if(:gerachamado=:servicos and :gerachamado='S') then
                begin
                    if( 'N' = :garantia ) then
                    begin
                        obsitorc = :refprodir || ' - ' || :descprod;
                    end
                    else
                    begin
                        obsitorc = :refprodir || ' - ' || :descprod || '[G]';
                    end

                end

                --Buscando cdigo do item de oramento
                select coalesce(max(coditorc)+1,1) from vditorcamento io
                where io.codemp=:codempoc and io.codfilial=:codfilialoc and io.codorc=:codorc and io.tipoorc='O'
                into :coditorc;

                -- Buscando preo de venda
                -- Se no est em garantia...

                if('N' = :garantia) then
                begin
                    -- Se o preo  basedo na peca, deve buscar o preo da pea
                    if(usaprecopecaserv='S') then
                    begin
                        select preco from vdbuscaprecosp(:codprodpeca,:codcli,:codempcl,:codfilialcl,
                        :codplanopag,:codemppg,:codfilialpg,:codtipomov,:codemptm,:codfilialtm,:codemp,:codfilial)
                        into :precoitorc;
                    end
                    else
                    begin
                        select preco from vdbuscaprecosp(:codprod,:codcli,:codempcl,:codfilialcl,
                        :codplanopag,:codemppg,:codfilialpg,:codtipomov,:codemptm,:codfilialtm,:codemp,:codfilial)
                        into :precoitorc;
                    end
                end
                else
                begin

                    precoitorc = 0.00;

                end

                -- Buscando informaes do produto
                select pd.codempax, pd.codfilialax, pd.codalmox, pd.refprod from eqproduto pd
                where pd.codemp=:codemppd and pd.codfilial=:codfilialpd and pd.codprod=:codprod
                into :codempax, :codfilialax, :codalmox, :refprod;

                vlrproditorc = :qtditorc * :precoitorc;
                vlrliqitorc = vlrproditorc;

                -- Inserir itens
                insert into vditorcamento (
                codemp, codfilial, codorc, tipoorc, coditorc,
                codemppd, codfilialpd, codprod, refprod,
                qtditorc, precoitorc, codempax, codfilialax, codalmox, obsitorc, vlrproditorc, vlrliqitorc, sitproditorc)
                values (:codempoc, :codfilialoc, :codorc, 'O', :coditorc,
                :codemppd, :codfilialpd, :codprod, :refprod,
                :qtditorc, :precoitorc, :codempax, :codfilialax, :codalmox, :obsitorc, :vlrproditorc, :vlrliqitorc,
                'PE') ;

                -- Inserindo vnculo entre item de oramento e ordem de servio

                insert into eqitrecmercitositorc(codemp, codfilial, ticket, coditrecmerc, coditos, codempoc, codfilialoc, codorc, coditorc, tipoorc)
                values(:codemp,:codfilial,:ticket,:coditrecmerc,:coditos, :codempoc,:codfilialoc,:codorc,:coditorc,'O');

                codprodant = codprod;

--            end
        end

        -- Atualizando o status da ordem de servio
        update eqrecmerc rm set rm.status = 'EO'
        where rm.codemp=:codemp and rm.codfilial=:codfilial and rm.ticket=:ticket;

end ^

ALTER PROCEDURE VDADICITVENDAORCSP (FILIALATUAL INTEGER,
ICODVENDA INTEGER,
ICODORC INTEGER,
ICODITORC INTEGER,
ICODFILIAL SMALLINT,
ICODEMP INTEGER,
STIPOVENDA CHAR(10),
TPAGRUP CHAR(1),
IQTDITVENDA NUMERIC(15, 5),
VLRDESCITVENDA NUMERIC(15, 5))
AS 

declare variable icoditvenda integer;
declare variable icodfilialnt smallint;
declare variable codempax integer;
declare variable codfilialax integer;
declare variable codalmox integer;
declare variable icodcli integer;
declare variable icodfilialtm integer;
declare variable icodtipomov integer;
declare variable icodfilialcl integer;
declare variable scodnat char(4);
declare variable icodfilialle smallint;
declare variable scodlote varchar(20);
declare variable tipofisc char(2);
declare variable sorigfisc char(1);
declare variable scodtrattrib char(2);
declare variable icodfilialtt smallint;
declare variable icodfilialme smallint;
declare variable icodmens smallint;
declare variable percicmsitvenda numeric(15,5);
declare variable vlrbaseicmsitvenda numeric(15,5);
declare variable vlricmsitvenda numeric(15,5);
declare variable percipiitvenda numeric(15,5);
declare variable vlrbaseipiitvenda numeric(15,5);
declare variable vlripiitvenda numeric(15,5);
declare variable icodprod integer;
declare variable icodfilialpd integer;
declare variable vlrprecoitvenda numeric(15,5);
declare variable percdescitvenda numeric(15,5);
declare variable vlrliqitvenda numeric(15,5);
declare variable vlrproditvenda numeric(15,5);
declare variable obsitorc varchar(500);
declare variable ufcli char(2);
declare variable ufflag char(1);
declare variable percred numeric(15,5);
declare variable cloteprod char(1);
declare variable perccomisitvenda numeric(15,5);
declare variable geracomis char(1);
declare variable vlrcomisitvenda numeric(15,5);
declare variable codempif integer;
declare variable codfilialif smallint;
declare variable codfisc char(13);
declare variable coditfisc integer;
declare variable percissitvenda numeric(15,5);
declare variable vlrbaseissitvenda numeric(15,5);
declare variable vlrissitvenda numeric(15,5);
declare variable vlrisentasitvenda numeric(15,5);
declare variable vlroutrasitvenda numeric(15,5);
declare variable tipost char(2);
declare variable vlrbaseicmsstitvenda numeric(15,5);
declare variable vlricmsstitvenda numeric(15,5);
declare variable margemvlagritvenda numeric(15,5);
declare variable srefprod varchar(20);
declare variable stipoprod varchar(2);
declare variable percicmsst numeric(15,5);
declare variable vlrbaseicmsbrutitvenda numeric(15,5);
declare variable tpredicms char(1);
declare variable redbaseicmsst char(1);
declare variable qtditorc numeric(15,5);
declare variable calcstcm char(1);
declare variable aliqicmsstcm numeric(9,2);
declare variable vlricmsstcalc numeric(15,5);
begin
-- Inicializao de variaveis
    CALCSTCM = 'N';
    UFFLAG = 'N';

    select icodfilial from sgretfilial(:ICODEMP,'LFNATOPER') into ICODFILIALNT;
    select icodfilial from sgretfilial(:ICODEMP,'LFTRATTRIB') into ICODFILIALTT;
    select icodfilial from sgretfilial(:ICODEMP,'LFMENSAGEM') into ICODFILIALME;

    select vd.codfilialtm,vd.codtipomov from vdvenda vd where codvenda=:ICODVENDA and codfilial=:ICODFILIAL and codemp=:ICODEMP and tipovenda=:STIPOVENDA
    into ICODFILIALTM,ICODTIPOMOV;

-- Verifica se deve gerar comisso para a venda

    select geracomisvendaorc from sgprefere1 where codemp=:ICODEMP and codfilial=:ICODFILIAL into GERACOMIS;

-- Busca sequencia de numerao do tem de venda

    select coalesce(max(coditvenda),0)+1 from vditvenda where codvenda=:ICODVENDA and codfilial=:ICODFILIAL and codemp=:ICODEMP and tipovenda=:STIPOVENDA
    into ICODITVENDA;

-- Informaes do Orcamento

    select codcli,codfilialcl from vdorcamento where codemp=:ICODEMP and codfilial=:ICODFILIAL and codorc=:ICODORC into ICODCLI,ICODFILIALCL;

-- Informaes do item de oramento

    select it.codemppd, it.codfilialpd,it.codprod,it.precoitorc,it.percdescitorc,it.vlrliqitorc,it.vlrproditorc,it.refprod,it.obsitorc,
    it.codempax,it.codfilialax,it.codalmox,it.codlote,pd.cloteprod,pd.comisprod,pd.tipoprod, it.perccomisitorc, it.vlrcomisitorc, it.qtditorc
    from vditorcamento it, eqproduto pd
    where it.coditorc=:ICODITORC and it.codorc=:ICODORC and it.codfilial=:ICODFILIAL and it.codemp=:ICODEMP and
    pd.codemp=it.codemppd and pd.codfilial=it.codfilialpd and pd.codprod=it.codprod
    into ICODEMP,ICODFILIALPD,ICODPROD,VLRPRECOITVENDA,PERCDESCITVENDA,VLRLIQITVENDA,VLRPRODITVENDA,SREFPROD,OBSITORC,
    CODEMPAX,CODFILIALAX,CODALMOX,SCODLOTE,CLOTEPROD,perccomisitvenda,STIPOPROD,perccomisitvenda,vlrcomisitvenda, :qtditorc;

    -- Informaes fiscais para a venda

    select coalesce(c.siglauf,c.ufcli)
    from vdorcamento o, vdcliente c
    where o.codorc=:ICODORC and o.codfilial=:ICODFILIAL and o.codemp=:ICODEMP and
    c.codcli=o.codcli and c.codfilial=o.codfilialcl and c.codemp=o.codempcl
    into ufcli;

    -- Busca informaes fiscais para o tem de venda (sem natureza da operao deve retornar apenas o coditfisc)

    select codempif,codfilialif,codfisc,coditfisc
    from lfbuscafiscalsp(:ICODEMP,:ICODFILIALPD,:ICODPROD,:ICODEMP,:ICODFILIALCL,:ICODCLI,:ICODEMP,:ICODFILIALTM,
    :ICODTIPOMOV, 'VD',null,null,null,null,null)
    into CODEMPIF,CODFILIALIF,CODFISC,CODITFISC;


-- Verifica se a venda  para outro estado

    select codnat from lfbuscanatsp(:FILIALATUAL,:ICODEMP,:ICODFILIALPD,:ICODPROD,:ICODEMP,:ICODFILIALCL,
    :ICODCLI,NULL,NULL,NULL,:ICODFILIALTM,:ICODTIPOMOV,:coditfisc)
    into SCODNAT;
    
    if (SCODNAT IS NULL) then
    begin
        exception vditvendaex03 :SREFPROD; -- NO FOI POSSVEL ENCONTRAR A NATUREZA DA OPERAO PARA O TEM
    end

-- Busca informaes fiscais para o tem de venda (j sabe o coditfisc)

    select tipofisc,redfisc,codtrattrib,origfisc,codmens,aliqfisc,codempif,codfilialif,codfisc,coditfisc,tipost,
    margemvlagr,aliqipifisc,aliqfiscintra,tpredicmsfisc,redbasest,aliqiss,coalesce(calcstcm,'N'),aliqicmsstcm
    from lfbuscafiscalsp(:ICODEMP,:ICODFILIALPD,:ICODPROD,:ICODEMP,:ICODFILIALCL,:ICODCLI,:ICODEMP,:ICODFILIALTM,
    :ICODTIPOMOV, 'VD',:scodnat,:codempif,:codfilialif,:codfisc,:coditfisc)
    into TIPOFISC,PERCRED,SCODTRATTRIB,SORIGFISC,ICODMENS,PERCICMSITVENDA,CODEMPIF,CODFILIALIF,CODFISC,CODITFISC,TIPOST,MARGEMVLAGRITVENDA,
    PERCIPIITVENDA,PERCICMSST, tpredicms, redbaseicmsst, PERCISSITVENDA, CALCSTCM, ALIQICMSSTCM;

   
   
-- Busca lote, caso seja necessrio

    if (CLOTEPROD = 'S' and SCODLOTE is null) then
    begin
        select first 1 l.codlote from eqlote l
        where l.codprod=:ICODPROD and l.codfilial=:ICODFILIALPD and l.codemp=:ICODEMP and
        l.venctolote = ( select min(venctolote) from eqlote ls where ls.codprod=l.codprod and ls.codfilial=l.codfilial and ls.codemp=L.codemp and
                         ls.sldliqlote>=:IQTDITVENDA ) and
        l.sldliqlote>=:IQTDITVENDA
        into SCODLOTE;

        ICODFILIALLE = ICODFILIALPD;
    end
    
-- Inicializando valores

    VLRPRODITVENDA = VLRPRECOITVENDA * :IQTDITVENDA;
     if (:iqtditvenda<>:qtditorc) then
    begin
       VLRDESCITVENDA = (:VLRDESCITVENDA/:QTDITORC*:IQTDITVENDA);
    end
    VLRLIQITVENDA = VLRPRODITVENDA - :VLRDESCITVENDA;
    VLRBASEIPIITVENDA = 0;
    VLRBASEICMSITVENDA = 0;
    VLRICMSITVENDA = 0;
    VLRIPIITVENDA = 0;

    if (PERCICMSITVENDA = 0 or PERCICMSITVENDA is null) then
    begin
        select coalesce(PERCICMS,0) from lfbuscaicmssp (:SCODNAT,:UFCLI,:ICODEMP,:ICODFILIAL) into PERCICMSST;
    end

    if (PERCRED is null) then
    begin
        PERCRED = 0;
    end

    if(percred>0) then
    begin
        if(:tpredicms='B') then
        begin
            VLRBASEICMSITVENDA = (:VLRPRODITVENDA - :VLRDESCITVENDA) - ( (VLRPRODITVENDA - :VLRDESCITVENDA) * ( PERCRED / 100 ) );
            VLRICMSITVENDA = VLRBASEICMSITVENDA * ( PERCICMSITVENDA / 100 );
        end
        else if(:tpredicms='V') then
        begin
            VLRBASEICMSITVENDA = (:VLRPRODITVENDA - :VLRDESCITVENDA);
            VLRICMSITVENDA = (VLRBASEICMSITVENDA * ( PERCICMSITVENDA / 100 )) -  ( (VLRBASEICMSITVENDA * ( PERCICMSITVENDA / 100 ) * ( PERCRED / 100 ) )) ;
        end
    end
    else
    begin
        VLRBASEICMSITVENDA = :VLRPRODITVENDA - :VLRDESCITVENDA;
        VLRICMSITVENDA = VLRBASEICMSITVENDA * ( PERCICMSITVENDA / 100 );
    end

    VLRBASEIPIITVENDA = :VLRPRODITVENDA - :VLRDESCITVENDA;
    VLRBASEICMSBRUTITVENDA = :VLRPRODITVENDA - :VLRDESCITVENDA;
    VLRIPIITVENDA = VLRBASEIPIITVENDA * ( PERCIPIITVENDA / 100 );

-- **** Calculo dos tributos ***

-- Verifica se  um servio (Calculo do ISS);

    if (:STIPOPROD = 'S') then
    begin
    -- Carregando aliquota do ISS
    -- Bloco comentado, pois j buscou o percentual do iss atravs da procedure.
   --     select percissfilial from sgfilial where codemp=:ICODEMP and codfilial=:ICODFILIAL
   --     into PERCISSITVENDA;

    -- Calculando e computando base e valor do ISS;
        if (:PERCISSITVENDA != 0) then
        begin
            VLRBASEISSITVENDA = :VLRLIQITVENDA;
            VLRISSITVENDA = :VLRBASEISSITVENDA * (:PERCISSITVENDA/100);
        end
    end
    else -- Se o item vendido no for SERVIO zera ISS
        VLRBASEISSITVENDA = 0;

    -- Se produto for isento de ICMS
    if (:TIPOFISC = 'II') then
    begin
        VLRISENTASITVENDA = :VLRLIQITVENDA;
        VLRBASEICMSITVENDA = 0;
        PERCICMSITVENDA = 0;
        VLRICMSITVENDA = 0;
        VLROUTRASITVENDA = 0;
    end
    -- Se produto for de Substituio Tributria

    else if (:TIPOFISC = 'FF') then
    begin
        if (:TIPOST = 'SI' ) then -- Contribuinte Substitudo
        begin
            VLROUTRASITVENDA = :VLRLIQITVENDA;
            VLRBASEICMSITVENDA = 0;
            PERCICMSITVENDA = 0;
            VLRICMSITVENDA = 0;
            VLRISENTASITVENDA = 0;
        end
        else if (:TIPOST = 'SU' ) then -- Contribuinte Substituto
        begin

            if( (:PERCICMSST is null) or (:PERCICMSST=0) ) then
            begin
                select coalesce(PERCICMSINTRA,0) from lfbuscaicmssp (:SCODNAT,:UFCLI,:ICODEMP,:ICODFILIAL)
                into PERCICMSST;
            end
            --Calculo do ICMS ST para fora de mato grosso.

            
            if(calcstcm = 'N') then
            begin
                
                if(percred>0 and redbaseicmsst='S') then
                begin
                -- Quando h reduo na base do icms st , deve usar o valor da base do icms proprio como parametro
                   vlrbaseicmsstitvenda = (  (coalesce(margemvlagritvenda,0) + 100) / 100 )  * (  (coalesce(vlrbaseicmsitvenda,0) ) + (coalesce(vlripiitvenda,0)) );
                end
                else
                begin
                    -- Quando no h reduo na base do icms st deve usar o valor da base bruto (rem reduo)
                    vlrbaseicmsstitvenda = (  (coalesce(margemvlagritvenda,0) + 100) / 100 )  * (  (coalesce(vlrbaseicmsbrutitvenda,0) ) + (coalesce(vlripiitvenda,0)) );
                end
    
                VLROUTRASITVENDA = 0;
                VLRISENTASITVENDA = 0;
                VLRICMSSTITVENDA = ( (:VLRBASEICMSSTITVENDA * :PERCICMSST) / 100 ) - (:VLRICMSITVENDA) ;
            end
            --Calculo do ICMS ST para o mato grosso.
            else
            begin
                if(percred>0 and redbaseicmsst='S') then
                begin
                   vlricmsstcalc=0;
                -- Quando h reduo na base do icms st , deve usar o valor da base do icms proprio como parametro
                   vlricmsstcalc = ( (coalesce(vlrbaseicmsitvenda,0) + coalesce(vlripiitvenda,0) ) * (coalesce(aliqicmsstcm,0)/100) );
                   vlrbaseicmsstitvenda =   (vlricmsitvenda + vlricmsstcalc)/(PERCICMSST/100);
                   

                end
                else
                begin
                    -- Quando no h reduo na base do icms st deve usar o valor da base bruto (rem reduo)
                    vlricmsstcalc = ( (coalesce(vlrbaseicmsbrutitvenda,0) + coalesce(vlripiitvenda,0) ) * (coalesce(aliqicmsstcm,0)/100)  );
                    
                    vlrbaseicmsstitvenda = ((vlricmsitvenda  + vlricmsstcalc )/(:PERCICMSST/100));
                  
                end

           
                VLROUTRASITVENDA = 0;
                VLRISENTASITVENDA = 0;
                VLRICMSSTITVENDA = ( (coalesce(vlrbaseicmsitvenda,0) + coalesce(vlripiitvenda,0) ) * (coalesce(aliqicmsstcm,0)/100)  );
           

            end 
        end
    end

    -- Se produto no for tributado e no isento

    else if (:TIPOFISC = 'NN') then
    begin
        VLROUTRASITVENDA = :VLRLIQITVENDA;
        VLRBASEICMSITVENDA = 0;
        PERCICMSITVENDA = 0;
        VLRICMSITVENDA = 0;
        VLRISENTASITVENDA = 0;
    end

    -- Se produto for tributado integralmente

    else if (:TIPOFISC = 'TT') then
    begin
        VLROUTRASITVENDA = 0;
        VLRISENTASITVENDA = 0;
    end

    -- Inserindo dados na tabela de tens de venda

    if ( TPAGRUP <> 'F' ) then
    begin

        insert into vditvenda (codemp,codfilial,codvenda,tipovenda,coditvenda,codempnt,codfilialnt,codnat,codemppd,
        codfilialpd,codprod,codemple,codfilialle,codlote,qtditvenda,precoitvenda,percdescitvenda,vlrdescitvenda,
        percicmsitvenda,vlrbaseicmsitvenda,vlricmsitvenda,percipiitvenda,vlrbaseipiitvenda,vlripiitvenda,vlrliqitvenda,
        vlrproditvenda,refprod,origfisc,codemptt,codfilialtt,codtrattrib,tipofisc,codempme,codfilialme,codmens,obsitvenda,
        codempax,codfilialax,codalmox,perccomisitvenda,vlrcomisitvenda,codempif,codfilialif,codfisc,coditfisc,percissitvenda,
        vlrbaseissitvenda,vlrissitvenda,vlrisentasitvenda,vlroutrasitvenda,tipost,vlrbaseicmsstitvenda,vlricmsstitvenda,
        margemvlagritvenda,vlrbaseicmsbrutitvenda, calcstcm)
        values (:ICODEMP,:ICODFILIAL,:ICODVENDA,:STIPOVENDA,:ICODITVENDA,:ICODEMP,
        :ICODFILIALNT,:SCODNAT,:ICODEMP,:ICODFILIALPD,:ICODPROD,:ICODEMP,:ICODFILIALPD,:SCODLOTE,:IQTDITVENDA,
        :VLRPRECOITVENDA,:PERCDESCITVENDA,:VLRDESCITVENDA,:PERCICMSITVENDA,:VLRBASEICMSITVENDA,:VLRICMSITVENDA,
        :PERCIPIITVENDA,:VLRBASEIPIITVENDA,:VLRIPIITVENDA,:VLRLIQITVENDA,:VLRPRODITVENDA,:SREFPROD,:SORIGFISC,
        :ICODEMP,:ICODFILIALTT,:SCODTRATTRIB,:TIPOFISC,:ICODEMP,:ICODFILIALME,:ICODMENS,:OBSITORC,
        :CODEMPAX,:CODFILIALAX,:CODALMOX,:perccomisitvenda,:vlrcomisitvenda,:CODEMPIF,:CODFILIALIF,:CODFISC,:CODITFISC,
        :PERCISSITVENDA,:VLRBASEISSITVENDA,:VLRISSITVENDA,:VLRISENTASITVENDA,:VLROUTRASITVENDA,:TIPOST,
        :VLRBASEICMSSTITVENDA,:VLRICMSSTITVENDA,:MARGEMVLAGRITVENDA,:vlrbaseicmsbrutitvenda, :calcstcm);
    end

-- Atualizando informaes de vnculo

    execute procedure vdupvendaorcsp(:ICODEMP,:ICODFILIAL,:ICODORC,:ICODITORC,:ICODFILIAL,:ICODVENDA,:ICODITVENDA,:STIPOVENDA);

end ^

CREATE OR ALTER PROCEDURE VDADICVENDAORCSP (
    codemp integer,
    codfilial smallint,
    codorc integer,
    codfilialvd integer,
    tipovenda char(1),
    codvenda integer,
    dtsaidavenda date)
returns (
    iret integer)
as
declare variable icodtipomov integer;
declare variable ifilialtm smallint;
declare variable sserie char(4);
declare variable ifilialse smallint;
declare variable sstatusvenda char(2);
declare variable dperccomvend numeric(9,2);
declare variable icodvend integer;
declare variable icodcli integer;
declare variable icodfilialcl integer;
declare variable icodplanopag integer;
declare variable icodfilialpg integer;
declare variable iconta integer;
declare variable icodclcomis integer;
declare variable icodfilialcm integer;
declare variable vlrfreteorc numeric(15,5);
declare variable codemptn integer;
declare variable codfilialtn smallint;
declare variable codtran integer;
declare variable tipofrete char(1);
declare variable adicfrete char(1);
declare variable codfilialpf smallint;
BEGIN

/*Cod. Tipo Mov e Sequencia:*/
  SELECT ICODFILIAL FROM SGRETFILIAL(:CODEMP,'SGPREFERE1') INTO CODFILIALPF;
  SELECT ICODFILIAL FROM SGRETFILIAL(:CODEMP,'EQTIPOMOV') INTO IFILIALTM;
  SELECT COUNT(P.TIPOPROD) FROM EQPRODUTO P, VDITORCAMENTO I WHERE
    P.CODPROD=I.CODPROD AND P.CODFILIAL=I.CODFILIALPD AND P.CODEMP=I.CODEMPPD
    AND P.TIPOPROD = 'S' AND I.CODORC=:CODORC
    AND I.CODFILIAL=:CODFILIAL AND I.CODEMP=:CODEMP INTO ICONTA;
    
  IF (ICONTA > 0) THEN
    SELECT CODTIPOMOV4 FROM SGPREFERE1
      WHERE CODEMP=:CODEMP AND CODFILIAL=:CODFILIALPF
      INTO ICODTIPOMOV;
  IF (ICODTIPOMOV IS NULL) THEN  /* CASO AINDA O IF DE CIMA NAO TENHA PREECHIDO... */
    SELECT CODTIPOMOV3 FROM SGPREFERE1
      WHERE CODEMP=:CODEMP AND CODFILIAL=:CODFILIALPF
      INTO ICODTIPOMOV;

/*Informaes basicas:*/

/*Serie:*/
  SELECT ICODFILIAL FROM SGRETFILIAL(:CODEMP,'LFSERIE') INTO IFILIALSE;
  SELECT SERIE FROM EQTIPOMOV WHERE CODEMP=:CODEMP AND CODFILIAL=:IFILIALTM AND CODTIPOMOV=:ICODTIPOMOV INTO SSERIE;

/*Status:*/
  SSTATUSVENDA = 'P1';

/*Busca no oramento:*/
  SELECT O.CODFILIALVD,O.CODVEND,O.CODFILIALCL,O.CODCLI,O.CODFILIALPG,
    O.CODPLANOPAG,VE.PERCCOMVEND,O.CODCLCOMIS,O.CODFILIALCM
    , coalesce(O.VLRFRETEORC,0), O.CODEMPTN, O.CODFILIALTN, O.CODTRAN
    , o.tipofrete, o.adicfrete
    FROM VDORCAMENTO O, VDVENDEDOR VE WHERE O.CODORC=:CODORC
    AND O.CODFILIAL=:CODFILIAL AND O.CODEMP=:CODEMP
    AND VE.CODEMP=O.CODEMP AND VE.CODFILIAL=O.CODFILIALVD
    AND VE.CODVEND=O.CODVEND INTO
           :CODFILIALVD,:ICODVEND,:ICODFILIALCL,:ICODCLI
           ,:ICODFILIALPG,:ICODPLANOPAG,DPERCCOMVEND,:ICODCLCOMIS
           ,:ICODFILIALCM, :VLRFRETEORC
           ,:CODEMPTN, :CODFILIALTN, :CODTRAN
           , :TIPOFRETE, :adicfrete;

  INSERT INTO VDVENDA (
    CODEMP,CODFILIAL,CODVENDA,TIPOVENDA,CODEMPVD,CODFILIALVD,CODVEND,CODEMPCL,CODFILIALCL,CODCLI,
    CODEMPPG,CODFILIALPG,CODPLANOPAG,CODEMPSE,CODFILIALSE,SERIE,CODEMPTM,CODFILIALTM,CODTIPOMOV,
    DTSAIDAVENDA,DTEMITVENDA,STATUSVENDA,PERCCOMISVENDA,CODCLCOMIS,CODFILIALCM,CODEMPCM)
    VALUES (
    :CODEMP,:CODFILIALVD,:CODVENDA,:TIPOVENDA,:CODEMP,:CODFILIALVD,:ICODVEND,:CODEMP,:ICODFILIALCL,:ICODCLI,
    :CODEMP,:ICODFILIALPG,:ICODPLANOPAG,:CODEMP,:IFILIALSE,:SSERIE,:CODEMP,:IFILIALTM,:ICODTIPOMOV,
    :DTSAIDAVENDA,CAST('today' AS DATE),:SSTATUSVENDA,:DPERCCOMVEND,:ICODCLCOMIS,:ICODFILIALCM,:CODEMP
    );

  if ( (:codtran is not null) or (:vlrfreteorc>0) )  then
  begin
     insert into vdfretevd (codemp, codfilial, tipovenda, codvenda, codemptn
        , codfilialtn, codtran, tipofretevd, vlrfretevd, adicfretevd
        , placafretevd, vlrsegfretevd, pesobrutvd, pesoliqvd
        , espfretevd, marcafretevd, qtdfretevd, uffretevd
         )
        values (:codemp, :codfilialvd, :tipovenda, :codvenda, :codemptn
        , :codfilialtn, :codtran, :tipofrete,  :vlrfreteorc, :adicfrete
        , '***-***', 0, 0, 0
        , 'Volume', '*', 0, '**' );

  end

  IRET = CODVENDA;

  SUSPEND;
END^

ALTER PROCEDURE VDATUDESCVENDAORCSP (CODEMPVD INTEGER,
CODFILIALVD SMALLINT,
TIPOVENDA CHAR(1),
CODVENDA INTEGER)
AS 
 

declare variable vlrdescorc numeric(15,5);
declare variable vlrtotdesc numeric(15,5) = 0;
declare variable codorc integer;
declare variable conta1 numeric(15,5);
declare variable statusorc char(2);
declare variable conta2 numeric(15,5);
declare variable codempoc integer;
declare variable codfilialoc smallint;
declare variable tipoorc char(1);
begin
    -- verifica a quantidade total do oramneto vinculado a venda
    select first 1 oc.codemp, oc.codfilial, oc.tipoorc, oc.codorc, oc.statusorc, sum(iv.qtditvenda)
      from vdorcamento oc, vdvendaorc vo, vditorcamento itoc, vditvenda iv
        where vo.codemp=:codempvd and vo.codfilial=:codfilialvd and
          vo.tipovenda=:tipovenda and vo.codvenda=:codvenda and
          oc.codemp=vo.codempor and oc.codfilial=vo.codfilialor and
          oc.tipoorc=vo.tipoorc and oc.codorc=vo.codorc and
          itoc.codemp=oc.codemp and itoc.codfilial=oc.codfilial and
          itoc.tipoorc=oc.tipoorc and itoc.codorc=oc.codorc and
          itoc.coditorc=vo.coditorc and
          iv.codemp=vo.codemp and iv.codfilial=vo.codfilial and
          iv.tipovenda=vo.tipovenda and iv.codvenda=vo.codvenda and
          iv.coditvenda=vo.coditvenda
        group by oc.codemp, oc.codfilial, oc.tipoorc, oc.codorc, oc.statusorc
        into :codempoc, :codfilialoc, :tipoorc, :codorc, :statusorc, :conta1;

    if (:statusorc not in ('FP') ) then
    begin
        -- verifica a quantidade total do oramento
        select sum(qtditorc) from vditorcamento it
          where codemp=:codempoc and codfilial=:codfilialoc and
          tipoorc=:tipoorc and codorc=:codorc
          into :conta2;
        if (conta1=conta2) then
        begin
            -- Buscando desconto nos oramentos dessa venda
            for select vo.codorc, oc.vlrdescorc from vdvendaorc vo, vdorcamento oc
            where
              vo.codemp=:CODEMPVD and vo.codfilial=:CODFILIALVD and vo.tipovenda=:TIPOVENDA and vo.codvenda=:CODVENDA and
              oc.codemp=vo.codempor and oc.codfilial=vo.codfilial and oc.tipoorc=vo.tipoorc and oc.codorc=vo.codorc
            group by 1,2
            into :codorc,:vlrdescorc
            do
            begin
                VLRTOTDESC = :VLRTOTDESC + :VLRDESCORC;
            end
            -- Atualizando desconto na venda
            if(:VLRTOTDESC is not null and :VLRTOTDESC>0) then
            begin
               --update vdvenda set vlrdescvenda = :VLRTOTDESC
               --where codemp=:CODEMPVD and codfilial=:CODFILIALVD and tipovenda=:TIPOVENDA and codvenda=:CODVENDA;
            end
        end
    end
end ^

ALTER PROCEDURE VDBAIXACOMISSAOSP (STIPO CHAR(1),
DINI DATE,
DFIM DATE,
ICODVEND INTEGER,
ICODEMPVD INTEGER,
ICODFILIALVD SMALLINT,
SCODCONTA CHAR(10),
ICODEMPCA INTEGER,
ICODFILIALCA SMALLINT,
SCODPLAN CHAR(13),
ICODEMPPN INTEGER,
ICODFILIALPN SMALLINT,
DDATA DATE,
IDOC INTEGER,
DVLR NUMERIC(15, 5),
SOBS CHAR(50),
ICODEMP INTEGER,
ICODFILIAL SMALLINT)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

declare variable icodpcomi integer;
declare variable icodcomi integer;
declare variable icodempcomi integer;
declare variable icodfilialcomi integer;
declare variable cflag char(1);
declare variable ifilialpcomi integer;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(:ICODEMP,'FNPAGTOCOMI') INTO IFILIALPCOMI;
  SELECT ISEQ FROM SPGERANUM(:ICODEMP,:IFILIALPCOMI,'CI') INTO ICODPCOMI;
  INSERT INTO FNPAGTOCOMI(CODEMP,CODFILIAL,CODPCOMI,CODEMPCA,CODFILIALCA,NUMCONTA,CODEMPPN,CODFILIALPN,CODPLAN,DTCOMPPCOMI,DATAPCOMI,DOCPCOMI,VLRPCOMI,OBSPCOMI)
         VALUES (
                :ICODEMP,:IFILIALPCOMI,:iCodPComi,:ICODEMPCA,:ICODFILIALCA,:sCodConta,:ICODEMPPN,:ICODFILIALPN,:sCodPlan,:dData,:dData,:iDoc,:dVlr,:sObs
         );
  FOR SELECT C.CODCOMI,C.CODEMP,C.CODFILIAL,C.FLAG FROM VDCOMISSAO C,FNRECEBER R WHERE R.CODVEND=:iCodVend
               AND R.CODEMPVD=:ICODEMPVD AND R.CODFILIALVD=:ICODFILIALVD
               AND C.CODREC=R.CODREC AND C.CODEMPRC=R.CODEMP AND C.CODFILIALRC=R.CODFILIAL
               AND ( (:STIPO='E') OR  (C.DTVENCCOMI BETWEEN :dIni AND :dFim) )
               AND ( (:STIPO='V') OR  (C.DATACOMI BETWEEN :dIni AND :dFim) )
               AND STATUSCOMI='C2'
               AND R.CODEMP=:ICODEMP AND R.CODFILIAL=:ICODFILIAL
               INTO :iCodComi,:iCodEmpComi,:iCodFilialComi,:cFLAG DO
  BEGIN
     UPDATE VDCOMISSAO SET VLRPAGOCOMI=VLRAPAGCOMI, CODPCOMI=:iCodPComi,CODEMPCI=:ICODEMP,
        CODFILIALCI=:IFILIALPCOMI,STATUSCOMI='CP',DTPAGTOCOMI=:dData,FLAG=:cFLAG
      WHERE CODCOMI=:iCodComi AND CODEMP=:iCodEmpComi AND CODFILIAL=:iCodFilialComi;
  END
END ^

ALTER PROCEDURE VDBLOQVENDASP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
CTIPOVENDA CHAR(1),
ICODVENDA INTEGER,
CBLOQVENDA CHAR(1))
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

begin
  /* Stored procedure de bloqueio e desbloqueio de venda*/
  UPDATE VDVENDA SET EMMANUT='S', BLOQVENDA=:CBLOQVENDA WHERE CODEMP=:ICODEMP AND
     CODFILIAL=:SCODFILIAL AND TIPOVENDA=:CTIPOVENDA AND CODVENDA=:ICODVENDA;
  UPDATE VDVENDA SET EMMANUT='N' WHERE CODEMP=:ICODEMP AND
     CODFILIAL=:SCODFILIAL AND TIPOVENDA=:CTIPOVENDA AND CODVENDA=:ICODVENDA;
  suspend;
end ^

ALTER PROCEDURE VDBUSCACUSTOVENDASP (CODEMPVD INTEGER,
CODFILIALVD SMALLINT,
CODVENDA INTEGER,
TIPOVENDA CHAR(1),
CODEMPOC INTEGER,
CODFILIALOC INTEGER,
CODORC INTEGER,
TIPOORC CHAR(1),
CODITORC INTEGER)
RETURNS (VLRPROD NUMERIC(15, 5),
VLRDESC NUMERIC(15, 5),
VLRICMS NUMERIC(15, 5),
VLROUTRAS NUMERIC(15, 5),
VLRCOMIS NUMERIC(15, 5),
VLRADIC NUMERIC(15, 5),
VLRIPI NUMERIC(15, 5),
VLRPIS NUMERIC(15, 5),
VLRCOFINS NUMERIC(15, 5),
VLRIR NUMERIC(15, 5),
VLRCSOCIAL NUMERIC(15, 5),
VLRFRETE NUMERIC(15, 5),
TIPOFRETE CHAR(1),
ADICFRETE CHAR(1),
VLRCUSTOPEPS NUMERIC(15, 5),
VLRCUSTOMPM NUMERIC(15, 5),
VLRPRECOULTCP NUMERIC(15, 5))
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

declare variable aliqicms numeric(9,2);
declare variable aliqipi numeric(9,2);
declare variable aliqpis numeric(9,2);
declare variable aliqir numeric(9,2);
declare variable aliqcofins numeric(9,2);
declare variable aliqcsocial numeric(9,2);
declare variable codemppd integer;
declare variable codfilialpd smallint;
declare variable codprod integer;
declare variable codemptm integer;
declare variable codfilialtm smallint;
declare variable codtipomov integer;
declare variable codfilialpf smallint;
declare variable codempcl integer;
declare variable codfilialcl smallint;
declare variable codcli integer;
declare variable vlrliq numeric(15,5);
declare variable redbase numeric(9,2);
declare variable base numeric(15,5);
declare variable ufcli char(2);
declare variable codtrattrib char(2);
declare variable comisprod numeric(6,2);
declare variable perccomvend numeric(6,2);
declare variable codnat char(4);
declare variable codregra char(4);
begin

    --Verifica se deve buscar custos para venda .
    if(:CODVENDA is not null) then
    begin

        select
            coalesce(vd.vlrprodvenda,0), coalesce(vd.vlrdescvenda,0), coalesce(vd.vlricmsvenda,0),
            coalesce(vd.vlroutrasvenda,0), coalesce(vd.vlrcomisvenda,0), coalesce(vd.vlradicvenda,0),
            coalesce(vd.vlripivenda,0), coalesce(vd.vlrpisvenda,0), coalesce(vd.vlrcofinsvenda,0),
            coalesce(vd.vlrirvenda,0), coalesce(vd.vlrcsocialvenda,0),
            coalesce(fr.vlrfretevd,0), fr.tipofretevd, fr.adicfretevd,
            
            sum(icv.vlrcustopeps * iv.qtditvenda),
            sum(icv.vlrcustompm * iv.qtditvenda),
            sum(icv.vlrprecoultcp * iv.qtditvenda)
            
            from
            vdvenda vd left outer join vdfretevd fr on
            fr.codemp=vd.codemp and fr.codfilial=vd.codfilial and fr.codvenda=vd.codvenda and fr.tipovenda=vd.tipovenda,
            
            vditvenda iv left outer join vditcustovenda icv on
            icv.codemp=iv.codemp and icv.codfilial=iv.codfilial and icv.codvenda = iv.codvenda
            and icv.tipovenda=iv.tipovenda and icv.coditvenda=iv.coditvenda
            
            where vd.codemp=:CODEMPVD and vd.codfilial=:CODFILIALVD and vd.codvenda=:CODVENDA and vd.tipovenda=:TIPOVENDA and
            iv.codemp=vd.codemp and iv.codfilial=vd.codfilial and iv.tipovenda=vd.tipovenda and iv.codvenda=vd.codvenda
            
            group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14

            into vlrprod,vlrdesc,vlricms,vlroutras,vlrcomis,vlradic,vlripi,vlrpis,vlrcofins,vlrir,vlrcsocial,
                 vlrfrete,tipofrete,adicfrete,vlrcustopeps,vlrcustompm,vlrprecoultcp;

            suspend;

    end
    else
    begin
        --Buscando informaes sobre o produto do item de oramento
        select io.codemppd,io.codfilialpd,io.codprod,pd.comisprod,
        coalesce(io.vlrproditorc,0),coalesce(io.vlrdescitorc,0),coalesce(io.vlrliqitorc,0),
        ico.vlrcustopeps * io.qtditorc, ico.vlrcustompm * io.qtditorc, ico.vlrprecoultcp * io.qtditorc,
        cf.codregra
        from lfclfiscal cf, eqproduto pd, vditorcamento io left outer join vditcustoorc ico on
        ico.codemp=io.codemp and ico.codfilial=io.codfilial and ico.codorc = io.codorc and
        ico.tipoorc=io.tipoorc and ico.coditorc=io.coditorc
        where io.codemp=:CODEMPOC and io.codfilial=:CODFILIALOC and io.codorc=:CODORC and io.tipoorc=:TIPOORC and io.coditorc=:CODITORC and
        pd.codemp=io.codemppd and pd.codfilial=io.codfilial and pd.codprod=io.codprod and
        cf.codemp=pd.codempfc and cf.codfilial=pd.codfilialfc and cf.codfisc=pd.codfisc
        into :CODEMPPD,:CODFILIALPD,:CODPROD,:VLRPROD,:VLRDESC,:VLRLIQ,:COMISPROD,:VLRCUSTOPEPS,:VLRCUSTOMPM,:VLRPRECOULTCP,:CODREGRA;

        -- Buscanco informaes do oramento,cliente,vendedor
        select oc.codempcl,oc.codfilialcl,oc.codcli,coalesce(cl.siglauf,cl.ufcli),vd.perccomvend,
        oc.tipofrete,oc.adicfrete
        from vdorcamento oc, vdcliente cl, vdvendedor vd
        where oc.codemp=:CODEMPOC and oc.codfilial=:CODFILIALOC and oc.tipoorc=:TIPOORC and oc.codorc=:CODORC and
        cl.codemp=oc.codempcl and cl.codfilial=oc.codfilialcl and cl.codcli=oc.codcli and
        vd.codemp=oc.codempvd and vd.codfilial=oc.codfilialvd and vd.codvend=oc.codvend
        into :CODEMPCL,:CODFILIALCL,:CODCLI,:UFCLI,:PERCCOMVEND,:TIPOFRETE,:ADICFRETE;

        --Buscando o tipo de movimento a ser utilizado na venda futura
        select p1.codempt2,p1.codfilialt2,p1.codtipomov2 from sgprefere1 p1
        where p1.codemp=:CODEMPOC and p1.codfilial=:CODFILIALPF
        into :CODEMPTM,:CODFILIALTM,:CODTIPOMOV;

        -- Buscando natureza de operao da venda futura
        select first 1 nt.codnat from lfnatoper nt, lfitregrafiscal irf
        where nt.codemp=irf.codemp and nt.codfilial=irf.codfilial and nt.codnat=irf.codnat
        and (irf.codtipomov=:CODTIPOMOV or irf.codtipomov is null)
        and (irf.codemp=:CODEMPTM or irf.codemp is null)
        and (irf.codfilial=:CODFILIALTM or irf.codfilial is null)
        and irf.codregra=:CODREGRA and irf.noufitrf='N' and irf.cvitrf='V'
        into :CODNAT;

         -- Buscando informaes fiscais
        select codtrattrib,coalesce(aliqfisc,0),coalesce(aliqipifisc,0),coalesce(aliqpis,0),coalesce(aliqcofins,0),coalesce(aliqcsocial,0),
        coalesce(aliqir,0),coalesce(redfisc,0)
        from lfbuscafiscalsp(:CODEMPPD,:CODFILIALPD,:CODPROD,:CODEMPCL,:CODFILIALCL,:CODCLI,:CODEMPTM,:CODFILIALTM,
        :CODTIPOMOV,'VD',:codnat,null,null,null,null)
        into :CODTRATTRIB,:ALIQICMS,:ALIQIPI,:ALIQPIS,:ALIQCOFINS,:ALIQCSOCIAL,:ALIQIR,:REDBASE;

        -- Caso o ICMS no seja definido na classifificao, buscar da tabela de aliquotas.
        if(:ALIQICMS = 0 and :CODTRATTRIB in('00','51','20','70','10') ) then
        begin
            select coalesce(PERCICMS,0) from lfbuscaicmssp (:CODNAT,:UFCLI,:CODEMPOC,:CODFILIALPF)
            into :ALIQICMS;
        end

        -- Buscando custo do tem

        if(:REDBASE >0) then
        begin
            BASE = :VLRLIQ - ((:VLRLIQ * :REDBASE) /100 );
        end

        BASE = :VLRLIQ;

        vlricms = :BASE * :ALIQICMS / 100;

--      vlroutras =
        vlrcomis = :VLRLIQ * ((:COMISPROD * :PERCCOMVEND) / 10000 );

--      vlradic =
        vlripi = :VLRLIQ * :ALIQIPI / 100;
        vlrpis = :VLRLIQ * :ALIQCOFINS / 100;
        vlrcofins = :VLRLIQ * :ALIQCOFINS / 100;
        vlrir = :VLRLIQ * :ALIQIR /100;
        vlrcsocial = :VLRLIQ * :ALIQCSOCIAL / 100;
--      vlrfrete =

    end

end ^

ALTER PROCEDURE VDBUSCAPRECOSP (ICODPROD INTEGER,
ICODCLI INTEGER,
ICODEMPCL INTEGER,
ICODFILIALCL SMALLINT,
ICODPLANOPAG INTEGER,
ICODEMPPG INTEGER,
ICODFILIALPG SMALLINT,
ICODTIPOMOV INTEGER,
ICODEMPTM INTEGER,
ICODFILIALTM SMALLINT,
ICODEMP INTEGER,
ICODFILIAL SMALLINT)
RETURNS (PRECO NUMERIC(14, 5),
CODCLASCLIP INTEGER,
CODPLANOPAGP INTEGER,
CODPRECOPRODP INTEGER,
CODTABP INTEGER)
AS 

declare variable icodtab integer;
declare variable icodemptab integer;
declare variable icodfilialtab smallint;
declare variable icodclascli integer;
declare variable icodempclascli integer;
declare variable icodfilialclascli smallint;
declare variable percdesccli numeric(3,2);
declare variable desccli char(1);
declare variable arredpreco smallint;
declare variable codfilialpf integer;
declare variable centavos decimal(2,2);
declare variable precobase decimal(15,5);

begin
    -- Buscando cdigo da filial de preferencias
    select icodfilial from sgretfilial(:icodemp,'SGFILIAL') into :codfilialpf;

    -- Buscando preferencias de arredondamento;
    select coalesce(arredpreco, 0)
    from sgprefere1 p1
    where p1.codemp=:icodemp and p1.codfilial=:codfilialpf
    into :arredpreco;

    -- Buscando tabela de preos do tipo de movimento;
    select codtab, codemptb, codfilialtb
    from eqtipomov
    where codtipomov=:icodtipomov and codemp=:icodemptm and codfilial=:icodfilialtm
    into :icodtab, :icodemptab, :icodfilialtab;


    -- Buscando informaes do produto
    select coalesce(pd.desccli,'N'), coalesce(precobaseprod,0) from eqproduto pd
        where pd.codprod=:icodprod and pd.codemp=:icodemp and pd.codfilial=:icodfilial
        into :desccli, :precobase;

    -- Buscando informaes do cliente
        
    select codclascli, codempcc, codfilialcc, coalesce(percdesccli,0) percdesccli
    from vdcliente
    where codcli=:icodcli and codemp=:icodempcl and codfilial=:icodfilialcl
    into :icodclascli, :icodempclascli, icodfilialclascli, :percdesccli;

     -- Buscando preo da tabela de preos utilizando todos os filtros exceto tabela de preos
    for select pp.codclascli, pp.codplanopag, pp.codtab, pp.codprecoprod, pp.precoprod
    from vdprecoprod pp
    where pp.codemp=:icodemp and pp.codfilial=:icodfilial and pp.codprod=:icodprod
    and pp.ativoprecoprod='S'
    and ( ( pp.codplanopag is null ) or (pp.codemppg=:icodemppg and pp.codfilialpg=:icodfilialpg and pp.codplanopag=:icodplanopag ) )
    and ( ( pp.codclascli is null) or (pp.codempcc=:icodempclascli and pp.codfilialcc=:icodfilialclascli and pp.codclascli=:icodclascli ) )
    order by pp.codclascli, pp.codplanopag, pp.codtab, pp.codprecoprod
    into :codclasclip, :codplanopagp, :codtabp, :codprecoprodp, :preco do
    begin
        --exception vdvendaex01 'Teste';

        if ( (:preco is not null) or (:preco <> 0) ) then
        begin
            --suspend;
            break;
        end
    end

    -- Buscando preo da tabela de preos especfica
    if ( (:preco is null) or (:preco = 0) ) then
    begin

        for select pp.codclascli, pp.codplanopag, pp.codtab, pp.codprecoprod, pp.precoprod
        from vdprecoprod pp
        where pp.codemp=:icodemp and pp.codfilial=:icodfilial and pp.codprod=:icodprod
        and pp.ativoprecoprod='S'
        and pp.codemptb=:icodemptab and pp.codfilialtb=:icodfilialtab and pp.codtab=:icodtab
        order by pp.codclascli, pp.codplanopag, pp.codtab, pp.codprecoprod
        into :codclasclip, :codplanopagp, :codtabp, :codprecoprodp, :preco do
        begin
            --exception vdvendaex01 'Teste';

            if ( (:preco is not null) or (:preco <> 0) ) then
            begin
               --suspend;
               break;
            end
        end
    end

    --Se ainda no conseguiu pagar o preco, deve utilizar o preo base do produto aplicando o desconto especial do cliente se houver
    if ((preco is null) or (preco = 0)) then
    begin
         preco = precobase;
    end

    -- Verifica se o cliente possui desconto especial e o produto permite este desconto...
    if( percdesccli >0 and 'S' = :desccli ) then
    begin
         preco = :preco - (:preco * (:percdesccli / 100)) ;
    end

    if( :arredpreco > 0 ) then
    begin

        -- capturando valor dos centavos
        centavos = ( cast(:preco as decimal(15,2)) - truncate(preco) ) * 10;

        -- se o valor em centavos  maior ou igual ao parametro de arredondamento (arredondar para cima)
        if(:centavos >= :arredpreco) then
        begin
            preco = truncate(preco) + 1;
        end
        else
        begin
            preco = truncate(preco);
        end

    end

    suspend;

end ^

ALTER PROCEDURE VDCLIENTEATIVOSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODCLI INTEGER)
AS 
DECLARE VARIABLE CATIVOCLI CHAR(1);
DECLARE VARIABLE SITREVCLI CHAR(1);
begin
  SELECT ATIVOCLI, COALESCE(SITREVCLI,'N') FROM VDCLIENTE WHERE CODEMP=:ICODEMP AND
    CODFILIAL=:SCODFILIAL AND CODCLI=:ICODCLI
    INTO :CATIVOCLI, SITREVCLI;
  IF ( (CATIVOCLI IS NOT NULL) AND (CATIVOCLI='N') ) then
     exception vdvendaex01 'CLIENTE INATIVO!';
  IF ( SITREVCLI='O' ) then
     exception vdvendaex01 ' OBRIGATRIA A REVISO CADASTRAL DO CLIENTE !!!';
  suspend;
end ^

ALTER PROCEDURE VDCONTRATOTOTSP (CODEMPCT INTEGER,
CODFILIALCT SMALLINT,
CODCONTR INTEGER,
CODITCONTR INTEGER,
CODEMPSC INTEGER,
CODFILIALSC SMALLINT,
CODCONTRSC INTEGER,
CODEMPTA INTEGER,
CODFILIALTA SMALLINT,
CODTAREFA INTEGER,
CODEMPST INTEGER,
CODFILIALST SMALLINT,
CODTAREFAST INTEGER,
DATAINI DATE,
DATAFIM DATE)
RETURNS (TOTALPREVGERAL NUMERIC(15, 5),
TOTALPREVPER NUMERIC(15, 5),
TOTALGERAL NUMERIC(15, 5),
TOTALCOBCLIGERAL NUMERIC(15, 5),
TOTALANT NUMERIC(15, 5),
TOTALCOBCLIANT NUMERIC(15, 5),
TOTALPER NUMERIC(15, 5),
TOTALCOBCLIPER NUMERIC(15, 5),
SALDOANT NUMERIC(15, 5),
SALDOPER NUMERIC(15, 5))
AS 

begin
  if (:codcontrsc is not null) then
  begin
     codempct = codempsc;
     codfilialct = codfilialsc;
     codcontr = codcontrsc;
  end
  if (:codtarefast is not null) then
  begin
     codempta = codempst;
     codfilialta = codfilialst;
     codtarefa = codtarefast;
  end
  select sum(a.totalgeral), sum(a.totalcobcli)
   from atatendimentovw02 a
    left outer join crtarefa ta
      on ta.codemp=a.codempta and ta.codfilial=a.codfilialta and ta.codtarefa=a.codtarefa
    left outer join crtarefa st
      on st.codempta=ta.codemp and st.codfilialta=ta.codemp and st.codtarefata=ta.codtarefa
    where a.codempct=:codempct and a.codfilialct=:codfilialct and a.codcontr=:codcontr and
    (:coditcontr is null or a.coditcontr=:coditcontr) and
    (
       (:codtarefa is null) or
       (st.codtarefa is null and ta.codemp=:codempta and ta.codfilial=:codfilialta and ta.codtarefa=:codtarefa ) or
       (st.codtarefa is not null and st.codempta=:codempta and st.codfilialta=:codfilialta and st.codtarefata=:codtarefa )
    )
  into :totalgeral,  :totalcobcligeral;

  select sum(a.totalgeral), sum(a.totalcobcli)
   from atatendimentovw02 a
    left outer join crtarefa ta
      on ta.codemp=a.codempta and ta.codfilial=a.codfilialta and ta.codtarefa=a.codtarefa
    left outer join crtarefa st
      on st.codempta=ta.codemp and st.codfilialta=ta.codemp and st.codtarefata=ta.codtarefa
    where a.codempct=:codempct and a.codfilialct=:codfilialct and a.codcontr=:codcontr and
    (:coditcontr is null or a.coditcontr=:coditcontr) and
      a.dataatendo between :dataini and :datafim and
    (
       (:codtarefa is null) or
       (st.codtarefa is null and ta.codemp=:codempta and ta.codfilial=:codfilialta and ta.codtarefa=:codtarefa ) or
       (st.codtarefa is not null and st.codempta=:codempta and st.codfilialta=:codfilialta and st.codtarefata=:codtarefa )
    )
  into :totalper,  :totalcobcliper;

  select sum(a.totalgeral), sum(a.totalcobcli)
   from atatendimentovw02 a
    left outer join crtarefa ta
     on ta.codemp=a.codempta and ta.codfilial=a.codfilialta and ta.codtarefa=a.codtarefa
    left outer join crtarefa st
      on st.codempta=ta.codemp and st.codfilialta=ta.codemp and st.codtarefata=ta.codtarefa
    where a.codempct=:codempct and a.codfilialct=:codfilialct and a.codcontr=:codcontr and
    (:coditcontr is null or a.coditcontr=:coditcontr) and
     a.dataatendo < :dataini and
    (
       (:codtarefa is null) or
       (st.codtarefa is null and ta.codemp=:codempta and ta.codfilial=:codfilialta and ta.codtarefa=:codtarefa ) or
       (st.codtarefa is not null and st.codempta=:codempta and st.codfilialta=:codfilialta and st.codtarefata=:codtarefa )
    )
  into :totalant,  :totalcobcliant;

  select sum(coalesce(st.tempodectarefa, ta.tempodectarefa) )
    from crtarefa ta
    left outer join crtarefa st
      on st.codempta=ta.codemp and st.codfilialta=ta.codemp and st.codtarefata=ta.codtarefa
    where ta.codempct=:codempct and ta.codfilialct=:codfilialct and ta.codcontr=:codcontr and
    (:coditcontr is null or ta.coditcontr=:coditcontr) and
    (
       (:codtarefa is null) or
       (st.codtarefa is null and ta.codemp=:codempta and ta.codfilial=:codfilialta and ta.codtarefa=:codtarefa ) or
       (st.codtarefa is not null and st.codempta=:codempta and st.codfilialta=:codfilialta and st.codtarefata=:codtarefa )
    )
  into totalprevgeral;

  select sum(tp.tempodectarefa)
   from crtarefa ttp, crtarefaper tp
    left outer join crtarefa ta
      on ta.codemp=ttp.codempta and ta.codfilial=ttp.codfilialta and ta.codtarefa=ttp.codtarefa
    left outer join crtarefa st
      on st.codempta=ta.codemp and st.codfilialta=ta.codemp and st.codtarefata=ta.codtarefa
    where ttp.codemp=tp.codemp and ttp.codfilial=tp.codfilial and ttp.codtarefa=tp.codtarefa and
      ttp.codempct=:codempct and ttp.codfilialct=:codfilialct and ttp.codcontr=:codcontr and
    (:coditcontr is null or ttp.coditcontr=:coditcontr) and
      tp.dtiniper>=:dataini and tp.dtfimper<=:datafim and
    (
       (:codtarefa is null) or
       (st.codtarefa is null and ta.codemp=:codempta and ta.codfilial=:codfilialta and ta.codtarefa=:codtarefa ) or
       (st.codtarefa is not null and st.codempta=:codempta and st.codfilialta=:codfilialta and st.codtarefata=:codtarefa )
    )
  into :totalprevper;

  if (totalgeral is null) then
      totalgeral = 0;
  if (totalcobcligeral is null) then
      totalcobcligeral = 0;
  if (totalant is null) then
      totalant = 0;
  if (totalcobcliant is null) then
      totalcobcliant = 0;
  if (totalper is null) then
      totalper = 0;
  if (totalcobcliper is null) then
      totalcobcliper = 0;
  saldoant = totalprevgeral - totalcobcliant;
  saldoper = totalprevper - totalcobcliper;

  suspend;
end ^

ALTER PROCEDURE VDCOPIACLIENTE (ICODCLI INTEGER,
IDOCUMENTO VARCHAR(14),
ICODEMP INTEGER,
ICODFILIAL INTEGER)
RETURNS (ICOD INTEGER)
AS 

declare variable inovocod integer;
declare variable usacliseq char(1);
begin
    
  SELECT USACLISEQ FROM SGPREFERE1 WHERE CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL INTO :USACLISEQ;
  IF (:USACLISEQ='S') THEN
      select iseq from spgeranum(:ICODEMP,:ICODFILIAL,'CL') into INOVOCOD;
  ELSE
      SELECT MAX(CODCLI)+1 FROM VDCLIENTE WHERE CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL INTO INOVOCOD;

    INSERT INTO VDCLIENTE (CODEMP, CODFILIAL, CODCLI, RAZCLI, NOMECLI, CODEMPCC, CODFILIALCC,
        CODCLASCLI, CODEMPVD, CODFILIALVD, CODVEND, CODEMPTC, CODFILIALTC, CODTIPOCOB, CODEMPPG,
        CODFILIALPG, CODPLANOPAG, CODEMPTN, CODFILIALTN, CODTRAN, CODEMPBO, CODFILIALBO, CODBANCO,
        CODEMPSR, CODFILIALSR, CODSETOR, CODEMPTI, CODFILIALTI, CODTIPOCLI, CODTPCRED, CODFILIALTR,
        CODEMPTR, CODFISCCLI, CODEMPFC, CODFILIALFC, CODEMPEC, CODFILIALEC, CODTBEC, CODITTBEC, CODEMPHP,
        CODFILIALHP, CODHIST, CODEMPCB, CODFILIALCB, CODCARTCOB, DATACLI, PESSOACLI, ATIVOCLI, CNPJCLI,
        INSCCLI, CPFCLI, RGCLI, SSPCLI, ENDCLI, NUMCLI, COMPLCLI, BAIRCLI, CIDCLI, UFCLI, CEPCLI, DDDCLI,
        FONECLI, RAMALCLI, DDDFAXCLI, FAXCLI, EMAILCLI, EMAILCOB, EMAILENT, EMAILNFECLI, CONTCLI, ENDCOB,
        NUMCOB, COMPLCOB, BAIRCOB, CIDCOB, UFCOB, CEPCOB, DDDFONECOB, FONECOB, DDDFAXCOB, FAXCOB, ENDENT,
        NUMENT, COMPLENT, BAIRENT, CIDENT, UFENT, CEPENT, DDDFONEENT, FONEENT, DDDFAXENT, FAXENT, OBSCLI,
        AGENCIACLI, CODEMPPQ, CODFILIALPQ, CODPESQ, INCRACLI, DTINITR, DTVENCTOTR, NIRFCLI, SIMPLESCLI, DDDCELCLI,
        CELCLI, NATCLI, UFNATCLI, TEMPORESCLI, APELIDOCLI, SITECLI, CODCONTDEB, CODCONTCRED, CODCLICONTAB,
        FOTOCLI, IMGASSCLI, CODMUNIC, SIGLAUF, CODPAIS, CODMUNICENT, SIGLAUFENT, CODPAISENT, CODMUNICCOB,
        SIGLAUFCOB, CODPAISCOB, CODEMPUC, CODFILIALUC, CODUNIFCOD, SUFRAMACLI, PRODRURALCLI, CTOCLI, CODCNAE,
        INSCMUNCLI, PERCDESCCLI, CONTCLICOB, CONTCLIENT, DESCIPI, DDDCELENT, CELENT)
        SELECT :ICODEMP, :ICODFILIAL, :INOVOCOD, RAZCLI, NOMECLI, CODEMPCC, CODFILIALCC, CODCLASCLI, CODEMPVD,
            CODFILIALVD, CODVEND, CODEMPTC, CODFILIALTC, CODTIPOCOB, CODEMPPG, CODFILIALPG, CODPLANOPAG, CODEMPTN,
            CODFILIALTN, CODTRAN, CODEMPBO, CODFILIALBO, CODBANCO, CODEMPSR, CODFILIALSR, CODSETOR, CODEMPTI,
            CODFILIALTI, CODTIPOCLI, CODTPCRED, CODFILIALTR, CODEMPTR, CODFISCCLI, CODEMPFC, CODFILIALFC, CODEMPEC,
            CODFILIALEC, CODTBEC, CODITTBEC, CODEMPHP, CODFILIALHP, CODHIST, CODEMPCB, CODFILIALCB, CODCARTCOB, DATACLI,
            PESSOACLI, ATIVOCLI,

            CASE PESSOACLI
                WHEN 'J' THEN :IDOCUMENTO
            ELSE NULL
            END,

            INSCCLI,

            CASE PESSOACLI
                WHEN 'F' THEN :IDOCUMENTO
            ELSE NULL
            END,

            RGCLI, SSPCLI, ENDCLI, NUMCLI, COMPLCLI, BAIRCLI, CIDCLI,
            UFCLI, CEPCLI, DDDCLI, FONECLI, RAMALCLI, DDDFAXCLI, FAXCLI, EMAILCLI, EMAILCOB, EMAILENT, EMAILNFECLI,
            CONTCLI, ENDCOB, NUMCOB, COMPLCOB, BAIRCOB, CIDCOB, UFCOB, CEPCOB, DDDFONECOB, FONECOB, DDDFAXCOB, FAXCOB,
            ENDENT, NUMENT, COMPLENT, BAIRENT, CIDENT, UFENT, CEPENT, DDDFONEENT, FONEENT, DDDFAXENT, FAXENT, OBSCLI,
            AGENCIACLI, CODEMPPQ, CODFILIALPQ, CODPESQ, INCRACLI, DTINITR, DTVENCTOTR, NIRFCLI, SIMPLESCLI, DDDCELCLI,
            CELCLI, NATCLI, UFNATCLI, TEMPORESCLI, APELIDOCLI, SITECLI, CODCONTDEB, CODCONTCRED, CODCLICONTAB, FOTOCLI,
            IMGASSCLI, CODMUNIC, SIGLAUF, CODPAIS, CODMUNICENT, SIGLAUFENT, CODPAISENT, CODMUNICCOB, SIGLAUFCOB, CODPAISCOB,
            CODEMPUC, CODFILIALUC, CODUNIFCOD, SUFRAMACLI, PRODRURALCLI, CTOCLI, CODCNAE, INSCMUNCLI, PERCDESCCLI, CONTCLICOB,
            CONTCLIENT, DESCIPI, DDDCELENT, CELENT
            FROM VDCLIENTE  VC WHERE VC.CODEMP=:ICODEMP AND VC.CODFILIAL=:ICODFILIAL AND VC.CODCLI = :ICODCLI ;

     ICOD = INOVOCOD;

  suspend;
end ^

ALTER PROCEDURE VDCOPIAORCSP (CODEMP INTEGER,
CODFILIAL INTEGER,
CODORC INTEGER,
CODFILIALCL INTEGER,
CODCLI INTEGER)
RETURNS (IRET INTEGER)
AS 

declare variable icodorc integer;
declare variable icodfilialpf integer;
declare variable cusaorcseq char(1);
declare variable vlrprodorc decimal(15,5);
declare variable percdescorc decimal(9,2);
declare variable vlrdescorc decimal(15,5);
declare variable vlradicorc decimal(15,5);
declare variable vlrdescitorc decimal(15,5);
declare variable vlrliqorc decimal(15,5);
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(:CODEMP, 'SGPREFERE1')
    INTO :ICODFILIALPF;
  SELECT USAORCSEQ FROM SGPREFERE1 P
     WHERE P.CODEMP=:CODEMP AND P.CODFILIAL=:ICODFILIALPF
     INTO :CUSAORCSEQ;
  IF (CUSAORCSEQ='S') THEN
  BEGIN
     SELECT ISEQ FROM SPGERANUM(:CODEMP,:CODFILIAL,'OC') INTO ICODORC;
  END
  ELSE
  BEGIN
     SELECT COALESCE(MAX(O.CODORC),0)+1 FROM VDORCAMENTO O
       WHERE O.CODEMP=:CODEMP AND O.CODFILIAL=:CODFILIAL AND
       O.TIPOORC='O' INTO ICODORC;
  END

  INSERT INTO VDORCAMENTO (CODEMP, CODFILIAL, TIPOORC, CODORC,
    CODEMPAE, CODFILIALAE, CODATEND, CODEMPCV, CODFILIALCV, CODCONV,
    DTORC, DTVENCORC, OBSORC, CODPLANOPAG, CODFILIALPG,
    CODEMPPG, TXT01, CODEMPVD, CODFILIALVD, CODVEND, CODEMPCL, CODFILIALCL,
    CODCLI, CODTPCONV, CODFILIALTC, CODEMPTC, PRAZOENTORC, STATUSORC, VLRFRETEORC, ADICFRETE,
    CODEMPTM, CODFILIALTM, CODTRAN

    )
    SELECT CODEMP, CODFILIAL, 'O', :ICODORC, CODEMPAE, CODFILIALAE,
      CODATEND, CODEMPCV, CODFILIALCV, CODCONV, DTORC, DTVENCORC,
      OBSORC, CODPLANOPAG, CODFILIALPG, CODEMPPG, TXT01, CODEMPVD,
      CODFILIALVD, CODVEND, :CODEMP, :CODFILIALCL, :CODCLI, CODTPCONV,
      CODFILIALTC, CODEMPTC, PRAZOENTORC, '*', VLRFRETEORC, ADICFRETE,
      CODEMPTM, CODFILIALTM, CODTRAN

      FROM VDORCAMENTO WHERE
      CODORC=:CODORC AND CODEMP=:CODEMP AND CODFILIAL=:CODFILIAL;

  INSERT INTO VDITORCAMENTO (CODEMP, CODFILIAL, TIPOORC, CODORC, CODITORC,
    CODEMPPD, CODFILIALPD, CODPROD, QTDITORC, PRECOITORC, PERCDESCITORC,
    VLRDESCITORC, VLRFRETEITORC, VLRPRODITORC, REFPROD, NUMAUTORIZORC, ACEITEITORC,
    APROVITORC, EMITITORC, VENCAUTORIZORC, STRDESCITORC, OBSITORC,
    CODEMPAX, CODFILIALAX, CODALMOX)
    SELECT CODEMP, CODFILIAL, TIPOORC, :ICODORC, CODITORC,
      CODEMPPD, CODFILIALPD, CODPROD, QTDITORC, PRECOITORC, PERCDESCITORC,
      VLRDESCITORC, VLRFRETEITORC, VLRPRODITORC, REFPROD, null, 'N',
      'N', 'N', VENCAUTORIZORC, STRDESCITORC, OBSITORC,
      CODEMPAX, CODFILIALAX, CODALMOX
      FROM VDITORCAMENTO
      WHERE CODORC=:CODORC AND CODEMP=:CODEMP AND CODFILIAL=:CODFILIAL;

  SELECT VLRPRODORC, PERCDESCORC,VLRDESCORC,VLRADICORC,VLRDESCITORC,VLRLIQORC
      FROM VDORCAMENTO WHERE CODORC=:CODORC AND CODEMP=:CODEMP AND
      CODFILIAL=:CODFILIAL
      INTO :VLRPRODORC, :PERCDESCORC, :VLRDESCORC, :VLRADICORC, :VLRDESCITORC, :VLRLIQORC;

  UPDATE VDORCAMENTO SET VLRPRODORC=:VLRPRODORC, PERCDESCORC=:PERCDESCORC,
     VLRDESCORC=:VLRDESCORC, VLRADICORC=:VLRADICORC,
     VLRDESCITORC=:VLRDESCITORC, VLRLIQORC=:VLRLIQORC
     WHERE CODORC=:ICODORC AND CODEMP=:CODEMP AND CODFILIAL=:CODFILIAL;

  IRET = ICODORC;
  SUSPEND;
END ^

ALTER PROCEDURE VDDESBAIXACOMISSAOSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODVEND INTEGER,
CORDEM CHAR(1),
DINI DATE,
DFIM DATE)
AS 
 
 
 
 
 
 
 
 
 
 
 
 
 

DECLARE VARIABLE SCODFILIALCI SMALLINT;
DECLARE VARIABLE ICODPCOMI INTEGER;
DECLARE VARIABLE IQTD INTEGER;
begin
  /* Procedure Text */
  FOR SELECT CODFILIALCI,CODPCOMI,COUNT(*)
     FROM VDCOMISSAO C, FNRECEBER R
     WHERE R.CODEMPVD = :ICODEMP AND R.CODFILIALVD = :SCODFILIAL AND R.CODVEND = :ICODVEND AND
        C.CODREC = R.CODREC AND C.CODEMPRC = R.CODEMP AND C.CODFILIALRC = R.CODFILIAL AND
        C.STATUSCOMI = 'CP' AND C.CODPCOMI IS NOT NULL AND
         ( (:CORDEM = 'V')  OR (C.DATACOMI BETWEEN :DINI AND :DFIM) ) AND
         ( (:CORDEM = 'E')  OR (C.DTVENCCOMI BETWEEN :DINI AND :DFIM) )
         GROUP BY CODFILIALCI,CODPCOMI
         INTO  :SCODFILIALCI, :ICODPCOMI, :IQTD
         DO
     BEGIN
        UPDATE VDCOMISSAO SET STATUSCOMI='CD'
           WHERE CODEMPCI=:ICODEMP AND
             CODFILIALCI=:SCODFILIALCI AND
             CODPCOMI=:ICODPCOMI;
        DELETE FROM FNPAGTOCOMI
           WHERE CODEMP=:ICODEMP AND
             CODFILIAL=:SCODFILIALCI AND
             CODPCOMI=:ICODPCOMI;
     END
  suspend;
end ^

ALTER PROCEDURE VDESTORNACOMISSAOSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODEMPVD INTEGER,
SCODFILIALVD SMALLINT,
ICODVEND INTEGER,
DINI DATE,
DFIM DATE,
CORDEM CHAR(1))
AS 
 
 
 
declare variable icodcomi integer;
declare variable icodemprc integer;
declare variable scodfilialrc smallint;
declare variable icodrec integer;
declare variable inparcitrec integer;
declare variable nvlrvendacomi numeric(15,5);
declare variable nvlrcomi numeric(15,5);
declare variable ddatacomi date;
declare variable ddtcompcomi date;
declare variable ddtvenccomi date;
declare variable ctipocomi char(1);
declare variable cstatuscomi char(2);
declare variable datual date;
declare variable cstatusitrec char(2);
declare variable ddtvencitrec date;
begin
  /* Procedure Text */
  DATUAL = CAST( 'now' AS DATE);
  FOR SELECT C.CODCOMI,C.CODEMPRC, C.CODFILIALRC , C.CODREC, C.NPARCITREC,
      C.VLRVENDACOMI, C.VLRCOMI, C.DATACOMI , C.DTCOMPCOMI, C.DTVENCCOMI,
      C.TIPOCOMI, C.STATUSCOMI , IR.STATUSITREC, IR.DTVENCITREC
    FROM VDCOMISSAO C, FNITRECEBER IR, FNRECEBER R
    WHERE C.CODEMP=:ICODEMP AND C.CODFILIAL=:SCODFILIAL AND
       IR.CODEMP=C.CODEMPRC AND IR.CODFILIAL=C.CODFILIALRC AND
       IR.CODREC=C.CODREC AND IR.NPARCITREC=C.NPARCITREC AND
       R.CODEMP=C.CODEMPRC AND R.CODFILIAL=C.CODFILIALRC AND
       R.CODREC=C.CODREC AND R.CODEMPVD=:ICODEMPVD AND
       R.CODFILIALVD=:SCODFILIALVD AND R.CODVEND=:ICODVEND AND
       ( (:CORDEM = 'V')  OR (C.DATACOMI BETWEEN :DINI AND :DFIM) ) AND
       ( (:CORDEM = 'E')  OR (C.DTVENCCOMI BETWEEN :DINI AND :DFIM) ) AND
       C.STATUSCOMI IN ('C2','CP') AND
       IR.STATUSITREC NOT IN ('RP') AND
       NOT EXISTS(SELECT * FROM VDCOMISSAO C2 /* Sub-select para verificar a */
          /* existencia de estorno anterior. */
         WHERE C2.CODEMPRC=C.CODEMPRC AND C2.CODFILIALRC=C.CODFILIALRC AND
         C2.CODREC=C.CODREC AND C2.NPARCITREC=C.NPARCITREC AND
         C2.TIPOCOMI=C.TIPOCOMI AND C2.STATUSCOMI IN ('CE') )
    INTO :ICODCOMI, :ICODEMPRC, :SCODFILIALRC, :ICODREC, :INPARCITREC, :NVLRVENDACOMI,
      :NVLRCOMI, :DDATACOMI, :DDTCOMPCOMI, :DDTVENCCOMI, :CTIPOCOMI, :CSTATUSCOMI, :CSTATUSITREC,
      :DDTVENCITREC
  DO
  BEGIN
     IF ( (DATUAL>DDTVENCITREC) AND (CSTATUSCOMI='C2') ) THEN
     /* Caso a data atual seja maior que a data de vencimento e a */
     /* comisso no esteja paga, passa o status da comisso para no */
     /* liberada. */
     BEGIN
        UPDATE VDCOMISSAO SET STATUSCOMI='C1'
          WHERE CODEMP=:ICODEMP AND CODFILIAL=:SCODFILIAL AND
            CODCOMI=:ICODCOMI;
     END
     ELSE IF ( (DATUAL>DDTVENCITREC) AND (CSTATUSCOMI='CP') ) THEN
     /* Caso a comisso esteja paga e a parcela esteja vencida, */
     /* gera um estorno da comisso. */
     BEGIN
        NVLRCOMI = NVLRCOMI * -1; /* Transforma o valor da comisso em negativo */
        /* para gerar estorno */
        EXECUTE PROCEDURE vdadiccomissaosp(:ICODEMPRC,:SCODFILIALRC,:ICODREC,
          :INPARCITREC, :NVLRVENDACOMI, :NVLRCOMI, :DDATACOMI , :DDTCOMPCOMI, :DDTVENCITREC,
          :CTIPOCOMI, :icodempvd, :scodfilialvd, : icodvend );
     END
  END
  suspend;
end ^

ALTER PROCEDURE VDEVOLUVENDAS (ICODEMP SMALLINT,
ICODFILIAL SMALLINT,
DATAINI DATE,
DATAFIM DATE,
ICODTIPOCLI SMALLINT,
ICODCLI SMALLINT,
FILTRAVENDAS CHAR(1),
FATURADO CHAR(1),
FINANCEIRO CHAR(1),
EMITIDO CHAR(1))
RETURNS (VALOR NUMERIC(15, 5),
MES SMALLINT,
ANO SMALLINT)
AS 
 
 

declare variable valortmp numeric(15,5);
declare variable datatmp date;
declare variable mestmp smallint;
declare variable anotmp smallint;
declare variable mesant smallint;
declare variable anoant smallint;
declare variable valorant numeric(15,5);
declare variable enviou char(1);
begin
  /* Retorna os valores de vendas por perodo */
  VALOR = 0;
  VALORANT = 0;
  ENVIOU = 'N';

  FOR select sum(v.vlrliqvenda),v.dtemitvenda from vdvenda v, vdcliente c, eqtipomov tm
             where c.codcli=v.codcli and c.codemp=v.codempcl and c.codfilial=v.codfilialcl
             and v.dtemitvenda between :DATAINI and :DATAFIM and v.codemp = :ICODEMP
             and v.codfilial = :ICODFILIAL
             and tm.codemp=v.codemptm and tm.codfilial=v.codfilialtm and tm.codtipomov=v.codtipomov
             and ( (c.codtipocli=:ICODTIPOCLI) or (:ICODTIPOCLI is null) )
             and ( (v.codcli=:ICODCLI) or (:ICODCLI is null) )
             and ( (tm.tipomov in(select tm2.tipomov from eqtipomov tm2 where tm2.codemp=v.codemptm and tm2.codfilial=v.codfilialtm and tm2.somavdtipomov='S')) or (:FILTRAVENDAS='N') )

             and (TM.FISCALTIPOMOV=:faturado or :faturado='A')
             and (TM.SOMAVDTIPOMOV=:financeiro or :financeiro='A')
             and (( (V.STATUSVENDA IN ('V2','V3','P3') and :emitido='S') or :emitido='A' )
             or ( (V.STATUSVENDA NOT IN ('V2','V3','P3') and :emitido='N') or :emitido='A' ))

             group by v.dtemitvenda order by v.dtemitvenda
      into VALORTMP,DATATMP do
      BEGIN
        MESTMP = extract(MONTH from DATATMP);
        ANOTMP = extract(YEAR from DATATMP);
        VALOR=VALOR+VALORANT;
        MES=MESANT;
        ANO=ANOANT;
        if ((not MESANT = MESTMP or not ANOANT = ANOTMP) AND not MESANT is null) then
        begin
          suspend;
          ENVIOU = 'S';
          VALOR = 0;
          MESANT=MESTMP;
          ANOANT=ANOTMP;
          VALORANT=VALORTMP;
        end
        ELSE
        BEGIN
          MESANT=MESTMP;
          ANOANT=ANOTMP;
          VALORANT=VALORTMP;
        END
      END

     VALOR=VALOR+VALORANT;
     MES=MESANT;
     ANO=ANOANT;
     suspend;
end ^

ALTER PROCEDURE VDGERACOMISSAOSP (ICODEMP INTEGER,
SCODFILIAL SMALLINT,
ICODREC INTEGER,
INPARCITREC INTEGER,
NVLRCOMIITREC NUMERIC(15, 5),
DDTVENCITREC DATE)
AS 
 
 
 
declare variable icodempva integer;
declare variable scodfilialva smallint;
declare variable ctipovenda char(3);
declare variable icodvenda integer;
declare variable icodempcm integer;
declare variable scodfilialcm smallint;
declare variable icodclcomis integer;
declare variable nvlrvendacomi numeric(15,5);
declare variable ddatacomi date;
declare variable ddtcompcomi date;
declare variable npercfatclcomis numeric(9,2);
declare variable npercpgtoclcomis numeric(9,2);
declare variable ctipocomi char(1);
declare variable nvlrcomi numeric(15,5);
declare variable i integer;
declare variable icodemptm integer;
declare variable scodfilialtm smallint;
declare variable icodtipomov integer;
declare variable cmulticomis char(1);
declare variable icodempvd integer; /* Cdigo da empresa do comissionado principal */
declare variable scodfilialvd smallint; /* Cdigo da filial do comissionado principal */
declare variable icodvend integer; /* Cdigo do comissionado principal */
declare variable nperccomisvendadic numeric(15,2); /* Percentual de comisso para cada comissionado adicional */
declare variable nvlrcomiadic numeric(15,5); /* Valor total da comisso para os comissionados adicionais. */
declare variable icodempvdadic integer; /* Cdigo da empresa do comissionado adicional */
declare variable scodfilialvdadic smallint; /* Cdigo da filial do comissionado adicional */
declare variable icodvendadic integer; /* Cdigo do comissionado adicional */
declare variable nvlrcomiparc numeric(15,5); /* Valor da comisso por vendedor parcial. */
begin
    /* Gera as comisses a pagar na tabela VDCOMISSAO */


    nvlrcomiadic = 0;

    select r.codempva, r.codfilialva, r.tipovenda, r.codvenda,
        v.codempcm, v.codfilialcm, v.codclcomis, ( v.vlrprodvenda - v.vlrdescvenda ),
        v.dtemitvenda, v.dtcompvenda, cm.percfatclcomis, cm.percpgtoclcomis,
        v.codemptm, v.codfilialtm, v.codtipomov,
        v.codempvd, v.codfilialvd, v.codvend
        from fnreceber r, vdvenda v, vdclcomis cm
        where r.codemp=:icodemp and r.codfilial=:scodfilial and r.codrec=:icodrec
            and v.codemp=r.codempva and v.codfilial=r.codfilialva and v.tipovenda=r.tipovenda
            and v.codvenda=r.codvenda and cm.codemp=v.codempcm and cm.codfilial=v.codfilialcm
            and cm.codclcomis=v.codclcomis
    into :icodempva, :scodfilialva, :ctipovenda, :icodvenda,
         :icodempcm, :scodfilialcm, :icodclcomis, :nvlrvendacomi,
         :ddatacomi, :ddtcompcomi, :npercfatclcomis, :npercpgtoclcomis,
         :icodemptm, :scodfilialtm, :icodtipomov,
         :icodempvd, :scodfilialvd, :icodvend ;

    /*Verifica se deve utilizar mecanismo de multiplos comissionados*/

    select cmulticomis from sgretmulticomissp(:icodemp, :icodemptm, :scodfilialtm, :icodtipomov)
        into cmulticomis;

    if(cmulticomis = 'S') then
    begin

        /*Implementao do mecanismo de multiplos comissionados*/
        
        for select vc.codempvd, vc.codfilialvd, vc.codvend, vc.percvc
            from vdvendacomis vc
            where vc.codemp=:icodempva and vc.codfilial=:scodfilialva and vc.codvenda=:icodvenda
                and vc.tipovenda=:ctipovenda and vc.codvend is not null
        into :icodempvdadic, :scodfilialvdadic, :icodvendadic, :nperccomisvendadic do
        begin

            /* Calcula o valor da comisso proporcional para cada comissionado adicional*/

            nvlrcomi = cast( ( nvlrcomiitrec * nperccomisvendadic / 100 ) as numeric(15,5));
            I = 1;
            while (:I<=2) do
            begin
                if (I=1) then
                    begin
                        ctipocomi='F';
                        nvlrcomiparc = cast( ( nvlrcomi * npercfatclcomis / 100 ) as NUMERIC(15, 5));
                    end
                else
                    begin
                        ctipocomi='R';
                        nvlrcomiparc = cast( (nvlrcomi * npercpgtoclcomis / 100 ) as NUMERIC(15, 5));
                    end
                execute procedure vdadiccomissaosp(:iCodEmp, :sCodFilial, :iCodRec, :iNParcItRec,
                    :nVlrVendaComi, :nvlrcomiparc, :dDataComi, :dDtCompComi, :dDtVencItRec, cTipoComi,:icodempvdadic, :scodfilialvdadic, :icodvendadic );
                I=I+1;
                /*Acumula as comisses adicionais para posteriormente descontar do valor principal*/
                nvlrcomiadic = nvlrcomiadic + nvlrcomiparc;

           /*     exception vdcomissaoex02 'rodou procedure para o vendedor:' || cast(:icodempvdadic as char(2)) || '-' || cast(:scodfilialvdadic as char(2)) || '-' || cast(:icodvendadic as char(2)) || '-' || ' - nvlrcomiadic:' || cast(nvlrcomiadic as char(20));*/

            end

        end

    end

    /*Comissionamento do vendedor principal*/

    I = 1;
    while (:I<=2) do
        begin
            if (I=1) then
                begin
                    ctipocomi='F';
                    nvlrcomi = cast( ( (nvlrcomiitrec - nvlrcomiadic ) * nPercFatClComis / 100 ) as numeric(15, 5) );
                end
            else
                begin
                    ctipocomi='R';
                    nvlrcomi = cast( ( (nvlrcomiitrec - nvlrcomiadic ) * nPercPgtoClComis / 100 ) as numeric(15, 5));
                end
/*
                exception vdcomissaoex01 ''
                || cast(:icodempvd as char(2)) || '-' || cast(:scodfilialvd as char(2)) || '-' || cast(:icodvend as char(2))
                || 'nvlrcomi:' || cast(:nvlrcomi as char(20))
                || 'nvlrvendacomi:' || cast(:nvlrvendacomi as char(20));
  */
            execute procedure vdadiccomissaosp(:icodemp, :scodfilial, :icodrec, :inparcitrec,
                :nvlrvendacomi, :nvlrcomi, :ddatacomi, :ddtcompcomi, :ddtvencitrec, ctipocomi, :icodempvd, :scodfilialvd, :icodvend );


            I=I+1;
        end

        suspend;
end ^

ALTER PROCEDURE VDGERAESTORNOCOMISP AS 
 
 
 

begin
  /* Procedure Text */

  suspend;
end ^

ALTER PROCEDURE VDITVENDASERIESP (TRANSACAO CHAR(1),
CODEMP INTEGER,
CODFILIAL SMALLINT,
CODVENDA INTEGER,
TIPOVENDA CHAR(1),
CODITVENDA SMALLINT,
CODEMPPD INTEGER,
CODFILIALPD SMALLINT,
CODPROD INTEGER,
NUMSERIETMP VARCHAR(30),
QTDITVENDA INTEGER)
AS 
 
 
 
declare variable seqitserie integer;
declare variable serieprod char(1);
begin
        
    -- Buscando informaes do produto
    select pd.serieprod from eqproduto pd
    where pd.codemp = :codemppd and pd.codfilial = :codfilialpd and pd.codprod = :codprod
    into :serieprod;
    
    -- Se o produto usa srie...
    if(serieprod = 'S') then
    begin
    
        -- Buscando ultimo item de srie inserido...
        select coalesce(max(seqitserie),0) from vditvendaserie
        where codemp=:codemp and codfilial=:codfilial and codvenda=:codvenda and tipovenda=:tipovenda and coditvenda=:coditvenda
        into :seqitserie;
    
        -- Se for uma transao de Insero...
        if( 'I' = :transacao) then
        begin
            -- Inserindo itens, enquanto a sequencia for menor ou igual  quantidade de itens
            while (seqitserie < qtditvenda) do
            begin
                seqitserie = seqitserie + 1;

                -- Se a quantidade no for unitria
                if(qtditvenda > 1) then
                begin
                    insert into vditvendaserie
                    (codemp, codfilial, codvenda,  tipovenda, coditvenda, seqitserie )
                    values
                    (:codemp, :codfilial, :codvenda, :tipovenda, :coditvenda, :seqitserie);
                end
                -- Se for apenas um item, deve inserir o numero se srie digitado na tela...
                else if(qtditvenda = 1 and :numserietmp is not null) then
                begin
                    insert into vditvendaserie
                    (codemp, codfilial, codvenda, tipovenda,  coditvenda, seqitserie, codemppd, codfilialpd, codprod, numserie )
                    values
                    (:codemp, :codfilial, :codvenda, :tipovenda, :coditvenda, :seqitserie, :codemppd, :codfilialpd, :codprod, :numserietmp );
                end
            end
        end
        -- Se for uma transao de Deleo, deve excluir todas os tens gerados.
        else if('D' = :transacao) then
        begin
            delete from vditvendaserie itcs
            where
            itcs.codemp = :codemp and itcs.codfilial = :codfilial and itcs.codvenda = :codvenda and itcs.coditvenda = :coditvenda;
        end
        -- Se for uma transao de Update, deve excluir os excessos ou incluir os faltantes...
        else if('U' = :transacao) then
        begin

            if(seqitserie > qtditvenda) then
            begin

                delete from vditvendaserie itcs
                where
                itcs.codemp = :codemp and itcs.codfilial = :codfilial and itcs.codvenda = :codvenda and itcs.coditvenda = :coditvenda
                and itcs.seqitserie > :qtditvenda;
            
            end
            else
            begin
            
                execute procedure vditvendaseriesp( 'I', :codemp, :codfilial, :codvenda, :tipovenda, :coditvenda, :codemppd, :codfilialpd, :codprod, :numserietmp, :qtditvenda);

            end

        end

    end


end ^

ALTER PROCEDURE VDREORGVENDASP (CODEMP INTEGER,
CODFILIAL SMALLINT,
TIPOVENDA CHAR(1),
CODVENDA INTEGER)
AS 
 

declare variable coditvendainc smallint;
declare variable coditvenda smallint;
begin
  coditvendainc = 1;
  for select coditvenda from vditvenda it
    where it.codemp=:codemp and it.codfilial=:codfilial and
       it.tipovenda=:tipovenda and it.codvenda=:codvenda
       order by it.coditvenda
       into :coditvenda do
  begin
    if (coditvenda>coditvendainc) then
    begin
        update vditvenda set emmanut='S', coditvenda=:coditvendainc
            where codemp=:codemp and codfilial=:codfilial and tipovenda=:tipovenda and 
                codvenda=:codvenda and coditvenda=:coditvenda;
    end
    coditvendainc = coditvendainc + 1;
  end
  update vditvenda set emmanut='N'
      where codemp=:codemp and codfilial=:codfilial and tipovenda=:tipovenda and 
         codvenda=:codvenda and emmanut='S';
end ^

ALTER PROCEDURE VDRETULTVDCLIPROD (ICODEMP INTEGER,
ICODCLI INTEGER,
ICODFILIALVD SMALLINT,
ICODVEND INTEGER,
DTINI DATE,
DTFIM DATE,
CODEMPTIPOCL INTEGER,
CODFILIALTIPOCL SMALLINT,
CODTIPOCLI INTEGER)
RETURNS (RAZCLI_RET CHAR(60),
CODCLI_RET INTEGER,
DESCPROD_RET CHAR(50),
CODPROD_RET INTEGER,
DTEMITVENDA_RET DATE,
DOCVENDA_RET INTEGER,
SERIE_RET CHAR(4),
PRECOVENDA_RET NUMERIC(15, 4),
OBSITVENDA_RET VARCHAR(500),
REFPROD_RET VARCHAR(20),
QTDPROD_RET NUMERIC(15, 5))
AS 

declare variable icodfilial smallint;
declare variable icodprod integer;
begin

    select icodfilial from sgretfilial(:ICODEMP,'VDVENDA') into :ICODFILIAL;

    for select v.codcli,iv.codprod
        from vdvenda v, vdcliente cl, vditvenda iv
        where
            iv.codemp=v.codemp and iv.codfilial=v.codfilial
            and iv.tipovenda=v.TIPOVENDA and iv.codvenda=v.codvenda
            and v.codemp=:ICODEMP and v.codfilial=:ICODFILIAL
            and (v.codcli=:ICODCLI or :ICODCLI is null)
            and (v.codvend=:ICODVEND or :ICODVEND is null )
            and v.dtemitvenda between :DTINI and :DTFIM
            and cl.codemp=v.codempcl and cl.codfilial=v.codfilialcl and cl.codcli=v.codcli
            and (cl.codtipocli=:codtipocli or :codtipocli is null)
        group by v.codcli,iv.codprod into :ICODCLI,:ICODPROD
    do
    begin
        select first 1 c.razcli, c.codcli, p.descprod, iv.codprod, v.dtemitvenda, v.docvenda, v.serie,
            (iv.vlrliqitvenda/(case when iv.qtditvenda=0 then 1 else iv.qtditvenda end)) precovenda, p.desccompprod, p.refprod, iv.qtditvenda
        from vdcliente c, vdvenda v, vditvenda iv, eqproduto p
        where
            c.codemp=v.codempcl and c.codfilial=v.codfilialcl and c.codcli=v.codcli
            and c.codemp=v.codempcl and c.codfilial=v.codfilialcl and iv.codemp=v.codemp
            and iv.codfilial=v.codfilial and iv.tipovenda=v.tipovenda and iv.codvenda=v.codvenda
            and p.codemp=iv.codemppd and p.codfilial=iv.codfilialpd and p.codprod=iv.codprod
            and v.codempvd=:ICODEMP and v.codfilialvd=:ICODFILIALVD and (v.codvend=:ICODVEND or :ICODVEND is null )
            and v.dtemitvenda between :DTINI and :DTFIM and c.codcli=:ICODCLI and p.codprod=:ICODPROD
            order by v.dtemitvenda desc
            into :RAZCLI_RET, :CODCLI_RET, :DESCPROD_RET, :CODPROD_RET, :DTEMITVENDA_RET, :DOCVENDA_RET, :SERIE_RET,
                 :PRECOVENDA_RET, :OBSITVENDA_RET, :REFPROD_RET, :QTDPROD_RET;
            suspend;
    end
end ^

ALTER PROCEDURE VDUPVENDAORCSP (ICODEMP INTEGER,
ICODFILIAL INTEGER,
ICODORC INTEGER,
ICODITORC INTEGER,
ICODFILIALVD INTEGER,
ICODVENDA INTEGER,
ICODITVENDA INTEGER,
STIPOVENDA CHAR(10))
AS 

declare variable iconta1 decimal(15,5);
declare variable vlrdescvenda decimal(15,5);
declare variable iconta2 decimal(15,5);
declare variable iconta3 decimal(15,5);
begin
  /* Procedure Text */
  

 -- EXECUTE PROCEDURE sgdebugsp 'vdupvendaorcsp, orc.: '||:icodorc, 'inicio :'|| cast('now' as time);

  INSERT INTO VDVENDAORC (CODEMP,CODFILIAL,TIPOVENDA,CODVENDA,CODITVENDA,
                          CODEMPOR,CODFILIALOR,TIPOORC,CODORC,CODITORC) VALUES
                         (:ICODEMP,:ICODFILIALVD,:STIPOVENDA,:ICODVENDA,:ICODITVENDA,
                          :ICODEMP,:ICODFILIAL,'O',:ICODORC,:ICODITORC);

--  EXECUTE PROCEDURE sgdebugsp 'vdupvendaorcsp, orc.: '||:icodorc, 'fim insert vdvendaorc:'|| cast('now' as time);

  UPDATE VDITORCAMENTO SET EMITITORC='S'
       WHERE CODITORC=:ICODITORC AND CODORC=:ICODORC AND TIPOORC='O'
       AND CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL
       AND EMITITORC<>'S';


--  EXECUTE PROCEDURE sgdebugsp 'vdupvendaorcsp, orc.: '||:icodorc, 'fim update vditorcamento '|| cast('now' as time);
    
  SELECT SUM(QTDITORC), SUM(QTDFATITORC) FROM VDITORCAMENTO WHERE CODORC=:ICODORC AND TIPOORC='O'
    AND CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL
      INTO :ICONTA1, :ICONTA2;
--  SELECT SUM(QTDFATITORC) FROM VDITORCAMENTO WHERE CODORC=:ICODORC AND TIPOORC='O'
--    AND CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL
--      INTO ICONTA2;

--  EXECUTE PROCEDURE sgdebugsp 'vdupvendaorcsp, orc.: '||:icodorc, 'fim select sum(qtditorc) '|| cast('now' as time);

  IF ( ICONTA1 = ICONTA2 ) THEN
  BEGIN
    UPDATE VDORCAMENTO SET STATUSORC='OV'
    WHERE CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL AND CODORC=:ICODORC
    AND STATUSORC<>'OV';
    SELECT SUM(IV.QTDITVENDA) FROM VDITVENDA IV, VDVENDAORC VO
       WHERE VO.CODEMP=:ICODEMP AND VO.CODFILIAL=:ICODFILIALVD AND
       VO.TIPOVENDA=:STIPOVENDA AND VO.CODVENDA=:ICODVENDA AND
       IV.CODEMP=VO.CODEMP AND IV.CODFILIAL=VO.CODFILIAL AND
       IV.TIPOVENDA=VO.TIPOVENDA AND IV.CODVENDA=VO.CODVENDA AND
       IV.CODITVENDA=VO.CODITVENDA
          INTO ICONTA3;
  --  EXECUTE PROCEDURE sgdebugsp 'vdupvendaorcsp, orc.: '||:icodorc, 'fim update vdorcamento OV = ICONTA1=ICONTA2 '|| cast('now' as time);

    IF ( ICONTA1<>ICONTA3 ) THEN -- Verifica se o oramento foi dividido em vrias vendas
    BEGIN
       UPDATE VDVENDA SET VLRDESCVENDA=0
         WHERE CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIALVD AND TIPOVENDA=:STIPOVENDA AND CODVENDA=:ICODVENDA
           AND VLRDESCVENDA<>0;
--        EXECUTE PROCEDURE sgdebugsp 'vdupvendaorcsp, orc.: '||:icodorc, 'fim update vdvenda VRLDESCVENDA=0 / ICONTA1<>ICONTA3 '|| cast('now' as time);

    END
  END
  ELSE IF (ICONTA1 > ICONTA2) THEN
  BEGIN               
    UPDATE VDORCAMENTO SET STATUSORC='FP'
    WHERE CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIAL AND CODORC=:ICODORC AND
     STATUSORC<>'FP';
    SELECT SUM(I.VLRDESCITVENDA) FROM VDITVENDA I
       WHERE I.CODEMP=:ICODEMP AND I.CODFILIAL=:ICODFILIALVD AND I.TIPOVENDA=:STIPOVENDA AND I.CODVENDA=:ICODVENDA
       INTO :VLRDESCVENDA;
--    EXECUTE PROCEDURE sgdebugsp 'vdupvendaorcsp, orc.: '||:icodorc, 'fim update vdorcamento STATUSORC=FP ICONTA1 > ICONTA2 '|| cast('now' as time);
    IF (:VLRDESCVENDA<>0) THEN
    BEGIN
       UPDATE VDVENDA SET VLRDESCVENDA=0
         WHERE CODEMP=:ICODEMP AND CODFILIAL=:ICODFILIALVD AND TIPOVENDA=:STIPOVENDA AND CODVENDA=:ICODVENDA AND
         VLRDESCVENDA<>0;
--        EXECUTE PROCEDURE sgdebugsp 'vdupvendaorcsp, orc.: '||:icodorc, 'fim update vdvenda VRLDESCVENDA=0 / ICONTA1>ICONTA2 '|| cast('now' as time);
    END 
  END

--  EXECUTE PROCEDURE sgdebugsp 'vdupvendaorcsp, orc.: '||:icodorc, 'fim VDUPVENDAORCSP'|| cast('now' as time);

  --  exception vdvendaex06 'teste de velociadade';

  suspend;
end ^
SET TERM ; ^
COMMIT WORK ;
SET AUTODDL ON;
SET TERM ^ ;

/* Triggers only will work for SQL triggers */
CREATE TRIGGER ATAGENDATGBU FOR ATAGENDA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER ATATENDENTETGBU FOR ATATENDENTE 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER ATATENDIMENTOTGBI FOR ATATENDIMENTO 
ACTIVE BEFORE INSERT POSITION 0 
AS
declare variable icodempcl integer;
declare variable icodfilialcl smallint;
declare variable icodcli integer;
begin
    if (new.codatend is not null) then
    begin
        select co.codempcl,co.codfilialcl,co.codcli
            from atconveniado co
            where co.codemp=new.codempcv and co.codfilial=new.codfilialcv and co.codconv=new.codconv
        into :icodempcl, :icodfilialcl, :icodcli;

        if(:icodcli is not null) then
        begin
           new.codempcl=:icodempcl;
           new.codfilialcl=:icodfilialcl;
           new.codcli=:icodcli;
        end
    end
end ^

CREATE TRIGGER ATATENDIMENTOTGAI FOR ATATENDIMENTO 
ACTIVE AFTER INSERT POSITION 0 
AS
declare variable statuschamado char(2);
declare variable novostatuschamado char(2);
begin
    -- Verifica se o atendimento  para um chamado
    if (new.codchamado is not null) then
    begin
        -- Buscando status do chamado;
        select status from crchamado where codemp=new.codempch and codfilial=new.codfilialch and codchamado=new.codchamado
        into :statuschamado;

        -- Atualiza o status do chamado...
        -- Outros status devem ser implementados futuramente.
        if(:statuschamado is not null) then
        begin
            novostatuschamado = 'EA';

            if(new.concluichamado='S') then
            begin
                novostatuschamado = 'CO';
            end

            update crchamado set status=:novostatuschamado, ematendimento='S'
            where codemp=new.codempch and codfilial=new.codfilialch and codchamado=new.codchamado;

        end

    end
end ^

CREATE TRIGGER ATATENDIMENTOTGBU FOR ATATENDIMENTO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  IF (new.EMMANUT IS NULL) THEN
     new.EMMANUT='N';
  IF (new.BLOQATENDO IS NULL) THEN
     new.BLOQATENDO='N';
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
  BEGIN
      if ( ( (old.BLOQATENDO IS  NULL) OR (old.BLOQATENDO='N') ) AND (new.BLOQATENDO='S') )  then
      begin
          new.DTALT=cast('now' AS DATE);
          new.IDUSUALT=user;
          new.HALT=cast('now' AS TIME);
      end
      if ( (new.BLOQATENDO='S') and (old.BLOQATENDO='S') ) then
         EXCEPTION ATATENDIMENTOEX01;
  END
end ^

CREATE TRIGGER ATATENDIMENTOTGAU FOR ATATENDIMENTO 
ACTIVE AFTER UPDATE POSITION 0 
AS
declare variable statuschamado char(2);
declare variable novostatuschamado char(2);
begin
   -- Buscando status do chamado;
   select status from crchamado where codemp=new.codempch and codfilial=new.codfilialch and codchamado=new.codchamado
   into :statuschamado;

    -- Atualiza status do chamado
    -- Outros status devem ser implementados futuramente.
   if ( (:statuschamado is not null) and (:statuschamado<>'CO') ) then
   begin
      novostatuschamado = 'EA';

      if(new.concluichamado='S') then
      begin
         novostatuschamado = 'CO';
      end

      update crchamado set status=:novostatuschamado, ematendimento='S'
         where codemp=new.codempch and codfilial=new.codfilialch and codchamado=new.codchamado;
   end
end ^

CREATE TRIGGER ATATENDIMENTOITRECTGBU FOR ATATENDIMENTOITREC 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER ATATENDIMENTOORCTGBU FOR ATATENDIMENTOORC 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER ATATRIBUICAOTGBU FOR ATATRIBUICAO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER ATCLASATENDOTGBU FOR ATCLASATENDO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER ATCONVATRIBTGBU FOR ATCONVATRIB 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER ATCONVATRIBTBTGBU FOR ATCONVATRIBTB 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER ATCONVENIADOTGBI FOR ATCONVENIADO 
ACTIVE BEFORE INSERT POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  /* Trigger Text */
end ^

CREATE TRIGGER ATCONVENIADOTGAI FOR ATCONVENIADO 
ACTIVE AFTER INSERT POSITION 0 
as
declare variable ICODATEND INTEGER;
declare variable ICODATENDO INTEGER;
declare variable ICODSETOR INTEGER;
DECLARE VARIABLE IFILIALATEND INTEGER;
DECLARE VARIABLE IFILIALPREF INTEGER;
DECLARE VARIABLE IFILIALUSU INTEGER;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'ATATENDENTE') INTO IFILIALATEND;
  SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'SGPREFERE2') INTO IFILIALPREF;
  SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'SGUSUARIO') INTO IFILIALUSU;
  SELECT CODATEND FROM ATATENDENTE
    WHERE CODEMP=new.CODEMP AND CODFILIAL=:IFILIALATEND
    AND IDUSU=LOWER(USER) AND CODEMPUS=new.CODEMP AND CODFILIALUS=:IFILIALUSU
    INTO ICODATEND;
  SELECT CODSETAT,CODTPATENDO2 FROM SGPREFERE2
    WHERE CODEMP=new.CODEMP AND CODFILIAL=:IFILIALPREF
    INTO ICODSETOR,ICODATENDO;
  EXECUTE PROCEDURE ATADICATENDIMENTOSP(
    new.CODCONV,:ICODATENDO,:ICODATEND,
    ICODSETOR,NULL,new.CODEMP,:IFILIALUSU,new.CODCONV
  );
end ^

CREATE TRIGGER ATCONVENIADOTGBU FOR ATCONVENIADO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER ATENCAMINHADORTGBU FOR ATENCAMINHADOR 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER ATESPECATENDTGBU FOR ATESPECATEND 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER ATMODATENDOTGBU FOR ATMODATENDO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
   new.DTALT=cast('now' AS DATE);
   new.IDUSUALT=user;
   new.HALT=cast('now' AS TIME);
end ^

CREATE TRIGGER ATSETORTGBU FOR ATSETOR 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER ATSETORATENDENTETGBU FOR ATSETORATENDENTE 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER ATTIPOATENDTGBU FOR ATTIPOATEND 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER ATTIPOATENDOTGBU FOR ATTIPOATENDO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER ATTIPOATENDOSETORTGBU FOR ATTIPOATENDOSETOR 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER ATTIPOCONVTGBU FOR ATTIPOCONV 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER CBCONTAEXTTGBU FOR CBCONTAEXT 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER CPCOMPRATGBI FOR CPCOMPRA 
ACTIVE BEFORE INSERT POSITION 0 
AS
  DECLARE VARIABLE IFILIALTIPOMOV INTEGER;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'EQTIPOMOV') INTO IFILIALTIPOMOV;
  SELECT T.FISCALTIPOMOV FROM EQTIPOMOV T WHERE T.CODTIPOMOV=new.CODTIPOMOV
         AND T.CODEMP=new.CODEMP AND T.CODFILIAL=:IFILIALTIPOMOV INTO new.FLAG;
  IF ( new.FLAG <> 'S') THEN
  BEGIN
    new.FLAG = 'N';
  END
  new.STATUSCOMPRA = 'P1';
  IF (new.VLRPRODCOMPRA IS NULL) THEN new.VLRPRODCOMPRA = 0;
  IF (new.VLRDESCCOMPRA IS NULL) THEN new.VLRDESCCOMPRA = 0;
  IF (new.VLRDESCITCOMPRA IS NULL) THEN new.VLRDESCITCOMPRA = 0;
  IF (new.VLRCOMPRA IS NULL) THEN new.VLRCOMPRA = 0;
  IF (new.VLRBASEICMSCOMPRA IS NULL) THEN new.VLRBASEICMSCOMPRA = 0;
  IF (new.VLRICMSCOMPRA IS NULL) THEN new.VLRICMSCOMPRA = 0;
  IF (new.VLRISENTASCOMPRA IS NULL) THEN new.VLRISENTASCOMPRA = 0;
  IF (new.VLROUTRASCOMPRA IS NULL) THEN new.VLROUTRASCOMPRA = 0;
  IF (new.VLRBASEIPICOMPRA IS NULL) THEN new.VLRBASEIPICOMPRA = 0;
  IF (new.VLRIPICOMPRA IS NULL) THEN new.VLRIPICOMPRA = 0;
  IF (new.VLRLIQCOMPRA IS NULL) THEN new.VLRLIQCOMPRA = 0;
  IF (new.VLRFRETECOMPRA IS NULL) THEN new.VLRFRETECOMPRA = 0;
  IF (new.VLRADICCOMPRA IS NULL) THEN new.VLRADICCOMPRA = 0;
  IF (new.vlrbasepiscompra IS NULL) THEN new.vlrbasepiscompra = 0;
  IF (new.vlrbasecofinscompra IS NULL) THEN new.vlrbasecofinscompra = 0;
  IF (new.vlrpiscompra IS NULL) THEN new.vlrpiscompra = 0;
  IF (new.vlrcofinscompra IS NULL) THEN new.vlrcofinscompra = 0;
  IF (new.vlrfunruralcompra IS NULL) THEN new.vlrfunruralcompra = 0;
  IF (new.vlrbaseiicompra IS NULL) THEN new.vlrbaseiicompra = 0;
  IF (new.vlriicompra IS NULL) THEN new.vlriicompra = 0;
  IF (new.vlricmsdiferido IS NULL) THEN new.vlricmsdiferido = 0;
  IF (new.vlricmsdevido IS NULL) THEN new.vlricmsdevido = 0;
  IF (new.vlricmscredpresum IS NULL) THEN new.vlricmscredpresum = 0;
  if (new.sitdoc is null) then new.sitdoc='00';
  if (new.DTCOMPCOMPRA IS NULL) then new.DTCOMPCOMPRA = new.DTEMITCOMPRA;

END ^

CREATE TRIGGER CPCOMPRATGBU FOR CPCOMPRA 
ACTIVE BEFORE UPDATE POSITION 0 
AS
  DECLARE VARIABLE dVlrPagar NUMERIC(15, 5);
  DECLARE VARIABLE sStatusPag CHAR(2);
  DECLARE VARIABLE IFILIALTIPOMOV INTEGER;
  DECLARE VARIABLE IFILIALPAG INTEGER;
  DECLARE VARIABLE CSEQNFTIPOMOV CHAR(1);
BEGIN
  IF (new.EMMANUT IS NULL) THEN
     new.EMMANUT='N';
  if (new.BLOQCOMPRA IS NULL) then
     new.BLOQCOMPRA='N';
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
  BEGIN
      if ( (old.BLOQCOMPRA IS NOT NULL AND old.BLOQCOMPRA='S') or (new.BLOQCOMPRA='S') ) then
         EXCEPTION CPCOMPRAEX04 'ESTA COMPRA EST BLOQUEADA!!!';
      new.DTALT=cast('now' AS DATE);
      new.IDUSUALT=USER;
      new.HALT = cast('now' AS TIME);
      if ( (new.DTCOMPCOMPRA IS NULL) OR (new.DTEMITCOMPRA<>old.DTEMITCOMPRA) )  then
         new.DTCOMPCOMPRA = new.DTEMITCOMPRA;
      SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'EQTIPOMOV') INTO IFILIALTIPOMOV;
      SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'FNPAGAR') INTO IFILIALPAG;
      SELECT T.FISCALTIPOMOV, T.SEQNFTIPOMOV FROM EQTIPOMOV T WHERE T.CODTIPOMOV=new.CODTIPOMOV
             AND T.CODEMP=new.CODEMP AND T.CODFILIAL = :IFILIALTIPOMOV INTO new.FLAG, :CSEQNFTIPOMOV;
      IF (old.IMPNOTACOMPRA IS NULL) THEN
         new.IMPNOTACOMPRA = 'N';
      IF ( (CSEQNFTIPOMOV IS NOT NULL) AND (CSEQNFTIPOMOV='S') ) THEN
      BEGIN
         IF  (new.IMPNOTACOMPRA='N') THEN
         BEGIN
            SELECT DOC FROM LFNOVODOCSP(new.Serie,new.CODEMPSE,new.CODFILIALSE) INTO new.DocCompra;
            new.IMPNOTACOMPRA = 'S';
         END
         ELSE IF (old.DOCCOMPRA != new.DOCCOMPRA) THEN
         BEGIN
            new.DOCCOMPRA = old.DOCCOMPRA;
         END
      END

      IF ( new.FLAG <> 'S') THEN
      BEGIN
        new.FLAG = 'N';
      END
      IF (new.VLRDESCCOMPRA IS NULL) THEN
        new.VLRDESCCOMPRA = 0;
      IF (new.VLRADICCOMPRA IS NULL) THEN
        new.VLRADICCOMPRA = 0;
      IF (new.VLRFRETECOMPRA IS NULL) THEN
        new.VLRFRETECOMPRA = 0;
      IF (old.STATUSCOMPRA = 'P1')  THEN
      BEGIN
        IF (new.STATUSCOMPRA = 'C1') THEN
        BEGIN
          new.STATUSCOMPRA = 'C2';
        END
      END
      ELSE IF ((old.STATUSCOMPRA IN ('P4','C4')) AND (new.STATUSCOMPRA IN ('P4','C4'))) THEN
      BEGIN
        EXCEPTION CPCOMPRAEX03;
      END
      ELSE IF ((old.STATUSCOMPRA IN ('P2','C2')) AND (new.STATUSCOMPRA IN ('P3','C3'))) THEN
      BEGIN
        SELECT STATUSPAG,VLRPARCPAG FROM FNPAGAR WHERE CODCOMPRA=new.CODCOMPRA
             AND CODEMP=new.CODEMP AND CODFILIAL = :IFILIALPAG INTO :sStatusPag,:dVlrPagar;
        IF ((sStatusPag = 'PD') AND (new.VLRLIQCOMPRA != :dVlrPagar)) THEN
          EXCEPTION CPCOMPRAEX04;
      END
       IF ((substr(old.STATUSCOMPRA,1,1) IN ('P','C')) AND (substr(new.STATUSCOMPRA,1,1) IN ('X','N') )) THEN
      BEGIN
           new.vlrdescitcompra = 0;
           new.vlrprodcompra = 0;
           new.vlrbaseicmscompra = 0;
           new.vlricmscompra = 0;
           new.vlrisentascompra = 0;
           new.vlroutrascompra = 0;
           new.vlrbaseipicompra = 0;
           new.vlripicompra = 0;
           new.vlrliqcompra = 0;
           new.vlripicompra = 0;
      END

  END
    -- Atualizando o status do documento fiscal para 02 - Documento cancelado, quando nota for cancelado pelo sistema.
  IF (substr(new.statuscompra,1,1) in ('X','N') and new.sitdoc!='02') THEN
  begin
    new.sitdoc = '02';
  end

  if(old.chavenfecompra is null and new.chavenfecompra is not null) then
  begin
    new.emmanut = 'N';
  end

END ^

CREATE TRIGGER CPCOMPRATGAU FOR CPCOMPRA 
ACTIVE AFTER UPDATE POSITION 0 
AS
  DECLARE VARIABLE iCodPag INTEGER;
  DECLARE VARIABLE dVLR NUMERIC(15, 5);
  DECLARE VARIABLE IFILIALPAG INTEGER;
  DECLARE VARIABLE TIPOMOV CHAR(2);        
  DECLARE VARIABLE ICODITEM SMALLINT;
  DECLARE VARIABLE VLRITEM NUMERIC(15, 5);  
  DECLARE VARIABLE QTDITEM NUMERIC(15, 5);
  DECLARE VARIABLE PERCITFRETE NUMERIC(15, 5);
  DECLARE VARIABLE VLRITFRETE NUMERIC(15, 5);
  DECLARE VARIABLE PERCITADIC NUMERIC(15, 5);
  DECLARE VARIABLE VLRITADIC NUMERIC(15, 5);
  DECLARE VARIABLE SCODFILIALP1 SMALLINT;
  DECLARE VARIABLE GERAPAGEMIS CHAR(1);
  DECLARE VARIABLE DTBASE DATE;
  DECLARE VARIABLE ICODMODNOTA INTEGER;
BEGIN
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT IS NOT NULL) )) ) THEN
  BEGIN
      SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'SGPREFERE1') INTO :SCODFILIALP1;
      SELECT P1.GERAPAGEMIS FROM SGPREFERE1 P1 WHERE  P1.CODEMP=new.CODEMP AND
         P1.CODFILIAL=:SCODFILIALP1 INTO :GERAPAGEMIS;
      IF (GERAPAGEMIS IS NULL) THEN
      BEGIN
        GERAPAGEMIS = 'N';
      END
      IF (GERAPAGEMIS='S') THEN
      BEGIN
        DTBASE = new.DTEMITCOMPRA;
      END
      ELSE
      BEGIN
        DTBASE = new.DTENTCOMPRA;
      END
      SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'FNPAGAR') INTO IFILIALPAG;
      SELECT CODPAG FROM FNPAGAR WHERE CODCOMPRA=new.CODCOMPRA
             AND CODEMP=new.CODEMP AND CODFILIAL = :IFILIALPAG INTO iCodPag;
      SELECT TIPOMOV FROM EQTIPOMOV WHERE CODTIPOMOV=new.CODTIPOMOV
             AND CODEMP=new.CODEMPTM AND CODFILIAL=new.CODFILIALTM INTO TIPOMOV;
      IF ((NOT TIPOMOV IN ('DV','TR')) AND (
         (iCodPag IS NULL) OR (
         (new.CODPLANOPAG != old.CODPLANOPAG) OR
         (new.CODFOR != old.CODFOR) OR
         (new.VLRLIQCOMPRA != old.VLRLIQCOMPRA) OR
         (new.DTENTCOMPRA != old.DTENTCOMPRA) OR
         (new.DTEMITCOMPRA != old.DTEMITCOMPRA) OR
         (new.DOCCOMPRA != old.DOCCOMPRA) OR
         (new.CODBANCO != old.CODBANCO)))) THEN
      BEGIN
        dVLR = new.VLRLIQCOMPRA;
        IF ((new.STATUSCOMPRA IN ('P2','C2')) AND (old.STATUSCOMPRA IN ('P1','C1'))) THEN
        BEGIN
          DELETE FROM FNPAGAR WHERE CODCOMPRA=old.CODCOMPRA AND CODEMP=old.CODEMP AND CODFILIAL=:IFILIALPAG;
          IF (dVlr > 0) THEN
            EXECUTE PROCEDURE FNADICPAGARSP01(new.CODCOMPRA,new.CODEMPPG,new.CODFILIALPG,
               new.CODPLANOPAG,new.CODEMPFR,new.CODFILIALFR,new.CODFOR,:dVLR,
               :DTBASE, new.DTCOMPCOMPRA, new.DOCCOMPRA,new.CODEMPBO,new.CODFILIALBO,new.CODBANCO,
               new.FLAG,new.CODEMP,new.CODFILIAL, new.CODEMPTC, new.CODFILIALTC, new.CODTIPOCOB,
               new.codempct, new.codfilialct, new.numconta, new.codempcc,  new.codfilialcc, new.anocc, new.codcc, new.codemppn, new.codfilialpn, new.codplan, new.obspag );
               
          SELECT CODMODNOTA FROM EQTIPOMOV m WHERE m.codemp=new.codemptm and m.codfilial=new.codfilialtm and m.codtipomov=new.codtipomov INTO ICODMODNOTA;
          --execute procedure sgdebugsp 'cpcompratgbu', 'PEGOU O MODELO DE NOTA:'||:ICODMODNOTA;
          IF(:ICODMODNOTA=55) THEN
          BEGIN
              --execute procedure sgdebugsp 'cpcompratgbu', 'ENTROU O MODELO DA NOTA  IGUAL A 55:';
              execute procedure sggeracnfsp('CP', null,null,null,null,new.codemp, new.codfilial,new.codcompra);
          END
        END
        ELSE IF ((new.STATUSCOMPRA IN ('P2','C2')) AND (old.STATUSCOMPRA IN ('P2','C2'))) THEN
        BEGIN
          DELETE FROM FNPAGAR WHERE CODCOMPRA=old.CODCOMPRA AND CODEMP=old.CODEMP AND CODFILIAL = old.CODFILIAL;
          IF (dVlr > 0) THEN
            EXECUTE PROCEDURE FNADICPAGARSP01(new.CODCOMPRA,new.CODEMPPG,new.CODFILIALPG,new.CODPLANOPAG,
               new.CODEMPFR,new.CODFILIALFR,new.CODFOR,:dVLR,:DTBASE , new.DTCOMPCOMPRA, new.DOCCOMPRA,
               new.CODEMPBO,new.CODFILIALBO,new.CODBANCO,new.FLAG,new.CODEMP,new.CODFILIAL,
               new.CODEMPTC, new.CODFILIALTC, new.CODTIPOCOB,
               new.codempct, new.codfilialct, new.numconta, new.codempcc,  new.codfilialcc, new.anocc, new.codcc, new.codemppn, new.codfilialpn, new.codplan, new.obspag );
        END
        ELSE IF ((new.STATUSCOMPRA IN ('P3','C3')) AND (old.STATUSCOMPRA IN ('P3','C3'))) THEN
        BEGIN
          DELETE FROM FNPAGAR WHERE CODCOMPRA=old.CODCOMPRA AND CODEMP=old.CODEMP AND CODFILIAL = :IFILIALPAG;
          IF (dVlr > 0) THEN
            EXECUTE PROCEDURE FNADICPAGARSP01(new.CODCOMPRA, new.CODEMPPG, new.CODFILIALPG, new.CODPLANOPAG,
               new.CODEMPFR, new.CODFILIALFR, new.CODFOR, :dVLR, :DTBASE, new.DTCOMPCOMPRA, new.DOCCOMPRA,
               new.CODEMPBO, new.CODFILIALBO, new.CODBANCO, new.FLAG, new.CODEMP, new.CODFILIAL,
               new.CODEMPTC, new.CODFILIALTC, new.CODTIPOCOB,
               new.codempct, new.codfilialct, new.numconta, new.codempcc,  new.codfilialcc, new.anocc, new.codcc, new.codemppn, new.codfilialpn, new.codplan, new.obspag);
        END
      END
    /**
     Movimento do estoque
    **/
    /* Avisa os itens que a data de saida foi alterada */
      IF ( (new.DTENTCOMPRA != old.DTENTCOMPRA) OR
           (new.DTEMITCOMPRA != old.DTEMITCOMPRA) OR
           (new.DOCCOMPRA != old.DOCCOMPRA) OR
           (new.CODTIPOMOV != old.CODTIPOMOV) )  THEN
        UPDATE CPITCOMPRA SET CODITCOMPRA=CODITCOMPRA WHERE
             CODCOMPRA = old.CODCOMPRA AND CODEMP=old.CODEMP AND CODFILIAL=old.CODFILIAL;

      IF ( new.codimp is null and (((new.VLRFRETECOMPRA > 0) AND ( NOT new.VLRFRETECOMPRA = old.VLRFRETECOMPRA)) or ((new.vlradiccompra > 0) AND ( NOT new.vlradiccompra = old.vlradiccompra)))  ) THEN
      BEGIN
          FOR SELECT IT.CODITCOMPRA, IT.VLRLIQITCOMPRA, IT.QTDITCOMPRA FROM CPITCOMPRA IT
              WHERE IT.CODEMP=new.CODEMP AND IT.CODFILIAL=new.CODFILIAL AND IT.CODCOMPRA=new.CODCOMPRA
              INTO :ICODITEM, :VLRITEM, :QTDITEM
              DO
              BEGIN

                  IF ( (new.vlrfretecompra > 0) AND ( NOT new.vlrfretecompra = old.vlrfretecompra)  ) THEN
                  begin
                      PERCITFRETE = :VLRITEM / (old.VLRLIQCOMPRA / 100);
                      VLRITFRETE =  (:PERCITFRETE * (new.VLRFRETECOMPRA / 100)) / COALESCE(:QTDITEM, 1);

                      UPDATE CPITCOMPRA CIT
                          SET VLRFRETEITCOMPRA=:VLRITFRETE
                            WHERE CIT.CODEMP=new.CODEMP AND CIT.CODFILIAL=new.CODFILIAL
                                AND CIT.CODCOMPRA=new.CODCOMPRA AND CIT.CODITCOMPRA=:ICODITEM;
                  end
                  IF ( (new.vlradiccompra > 0) AND ( NOT new.vlradiccompra = old.vlradiccompra)  ) THEN
                  begin
                      PERCITADIC = :VLRITEM / (old.VLRLIQCOMPRA / 100);
                      VLRITADIC =  (:PERCITADIC * (new.VLRADICCOMPRA / 100)) / COALESCE(:QTDITEM, 1);
                      UPDATE CPITCOMPRA CIT
                          SET VLRADICITCOMPRA=:VLRITADIC
                            WHERE CIT.CODEMP=new.CODEMP AND CIT.CODFILIAL=new.CODFILIAL
                                AND CIT.CODCOMPRA=new.CODCOMPRA AND CIT.CODITCOMPRA=:ICODITEM;

                  end


              END
        END
          IF ((substr(new.STATUSCOMPRA,1,1) IN ('X','N')) AND (substr(old.STATUSCOMPRA,1,1) IN ('P','C'))) THEN
          BEGIN
              UPDATE CPITCOMPRA SET QTDITCOMPRACANC=QTDITCOMPRA, QTDITCOMPRA=0 WHERE CODCOMPRA=new.CODCOMPRA AND CODEMP=new.CODEMP
              AND CODFILIAL=new.CODFILIAL;
              DELETE FROM FNPAGAR WHERE CODCOMPRA=new.CODCOMPRA AND CODEMP=new.CODEMP
              AND CODFILIAL=new.CODFILIAL;
          END

        -- Atualizao do status do recebimento da mercadoria quando a nota for emitida.
        if( old.statuscompra!='ET' and new.statuscompra='ET') then
        begin
            
           update eqrecmerc rm set rm.status='NE'
           where rm.codemp=new.codemp and rm.codfilial=new.codfilial
           and rm.ticket in
           (
            select ticket
            from eqitrecmercitcp rm
            where rm.codempcp=new.codemp and rm.codfilialcp=new.codfilial
            and rm.codcompra=new.codcompra
           );

        end

    END
END ^

CREATE TRIGGER CPCOMPRATGBD FOR CPCOMPRA 
ACTIVE BEFORE DELETE POSITION 0 
AS
begin
  /* Trigger text */
  if ( old.BLOQCOMPRA IS NOT NULL AND old.BLOQCOMPRA='S'  ) then
      EXCEPTION CPCOMPRAEX04 'ESTA COMPRA EST BLOQUEADA!!!';
end ^

CREATE TRIGGER CPCOMPRAPEDTGBU FOR CPCOMPRAPED 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER CPCOMPRAPEDTGAD FOR CPCOMPRAPED 
ACTIVE AFTER DELETE POSITION 0 
AS
begin
    -- Atualizando o status do item do pedido de compra;
    update cpitcompra set EMITITcompra='N' where CODEMP=old.CODEMPpc AND CODFILIAL=old.CODFILIALpc AND CODcompra=old.CODcompra
    and CODITcompra=old.CODITcomprapc;

end ^

CREATE TRIGGER CPCOMPRASOLTGBU FOR CPCOMPRASOL 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER CPCOMPRAVENDATGBU FOR CPCOMPRAVENDA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER CPCOTACAOTGBI FOR CPCOTACAO 
ACTIVE BEFORE INSERT POSITION 0 
AS
begin
  SELECT sititsol FROM cpitsolicitacao
      WHERE CODEMP=new.codemp AND CODFILIAL=new.codfilial and coditsol=new.coditsol and codsol=new.codsol
      INTO new.sititsol;
end ^

CREATE TRIGGER CPCOTACAOTGBU FOR CPCOTACAO 
ACTIVE BEFORE UPDATE POSITION 0 
AS
     declare variable sRefProd varChar(20);
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER CPCOTACAOTGBD FOR CPCOTACAO 
ACTIVE BEFORE DELETE POSITION 0 
AS
declare variable sUsuarioCN char(8);
declare variable sUsuarioRM char(8);
begin

   if(old.sititsol<>'PE') then
   begin
      exception eqitrma01;
   end

   select idusus from sgretinfousu(old.CODEMP, USER) into :sUsuarioCN;
   select rm.idusucot from cpcotacao rm where rm.codemp=old.codemp and rm.codfilial=old.codfilial and rm.codsol=old.codsol into :sUsuarioRM;
   if(:sUsuarioCN<>:sUsuarioRM)then
   begin
      exception eqitrma02;
   end
end ^

CREATE TRIGGER CPCOTTGBIBU FOR CPCOTACAO 
ACTIVE BEFORE INSERT OR UPDATE POSITION 1 
AS
  declare variable statusitem char(2);
begin
  if (old.sititsol!='AF') then
  begin
      if (new.qtdaprovcot!=old.qtdaprovcot or (NEW.sitaprovitsol='AT') ) then
      begin
          if ((new.sitaprovitsol='AT') and (new.qtdaprovcot=0) and (old.sitaprovitsol!='AT')) then
          begin
            new.qtdaprovcot=new.qtdcot;
          end
          if (new.qtdaprovcot>0) then
          begin
            if (new.qtdaprovcot<new.qtdcot) then
            begin
                statusitem = 'AP';
            end
            else
            begin
                statusitem = 'AT';
            end
          new.sitaprovitsol=:statusitem;
          if(new.sititsol='PE') then
          begin
              new.sititsol='EA';
          end
        end
      end
  end
  if(new.sititsol='CA') then
  begin
    new.qtdaprovcot=0;
    new.sitaprovitsol='NA';
  end

end ^

CREATE TRIGGER CPCOTACAOTGAIAU001 FOR CPCOTACAO 
ACTIVE AFTER INSERT OR UPDATE POSITION 0 
AS
DECLARE VARIABLE NUMITENS INTEGER;
DECLARE VARIABLE NUMITENSAF INTEGER;
DECLARE VARIABLE NUMITENSAP INTEGER;
DECLARE VARIABLE NUMITENSNA INTEGER;
DECLARE VARIABLE NUMITENSAT INTEGER;
DECLARE VARIABLE NUMITENSEF INTEGER;
DECLARE VARIABLE NUMITENSCA INTEGER;
begin
  if (old.sititsol!='AF') then
  begin
      select count(1) from cpcotacao where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and coditsol = new.coditsol into :numitens;
      select count(1) from cpcotacao where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and coditsol = new.coditsol and sitcompitsol='EF' into :numitensef;
      select count(1) from cpcotacao where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and coditsol = new.coditsol and new.sititsol='CA' into :numitensca;
      if (:numitens=:numitensef) then
      begin
        update cpitsolicitacao set sititsol='EF' where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and coditsol = new.coditsol and sititsol!='EF';
      end
      else if (:numitens=:numitensca) then
      begin
        update cpitsolicitacao set sititsol='CA' where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and coditsol = new.coditsol and sititsol!='CA';
      end
      if (new.qtdaprovcot!=old.qtdaprovcot) then
      begin
          if (new.qtdaprovcot>0) then
          begin
              update cpitsolicitacao set sititsol='EA' where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and coditsol = new.coditsol and sititsol='PE';
              select count(1) from cpcotacao where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and coditsol = new.coditsol and sitaprovitsol='AP' into :numitensap;
              select count(1) from cpcotacao where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and coditsol = new.coditsol and sitaprovitsol='NA' into :numitensna;
              select count(1) from cpcotacao where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and coditsol = new.coditsol and sitaprovitsol='AT' into :numitensat;
              if(:numitens!=:numitensaf) then
              begin
                if(:numitens=:numitensat) then
                begin
                   update cpitsolicitacao set sitcompitsol='CT' where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and coditsol = new.coditsol and sitcompitsol!='CT';
                end
                else if((:numitensap>0) or (:numitensna>0)) then
                begin
                   update cpitsolicitacao set sitcompitsol='CP' where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and coditsol = new.coditsol and sitcompitsol!='CP';
                end
                if(:numitens=:numitensna) then
                begin
                   update cpitsolicitacao set sitcompitsol='NA' where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and coditsol = new.coditsol and sitcompitsol!='NA';
                end
              end
          end
      end
  end
  else if (old.sititsol!='EF') then
  begin
      select count(1) from cpcotacao where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and coditsol = new.coditsol into :numitens;
      select count(1) from cpcotacao where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and coditsol = new.coditsol and sititsol='EF' into :numitensef;
      if (:numitens=:numitensef) then
      begin
        update cpitsolicitacao set sititsol='EF' where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and coditsol = new.coditsol and sititsol!='EF';
      end
  end
  -- Implementao intil pois no  possivel atribuir falor em atributo "new"
/*  SELECT sititsol FROM cpitsolicitacao
      WHERE CODEMP=new.codemp AND CODFILIAL=new.codfilial and coditsol=new.coditsol and codsol=new.codsol
      INTO new.sititsol;*/
end ^

CREATE TRIGGER CPDEVOLUCAOTGBI FOR CPDEVOLUCAO 
ACTIVE BEFORE INSERT POSITION 0 
AS
begin
    new.DTINS=cast('now' AS DATE);
    new.IDUSUINS=user;
    new.HINS=cast('now' AS TIME);
end ^

CREATE TRIGGER CPDEVOLUCAOTGBU FOR CPDEVOLUCAO 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
    new.DTALT=cast('now' AS DATE);
    new.IDUSUALT=USER;
    new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER CPEQUIVCFOPTGBU FOR CPEQUIVCFOP 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER CPFORNECEDTGBI FOR CPFORNECED 
ACTIVE BEFORE INSERT POSITION 0 
AS
    declare variable nomemunicfor CHAR(30);
    declare variable geracodunif char(1);
    declare variable codunifcod integer;
    declare variable filialpref smallint;

begin

    /*Atualizao do campo cidade e estado (temporrio para retro-compatibilidade)*/

    if(new.codmunic is not null) then
    begin
        select substr(mun.nomemunic,1,30) from sgmunicipio mun
            where mun.codpais=new.codpais and mun.siglauf=new.siglauf and mun.codmunic=new.codmunic
                into :nomemunicfor;
        if (nomemunicfor is not null) then new.cidfor = nomemunicfor;
    end

    if(new.siglauf is not null) then
    begin
        new.uffor=new.siglauf;
    end

    /* Fim da atualizao do campo cidade e estado*/

    -- Gerao de cdigo unificador (SGUNIFCOD)

    select icodfilial from sgretfilial(new.codemp,'SGPREFERE1') into filialpref;
    select geracodunif from sgprefere1 where codemp=new.codemp and codfilial=:filialpref into :geracodunif;

    if(:geracodunif = 'S') then
    begin

        select (coalesce(max(codunifcod),0)+1) from sgunifcod where codemp=new.codemp and codfilial=new.codfilial
        into :codunifcod;

        insert into sgunifcod (codemp, codfilial, codunifcod, tipounifcod, descunifcod)
        values (new.codemp, new.codfilial, :codunifcod, 'F', new.razfor);
        new.codempuc=new.codemp;
        new.codfilialuc=new.codfilial;
        new.codunifcod=:codunifcod;

    end

end ^

CREATE TRIGGER CPFORNECEDTGBU FOR CPFORNECED 
ACTIVE BEFORE UPDATE POSITION 0 
as
  declare variable nomemunicfor CHAR(30);
begin
    new.DTALT=cast('now' AS DATE);
    new.IDUSUALT=USER;
    new.HALT = cast('now' AS TIME);

    /*Atualizao do campo cidade e estado (temporrio para retro-compatibilidade)*/

    if(old.codmunic != new.codmunic) then
    begin
        select substr(mun.nomemunic,1,30) from sgmunicipio mun
            where mun.codpais=new.codpais and mun.siglauf=new.siglauf and mun.codmunic=new.codmunic
                into :nomemunicfor;
        if (nomemunicfor is not null) then new.cidfor = nomemunicfor;
    end

    if(new.siglauf is not null) then
    begin
        new.uffor=new.siglauf;
    end

    /* Fim da atualizao do campo cidade */

end ^

CREATE TRIGGER CPFORNECEDTGAU FOR CPFORNECED 
ACTIVE AFTER UPDATE POSITION 0 
AS
    declare variable filialpref smallint;
    declare variable geracodunif char(1);

begin
      -- Atualizao de descrio do cdigo unificador (SGUNIFCOD)

    select icodfilial from sgretfilial(new.codemp,'SGPREFERE1') into filialpref;
    select geracodunif from sgprefere1 where codemp=new.codemp and codfilial=:filialpref into :geracodunif;
    
    if(:geracodunif = 'S' and new.codunifcod is not null) then
    begin
        update sgunifcod set descunifcod=new.razfor
        where codemp=new.codempuc and codfilial=new.codfilialuc and codunifcod=new.codunifcod;
    end
end ^

CREATE TRIGGER CPFRETECPTGAI FOR CPFRETECP 
ACTIVE BEFORE INSERT POSITION 0 
as

declare variable vlrliqcompra numeric(9,2);

begin

    select vlrliqcompra from cpcompra
    where codcompra=new.codcompra and codemp=new.codemp and codfilial=new.codfilial
    into vlrliqcompra;

    if (not vlrliqcompra is null and vlrliqcompra > 0 and not new.perccomprafretecp > 0) then
    begin
        new.perccomprafretecp = (new.vlrfretecp/:vlrliqcompra) * 100;
    end

end ^

CREATE TRIGGER CPFRETECPTGBU FOR CPFRETECP 
ACTIVE BEFORE UPDATE POSITION 0 
as

declare variable vlrliqcompra numeric(9,2);

begin

    new.dtalt = cast('now' as date);
    new.idusualt = user;
    new.halt = cast('now' as time);

    select vlrliqcompra from cpcompra
    where codcompra=new.codcompra and codemp=new.codemp and codfilial=new.codfilial
    into vlrliqcompra;

    if (not vlrliqcompra is null and vlrliqcompra > 0 and not new.perccomprafretecp > 0) then
    begin
        new.perccomprafretecp = (new.vlrfretecp/:vlrliqcompra)*100;
    end

end ^

CREATE TRIGGER CPIMPORTACAOTGBI FOR CPIMPORTACAO 
ACTIVE BEFORE INSERT POSITION 0 
AS
begin

    -- Convertendo valores em moeda corrente / estrangeira
  if ( ( new.emmanut is null ) or ( new.emmanut='N' ) ) then
  begin
    new.vlrfrete    =   new.vlrfretemi      *   new.cotacaomoeda;
    new.vlrseguro   =   new.vlrseguromi     *   new.cotacaomoeda;
    new.vlrthcmi    =   new.vlrthc          /   new.cotacaomoeda;
  end


end ^

CREATE TRIGGER CPIMPORTACAOTGBU FOR CPIMPORTACAO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  if (new.emmanut is null) then
     new.emmanut='N';
  if ( not ( (new.emmanut='S') or ( (old.emmanut='S') and (old.emmanut is not null)) ) ) then
  begin

    new.dtalt=cast('now' as date);
    new.idusualt=user;
    new.halt = cast('now' as time);

    -- No permitindo valores negativos
    if (new.pesobruto       < 0) then new.pesobruto     = 0;
    if (new.pesoliquido     < 0) then new.pesoliquido   = 0;
    if (new.vmlemi          < 0) then new.pesobruto     = 0;
    if (new.vmldmi          < 0) then new.pesobruto     = 0;
    if (new.vlrii           < 0) then new.pesobruto     = 0;
    if (new.vlripi          < 0) then new.pesobruto     = 0;
    if (new.vlrpis          < 0) then new.pesobruto     = 0;
    if (new.vlrcofins       < 0) then new.pesobruto     = 0;
    if (new.vlrtxsiscomex   < 0) then new.pesobruto     = 0;

    -- Convertendo valores em moeda corrente / estrangeira
    if( (old.cotacaomoeda != new.cotacaomoeda) or (old.vlrfretemi != new.vlrfretemi) or (old.vlrseguromi != new.vlrseguromi) or (old.vlrthc != new.vlrthc) ) then
    begin
        new.vlrfrete    =   new.vlrfretemi      *   new.cotacaomoeda;
        new.vlrseguro   =   new.vlrseguromi     *   new.cotacaomoeda;
        new.vlrthcmi    =   new.vlrthc          /   new.cotacaomoeda;
    end

  end
  
end ^

CREATE TRIGGER CPIMPORTACAOADICTGBU FOR CPIMPORTACAOADIC 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
    new.dtalt=cast('now' as date);
    new.idusualt=user;
    new.halt = cast('now' as time);
end ^

CREATE TRIGGER CPITCOMPRATGBI FOR CPITCOMPRA 
ACTIVE BEFORE INSERT POSITION 0 
as

declare variable srefprod varchar(20);
declare variable habCustoCompra char(1);
declare variable calctrib char(1);
declare variable utilizatbcalcca char(1) ;
declare variable codempcc integer;
declare variable codfilialcc smallint;
declare variable codcalc integer;
declare variable codempcf integer;
declare variable codfilialcf smallint;
declare variable codcf integer;
declare variable codemptm integer;
declare variable codfilialtm smallint;
declare variable codtipomov integer;



begin

    if (new.calccusto is null) then 
       new.calccusto = 'S';
    -- Buscando preferncias
    select p.custocompra, p.utilizatbcalcca from sgprefere1 p
    where p.codemp=new.codemp and p.codfilial=new.codfilial
    into :habCustoCompra, :utilizatbcalcca;
    if (utilizatbcalcca is null) then
       utilizatbcalcca = 'N';

    --Buscando informaes da compra
    select cp.calctrib from cpcompra cp
    where cp.codemp=new.codemp and cp.codfilial=new.codfilial and cp.codcompra=new.codcompra
    into :calctrib;

    -- Buscando referncia do produto
    select refprod from eqproduto
    where codprod=new.codprod and codemp=new.codemppd and codfilial=new.codfilialpd
    into srefprod;

    -- Carregando valores padro
    if (new.refprod is null) then new.refprod = srefprod;
    if (new.vlrdescitcompra is null) then new.vlrdescitcompra = 0;
    if (new.vlrbaseicmsitcompra is null) then new.vlrbaseicmsitcompra = 0;
    if (new.vlricmsitcompra is null) then new.vlricmsitcompra = 0;
    if (new.vlrbaseipiitcompra is null) then new.vlrbaseipiitcompra = 0;
    if (new.vlripiitcompra is null) then new.vlripiitcompra = 0;
    if (new.vlrliqitcompra is null) then new.vlrliqitcompra = 0;
    if (new.vlradicitcompra is null) then new.vlradicitcompra = 0;
    if (new.vlrfreteitcompra is null) then new.vlrfreteitcompra = 0;
    if (new.vlrbaseicmsstitcompra is null) then new.vlrbaseicmsstitcompra = 0;
    if (new.vlricmsstitcompra is null) then new.vlricmsstitcompra = 0;
    

    if(new.vlrliqitcompra=0) then
    begin
       new.vlrliqitcompra = (new.qtditcompra * new.precoitcompra) - new.vlrdescitcompra + new.vlradicitcompra;
    end

    -- Buscando e carregando almoxarifado do produto
    if (new.codalmox is null) then
    begin
        select codempax, codfilialax, codalmox from eqproduto
        where codemp=new.codemppd and codfilial=new.codfilialpd and codprod=new.codprod
        into new.codempax, new.codfilialax, new.codalmox;
    end

       -- Buscando e carregando reteno de tributos
    if(calctrib='S') then
    begin
        select coalesce(bc.vlrbasefunrural,0), coalesce(bc.aliqfunrural,0), coalesce(bc.vlrfunrural,0), bc.codempif, bc.codfilialif, bc.codfisc, bc.coditfisc
        from lfbuscatribcompra(new.codemp, new.codfilial, new.codcompra, new.codemppd, new.codfilialpd, new.codprod, new.vlrliqitcompra) bc
        into new.vlrbasefunruralitcompra, new.aliqfunruralitcompra, new.vlrfunruralitcompra,
        new.codempif, new.codfilialif, new.codfisc, new.coditfisc;
    end
    
    
    -- Descontando o valor do funrual do valor liquido do tem
    if( new.vlrfunruralitcompra > 0 ) then
    begin
        new.vlrliqitcompra = new.vlrliqitcompra - new.vlrfunruralitcompra;
    end
    
    
    -- Buscando e carregando custo do produto
    if ( ( ('N' = habCustoCompra) or (new.custoitcompra is null) ) and (new.calccusto='S') ) then
    begin
        if (utilizatbcalcca='N') then
        begin
            select nvlrcusto
            from cpcomprasp01(new.codemp, new.codfilial, new.qtditcompra, new.vlrliqitcompra
            , new.vlricmsitcompra,'N',0,'N',0)
            into new.custoitcompra;
        end
        else
        begin

            if (new.coditfisc is null) then
            begin
               select codempfr, codfilialfr, codfor, codemptm, codfilialtm, codtipomov
                  from cpcompra
                  where codemp=new.codemp and codfilial=new.codfilial and codcompra=new.codcompra
                  into :codempcf, :codfilialcf, :codcf, :codemptm, :codfilialtm, :codtipomov;

               select itfisc.codempif, itfisc.codfilialif, itfisc.codfisc, itfisc.coditfisc
                from lfbuscafiscalsp(new.codemppd, new.codfilialpd, new.codprod, :codempcf, :codfilialcf, :codcf
                 , :codemptm, :codfilialtm, :codtipomov, 'CP', new.codnat, null, null, null, null) itfisc
               into new.codempif, new.codfilialif, new.codfisc, new.coditfisc;
            end

            select codempcc, codfilialcc, codcalc from lfitclfiscal itcl
              where itcl.codemp=new.codempif and itcl.codfilial=new.codfilialif and itcl.codfisc=new.codfisc and itcl.coditfisc=new.coditfisc
            into :codempcc, :codfilialcc, :codcalc ;

            select vlrcusto from lfcalccustosp01( :codempcc, :codfilialcc, :codcalc, new.qtditcompra, new.vlrproditcompra*new.qtditcompra
             , new.vlricmsitcompra, new.vlripiitcompra, 0, 0, new.vlrissitcompra, new.vlrfunruralitcompra
             , new.vlriiitcompra, 0, 0, 0, 0, 0 )
            into new.custoitcompra;

        end
    end

    new.calccusto = 'S';
    
    --Atualizando totais da compra
    update cpcompra cp set cp.vlrdescitcompra=cp.vlrdescitcompra + new.vlrdescitcompra,
    cp.vlrprodcompra = cp.vlrprodcompra + new.vlrproditcompra,
    cp.vlrbaseicmscompra = cp.vlrbaseicmscompra + new.vlrbaseicmsitcompra,
    cp.vlricmscompra = cp.vlricmscompra + new.vlricmsitcompra,
    -- Icms subtituio tributria
    cp.vlrbaseicmsstcompra = cp.vlrbaseicmsstcompra + new.vlrbaseicmsstitcompra,
    cp.vlricmsstcompra = cp.vlricmsstcompra + new.vlricmsstitcompra,
    -- 
    cp.vlrisentascompra = cp.vlrisentascompra + new.vlrisentasitcompra,
    cp.vlroutrascompra = cp.vlroutrascompra + new.vlroutrasitcompra,
    cp.vlrbaseipicompra = cp.vlrbaseipicompra + new.vlrbaseipiitcompra,
    cp.vlripicompra = cp.vlripicompra + new.vlripiitcompra,
    cp.vlrliqcompra = cp.vlrliqcompra + new.vlrliqitcompra,
    cp.vlrfunruralcompra = coalesce(cp.vlrfunruralcompra,0) + coalesce(new.vlrfunruralitcompra,0)
    where cp.codcompra=new.codcompra and cp.codemp=new.codemp and cp.codfilial=new.codfilial;

end ^

CREATE TRIGGER CPITCOMPRATGAI FOR CPITCOMPRA 
ACTIVE AFTER INSERT POSITION 0 
as
    declare variable dtcompra date;
    declare variable flag char(1);
    declare variable doccompra integer;
    declare variable codemptm integer;
    declare variable codfilialtm smallint;
    declare variable codtipomov integer;
    declare variable calctrib char(1);

begin

    -- Buscando informaes do cabealho da compra
    select c.dtentcompra, c.flag, c.doccompra, c.codemptm, c.codfilialtm, c.codtipomov, calctrib
    from cpcompra c
    where c.codcompra = new.codcompra and c.codemp = new.codemp and c.codfilial = new.codfilial
    into :dtcompra, :flag, :doccompra, :codemptm, :codfilialtm, :codtipomov, :calctrib;

    -- Executando procedure para movimentao de produto
    execute procedure eqmovprodiudsp (
        'I', new.codemppd, new.codfilialpd, new.codprod, new.codemple, new.codfilialle, new.codlote,
        :codemptm, :codfilialtm, :codtipomov, null, null, null, new.codemp, new.codfilial, new.codcompra, new.coditcompra,
        null, null, null, null, null, null, null, null, null, null, null, null, null, null, new.codempnt, new.codfilialnt, new.codnat,
        :dtcompra, :doccompra, :flag, new.qtditcompra, new.custoitcompra, new.codempax, new.codfilialax, new.codalmox, null, 'S', new.tiponfitcompra
    );

    -- Executa procedure de gerao de tabela de vinculo para numeros de serie

    execute procedure cpitcompraseriesp('I', new.codemp, new.codfilial, new.codcompra, new.coditcompra, new.codemppd, new.codfilialpd, new.codprod, new.numserietmp, new.qtditcompra);

    -- Gerando tabela de informaes fiscais adicionais (lfitcompra)
    if(calctrib='S') then
    begin
       -- Inserindo registros na tabela de informaes fiscais complementares (LFITCOMPRA)
        execute procedure lfgeralfitcomprasp(new.codemp, new.codfilial, new.codcompra, new.coditcompra);
    end

    -- Atualizando cabealho da compra

    update cpcompra cp set
    cp.vlrfretecompra = cp.vlrfretecompra + new.vlrfreteitcompra,
    cp.vlradiccompra = cp.vlradiccompra + new.vlradicitcompra
    where cp.codcompra=new.codcompra and cp.codemp=new.codemp and cp.codfilial=new.codfilial;


end ^

CREATE TRIGGER CPITCOMPRATGBU FOR CPITCOMPRA 
ACTIVE BEFORE UPDATE POSITION 0 
as

declare variable srefprod varchar(20);
declare variable sadicfrete char(1);
declare variable sadicadic char(1);
declare variable habcustocompra char(1);
declare variable vlritcusto numeric(15, 5);
declare variable statuscompra char(2);
declare variable calctrib char(1);
declare variable utilizatbcalcca char(1);
declare variable codempcc integer;
declare variable codfilialcc smallint;
declare variable codcalc integer;

begin

    if ( not ( (new.emmanut='S') or ( (old.emmanut='S') and (old.emmanut is not null) )) ) then
    begin

        if ( new.vlrbaseicmsstitcompra is null ) then new.vlrbaseicmsstitcompra=0;
        if (new.vlricmsstitcompra is null ) then new.vlricmsstitcompra=0;
        
        
        -- Atulizando log de alterao
        new.dtalt = cast('today' as date);
        new.idusualt = user;
        new.halt = cast('now' as time);

        -- No permite a alterao do produto
        if (new.codprod != old.codprod) then
        begin
            exception cpitcompraex01;
        end

        -- No permite a alterao do lote
        if (new.codlote != old.codlote) then
        begin
            exception cpitcompraex02;
        end

        -- Se o cdigo do almoxarifado estiver nulo, preenche como almoxarifado padro do produto
        if (new.codalmox is null) then
        begin
            select codempax, codfilialax, codalmox from eqproduto
            where codemp=new.codemppd and codfilial=new.codfilialpd and codprod=new.codprod
            into new.codempax, new.codfilialax, new.codalmox;
        end

        -- No permite a troca de almoxarifado
        if ( old.codalmox is not null and old.codalmox != new.codalmox ) then
        begin
            exception eqalmox01;
        end

        -- Busca referncia do produto
        select refprod from eqproduto
        where codprod=new.codprod and codemp=new.codemppd and codfilial=new.codfilialpd
        into srefprod;

        -- Busca informaes no cabealho da compra
        select adicfretecompra, adicadiccompra, statuscompra
        from cpcompra where
        codemp=new.codemp and codfilial=new.codfilial and codcompra=new.codcompra
        into :sadicfrete, :sadicadic, :statuscompra;

        /* Caso a nota no seja cancelada */
        if ((substr(:statuscompra,1,1) not in ('X','N'))) then
        begin

            vlritcusto = new.vlrliqitcompra/new.qtditcompra;

            -- Buscando informaes das preferencias gerais
            select p.custocompra, p.utilizatbcalcca from sgprefere1 p
            where p.codemp=new.codemp and p.codfilial=new.codfilial
            into :habcustocompra, :utilizatbcalcca;

            --Buscando informaes da compra
            select cp.calctrib from cpcompra cp
            where cp.codemp=new.codemp and cp.codfilial=new.codfilial and cp.codcompra=new.codcompra
            into :calctrib;

            --  Atualizado a referencia do produto
            if (new.refprod is null) then
            begin
                new.refprod = srefprod;
            end
            -- Adicionando o frete ao valor de custo do item
            if (:sadicfrete = 'S' ) then
            begin
               vlritcusto = vlritcusto + new.vlrfreteitcompra;
            end

            -- Adiconando valores adicionais ao custo do item
            if (:sadicadic = 'S') then
            begin
                vlritcusto = vlritcusto + new.vlradicitcompra;
            end

            new.custoitcompra=:vlritcusto;

            -- Buscando e carregando reteno de tributos
            if(calctrib='S') then
            begin
                select coalesce(bc.vlrbasefunrural,0), coalesce(bc.aliqfunrural,0), coalesce(bc.vlrfunrural,0), bc.codempif, bc.codfilialif, bc.codfisc, bc.coditfisc
                from lfbuscatribcompra(new.codemp, new.codfilial, new.codcompra, new.codemppd, new.codfilialpd, new.codprod, new.vlrliqitcompra) bc
                into new.vlrbasefunruralitcompra, new.aliqfunruralitcompra, new.vlrfunruralitcompra,
                new.codempif, new.codfilialif, new.codfisc, new.coditfisc;
            end

            -- Descontando o valor do funrual do valor liquido do tem
            if( new.vlrfunruralitcompra > 0 ) then
            begin
                new.vlrliqitcompra = new.vlrliqitcompra - new.vlrfunruralitcompra;
            end

            -- Buscando e carregando custo do produto
            if ( ('N' = habCustoCompra) or (new.custoitcompra is null)) then
            begin
                if (utilizatbcalcca='N') then
                begin
                    select nvlrcusto from cpcomprasp01(new.codemp, new.codfilial, new.qtditcompra, new.vlrliqitcompra, new.vlricmsitcompra
                    , :sadicfrete, new.vlrfreteitcompra, :sadicadic, new.vlradicitcompra)
                    into new.custoitcompra;
                end
                else
                begin
                    select codempcc, codfilialcc, codcalc from lfitclfiscal itcl
                      where itcl.codemp=new.codempif and itcl.codfilial=new.codfilialif and itcl.codfisc=new.codfisc and itcl.coditfisc=new.coditfisc
                    into :codempcc, :codfilialcc, :codcalc ;
        
                    select vlrcusto from lfcalccustosp01( :codempcc, :codfilialcc, :codcalc, new.qtditcompra, new.vlrproditcompra*new.qtditcompra
                     , new.vlricmsitcompra, new.vlripiitcompra, 0, 0, new.vlrissitcompra, new.vlrfunruralitcompra
                     , new.vlriiitcompra, 0, 0, 0, 0, 0 )
                    into new.custoitcompra;
                end
            end
        end
    end
end ^

CREATE TRIGGER CPITCOMPRATGAU FOR CPITCOMPRA 
ACTIVE AFTER UPDATE POSITION 0 
as

declare variable ddtcompra date;
declare variable cflag char(1);
declare variable idoccompra integer;
declare variable icodemptm integer;
declare variable scodfilialtm smallint;
declare variable icodtipomov integer;
declare variable calctrib char(1);
declare variable codimp integer;

begin
    -- Se no estiver em manuteno...
    if ( not ( (new.emmanut='S') or ( (old.emmanut='S') and (old.emmanut is not null) ) ) ) then
    begin
        -- Buscando informaes da compra
        select c.dtentcompra, c.flag, c.doccompra, c.codemptm, c.codfilialtm, c.codtipomov, c.calctrib, c.codimp
        from cpcompra c
        where c.codcompra = new.codcompra and c.codemp=new.codemp and c.codfilial = new.codfilial
        into :ddtcompra, :cflag, :idoccompra, :icodemptm, :scodfilialtm, :icodtipomov, :calctrib, :codimp;

        if(:codimp is null) then
        begin
            -- Atualizando cabealho da compra (no atualiza frete para no entrar em loop);
            update cpcompra cp set
                cp.vlrdescitcompra = cp.vlrdescitcompra -old.vlrdescitcompra + new.vlrdescitcompra,
                cp.vlrprodcompra = cp.vlrprodcompra - old.vlrproditcompra + new.vlrproditcompra,
                cp.vlrbaseicmscompra = cp.vlrbaseicmscompra - old.vlrbaseicmsitcompra + new.vlrbaseicmsitcompra,
                cp.vlricmscompra = cp.vlricmscompra -old.vlricmsitcompra + new.vlricmsitcompra,
                -- Icms substituio tributria
                cp.vlrbaseicmsstcompra = cp.vlrbaseicmsstcompra - old.vlrbaseicmsstitcompra + new.vlrbaseicmsstitcompra,
                cp.vlricmsstcompra = cp.vlricmsstcompra -old.vlricmsstitcompra + new.vlricmsstitcompra,
                
                cp.vlrisentascompra = cp.vlrisentascompra - old.vlrisentasitcompra + new.vlrisentasitcompra,
                cp.vlroutrascompra = cp.vlroutrascompra - old.vlroutrasitcompra + new.vlroutrasitcompra,
                cp.vlrbaseipicompra = cp.vlrbaseipicompra - old.vlrbaseipiitcompra + new.vlrbaseipiitcompra,
                cp.vlripicompra = cp.vlripicompra - old.vlripiitcompra + new.vlripiitcompra,
                cp.vlrliqcompra = cp.vlrliqcompra - old.vlrliqitcompra + new.vlrliqitcompra,
                cp.vlrfunruralcompra = cp.vlrfunruralcompra - old.vlrfunruralitcompra + new.vlrfunruralitcompra
            where cp.codcompra=new.codcompra and cp.codemp=new.codemp and cp.codfilial=new.codfilial and cp.codimp is null;
        end
        else
        begin

            -- Atualizando cabealho da compra (atualiza o frete);

            update cpcompra cp set
                cp.vlrdescitcompra = cp.vlrdescitcompra -old.vlrdescitcompra + new.vlrdescitcompra,
                cp.vlrprodcompra = cp.vlrprodcompra - old.vlrproditcompra + new.vlrproditcompra,
                cp.vlrbaseicmscompra = cp.vlrbaseicmscompra - old.vlrbaseicmsitcompra + new.vlrbaseicmsitcompra,
                cp.vlricmscompra = cp.vlricmscompra -old.vlricmsitcompra + new.vlricmsitcompra,
                -- Icms substituio tributria
                cp.vlrbaseicmsstcompra = cp.vlrbaseicmsstcompra - old.vlrbaseicmsstitcompra + new.vlrbaseicmsstitcompra,
                cp.vlricmsstcompra = cp.vlricmsstcompra -old.vlricmsstitcompra + new.vlricmsstitcompra,

                cp.vlrisentascompra = cp.vlrisentascompra - old.vlrisentasitcompra + new.vlrisentasitcompra,
                cp.vlroutrascompra = cp.vlroutrascompra - old.vlroutrasitcompra + new.vlroutrasitcompra,
                cp.vlrbaseipicompra = cp.vlrbaseipicompra - old.vlrbaseipiitcompra + new.vlrbaseipiitcompra,
                cp.vlripicompra = cp.vlripicompra - old.vlripiitcompra + new.vlripiitcompra,
                cp.vlrliqcompra = cp.vlrliqcompra - old.vlrliqitcompra + new.vlrliqitcompra,
                cp.vlrfunruralcompra = cp.vlrfunruralcompra - old.vlrfunruralitcompra + new.vlrfunruralitcompra,
                cp.vlrfretecompra = cp.vlrfretecompra - old.vlrfreteitcompra + new.vlrfreteitcompra,
                cp.vlradiccompra = cp.vlradiccompra - old.vlradicitcompra + new.vlradicitcompra
            where cp.codcompra=new.codcompra and cp.codemp=new.codemp and cp.codfilial=new.codfilial and cp.codimp is not null;

        end

        -- Atualizando movimentao de estoque
        execute procedure eqmovprodiudsp('U', new.codemppd, new.codfilialpd, new.codprod,
        new.codemple, new.codfilialle, new.codlote, :icodemptm, :scodfilialtm, :icodtipomov, null, null, null,
        new.codemp, new.codfilial, new.codcompra, new.coditcompra, null, null, null, null, null, null, null, null,
        null, null, null, null, null, null, new.codempnt, new.codfilialnt, new.codnat, :ddtcompra, :idoccompra, :cflag,
        new.qtditcompra, new.custoitcompra, new.codempax, new.codfilialax, new.codalmox, null, 'S', new.tiponfitcompra);

        -- Executa procedure para atualizao de tabela de vinculo para numeros de serie
        execute procedure cpitcompraseriesp('U', old.codemp, old.codfilial, old.codcompra, old.coditcompra, old.codemppd, old.codfilialpd, old.codprod, new.numserietmp, new.qtditcompra);

        -- Gerando tabela de informaes fiscais adicionais (lfitcompra)
        if(calctrib='S') then
        begin
           -- Inserindo registros na tabela de informaes fiscais complementares (LFITCOMPRA)
            execute procedure lfgeralfitcomprasp(new.codemp, new.codfilial, new.codcompra, new.coditcompra);
        end


    end

end ^

CREATE TRIGGER CPITCOMPRATGBD FOR CPITCOMPRA 
ACTIVE BEFORE DELETE POSITION 0 
AS
declare variable habconvcp char(1);
begin
    -- Buscando preferncias
    select p5.habconvcp from sgprefere5 p5
    into habconvcp;

    if(habconvcp='S') then
    begin
        update ppop op set op.sitop='CA', op.justificcanc='OP de converso: Item de compra excludo'
        where op.codempcp=old.codemp and op.codfilialcp=old.codfilial and op.codcompra=old.codcompra
        and op.coditcompra=old.coditcompra;
    end

    -- Executa procedure para excluso de tabela de vinculo para numeros de serie
    execute procedure cpitcompraseriesp('D', old.codemp, old.codfilial, old.codcompra, old.coditcompra, old.codemppd, old.codfilialpd, old.codprod, null, old.qtditcompra);

    -- Deleta vinculos com tabela de compra de compra
    delete from cpcompraped cp where cp.codemp=old.codemp and cp.codfilial=old.codfilial
    and cp.codcompra = old.codcompra and cp.coditcompra=old.coditcompra;


end ^

CREATE TRIGGER CPITCOMPRATGAD FOR CPITCOMPRA 
ACTIVE AFTER DELETE POSITION 0 
as

declare variable ddtcompra date;
declare variable cflag char(1);
declare variable idoccompra integer;
declare variable icodemptm integer;
declare variable scodfilialtm smallint;
declare variable icodtipomov integer;

begin

    -- Se no estifver em manuteno...
    if ( not ( (old.emmanut='S') and (old.emmanut is not null) ) ) then
    begin

        -- Atualizando cabealho da compra
        update cpcompra cp set
            cp.vlrdescitcompra = cp.vlrdescitcompra - old.vlrdescitcompra,
            cp.vlrprodcompra = cp.vlrprodcompra - old.vlrproditcompra,
            cp.vlrbaseicmscompra = cp.vlrbaseicmscompra - old.vlrbaseicmsitcompra,
            cp.vlricmscompra = cp.vlricmscompra - old.vlricmsitcompra,
            -- Icms substituio tributria
            cp.vlrbaseicmsstcompra = coalesce(cp.vlrbaseicmsstcompra,0) - coalesce(old.vlrbaseicmsstitcompra,0),
            cp.vlricmsstcompra = coalesce(cp.vlricmsstcompra,0) - coalesce(old.vlricmsstitcompra,0),

            cp.vlrisentascompra = cp.vlrisentascompra - old.vlrisentasitcompra,
            cp.vlroutrascompra = cp.vlroutrascompra - old.vlroutrasitcompra,
            cp.vlrbaseipicompra = cp.vlrbaseipicompra - old.vlrbaseipiitcompra,
            cp.vlripicompra = cp.vlripicompra - old.vlripiitcompra,
            cp.vlrliqcompra = cp.vlrliqcompra - old.vlrliqitcompra,
            cp.vlrfunruralcompra = cp.vlrfunruralcompra - old.vlrfunruralitcompra,
            cp.vlrfretecompra = cp.vlrfretecompra - old.vlrfreteitcompra,
            cp.vlradiccompra = cp.vlradiccompra - old.vlradicitcompra
        where codcompra=old.codcompra and codemp=old.codemp and codfilial=old.codfilial;

        -- Buscando informaes do cabeaho da compra
        select c.dtentcompra, c.flag, c.doccompra, c.codemptm, c.codfilialtm, c.codtipomov
        from cpcompra c
        where c.codcompra=old.codcompra and c.codemp=old.codemp and c.codfilial=old.codfilial
        into :ddtcompra, :cflag, :idoccompra, :icodemptm, :scodfilialtm, :icodtipomov;

        -- Atualizando movimentao de estoque
        execute procedure eqmovprodiudsp('D', old.codemppd, old.codfilialpd, old.codprod,
        old.codemple, old.codfilialle, old.codlote, :icodemptm, :scodfilialtm, :icodtipomov,
        null, null, null, old.codemp, old.codfilial, old.codcompra, old.coditcompra,
        null, null, null, null, null, null, null, null, null, null, null, null, null, null, old.codempnt,
        old.codfilialnt, old.codnat, :ddtcompra, :idoccompra, :cflag, old.qtditcompra, old.custoitcompra,
        old.codempax, old.codfilialax, old.codalmox, null, 'S', old.tiponfitcompra);

    end

end ^

CREATE TRIGGER CPITCOMPRASERIETGBIBU FOR CPITCOMPRASERIE 
ACTIVE BEFORE INSERT POSITION 0 
as
    declare variable temserie smallint;
begin
    -- Verifica se numero de srie j foi inserido nessa compra
    select count(*) from cpitcompraserie its
    where its.codemp = new.codemp and its.codfilial=new.codfilial and its.codcompra=new.codcompra
    and its.codemppd=new.codemppd and its.codfilialpd=new.codfilialpd and its.codprod=new.codprod
    and its.numserie = new.numserie and its.numserie is not null and its.seqitserie!=new.seqitserie
    into temserie;

    if(temserie > 0) then
    begin
        exception cpitcompraex03 new.numserie;
    end


end ^

CREATE TRIGGER CPITCOMPRASERIETGBU FOR CPITCOMPRASERIE 
ACTIVE BEFORE UPDATE POSITION 0 
as
    declare variable temserie smallint;
begin
    -- Atualizando log
    new.DTALT=cast('now' as date);
    new.IDUSUALT=USER;
    new.HALT = cast('now' as time);

    -- Verificando se foi inserido um numero de srie
    if(old.numserie is null and new.numserie is not null) then
    begin
        -- Verificando se o nmero de srie informado, j existe.
        select count(*) from eqserie sr
        where sr.codemp = new.codemppd and sr.codfilial = new.codfilialpd and sr.codprod = new.codprod and sr.numserie = new.numserie
        into :temserie;

        -- se o nmero de srie informado no existe, deve inseri-lo;
        if (temserie = 0) then
        begin
            insert into eqserie (codemp, codfilial, codprod, numserie)
            values(new.codemppd, new.codfilialpd, new.codprod, new.numserie);
        end

    end

end ^

CREATE TRIGGER CPITCOMPRASERIETGAI FOR CPITCOMPRASERIE 
ACTIVE BEFORE INSERT OR UPDATE POSITION 0 
AS
    declare variable codemptm integer;
    declare variable codfilialtm integer;
    declare variable codtipomov integer;
    declare variable estoqtipomov char(1);
    declare variable tipomovserie smallint;
begin
    if(new.numserie is not null)then
        begin

            -- Buscando informaes da compra e to tipo de movimento
            select c.codemptm, c.codfilialtm, c.codtipomov, tm.estoqtipomov
                from cpcompra c, eqtipomov tm
                where c.codemp = new.codemp and c.codfilial = new.codfilial and c.codcompra = new.codcompra
                and tm.codemp=c.codemptm and tm.codfilial=c.codfilialtm and tm.codtipomov=c.codtipomov
                into :codemptm, :codfilialtm, :codtipomov, :estoqtipomov;

            if('S' = :estoqtipomov) then
            begin
                tipomovserie = 1;
            end
            else
            begin
                tipomovserie = 0;
            end

            insert into eqmovserie (codemp, codfilial, codemppd, codfilialpd, codprod,
                codempcp, codfilialcp, codcompra, coditcompra,
                codemptm, codfilialtm, codtipomov,
                numserie, dtmovserie, tipomovserie)

            values(new.codemp, new.codfilial, new.codemppd, new.codfilialpd, new.codprod,
                new.codemp, new.codfilial, new.codcompra, new.coditcompra,
                :codemptm, :codfilialtm, :codtipomov,
                new.numserie,  current_timestamp , :tipomovserie );
        end
end ^

CREATE TRIGGER CPITIMPORTACAOTGBI FOR CPITIMPORTACAO 
ACTIVE BEFORE INSERT POSITION 0 
AS
    declare variable cotacao numeric(15,5);
begin
    
  if ( ( new.emmanut is null ) or ( new.emmanut='N' ) ) then
  begin
    
    -- Buscando cotao da moeda de importao
    select imp.cotacaomoeda from cpimportacao imp where imp.codemp=new.codemp and imp.codfilial=new.codfilial and imp.codimp=new.codimp
    into :cotacao;

    -- Calculando VMLE , VMLD e VLRAD

    new.vmlemi      =   new.qtd         *       new.precomi;
    new.vmldmi      =   new.vmlemi      +       new.vlrfretemi;
    new.vlradmi     =   new.vmldmi      +       new.vlrthcmi;


    -- Calculando valores em moeda corrente
    new.preco       =   new.precomi     *       :cotacao;
    new.vmle        =   new.vmlemi      *       :cotacao;
    new.vmld        =   new.vmldmi      *       :cotacao;
    new.vlrfrete    =   new.vlrfretemi  *       :cotacao;
    new.vlrseguro   =   new.vlrseguromi *       :cotacao;
    new.vlrthc      =   new.vlrthcmi    *       :cotacao;
    new.vlrad       =   new.vlradmi     *       :cotacao;

    -- Calculando II

    new.vlrii       =   new.vlrad       *       new.aliqii  /   100.00;

    -- Gerando o nmero do sequencial de adio.
    select coalesce(count(*),0) + 1
    from cpitimportacao
    where codemp=new.codemp and codfilial=new.codfilial and codimp=new.codimp and codncm=new.codncm
    into new.seqadic;
    
  end
  
end ^

CREATE TRIGGER CPITIMPORTACAOTGAI FOR CPITIMPORTACAO 
ACTIVE AFTER INSERT POSITION 0 
AS
begin

  if ( ( new.emmanut is null ) or ( new.emmanut='N' ) ) then
  begin

    -- Atualizando totais da importao

    update cpimportacao set

    pesobruto           =   pesobruto           +   new.pesobruto, 
    pesoliquido         =   pesoliquido         +   new.pesoliquido,
    vmlemi              =   vmlemi              +   new.vmlemi,
    vmldmi              =   vmldmi              +   new.vmldmi,
    vmle                =   vmle                +   new.vmle,
    vmld                =   vmld                +   new.vmld,
    vlradmi             =   vlradmi             +   new.vlradmi,
    vlrad               =   vlrad               +   new.vlrad,
    vlrbaseicms         =   vlrbaseicms         +   new.vlrbaseicms,

    -- Tributos

    vlrii               =   vlrii               +   new.vlrii,
    vlripi              =   vlripi              +   new.vlripi,
    vlrpis              =   vlrpis              +   new.vlrpis,
    vlrcofins           =   vlrcofins           +   new.vlrcofins,
    vlrtxsiscomex       =   vlrtxsiscomex       +   new.vlrtxsiscomex,
    vlricms             =   vlricms             +   new.vlricms,
    vlricmsdiferido     =   vlricmsdiferido     +   new.vlricmsdiferido,
    vlricmsdevido       =   vlricmsdevido       +   new.vlricmsdevido,
    vlricmscredpresum   =   vlricmscredpresum   +   new.vlricmscredpresum,
    vlricmsrecolhimento =   vlricmsrecolhimento +   new.vlricmsrecolhimento

    where codemp=new.codemp and codfilial=new.codfilial and codimp=new.codimp;
    
  end
  
end ^

CREATE TRIGGER CPITIMPORTACAOTGBU FOR CPITIMPORTACAO 
ACTIVE BEFORE UPDATE POSITION 0 
as
    declare variable cotacao        decimal(15,5);

begin

  if (new.emmanut is null) then
     new.emmanut='N';
  if ( not ( (new.emmanut='S') or ( (old.emmanut='S') and (old.emmanut is not null)) ) ) then
  begin

    -- Atualizando log
    new.DTALT=cast('now' AS DATE);
    new.IDUSUALT=USER;
    new.HALT = cast('now' AS TIME);

    -- Buscando informaes do cabealho
    select imp.cotacaomoeda
    from cpimportacao imp where imp.codemp=new.codemp and imp.codfilial=new.codfilial and imp.codimp=new.codimp
    into :cotacao;

    -- Calculando VMLE e VMLD

    new.vmlemi      =  ( new.qtd         *       new.precomi ) + new.vlrthcmi ;
    new.vmldmi      =   new.vmlemi       +       new.vlrfretemi;
    new.vlradmi     =   new.vmldmi       ;
    new.vlrvmcv     =  ( new.qtd         *       new.precomi ) + new.vlrfretemi ;

    -- Calculando valores em moeda corrente
    new.preco       =   new.precomi     *       :cotacao;
    new.vmle        =   new.vmlemi      *       :cotacao;
    new.vmld        =   new.vmldmi      *       :cotacao;
    new.vlrfrete    =   new.vlrfretemi  *       :cotacao;
    new.vlrseguro   =   new.vlrseguromi *       :cotacao;
    new.vlrthc      =   new.vlrthcmi    *       :cotacao;
    new.vlrad       =   new.vlradmi     *       :cotacao;

    -- Calculando II

    new.vlrii       =   new.vlrad       *       new.aliqii  /   100.00;

    -- Calculando IPI

    new.vlripi      = ( new.vlrad       +       new.vlrii ) *  ( new.aliqipi /   100.00);

    -- Calculando o ICMS

    new.vlrbaseicms         =  cast ( ( new.vlrad      +       new.vlrcofins      +   new.vlrpis   +     new.vlripi   + new.vlrii + new.vlrtxsiscomex + new.vlritdespad ) / (  cast(1.00 as decimal(15,5)) - (new.aliqicmsuf / 100.00) ) as decimal(15,5));

    new.vlricms             =   cast( new.vlrbaseicms *   cast( ( new.aliqicmsuf     / cast(100.00 as decimal(15,5)) ) as decimal(15,5)) as decimal(15,5));

    if(new.percdifericms > 0) then
        new.vlricmsdiferido     =   new.vlricms     *    cast(  ( new.percdifericms  / cast(100.00 as decimal(15,5)) ) as decimal(15,5));
    else
        new.vlricmsdiferido     =   0.00;

    new.vlricmsdevido       =   new.vlricms     -       new.vlricmsdiferido;

    new.vlricmscredpresum   =   cast( new.vlrbaseicms *   cast( ( new.aliqicmsuf  / cast(100.00 as numeric(15,5) ) ) as decimal(15,5) ) as decimal(15,5)) ;
    
    new.vlricmscredpresum   =   new.vlricmscredpresum - new.vlricmsdiferido;

    if (new.perccredpresimp<100) then
    begin
       new.vlricmscredpresum = new.vlricmscredpresum * cast(( new.perccredpresimp / cast(100.00 as numeric(15,5) ) ) as decimal(15,5)) ; 
    end

    new.vlricmsrecolhimento =   new.vlricmsdevido   -   new.vlricmscredpresum;

    -- Gerando o nmero do sequencial de adio.
    if(old.codncm <> new.codncm) then
    begin
        select coalesce(count(*),0) + 1
        from cpitimportacao
        where codemp=new.codemp and codfilial=new.codfilial and codimp=new.codimp and codncm=new.codncm
        into new.seqadic;
    end
    
  end

end ^

CREATE TRIGGER CPITIMPORTACAOTGAU FOR CPITIMPORTACAO 
ACTIVE AFTER UPDATE POSITION 0 
AS
begin

    -- Atualizando totais da importao
  if ( not ( (new.emmanut='S') or ( (old.emmanut='S') and (old.emmanut is not null)) ) ) then
  begin

    update cpimportacao set

    pesobruto           = pesobruto         - old.pesobruto                 + new.pesobruto,
    pesoliquido         = pesoliquido       - old.pesoliquido               + new.pesoliquido,
    vmlemi              = vmlemi            - old.vmlemi                    + new.vmlemi,
    vmldmi              = vmldmi            - old.vmldmi                    + new.vmldmi,
    vmle                = vmle              - old.vmle                      + new.vmle,
    vmld                = vmld              - old.vmld                      + new.vmld,
    vlrad               = vlrad             - old.vlrad                     + new.vlrad,
    vlradmi             = vlradmi           - old.vlradmi                   + new.vlradmi,
    vlrbaseicms         = vlrbaseicms       - old.vlrbaseicms               + new.vlrbaseicms,

    -- Tributos

    vlrii               =   vlrii               -   old.vlrii               +   new.vlrii,
    vlripi              =   vlripi              -   old.vlripi              +   new.vlripi,
    vlrpis              =   vlrpis              -   old.vlrpis              +   new.vlrpis,
    vlrcofins           =   vlrcofins           -   old.vlrcofins           +   new.vlrcofins,
    vlrtxsiscomex       =   vlrtxsiscomex       -   old.vlrtxsiscomex       +   new.vlrtxsiscomex,
    vlricms             =   vlricms             -   old.vlricms             +   new.vlricms,
    vlricmsdiferido     =   vlricmsdiferido     -   old.vlricmsdiferido     +   new.vlricmsdiferido,
    vlricmsdevido       =   vlricmsdevido       -   old.vlricmsdevido       +   new.vlricmsdevido,
    vlricmscredpresum   =   vlricmscredpresum   -   old.vlricmscredpresum   +   new.vlricmscredpresum,
    vlricmsrecolhimento =   vlricmsrecolhimento -   old.vlricmsrecolhimento +   new.vlricmsrecolhimento

    where codemp=new.codemp and codfilial=new.codfilial and codimp=new.codimp;
    
 end

end ^

CREATE TRIGGER CPITIMPORTACAOTGAD FOR CPITIMPORTACAO 
ACTIVE AFTER DELETE POSITION 0 
AS
begin

    -- Atualizando totais da importao

    update cpimportacao set

    pesobruto           =   pesobruto           -   old.pesobruto,
    pesoliquido         =   pesoliquido         -   old.pesoliquido,
    vmlemi              =   vmlemi              -   old.vmlemi,
    vmldmi              =   vmldmi              -   old.vmldmi,
    vmle                =   vmle                -   old.vmle,
    vmld                =   vmld                -   old.vmld,
    vlradmi             =   vlradmi             -   old.vlradmi,
    vlrad               =   vlrad               -   old.vlrad,
    vlrbaseicms         =   vlrbaseicms         -   old.vlrbaseicms,

    -- Tributos

    vlrii               =   vlrii               -   old.vlrii,
    vlripi              =   vlripi              -   old.vlripi,
    vlrpis              =   vlrpis              -   old.vlrpis,
    vlrcofins           =   vlrcofins           -   old.vlrcofins,
    vlrtxsiscomex       =   vlrtxsiscomex       -   old.vlrtxsiscomex,
    vlricms             =   vlricms             -   old.vlricms,
    vlricmsdiferido     =   vlricmsdiferido     -   old.vlricmsdiferido,
    vlricmsdevido       =   vlricmsdevido       -   old.vlricmsdevido,
    vlricmscredpresum   =   vlricmscredpresum   -   old.vlricmscredpresum,
    vlricmsrecolhimento =   vlricmsrecolhimento -   old.vlricmsrecolhimento


    where codemp=old.codemp and codfilial=old.codfilial and codimp=old.codimp;

end ^

CREATE TRIGGER CPITORDCOMPRATGBU FOR CPITORDCOMPRA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER CPITORDCOMPRAPETGBU FOR CPITORDCOMPRAPE 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER CPITSOLICITACAOTGBI FOR CPITSOLICITACAO 
ACTIVE BEFORE INSERT POSITION 0 
AS
begin
  IF (new.REFPROD IS NULL) THEN
       SELECT REFPROD FROM EQPRODUTO WHERE CODPROD=new.CODPROD
            AND CODEMP=new.CODEMPPD AND CODFILIAL = new.CODFILIALPD INTO new.REFPROD;
end ^

CREATE TRIGGER CPITSOLTGBI FOR CPITSOLICITACAO 
ACTIVE BEFORE INSERT POSITION 0 
AS
begin
  IF (new.CODALMOX IS NULL) THEN
       SELECT CODEMPAX,CODFILIALAX,CODALMOX FROM EQPRODUTO WHERE
          CODEMP=new.CODEMPPD AND CODFILIAL=new.CODFILIALPD AND CODPROD=new.CODPROD
       INTO new.codempam, new.codfilialam,new.codalmox;
  if (new.qtdaprovitsol>new.qtditsol) then
     exception cpitsolicitacao;
end ^

CREATE TRIGGER CPITSOLICITACAOTGBU FOR CPITSOLICITACAO 
ACTIVE BEFORE UPDATE POSITION 0 
AS
     declare variable sRefProd VARChar(20);
     DECLARE VARIABLE ICODEMPUSU INT;
     declare variable ICODFILIALUSU smallint;
     declare variable IDUSU char(8);
begin
  IF (new.EMMANUT IS NULL) THEN
     new.EMMANUT='N';
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
  BEGIN
      new.IDUSUALT = USER;
      new.HALT = cast('now' AS TIME);
      IF (new.CODALMOX IS NULL) THEN
           SELECT CODEMPAX,CODFILIALAX,CODALMOX FROM EQPRODUTO WHERE
              CODEMP=new.CODEMPPD AND CODFILIAL=new.CODFILIALPD AND
              CODPROD=new.CODPROD
           INTO new.codempam, new.codfilialam,new.CODALMOX;
    
      IF (old.CODALMOX IS NOT NULL) THEN
      BEGIN
         IF (old.CODALMOX!=new.CODALMOX) THEN
             EXCEPTION EQALMOX01;
      END
      IF (new.CODPROD != old.CODPROD) THEN
         EXCEPTION CPITSOLICITACAOEX01;
      IF (new.REFPROD IS NULL) THEN
      BEGIN
           SELECT REFPROD FROM EQPRODUTO WHERE CODPROD=new.CODPROD
                AND CODEMP=new.CODEMPPD AND CODFILIAL = new.CODFILIALPD INTO sRefProd;
           new.REFPROD = sRefProd;
      END
      if((new.idusuaprovitsol is null) and (new.sititsol!=old.sititsol) and ((new.sititsol= 'AP') or (new.sititsol= 'AT') )) then
      begin
        SELECT CODEMPUSU,CODFILIALUSU,IDUSUS FROM sgretinfousu(new.CODEMP, USER) into :ICODEMPUSU,:ICODFILIALUSU,:IDUSU;
        new.codempua = :ICODEMPUSU;
        new.codfilialua = :ICODFILIALUSU;
        new.idusuaprovitsol = :IDUSU;
        new.dtaprovitsol = cast('now' AS DATE);
      end
  END
end ^

CREATE TRIGGER CPITSOLTGBU02 FOR CPITSOLICITACAO 
ACTIVE BEFORE UPDATE POSITION 8 
AS
  declare variable statusitem char(2);
begin
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
  BEGIN
      if (old.sititsol!='AF') then
      begin
          if (new.qtdaprovitsol!=old.qtdaprovitsol or (NEW.sitaprovitsol='AT') ) then
          begin
              if ((new.sitaprovitsol='AT') and (new.qtdaprovitsol=0) and (old.sitaprovitsol!='AT')) then
              begin
                new.qtdaprovitsol=new.qtditsol;
              end
              if (new.qtdaprovitsol>0) then
              begin
                if (new.qtdaprovitsol<new.qtditsol) then
                begin
                    statusitem = 'AP';
                end
                else
                begin
                    statusitem = 'AT';
                end
              new.sitaprovitsol=:statusitem;
              if(new.sititsol='PE') then
              begin
                  new.sititsol='EA';
              end
            end
          end
      end
      if(new.sititsol='CA') then
      begin
        new.qtdaprovitsol=0;
        new.sitaprovitsol='NA';
      end
  END
end ^

CREATE TRIGGER CPITSOLTGBD FOR CPITSOLICITACAO 
ACTIVE BEFORE DELETE POSITION 0 
AS
declare variable sUsuarioCN char(8);
declare variable sUsuarioRM char(8);
begin

   if(old.sititsol<>'PE') then
   begin
      exception eqitrma01;
   end

   select idusus from sgretinfousu(old.CODEMP, USER) into :sUsuarioCN;
   select rm.idusu from cpsolicitacao rm where rm.codemp=old.codemp and rm.codfilial=old.codfilial and rm.codsol=old.codsol into :sUsuarioRM;
   if(:sUsuarioCN<>:sUsuarioRM)then
   begin
      exception eqitrma02;
   end
end ^

CREATE TRIGGER CPITSOLSTSOL FOR CPITSOLICITACAO 
ACTIVE AFTER INSERT OR UPDATE OR DELETE POSITION 1 
AS
  declare variable numitens int;
  declare variable numitensaf int;
  declare variable numitensap int;
  declare variable numitensna int;
  declare variable numitensat int;
  declare variable numitensef int;
  declare variable numitensca int;
  declare variable numitensep int;
  declare variable numitensne int;
  declare variable numitenset int;

begin

  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
  BEGIN

      if (old.sititsol!='AF') then
      begin
          select count(1) from cpitsolicitacao where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol into :numitens;
          select count(1) from cpitsolicitacao where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and sititsol='AF' into :numitensaf;
          select count(1) from cpitsolicitacao where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and sititsol='EF' into :numitensef;
          select count(1) from cpitsolicitacao where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and sititsol='CA' into :numitensca;
          if(:numitens=:numitensaf) then
          begin
            update cpsolicitacao set sitsol='AF' where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and sitsol!='AF';
          end
          else if (:numitens=:numitensef) then
          begin
            update cpsolicitacao set sitsol='EF' where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and sitsol!='EF';
          end
          else if (:numitens=:numitensca) then
          begin
            update cpsolicitacao set sitsol='CA' where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and sitsol!='CA';
          end
          if (new.qtdaprovitsol!=old.qtdaprovitsol) then
          begin
              if (new.qtdaprovitsol>0) then
              begin
                  update cpsolicitacao set sitsol='EA' where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and sitsol='PE';
                  select count(1) from cpitsolicitacao where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and sitaprovitsol='AP' into :numitensap;
                  select count(1) from cpitsolicitacao where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and sitaprovitsol='NA' into :numitensna;
                  select count(1) from cpitsolicitacao where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and sitaprovitsol='AT' into :numitensat;
                  if(:numitens!=:numitensaf) then
                  begin
                    if(:numitens=:numitensat) then
                    begin
                       update cpsolicitacao set sitsol='AT' where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and sitsol!='AT';
                    end
                    else if((:numitensap>0) or (:numitensna>0)) then
                    begin
                       update cpsolicitacao set sitsol='AP' where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and sitsol!='AP';
                    end
                    if(:numitens=:numitensna) then
                    begin
                       update cpsolicitacao set sitsol='NA' where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol  and sitsol!='NA';
                    end
                  end
              end
          end
      end
      else if (old.sititsol!='EF') then
      begin
          select count(1) from cpitsolicitacao where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol into :numitens;
          select count(1) from cpitsolicitacao where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and sititsol='EF' into :numitensef;
          if (:numitens=:numitensef) then
          begin
            update cpsolicitacao set sitsol='EF' where codemp=new.codemp and codfilial=new.codfilial and codsol = new.codsol and sitsol!='EF';
          end
      end
        if(new.sititsol='EF')  then
        begin
          update cpcotacao set sititsol = 'EF' where codemp=new.codemp and codfilial=new.codfilial and codsol=new.codsol and coditsol=new.coditsol and sititsol!='EF';
        end
        if(new.sititsol='ET')  then
        begin
          update cpcotacao set sititsol = 'ET' where codemp=new.codemp and codfilial=new.codfilial and codsol=new.codsol and coditsol=new.coditsol and sitcompitsol!='ET';
        end
    END
end ^

CREATE TRIGGER CPITSOLITSOL FOR CPITSOLITSOL 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER CPITSUMSOLTGBI FOR CPITSUMSOL 
ACTIVE BEFORE INSERT POSITION 0 
AS
begin
  new.dtins=cast('now' AS DATE);
  new.idusuins=USER;
  new.hins = cast('now' AS TIME);
END ^

CREATE TRIGGER CPITSUMSOLTGBU FOR CPITSUMSOL 
ACTIVE BEFORE UPDATE POSITION 0 
AS
     declare variable sRefProd varChar(20);
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER CPORDCOMPRATGBU FOR CPORDCOMPRA 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
    
    new.DTALT=cast('now' AS DATE);
    new.IDUSUALT=USER;
    new.HALT = cast('now' AS TIME);
    
    -- Na aprovao total mudar status para aguardando recebimento
    if(old.statusapoc='PE' and new.statusapoc='AT') then
    begin
        new.statusoc='AR';
    
        -- Gerando contas a pagar de empenho
        execute procedure fnadicpagarsp02(
            new.codemp, new.codfilial, new.codordcp,
            new.codemppg, new.codfilialpg, new.codplanopag,
            new.codempfr, new.codfilialfr, new.codfor, 
            substring(new.obsordcp from 1 for 250) );

    end

end ^

CREATE TRIGGER CPPRODFORTGBU FOR CPPRODFOR 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER CPRATEIOTGBU FOR CPRATEIO 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER CPSOLICITACAOTGBI FOR CPSOLICITACAO 
ACTIVE BEFORE INSERT POSITION 0 
AS
begin
    new.DTINS=cast('now' AS DATE);
    new.IDUSUINS=user;
    new.HINS=cast('now' AS TIME);
end ^

CREATE TRIGGER CPSOLICITACAOTGBU FOR CPSOLICITACAO 
ACTIVE BEFORE UPDATE POSITION 1 
as
  DECLARE VARIABLE ICODEMPUSU INT;
  declare variable ICODFILIALUSU smallint;
  declare variable IDUSU char(8);
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  if((new.idusuaprov is null) and (new.sitsol!=old.sitsol) and ((new.sitsol= 'AP') or (new.sitsol= 'AT') )) then
  begin
    SELECT CODEMPUSU,CODFILIALUSU,IDUSUS FROM sgretinfousu(new.CODEMP, USER) into :ICODEMPUSU,:ICODFILIALUSU,:IDUSU;
    new.codempua = :ICODEMPUSU;
    new.codfilialua = :ICODFILIALUSU;
    new.idusuaprov = :IDUSU;
    new.dtaaprovsol = cast('now' AS DATE);
  end
end ^

CREATE TRIGGER CPSOLICITACAOTGAU FOR CPSOLICITACAO 
ACTIVE AFTER UPDATE POSITION 0 
AS
begin
    if(new.sitsol='AF')  then
    begin
      update cpitsolicitacao set sititsol = 'AF' where codemp=new.codemp and codfilial=new.codfilial and codsol=new.codsol and sititsol!='AF';
    end
    else if (new.sitsol='CA')  then
    begin
      update cpitsolicitacao set sititsol = 'CA' where codemp=new.codemp and codfilial=new.codfilial and codsol=new.codsol and sititsol!='CA';
    end
    else if(new.sitsol='AT')  then
    begin
      update cpitsolicitacao set sitaprovitsol = 'AT' where codemp=new.codemp and codfilial=new.codfilial and codsol=new.codsol and sitaprovitsol!='AT';
    end
    if(new.sitsol='EF')  then
    begin
      update cpitsolicitacao it set sititsol = 'EF' where codemp=new.codemp and codfilial=new.codfilial and codsol=new.codsol and sititsol!='EF';
    end
    if(new.sitsol='ET')  then
    begin
      update cpitsolicitacao set sitcompitsol = 'ET' where codemp=new.codemp and codfilial=new.codfilial and codsol=new.codsol and sitcompitsol!='ET';
    end
    if(new.sitsol='CT')  then
    begin
      update cpcotacao set sititsol = 'AT' where codemp=new.codemp and codfilial=new.codfilial and codsol=new.codsol and sititsol!='AT';
    end
    if(new.sitsol='CF')  then
    begin
      update cpcotacao set sitcompitsol = 'EF' where codemp=new.codemp and codfilial=new.codfilial and codsol=new.codsol and sitcompitsol!='EF';
    end
end ^

CREATE TRIGGER CPSUMSOLTGBI FOR CPSUMSOL 
ACTIVE BEFORE INSERT POSITION 0 
AS
begin
  new.dtins=cast('now' AS DATE);
  new.idusuins=USER;
  new.hins = cast('now' AS TIME);

  IF (new.REFPROD IS NULL) THEN
       SELECT REFPROD FROM EQPRODUTO WHERE CODPROD=new.CODPROD
            AND CODEMP=new.CODEMPPD AND CODFILIAL = new.CODFILIALPD INTO new.REFPROD;
END ^

CREATE TRIGGER CPSUMSOLTGBU FOR CPSUMSOL 
ACTIVE BEFORE UPDATE POSITION 0 
AS
     declare variable sRefProd VARChar(20);
begin
  IF (new.EMMANUT IS NULL) THEN
     new.EMMANUT='N';
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
  BEGIN
      new.DTALT=cast('now' AS DATE);
      new.IDUSUALT=USER;
      new.HALT = cast('now' AS TIME);
    
      IF (new.CODPROD != old.CODPROD) THEN
         EXCEPTION CPITSOLICITACAOEX01;
      IF (new.REFPROD IS NULL) THEN
      BEGIN
           SELECT REFPROD FROM EQPRODUTO WHERE CODPROD=new.CODPROD
                AND CODEMP=new.CODEMPPD AND CODFILIAL = new.CODFILIALPD INTO sRefProd;
           new.REFPROD = sRefProd;
      END
  END
end ^

CREATE TRIGGER CPTABFORTGBU FOR CPTABFOR 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER CPTIPOFORTGBU FOR CPTIPOFOR 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER CRCHAMADOTGAI FOR CRCHAMADO 
ACTIVE AFTER INSERT POSITION 0 
AS
begin
    -- Atualizao do status da ordem de servio quando integrada....
    if(new.ticket is not null) then
    begin
        update eqitrecmercitos os set os.statusitos='EC' where
        os.codemp=new.codempos and os.codfilial=new.codfilialos and os.ticket=new.ticket and
        os.coditrecmerc=new.coditrecmerc and os.coditos=new.coditos;
    end
end ^

CREATE TRIGGER CRCHAMADOTGBU FOR CRCHAMADO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER CRCHAMADOTGAU FOR CRCHAMADO 
ACTIVE AFTER UPDATE POSITION 0 
AS
begin
    -- Atualizao do status da ordem de servio quando integrada....
    if(new.ticket is not null and new.status!=old.status) then
    begin
        -- Se o status do chamado for alterado para EA (Em andamento)
        if(new.status in ('EA','AN')) then
        begin
            update eqitrecmercitos os set os.statusitos=new.status where
            os.codemp=new.codempos and os.codfilial=new.codfilialos and os.ticket=new.ticket and
            os.coditrecmerc=new.coditrecmerc and os.coditos=new.coditos;
        end
        -- Se o chamado for concludo atualizar o status do item de OS.
        else if(new.status='CO') then
        begin
            update eqitrecmercitos os set os.statusitos='CO' where
            os.codemp=new.codempos and os.codfilial=new.codfilialos and os.ticket=new.ticket and
            os.coditrecmerc=new.coditrecmerc and os.coditos=new.coditos;
        end

    end
end ^

CREATE TRIGGER CRCHAMADOTGAD FOR CRCHAMADO 
ACTIVE AFTER DELETE POSITION 0 
as
declare variable codempos integer;
declare variable codfilialos smallint;
declare variable ticket integer;
declare variable coditrecmerc smallint;
declare variable coditos smallint;

begin
     -- Alterando status do item de OS caso exista;

     if(old.coditos is not null) then
     begin
        update eqitrecmercitos os set os.statusitos='PE' where
        os.codemp=old.codempos and os.codfilial=old.codfilialos and os.ticket=old.ticket and
        os.coditrecmerc=old.coditrecmerc and os.coditos=old.coditos;
     end

end ^

CREATE TRIGGER CRCHAMADOANEXOTGBU FOR CRCHAMADOANEXO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER CRFEEDBACKTGBU FOR CRFEEDBACK 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER CRFICHAAVALTGBU FOR CRFICHAAVAL 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER CRMARCADORTGBU FOR CRMARCADOR 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER CRMOTIVOAVALTGBU FOR CRMOTIVOAVAL 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER CRMOTIVOFBTGBU FOR CRMOTIVOFB 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER CRPESSOATGBU FOR CRPESSOA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER CRQUALIFICACAOTGBU FOR CRQUALIFICACAO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER CRTAREFATGBU FOR CRTAREFA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER CRTIPOCHAMADOTGBU FOR CRTIPOCHAMADO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);

end ^

CREATE TRIGGER EQALMOXTGBU FOR EQALMOX 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT=cast('now'AS TIME);
end ^

CREATE TRIGGER EQALMOXFILIALTGBU FOR EQALMOXFILIAL 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER EQCLIFORTGBU FOR EQCLIFOR 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER EQCODALTPRODBI FOR EQCODALTPROD 
ACTIVE BEFORE INSERT POSITION 0 
AS
begin
  SELECT REFPROD FROM EQPRODUTO WHERE CODEMP=new.CODEMP and CODFILIAL=new.CODFILIAL
     AND CODPROD=new.CODPROD INTO new.REFPROD;
end ^

CREATE TRIGGER EQCODALTPRODBU FOR EQCODALTPROD 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  IF (new.EMMANUT IS NULL) THEN
     new.EMMANUT='N';
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
  BEGIN    
      new.DTALT=cast('now' AS DATE);
      new.IDUSUALT=USER;
      new.HALT = cast('now' AS TIME);
      SELECT REFPROD FROM EQPRODUTO WHERE CODEMP=new.CODEMP and CODFILIAL=new.CODFILIAL
         AND CODPROD=new.CODPROD INTO new.REFPROD;
  END
end ^

CREATE TRIGGER EQETIQPRODTGBU FOR EQETIQPROD 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER EQEXPEDAMOSTRAGEMTGBI FOR EQEXPEDAMOSTRAGEM 
ACTIVE BEFORE INSERT POSITION 0 
AS
BEGIN
  IF (NEW.SEQAMOSTRAGEM IS NULL or (NEW.SEQAMOSTRAGEM=0)  ) THEN
    NEW.SEQAMOSTRAGEM = GEN_ID(EQEXPEDAMOSTRAGEMINC,1);
END ^

CREATE TRIGGER EQEXPEDAMOSTRAGEMTGAI FOR EQEXPEDAMOSTRAGEM 
ACTIVE AFTER INSERT POSITION 0 
as

    declare variable nroamostprocrecmercval smallint;
    declare variable nroamostprocrecmercatu smallint;

begin

    update eqitexpedicao itr set itr.statusitexped='FN'
    where itr.codemp=new.codemp and itr.codfilial=new.codfilial and itr.ticket=new.ticket
    and itr.coditexped=new.coditexped;

end ^

CREATE TRIGGER EQEXPEDAMOSTRAGEMTGBU FOR EQEXPEDAMOSTRAGEM 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
    new.dtalt = cast('now' as date);
    new.idusualt = user;
    new.halt = cast('now' as time);
end ^

CREATE TRIGGER EQEXPEDAMOSTRAGEMTGAU FOR EQEXPEDAMOSTRAGEM 
ACTIVE AFTER UPDATE POSITION 0 
AS
declare variable tipoproc char(2);
begin
    if(new.pesoamost != old.pesoamost) then
    begin

        select coalesce(pe.tipoprocexped,'PI') from eqitexpedicao ix, eqprocexped pe where
        ix.codemp=new.codemp and ix.codfilial=new.codfilial and ix.ticket=new.ticket and ix.coditexped=new.coditexped
        and pe.codemp=ix.codempte and pe.codfilial=ix.codfilialte and pe.codtipoexped=ix.codtipoexped and pe.codprocexped=ix.codprocexped
        into tipoproc;

        if('PI' = tipoproc) then
        begin

            update eqexpedicao ex set ex.pesoentrada=new.pesoamost
            where ex.codemp=new.codemp and ex.codfilial=new.codfilial and ex.ticket=new.ticket;

        end
        else  if('PF' = tipoproc) then
        begin

            update eqexpedicao ex set ex.pesosaida=new.pesoamost
            where ex.codemp=new.codemp and ex.codfilial=new.codfilial and ex.ticket=new.ticket;

        end

    end
end ^

CREATE TRIGGER EQEXPEDICAOTGAI FOR EQEXPEDICAO 
ACTIVE AFTER INSERT POSITION 0 
as
declare variable codempte integer;
declare variable codfilialte smallint;
declare variable codtipoexped integer;
declare variable codprocexped integer;
declare variable coditexped integer;

begin

    -- Se tiver um produto padro no cabealho, deve gerar os tens automaticamente.
    if(new.codprod is not null) then
    begin

        coditexped = 1;
    
        for select pr.codemp, pr.codfilial, pr.codtipoexped, pr.codprocexped
        from eqprocexped pr
        where pr.codemp=new.codempte and pr.codfilial=new.codfilialte and pr.codtipoexped=new.codtipoexped
    order by pr.codprocexped
        into :codempte,  :codfilialte, :codtipoexped, :codprocexped do
        begin

            select coalesce( max(coditexped) , 0 ) + 1
            from eqitexpedicao ie
            where ie.codemp=new.codemp and ie.codfilial=new.codfilial and ie.ticket=new.ticket
            into coditexped;
        
            insert into eqitexpedicao
            ( codemp, codfilial, ticket, coditexped, codemppd, codfilialpd, codprod, refprod, codempte, codfilialte, codtipoexped, codprocexped ) values
            ( new.codemp, new.codfilial, new.ticket, :coditexped, new.codemppd, new.codfilial, new.codprod, new.refprod, :codempte, :codfilialte, :codtipoexped, :codprocexped );


        end
    end

end ^

CREATE TRIGGER EQEXPEDICAOTGBU FOR EQEXPEDICAO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin

    -- Atualizando log de atualizao do registro
    new.DTALT=cast('now' AS DATE);
    new.IDUSUALT=USER;
    new.HALT=cast('now'AS TIME);

    -- Verifica se um romaneio foi vinculado e atualizao o status.
    if(old.codroma is null and new.codroma is not null) then
    begin
    
        new.status='RE';

    end


end ^

CREATE TRIGGER EQFATCONVTGBU FOR EQFATCONV 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER EQGRUPOTGBU FOR EQGRUPO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  if (new.ESTNEGGRUP IS NULL) then
     new.ESTNEGGRUP = 'N';
  if (new.ESTLOTNEGGRUP IS NULL) then
     new.ESTLOTNEGGRUP = 'N';
  if ( (old.ESTNEGGRUP IS NULL) OR (old.ESTNEGGRUP!=new.ESTNEGGRUP) ) then
     UPDATE EQGRUPO SET ESTNEGGRUP=new.ESTNEGGRUP
         WHERE CODEMP=new.CODEMP AND CODFILIAL=new.CODFILIAL AND
           CODGRUP!=new.CODGRUP AND CODGRUP LIKE RTRIM(new.CODGRUP)||'%';
  if ( (old.ESTLOTNEGGRUP IS NULL) OR (old.ESTLOTNEGGRUP!=new.ESTLOTNEGGRUP) ) then
     UPDATE EQGRUPO SET ESTLOTNEGGRUP=new.ESTLOTNEGGRUP
         WHERE CODEMP=new.CODEMP AND CODFILIAL=new.CODFILIAL AND
           CODGRUP!=new.CODGRUP AND CODGRUP LIKE RTRIM(new.CODGRUP)||'%';
  /* Trigger Text */
end ^

CREATE TRIGGER EQGUIATRAFTGBU FOR EQGUIATRAF 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
   new.DTALT=cast('now' AS DATE);
    new.IDUSUALT=USER;
    new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER EQINVPRODTGBI FOR EQINVPROD 
ACTIVE BEFORE INSERT POSITION 0 
AS
  DECLARE VARIABLE CLOTEPROD CHAR;
BEGIN
  new.DTINS=cast('now' AS DATE);
  new.IDUSUINS=USER;
  new.HINS = cast('now' AS TIME);
  SELECT CLOTEPROD FROM EQPRODUTO WHERE CODPROD=new.CODPROD
    AND CODEMP=new.CODEMPPD AND CODFILIAL=new.CODFILIALPD INTO CLOTEPROD;
  IF (CLOTEPROD = 'S' AND new.CODLOTE IS NULL) THEN
    EXCEPTION EQINVPRODEX05;
  if (new.SLDATUALINVP is null) then new.SLDATUALINVP = 0;
  if (new.SLDDIGINVP is null) then new.SLDDIGINVP = 0;
/*  new.QTDINVP = new.SLDATUALINVP - new.SLDDIGINVP; */
  SELECT REFPROD FROM EQPRODUTO WHERE CODPROD=new.CODPROD
         AND CODEMP=new.CODEMPPD AND CODFILIAL = new.CODFILIALPD INTO new.REFPROD;
END ^

CREATE TRIGGER EQINVPRODTGAI FOR EQINVPROD 
ACTIVE AFTER INSERT POSITION 0 
AS
BEGIN
  EXECUTE PROCEDURE EQMOVPRODIUDSP('I', new.CODEMPPD, new.CODFILIALPD,
     new.CODPROD, new.CODEMPLE, new.CODFILIALLE, new.CODLOTE,
     new.CODEMPTM, new.CODFILIALTM, new.CODTIPOMOV, new.CODEMP,
     new.CODFILIAL, new.CODINVPROD,  null, null, null, null,
     null, null, null, null, null, null, null, null, null,null,
     null,null,null,null,
     null, null, null, new.DATAINVP, new.CODINVPROD, 'S',
     new.QTDINVP, new.PRECOINVP,
     new.CODEMPAX, new.CODFILIALAX, new.CODALMOX, null, 'S', 'N');
END ^

CREATE TRIGGER EQINVPRODTGBU FOR EQINVPROD 
ACTIVE BEFORE UPDATE POSITION 0 
AS
  DECLARE VARIABLE CLOTEPROD CHAR;
BEGIN
    -- Verifica se tabela est em manuteno // caso no esteja inicia procedimentos
  if ( new.emmanut is null) then
      new.emmanut='N';

  if ( not ( (new.emmanut='S') or ( (old.emmanut='S') and (old.emmanut is not null) )) ) then
  begin

      new.DTALT=cast('now' AS DATE);
      new.IDUSUALT=USER;
      new.HALT = cast('now' AS TIME);
      SELECT CLOTEPROD FROM EQPRODUTO WHERE CODPROD=new.CODPROD
        AND CODEMP=new.CODEMPPD AND CODFILIAL=new.CODFILIALPD INTO CLOTEPROD;
      IF (new.CODPROD != old.CODPROD) THEN
        EXCEPTION EQINVPRODEX01;
      IF (new.CODLOTE != old.CODLOTE) THEN
        EXCEPTION EQINVPRODEX02;
      IF (new.DATAINVP != old.DATAINVP) THEN
        EXCEPTION EQINVPRODEX03;
      IF (new.CODALMOX != old.CODALMOX) THEN
        EXCEPTION EQINVPRODEX04;
      IF (CLOTEPROD = 'S' AND new.CODLOTE IS NULL) THEN
        EXCEPTION EQINVPRODEX05;
  end
  
END ^

CREATE TRIGGER EQINVPRODTGAU FOR EQINVPROD 
ACTIVE AFTER UPDATE POSITION 0 
AS
BEGIN
  if ( not ( (new.emmanut='S') or ( (old.emmanut='S') and (old.emmanut is not null) )) ) then
  begin
      EXECUTE PROCEDURE EQMOVPRODIUDSP('U', new.CODEMPPD, new.CODFILIALPD,
         new.CODPROD, new.CODEMPLE, new.CODFILIALLE, new.CODLOTE,
         new.CODEMPTM, new.CODFILIALTM, new.CODTIPOMOV, new.CODEMP,
         new.CODFILIAL, new.CODINVPROD,  null, null, null, null,
         null, null, null, null, null, null, null, null, null,null,null,null,
         null, null, null, null, null, new.DATAINVP, new.CODINVPROD, 'S',
         new.QTDINVP, new.PRECOINVP,
         new.CODEMPAX, new.CODFILIALAX, new.CODALMOX, null, 'S', 'N');
  end
END ^

CREATE TRIGGER EQINVPRODTGAD FOR EQINVPROD 
ACTIVE AFTER DELETE POSITION 0 
AS
begin
  /* Apos a excluso do inventrio */
  EXECUTE PROCEDURE EQMOVPRODIUDSP('D', old.CODEMPPD, old.CODFILIALPD,
     old.CODPROD, old.CODEMPLE, old.CODFILIALLE, old.CODLOTE,
     old.CODEMPTM, old.CODFILIALTM, old.CODTIPOMOV, old.CODEMP,
     old.CODFILIAL, old.CODINVPROD, null, null, null, null,null,
     null, null, null, null, null, null, null, null, null, null, null,
     null, null, null,null,
     null, old.DATAINVP, old.CODINVPROD, 'S', old.QTDINVP, old.PRECOINVP,
     old.CODEMPAX, old.CODFILIALAX, old.CODALMOX, null, 'S', 'N');
end ^

CREATE TRIGGER EQITEXPEDICAOTGBU FOR EQITEXPEDICAO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  IF (new.EMMANUT IS NULL) THEN
     new.EMMANUT='N';
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER EQITEXPEDICAOTGAU FOR EQITEXPEDICAO 
ACTIVE AFTER UPDATE POSITION 0 
as
    declare variable tipoprocexped char(2);
    declare variable peso decimal(15,5);

begin

  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
  begin
  -- buscando tipo de amostragem

    select pr.tipoprocexped,

        (select first 1 ea.pesoamost from eqexpedamostragem ea
         where ea.codemp=ie.codemp and ea.codfilial=ie.codfilial and ea.ticket=ie.ticket and ea.coditexped=ie.coditexped
         order by ea.coditexped desc
        ) peso

    from eqprocexped pr, eqitexpedicao ie
    where ie.codemp=new.codemp and ie.codfilial=new.codfilial and ie.ticket=new.ticket and ie.coditexped=new.coditexped
    and pr.codemp=ie.codempte and pr.codfilial=ie.codfilialte and pr.codtipoexped=ie.codtipoexped and pr.codprocexped=ie.codprocexped
    into :tipoprocexped, :peso;

    if(new.statusitexped='FN') then
    begin

        if (tipoprocexped='PI') then
        begin
            update eqexpedicao ex set ex.status='PI', ex.pesoentrada=:peso
            where ex.codemp=new.codemp and ex.codfilial=new.codfilial and ex.ticket=new.ticket;
        end
        else if (tipoprocexped='PF') then
        begin
            update eqexpedicao ex set ex.status='PS', ex.pesosaida=:peso
            where ex.codemp=new.codemp and ex.codfilial=new.codfilial and ex.ticket=new.ticket;
        end
        else if (tipoprocexped='RO') then
        begin
            update eqexpedicao ex set ex.status='FN'
            where ex.codemp=new.codemp and ex.codfilial=new.codfilial and ex.ticket=new.ticket;
        end
    end
  end
end ^

CREATE TRIGGER EQITMODGRADETGBU FOR EQITMODGRADE 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER EQITRECMERCTGAI FOR EQITRECMERC 
ACTIVE AFTER INSERT POSITION 0 
AS
begin
    -- Executa procedure de gerao de tabela de vinculo para numeros de serie

    execute procedure eqitrecmercseriesp('I', new.codemp, new.codfilial, new.ticket, new.coditrecmerc, new.codemppd, new.codfilialpd, new.codprod, new.numserie, new.qtditrecmerc);

end ^

CREATE TRIGGER EQITRECMERCTGBU FOR EQITRECMERC 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  IF (new.EMMANUT IS NULL) THEN
     new.EMMANUT='N';
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT=cast('now'AS TIME);
end ^

CREATE TRIGGER EQITRECMERCTGAU FOR EQITRECMERC 
ACTIVE AFTER UPDATE POSITION 0 
as
    declare variable tipoprocrecmerc char(2);

begin

  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
  BEGIN
  -- buscando tipo de amostragem

    select pr.tipoprocrecmerc
    from eqprocrecmerc pr, eqitrecmerc ir
    where ir.codemp=new.codemp and ir.codfilial=new.codfilial and ir.ticket=new.ticket and ir.coditrecmerc=new.coditrecmerc
    and pr.codemp=ir.codemptp and pr.codfilial=ir.codfilialtp and pr.codtiporecmerc=ir.codtiporecmerc and pr.codprocrecmerc=ir.codprocrecmerc
    into :tipoprocrecmerc;

    if( ( coalesce(new.mediaamostragem,0) > 0 )  and ( coalesce(new.rendaamostragem,0) > 0 ) ) then
    begin

        update eqrecmerc rm set
        rm.mediaamostragem = ( coalesce(rm.mediaamostragem,new.mediaamostragem) + new.mediaamostragem ) / 2,
        rm.rendaamostragem = ( coalesce(rm.rendaamostragem,new.rendaamostragem) + new.rendaamostragem ) / 2
        where
        rm.codemp=new.codemp and rm.codfilial=new.codfilial and rm.ticket=new.ticket;

    end

    if(new.statusitrecmerc='FN') then
    begin

        if (tipoprocrecmerc='PI') then
        begin
            update eqrecmerc rm set rm.status='E1'
            where rm.codemp=new.codemp and rm.codfilial=new.codfilial and rm.ticket=new.ticket;
        end
        else if (tipoprocrecmerc='TR') then
        begin
            update eqrecmerc rm set
            rm.status='E2',
            rm.rendaamostragem=new.rendaamostragem
            where rm.codemp=new.codemp and rm.codfilial=new.codfilial and rm.ticket=new.ticket;
        end
        else if (tipoprocrecmerc='PF') then
        begin
            update eqrecmerc rm set rm.status='FN'
            where rm.codemp=new.codemp and rm.codfilial=new.codfilial and rm.ticket=new.ticket;
        end
    end


    -- Executa procedure para atualizao de tabela de vinculo para numeros de serie
    execute procedure eqitrecmercseriesp('U', old.codemp, old.codfilial, old.ticket, old.coditrecmerc, old.codemppd, old.codfilialpd, old.codprod, new.numserie, new.qtditrecmerc);

    -- Atualiza registros de ticket com nmero de srie da tabela eqmovserie
    if (old.codprod <> new.codprod) then
    begin
        update eqmovserie eq set eq.codprod=new.codprod where
        eq.ticket=old.ticket and eq.coditrecmerc=old.coditrecmerc and
        eq.codfilialrc=old.codfilial and eq.codemprc=old.codemp and
        eq.codprod<>new.codprod;
    end

    if (old.numserie <> new.numserie) then
    begin
        update eqmovserie eq set eq.numserie=new.numserie where
        eq.ticket=old.ticket and eq.coditrecmerc=old.coditrecmerc and
        eq.codfilialrc=old.codfilial and eq.codemprc=old.codemp and
        eq.numserie<>new.numserie;
    end
  END
end ^

CREATE TRIGGER EQITRECMERCTGBD FOR EQITRECMERC 
ACTIVE BEFORE DELETE POSITION 0 
AS
begin

    -- Executa procedure para excluso de tabela de vinculo para numeros de serie
    execute procedure eqitrecmercseriesp('D', old.codemp, old.codfilial, old.ticket, old.coditrecmerc, old.codemppd, old.codfilialpd, old.codprod, null, old.qtditrecmerc);


end ^

CREATE TRIGGER EQITRECMERCITCPTGAI FOR EQITRECMERCITCP 
ACTIVE AFTER INSERT POSITION 0 
AS
begin
    -- atualizando status do recebimento de mercadorias

    update eqrecmerc set status='PC'
    where codemp=new.codemp and codfilial=codfilial and ticket=new.ticket;

end ^

CREATE TRIGGER EQITRECMERCITCPTGBU FOR EQITRECMERCITCP 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER EQITRECMERCITOSTGBI FOR EQITRECMERCITOS 
ACTIVE BEFORE INSERT POSITION 0 
AS
declare variable rmaprod char(1);
declare variable tipoprod varchar(2);

begin
    -- Buscando informao do produto
    select pd.rmaprod, pd.tipoprod from eqproduto pd
    where pd.codemp=new.codemppd and pd.codfilial=new.codfilialpd and pd.codprod=new.codprodpd
    into :rmaprod, :tipoprod;

    if('S' = :rmaprod) then
    begin
        
        new.gerarma = 'S';
        new.statusitos = 'AN';

    end

    -- Se o produto  de Comercio, Equipamento ou Fabricao deve sinalizar
    -- o tem de OS como um produto novo, para substituio.

    if(:tipoprod in ('P','E','F')) then
    begin
--        new.gerarma = 'N';
        new.geranovo = 'S';
        new.statusitos = 'AN';
    end


end ^

CREATE TRIGGER EQITRECMERCITOSTGAI FOR EQITRECMERCITOS 
ACTIVE AFTER INSERT POSITION 0 
AS
declare variable num_os_tot integer;
declare variable num_os_status integer;
declare variable status_atual_os char(2);
declare variable novo_status_os char(2);
begin

    if(new.gerarma = 'S') then

    begin
        
        -- Buscando status geral da OS
        select rm.status from eqrecmerc rm
        where rm.codemp=new.codemp and rm.codfilial=new.codfilial and rm.ticket=new.ticket
        into status_atual_os;

        -- Verifica se deve atualizar o status geral da OS
        if(status_atual_os in('PE','AN','EA','EC')) then
        begin

            -- carregando quantidade de itens para a OS
            select count(*) from eqitrecmercitos os
            where os.codemp = new.codemp and os.codfilial=new.codfilial and os.ticket=new.ticket
            into num_os_tot;

            -- carregando quantidade de tens na situao atual
            select count(*) from eqitrecmercitos os
            where os.codemp = new.codemp and os.codfilial=new.codfilial and os.ticket=new.ticket
            and os.statusitos=new.statusitos
            into num_os_status;

            -- Atualizao do status da ordem de servio
    
            if(num_os_status = num_os_tot) then
            begin
                if(new.statusitos = 'AN') then
                begin
                    novo_status_os = 'AN';

                    update eqrecmerc rm set rm.status=:novo_status_os
                    where rm.codemp=new.codemp and rm.codfilial=new.codfilial and rm.ticket=new.ticket;

                end
/*                else
                begin
                    novo_status_os = new.statusitos;
                end*/
    
            end
        end
    end
end ^

CREATE TRIGGER EQITRECMERCITOSTGBU FOR EQITRECMERCITOS 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  IF (new.EMMANUT IS NULL) THEN
     new.EMMANUT='N';
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT=cast('now'AS TIME);
end ^

CREATE TRIGGER EQITRECMERCITOSTGAU FOR EQITRECMERCITOS 
ACTIVE AFTER UPDATE POSITION 0 
as
declare variable num_os_tot integer;
declare variable num_os_tot_item integer;
declare variable num_os_status integer;
declare variable num_os_status_item integer;
declare variable status_atual_os char(2);
declare variable novo_status_os char(2);
declare variable novo_status_it char(2);
declare variable codempoc integer;
declare variable codfilialoc smallint;
declare variable codorc integer;
declare variable tipoorc char(1);
declare variable coditorc smallint;

begin

  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
  BEGIN
    -- Buscando status geral da OS
    select rm.status from eqrecmerc rm
    where rm.codemp=new.codemp and rm.codfilial=new.codfilial and rm.ticket=new.ticket
    into status_atual_os;

    -- Verifica se deve atualizar o status geral da OS
    if(status_atual_os in('PE','AN','EA','EC','OA','EO','PT')) then
    begin

        -- carregando quantidade de itens para a OS
        select count(*) from eqitrecmercitos os
        where os.codemp = new.codemp and os.codfilial=new.codfilial and os.ticket=new.ticket
        into num_os_tot;

        -- carregando quantidade de itens para um item
        select count(*) from eqitrecmercitos os
        where os.codemp = new.codemp and os.codfilial=new.codfilial and os.ticket=new.ticket and os.coditrecmerc=new.coditrecmerc
        into num_os_tot_item;

        -- carregando quantidade de tens na situao atual toda a OS
        select count(*) from eqitrecmercitos os
        where os.codemp = new.codemp and os.codfilial=new.codfilial and os.ticket=new.ticket
        and os.statusitos=new.statusitos
        into num_os_status;

        -- carregando quantidade de tens na situao atual para um item
        select count(*) from eqitrecmercitos os
        where os.codemp = new.codemp and os.codfilial=new.codfilial and os.ticket=new.ticket and os.coditrecmerc=new.coditrecmerc
        and os.statusitos=new.statusitos
        into num_os_status_item;

        -- Atualizao do status da ordem de servio
    
        if(num_os_status = num_os_tot) then
        begin
            if(new.statusitos = 'CO') then
            begin
                novo_status_os = 'PT';
            end
            else
            begin
                novo_status_os = new.statusitos;
            end

           update eqrecmerc rm set rm.status=:novo_status_os
           where rm.codemp=new.codemp and rm.codfilial=new.codfilial and rm.ticket=new.ticket;

        end
        -- Atualizao do status do item da OS
        if(num_os_status_item = num_os_tot_item) then
        begin
        if(new.statusitos = 'CO') then
            begin
                novo_status_it = 'FN';
            end
            else
            begin
                novo_status_it = new.statusitos;
            end

            update eqitrecmerc ir set ir.statusitrecmerc =:novo_status_it
            where ir.codemp=new.codemp and ir.codfilial=new.codfilial and ir.ticket=new.ticket and ir.coditrecmerc=new.coditrecmerc;

        end

    end

    -- Quando tem for concludo, deve alterar o status do oramento para 'PRODUZIDO' OP;

    if(old.statusitos!='CO' and new.statusitos='CO') then
    begin

        for select itos.codempoc, itos.codfilialoc, itos.codorc, itos.tipoorc, itos.coditorc
            from eqitrecmercitositorc itos
            where itos.codemp=new.codemp and itos.codfilial=new.codfilial and itos.ticket=new.ticket
            and itos.coditrecmerc=new.coditrecmerc and itos.coditos=new.coditos
        into :codempoc, :codfilialoc, :codorc, :tipoorc, :coditorc
        do
        begin
            update vditorcamento ito set ito.statusitorc='OP', ito.sitproditorc='PD', ito.aceiteitorc='S', ito.aprovitorc='S'
            where ito.codemp=:codempoc and ito.codfilial=:codfilialoc and ito.tipoorc=:tipoorc and ito.codorc=:codorc and ito.coditorc=:coditorc;
        end

    end
  END
end ^

CREATE TRIGGER EQITRECMERCITOSITORCTGBU FOR EQITRECMERCITOSITORC 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER EQITRECMERCITOSITORCTGAU FOR EQITRECMERCITOSITORC 
ACTIVE AFTER UPDATE POSITION 0 
AS
begin
    -- Atualizando status da OS
    if(old.status!=new.status) then
    begin
        -- Implementar futuramento o status parcial
        update eqitrecmercitos rm set rm.statusitos =new.status
        where rm.codemp=new.codemp and rm.codfilial=new.codfilial and rm.ticket=new.ticket
        and rm.coditrecmerc=new.coditrecmerc and rm.coditos=new.coditos;
    end
end ^

CREATE TRIGGER EQITRECMERCSERIETGBIBU FOR EQITRECMERCSERIE 
ACTIVE BEFORE INSERT POSITION 0 
as
    declare variable temserie smallint;
begin
    -- Verifica se numero de srie j foi inserido nessa entrada
    select count(*) from eqitreCmercserie its
    where its.codemp = new.codemp and its.codfilial=new.codfilial and its.ticket=new.ticket
    and its.codemppd=new.codemppd and its.codfilialpd=new.codfilialpd and its.codprod=new.codprod
    and its.numserie = new.numserie and its.numserie is not null and its.seqitserie!=new.seqitserie
    into temserie;

    if(temserie > 0) then
    begin
        exception cpitcompraex03 new.numserie;
    end

end ^

CREATE TRIGGER EQITRECMERCSERIETGBU FOR EQITRECMERCSERIE 
ACTIVE BEFORE UPDATE POSITION 0 
as
    declare variable temserie smallint;
begin
    -- Atualizando log
    new.DTALT=cast('now' as date);
    new.IDUSUALT=USER;
    new.HALT = cast('now' as time);

    -- Verificando se foi inserido um numero de srie
    if(old.numserie is null and new.numserie is not null) then
    begin
        -- Verificando se o nmero de srie informado, j existe.
        select count(*) from eqserie sr
        where sr.codemp = new.codemppd and sr.codfilial = new.codfilialpd and sr.codprod = new.codprod and sr.numserie = new.numserie
        into :temserie;

        -- se o nmero de srie informado no existe, deve inseri-lo;
        if (temserie = 0) then
        begin
            insert into eqserie (codemp, codfilial, codprod, numserie)
            values(new.codemppd, new.codfilialpd, new.codprod, new.numserie);
        end

    end

end ^

CREATE TRIGGER EQITRECMERCSERIETGAI FOR EQITRECMERCSERIE 
ACTIVE BEFORE INSERT OR UPDATE POSITION 0 
AS
   declare variable docrecmerc integer;
begin
    if(new.numserie is not null)then
        begin
            select docrecmerc from eqrecmerc where codemp=new.codemp and 
               codfilial=new.codfilial and ticket=new.ticket 
               into :docrecmerc; 
            insert into eqmovserie (codemp, codfilial, codemppd, codfilialpd, codprod,
                codemprc, codfilialrc, ticket, coditrecmerc,
                numserie, dtmovserie, tipomovserie, docmovserie )
            values(new.codemp, new.codfilial, new.codemppd, new.codfilialpd, new.codprod,
                   new.codemp, new.codfilial, new.ticket, new.coditrecmerc,
                   new.numserie,  current_timestamp , 1, :docrecmerc );
        end
end ^

CREATE TRIGGER EQITRMATGBI FOR EQITRMA 
ACTIVE BEFORE INSERT POSITION 0 
AS
begin
  IF (new.CODALMOX IS NULL) THEN
       SELECT CODEMPAX,CODFILIALAX,CODALMOX FROM EQPRODUTO WHERE
          CODEMP=new.CODEMPPD AND CODFILIAL=new.CODFILIALPD AND CODPROD=new.CODPROD
       INTO new.CODEMPAX, new.CODFILIALAX,new.CODALMOX;
  if (new.QTDAPROVITRMA>new.QTDITRMA) then
     exception eqitrma;

end ^

CREATE TRIGGER EQITRMATGAI FOR EQITRMA 
ACTIVE AFTER INSERT POSITION 0 
AS
    declare variable DDTRMA date;
    declare variable ICODEMPTM int;
    declare variable ICODFILIALTM smallint;
    declare variable ICODTIPOMOV int;
    declare variable ICODOP int;
    declare variable QTD decimal(15,5);
    declare variable CBAIXARMAAPROV char(1);

    begin

        select r.dtareqrma,r.codemptm,r.codfilialtm,r.codtipomov,r.codop
            from eqrma r
                where r.codrma=new.codrma and r.codemp=new.codemp and r.codfilial=new.codfilial
        into :DDTRMA,:ICODEMPTM,:ICODFILIALTM,:ICODTIPOMOV,:ICODOP;

        select baixarmaaprov from sgprefere5
            where codemp=new.codemp and codfilial=new.codfilial
        into :CBAIXARMAAPROV;

        if(:CBAIXARMAAPROV='S' AND :ICODOP IS NOT NULL) THEN
        begin
            QTD = new.qtdaprovitrma;
        end
        else
            QTD = new.qtdexpitrma;

        execute procedure eqmovprodiudsp('I',new.CODEMPPD, new.CODFILIALPD, new.CODPROD,
            new.CODEMPLE, new.CODFILIALLE, new.codlote, :ICODEMPTM,:ICODFILIALTM,:ICODTIPOMOV,
            null, null, null ,null, null, null, null, null, null, null, null, null, new.CODEMP,
            new.CODFILIAL, new.codrma, new.coditrma, null, null, null, null,null,null,null,null,
            :DDTRMA, new.codrma, 'N', :QTD, new.precoitrma, new.CODEMPAX,
            new.CODFILIALAX, new.CODALMOX, null, 'S', 'N');
end ^

CREATE TRIGGER EQITRMATGBU FOR EQITRMA 
ACTIVE BEFORE UPDATE POSITION 0 
AS
    declare variable statusitem char(2);

begin


    -- Verifica se tabela est em manuteno // caso no esteja inicia procedimentos
    if ( new.emmanut is null) then
        new.emmanut='N';

    if ( not ( (new.emmanut='S') or ( (old.emmanut='S') and (old.emmanut is not null) )) ) then
    begin

       -- Atualizando log.
       new.dtalt = cast('now' AS DATE);
       new.idusualt = USER;
       new.halt = cast('now' AS TIME);

       -- Acertando almoxarifado (quando no informado)
       if (new.codalmox is null) then
           select CODEMPAX,CODFILIALAX,CODALMOX from eqproduto where
               codemp=new.codemppd and codfilial=new.codfilialpd and codprod=new.codprod
           into new.codempax, new.codfilialax,new.codalmox;

       -- Acertando os status.
       if (old.sititrma!='AF') then
       begin
           if (new.qtdaprovitrma!=old.qtdaprovitrma or (NEW.sitaprovitrma='AT') ) then
           begin
               if ((new.sitaprovitrma='AT') and (new.qtdaprovitrma=0) and (old.sitaprovitrma!='AT')) then
               begin
                   new.qtdaprovitrma=new.qtditrma;
               end
               if (new.qtdaprovitrma>0) then
               begin
                   if (new.qtdaprovitrma<new.qtditrma) then
                   begin
                       statusitem = 'AP'; -- Aprovao parcial
                   end
                   else
                   begin
                       statusitem = 'AT'; -- Aprovao total
                   end

                   -- atualizando status e data da aprovao
                   new.sitaprovitrma=:statusitem;
                   new.dtaprovitrma=cast('today' as date);

                   if(new.sititrma='PE') then
                   begin
                       new.sititrma='EA';
                   end
               end
           end
       end
       else if (old.sititrma!='EF') then
       begin
           if (new.qtdexpitrma!=old.qtdexpitrma or (NEW.sitexpitrma='ET') ) then
           begin
               if ((new.sitexpitrma='ET') and (new.qtdexpitrma=0) and (old.sitexpitrma!='ET')) then
               begin
                   new.qtdexpitrma=new.qtdaprovitrma;
               end
               if (new.qtdexpitrma>0) then
               begin
                   if (new.qtdexpitrma<new.qtdaprovitrma) then
                   begin
                       statusitem = 'EP'; -- Expedio parcial
                   end
                   else
                   begin
                       statusitem = 'ET'; -- Expedio total
                   end

                   -- Atualizando status e data da expedio
                   new.sitexpitrma=:statusitem;
                   new.dtaexpitrma=cast('today' as date);

                   -- Atualizando custo do produto no momento da expedio.
                   select ncustompmax from eqprodutosp01(new.codemppd,new.codfilialpd,new.codprod,new.codempax,new.codfilialax,new.codalmox)
                   into new.precoitrma;

               end
           end
       end
       if(new.sititrma='CA') then
       begin
           new.qtdaprovitrma=0;
           new.qtdexpitrma=0;
           new.sitaprovitrma='NA';
           new.sitexpitrma='NA';
       end
    end
end ^

CREATE TRIGGER EQITRMATGAU FOR EQITRMA 
ACTIVE AFTER UPDATE POSITION 0 
as
    declare variable icodemptm int;
    declare variable icodfilialtm smallint;
    declare variable icodtipomov int;
    declare variable ddtrma date;
    declare variable baixarmaaprov char(1);
    declare variable estoque char(1);
    declare variable qtdmov numeric(15,5);

begin
    -- Verifica se tabela est em manuteno // caso no esteja inicia procedimentos
    -- if ( new.emmanut is null) then
    --     new.emmanut='N';

    if ( not ( (new.emmanut='S') or ( (old.emmanut='S') and (old.emmanut is not null) )) ) then
    begin


        -- Carregando preferncias
        select baixarmaaprov from sgprefere5
        where codemp=new.codemp and codfilial=new.codfilial
        into :baixarmaaprov;
    
        qtdmov = new.qtdexpitrma;
    
        if(:baixarmaaprov='S' and new.sitaprovitrma in ('AT','AP')) then
        begin
            estoque = 'S';
            qtdmov = new.qtdaprovitrma;
        end
        else
        begin
            estoque = 'N';
        end
    
    
        -- Carregando informaes do cabealho (RMA)
        select r.dtareqrma,r.codemptm,r.codfilialtm,r.codtipomov
        from eqrma r
        where r.codrma = new.codrma and r.codemp=new.codemp and r.codfilial = new.codfilial
        into :ddtrma,:icodemptm,:icodfilialtm,:icodtipomov;
    
        -- Movimentao de estoque
        execute procedure eqmovprodiudsp('U',new.codemppd, new.codfilialpd, new.codprod,
            new.codemple, new.codfilialle, new.codlote, :icodemptm,:icodfilialtm, :icodtipomov,
            null, null, null ,null, null,null, null, null, null, null, null, null,
            new.codemp, new.codfilial, new.codrma, new.coditrma, null, null, null, null,
            null, null, null, null, :ddtrma, new.codrma, :estoque, :qtdmov, new.precoitrma,
            new.codempax, new.codfilialax, new.codalmox, null, 'S', 'N' );
    
   end
   
end ^

CREATE TRIGGER EQITRMATGBD FOR EQITRMA 
ACTIVE BEFORE DELETE POSITION 0 
AS
declare variable sUsuarioCN char(8);
declare variable sUsuarioRM char(8);
declare variable apagarmaop char(1);
declare variable icodfilialpref smallint;
declare variable icodop integer;
begin

       if(old.sititrma<>'PE') then
       begin
    --      exception eqitrma01;
       end
    
       select icodfilial from sgretfilial(old.codemp,'SGPREFERE5') into :icodfilialpref;
    
       select idusus from sgretinfousu(old.CODEMP, USER)
          into :sUsuarioCN;
    
       select rm.idusu,rm.codop from eqrma rm
          where rm.codemp=old.codemp and rm.codfilial=old.codfilial and rm.codrma=old.codrma
          into :sUsuarioRM, :icodop;
    
       select p.apagarmaop from sgprefere5 p
          where p.codemp=old.codemp and p.codfilial=:icodfilialpref
          into :apagarmaop;
    
       if(:icodop is null) then
       begin
           if(:sUsuarioCN<>:sUsuarioRM)then
           begin
    --          exception eqitrma02;
           end
       end
       else
       begin
          if(:apagarmaop='N' and :sUsuarioCN<>:sUsuarioRM) then
           begin
     --         exception eqitrma02;
           end
       end
       
end ^

CREATE TRIGGER EQITRMATGAD FOR EQITRMA 
ACTIVE AFTER DELETE POSITION 0 
AS
  DECLARE VARIABLE DDTRMA DATE;
  DECLARE VARIABLE ICODEMPTM INT;
  DECLARE VARIABLE ICODFILIALTM SMALLINT;
  declare VARIABLE ICODTIPOMOV INT ;

  begin
  
      SELECT R.DTAREQRMA,R.codemptm,R.codfilialtm,R.codtipomov
        FROM EQRMA R
        WHERE R.CODRMA = OLD.CODRMA AND R.CODEMP=OLD.CODEMP AND R.CODFILIAL = OLD.CODFILIAL
        INTO :DDTRMA,:ICODEMPTM,:ICODFILIALTM,:ICODTIPOMOV;

      EXECUTE PROCEDURE EQMOVPRODIUDSP('D',OLD.CODEMPPD, OLD.CODFILIALPD, OLD.CODPROD,
        OLD.CODEMPLE, OLD.CODFILIALLE, OLD.codlote, :ICODEMPTM,
        :ICODFILIALTM, :ICODTIPOMOV, null, null, null ,null, null,
        null, null, null, null, null, null,
        null, OLD.CODEMP, OLD.CODFILIAL, OLD.codrma, OLD.coditrma, null, null, null,null,
        null,null,null,null, :DDTRMA, OLD.codrma, 'N', OLD.qtdexpitrma, OLD.precoitrma,
        OLD.CODEMPAX, OLD.CODFILIALAX, OLD.CODALMOX, null, 'S', 'N');
end ^

CREATE TRIGGER EQITRMATGAIAU FOR EQITRMA 
ACTIVE AFTER INSERT OR UPDATE POSITION 2 
AS
declare variable icodemptm int;
declare variable icodfilialtm smallint;
declare variable icodtipomov integer;
begin

    if ( not ( (new.emmanut='S') or ( (old.emmanut='S') and (old.emmanut is not null) )) ) then
    begin

      if(new.sititrma='EF') then
      begin
        select tm.codemptm,tm.codfilialtm,tm.codtipomovtm from eqtipomov tm, eqrma rm
           where tm.codemp=rm.codemptm and tm.codfilial=rm.codfilialtm and tm.codtipomov=rm.codtipomov
           and rm.codemp=new.codemp and rm.codfilial=new.codfilial and codrma=new.codrma
           into :icodemptm,:icodfilialtm,:icodtipomov;
        if((:icodemptm is not null) and (:icodfilialtm is not null) and (:icodtipomov is not null)) then
        begin
           update eqrma set codemptm=:icodemptm, codfilialtm=:icodfilialtm, codtipomov=:icodtipomov where
           codemp=new.codemp and codfilial=new.codfilial and codrma=new.codrma;
        end
        
     end
  end

  -- Atualizao do status do item de ordem de servio ao expedir o item de rma
  if( new.coditos is not null and new.sitexpitrma in ('ET','EP')) then
  begin

    update eqitrecmercitos ios set ios.statusitos='CO'
    where ios.codemp=new.codempos and ios.codfilial=new.codfilialos and ios.ticket=new.ticket
    and ios.coditrecmerc = new.coditrecmerc and ios.coditos=new.coditos;

  end

end ^

CREATE TRIGGER EQITRMASTRMA FOR EQITRMA 
ACTIVE AFTER INSERT OR UPDATE OR DELETE POSITION 1 
AS
  declare variable numitens int;
  declare variable numitensaf int;
  declare variable numitensap int;
  declare variable numitensna int;
  declare variable numitensat int;
  declare variable numitensef int;
  declare variable numitensca int;
  declare variable numitensep int;
  declare variable numitensne int;
  declare variable numitenset int;

begin

  if ( not ( (new.emmanut='S') or ( (old.emmanut='S') and (old.emmanut is not null) )) ) then
  begin

      if (old.sititrma!='AF') then
      begin
          select count(1) from eqitrma where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma into :numitens;
          select count(1) from eqitrma where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sititrma='AF' into :numitensaf;
          select count(1) from eqitrma where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sititrma='EF' into :numitensef;
          select count(1) from eqitrma where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sititrma='CA' into :numitensca;
          if(:numitens=:numitensaf) then
          begin
            update eqrma set sitrma='AF' where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sitrma!='AF';
          end
          else if (:numitens=:numitensef) then
          begin
            update eqrma set sitrma='EF' where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sitrma!='EF';
          end
          else if (:numitens=:numitensca) then
          begin
            update eqrma set sitrma='CA' where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sitrma!='CA';
          end
          if (new.qtdaprovitrma!=old.qtdaprovitrma) then
          begin
              if (new.qtdaprovitrma>0) then
              begin
                  update eqrma set sitrma='EA' where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sitrma='PE';
                  select count(1) from eqitrma where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sitaprovitrma='AP' into :numitensap;
                  select count(1) from eqitrma where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sitaprovitrma='NA' into :numitensna;
                  select count(1) from eqitrma where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sitaprovitrma='AT' into :numitensat;
                  if(:numitens!=:numitensaf) then
                  begin
                    if(:numitens=:numitensat) then
                    begin
                       update eqrma set sitaprovrma='AT' where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sitaprovrma!='AT';
                    end
                    else if((:numitensap>0) or (:numitensna>0)) then
                    begin
                       update eqrma set sitaprovrma='AP' where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sitaprovrma!='AP';
                    end
                    if(:numitens=:numitensna) then
                    begin
                       update eqrma set sitaprovrma='NA' where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma  and sitaprovrma!='NA';
                    end
                  end
              end
          end
      end
      else if (old.sititrma!='EF') then
      begin
          select count(1) from eqitrma where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma into :numitens;
          select count(1) from eqitrma where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sititrma='EF' into :numitensef;
          if (:numitens=:numitensef) then
          begin
            update eqrma set sitrma='EF' where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sitrma!='EF';
          end
          if (new.qtdexpitrma!=old.qtdexpitrma) then
          begin
              if (new.qtdexpitrma>0) then
              begin
                  select count(1) from eqitrma where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sitexpitrma='EP' into :numitensep;
                  select count(1) from eqitrma where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sitexpitrma='NE' into :numitensne;
                  select count(1) from eqitrma where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sitexpitrma='ET' into :numitenset;
                  if(:numitens!=:numitensef) then
                  begin
                    if(:numitens=:numitenset) then
                    begin
                       update eqrma set sitexprma='ET' where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sitexprma!='ET';
                    end
                    else if((:numitensep>0) or (:numitensne>0)) then
                    begin
                       update eqrma set sitexprma='EP' where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma and sitexprma!='EP';
                    end
                    if(:numitens=:numitensne) then
                    begin
                       update eqrma set sitaprovrma='NE' where codemp=new.codemp and codfilial=new.codfilial and codrma = new.codrma  and sitexprma!='NE';
                    end
                  end
              end
          end
      end
  end
end ^

CREATE TRIGGER EQITSIMILARBI FOR EQITSIMILAR 
ACTIVE BEFORE INSERT POSITION 0 
AS
 declare variable ICODPROD INTEGER;
begin
  SELECT CODPROD FROM EQITSIMILAR ITS
     WHERE ITS.CODEMPPD=new.CODEMPPD AND ITS.CODFILIALPD=new.CODFILIALPD AND
       ITS.CODPROD=new.CODPROD AND ITS.CODSIM != new.CODSIM
       INTO :ICODPROD;
  if (ICODPROD IS NOT NULL) then
     exception EQSIMILAREX01;
  SELECT REFPROD FROM EQPRODUTO WHERE CODEMP=new.CODEMPPD and CODFILIAL=new.CODFILIALPD
     AND CODPROD=new.CODPROD INTO new.REFPROD;

end ^

CREATE TRIGGER EQITSIMILARBU FOR EQITSIMILAR 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  IF (new.EMMANUT IS NULL) THEN
     new.EMMANUT='N';
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
  BEGIN  
      SELECT REFPROD FROM EQPRODUTO WHERE CODEMP=new.CODEMPPD and CODFILIAL=new.CODFILIALPD
         AND CODPROD=new.CODPROD INTO new.REFPROD;
  END
end ^

CREATE TRIGGER EQITVARGRADETGBU FOR EQITVARGRADE 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER EQLANCTOEXPTGBU FOR EQLANCTOEXP 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER EQLOCDESCARGA FOR EQLOCDESCARGA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT=cast('now'AS TIME);
end ^

CREATE TRIGGER EQLOTETGBI FOR EQLOTE 
ACTIVE BEFORE INSERT POSITION 0 
as
begin
  if (new.SLDLOTE is null) then
     new.SLDLOTE = 0;
  if (new.SLDRESLOTE is null) then
     new.SLDRESLOTE = 0;
  if (new.SLDCONSIGLOTE is null) then
     new.SLDCONSIGLOTE = 0;
  new.SLDLIQLOTE = new.SLDLOTE-new.SLDRESLOTE-new.SLDCONSIGLOTE;
end ^

CREATE TRIGGER EQLOTETGBU FOR EQLOTE 
ACTIVE BEFORE UPDATE POSITION 0 
as
  DECLARE VARIABLE ICODFILIAL INTEGER;
  DECLARE VARIABLE CESTLOTNEG CHAR(1);
  DECLARE VARIABLE CESTNEGGRUP CHAR(1);
  DECLARE VARIABLE CESTLOTNEGGRUP CHAR(1);
begin
  SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'SGPREFERE1') INTO :iCodFilial;
  SELECT ESTLOTNEG,ESTNEGGRUP FROM SGPREFERE1 WHERE CODEMP=new.CODEMP AND CODFILIAL=:iCodFilial
     INTO :cEstLotNeg, :cEstNegGrup;
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  if (new.SLDLOTE is null) then
     new.SLDLOTE = 0;
  if (new.SLDRESLOTE is null) then
     new.SLDRESLOTE = 0;
  if (new.SLDCONSIGLOTE is null) then
     new.SLDCONSIGLOTE = 0;
  new.SLDLIQLOTE = new.SLDLOTE-new.SLDRESLOTE-new.SLDCONSIGLOTE;
  if (cEstNegGrup is null) then
      cEstNegGrup ='N';
  if (cEstLotNeg Is null) then
      cEstLotNeg = 'N';

  if ( new.SLDLOTE < 0) then
  begin
     if (cEstNegGrup = 'S') then
     begin
        SELECT G.ESTLOTNEGGRUP FROM EQGRUPO G, EQPRODUTO P
          WHERE P.CODEMP=new.CODEMP AND P.CODFILIAL=new.CODFILIAL AND
            P.CODPROD=new.CODPROD AND G.CODEMP=P.CODEMPGP AND
            G.CODFILIAL=P.CODFILIALGP AND G.CODGRUP=P.CODGRUP
          INTO :cEstLotNegGrup;
        if (cEstLotNegGrup is null) then
           cEstLotNegGrup = 'N';
        if (cEstLotNegGrup='N') then
           EXCEPTION EQLOTEEX01 'O LOTE '||rtrim(new.CODLOTE)||
              ' NO POSSUI SALDO P/COMPL. A OPERAO';
     end
     else if (cEstLotNeg='N') then
           EXCEPTION EQLOTEEX01 'O LOTE '||rtrim(new.CODLOTE)||
              ' NO POSSUI SALDO P/COMPL. A OPERAO';
  end
end ^

CREATE TRIGGER EQMARCATGBU FOR EQMARCA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER EQMODGRADETGBU FOR EQMODGRADE 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER EQMODLOTETGBU FOR EQMODLOTE 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER EQMOVEXPTGBU FOR EQMOVEXP 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER EQMOVPRODTGAI FOR EQMOVPROD 
ACTIVE AFTER INSERT POSITION 0 
AS
DECLARE VARIABLE SOPERADOR SMALLINT;
BEGIN
  IF (new.ESTOQMOVPROD='S') THEN
  BEGIN
      IF (new.TIPOMOVPROD = 'S') THEN
         SOPERADOR = -1;
      ELSE
         SOPERADOR = 1;
      EXECUTE PROCEDURE EQMOVPRODATEQSP(new.CODEMPPD, new.CODFILIALPD, new.CODPROD,
        null, null, null,
        new.CODEMPLE, new.CODFILIALLE, new.CODLOTE,
        :SOPERADOR, 0, new.QTDMOVPROD,
        null, null, null,
        new.CODEMPAX, new.CODFILIALAX, new.CODALMOX);
  END
END ^

CREATE TRIGGER EQMOVPRODTGBU FOR EQMOVPROD 
ACTIVE BEFORE UPDATE POSITION 0 
AS
BEGIN
  IF ( new.EMMANUT IS NULL) THEN
      new.EMMANUT='N';
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT IS NOT NULL) )) ) THEN
  BEGIN
     new.DTALT=cast('now' AS DATE);
     new.IDUSUALT=USER;
     new.HALT = cast('now' AS TIME);
  END
END ^

CREATE TRIGGER EQMOVPRODTGAU FOR EQMOVPROD 
ACTIVE AFTER UPDATE POSITION 0 
AS
DECLARE VARIABLE SOPERADOR SMALLINT;
DECLARE VARIABLE NQTDMOVPRODOLD NUMERIC(15, 5);
DECLARE VARIABLE NQTDMOVPRODNEW NUMERIC(15, 5);
BEGIN
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT IS NOT NULL) ) ) ) THEN
  BEGIN

      IF ( ( old.ESTOQMOVPROD='S' ) OR (new.ESTOQMOVPROD='S') ) THEN
      BEGIN
          NQTDMOVPRODOLD = old.QTDMOVPROD;
          NQTDMOVPRODNEW = new.QTDMOVPROD;
          IF (new.TIPOMOVPROD = 'S') THEN /* Se for sada tem que diminuir do estoque */
            SOPERADOR = -1;
          ELSE
            SOPERADOR = 1;
          /* Caso o flag de controle de estoque tenha mudado */
          IF ( (old.ESTOQMOVPROD='S') AND (new.ESTOQMOVPROD='N') ) THEN
              NQTDMOVPRODNEW = 0;
          ELSE IF ( (old.ESTOQMOVPROD='N') AND (new.ESTOQMOVPROD='S') ) THEN
              NQTDMOVPRODOLD = 0;
          EXECUTE PROCEDURE EQMOVPRODATEQSP(new.CODEMPPD, new.CODFILIALPD, new.CODPROD,
            old.CODEMPLE, old.CODFILIALLE, old.CODLOTE,
            new.CODEMPLE, new.CODFILIALLE, new.CODLOTE,
            :SOPERADOR, NQTDMOVPRODOLD, NQTDMOVPRODNEW,
            old.CODEMPAX, old.CODFILIALAX, old.CODALMOX,
            new.CODEMPAX, new.CODFILIALAX, new.CODALMOX);
      END
   END
END ^

CREATE TRIGGER EQMOVPRODTGAD FOR EQMOVPROD 
ACTIVE AFTER DELETE POSITION 0 
AS
  DECLARE VARIABLE SOPERADOR SMALLINT;
BEGIN
  
  IF ( not ( (old.EMMANUT='S') and (old.EMMANUT IS NOT NULL) ) ) THEN
  BEGIN
      IF (old.ESTOQMOVPROD = 'S') THEN
      BEGIN
          IF (old.TIPOMOVPROD = 'S') THEN
            SOPERADOR = -1;
          ELSE
            SOPERADOR = 1;
          EXECUTE PROCEDURE EQMOVPRODATEQSP(old.CODEMPPD, old.CODFILIALPD, old.CODPROD,
            old.CODEMPLE, old.CODFILIALLE, old.CODLOTE,
            old.CODEMPLE, old.CODFILIALLE, old.CODLOTE,
            :SOPERADOR, old.QTDMOVPROD, 0,
            old.CODEMPAX, old.CODFILIALAX, old.CODALMOX,
            old.CODEMPAX, old.CODFILIALAX, old.CODALMOX);
       END
   END
 /* EXECUTE PROCEDURE EQMOVPRODATCUSTSP(old.CODEMPPD, old.CODFILIALPD, old.CODPROD, SOPERADOR); */
END ^

CREATE TRIGGER EQMOVSERIETGBI FOR EQMOVSERIE 
ACTIVE BEFORE INSERT POSITION 0 
AS 
    declare variable codmovserie integer;
begin

    select max (eqmovserie.codmovserie) from eqmovserie into :codmovserie;

    if( codmovserie is null) then
    begin
        codmovserie = 0;
    end

    new.codmovserie = :codmovserie + 1;

end ^

CREATE TRIGGER EQMOVSERIETGBU FOR EQMOVSERIE 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER EQPREVESTOQLOGTGBU FOR EQPREVESTOQLOG 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER EQPROCEXPEDTGBU FOR EQPROCEXPED 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.dtalt=cast('now' AS DATE);
  new.idusualt=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER EQPROCRECTGBU FOR EQPROCRECMERC 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.dtalt=cast('now' AS DATE);
  new.idusualt=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER EQPRODACESSOTGBU FOR EQPRODACESSO 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  new.IDUSUALT=USER;
  new.DTALT=cast('now' AS DATE);
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER EQPRODPLANBU FOR EQPRODPLAN 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);

end ^

CREATE TRIGGER EQPRODUTOTGBI FOR EQPRODUTO 
ACTIVE BEFORE INSERT POSITION 0 
as
begin
  if (new.SLDPROD is null) then
     new.SLDPROD = 0;
  if (new.SLDRESPROD is null) then
     new.SLDRESPROD = 0;
  if (new.SLDCONSIGPROD is null) then
     new.SLDCONSIGPROD = 0;
  new.SLDLIQPROD = new.SLDPROD-new.SLDRESPROD-new.SLDCONSIGPROD;
end ^

CREATE TRIGGER EQPRODUTOTGAI FOR EQPRODUTO 
ACTIVE AFTER INSERT POSITION 0 
AS
begin
    -- Inserindo registro na tabela de log do produto (para permitir processamento de preos
    insert into eqprodutolog(codemp, codfilial, codprod, seqlog, precobaseprodant, precobaseprodnovo)
    values (new.codemp, new.codfilial, new.codprod, 1, 0.00, new.precobaseprod);
end ^

CREATE TRIGGER EQPRODUTOTGBU FOR EQPRODUTO 
ACTIVE BEFORE UPDATE POSITION 0 
as
  DECLARE VARIABLE ICODFILIAL INTEGER;
  DECLARE VARIABLE CESTNEG CHAR(1);
  DECLARE VARIABLE CESTNEGGRUPPREF CHAR(1);
  DECLARE VARIABLE CESTNEGGRUP CHAR(1);
  DECLARE VARIABLE ICODPROD INTEGER;
begin
  IF (new.EMMANUT IS NULL) THEN
     new.EMMANUT='N';
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
  BEGIN
      SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'SGPREFERE1') INTO :iCodFilial;
      SELECT ESTNEG, ESTNEGGRUP FROM SGPREFERE1
         WHERE CODEMP=new.CODEMP AND CODFILIAL=:iCodFilial
         INTO :cEstNeg, :cEstNegGrupPref;
      if (new.SLDPROD is null) then
         new.SLDPROD = 0;
      if (new.SLDRESPROD is null) then
         new.SLDRESPROD = 0;
      if (new.SLDCONSIGPROD is null) then
         new.SLDCONSIGPROD = 0;
      new.SLDLIQPROD = new.SLDPROD-new.SLDRESPROD-new.SLDCONSIGPROD;
      if (cEstNeg Is null) then
          cEstNeg = 'N';
      if (cEstNegGrupPref is null) then
          cEstNegGrupPref = 'N';
      if ((new.SLDPROD < 0) AND (new.TIPOPROD='P') ) THEN
      begin
        if (cEstNegGrupPref = 'S') then
        begin
           SELECT ESTNEGGRUP FROM EQGRUPO
             WHERE CODEMP=new.CODEMPGP AND CODFILIAL=new.CODFILIALGP AND
                CODGRUP=new.CODGRUP INTO :CESTNEGGRUP;
           if (cEstNegGrup is null) then
              cEstNegGrup = 'N';
           if (cEstNegGrup='N') then
              EXCEPTION EQPRODUTOEX01 'O PROD. '||rtrim(cast(new.CODPROD as char(10)))
                ||'-'||substring(new.DESCPROD from 1 for 20)||
              ' NO POSSUI SALDO P/COMPL. A OPERAO';
        end
        else if (cEstNeg='N') then
              EXCEPTION EQPRODUTOEX01 'O PROD. '||rtrim(cast(new.CODPROD as char(10)))
                ||'-'||substring(new.DESCPROD from 1 for 20)||
              ' NO POSSUI SALDO P/COMPL. A OPERAO';
      end
      if ( new.REFPROD != old.REFPROD ) then
      begin
         SELECT FIRST 1 CODPROD FROM EQMOVPROD WHERE CODEMPPD=new.CODEMP AND
            CODFILIALPD=new.CODFILIAL AND CODPROD=new.CODPROD
              INTO :ICODPROD;
         if ( (ICODPROD IS NOT NULL) AND (ICODPROD=new.CODPROD) ) then
            EXCEPTION EQPRODUTOEX01 'REFERNCIA NO PODE SER ALTERADA. PRODUTO POSSUI MOVIMENTO!';
         else
            UPDATE EQCODALTPROD SET REFPROD=new.REFPROD WHERE CODEMP=new.CODEMP AND
              CODFILIAL=new.CODFILIAL AND CODPROD=new.CODPROD;
      end
  END
end ^

CREATE TRIGGER EQPRODUTOTGAU FOR EQPRODUTO 
ACTIVE AFTER UPDATE POSITION 0 
AS
    declare variable seqlog integer;
begin
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
  BEGIN  
    --Verifica se o preo foi realmente alterado;
    if(new.precobaseprod != old.precobaseprod) then
    begin
    
      select coalesce(max(seqlog),0) + 1 from eqprodutolog
      where codemp=new.codemp and codfilial=new.codfilial and codprod=new.codprod
      into :seqlog;

      insert into eqprodutolog(codemp, codfilial, codprod, seqlog, precobaseprodant, precobaseprodnovo)
      values (new.codemp, new.codfilial, new.codprod, coalesce(:seqlog,1), old.precobaseprod, new.precobaseprod);

    end
  END
end ^

CREATE TRIGGER EQPRODUTOLOGTGBU FOR EQPRODUTOLOG 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER EQRECAMOSTRAGEM_BI FOR EQRECAMOSTRAGEM 
ACTIVE BEFORE INSERT POSITION 0 
AS
BEGIN
  IF (NEW.SEQAMOSTRAGEM IS NULL or (NEW.SEQAMOSTRAGEM=0)  ) THEN
    NEW.SEQAMOSTRAGEM = GEN_ID(EQRECAMOSTRAGEMINC,1);
END ^

CREATE TRIGGER EQRECAMOSTRAGEMTGAI FOR EQRECAMOSTRAGEM 
ACTIVE AFTER INSERT POSITION 0 
as

    declare variable nroamostprocrecmercval smallint;
    declare variable nroamostprocrecmercatu smallint;

begin

    -- buscando quantidade de amostras necessrias para finalizao

    select pr.nroamostprocrecmerc
    from eqprocrecmerc pr, eqitrecmerc ir
    where ir.codemp=new.codemp and ir.codfilial=new.codfilial and ir.ticket=new.ticket and ir.coditrecmerc=new.coditrecmerc
    and pr.codemp=ir.codemptp and pr.codfilial=ir.codfilialtp and pr.codtiporecmerc=ir.codtiporecmerc and pr.codprocrecmerc=ir.codprocrecmerc
    into :nroamostprocrecmercval;

    select count(*) from eqrecamostragem am
    where am.codemp=new.codemp and am.codfilial=new.codfilial and am.ticket=new.ticket and am.coditrecmerc=new.coditrecmerc
    into :nroamostprocrecmercatu;

--    exception vdvendaex01 'nrovalida:' || nroamostprocrecmercval;
--    exception vdvendaex01 'nroatu   :' || nroamostprocrecmercatu;

    -- Atualizando status do recebimento
    -- Primeira pesagem

    if( :nroamostprocrecmercval = :nroamostprocrecmercatu) then
    begin
        
--        exception vdvendaex01 'entrou no update' || nroamostprocrecmercval;

        update eqitrecmerc itr set itr.statusitrecmerc='FN'
        where itr.codemp=new.codemp and itr.codfilial=new.codfilial and itr.ticket=new.ticket
        and itr.coditrecmerc=new.coditrecmerc;
    end

end ^

CREATE TRIGGER EQRECAMOSTRAGEMTGBU FOR EQRECAMOSTRAGEM 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
    new.dtalt = cast('now' as date);
    new.idusualt = user;
    new.halt = cast('now' as time);
end ^

CREATE TRIGGER EQRECMERCTGAI FOR EQRECMERC 
ACTIVE AFTER INSERT POSITION 0 
as
declare variable codemptp integer;
declare variable codfilialtp smallint;
declare variable codtiporecmerc integer;
declare variable codprocrecmerc integer;
declare variable coditrecmerc integer;

begin

    -- Se tiver um produto padro no cabealho, deve gerar os tens automaticamente.
    if(new.codprod is not null) then
    begin

        coditrecmerc = 1;
    
        for select pr.codemp, pr.codfilial, pr.codtiporecmerc, pr.codprocrecmerc
        from eqprocrecmerc pr
        where pr.codemp=new.codemptr and pr.codfilial=new.codfilialtr and pr.codtiporecmerc=new.codtiporecmerc
        into :codemptp,  :codfilialtp, :codtiporecmerc, :codprocrecmerc do
        begin

            select coalesce( max(coditrecmerc) , 0 ) + 1
            from eqitrecmerc rm
            where rm.codemp=new.codemp and rm.codfilial=new.codfilial and rm.ticket=new.ticket
            into coditrecmerc;
        
            insert into eqitrecmerc
            ( codemp, codfilial, ticket, coditrecmerc, codemppd, codfilialpd, codprod, refprod, codemptp, codfilialtp, codtiporecmerc, codprocrecmerc ) values
            ( new.codemp, new.codfilial, new.ticket, :coditrecmerc, new.codemppd, new.codfilial, new.codprod, new.refprod, :codemptp, :codfilialtp, :codtiporecmerc, :codprocrecmerc );


        end
    end

end ^

CREATE TRIGGER EQRECMERCTGBU FOR EQRECMERC 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  IF (new.EMMANUT IS NULL) THEN
     new.EMMANUT='N';
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT=cast('now'AS TIME);
end ^

CREATE TRIGGER EQRECMERCTGAU FOR EQRECMERC 
ACTIVE AFTER UPDATE POSITION 0 
AS
begin
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
  BEGIN
    -- Mecanismo de contingncia do status dos itens de OS

    if( new.status='PT' ) then
    begin
        update eqitrecmercitos set statusitos = 'CO'
        where codemp=new.codemp and codfilial=new.codfilial and ticket = new.ticket and statusitos!='CO';
    end
 END
end ^

CREATE TRIGGER EQRMATGBI FOR EQRMA 
ACTIVE BEFORE INSERT POSITION 0 
AS
begin
    new.DTINS=cast('now' AS DATE);
    new.IDUSUINS=user;
    new.HINS=cast('now' AS TIME);
end ^

CREATE TRIGGER EQRMATGBU FOR EQRMA 
ACTIVE BEFORE UPDATE POSITION 0 
as
  DECLARE VARIABLE ICODEMPUSU INT;
  declare variable ICODFILIALUSU smallint;
  declare variable IDUSU char(8);
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  if((new.idusuaprov is null) and (new.sitaprovrma!=old.sitaprovrma)) then
  begin
    SELECT CODEMPUSU,CODFILIALUSU,IDUSUS FROM sgretinfousu(new.CODEMP, USER) into :ICODEMPUSU,:ICODFILIALUSU,:IDUSU;
    new.codempua = :ICODEMPUSU;
    new.codfilialua = :ICODFILIALUSU;
    new.idusuaprov = :IDUSU;
    new.dtaaprovrma = cast('now' AS DATE);
  end
  if((new.idusuexp is null) and (new.sitexprma!=old.sitexprma)) then
  begin
    SELECT CODEMPUSU,CODFILIALUSU,IDUSUS FROM sgretinfousu(new.CODEMP, USER) into :ICODEMPUSU,:ICODFILIALUSU,:IDUSU;
    new.codempue = :ICODEMPUSU;
    new.codfilialue = :ICODFILIALUSU;
    new.idusuexp = :IDUSU;
    new.dtaexprma = cast('now' AS DATE);
  end
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT=cast('now' AS TIME);

end ^

CREATE TRIGGER EQRMATGAU FOR EQRMA 
ACTIVE AFTER UPDATE POSITION 0 
AS
begin
    if(new.sitrma='AF')  then
    begin
      update eqitrma set sititrma = 'AF' where codemp=new.codemp and codfilial=new.codfilial and codrma=new.codrma and sititrma!='AF';
    end
    else if (new.sitrma='CA')  then
    begin
      update eqitrma set sititrma = 'CA' where codemp=new.codemp and codfilial=new.codfilial and codrma=new.codrma and sititrma!='CA';
    end
    else if(new.sitaprovrma='AT')  then
    begin
      update eqitrma set sitaprovitrma = 'AT' where codemp=new.codemp and codfilial=new.codfilial and codrma=new.codrma and sitaprovitrma!='AT';
    end
    if(new.sitrma='EF')  then
    begin
      update eqitrma it set sititrma = 'EF',precoitrma=(select ncustompm from eqprodutosp01(it.codemppd,it.codfilialpd,it.codprod,null,null,null)) where codemp=new.codemp and codfilial=new.codfilial and codrma=new.codrma and sititrma!='EF';
    end
    if(new.sitexprma='ET')  then
    begin
      update eqitrma set sitexpitrma = 'ET' where codemp=new.codemp and codfilial=new.codfilial and codrma=new.codrma and sitexpitrma!='ET';
    end
    if(new.codtipomov!=old.codtipomov) then
    begin
        update eqitrma it set precoitrma=(select ncustompm from eqprodutosp01(it.codemppd,it.codfilialpd,it.codprod,null,null,null))
            where codemp=new.codemp and codfilial=new.codfilial and codrma=new.codrma;
    end

end ^

CREATE TRIGGER EQRMAALTGBU FOR EQRMAAL 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER EQSALDOLOTETGBI FOR EQSALDOLOTE 
ACTIVE BEFORE INSERT POSITION 0 
AS
BEGIN
  if (new.SLDLOTE is null) then
     new.SLDLOTE = 0;
  if (new.SLDRESLOTE is null) then
     new.SLDRESLOTE = 0;
  if (new.SLDCONSIGLOTE is null) then
     new.SLDCONSIGLOTE = 0;
  new.SLDLIQLOTE = new.SLDLOTE-new.SLDRESLOTE-new.SLDCONSIGLOTE;
END ^

CREATE TRIGGER EQSALDOLOTETGBU FOR EQSALDOLOTE 
ACTIVE BEFORE UPDATE POSITION 0 
AS
BEGIN
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  if (new.SLDLOTE is null) then
     new.SLDLOTE = 0;
  if (new.SLDRESLOTE is null) then
     new.SLDRESLOTE = 0;
  if (new.SLDCONSIGLOTE is null) then
     new.SLDCONSIGLOTE = 0;
  new.SLDLIQLOTE = new.SLDLOTE-new.SLDRESLOTE-new.SLDCONSIGLOTE;
END ^

CREATE TRIGGER EQSALDOPRODTGBI FOR EQSALDOPROD 
ACTIVE BEFORE INSERT POSITION 0 
AS
BEGIN
  if (new.SLDPROD is null) then
     new.SLDPROD = 0;
  if (new.SLDRESPROD is null) then
     new.SLDRESPROD = 0;
  if (new.SLDCONSIGPROD is null) then
     new.SLDCONSIGPROD = 0;
  new.SLDLIQPROD = new.SLDPROD-new.SLDRESPROD-new.SLDCONSIGPROD;
END ^

CREATE TRIGGER EQSALDOPRODTGBU FOR EQSALDOPROD 
ACTIVE BEFORE UPDATE POSITION 0 
AS
BEGIN
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  if (new.SLDPROD is null) then
     new.SLDPROD = 0;
  if (new.SLDRESPROD is null) then
     new.SLDRESPROD = 0;
  if (new.SLDCONSIGPROD is null) then
     new.SLDCONSIGPROD = 0;
  new.SLDLIQPROD = new.SLDPROD-new.SLDRESPROD-new.SLDCONSIGPROD;
END ^

CREATE TRIGGER EQSECAOTGBU FOR EQSECAO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER EQSERIETGBU FOR EQSERIE 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER EQTIPOEXPTGBU FOR EQTIPOEXP 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER EQTIPOEXPEDTGBU FOR EQTIPOEXPEDICAO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.dtalt=cast('now' AS DATE);
  new.idusualt=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER EQTIPOMOVTGBI FOR EQTIPOMOV 
ACTIVE BEFORE INSERT POSITION 0 
AS
BEGIN
  IF ( (new.TIPOMOV='IV') AND (new.ESTIPOMOV!='I') ) THEN
     EXCEPTION EQTIPOMOVEX01 'FLUXO INCOMPATVEL COM O TIPO DE MOVIMENTO';
  ELSE IF (new.ESTIPOMOV = 'E') THEN
  BEGIN
    IF (new.CODTAB IS NOT NULL) THEN
    BEGIN
      EXCEPTION EQTIPOMOVEX01;
    END
  END
  ELSE
  BEGIN
    IF (new.CODTAB IS NULL) THEN
    BEGIN
      EXCEPTION EQTIPOMOVEX02;
    END
  END
END ^

CREATE TRIGGER EQTIPOMOVTGBU FOR EQTIPOMOV 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT = cast('now' AS DATE);
  new.IDUSUALT = USER;
  new.HALT = cast('now' AS TIME);
  IF ( (new.TIPOMOV='IV') AND (new.ESTIPOMOV!='I') ) THEN
     EXCEPTION EQTIPOMOVEX01 'FLUXO INCOMPATVEL COM O TIPO DE MOVIMENTO';
  ELSE IF (new.ESTIPOMOV = 'E') THEN
  BEGIN
    IF (new.CODTAB IS NOT NULL) THEN
    BEGIN
      EXCEPTION EQTIPOMOVEX01;
    END
  END
  ELSE
  BEGIN
    IF (new.CODTAB IS NULL) THEN
    BEGIN
      EXCEPTION EQTIPOMOVEX02;
    END
  END
  IF (old.ESTOQTIPOMOV != new.ESTOQTIPOMOV) THEN
  BEGIN
    IF ((EXISTS (SELECT CODVENDA FROM VDVENDA WHERE CODTIPOMOV=new.CODTIPOMOV
      AND CODEMPTM=new.CODEMP AND CODFILIALTM=new.CODFILIAL)) OR
        (EXISTS (SELECT CODCOMPRA FROM CPCOMPRA WHERE CODTIPOMOV=new.CODTIPOMOV
      AND CODEMPTM=new.CODEMP AND CODFILIALTM=new.CODFILIAL))) THEN
    BEGIN
      EXCEPTION EQTIPOMOVEX01 'JA EXISTE MOVIMENTOS PARA ESTE TIPO DE MOVIMENTO!';
    END
  END
end ^

CREATE TRIGGER EQTIPOMOVUSUTGBU FOR EQTIPOMOVUSU 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER EQTIPORECTGBU FOR EQTIPORECMERC 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.dtalt=cast('now' AS DATE);
  new.idusualt=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER EQUNIDADETGBU FOR EQUNIDADE 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER EQVARGRADETGBU FOR EQVARGRADE 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER FNBANCOTGBU FOR FNBANCO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER FNBORDEROTGBU FOR FNBORDERO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT=cast('now'AS TIME);
end ^

CREATE TRIGGER FNBORDEROTGAU FOR FNBORDERO 
ACTIVE AFTER UPDATE POSITION 0 
AS                                   
DECLARE VARIABLE IFILIALLANCA INTEGER;
DECLARE VARIABLE ICODLANCA INTEGER;   
DECLARE VARIABLE NVALOR NUMERIC(15,5); 
DECLARE VARIABLE ICODEMPPLAN INTEGER;
DECLARE VARIABLE IFILIALPLAN INTEGER;
DECLARE VARIABLE SPLANEJAMENTO CHAR(13); 
DECLARE VARIABLE ICODEMPPLANBOR INTEGER;
DECLARE VARIABLE IFILIALPLANBOR INTEGER;
DECLARE VARIABLE SPLANEJAMENTOBOR CHAR(13);
DECLARE VARIABLE ICODSUBLANCA INTEGER;  
begin

  IF (new.STATUSBOR = 'BC') THEN
  BEGIN

    SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'FNLANCA') INTO IFILIALLANCA;
    SELECT ISEQ FROM SPGERANUM(new.CODEMP,:IFILIALLANCA,'LA') INTO ICODLANCA;
    SELECT SUM(IR.VLRITREC) FROM FNITRECEBER IR, FNITBORDERO IB
      WHERE
      IR.CODEMP=IB.CODEMPRC AND IR.CODFILIAL=IB.CODFILIALRC AND
      IR.CODREC=IB.CODREC AND IR.NPARCITREC=IB.NPARCITREC AND
      IB.CODEMP=new.CODEMP AND IB.CODFILIAL=new.CODFILIAL AND IB.CODBOR=new.CODBOR
      INTO NVALOR;

    SELECT P.CODEMP, P.CODFILIAL, P.CODPLAN FROM FNPLANEJAMENTO P, FNCONTA C
      WHERE P.CODEMP=C.CODEMPPN AND P.CODFILIAL=C.CODFILIALPN AND P.CODPLAN=C.CODPLAN AND
      C.CODEMP=new.CODEMPCC AND C.CODFILIAL=new.CODFILIALCC AND C.NUMCONTA=new.NUMCONTA
      INTO ICODEMPPLAN, IFILIALPLAN, SPLANEJAMENTO; 

    SELECT P.CODEMP, P.CODFILIAL, P.CODPLAN FROM FNPLANEJAMENTO P, FNCONTA C
      WHERE P.CODEMP=C.CODEMPPN AND P.CODFILIAL=C.CODFILIALPN AND P.CODPLAN=C.CODPLAN AND
      C.CODEMP=new.CODEMPCB AND C.CODFILIAL=new.CODFILIALCB AND C.NUMCONTA=new.NUMCONTABOR
      INTO ICODEMPPLANBOR, IFILIALPLANBOR, SPLANEJAMENTOBOR;

    /* Transferencia */
    INSERT INTO FNLANCA (
      TIPOLANCA,CODEMP,CODFILIAL,CODLANCA,
      CODEMPPN,CODFILIALPN,CODPLAN, DTCOMPLANCA,
      DATALANCA,DOCLANCA,HISTBLANCA,TRANSFLANCA,VLRLANCA)
      VALUES (
      'A',new.CODEMP,:IFILIALLANCA,:ICODLANCA,
      :ICODEMPPLANBOR,:IFILIALPLANBOR,:SPLANEJAMENTOBOR, new.DTBOR,
      new.DTBOR,CAST(new.CODBOR AS CHAR(15)),'ADIANTAMENTO DE RECEBIVIS','S',0);       

    ICODSUBLANCA=1;

    INSERT INTO FNSUBLANCA (
      CODEMP,CODFILIAL,CODLANCA,CODSUBLANCA,
      CODEMPPN,CODFILIALPN,CODPLAN, DTCOMPSUBLANCA,
      DATASUBLANCA,VLRSUBLANCA,HISTSUBLANCA)
      VALUES (
      new.CODEMP,:IFILIALLANCA,:ICODLANCA,:ICODSUBLANCA,
      :ICODEMPPLAN,:IFILIALPLAN,:SPLANEJAMENTO, new.DTBOR,
      new.DTBOR,:NVALOR,'ADIANTAMENTO DE RECEBIVIS');
  END
end ^

CREATE TRIGGER FNCARTCOBTGBU FOR FNCARTCOB 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER FNCCTGBI FOR FNCC 
ACTIVE BEFORE INSERT POSITION 0 
AS
BEGIN
   IF (new.NIVELCC=10) THEN
   BEGIN
     SELECT ISEQ FROM SPGERANUM(new.CODEMP,new.CODFILIAL,'CC') INTO new.CODREDCC;
   END
END ^

CREATE TRIGGER FNCCTGBU FOR FNCC 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER FNCHEQUETGBU FOR FNCHEQUE 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER FNCHEQUETGAU FOR FNCHEQUE 
ACTIVE AFTER UPDATE POSITION 0 
AS
begin

    -- Se o cheque mudar de Cadastrado para Emitido,
    -- dever sinalizar o titulo para ser baixado na conta de cheques.
    if(old.sitcheq='CA' and new.sitcheq='ED') then
    begin

        update fnpagcheq pc
        set pc.baixa='S'
        where pc.codempch=new.codemp and pc.codfilialch=new.codfilial and pc.seqcheq=new.seqcheq;

    end
    -- Deve realizar a transferncia entre as contas de cheque
    -- Quando o cheque for compensado.
    if(old.sitcheq='ED' and new.sitcheq='CD') then
    begin

        update fnpagcheq pc
        set pc.transfere='S'
        where pc.codempch=new.codemp and pc.codfilialch=new.codfilial and pc.seqcheq=new.seqcheq;

    end

     -- Serve para limpar os flags caso o status do cheque volte para cadastrado
    if(new.sitcheq='CA' and old.sitcheq!='CA') then
    begin
        update fnpagcheq pc
        set pc.baixa='N', pc.transfere='N'
        where pc.codempch=new.codemp and pc.codfilialch=new.codfilial and pc.seqcheq=new.seqcheq;
    end

    -- Caso o status do cheque seja cancelado, deve eliminar os vinculos iniciais
    if(new.sitcheq='CN' and old.sitcheq!='CN') then
    begin
        delete from fnpagcheq pc
        where pc.codempch=new.codemp and pc.codfilialch=new.codfilial and pc.seqcheq=new.seqcheq;
    end

end ^

CREATE TRIGGER FNCONTATGBU FOR FNCONTA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER FNCONTAUSUTGBU FOR FNCONTAUSU 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER FNCONTAVINCULADATGAI FOR FNCONTAVINCULADA 
ACTIVE AFTER INSERT POSITION 0 
AS
begin
    -- Se a conta foi marcada como contacheque, deve desmarcar as outras
    if(new.contacheque='S') then
    begin
        update fncontavinculada cv set cv.contacheque='N'
        where cv.codemp=new.codemp and cv.codfilial=new.codfilial and cv.numconta=new.numconta and
        cv.codempcv=new.codempcv and cv.codfilialcv=new.codfilialcv and cv.numcontacv<>new.numcontacv;
    end

end ^

CREATE TRIGGER FNCONTAVINCULADATGBU FOR FNCONTAVINCULADA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER FNCONTAVINCULADATGAU FOR FNCONTAVINCULADA 
ACTIVE AFTER UPDATE POSITION 0 
AS
begin
    -- Se a conta foi marcada como contacheque, deve desmarcar as outras
    if(new.contacheque='S') then
    begin
        update fncontavinculada cv set cv.contacheque='N'
        where cv.codemp=new.codemp and cv.codfilial=new.codfilial and cv.numconta=new.numconta and
        cv.codempcv=new.codempcv and cv.codfilialcv=new.codfilialcv and cv.numcontacv<>new.numcontacv;
    end
end ^

CREATE TRIGGER FNCOTMOEDATGBU FOR FNCOTMOEDA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER FNFBNCLITGBU FOR FNFBNCLI 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER FNFBNCODRETTGBU FOR FNFBNCODRET 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER FNFBNRECTGBU FOR FNFBNREC 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER FNFINALIDADETGBU FOR FNFINALIDADE 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER FNHISTPADTGBU FOR FNHISTPAD 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER FNITBORDEROTGAI FOR FNITBORDERO 
ACTIVE AFTER INSERT POSITION 0 
AS
begin

  UPDATE FNITRECEBER SET STATUSITREC = 'RB'
  WHERE CODEMP=new.CODEMPRC AND CODFILIAL=new.CODFILIALRC AND CODREC=new.CODREC AND NPARCITREC=new.NPARCITREC;

end ^

CREATE TRIGGER FNITFBNCODRETTGBU FOR FNITFBNCODRET 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER FNITMODBOLETOTGBU FOR FNITMODBOLETO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER FNITPAGARTGBU FOR FNITPAGAR 
ACTIVE BEFORE UPDATE POSITION 0 
AS
  DECLARE VARIABLE IFILIALPAG INTEGER;
  DECLARE VARIABLE ICODFOR INTEGER;
  DECLARE VARIABLE ICODEMPFR INTEGER;
  DECLARE VARIABLE ICODFILIALFR INTEGER;
  DECLARE VARIABLE CODEMPLC INTEGER;
  DECLARE VARIABLE CODFILIALLC SMALLINT;
  DECLARE VARIABLE CODLANCA INTEGER;
  DECLARE VARIABLE COUNTLANCA INTEGER;
  DECLARE VARIABLE VLRLANCA NUMERIC(15,5);
BEGIN

  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);

  IF ( new.EMMANUT IS NULL ) THEN
  BEGIN
      new.EMMANUT = 'N';
  END

  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
  BEGIN

     if ( (old.edititpag='S') or (new.edititpag is null) ) then
     begin
         new.edititpag = 'N';
     end

     SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'FNPAGAR') INTO IFILIALPAG;
     IF ((old.STATUSITPAG IN ('PP','PL') )  AND (new.STATUSITPAG='P1') ) THEN
     BEGIN

       IF ( (old.MULTIBAIXA IS NULL) OR (old.MULTIBAIXA='N') ) THEN
       BEGIN        
          DELETE FROM FNSUBLANCA WHERE CODPAG=new.CODPAG AND NPARCPAG=new.NPARCPAG AND 
              CODEMPPG=new.CODEMP AND CODFILIALPG = new.CODFILIAL;
          DELETE FROM FNLANCA WHERE CODPAG=new.CODPAG AND NPARCPAG=new.NPARCPAG AND 
              CODEMPPG=new.CODEMP AND CODFILIALPG = new.CODFILIAL;
       END
       ELSE 
       BEGIN
          FOR SELECT CODEMP, CODFILIAL, CODLANCA FROM FNSUBLANCA
             WHERE CODPAG=new.CODPAG AND NPARCPAG=new.NPARCPAG AND
                CODEMPPG=new.CODEMP AND CODFILIALPG = new.CODFILIAL 
             INTO :CODEMPLC, :CODFILIALLC, :CODLANCA
          DO BEGIN

             DELETE FROM FNSUBLANCA WHERE CODPAG=new.CODPAG AND NPARCPAG=new.NPARCPAG AND
                CODEMPPG=new.CODEMP AND CODFILIALPG = new.CODFILIAL;
             SELECT VLRLANCA FROM FNLANCA
                WHERE CODEMP=:CODEMPLC AND CODFILIAL=:CODFILIALLC AND CODLANCA=:CODLANCA
                INTO :VLRLANCA;
             IF (:VLRLANCA=0) THEN
             BEGIN
                DELETE FROM FNLANCA
                WHERE CODEMP=:CODEMPLC AND CODFILIAL=:CODFILIALLC AND CODLANCA=:CODLANCA;
             END
          END
       END

       new.VLRPAGOITPAG = 0;
       new.DTPAGOITPAG = NULL;

     END
     ELSE IF ( (old.STATUSITPAG='P1') AND ( new.STATUSITPAG='CP' ) ) THEN
     BEGIN
        IF ( (new.OBSITPAG IS NULL) OR (rtrim(new.OBSITPAG)='') ) THEN
        BEGIN
           EXCEPTION FNITPAGAREX01;
        END
        new.VLRCANCITPAG = new.VLRAPAGITPAG;
        new.VLRAPAGITPAG = 0;
        new.VLRDESCITPAG = 0;
        new.VLRJUROSITPAG = 0;
        new.VLRDEVITPAG = 0;
     END

     SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'FNSUBLANCA') INTO :CODFILIALLC;
     SELECT COUNT (CODLANCA) FROM FNSUBLANCA WHERE CODPAG=new.CODPAG AND NPARCPAG=new.NPARCPAG
           AND CODEMPPG= new.CODEMP AND CODFILIALPG=new.CODFILIAL
           AND CODEMP=new.CODEMP AND CODFILIAL = :CODFILIALLC INTO :COUNTLANCA;

     new.VLRITPAG = new.VLRPARCITPAG - new.VLRDESCITPAG  - coalesce(new.VLRCANCITPAG,0) - new.VLRDEVITPAG + new.VLRJUROSITPAG + new.VLRMULTAITPAG + new.VLRADICITPAG;

     IF ( new.STATUSITPAG = 'P1' ) THEN
     BEGIN
         new.VLRAPAGITPAG = new.VLRITPAG - new.VLRPAGOITPAG;
     END
  
     if( :countlanca <= 1 ) then
     begin
         if (new.VLRAPAGITPAG < 0) then /* se o valor a pagar for menor que zero */
           new.VLRAPAGITPAG = 0;  /* ento valor a pagar ser zero */
         if ( (new.VLRAPAGITPAG=0) AND (new.VLRITPAG>0) ) then /* se o valor a pagar for igual a zero e existir valor na parcela*/
           new.STATUSITPAG = 'PP';  /* ento o status ser PP(pagamento completo) */
         else if ( (new.VLRPAGOITPAG>0) AND (new.VLRITPAG>0) ) then /* caso contrrio e o valor pago maior que zero e existir valor na parcela*/
           new.STATUSITPAG = 'PL'; /*  ento o status ser PL(pagamento parcial) */
     end

     IF ((old.STATUSITPAG='P1' AND new.STATUSITPAG in ('PP','PL')) OR
            (old.STATUSITPAG in ('PL') AND new.STATUSITPAG in ('PP','PL') AND new.VLRPAGOITPAG > 0) ) THEN
     BEGIN
       /* faz o lanamento */
       SELECT CODFOR,CODEMPFR,CODFILIALFR FROM FNPAGAR WHERE CODEMP=new.CODEMP AND CODFILIAL=new.CODFILIAL AND CODPAG=new.CODPAG
         INTO ICODFOR,ICODEMPFR,ICODFILIALFR;

       if ( (new.multibaixa = 'N') and ((new.edititpag is null) or (new.edititpag='N') ) ) THEN
       BEGIN
           EXECUTE PROCEDURE FNADICLANCASP02(new.CodPag,new.NParcPag,new.NumConta,new.CODEMPCA,new.CODFILIALCA,:ICODFOR,:ICODEMPFR,:ICODFILIALFR,
                              new.CodPlan,new.CODEMPPN,new.CODFILIALPN,new.AnoCC,new.CodCC,new.CODEMPCC,new.CODFILIALCC, new.DTCOMPITPAG,
                              new.DtPagoItPag,new.DocLancaItPag,new.ObsItPag,new.VlrPagoItPag,new.CODEMP,new.CODFILIAL,new.vlrjurositpag,new.vlrdescitpag
                              ,new.codempct, new.codfilialct, new.codcontr, new.coditcontr, new.codempem, new.codfilialem, new.matempr);
       END

       /* Altera o valor pago e o valor a pagar */
       if ((new.edititpag is null) or (new.edititpag='N')) then
       begin
           new.VLRPAGOITPAG = new.VLRPAGOITPAG + old.VLRPAGOITPAG;
       end

       new.VLRAPAGITPAG = new.VLRITPAG - new.VLRPAGOITPAG;

       if (new.VLRAPAGITPAG < 0) then /* se o valor a pagar for menor que zero */
         new.VLRAPAGITPAG = 0;  /* ento valor a pagar ser zero */

       if (new.VLRAPAGITPAG=0) then /* se o valor a pagar for igual a zero */
         new.STATUSITPAG = 'PP';  /* ento o status ser PP(pagamento completo) */
       else if (new.VLRPAGOITPAG>0) then /* caso contrrio e o valor pago maior que zero */
         new.STATUSITPAG = 'PL'; /*  ento o status ser PL(pagamento parcial) */

     END
     ELSE IF (new.VLRPAGOITPAG < 0 )THEN
     BEGIN
         new.VLRPAGOITPAG = new.VLRPAGOITPAG * -1;
         new.VLRAPAGITPAG = new.VLRAPAGITPAG + new.VLRPAGOITPAG;
         new.VLRPAGOITPAG = old.VLRPAGOITPAG - new.VLRPAGOITPAG;
     END
     ELSE IF ((old.STATUSITPAG='PP') AND (new.STATUSITPAG='PP')) THEN
     BEGIN
        EXCEPTION FNPAGAREX01;
     END

     if (new.edititpag='S') then
     begin
        new.edititpag='N';
     end

   END
   
   
END ^

CREATE TRIGGER FNITPAGARTGAU FOR FNITPAGAR 
ACTIVE AFTER UPDATE POSITION 0 
AS
    DECLARE VARIABLE PERMITBAIXAPARCJDM CHAR(1);
BEGIN
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
  BEGIN
     SELECT PERMITBAIXAPARCJDM FROM SGPREFERE1 WHERE CODEMP=new.CODEMP AND CODFILIAL=new.CODFILIAL INTO :PERMITBAIXAPARCJDM;
     UPDATE FNPAGAR SET VLRPAG = VLRPAG - old.VLRITPAG + new.VLRITPAG,
         VLRDESCPAG = VLRDESCPAG - old.VLRDESCITPAG + new.VLRDESCITPAG,
         VLRMULTAPAG = VLRMULTAPAG - old.VLRMULTAITPAG + new.VLRMULTAITPAG,
         VLRJUROSPAG = VLRJUROSPAG - old.VLRJUROSITPAG + new.VLRJUROSITPAG,
         VLRDEVPAG = VLRDEVPAG - old.VLRDEVITPAG + new.VLRDEVITPAG,
         VLRADICPAG = VLRADICPAG - old.VLRADICITPAG + new.VLRADICITPAG,
         VLRPARCPAG = VLRPARCPAG - old.VLRPARCITPAG + new.VLRPARCITPAG,
         VLRPAGOPAG = VLRPAGOPAG - old.VLRPAGOITPAG + new.VLRPAGOITPAG,
         VLRAPAGPAG = VLRAPAGPAG - old.VLRAPAGITPAG + new.VLRAPAGITPAG
         WHERE CODPAG=new.CODPAG
              AND CODEMP=new.CODEMP AND CODFILIAL=new.CODFILIAL;
         IF ( (:PERMITBAIXAPARCJDM='N') AND (new.STATUSITPAG='PL') AND ( (new.VLRDESCITPAG<>0) OR (new.VLRJUROSITPAG<>0) OR (new.VLRMULTAITPAG<>0) ) ) THEN
            EXCEPTION FNITPAGAREX02; 
   END
END ^

CREATE TRIGGER FNITPAGARTGBD FOR FNITPAGAR 
ACTIVE BEFORE DELETE POSITION 0 
AS
BEGIN
  IF (old.STATUSITPAG = 'PP') THEN
    EXCEPTION FNPAGAREX01;
END ^

CREATE TRIGGER FNITPAGARTGAD FOR FNITPAGAR 
ACTIVE AFTER DELETE POSITION 0 
AS
BEGIN
  UPDATE FNPAGAR SET VLRPAG = VLRPAG - old.VLRITPAG,
         VLRDESCPAG = VLRDESCPAG - old.VLRDESCITPAG,
         VLRMULTAPAG = VLRMULTAPAG  - old.VLRMULTAITPAG,
         VLRJUROSPAG = VLRJUROSPAG - old.VLRJUROSITPAG,
         VLRDEVPAG = VLRDEVPAG - old.VLRDEVITPAG,
         VLRADICPAG = VLRADICPAG - old.VLRADICITPAG,
         VLRPAGOPAG = VLRPAGOPAG - old.VLRPAGOITPAG,
         VLRPARCPAG = VLRPARCPAG - old.VLRPARCITPAG,
         VLRAPAGPAG = VLRAPAGPAG - old.VLRAPAGITPAG
         WHERE CODPAG=old.CODPAG
         AND CODEMP=old.CODEMP AND CODFILIAL=old.CODFILIAL;
END ^

CREATE TRIGGER FNITRECEBERTGBI FOR FNITRECEBER 
ACTIVE BEFORE INSERT POSITION 0 
as

    declare variable seqnossonumero int;

begin

    --Setando valor padro de campos para 0;
    if (new.vlrparcitrec is null) then
        new.vlrparcitrec = 0;

    if (new.vlrdescitrec is null) then
        new.vlrdescitrec = 0;

    if (new.vlrjurositrec is null) then
        new.vlrjurositrec = 0;

    if (new.vlrmultaitrec is null) then
        new.vlrmultaitrec = 0;

    -- Calculando o valor liquido da parcela...
    new.vlritrec = new.vlrparcitrec - new.vlrdescitrec - new.vlrdevitrec + new.vlrjurositrec + new.vlrmultaitrec;
    new.vlrapagitrec = new.vlritrec - new.vlrpagoitrec;

    -- Zerando valores caso fique negativo...
    if (new.vlrapagitrec<0) then
        new.vlrapagitrec = 0;

    if(new.dtprevitrec is null) then
        new.dtprevitrec = new.dtvencitrec;

   -- Buscando informaes da conta (necessrio quando  alterado o plano de pagamento na venda)
    if(new.numconta is null) then
    begin
    
        select vd.codempca, vd.codfilialca, vd.numconta
        from fnreceber rc, vdvenda vd
        where
        rc.codemp=new.codemp and rc.codfilial=new.codfilial and rc.codrec=new.codrec and
        vd.codemp=rc.codempva and vd.codfilial=rc.codfilialva and vd.codvenda=rc.codvenda and vd.tipovenda=rc.tipovenda
        into new.codempca, new.codfilialca, new.numconta;

    end

    --Buscando sequencial caso informaes de banco e carteira j tenham sido informadas...

    if(new.codbanco is not null and new.codcartcob is not null and new.numconta is not null) then
    begin

       select seqnossonumero
       from fngeraseqnossonumero( new.codempbo, new.codfilialbo, new.codbanco, new.codempcb, new.codfilialcb, new.codcartcob, new.codempca, new.codfilialca, new.numconta)
       into :seqnossonumero;

       if (:seqnossonumero is not null and :seqnossonumero >0 ) then
       begin
          new.seqnossonumero = :seqnossonumero;
       end

    end



end ^

CREATE TRIGGER FNITRECEBERTGBI02 FOR FNITRECEBER 
ACTIVE BEFORE INSERT POSITION 0 
AS
    DECLARE VARIABLE nrodiascomp INTEGER;
    DECLARE VARIABLE datets TIMESTAMP;
BEGIN
    SELECT tc.nrodiascomp FROM fntipocob tc
        WHERE tc.codemp = NEW.codemptc
        AND tc.codfilial = NEW.codfilialtc
        AND tc.codtipocob = NEW.codtipocob INTO :nrodiascomp;

    NEW.dtprevitrec = NEW.dtvencitrec;

    IF(nrodiascomp IS NOT NULL) THEN
    BEGIN
        datets = CAST (NEW.dtprevitrec AS TIMESTAMP);
        datets = addday(datets, nrodiascomp);
        NEW.dtprevitrec = CAST(datets AS DATE);
    END
END ^

CREATE TRIGGER FNITRECEBERTGAI FOR FNITRECEBER 
ACTIVE AFTER INSERT POSITION 0 
AS
BEGIN
  EXECUTE PROCEDURE vdgeracomissaosp(new.CODEMP, new.CODFILIAL, new.CODREC, new.NPARCITREC,
    new.VLRCOMIITREC, new.DTVENCITREC);
END ^

CREATE TRIGGER FNITRECEBERTGBU FOR FNITRECEBER 
ACTIVE BEFORE UPDATE POSITION 0 
AS

  DECLARE VARIABLE SCODFILIALPF SMALLINT;
  DECLARE VARIABLE CCOMISPDUPL CHAR(1);
  DECLARE VARIABLE NVLRPARCREC NUMERIC(15, 5);
  DECLARE VARIABLE NVLRCOMIREC NUMERIC(15, 5);
  DECLARE VARIABLE ESTITRECALTDTVENC CHAR(1);
  DECLARE VARIABLE AUTOBAIXAPARC CHAR(1);
  declare variable seqnossonumero int;
  DECLARE VARIABLE CODFILIALLC SMALLINT;
  DECLARE VARIABLE COUNTLANCA INTEGER;
BEGIN
  IF (new.EMMANUT IS NULL) THEN   /* Evita flag de manuteno nulo */
     new.EMMANUT='N';

  IF ( new.ALTUSUITREC IS NULL ) THEN /* Para no permitir flag de usurio nulo */
     new.ALTUSUITREC = 'S';

  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
  BEGIN
     new.DTALT=cast('now' AS DATE);
     new.IDUSUALT=USER;
     new.HALT = cast('now' AS TIME);

     IF ( (new.DTPAGOITREC is not null) AND (new.DTLIQITREC is null) ) THEN
     BEGIN
        new.DTLIQITREC = new.DTPAGOITREC;
     END

     SELECT ESTITRECALTDTVENC FROM SGPREFERE1 WHERE CODEMP=new.CODEMP AND CODFILIAL=new.CODFILIAL INTO :ESTITRECALTDTVENC;
     SELECT ITPP.AUTOBAIXAPARC FROM FNPARCPAG ITPP, FNRECEBER R
       WHERE ITPP.CODEMP=R.CODFILIALPG AND ITPP.CODFILIAL=R.CODFILIALPG AND ITPP.CODPLANOPAG=R.CODPLANOPAG AND
         ITPP.NROPARCPAG=new.NPARCITREC AND
          R.CODEMP=new.CODEMP AND R.CODFILIAL=new.CODFILIAL AND R.CODREC=new.CODREC
       INTO :AUTOBAIXAPARC;

     IF  ( ( (old.STATUSITREC IN ('RP','RL') )  AND (new.STATUSITREC IN ('R1', 'RR')) ) OR
           ( (ESTITRECALTDTVENC='S') AND (AUTOBAIXAPARC='S') AND
             (old.DTVENCITREC<>new.DTVENCITREC) ) ) THEN
     BEGIN
       IF(new.STATUSITREC != 'RR')THEN
       BEGIN
        new.STATUSITREC = 'R1';
       END
       new.VLRPAGOITREC = 0;
     END
     ELSE IF ( (old.STATUSITREC='R1') AND ( new.STATUSITREC='CR' ) ) THEN
     BEGIN
        IF ( (new.OBSITREC IS NULL) OR (rtrim(new.OBSITREC)='') ) THEN
        BEGIN
           EXCEPTION FNITRECEBEREX02;
        END
        new.VLRCANCITREC = new.VLRAPAGITREC;
        new.VLRAPAGITREC = 0;
        new.VLRDESCITREC = 0;
        new.VLRJUROSITREC = 0;
        new.VLRDEVITREC = 0;
     END

     SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'FNSUBLANCA') INTO :CODFILIALLC;
     SELECT COUNT (CODLANCA) FROM FNSUBLANCA WHERE CODREC=new.CODREC AND NPARCITREC=new.NPARCITREC
              AND CODEMPRC= new.CODEMP AND CODFILIALRC=new.CODFILIAL
              AND CODEMP=new.CODEMP AND CODFILIAL = :CODFILIALLC INTO :COUNTLANCA;

     new.VLRITREC = new.VLRPARCITREC - coalesce(new.VLRCANCITREC,0) - new.VLRDESCITREC - new.VLRDEVITREC + new.VLRJUROSITREC + new.VLRMULTAITREC;
     new.VLRAPAGITREC = new.VLRITREC - new.VLRPAGOITREC;
     if (new.VLRAPAGITREC < 0 or new.VLRAPAGITREC is null ) then /* se o valor a pagar for menor que zero */
        new.VLRAPAGITREC = 0;  /* ento valor a pagar ser zero */

     if(:countlanca <= 1)then
     begin
        if ( (new.VLRAPAGITREC=0) AND (new.STATUSITREC<>'CR') ) then /* se o valor a pagar for igual a zero */
            new.STATUSITREC = 'RP';  /* ento o status ser RP(pagamento completo) */
        else if (new.VLRPAGOITREC>0) then /* caso contrrio e o valor pago maior que zero */
            new.STATUSITREC = 'RL'; /*  ento o status ser RL(pagamento parcial) */
     end
     /*
       Esta seo  destinada e ajustar as comisses conforme os valores de parcelas
       caso o preferncias esteja ajustado para isso.
     */
     IF ( (new.VLRPARCITREC!=old.VLRPARCITREC) AND (new.VLRPARCITREC!=0) ) THEN
     BEGIN
        SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'SGPREFERE1') INTO :SCODFILIALPF;
        SELECT P1.COMISPDUPL  FROM SGPREFERE1 P1
            WHERE P1.CODEMP=new.CODEMP AND P1.CODFILIAL=:SCODFILIALPF INTO :CCOMISPDUPL;
        IF (CCOMISPDUPL='S') THEN
        BEGIN
           SELECT V.VLRLIQVENDA, R.VLRCOMIREC FROM FNRECEBER R, VDVENDA V
             WHERE R.CODEMP=new.CODEMP AND R.CODFILIAL=new.CODFILIAL AND
                 R.CODREC=new.CODREC AND V.CODEMP=R.CODEMPVA AND V.CODFILIAL=R.CODFILIALVA AND
                 V.TIPOVENDA=R.TIPOVENDA AND V.CODVENDA=R.CODVENDA INTO :NVLRPARCREC, :NVLRCOMIREC;
           IF (NVLRPARCREC!=0) THEN
             new.VLRCOMIITREC = cast( new.VLRPARCITREC * :NVLRCOMIREC / :NVLRPARCREC as NUMERIC(15, 5) );
        END
     END
     IF ((old.IMPRECIBOITREC='N') AND (new.IMPRECIBOITREC='S') AND (new.RECIBOITREC IS NULL)) THEN
     BEGIN
        SELECT ISEQ FROM SPGERANUM(new.CODEMP,new.CODFILIAL,'RB') INTO new.RECIBOITREC;
     END
     /*Alterao das datas de entrada e saida do estado de 'em cobrana'*/
     IF (new.RECEMCOB='S') THEN
     BEGIN
       new.DTINIEMCOB=CURRENT_DATE;
       new.DTFIMEMCOB=NULL;
     END
     ELSE IF (new.RECEMCOB='N') THEN
     BEGIN
       new.DTFIMEMCOB=CURRENT_DATE;
     END
     if(new.dtprevitrec is null) then
       new.dtprevitrec = new.dtvencitrec;

    --Buscando sequencial caso informaes de banco e carteira tenham sido alteradas...

       if ( (old.codbanco is null or old.codcartcob is null or old.numconta is null )
             or
            (new.codbanco != old.codbanco or new.codcartcob != old.codcartcob or new.numconta != old.numconta)
             and
            (new.codbanco is not null and new.codcartcob is not null and new.numconta is not null ) ) then

       begin

           seqnossonumero = 0;

          select seqnossonumero
          from fngeraseqnossonumero( new.codempbo, new.codfilialbo, new.codbanco, new.codempcb, new.codfilialcb, new.codcartcob, new.codempca, new.codfilialca, new.numconta)
          into :seqnossonumero;

          if (:seqnossonumero is not null and :seqnossonumero >0 ) then
          begin
             new.seqnossonumero = :seqnossonumero;
          end

       end
   end
end ^

CREATE TRIGGER FNITRECEBERTGAU FOR FNITRECEBER 
ACTIVE AFTER UPDATE POSITION 0 
AS
  DECLARE VARIABLE ICODCLI INTEGER;
  DECLARE VARIABLE ICODEMPCL INTEGER;
  DECLARE VARIABLE ICODFILIALCL INTEGER;
  DECLARE VARIABLE SCODFILIALCI SMALLINT;
  DECLARE VARIABLE CODFILIALLC SMALLINT;
  DECLARE VARIABLE CODEMPLC INTEGER;
  DECLARE VARIABLE CODLANCA INTEGER;
  DECLARE VARIABLE VLRLANCA NUMERIC(15,5);
  DECLARE VARIABLE ESTITRECALTDTVENC CHAR(1);
  DECLARE VARIABLE AUTOBAIXAPARC CHAR(1);
  DECLARE VARIABLE PERMITBAIXAPARCJDM CHAR(1);
BEGIN
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
  BEGIN

     SELECT ESTITRECALTDTVENC, PERMITBAIXAPARCJDM FROM SGPREFERE1 WHERE CODEMP=new.CODEMP AND CODFILIAL=new.CODFILIAL INTO :ESTITRECALTDTVENC, :PERMITBAIXAPARCJDM;
     SELECT ITPP.AUTOBAIXAPARC FROM FNPARCPAG ITPP, FNRECEBER R
       WHERE ITPP.CODEMP=R.CODFILIALPG AND ITPP.CODFILIAL=R.CODFILIALPG AND ITPP.CODPLANOPAG=R.CODPLANOPAG AND
         ITPP.NROPARCPAG=new.NPARCITREC AND
          R.CODEMP=new.CODEMP AND R.CODFILIAL=new.CODFILIAL AND R.CODREC=new.CODREC
       INTO :AUTOBAIXAPARC;
     IF  ( ( (old.STATUSITREC IN ('RP','RL') )  AND (new.STATUSITREC='R1') ) OR
           ( (old.STATUSITREC IN ('RP','RL') )  AND (new.STATUSITREC='RR') ) OR
           ( (ESTITRECALTDTVENC='S') AND (AUTOBAIXAPARC='S') AND
             (old.DTVENCITREC<>new.DTVENCITREC) ) ) THEN
     BEGIN
       SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'FNCOMISSAO') INTO :SCODFILIALCI;
       SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'FNLANCA') INTO :CODFILIALLC;
       
       execute procedure fnestornacomissaosp new.codemp, new.codfilial, new.codrec, new.nparcitrec;

       --UPDATE VDCOMISSAO SET STATUSCOMI='C1'
--              WHERE CODREC=new.CODREC AND NPARCITREC=new.NPARCITREC
--              AND CODEMPRC = new.CODEMP AND CODFILIALRC=new.CODFILIAL
--              AND CODEMP=new.CODEMP AND CODFILIAL=:SCODFILIALCI
--              AND STATUSCOMI NOT IN ('CE') AND TIPOCOMI='R';
       
       
              
       IF ( (old.MULTIBAIXA IS NULL) OR (old.MULTIBAIXA='N') ) THEN
       BEGIN        
          DELETE FROM FNSUBLANCA WHERE CODREC=new.CODREC AND NPARCITREC=new.NPARCITREC AND 
             CODEMPRC=new.CODEMP AND CODFILIALRC = new.CODFILIAL;
          DELETE FROM FNLANCA WHERE CODREC=new.CODREC AND NPARCITREC=new.NPARCITREC AND 
             CODEMPRC=new.CODEMP AND CODFILIALRC = new.CODFILIAL;
       END
       ELSE 
       BEGIN
          SELECT CODEMP, CODFILIAL, CODLANCA FROM FNSUBLANCA
             WHERE CODREC=new.CODREC AND NPARCITREC=new.NPARCITREC AND 
                CODEMPRC=new.CODEMP AND CODFILIALRC = new.CODFILIAL 
             INTO :CODEMPLC, :CODFILIALLC, :CODLANCA;
          DELETE FROM FNSUBLANCA WHERE CODREC=new.CODREC AND NPARCITREC=new.NPARCITREC AND 
             CODEMPRC=new.CODEMP AND CODFILIALRC = new.CODFILIAL;
          SELECT VLRLANCA FROM FNLANCA
             WHERE CODEMP=:CODEMPLC AND CODFILIAL=:CODFILIALLC AND CODLANCA=:CODLANCA
             INTO :VLRLANCA;
          IF (:VLRLANCA=0) THEN 
          BEGIN
             DELETE FROM FNLANCA 
             WHERE CODEMP=:CODEMPLC AND CODFILIAL=:CODFILIALLC AND CODLANCA=:CODLANCA;
          END 
       END
     END
     ELSE IF ((old.STATUSITREC='R1' AND new.STATUSITREC in ('RP','RL')) OR
              (old.STATUSITREC='RR' AND new.STATUSITREC in ('RP','RL')) OR
              (old.STATUSITREC in ('RP','RL') AND new.STATUSITREC in ('RP','RL') AND new.VLRPAGOITREC > 0) OR
              (old.STATUSITREC = 'RB' AND new.STATUSITREC = 'RP')) THEN
     BEGIN
        SELECT CODCLI,CODEMPCL,CODFILIALCL FROM FNRECEBER WHERE CODEMP=new.CODEMP AND
           CODFILIAL=new.CODFILIAL AND CODREC=new.CODREC
           INTO ICODCLI,ICODEMPCL,ICODFILIALCL;
        IF ((new.VLRPAGOITREC-old.VLRPAGOITREC) > 0) THEN
        BEGIN
          IF(new.multibaixa is null or new.multibaixa = 'N')THEN
          BEGIN
             EXECUTE PROCEDURE FNADICLANCASP01(new.CodRec,new.NParcItRec,new.PDVITREC,new.NumConta,new.CODEMPCA,new.CODFILIALCA,:ICODCLI,:ICODEMPCL,:ICODFILIALCL,
                        new.CodPlan,new.CODEMPPN,new.CODFILIALPN,new.ANOCC,new.CODCC,new.CODEMPCC,new.CODFILIALCC, new.dtCompItRec, new.DtPagoItRec, 
                        new.DocLancaItRec, SUBSTRING(new.ObsItRec FROM 1 FOR 50),new.VlrPagoItRec-old.VlrPagoItRec,new.CODEMP,new.CODFILIAL,new.vlrjurositrec,new.vlrdescitrec
                        , new.codempct, new.codfilialct, new.codcontr, new.coditcontr
                        , new.codempem, new.codfilialem, new.matempr);
          END
        END
        IF (new.STATUSITREC = 'RP') THEN
        BEGIN
            UPDATE VDCOMISSAO SET STATUSCOMI='C2'
               WHERE CODREC=old.CODREC
               AND CODEMPRC=old.CODEMP
               AND CODFILIALRC=old.CODFILIAL
               AND NPARCITREC=old.NPARCITREC
               AND NOT STATUSCOMI IN ('CP','C2')
               AND CODEMP=old.CODEMP;
        END
     END
     ELSE IF (old.VLRCOMIITREC != new.VLRCOMIITREC) THEN
     BEGIN
        EXECUTE PROCEDURE vdgeracomissaosp(new.CODEMP, new.CODFILIAL, new.CODREC,
           new.NPARCITREC, new.VLRCOMIITREC, new.DTVENCITREC);
     END

     IF ( (new.ALTUSUITREC='S') AND ( (old.VLRITREC!=new.VLRITREC) OR
          (old.VLRDESCITREC!=new.VLRDESCITREC) OR (old.VLRMULTAITREC!=new.VLRMULTAITREC) OR
          (old.VLRJUROSITREC!=new.VLRJUROSITREC) OR (old.VLRPARCITREC!=new.VLRPARCITREC) OR
          (old.VLRPAGOITREC!=new.VLRPAGOITREC) OR (old.VLRAPAGITREC!=new.VLRAPAGITREC) ) ) THEN
        UPDATE FNRECEBER SET VLRREC = VLRREC - old.VLRITREC + new.VLRITREC,
            VLRDESCREC = VLRDESCREC - old.VLRDESCITREC + new.VLRDESCITREC,
            VLRMULTAREC = VLRMULTAREC - old.VLRMULTAITREC + new.VLRMULTAITREC,
            VLRJUROSREC = VLRJUROSREC - old.VLRJUROSITREC + new.VLRJUROSITREC,
            VLRDEVREC = VLRDEVREC - old.VLRDEVITREC + new.VLRDEVITREC,
            VLRPARCREC = VLRPARCREC - old.VLRPARCITREC + new.VLRPARCITREC,
            VLRPAGOREC = VLRPAGOREC - old.VLRPAGOITREC + new.VLRPAGOITREC,
            ALTUSUREC = 'S' WHERE CODREC=new.CODREC
           AND CODEMP=new.CODEMP AND CODFILIAL=new.CODFILIAL;
      /* Condio para evitar baixa parcial de ttulos com juros, descontos ou multas. */
      IF ( (:PERMITBAIXAPARCJDM='N') AND (new.STATUSITREC='RL') AND ( (new.VLRDESCITREC<>0) OR (new.VLRJUROSITREC<>0) OR (new.VLRMULTAITREC<>0) ) ) THEN
         EXCEPTION FNITRECEBEREX03; 
   END
   
END ^

CREATE TRIGGER FNITRECEBERTGBD FOR FNITRECEBER 
ACTIVE BEFORE DELETE POSITION 0 
AS
DECLARE VARIABLE IFILIALCOMI INTEGER;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(old.CODEMP,'VDCOMISSAO') INTO IFILIALCOMI;
  IF (old.STATUSITREC not in ('RP','RL') ) THEN
    DELETE FROM VDCOMISSAO WHERE CODREC=old.CODREC AND NPARCITREC=old.NPARCITREC
           AND CODEMP=old.CODEMP AND CODFILIAL = :IFILIALCOMI;
  ELSE
    EXCEPTION FNITRECEBEREX01;
END ^

CREATE TRIGGER FNITRENEGRECTGAI FOR FNITRENEGREC 
ACTIVE AFTER INSERT POSITION 0 
as
begin

 update fnitreceber set statusitrec = 'RN'
 where codemp=new.codempir and codfilial=new.codfilialir and codrec=new.codrec and nparcitrec=new.nparcitrec;

end ^

CREATE TRIGGER FNITRENEGRECTGBU FOR FNITRENEGREC 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER FNITRENEGRECTGBD FOR FNITRENEGREC 
ACTIVE BEFORE DELETE POSITION 0 
AS
begin
  update fnitreceber set statusitrec = 'R1'
  where codemp=old.codempir and codfilial=old.codfilialir and codrec=old.codrec and nparcitrec=old.nparcitrec;
end ^

CREATE TRIGGER FNITTBJUROSTGBU FOR FNITTBJUROS 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER FNLANCATGBI FOR FNLANCA 
ACTIVE BEFORE INSERT POSITION 0 
AS
BEGIN
  new.STATUSLANCA = 'L1';
  IF (new.HISTLANCA IS NULL) THEN
    new.HISTLANCA = new.HISTBLANCA;
  IF (new.DTPREVLANCA IS NULL) THEN
    new.DTPREVLANCA = new.DATALANCA;
  IF (new.DTCOMPLANCA IS NULL) THEN
    new.DTCOMPLANCA = new.DATALANCA;
END ^

CREATE TRIGGER FNLANCATGAI FOR FNLANCA 
ACTIVE AFTER INSERT POSITION 0 
AS
DECLARE VARIABLE IFILIALPLAN INTEGER;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'FNPLANEJAMENTO') INTO IFILIALPLAN;
  INSERT INTO FNSUBLANCA (CODEMP,CODFILIAL,CODLANCA,CODSUBLANCA,CODEMPPN,CODFILIALPN,CODPLAN,DTPREVSUBLANCA,DATASUBLANCA,VLRSUBLANCA,ORIGSUBLANCA,FLAG)
                       VALUES (new.CODEMP,new.CODFILIAL,new.CODLANCA,0,new.CODEMP,:IFILIALPLAN,new.CODPLAN,new.DTPREVLANCA,new.DATALANCA,new.VLRLANCA,'S',new.FLAG);
END ^

CREATE TRIGGER FNLANCATGBU FOR FNLANCA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  if (new.emmanut is null) then
    new.emmanut = 'N';
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
  BEGIN
     new.DTALT=cast('now' AS DATE);
     new.IDUSUALT=USER;
     new.HALT = cast('now' AS TIME);
  END
end ^

CREATE TRIGGER FNLANCATGAU FOR FNLANCA 
ACTIVE AFTER UPDATE POSITION 0 
AS
BEGIN
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
  BEGIN
     UPDATE FNSUBLANCA SET DTCOMPSUBLANCA = new.DTCOMPLANCA,
         DTPREVSUBLANCA=new.DTPREVLANCA,
         DATASUBLANCA=new.DATALANCA,VLRSUBLANCA=new.VLRLANCA,FLAG=new.FLAG
         WHERE CODLANCA=old.CODLANCA AND CODSUBLANCA=0
         AND CODEMP=old.CODEMP AND CODFILIAL=old.CODFILIAL;
  END
END ^

CREATE TRIGGER FNLANCATGBD FOR FNLANCA 
ACTIVE BEFORE DELETE POSITION 0 
AS
BEGIN
  DELETE FROM FNSUBLANCA WHERE CODLANCA=old.CODLANCA
         AND CODEMP=old.CODEMP AND CODFILIAL = old.CODFILIAL;
END ^

CREATE TRIGGER FNLIBCREDTGBI FOR FNLIBCRED 
ACTIVE BEFORE INSERT POSITION 0 
AS
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'SGUSUARIO') INTO new.CODFILIALUS;
  new.CODEMPUS = new.CODEMP;
  new.IDUSU=lower(USER);
END ^

CREATE TRIGGER FNLIBCREDTGBU FOR FNLIBCRED 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER FNMODBOLETOTGBU FOR FNMODBOLETO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER FNMOEDATGBU FOR FNMOEDA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER FNPAGARTGBI FOR FNPAGAR 
ACTIVE BEFORE INSERT POSITION 0 
AS
BEGIN
  IF (new.VLRDESCPAG IS NULL) THEN new.VLRDESCPAG = 0;
  IF (new.VLRJUROSPAG IS NULL) THEN new.VLRJUROSPAG = 0;
  IF (new.VLRMULTAPAG IS NULL) THEN new.VLRMULTAPAG = 0;
  IF (new.VLRPARCPAG IS NULL) THEN new.VLRPARCPAG = 0;
  IF (new.VLRPAGOPAG IS NULL) THEN new.VLRPAGOPAG = 0;
  IF (new.STATUSPAG IS NULL) THEN new.STATUSPAG = 'P1';
  IF (new.DTCOMPPAG IS NULL) THEN new.DTCOMPPAG = new.DATAPAG;
  new.VLRPAG = new.VLRPARCPAG - new.VLRDESCPAG - new.VLRDEVPAG + new.VLRJUROSPAG + new.VLRADICPAG +
  new.VLRMULTAPAG;
  new.VLRAPAGPAG = new.VLRPAG - new.VLRPAGOPAG;
  if ( ( new.NUMCONTA IS NULL ) AND ( new.CODTIPOCOB IS NOT NULL ) ) then
  begin
     SELECT TC.CODEMPCT, TC.CODFILIALCT, TC.NUMCONTA FROM FNTIPOCOB TC
        WHERE TC.CODEMP=new.CODEMPTC AND TC.CODFILIAL=new.CODFILIALTC AND TC.CODTIPOCOB=new.CODTIPOCOB
        INTO new.CODEMPCA, new.CODFILIALCA, new.NUMCONTA;
  end
END ^

CREATE TRIGGER FNPAGARTGAI FOR FNPAGAR 
ACTIVE AFTER INSERT POSITION 0 
as
declare variable vlrpag numeric(15, 5);
declare variable percpag numeric(11,6);
declare variable resto numeric(15, 5);
declare variable numparc integer;
declare variable diaspag integer;
declare variable i integer;
declare variable filialpp integer;
declare variable regrvcto char(1);
declare variable rvsab char(1);
declare variable rvdom char(1);
declare variable rvfer char(1);
declare variable rvdia char(1);
declare variable diavcto smallint;
declare variable casasdecfin smallint;
declare variable dtvencto date;

begin

    -- Buscando filial do plano de pagamento
    select icodfilial from sgretfilial(new.codemp, 'FNPLANOPAG') into :filialpp;

    -- Buscando preferencias

    select casasdecfin from sgprefere1 where codemp=new.codemp and codfilial=new.codfilial
    into casasdecfin;

    -- Carregando valor restante de pagamento
    i = 0;
    resto = new.vlrpag;

    -- Buscando informaes do plano de pagamento
    select pp.parcplanopag, pp.regrvctoplanopag, pp.rvsabplanopag, pp.rvdomplanopag,
           pp.rvferplanopag, pp.rvdiaplanopag, pp.diavctoplanopag
    from fnplanopag pp
    where pp.codplanopag=new.codplanopag and pp.codemp=new.codemp and pp.codfilial=:filialpp
    into :numparc, :regrvcto, :rvsab, :rvdom, :rvfer, :rvdia, :diavcto;

    -- Gerando parcelas

    for select pp.percpag, pp.diaspag
        from fnparcpag pp
        where pp.codplanopag=new.codplanopag and pp.codemp=new.codemp and pp.codfilial=:filialpp
        order by pp.diaspag
        into :percpag, :diaspag
    do
    begin
        i = i + 1;
        
        -- Calculando valor da parcela
        vlrpag = cast(cast(new.vlrpag * percpag as numeric(15, 5)) / 100 as numeric(15, 5));

        -- Usando o arredondamento para evitar dzima
        select v.deretorno
        from arreddouble(:vlrpag,:casasdecfin) v
        into :vlrpag;

        -- Valor restante para proximas parcelas
        resto = resto - vlrpag;

        if (i = numparc) then
        begin
            vlrpag = vlrpag + resto;
        end
        
        -- Buscando data de vencimento
        select c.dtvencret
        from sgcalcvencsp( new.codemp , new.datapag, new.datapag + :diaspag, :regrvcto,
                           :rvsab, :rvdom, :rvfer, :rvdia, :diavcto, :diaspag ) c
        into :dtvencto;

        -- Inserindo parcela

        insert into fnitpagar (CODEMP,CODFILIAL,CODPAG,NPARCPAG,VLRITPAG,VLRDESCITPAG,VLRMULTAITPAG,
                           VLRJUROSITPAG,VLRPARCITPAG,VLRPAGOITPAG,VLRAPAGITPAG,
                           DTITPAG, DTCOMPITPAG, DTVENCITPAG,STATUSITPAG,VLRADICITPAG,FLAG,OBSITPAG,
                           CODEMPTC,CODFILIALTC,CODTIPOCOB,CODEMPCA,CODFILIALCA,NUMCONTA,
                           CODEMPPN, CODFILIALPN, CODPLAN, CODEMPCC, CODFILIALCC, ANOCC, CODCC
                           ) VALUES
                           (new.CODEMP,new.CODFILIAL,new.CODPAG,:i,:vlrpag,0,0,0,:vlrpag,0,:vlrpag,
                            new.datapag, new.DTCOMPPAG, :dtvencto,'P1',new.vlradicpag,new.flag,new.obspag,
                            new.CODEMPTC,new.CODFILIALTC,new.CODTIPOCOB, new.codempca, new.codfilialca, new.numconta,
                            new.codemppn, new.codfilialpn, new.codplan, new.codempcc, new.codfilialcc, new.anocc, new.codcc
                            );
    end

end ^

CREATE TRIGGER FNPAGARTGBU FOR FNPAGAR 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  IF (new.EMMANUT IS NULL) THEN
     new.EMMANUT='N';
  /* Trigger Text */
end ^

CREATE TRIGGER FNPAGARTGBD FOR FNPAGAR 
ACTIVE BEFORE DELETE POSITION 0 
AS
BEGIN
  DELETE FROM FNITPAGAR WHERE CODPAG = old.CODPAG
         AND CODEMP=old.CODEMP AND CODFILIAL = old.CODFILIAL;
END ^

CREATE TRIGGER FNPAGCHEQTGAI FOR FNPAGCHEQ 
ACTIVE AFTER INSERT POSITION 0 
as
    declare variable dtvencitpag date;
begin

    -- Buscando informaes do ttulo
    select ip.dtvencitpag from fnitpagar ip
    where ip.codemp=new.codemp and ip.codfilial=new.codfilial and ip.codpag=new.codpag and ip.nparcpag=new.nparcpag
    into :dtvencitpag;

    -- Atualizando as datas do cheque
    update fncheque ch set ch.dtvenctocheq=:dtvencitpag
    where ch.codemp=new.codempch and ch.codfilial=new.codfilialch and ch.seqcheq=new.seqcheq;

end ^

CREATE TRIGGER FNPAGCHEQTGAU FOR FNPAGCHEQ 
ACTIVE AFTER UPDATE POSITION 0 
as
    declare variable codfilialch smallint;
    declare variable contacheq char(10);
    declare variable codempcb int;
    declare variable codfilialcb smallint;
    declare variable contabaixa char(10);
    declare variable codemppn int;
    declare variable codfilialpn smallint;
    declare variable codplan char(13);
    declare variable tipocheq char(2);
    declare variable dtvenctocheq date;
    declare variable vlrcheq decimal(15,5);
    declare variable vlrapagitpag decimal(15,5);
    declare variable vlrbaixa decimal(15,5);
    declare variable dtcompitpag date;
    declare variable statusitpagar char(2);
    declare variable codempla int;
    declare variable codfilialla smallint;
    declare variable codlancatransf int;
    declare variable codemppnorig int;
    declare variable codfilialpnorig smallint;
    declare variable codplanorig char(13);
    declare variable codemppntransf int;
    declare variable codfilialpntransf smallint;
    declare variable codplantransf char(13);
    declare variable numcheq int;
    declare variable dtcompcheq date;
    declare variable vlrlanca decimal(15,5);
    declare variable icont int;
    declare variable obsitpag varchar(250);
    declare variable histblanca varchar(250);
    declare variable snumcheque varchar(15);
    declare variable sdoccompra varchar(50);
    declare variable nomefavcheq varchar(50);

begin

    -- Busca informaes do cheque
    select ch.tipocheq, ch.contacheq, ch.dtvenctocheq, ch.vlrcheq, ch.numcheq, ch.dtcompcheq, ch.nomefavcheq
    from fncheque ch
    where ch.codemp=new.codempch and ch.codfilial=new.codfilialch and ch.seqcheq=new.seqcheq
    into :tipocheq, :contacheq, :dtvenctocheq, :vlrcheq, :numcheq, :dtcompcheq, :nomefavcheq;

    -- Baixa de ttulo na emisso do cheque
    if(coalesce(old.baixa,'N')='N' and new.baixa='S') then
    begin

        -- Buscando filial da tabela de contas
        select icodfilial from sgretfilial(new.codemp,'FNCONTA') into :codfilialch;

        -- Se o cheque  de pagamento de fornecedores, dever dar baixa no ttulo para a conta de controle de cheques.
        if('PF' = :tipocheq) then
        begin

            -- Busca conta para a baixa
            select cv.codempcv, cv.codfilialcv, cv.numcontacv
            from fncontavinculada cv
            where cv.codemp=new.codempch and cv.codfilial=:codfilialch and cv.numconta=:contacheq
            into :codempcb, :codfilialcb, :contabaixa;

            -- Busca informaes do planejamento
            select ip.vlrapagitpag, coalesce(ip.codemppn,p1.codemppc), coalesce(ip.codfilialpn,p1.codfilialpc),
            coalesce(ip.codplan,p1.codplanpc), coalesce(ip.obsitpag,'')
            from fnitpagar ip, fnpagar pg, sgprefere1 p1
            where ip.codemp=new.codemp and ip.codfilial=new.codfilial and ip.codpag=new.codpag and ip.nparcpag=new.nparcpag
            and p1.codemp=new.codemp and p1.codfilial=new.codfilial
            and pg.codemp=ip.codemp and pg.codfilial=ip.codfilial and pg.codpag=ip.codpag
            into :vlrapagitpag, :codemppn, :codfilialpn, :codplan, :obsitpag;

            -- Calculando valor e status da baixa de acordo com o valor do cheque.
            if(:vlrcheq >= :vlrapagitpag) then
            begin
                vlrbaixa = :vlrapagitpag;
                statusitpagar = 'PP';

            end
            else
            begin
                vlrbaixa = :vlrcheq;
                statusitpagar = 'PL';
            end


            if(:obsitpag='') then
            begin
                obsitpag = 'PGTO C/CHEQUE NRO:' || :numcheq;
            end
            else
            begin
                obsitpag = rtrim(obsitpag) || ' / ' || 'PGTO C/CHEQUE NRO:' || :numcheq;
            end

            -- Realizando a baixa
            update fnitpagar ip set
            ip.numconta=:contabaixa, ip.codempca=:codempcb, ip.codfilialca=:codfilialcb,
            ip.codplan=:codplan, ip.codemppn=:codemppn, ip.codfilialpn=:codfilialpn,
            ip.dtpagoitpag=:dtvenctocheq, ip.vlrpagoitpag=:vlrbaixa,
            ip.statusitpag=:statusitpagar, obsitpag=:obsitpag, multibaixa='N'
            where ip.codpag=new.codpag and ip.nparcpag=new.nparcpag and ip.codemp=new.codemp and ip.codfilial=new.codfilial;
        end
   end

    -- Transferencia de baixa na compensao do cheque
    if(coalesce(old.transfere,'N')='N' and new.transfere='S') then
    begin
        icont = 0;
        for
            select
            la.codemp, la.codfilial, la.codemppn, la.codfilialpn, la.codplan, la.vlrlanca, pg.dtcompitpag, coalesce(p.docpag,'') || '/' || coalesce(pg.nparcpag,'')
            from fnlanca la, fnitpagar pg, fnpagcheq pc, fnpagar p
            where pc.codemp=pg.codemp and pc.codfilial=pg.codfilial and pc.codpag=pg.codpag and pc.nparcpag=pg.nparcpag and
            la.codemppg=pg.codemp and la.codfilialpg=pg.codfilial and la.codpag=pg.codpag and la.nparcpag=pg.nparcpag
            and pc.codemp=new.codemp and pc.codfilial=new.codfilial and pc.codpag=new.codpag and pc.nparcpag=new.nparcpag
            and p.codemp=pg.codemp and p.codfilial=pg.codfilial and p.codpag=pg.codpag
            into :codempla, :codfilialla, :codemppnorig, :codfilialpnorig, :codplanorig, :vlrlanca, :dtcompitpag, :sdoccompra


        do
        begin

             icont = :icont + 1;

            -- Buscando cdigo do novo lanamento
            select iseq from spgeranum(:codempla, :codfilialla, 'LA' ) into :codlancatransf;

            -- Buscando conta planejamento da compensao.
            select ct.codemppn, ct.codfilialpn, ct.codplan
            from fncontavinculada cv, fnconta ct, fnconta ctv
            where ct.codemp=cv.codemp and ct.codfilial=cv.codfilial and ct.numconta=cv.numconta
            and ctv.codemppn=:codemppnorig and ctv.codfilialpn=:codfilialpnorig and ctv.codplan=:codplanorig
            and cv.codempcv=ctv.codemp and cv.codfilialcv=ctv.codfilial and cv.numcontacv=ctv.numconta and cv.contacheque='S'
            into :codemppntransf, :codfilialpntransf, codplantransf;

            -- Montando histrico...
            snumcheque = rtrim(coalesce(cast(:numcheq as char(15)),'0'));
            histblanca = 'CH CP [' || :snumcheque || '] NF ' || :sdoccompra || ' ' || coalesce(:nomefavcheq,'');

            -- Inserir lanamento na primeira passada....

            if(:icont=1) then
            begin

                -- Inserindo lanamento de transferncia...
                insert into fnlanca (
                    tipolanca, codemp, codfilial, codlanca,
                    codemppn, codfilialpn, codplan, dtcomplanca,
                    datalanca, doclanca, histblanca, transflanca, vlrlanca )
                values (
                      'A', :codempla, :codfilialla, :codlancatransf,
                  :codemppntransf, :codfilialpntransf, :codplantransf, :dtcompitpag, 
                  :dtcompcheq, :snumcheque, :histblanca, 'S', 0);

            end

            -- Inserindo sub-lanamento de transferncia...

            insert into fnsublanca (
                codemp, codfilial, codlanca, codsublanca,
                codemppn, codfilialpn, codplan, dtcompsublanca,
                datasublanca, vlrsublanca, histsublanca)
            values (
                :codempla, :codfilialla, :codlancatransf, :icont,
                :codemppnorig, :codfilialpnorig, :codplanorig, :dtcompitpag,
                :dtcompcheq, :vlrlanca * -1 , :histblanca );

        end

    end
end ^

CREATE TRIGGER FNPAGCHEQTGAD FOR FNPAGCHEQ 
ACTIVE AFTER DELETE POSITION 0 
AS
begin
    -- Estorno do pagamento com o cheque...

    UPDATE FNITPAGAR SET STATUSITPAG='P1' WHERE CODPAG=old.codpag AND NPARCPAG=old.nparcpag AND CODEMP=old.codemp AND CODFILIAL=old.codfilial;


end ^

CREATE TRIGGER FNPAGTOCOMITGAI FOR FNPAGTOCOMI 
ACTIVE AFTER INSERT POSITION 0 
AS
  DECLARE VARIABLE iCodLanca INTEGER;
  DECLARE VARIABLE sCodPlanConta CHAR(13);
  DECLARE VARIABLE iPlanEmp INTEGER;
  DECLARE VARIABLE iPlanFilial INTEGER;
  DECLARE VARIABLE IFILIALLANCA INTEGER;
  DECLARE VARIABLE sObsPComi varchar(100);
BEGIN
  IF (new.OBSPCOMI is null) THEN
  BEGIN
     sObsPComi = '';
  END
  ELSE
  BEGIN
     sObsPComi = SUBSTRING(new.OBSPCOMI from 1 for 100);
  END

  SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'FNLANCA') INTO IFILIALLANCA;
  SELECT CODPLAN,CODEMP,CODFILIAL FROM FNCONTA WHERE NUMCONTA=new.NUMCONTA
         AND CODEMP=new.CODEMPCA AND CODFILIAL = new.CODFILIALCA INTO :sCodPlanConta,:iPlanEmp,:iPlanFilial;
  SELECT ISEQ FROM SPGERANUM(new.CODEMP,new.CODFILIAL,'LA') INTO :iCodLanca;
  INSERT INTO FNLANCA (CODEMP,CODFILIAL,CODLANCA,CODEMPCI,CODFILIALCI,CODPCOMI,CODEMPPN,CODFILIALPN,CODPLAN,DTCOMPLANCA,DATALANCA,DOCLANCA,
                     HISTBLANCA,DTPREVLANCA,VLRLANCA,FLAG)
            VALUES (new.CODEMP,new.CODFILIAL,:iCodLanca,new.CODEMP,new.CODFILIAL,new.CODPCOMI,:iPlanEmp,:iPlanFilial,:sCodPlanConta, new.DTCOMPPCOMI, new.DATAPCOMI,
                   new.DOCPCOMI,:sObsPComi,new.DATAPCOMI,0,new.FLAG);
  INSERT INTO FNSUBLANCA (CODEMP,CODFILIAL,CODLANCA,CODSUBLANCA,CODEMPPN,CODFILIALPN,CODPLAN,ORIGSUBLANCA,DTCOMPSUBLANCA,DATASUBLANCA,DTPREVSUBLANCA,VLRSUBLANCA,FLAG)
            VALUES (new.CODEMP,new.CODFILIAL,:iCodLanca,1,new.CODEMPPN,new.CODFILIALPN,new.CODPLAN,'S',new.DTCOMPPCOMI, new.DATAPCOMI,new.DATAPCOMI,new.VLRPCOMI,new.FLAG);
END ^

CREATE TRIGGER FNPAGTOCOMITGBU FOR FNPAGTOCOMI 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  if (new.EMMANUT IS NULL) then
    new.EMMANUT='N';
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER FNPAGTOCOMITGBD FOR FNPAGTOCOMI 
ACTIVE BEFORE DELETE POSITION 0 
AS
DECLARE VARIABLE IFILIALLANCA INTEGER;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(old.CODEMP,'FNLANCA') INTO IFILIALLANCA;
  DELETE FROM FNLANCA WHERE CODPCOMI=old.codpcomi
         AND CODEMPCI=old.CODEMP AND CODFILIALCI=old.CODFILIAL
         AND CODEMP=old.CODEMP AND CODFILIAL=:IFILIALLANCA;
END ^

CREATE TRIGGER FNPARCPAGTGBU FOR FNPARCPAG 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER FNPLANEJAMENTOTGBI FOR FNPLANEJAMENTO 
ACTIVE BEFORE INSERT POSITION 0 
AS
declare variable codredplan Integer;
begin

    -- Se  de nvel analtico deve gerar cdigo reduzido
    if (new.nivelplan=6 and new.codredplan is null) then
    begin

        select coalesce(max(codredplan),0) from fnplanejamento where codemp=new.codemp and codfilial = new.codfilial
        into :codredplan;

        new.codredplan = codredplan + 1;

     end
end ^

CREATE TRIGGER FNPLANEJAMENTOTGBU FOR FNPLANEJAMENTO 
ACTIVE BEFORE UPDATE POSITION 0 
as
declare variable codredplan integer;
begin
    new.DTALT=cast('now' AS DATE);
    new.IDUSUALT=USER;
    new.HALT = cast('now' AS TIME);
     -- Se  de nvel analtico deve gerar cdigo reduzido
    if (new.nivelplan=6 and new.codredplan is null) then
    begin
        select coalesce(max(codredplan),0) from fnplanejamento where codemp=new.codemp and codfilial = new.codfilial
        into :codredplan;
        if (codredplan is null) then
        begin
           codredplan = 0;
        end
        new.codredplan = codredplan + 1;
    end
    if ( (old.codredplan is null and new.codredplan is not null) or (new.codredplan <> old.codredplan) ) then
    begin
        codredplan = null;
        select first 1 codredplan from fnplanejamento where codemp=new.codemp and codfilial=new.codfilial and codplan<>old.codplan and codredplan=new.codredplan
        into :codredplan;
        if(:codredplan is not null) then
        begin
            exception fnplanejamento01;
        end
     end
end ^

CREATE TRIGGER FNPLANOPAGTGAI FOR FNPLANOPAG 
ACTIVE AFTER INSERT POSITION 0 
AS
DECLARE VARIABLE i Integer;
DECLARE VARIABLE iDias Integer;
DECLARE VARIABLE dPerc NUMERIC(10,6);
DECLARE VARIABLE dTotPerc NUMERIC(10,6);
BEGIN
   IF (new.PARCPLANOPAG>0) THEN
   BEGIN
     i = 1;
     dTotPerc = 0;
     dPerc = 100.000000/new.PARCPLANOPAG;
     WHILE (i<=new.PARCPLANOPAG) DO
     BEGIN
        iDias = (i-1)*30;
        IF (i = new.PARCPLANOPAG) THEN
          dPerc = 100.000000-dTotPerc;
        INSERT INTO FNPARCPAG (CODEMP,CODFILIAL,CODPLANOPAG,NROPARCPAG,PERCPAG,DIASPAG)
               VALUES (new.CODEMP,new.CODFILIAL,new.CODPLANOPAG,:i,:dPerc,:iDias);
        dTotPerc = dTotPerc + dPerc;
        i = i + 1;
     END
   END
END ^

CREATE TRIGGER FNPLANOPAGTGBU FOR FNPLANOPAG 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER FNPLANOPAGTGBD FOR FNPLANOPAG 
ACTIVE BEFORE DELETE POSITION 0 
AS
BEGIN
  DELETE FROM FNPARCPAG WHERE CODPLANOPAG=old.CODPLANOPAG
         AND CODEMP=old.CODEMP AND CODFILIAL = old.CODFILIAL;
END ^

CREATE TRIGGER FNRECEBERTGBI FOR FNRECEBER 
ACTIVE BEFORE INSERT POSITION 0 
AS
BEGIN
  new.DTINS=cast('now' AS DATE);
  new.IDUSUINS=USER;
  new.HINS = cast('now' AS TIME);
  IF (new.VLRREC IS NULL) THEN new.VLRREC = 0;
  IF (new.VLRDESCREC IS NULL) THEN new.VLRDESCREC = 0;
  IF (new.VLRJUROSREC IS NULL) THEN new.VLRJUROSREC = 0;
  IF (new.VLRMULTAREC IS NULL) THEN new.VLRMULTAREC = 0;
  IF (new.VLRPARCREC IS NULL) THEN new.VLRPARCREC = 0;
  IF (new.VLRAPAGREC IS NULL) THEN new.VLRAPAGREC = 0;
  IF (new.VLRPAGOREC IS NULL) THEN new.VLRPAGOREC = 0;
  IF (new.DTCOMPREC IS NULL) THEN new.DTCOMPREC = new.DATAREC;
END ^

CREATE TRIGGER FNRECEBERTGAI FOR FNRECEBER 
ACTIVE AFTER INSERT POSITION 0 
AS
  DECLARE VARIABLE NPARCREC INTEGER;
  DECLARE VARIABLE CODFILIALPP SMALLINT;
  DECLARE VARIABLE CODFILIALPN SMALLINT;
  DECLARE VARIABLE CODPLAN CHAR(13);
  DECLARE VARIABLE CODCC CHAR(19);
  DECLARE VARIABLE ANOCC SMALLINT;
  DECLARE VARIABLE CODFILIALCC SMALLINT;
  DECLARE VARIABLE CODFILIALIR SMALLINT;
  DECLARE VARIABLE CODFILIALCL SMALLINT;
  DECLARE VARIABLE ATIVOCLI CHAR(1);
  DECLARE VARIABLE NUMRESTR INTEGER;
  DECLARE VARIABLE CODFILIALCA SMALLINT;
  DECLARE VARIABLE CODEMPCA INTEGER;
  DECLARE VARIABLE NUMCONTA CHAR(10);
  declare variable docvenda integer;
  declare variable serievenda char(4);

BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(NEW.CODEMP,'VDCLIENTE') INTO CODFILIALCL;
  SELECT C.ATIVOCLI  FROM VDCLIENTE C WHERE C.CODEMP=NEW.CODEMP AND
     C.CODFILIAL=:CODFILIALCL AND C.CODCLI=NEW.CODCLI INTO :ATIVOCLI;
  IF (ATIVOCLI<>'S') THEN
  BEGIN
     EXCEPTION FNRECEBEREX01;
  END
  SELECT COUNT(*) FROM FNRESTRICAO R, FNTIPORESTR TR
    WHERE R.CODEMP=NEW.CODEMP AND R.CODFILIAL=:CODFILIALCL AND
      R.CODCLI=NEW.CODCLI AND R.SITRESTR IN ('I') AND
      TR.CODEMP=R.CODEMPTR AND TR.CODFILIAL=R.CODFILIALTR AND
      TR.CODTPRESTR=R.CODTPRESTR AND TR.BLOQTPRESTR='S'
      INTO :NUMRESTR;
  IF ( (NUMRESTR IS NOT NULL) AND (NUMRESTR>0) ) THEN
  BEGIN
     IF (NUMRESTR=1) THEN
     BEGIN
        EXCEPTION FNRECEBEREX02 'Cliente possui '||RTRIM(CAST(NUMRESTR AS CHAR(10)))||' restrio!';
     END
     ELSE
     BEGIN
        EXCEPTION FNRECEBEREX02 'Cliente possui '||RTRIM(CAST(NUMRESTR AS CHAR(10)))||' restries!';
     END
  END
  SELECT ICODFILIAL FROM SGRETFILIAL(NEW.CODEMP,'FNPLANOPAG') INTO CODFILIALPP;
  SELECT ICODFILIAL FROM SGRETFILIAL(NEW.CODEMP,'FNPLANEJAMENTO') INTO CODFILIALPN;
  SELECT ICODFILIAL FROM SGRETFILIAL(NEW.CODEMP,'FNCENTROCUSTO') INTO CODFILIALCC;
  SELECT ICODFILIAL FROM SGRETFILIAL(NEW.CODEMP,'FNITRECEBER') INTO CODFILIALIR;

  if(new.codvenda is not null and new.numconta is null) then
  begin
    select codempca,codfilialca,numconta, vd.docvenda, vd.serie from vdvenda vd
    where codemp=new.codempva and codfilial=new.codfilialva and codvenda=new.codvenda and tipovenda=new.tipovenda
    into :codempca, :codfilialca, :numconta, :docvenda, :serievenda;
  end
  else
  begin
    codempca = new.codempca;
    codfilialca = new.codfilialca;
    numconta = new.numconta;
  end

  if (new.codvenda is not null and :docvenda is null) then
  begin
    select vd.docvenda, vd.serie from vdvenda vd
    where codemp=new.codempva and codfilial=new.codfilialva and codvenda=new.codvenda and tipovenda=new.tipovenda
    into :docvenda, :serievenda;
  end
  
  SELECT I FROM fngeraitrecebersp01('S',new.CODEMP,
    new.CODFILIAL, new.CODREC, new.CODEMPPG, new.CODFILIALPG, new.CODPLANOPAG,
    new.VLRREC, new.DATAREC, new.DTCOMPREC, new.FLAG, new.CODEMPBO, new.CODFILIALBO,
    new.CODBANCO, new.CODEMPTC, new.CODFILIALTC, new.CODTIPOCOB,
    new.CODEMPCB, new.CODFILIALCB, new.CODCARTCOB,
    new.VLRCOMIREC, new.OBSREC, :codempca, :codfilialca, :numconta,
    new.codemppn, new.codfilialpn, new.codplan, new.codempcc,  new.codfilialcc, new.anocc, new.codcc, new.vlrbasecomis
    ) INTO :NPARCREC;

/* Se a parcela do plano de pagamento tiver marcado para autobaixa, ento  realizada a baixa automtica. */
  FOR SELECT PP.NUMCONTA,PP.CODFILIALCA,PP.CODEMPCA, PP.CODPLAN,PP.CODFILIALPN,PP.CODCC,PP.ANOCC,PP.CODFILIALCC,PC.NROPARCPAG
      FROM FNPARCPAG PC, FNPLANOPAG PP
      WHERE
        PP.CODEMP=NEW.CODEMP AND PP.CODFILIAL=:CODFILIALPP AND PP.CODPLANOPAG=NEW.CODPLANOPAG AND
        PC.CODEMP=PP.CODEMP AND PC.CODFILIAL=PP.CODFILIAL AND PC.CODPLANOPAG=PP.CODPLANOPAG AND
        PC.AUTOBAIXAPARC='S'
      INTO NUMCONTA,CODFILIALCA,CODEMPCA, CODPLAN,CODFILIALPN,CODCC,ANOCC,CODFILIALCC,NPARCREC
  DO
  BEGIN
    UPDATE FNITRECEBER SET
      NUMCONTA=:NUMCONTA,
      CODEMPCA=:CODEMPCA,
      CODFILIALCA=:CODFILIALCA,
      -- NUMCONTA=:NUMCONTA,
      CODPLAN=:CODPLAN,
      CODEMPPN=NEW.CODEMP,
      CODFILIALPN=:CODFILIALPN,
      ANOCC=:ANOCC,
      CODCC=:CODCC,
      CODEMPCC=NEW.CODEMP,
      CODFILIALCC=:CODFILIALCC,
      DOCLANCAITREC= :docvenda || '/' || :nparcrec,
--      DOCLANCAITREC='AUTO',
      DTPAGOITREC=NEW.DATAREC,
      VLRPAGOITREC=VLRPARCITREC - coalesce(vlrdescitrec,0),
--      VLRDESCITREC=0,
      VLRJUROSITREC=0,
      OBSITREC='BAIXA AUTOMTICA' || ' REF. DOC: ' || :serievenda || '-' || :docvenda,
      STATUSITREC='RP'
      WHERE CODREC=NEW.CODREC AND CODEMP=NEW.CODEMP AND CODFILIAL=:CODFILIALIR AND
      NPARCITREC=:NPARCREC;
  END
END ^

CREATE TRIGGER FNRECEBERTGBU FOR FNRECEBER 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  IF (new.EMMANUT IS NULL) then
     new.EMMANUT='N';
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
  BEGIN
      new.DTALT=cast('now' AS DATE);
      new.IDUSUALT=USER;
      new.HALT = cast('now' AS TIME);
      IF ( (new.DTCOMPREC IS NULL) or (new.DATAREC<>old.DATAREC) ) THEN
         new.DTCOMPREC = new.DATAREC;
      new.VLRAPAGREC = new.VLRREC - new.VLRPAGOREC;
      if ( (new.VLRAPAGREC<0 ) or ( new.VLRAPAGREC is null ) ) then
         new.VLRAPAGREC = 0;  
  END
  /* Trigger Text */
end ^

CREATE TRIGGER FNRECEBERTGAU FOR FNRECEBER 
ACTIVE AFTER UPDATE POSITION 0 
as
    declare variable inparcold integer;
    declare variable inparcnew integer;
    declare variable caltvlr char(1);
    declare variable regrvcto char(1);
    declare variable rvsab char(1);
    declare variable rvdom char(1);
    declare variable rvfer char(1);
    declare variable rvdia char(1);
    declare variable diavcto smallint;
    declare variable diaspag smallint;
    declare variable dtvencto date;
    declare variable nroparcrec smallint;

    begin
      if ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) then
      begin

        -- Se houver alteraes relevantes...
        if ( (
                (old.codplanopag<>new.codplanopag) or
                (old.flag<>new.flag) or
                (old.vlrrec<>new.vlrrec) or
                (old.datarec<>new.datarec) or
                (coalesce(old.obsrec,'')<>coalesce(new.obsrec,''))
            )

            and (new.altusurec != 'S')

        ) then

        begin

            -- Se foi alterado o plano de pagamento            
            if (old.codplanopag <> new.codplanopag) then
            begin

                -- Buscando informaes do plano de pagamento antigo
                select pp.parcplanopag from fnplanopag pp
                where codemp=old.codemppg and pp.codfilial=old.codfilialpg and pp.codplanopag=old.codplanopag
                into :inparcold;

                -- Buscando informaes do novo plano de pagamento
                select pp.parcplanopag, pp.regrvctoplanopag, pp.rvsabplanopag, pp.rvdomplanopag,
                pp.rvferplanopag, pp.rvdiaplanopag, pp.diavctoplanopag
                from fnplanopag pp
                where pp.codemp=new.codemppg and pp.codfilial=new.codfilialpg and pp.codplanopag = new.codplanopag
                into :inparcnew, :regrvcto, :rvsab, :rvdom, :rvfer, :rvdia, :diavcto;

                -- Se o numero de parcelas entre os planos de pagamento so diferentes.
                if (inparcnew != inparcold) then
                begin
                    -- exclui os itens de contas a receber, para recria-los.
                    delete from fnitreceber where codrec=new.codrec and codemp=new.codemp and codfilial=new.codfilial;
                end
                -- Caso possua apenas uma parcela deve apenas atualizar a data do vencimento.
                else if (inparcnew=1) then
                begin
                    -- Buscando informao do item do plano de pagamento
                    select diaspag from fnparcpag
                    where codplanopag=new.codplanopag and codemp=new.codemppg and codfilial=new.codfilialpg
                    into :diaspag;

                    -- Calculando o vencimento da parcela.
                    select c.dtvencret from sgcalcvencsp( new.codemppg, new.datarec, new.datarec + :diaspag,
                    :regrvcto, :rvsab, :rvdom, :rvfer, :rvdia, :diavcto, :diaspag ) c
                    into :dtvencto;

                    -- Atualizando item do contas a receber
                    update fnitreceber set dtvencitrec=:dtvencto
                    where codemp=new.codemp and codfilial=new.codfilial and codrec=new.codrec and
                    statusitrec not in ('RP','RL');

                end
            end

            -- Se o valor foi alterado
            if (new.vlrrec!=old.vlrrec) then
                caltvlr = 'S';
            else
                caltvlr = 'N';

            select i from fngeraitrecebersp01(:caltvlr,  new.codemp, new.codfilial, new.codrec, new.codemppg,
            new.codfilialpg, new.codplanopag, new.vlrrec, new.datarec, new.dtcomprec, new.flag, new.codempbo, new.codfilialbo,
            new.codbanco, new.codemptc, new.codfilialtc, new.codtipocob, new.codempcb, new.codfilialcb, new.codcartcob,
            new.vlrcomirec, new.obsrec, null, null, null, new.codemppn, new.codfilialpn,new.codplan, new.codempcc,
            new.codfilialcc, new.anocc, new.codcc, new.vlrbasecomis)
            into :nroparcrec;

        end

        -- Atualiza os itens para eles atualizarem a comissao de forma distribuida.
        if (old.vlrcomirec != new.vlrcomirec) then
        begin
            execute procedure fnitrecebersp01(new.codemp, new.codfilial, new.codrec, new.vlrparcrec,
            new.vlrcomirec, new.nroparcrec, 'N');
        end
      end
    end ^

CREATE TRIGGER FNRECEBERRGBD FOR FNRECEBER 
ACTIVE BEFORE DELETE POSITION 0 
AS
BEGIN
    DELETE FROM FNITRECEBER WHERE CODREC = old.CODREC
         AND CODEMP=old.CODEMP AND CODFILIAL = old.CODFILIAL;
END ^

CREATE TRIGGER FNRECEBERTGAD FOR FNRECEBER 
ACTIVE AFTER DELETE POSITION 0 
AS
begin
 delete from fnrenegrec where codrenegrec = old.codrenegrec and codfilial = old.codfilial
    and codemp = old.codemp;
end ^

CREATE TRIGGER FNRENEGRECTGBU FOR FNRENEGREC 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER FNRENEGRECTGBD FOR FNRENEGREC 
ACTIVE BEFORE DELETE POSITION 0 
AS
begin
 delete from fnitrenegrec where codemp = old.codemp and codfilial = old.codfilial
 and codrenegrec = old.codrenegrec;
end ^

CREATE TRIGGER FNRESTRICAOTGBU FOR FNRESTRICAO 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  IF (new.DTCANCRESTR IS NOT NULL) THEN
  BEGIN
     new.SITRESTR = 'C';
  END
end ^

CREATE TRIGGER FNSALDOLANCATGBI FOR FNSALDOLANCA 
ACTIVE BEFORE INSERT POSITION 0 
AS
begin

    -- carregando valores para saldo...
    if (new.SALDOSL is null) then
        new.SALDOSL = 0;
    if (new.PREVSL is null) then
        new.PREVSL = 0;

end ^

CREATE TRIGGER FNSALDOLANCATGAI FOR FNSALDOLANCA 
ACTIVE AFTER INSERT POSITION 0 
AS
    declare variable fechacaixa char(1);
    declare variable fechacaixaauto char(1);
begin

    -- buscando preferncias para fechamento de caixas

    select coalesce(p1.fechacaixa,'N'),  coalesce(p1.fechacaixaauto,'N') from sgprefere1 p1
    where p1.codemp=new.codemp and p1.codfilial=new.codfilial
    into :fechacaixa, :fechacaixaauto;

    -- carregando valores para saldo...
    -- if (new.SALDOSL is null) then
    --     new.SALDOSL = 0;
    -- if (new.PREVSL is null) then
    --     new.PREVSL = 0;

    -- Fechando todos os caixas anteriors...

    if('S' = :fechacaixa and 'S' = :fechacaixaauto) then
    begin
        update fnsaldolanca sl
        set sl.fechado='S'
        where coalesce(sl.fechado,'N')='N'
        and sl.codemp=new.codemp and sl.codfilial=new.codfilial
        and sl.codemppn=new.codemppn and sl.codfilialpn=new.codfilialpn
        and sl.codplan=new.codplan
        and sl.datasl < new.datasl;
    end
end ^

CREATE TRIGGER FNSALDOLANCATGBU FOR FNSALDOLANCA 
ACTIVE BEFORE UPDATE POSITION 0 
as
    declare variable fechacaixa char(1);
 --   declare variable fechacaixaauto char(1);
    declare variable fechado char(1);
    declare variable numconta char(10);

begin

    -- buscando preferncias para fechamento de caixas

    select coalesce(p1.fechacaixa,'N') from sgprefere1 p1
    where p1.codemp=new.codemp and p1.codfilial=new.codfilial
    into :fechacaixa;

    -- Verifica se a conta  de caixa, pois deve bloquear apenas contas caixa...
    select ct.numconta from fnconta ct
    where ct.codemppn=new.codemppn and ct.codfilialpn=new.codfilialpn
    and ct.codplan=new.codplan
    into :numconta;

    -- Verifica se deve verificar o fechamento de caixas...
    if('S' = :fechacaixa and :numconta is not null) then
    begin

        if(new.fechado is null) then
        begin
           new.fechado = 'N';
        end

        -- Verifica se o caixa est fechado antes de permitir a atualizao

        if( new.fechado='N' ) then
        begin
            --Verifica se os caixas futuros esto fechados.

            select first 1 sl.fechado from fnsaldolanca sl
            where
            sl.codemp=new.codemp and sl.codfilial=new.codfilial
            and sl.codemppn=new.codemppn and sl.codfilialpn=new.codfilialpn and sl.codplan=new.codplan
            and coalesce(sl.fechado,'N')='S' and sl.datasl>new.datasl
            into :fechado;

            if( (new.fechado='S' or :fechado='S' ) and old.saldosl<>new.saldosl) then
            begin
                exception FNSALDOLANCAEX01;
            end
        end
        else if(old.saldosl<>new.saldosl) then
        begin
            exception FNSALDOLANCAEX01;
        end
    end

    new.DTALT=cast('now' AS DATE);
    new.IDUSUALT=USER;
    new.HALT = cast('now' AS TIME);

end ^

CREATE TRIGGER FNSUBLANCATGBI FOR FNSUBLANCA 
ACTIVE BEFORE INSERT POSITION 0 
AS
  DECLARE VARIABLE sEhTransf CHAR(1);
  DECLARE VARIABLE sTipoPlan CHAR(1);
  DECLARE VARIABLE dDataLanca DATE;
  DECLARE VARIABLE dDtPrevLanca DATE;
  DECLARE VARIABLE sHistSubLanc VARCHAR(250);
BEGIN
  /*IF ( new.VLRSUBLANCA = 0 ) THEN
     EXCEPTION FNSUBLANCAEX04;         */
  IF (new.EMMANUT IS NULL) THEN
     new.EMMANUT = 'N';
  SELECT HISTBLANCA FROM FNLANCA WHERE CODLANCA = new.CODLANCA AND CODEMP=new.CODEMP AND CODFILIAL = new.CODFILIAL
  INTO sHistSubLanc;

  IF (new.HISTSUBLANCA IS NULL) THEN
      new.HISTSUBLANCA = sHistSubLanc;

  IF (new.CODSUBLANCA IS NULL) THEN
    SELECT MAX(CODSUBLANCA) FROM FNSUBLANCA
    WHERE CODLANCA = new.CODLANCA AND CODEMP=new.CODEMP AND CODFILIAL = new.CODFILIAL
    INTO new.CODSUBLANCA;

  new.STATUSSUBLANCA = 'S1';

  SELECT TRANSFLANCA,DATALANCA,DTPREVLANCA FROM FNLANCA
  WHERE CODLANCA = new.CODLANCA AND CODEMP=new.CODEMP AND CODFILIAL = new.CODFILIAL
  INTO sEhTransf,dDataLanca,dDtPrevLanca;

  SELECT TIPOPLAN FROM FNPLANEJAMENTO WHERE CODPLAN = new.CODPLAN AND CODEMP=new.CODEMPPN AND CODFILIAL = new.CODFILIALPN
  INTO sTipoPlan;

  new.DATASUBLANCA = dDataLanca;

  IF (new.DTCOMPSUBLANCA IS NULL) THEN
     new.DTCOMPSUBLANCA = new.DATASUBLANCA;

  IF (new.CODSUBLANCA > 0) THEN
  BEGIN
    new.ORIGSUBLANCA = 'N';
  END

  new.STATUSSUBLANCA = 'S1';
  new.DTPREVSUBLANCA = dDtPrevLanca;

  IF (sEhTransf = 'S') THEN
  BEGIN
   IF (new.CODSUBLANCA = 2) THEN
     EXCEPTION FNSUBLANCAEX01;
   ELSE IF (sTipoPlan IN ('D','R')) THEN
     EXCEPTION FNSUBLANCAEX02;
  END
  ELSE
    IF ((new.CODSUBLANCA != 0) AND (sTipoPlan IN ('C','B'))) THEN
      EXCEPTION FNSUBLANCAEX03;
  UPDATE FNLANCA SET STATUSLANCA = 'L2', VLRLANCA=(VLRLANCA-new.VLRSUBLANCA)
         WHERE CODLANCA = new.CODLANCA AND CODEMP=new.CODEMP AND CODFILIAL=new.CODFILIAL;
END ^

CREATE TRIGGER FNSUBLANCATGAI FOR FNSUBLANCA 
ACTIVE AFTER INSERT POSITION 0 
AS
DECLARE VARIABLE sCodplan CHAR(13);
DECLARE VARIABLE dSaldoAnt NUMERIC(15, 5);
DECLARE VARIABLE IFILIALSALDO INTEGER;
declare variable codfilialpn smallint;
BEGIN

  SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'FNSALDOLANCA') INTO IFILIALSALDO;
  SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'FNPLANEJAMENTO') INTO :codfilialpn;

  SELECT CODPLAN FROM FNSALDOLANCA
  WHERE CODPLAN=new.CODPLAN AND DATASL=new.DATASUBLANCA AND CODEMP=new.CODEMP AND CODFILIAL = :IFILIALSALDO
  INTO :sCodplan;


   IF (:sCodplan IS NULL ) THEN
   BEGIN

      SELECT SALDOSL FROM FNSALDOLANCA SL1 WHERE SL1.CODPLAN=new.CODPLAN and sl1.codemppn=new.codemp and sl1.codfilialpn=:codfilialpn
             AND SL1.DATASL=(
                            SELECT MAX(SL2.DATASL) FROM FNSALDOLANCA SL2 WHERE
                                   SL2.CODPLAN=SL1.CODPLAN AND SL2.DATASL<new.DATASUBLANCA
                                   AND SL2.CODEMP=new.CODEMP AND SL2.CODFILIAL=:IFILIALSALDO
                            )
              AND SL1.CODEMP=new.CODEMP AND SL1.CODFILIAL = :IFILIALSALDO INTO :dSaldoAnt;



      IF (:dSaldoAnt IS NULL) THEN
         dSaldoAnt = 0;

      INSERT INTO FNSALDOLANCA (CODEMP,CODFILIAL,CODPLAN,CODEMPPN,CODFILIALPN,DATASL,SALDOSL)
             VALUES (new.CODEMPPN,:IFILIALSALDO,new.CODPLAN,new.CODEMPPN,new.CODFILIALPN,new.DATASUBLANCA,:dSaldoAnt+new.VLRSUBLANCA);

      UPDATE FNSALDOLANCA SET SALDOSL = SALDOSL + new.VLRSUBLANCA
             WHERE CODPLAN=new.CODPLAN AND DATASL>new.DATASUBLANCA
             AND CODEMP=new.CODEMP AND CODFILIAL=:IFILIALSALDO;



   END
   ELSE
   BEGIN

      UPDATE FNSALDOLANCA SET SALDOSL = SALDOSL + new.VLRSUBLANCA
             WHERE CODPLAN=new.CODPLAN AND DATASL>=new.DATASUBLANCA
             AND CODEMP=new.CODEMP AND CODFILIAL=:IFILIALSALDO;

   END
END ^

CREATE TRIGGER FNSUBLANCATGBU FOR FNSUBLANCA 
ACTIVE BEFORE UPDATE POSITION 0 
AS
  DECLARE VARIABLE sEhTransf CHAR(1);
  DECLARE VARIABLE sTipoPlan CHAR(1);
  DECLARE VARIABLE IFILIALSALDO INTEGER;
BEGIN
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
  BEGIN
     new.DTALT=cast('now' AS DATE);
     new.IDUSUALT=USER;
     new.HALT = cast('now' AS TIME);
     /*IF ( new.VLRSUBLANCA = 0 ) THEN
        EXCEPTION FNSUBLANCAEX04;   */
     SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'FNSALDOLANCA') INTO IFILIALSALDO;
     SELECT TIPOPLAN FROM FNPLANEJAMENTO WHERE CODPLAN = new.CODPLAN
            AND CODEMP=new.CODEMPPN AND CODFILIAL = new.CODFILIALPN INTO sTipoPlan;
     SELECT TRANSFLANCA FROM FNLANCA WHERE CODLANCA = new.CODLANCA
            AND CODEMP=new.CODEMP AND CODFILIAL = new.CODFILIAL INTO sEhTransf;
     IF (sEhTransf = 'S') THEN
     BEGIN
         IF (new.CODSUBLANCA = 2) THEN
        EXCEPTION FNSUBLANCAEX01;
      ELSE IF (sTipoPlan IN ('D','R')) THEN
        EXCEPTION FNSUBLANCAEX02;
     END
     ELSE
       IF ((new.CODSUBLANCA != 0) AND (sTipoPlan IN ('C','B'))) THEN
         EXCEPTION FNSUBLANCAEX03;
     IF ((new.CODSUBLANCA != 0) AND (old.VLRSUBLANCA <> new.VLRSUBLANCA)) THEN
       UPDATE FNLANCA SET VLRLANCA = ((VLRLANCA+old.VLRSUBLANCA)-new.VLRSUBLANCA)
              WHERE CODLANCA = new.CODLANCA AND CODEMP=new.CODEMP AND CODFILIAL=new.CODFILIAL;
     IF ( (old.DATASUBLANCA <> new.DATASUBLANCA) OR (old.VLRSUBLANCA<>new.VLRSUBLANCA) OR (old.CODPLAN<>new.CODPLAN) ) THEN
       UPDATE FNSALDOLANCA SET SALDOSL = SALDOSL - old.VLRSUBLANCA
              WHERE CODPLAN=old.CODPLAN AND DATASL>=old.DATASUBLANCA
              AND CODEMP=old.CODEMP AND CODFILIAL=:IFILIALSALDO;
   END
END ^

CREATE TRIGGER FNSUBLANCATGAU FOR FNSUBLANCA 
ACTIVE AFTER UPDATE POSITION 0 
AS
DECLARE VARIABLE dDataSl DATE;
DECLARE VARIABLE dSaldoSl NUMERIC(15, 5);
DECLARE VARIABLE sCodplan CHAR(13);
DECLARE VARIABLE dSaldoAnt NUMERIC(15, 5);
DECLARE VARIABLE IFILIALSALDO INTEGER;
declare variable codfilialpn smallint;
BEGIN

   IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
   BEGIN

      SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'FNSALDOLANCA') INTO IFILIALSALDO;
      SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'FNPLANEJAMENTO') INTO :codfilialpn;

      IF ( (old.DATASUBLANCA <> new.DATASUBLANCA) OR (old.VLRSUBLANCA<>new.VLRSUBLANCA) ) THEN
      BEGIN
   /*Verifica se j existe saldo no dia da nova data:*/
        SELECT CODPLAN,DATASL,SALDOSL FROM FNSALDOLANCA WHERE CODPLAN=new.CODPLAN
               AND DATASL=new.DATASUBLANCA AND CODEMP=new.CODEMPPN AND CODFILIAL=:IFILIALSALDO
               INTO :sCodplan,:dDataSl,:dSaldoSl;
   /*Se no existir, cria um saldo para o nova data:*/
        IF (sCodplan IS NULL ) THEN
        BEGIN
   /*Pega o ultimo saldo anterior a data do lanamento:*/
           SELECT SALDOSL FROM FNSALDOLANCA SL1 WHERE SL1.CODPLAN=new.CODPLAN and sl1.codemppn=new.codemp and sl1.codfilialpn=:codfilialpn
                  AND SL1.DATASL=(
                                 SELECT MAX(SL2.DATASL) FROM FNSALDOLANCA SL2 WHERE
                                        SL2.CODPLAN=SL1.CODPLAN AND SL2.DATASL<new.DATASUBLANCA
                                        AND SL2.CODEMP=new.CODEMPPN AND SL2.CODFILIAL=:IFILIALSALDO
                                 )
                  AND SL1.CODEMP=new.CODEMPPN AND SL1.CODFILIAL=:IFILIALSALDO INTO :dSaldoAnt;
       /*Cria um saldo para este dia e atualiza saldos possveis que tiverem na frente:*/
           IF (:dSaldoAnt IS NULL) THEN
              dSaldoAnt = 0;
           INSERT INTO FNSALDOLANCA (CODEMP,CODFILIAL,CODPLAN,CODEMPPN,CODFILIALPN,DATASL,SALDOSL)
                  VALUES (new.CODEMP,:IFILIALSALDO,new.CODPLAN,new.CODEMPPN,new.CODFILIALPN,new.DATASUBLANCA,:dSaldoAnt + new.VLRSUBLANCA);
           UPDATE FNSALDOLANCA SET SALDOSL = SALDOSL + new.VLRSUBLANCA
                  WHERE CODPLAN=new.CODPLAN AND DATASL>new.DATASUBLANCA
                  AND CODEMP=new.CODEMP AND CODFILIAL=:IFILIALSALDO;
        END
       /*Caso contrrio s atualiza o saldo:*/
        ELSE
        BEGIN
           UPDATE FNSALDOLANCA SET SALDOSL = SALDOSL + new.VLRSUBLANCA
                  WHERE CODPLAN=new.CODPLAN AND DATASL>=new.DATASUBLANCA
                  AND CODEMP=new.CODEMP AND CODFILIAL=:IFILIALSALDO;
        END
      END
   END
END ^

CREATE TRIGGER FNSUBLANCATGBD FOR FNSUBLANCA 
ACTIVE BEFORE DELETE POSITION 0 
AS
BEGIN
  IF (old.CODSUBLANCA > 0) THEN
    UPDATE FNLANCA SET VLRLANCA = VLRLANCA - (old.VLRSUBLANCA*-1) WHERE
      CODEMP=old.CODEMP AND CODFILIAL=old.CODFILIAL AND
      CODLANCA=old.CODLANCA;
END ^

CREATE TRIGGER FNSUBLANCATGAD FOR FNSUBLANCA 
ACTIVE AFTER DELETE POSITION 0 
AS
DECLARE VARIABLE dDataSl DATE;
DECLARE VARIABLE dSaldoSl NUMERIC(15, 5);
DECLARE VARIABLE sCodplan CHAR(13);
DECLARE VARIABLE dSaldoAnt NUMERIC(15, 5);
DECLARE VARIABLE IFILIALSALDO INTEGER;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(old.CODEMPPN,'FNSALDOLANCA') INTO IFILIALSALDO;
   SELECT CODPLAN,DATASL,SALDOSL FROM FNSALDOLANCA WHERE CODPLAN=old.CODPLAN
          AND DATASL=old.DATASUBLANCA AND CODEMP=old.CODEMP AND CODFILIAL=:IFILIALSALDO
          INTO :sCodplan,:dDataSl,:dSaldoSl;
   IF (:sCodplan IS NULL ) THEN
   BEGIN
      SELECT SALDOSL FROM FNSALDOLANCA SL1 WHERE SL1.CODPLAN=old.CODPLAN
             AND SL1.DATASL=(
                            SELECT MAX(SL2.DATASL) FROM FNSALDOLANCA SL2 WHERE
                                   SL2.CODPLAN=SL1.CODPLAN AND SL2.DATASL<old.DATASUBLANCA
                                   AND SL2.CODEMP=old.CODEMP AND SL2.CODFILIAL=:IFILIALSALDO
                            )
             AND SL1.CODEMP=old.CODEMP AND SL1.CODFILIAL=:IFILIALSALDO INTO :dSaldoAnt;
      IF (:dSaldoAnt IS NULL) THEN
         dSaldoAnt = 0;
      INSERT INTO FNSALDOLANCA (CODEMP,CODFILIAL,CODEMPPN,CODFILIALPN,CODPLAN,DATASL,SALDOSL)
             VALUES (old.CODEMPPN,old.CODFILIALPN,old.CODEMPPN,old.CODFILIALPN,old.CODPLAN,old.DATASUBLANCA,:dSaldoAnt);
      UPDATE FNSALDOLANCA SET SALDOSL = SALDOSL - old.VLRSUBLANCA
             WHERE CODPLAN=old.CODPLAN AND DATASL>old.DATASUBLANCA
             AND CODEMP=old.CODEMP AND CODFILIAL=:IFILIALSALDO;
   END
   ELSE
   BEGIN
      UPDATE FNSALDOLANCA SET SALDOSL = SALDOSL - old.VLRSUBLANCA
             WHERE CODPLAN=old.CODPLAN AND DATASL>=old.DATASUBLANCA
             AND CODEMP=old.CODEMP AND CODFILIAL=:IFILIALSALDO;
   END
END ^

CREATE TRIGGER FNTALAOCHEQTGBU FOR FNTALAOCHEQ 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER FNTBJUROSTGBU FOR FNTBJUROS 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER FNTIPOCOBTGBU FOR FNTIPOCOB 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER FNTIPOCREDTGBU FOR FNTIPOCRED 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER FNTIPORESTRTGBU FOR FNTIPORESTR 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER LFCLFISCALTGBU FOR LFCLFISCAL 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER LFCSOSNTGBU FOR LFCSOSN 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER LFFRETETGAI FOR LFFRETE 
ACTIVE AFTER INSERT POSITION 0 
AS
begin

    -- Atualiza status da expedio ao inserir frete
    if(new.ticketex is not null) then
    begin
        update eqexpedicao ex set ex.status='CE' where ex.codemp=new.codempex and ex.codfilial=new.codfilialex and ex.ticket=new.ticketex;
    end

end ^

CREATE TRIGGER LFFRETETGBU FOR LFFRETE 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  IF (new.EMMANUT IS NULL) THEN
     new.EMMANUT='N';
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
  begin

  	new.DTALT=cast('now' AS DATE);
  	new.IDUSUALT=USER;
  	new.HALT = cast('now' AS TIME);

   	-- Atualizando data do pagamento

  	if(old.codpag is null and new.codpag is not null) then
  	begin

      	select pg.datapag from fnpagar pg  where pg.codemp=new.codemppa and pg.codfilial=new.codfilialpa and pg.codpag=new.codpag
      	into new.dtpagfrete;

  	end
  end

end ^

CREATE TRIGGER LFFRETETGAD FOR LFFRETE 
ACTIVE AFTER DELETE POSITION 0 
AS
begin

    -- Atualiza status da expedio ao excluir frete
    if(old.ticketex is not null) then
    begin
        update eqexpedicao ex set ex.status='RE' where ex.codemp=old.codempex and ex.codfilial=old.codfilialex and ex.ticket=old.ticketex;
    end

end ^

CREATE TRIGGER LFITCLFISCALTGAI FOR LFITCLFISCAL 
ACTIVE AFTER INSERT POSITION 0 
AS
begin
    -- Se esta for a regra geral, desabilita demais regras que estejam como geral.
    if(new.geralfisc='S') then
    begin
       update lfitclfiscal set geralfisc='N'
       where codemp=new.codemp and codfilial=new.codfilial and codfisc=new.codfisc and
             coditfisc!=new.coditfisc and geralfisc='S' and ativoitfisc='S';
    end
end ^

CREATE TRIGGER LFITCLFISCALTGBU FOR LFITCLFISCAL 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
    -- Gerando Log
    new.dtalt=cast('now' as date);
    new.idusualt=user;
    new.halt = cast('now' as time);
end ^

CREATE TRIGGER LFITCLFISCALTGAU FOR LFITCLFISCAL 
ACTIVE AFTER UPDATE POSITION 0 
AS
begin
    -- Se esta for a regra geral, desabilita demais regras que estejam como geral.
    if(new.geralfisc='S') then
    begin
       update lfitclfiscal set geralfisc='N'
       where codemp=new.codemp and codfilial=new.codfilial and codfisc=new.codfisc and
             coditfisc!=new.coditfisc and geralfisc='S';

    end
end ^

CREATE TRIGGER LFITCOMPRATGAI FOR LFITCOMPRA 
ACTIVE AFTER INSERT POSITION 0 
as
    declare variable vlrbasepis numeric(15, 5);
    declare variable vlrbasecofins numeric(15, 5);
    declare variable vlrpis numeric(15, 5);
    declare variable vlrcofins numeric(15, 5);
    declare variable vlrbaseii numeric(15, 5);
    declare variable vlrii numeric(15, 5);
    declare variable vlricmsdiferido numeric(15, 5);
    declare variable vlricmsdevido numeric(15, 5);
    declare variable vlricmscredpresum numeric(15, 5);

    begin

    -- Inicializao de variveis
    if (new.vlrbasepis is null) then vlrbasepis = 0; else vlrbasepis = new.vlrbasepis;
    if (new.vlrbasecofins is null) then vlrbasecofins = 0; else vlrbasecofins = new.vlrbasepis;
    if (new.vlrpis is null) then vlrpis = 0; else vlrpis = new.vlrpis;
    if (new.vlrcofins is null) then vlrcofins = 0; else vlrcofins = new.vlrcofins;
    if (new.vlrbaseii is null) then vlrbaseii = 0; else vlrbaseii = new.vlrbaseii;
    if (new.vlrii is null) then vlrii = 0; else vlrii = new.vlrii;
    if (new.vlricmsdiferido is null) then vlricmsdiferido = 0; else vlricmsdiferido = new.vlricmsdiferido;
    if (new.vlricmsdevido is null) then vlricmsdevido = 0; else vlricmsdevido = new.vlricmsdevido;
    if (new.vlricmscredpresum is null) then vlricmscredpresum = 0; else vlricmscredpresum = new.vlricmscredpresum;

    -- Atualizando campos de totais na tabela de compra;
    update cpcompra cp set
        cp.vlrbasepiscompra = cp.vlrbasepiscompra + :vlrbasepis ,
        cp.vlrpiscompra =  cp.vlrpiscompra + :vlrpis ,
        cp.vlrbasecofinscompra = cp.vlrbasecofinscompra + :vlrbasecofins ,
        cp.vlrcofinscompra =  cp.vlrcofinscompra + :vlrcofins,
        cp.vlrbaseiicompra = cp.vlrbaseiicompra + :vlrbaseii,
        cp.vlriicompra = cp.vlriicompra + :vlrii,
        cp.vlricmsdiferido = cp.vlricmsdiferido + :vlricmsdiferido,
        cp.vlricmsdevido = cp.vlricmsdevido + :vlricmsdevido,
        cp.vlricmscredpresum = cp.vlricmscredpresum + :vlricmscredpresum

    where codcompra=new.codcompra and codemp=new.codemp and codfilial=new.codfilial;

end ^

CREATE TRIGGER LFITCOMPRATGBU FOR LFITCOMPRA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER LFITCOMPRATGAU FOR LFITCOMPRA 
ACTIVE AFTER UPDATE POSITION 0 
as
    declare variable cstatus char (2);
    declare variable nvlrbasepis numeric(15, 5);
    declare variable nvlrbasecofins numeric(15, 5);
    declare variable nvlrpis numeric(15, 5);
    declare variable nvlrcofins numeric(15, 5);

    declare variable ovlrbasepis numeric(15, 5);
    declare variable ovlrbasecofins numeric(15, 5);
    declare variable ovlrpis numeric(15, 5);
    declare variable ovlrcofins numeric(15, 5);

    declare variable ovlrbaseii numeric(15, 5);
    declare variable ovlrii numeric(15, 5);

    declare variable vlricmsdiferido numeric(15, 5);
    declare variable vlricmsdevido numeric(15, 5);
    declare variable vlricmscredpresum numeric(15, 5);

begin
    -- Inicializao de variveis (new)
    if (new.vlrbasepis is null) then nvlrbasepis = 0; else nvlrbasepis = new.vlrbasepis;
    if (new.vlrbasecofins is null) then nvlrbasecofins = 0; else nvlrbasecofins = new.vlrbasepis;
    if (new.vlrpis is null) then nvlrpis = 0; else nvlrpis = new.vlrpis;
    if (new.vlrcofins is null) then nvlrcofins = 0; else nvlrcofins = new.vlrcofins;

    -- Inicializao de variveis (old)
    if (old.vlrbasepis is null) then ovlrbasepis = 0; else ovlrbasepis = old.vlrbasepis;
    if (old.vlrbasecofins is null) then ovlrbasecofins = 0; else ovlrbasecofins = old.vlrbasepis;
    if (old.vlrpis is null) then ovlrpis = 0; else ovlrpis = old.vlrpis;
    if (old.vlrcofins is null) then ovlrcofins = 0; else ovlrcofins = old.vlrcofins;
    if (old.vlrbaseii is null) then ovlrbaseii = 0; else ovlrbaseii = old.vlrbaseii;
    if (old.vlrii is null) then ovlrii = 0; else ovlrii = old.vlrii;

    if (old.vlricmsdiferido is null) then vlricmsdiferido = 0; else vlricmsdiferido = old.vlricmsdiferido;
    if (old.vlricmsdevido is null) then vlricmsdevido = 0; else vlricmsdevido = old.vlricmsdevido;
    if (old.vlricmscredpresum is null) then vlricmscredpresum = 0; else vlricmscredpresum = old.vlricmscredpresum;


    if ( not ( (new.emmanut='S') or ( (old.emmanut='S') and (old.emmanut is not null) ) ) ) then
    begin
        select cp.statuscompra from cpcompra cp
        where cp.codcompra = new.codcompra and cp.codemp=new.codemp and cp.codfilial = new.codfilial
        into :cstatus;

        if (substr(:cstatus,1,1) not in ('X','N') ) then
        begin
            update cpcompra cp set
            cp.vlrbasepiscompra = cp.vlrbasepiscompra - :ovlrbasepis + :nvlrbasepis,
            cp.vlrpiscompra = vlrpiscompra - :ovlrpis + :nvlrpis,
            cp.vlrbasecofinscompra = vlrbasecofinscompra - :ovlrbasecofins + :nvlrbasecofins,
            cp.vlrcofinscompra= vlrcofinscompra - :ovlrcofins + :nvlrcofins,
            cp.vlrbaseiicompra= vlrbaseiicompra - :ovlrbaseii + new.vlrbaseii,
            cp.vlriicompra= vlriicompra - :ovlrii + new.vlrii,
            cp.vlricmsdiferido= vlricmsdiferido - :vlricmsdiferido + new.vlricmsdiferido,
            cp.vlricmsdevido= vlricmsdevido - :vlricmsdevido + new.vlricmsdevido,
            cp.vlricmscredpresum = vlricmscredpresum - :vlricmscredpresum + new.vlricmscredpresum
            where codcompra=new.codcompra and codemp=new.codemp and codfilial=new.codfilial;
        end
    end
end ^

CREATE TRIGGER LFITCOMPRATGAD FOR LFITCOMPRA 
ACTIVE AFTER DELETE POSITION 0 
AS

    declare variable ovlrbasepis numeric(15, 5);
    declare variable ovlrbasecofins numeric(15, 5);
    declare variable ovlrpis numeric(15, 5);
    declare variable ovlrcofins numeric(15, 5);
    declare variable vlricmsdiferido numeric(15, 5);
    declare variable vlricmsdevido numeric(15, 5);
    declare variable vlricmscredpresum numeric(15, 5);

begin
    -- Inicializao de variveis (old)
    if (old.vlrbasepis is null) then ovlrbasepis = 0; else ovlrbasepis = old.vlrbasepis;
    if (old.vlrbasecofins is null) then ovlrbasecofins = 0; else ovlrbasecofins = old.vlrbasepis;
    if (old.vlrpis is null) then ovlrpis = 0; else ovlrpis = old.vlrpis;
    if (old.vlrcofins is null) then ovlrcofins = 0; else ovlrcofins = old.vlrcofins;
    if (old.vlricmsdiferido is null) then vlricmsdiferido = 0; else vlricmsdiferido = old.vlricmsdiferido;
    if (old.vlricmsdevido is null) then vlricmsdevido = 0; else vlricmsdevido = old.vlricmsdevido;
    if (old.vlricmscredpresum is null) then vlricmscredpresum = 0; else vlricmscredpresum = old.vlricmscredpresum;

    update cpcompra cp set
        cp.vlrbasepiscompra = cp.vlrbasepiscompra - :ovlrbasepis,
        cp.vlrpiscompra = cp.vlrpiscompra - :ovlrpis,
        cp.vlrbasecofinscompra = cp.vlrbasecofinscompra - :ovlrbasecofins ,
        cp.vlrcofinscompra = cp.vlrcofinscompra - :ovlrcofins,
        cp.vlrbaseiicompra = cp.vlrbaseiicompra - old.vlrbaseii,
        cp.vlriicompra = cp.vlriicompra - old.vlrii,
        cp.vlricmsdiferido = cp.vlricmsdiferido - :vlricmsdiferido,
        cp.vlricmsdevido = cp.vlricmsdevido - :vlricmsdevido,
        cp.vlricmscredpresum = cp.vlricmscredpresum - :vlricmscredpresum
    where codcompra=old.codcompra and codemp=old.codemp and codfilial=old.codfilial;

end ^

CREATE TRIGGER LFITNATOPERTGBU FOR LFITNATOPER 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER LFITREGRAFISCALTGBU FOR LFITREGRAFISCAL 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER LFITVENDATGAI FOR LFITVENDA 
ACTIVE AFTER INSERT POSITION 0 
as
    declare variable vlrbasepis numeric(15, 5);
    declare variable vlrbasecofins numeric(15, 5);
    declare variable vlrpis numeric(15, 5);
    declare variable vlrcofins numeric(15, 5);

    begin

    -- Inicializao de variveis
    if (new.vlrbasepis is null) then vlrbasepis = 0; else vlrbasepis = new.vlrbasepis;
    if (new.vlrbasecofins is null) then vlrbasecofins = 0; else vlrbasecofins = new.vlrbasepis;
    if (new.vlrpis is null) then vlrpis = 0; else vlrpis = new.vlrpis;
    if (new.vlrcofins is null) then vlrcofins = 0; else vlrcofins = new.vlrcofins;

    -- Atualizando campos de totais na tabela de venda;
    update vdvenda vd set
        vd.vlrbasepisvenda = vd.vlrbasepisvenda + :vlrbasepis ,
        vd.vlrpisvenda =  vd.vlrpisvenda + :vlrpis ,
        vd.vlrbasecofinsvenda = vd.vlrbasecofinsvenda + :vlrbasecofins ,
        vd.vlrcofinsvenda =  vd.vlrcofinsvenda + :vlrcofins
    where codvenda=new.codvenda and tipovenda=new.tipovenda and codemp=new.codemp and codfilial=new.codfilial;

end ^

CREATE TRIGGER LFITVENDATGBU FOR LFITVENDA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER LFITVENDATGAU FOR LFITVENDA 
ACTIVE AFTER UPDATE POSITION 0 
as
    declare variable cstatus char (2);
    declare variable nvlrbasepis numeric(15, 5);
    declare variable nvlrbasecofins numeric(15, 5);
    declare variable nvlrpis numeric(15, 5);
    declare variable nvlrcofins numeric(15, 5);

    declare variable ovlrbasepis numeric(15, 5);
    declare variable ovlrbasecofins numeric(15, 5);
    declare variable ovlrpis numeric(15, 5);
    declare variable ovlrcofins numeric(15, 5);

begin
    -- Inicializao de variveis (new)
    if (new.vlrbasepis is null) then nvlrbasepis = 0; else nvlrbasepis = new.vlrbasepis;
    if (new.vlrbasecofins is null) then nvlrbasecofins = 0; else nvlrbasecofins = new.vlrbasepis;
    if (new.vlrpis is null) then nvlrpis = 0; else nvlrpis = new.vlrpis;
    if (new.vlrcofins is null) then nvlrcofins = 0; else nvlrcofins = new.vlrcofins;

    -- Inicializao de variveis (old)
    if (old.vlrbasepis is null) then ovlrbasepis = 0; else ovlrbasepis = old.vlrbasepis;
    if (old.vlrbasecofins is null) then ovlrbasecofins = 0; else ovlrbasecofins = old.vlrbasepis;
    if (old.vlrpis is null) then ovlrpis = 0; else ovlrpis = old.vlrpis;
    if (old.vlrcofins is null) then ovlrcofins = 0; else ovlrcofins = old.vlrcofins;

    if ( not ( (new.emmanut='S') or ( (old.emmanut='S') and (old.emmanut is not null) ) ) ) then
    begin
        select vd.statusvenda from vdvenda vd
        where vd.codvenda = new.codvenda and VD.tipovenda = new.tipovenda
        and vd.codemp=new.codemp and vd.codfilial = new.codfilial
        into :cstatus;

        if (substr(:cstatus,1,1) not in ('C','N')) then
        begin
            update vdvenda vd set
            vd.vlrbasepisvenda = vd.vlrbasepisvenda - :ovlrbasepis + :nvlrbasepis,
            vd.vlrpisvenda = vlrpisvenda - :ovlrpis + :nvlrpis,
            vd.vlrbasecofinsvenda = vlrbasecofinsvenda - :ovlrbasecofins + :nvlrbasecofins,
            vd.vlrcofinsvenda= vlrcofinsvenda - :ovlrcofins + :nvlrcofins
            where codvenda=new.codvenda and tipovenda=new.tipovenda and codemp=new.codemp and codfilial=new.codfilial;
        end
    end

end ^

CREATE TRIGGER LFITVENDATGAD FOR LFITVENDA 
ACTIVE AFTER DELETE POSITION 0 
AS

    declare variable ovlrbasepis numeric(15, 5);
    declare variable ovlrbasecofins numeric(15, 5);
    declare variable ovlrpis numeric(15, 5);
    declare variable ovlrcofins numeric(15, 5);

begin
    -- Inicializao de variveis (old)
    if (old.vlrbasepis is null) then ovlrbasepis = 0; else ovlrbasepis = old.vlrbasepis;
    if (old.vlrbasecofins is null) then ovlrbasecofins = 0; else ovlrbasecofins = old.vlrbasepis;
    if (old.vlrpis is null) then ovlrpis = 0; else ovlrpis = old.vlrpis;
    if (old.vlrcofins is null) then ovlrcofins = 0; else ovlrcofins = old.vlrcofins;

    update vdvenda vd set
        vd.vlrbasepisvenda = vd.vlrbasepisvenda - :ovlrbasepis,
        vd.vlrpisvenda = vd.vlrpisvenda - :ovlrpis,
        vd.vlrbasecofinsvenda = vd.vlrbasecofinsvenda - :ovlrbasecofins ,
        vd.vlrcofinsvenda = vd.vlrcofinsvenda - :ovlrcofins
    where codvenda=old.codvenda and tipovenda=old.tipovenda and codemp=old.codemp and codfilial=old.codfilial;

end ^

CREATE TRIGGER LFLIVROFISCALTGBU FOR LFLIVROFISCAL 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER LFMENSAGEMTGBU FOR LFMENSAGEM 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER LFMODDOCFISCTGBU FOR LFMODDOCFISC 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER LFMODNOTATGBU FOR LFMODNOTA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER LFNATOPERTGBU FOR LFNATOPER 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER LFNBMTGBU001 FOR LFNBM 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.dtalt=cast('now' as date);
  new.idusualt=user;
  new.halt = cast('now' as time);
end ^

CREATE TRIGGER LFNCMTGBU001 FOR LFNCM 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.dtalt=cast('now' as date);
  new.idusualt=user;
  new.halt = cast('now' as time);
end ^

CREATE TRIGGER LFNCMNBMTGBU001 FOR LFNCMNBM 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.dtalt=cast('now' as date);
  new.idusualt=user;
  new.halt = cast('now' as time);
end ^

CREATE TRIGGER LFREGRAFISCALTGBU FOR LFREGRAFISCAL 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER LFSEQSERIETGBU FOR LFSEQSERIE 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER LFSERIETGBI FOR LFSERIE 
ACTIVE BEFORE INSERT POSITION 0 
AS
begin
   if (new.DOCSERIE IS NULL) then
      new.DOCSERIE = 1;
end ^

CREATE TRIGGER LFSERIETGBU FOR LFSERIE 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER LFSERVICOTGBU FOR LFSERVICO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER LFSITTRIBTGBU FOR LFSITTRIB 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER LFTABICMSTGBU FOR LFTABICMS 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER LFTIPOFISCCLITGBU FOR LFTIPOFISCCLI 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER LFTRATTRIBTGBU FOR LFTRATTRIB 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER PEBATIDATGBU FOR PEBATIDA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER PEBATIDATGAD FOR PEBATIDA 
ACTIVE AFTER DELETE POSITION 0 
as
   declare variable seqlog smallint;
begin

   select max(seqlog) from pebatidalog bl
     where bl.codemp=old.codemp and bl.codfilial=old.codfilial and 
       bl.dtbat=old.dtbat and bl.hbat=old.hbat and 
       bl.codempep=old.codempep and bl.codfilialep=old.codfilialep and bl.matempr=old.matempr
    into :seqlog;
   if (:seqlog is null) then
   begin
     seqlog = 0;
   end
   seqlog = seqlog + 1;
   insert into pebatidalog (codemp, codfilial, dtbat, hbat,
        codempep, codfilialep, matempr, seqlog,
        tipobat, dtins, hins, idusuins, 
        dtalt, halt, idusualt)
      values (old.codemp, old.codfilial, old.dtbat, old.hbat,
        old.codempep, old.codfilialep, old.matempr, :seqlog,
        old.tipobat, old.dtins, old.hins, old.idusuins, 
        old.dtalt, old.halt, old.idusualt);
   
end ^

CREATE TRIGGER PEFALTATGBU FOR PEFALTA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER PEFALTATGAD FOR PEFALTA 
ACTIVE AFTER DELETE POSITION 0 
AS
  declare variable codfilialat integer;
  declare variable codfilialp3 integer;
begin
  select icodfilial from sgretfilial(old.codemp, 'ATATENDIMENTO')
    into :codfilialat;
  select icodfilial from sgretfilial(old.codemp, 'SGPREFERE3')
    into :codfilialp3;
  delete from atatendimento a
    where a.codemp=old.codemp and a.codfilial=:codfilialat and
    a.dataatendo=old.dtfalta and
    exists( select * from atatendente ae, sgprefere3 p3
      left outer join atmodatendo mfi on
        mfi.codemp=p3.codempfi and mfi.codfilial=p3.codfilialfi and mfi.codmodel=p3.codmodelfi
      left outer join atmodatendo mfj on
        mfj.codemp=p3.codempfj and mfj.codfilial=p3.codfilialfj and mfj.codmodel=p3.codmodelfj
      where ae.codempep=old.codempep and ae.codfilialep=old.codfilialep and ae.matempr=old.matempr and
      ae.codemp=a.codempae and ae.codfilial=a.codfilialae and ae.codatend=a.codatend and
      p3.codemp=old.codemp and p3.codfilial=:codfilialp3 and
      ( ( mfi.codempea=a.codempea and mfi.codfilialea=a.codfilialea and mfi.codespec=a.codespec ) or
        ( mfj.codempea=a.codempea and mfj.codfilialea=a.codfilialea and mfj.codespec=a.codespec )
      )
    ) and
    ( ( extract(hour from a.horaatendo)=extract(hour from old.hinifalta) and
        extract(minute from a.horaatendo)=extract(minute from old.hinifalta) ) or
      ( extract(hour from a.horaatendo)=extract(hour from old.hfinintfalta) and
        extract(minute from a.horaatendo)=extract(minute from old.hfinintfalta) )
    ) ;

end ^

CREATE TRIGGER PPDISTRIBTGBU FOR PPDISTRIB 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER PPESTRUANALISETGBU FOR PPESTRUANALISE 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER PPESTRUFASETGBU FOR PPESTRUFASE 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER PPESTRUFASETGAD FOR PPESTRUFASE 
ACTIVE AFTER DELETE POSITION 0 
AS
declare variable iSeqEf smallint;
begin
  IF(old.finalizaop = 'S') then
  begin
    for select max(seqef) from ppestrufase ef where ef.codemp=old.codemp and
        ef.codfilial=old.codfilial and ef.codprod = old.codprod and
        ef.seqest = old.seqest into :iSeqEf do
        begin
            update ppestrutura et set et.ativoest='N' where et.codemp=old.codemp and
                et.codfilial = old.codfilial and et.codprod=old.codprod and
                et.seqest = old.seqest;
        end
  end
end ^

CREATE TRIGGER PPESTRUFASETGBIBU FOR PPESTRUFASE 
ACTIVE BEFORE INSERT OR UPDATE POSITION 1 
AS
declare variable iFinaliza smallint;
begin
  if (NEW.finalizaop='S') then
  BEGIN
    SELECT COUNT(1) FROM PPESTRUFASE EF
        WHERE EF.CODEMP=NEW.CODEMP AND EF.CODFILIAL=NEW.CODFILIAL AND
              EF.CODPROD = NEW.codprod AND
              EF.SEQEST = NEW.SEQEST AND EF.FINALIZAOP='S' into :iFinaliza;
        if(:iFinaliza>0) then
        begin
           exception ppestrufase01;
        end
  END
end ^

CREATE TRIGGER PPESTRUTURATGBI FOR PPESTRUTURA 
ACTIVE BEFORE INSERT POSITION 0 
as
begin

    -- Acertando referncia quando nula
    if (new.refprod is null) then
    begin
        -- Buscando referncia do produto
        select p.refprod from eqproduto p
        where p.codemp=new.codemp and p.codfilial = new.codfilial and p.codprod=new.codprod
        into new.refprod;
    end
end ^

CREATE TRIGGER PPESTRUTURATGAI FOR PPESTRUTURA 
ACTIVE AFTER INSERT POSITION 0 
AS
    declare variable iFinaliza smallint;
begin
     IF(NEW.ativoest='S') THEN
      BEGIN
        select count(1) from ppestrufase ef
            where ef.codemp=new.codemp and ef.codfilial=new.codfilial and
            ef.codprod=new.codprod and ef.seqest=new.seqest and ef.finalizaop='S'
            into :iFinaliza;
        if ((:iFinaliza is null) or (:iFinaliza<1) ) then
        begin
          exception ppestruturaex01;
        end
      END
end ^

CREATE TRIGGER PPESTRUTURATGBU FOR PPESTRUTURA 
ACTIVE BEFORE UPDATE POSITION 0 
as
declare variable iFinaliza smallint;
begin
  IF (new.EMMANUT IS NULL) THEN
     new.EMMANUT='N';
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
  BEGIN
      if (new.REFPROD IS NULL) then
         SELECT REFPROD FROM EQPRODUTO WHERE CODPROD=new.CODPROD
             AND CODEMP=new.CODEMP AND CODFILIAL = new.CODFILIAL INTO new.REFPROD;
      IF(NEW.ativoest='S' AND NEW.ativoest!=OLD.ativoest) THEN
      BEGIN
        select count(1) from ppestrufase ef
            where ef.codemp=new.codemp and ef.codfilial=new.codfilial and
            ef.codprod=new.codprod and ef.seqest=new.seqest and ef.finalizaop='S'
            into :iFinaliza;
        if ((:iFinaliza is null) or (:iFinaliza<1) ) then
        begin
          exception ppestruturaex01;
        end
      END
 END

end ^

CREATE TRIGGER PPESTRUTURATGAU FOR PPESTRUTURA 
ACTIVE AFTER UPDATE POSITION 0 
AS
declare variable iCount smallint;
declare variable sCertfsc char;
begin
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
  BEGIN
        --verifica se estruta est em fase de ativao
      IF(NEW.ativoest='S' AND OLD.ativoest='N') THEN
      BEGIN
         --busca na tabela de produtos se produto  certificado FSC
         select pd.certfsc from eqproduto pd
            where pd.codemp=new.codemp and pd.codfilial=new.codfilial and pd.codprod=new.codprod
            into :sCertfsc;
    
         --Se produto  certificado, e no possui nenhum subproduto cadastrado lana uma exceo.
         IF(:sCertfsc='S') then
         BEGIN
            select count(1) from PPITESTRUTURASUBPROD es
               where es.codemp= new.codemp and es.codfilial=new.codfilial and es.codprod= new.codprod  and es.seqest = new.seqest
               into :iCount;
            IF ((:iCount is null) or (:iCount<1) ) THEN
            BEGIN
               exception ppestruturaex02;
            END
         END
      END
 END
end ^

CREATE TRIGGER PPFASETGBU FOR PPFASE 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER PPFOTOMTANTGBU FOR PPFOTOMTAN 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER PPITESTRUTURATGBI FOR PPITESTRUTURA 
ACTIVE BEFORE INSERT POSITION 0 
as
begin
  new.DTINS=cast('now' AS DATE);
  new.idusuins=USER;
  new.hins = cast('now' AS TIME);
  if (new.REFPROD IS NULL) then
    SELECT REFPROD FROM EQPRODUTO WHERE CODPROD=new.CODPROD
         AND CODEMP=new.CODEMP AND CODFILIAL = new.CODFILIAL INTO new.REFPROD;
end ^

CREATE TRIGGER PPITESTRUTURATGBU FOR PPITESTRUTURA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  IF (new.EMMANUT IS NULL) THEN
     new.EMMANUT='N';
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
  BEGIN
      if (new.REFPROD IS NULL) then
        SELECT REFPROD FROM EQPRODUTO WHERE CODPROD=new.CODPROD
         AND CODEMP=new.CODEMP AND CODFILIAL = new.CODFILIAL INTO new.REFPROD;
  END
end ^

CREATE TRIGGER PPITESTRUTURASUBPRODTGBI FOR PPITESTRUTURASUBPROD 
ACTIVE BEFORE INSERT POSITION 0 
as
begin
  new.DTINS=cast('now' AS DATE);
  new.idusuins=USER;
  new.hins = cast('now' AS TIME);
  if (new.REFPROD IS NULL) then
    SELECT REFPROD FROM EQPRODUTO WHERE CODPROD=new.CODPROD
         AND CODEMP=new.CODEMP AND CODFILIAL = new.CODFILIAL INTO new.REFPROD;
end ^

CREATE TRIGGER PPITESTRUTURASUBPRODTGBU FOR PPITESTRUTURASUBPROD 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  IF (new.EMMANUT IS NULL) THEN
     new.EMMANUT='N';
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
  BEGIN
    if (new.REFPROD IS NULL) then
      SELECT REFPROD FROM EQPRODUTO WHERE CODPROD=new.CODPROD
         AND CODEMP=new.CODEMP AND CODFILIAL = new.CODFILIAL INTO new.REFPROD;
  END
end ^

CREATE TRIGGER PPITOPTGBI FOR PPITOP 
ACTIVE BEFORE INSERT POSITION 0 
AS
begin
   SELECT REFPROD FROM EQPRODUTO WHERE CODEMP=new.CODEMPPD AND
    CODFILIAL=new.CODFILIALPD AND CODPROD=new.CODPROD INTO new.REFPROD;
end ^

CREATE TRIGGER PPITOPTGBI02 FOR PPITOP 
ACTIVE BEFORE INSERT POSITION 0 
AS
   DECLARE VARIABLE CSALDO CHAR(1);
BEGIN
   IF (new.SEQOP=0) THEN
     CSALDO = 'S';
   ELSE
   BEGIN
     FOR SELECT OP.CODEMPLE, OP.CODFILIALLE, OP.CODLOTE
        FROM PPOP OP, PPOP OD
        WHERE
          OD.CODEMP=new.CODEMP AND OD.CODFILIAL=new.CODFILIAL AND
          OD.CODOP=new.CODOP AND OD.SEQOP=new.SEQOP AND
          OP.CODEMP=OD.CODEMPOPM AND OP.CODFILIAL=OD.CODFILIALOPM AND
          OP.CODOP=OD.CODOPM AND OP.SEQOP=OD.SEQOPM AND
          OP.CODEMPPD=new.CODEMPPD AND OP.CODFILIALPD=new.CODFILIALPD AND OP.CODPROD=new.CODPROD
        INTO new.CODEMPLE, new.CODFILIALLE, new.CODLOTE DO
        BEGIN
          CSALDO='N';
        END
   END
   IF (((CSALDO='S') OR (CSALDO IS NULL)) AND (new.CODLOTE IS NULL)) THEN
   BEGIN
     SELECT FIRST 1 L.CODEMP, L.CODFILIAL, L.CODLOTE
        FROM EQLOTE L
        WHERE L.CODPROD=NEW.codprod AND L.CODFILIAL=NEW.codfilialpd AND L.SLDLIQLOTE>0
        AND L.CODEMP=NEW.codemppd  AND L.VENCTOLOTE>=cast('today' as date)
        ORDER BY L.VENCTOLOTE, L.CODLOTE
        INTO new.CODEMPLE, new.CODFILIALLE, new.CODLOTE;
   END
END ^

CREATE TRIGGER PPITOPTGBU FOR PPITOP 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
    -- Verifica se tabela est em manuteno // caso no esteja inicia procedimentos
    if ( new.emmanut is null) then
        new.emmanut='N';

    if ( not ( (new.emmanut='S') or ( (old.emmanut='S') and (old.emmanut is not null) )) ) then
    begin

      new.DTALT=cast('now' AS DATE);
      new.IDUSUALT=USER;
      new.HALT = cast('now' AS TIME);
      SELECT REFPROD FROM EQPRODUTO WHERE CODEMP=new.CODEMPPD AND
        CODFILIAL=new.CODFILIALPD AND CODPROD=new.CODPROD INTO new.REFPROD;
    end
    
end ^

CREATE TRIGGER PPITOPTGAU FOR PPITOP 
ACTIVE AFTER UPDATE POSITION 0 
as
declare variable codemprma integer;
declare variable codfilialrma smallint;
declare variable codrma integer;
declare variable coditrma smallint;
declare variable sititrma char(2);
declare variable qtditrma numeric(15,5);
declare variable qtdaprovitrma numeric(15,5);
declare variable qtdexpitrma numeric(15,5);

begin
    if ( not ( (new.emmanut='S') or ( (old.emmanut='S') and (old.emmanut is not null) )) ) then
    begin

        if(new.qtdcopiaitop is not null) then
        begin
            if( (new.qtdcopiaitop>0) and (old.qtdcopiaitop is null) ) then
            begin
                insert into ppitop (codemp,codfilial,codop,seqop,seqitop,
                                    codemppd, codfilialpd,codprod,refprod,
                                    qtditop, codempfs,codfilialfs, codfase,
                                    codemple,codfilialle,codlote,gerarma,SEQITOPCP)
                                    values
                                    (new.codemp,new.codfilial,new.codop,new.seqop,
                                    (select (max(op.seqitop)+1) from ppitop op
                                    where op.codemp=new.codemp and op.codfilial=new.codfilial
                                    and op.codop=new.codop and op.seqop=new.seqop),
                                    new.codemppd,new.codfilialpd,new.codprod,new.refprod,
                                    new.qtdcopiaitop,new.codempfs,new.codfilialfs,new.codfase,
                                    new.codemple, new.codfilialle,new.codloterat,new.gerarma,new.seqitop);
            end
        end
        -- Atualizando as requisies de material, caso as quantidades na OP sejam alteradas
        if(old.qtditop <> new.qtditop) then
        begin
            -- Buscando RMA Gerada para o produto de entrada
            select first 1 ir.codemp, ir.codfilial, ir.codrma, ir.coditrma, ir.sititrma,
            ir.qtditrma, ir.qtdaprovitrma, ir.qtdexpitrma
            from eqrma rm, eqitrma ir
            where rm.codemp=ir.codemp and rm.codfilial=ir.codfilial and rm.codrma=ir.codrma
            and ir.codemppd=new.codemppd and ir.codfilialpd=new.codfilialpd and ir.codprod=new.codprod
            and rm.codop=new.codop and rm.seqop=new.seqop
            into codemprma, codfilialrma, codrma, coditrma, sititrma, qtditrma, qtdaprovitrma, qtdexpitrma ;
    
            -- Atualizando item de rma
            if(sititrma='PE') then
            begin
                update eqitrma ir set ir.qtditrma=new.qtditop
                where ir.codemp=:codemprma and ir.codfilial=:codfilialrma and ir.codrma=:codrma
                and ir.coditrma=:coditrma;
            end
            else if (sititrma = 'AF' and :qtditrma=:qtdaprovitrma) then
            begin
                update eqitrma ir set ir.qtditrma=new.qtditop,ir.qtdaprovitrma=new.qtditop
                where ir.codemp=:codemprma and ir.codfilial=:codfilialrma and ir.codrma=:codrma
                and ir.coditrma=:coditrma;
            end
            else if(sititrma = 'EF' and :qtditrma=:qtdexpitrma) then
            begin
                update eqitrma ir set ir.qtditrma=new.qtditop,ir.qtdaprovitrma=new.qtditop,ir.qtdexpitrma=new.qtditop
                where ir.codemp=:codemprma and ir.codfilial=:codfilialrma and ir.codrma=:codrma
                and ir.coditrma=:coditrma;
            end
        end
    end
end ^

CREATE TRIGGER PPITRETCPTGBU FOR PPITRETCP 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER PPMETODOANALISETGBU FOR PPMETODOANALISE 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER PPOPTGBI FOR PPOP 
ACTIVE BEFORE INSERT POSITION 0 
as
begin
   SELECT REFPROD FROM EQPRODUTO WHERE CODEMP=new.CODEMP AND
    CODFILIAL=new.CODFILIAL AND CODPROD=new.CODPROD INTO new.REFPROD;
end ^

CREATE TRIGGER PPOPTGAI FOR PPOP 
ACTIVE AFTER INSERT POSITION 0 
as
declare variable preco numeric;
declare variable qtdest numeric;
declare variable prodetapas char(1);
begin

   EXECUTE PROCEDURE PPITOPSP01(new.CODEMP, new.CODFILIAL, new.CODOP, new.SEQOP);

   EXECUTE PROCEDURE ppgeraopcq (new.CODEMP, new.CODFILIAL, new.CODOP, new.SEQOP);

   select sum(pd.custompmprod) from ppitop it, eqproduto pd where it.codemp=new.codemp and
   it.codfilial=it.codfilial and it.codop=new.codop and it.seqop=new.seqop and
   pd.codemp=it.codemppd and pd.codfilial=it.codfilialpd and
   pd.codprod=it.codprod into :preco;

   select pe.qtdest from ppestrutura pe
      where pe.codemp=new.codemppd and pe.codfilial=new.codfilialpd and
      pe.codprod=new.codprod and pe.seqest=new.seqest into :qtdest;

   -- Buscando preferncias de produo

   select coalesce(p5.prodetapas,'N') from sgprefere5 p5 where p5.codemp=new.codemp and p5.codfilial=new.codfilial
   into :prodetapas;

   -- Se o processo de finalizao no for em etapas deve gerar movimentao de estoque vinculada diretamente a O.P.
   if( :prodetapas = 'N' or :prodetapas is null ) then
   begin

       EXECUTE PROCEDURE EQMOVPRODIUDSP('I',new.CODEMPPD, new.CODFILIALPD, new.CODPROD,
            new.CODEMPLE, new.CODFILIALLE, new.codlote, new.codemptm,
            new.codfilialtm, new.codtipomov, null, null, null ,null, null,
            null, null, null, null, null, null,
            null, null, null, null, null,new.codemp, new.codfilial,new.codop, new.seqop, null,
            null, null,  null, new.dtfabrop, new.codop,
            'N',new.qtdfinalprodop,cast(:preco as numeric(15,5)),
            new.codempax, new.codfilialax, new.codalmox, null, 'S', 'N' );

       if (new.CODOPM is not null) then
          EXECUTE PROCEDURE PPATUDISTOPSP(new.CODEMPOPM, new.CODFILIALOPM, new.CODOPM,
            new.SEQOPM, 0, new.QTDDISTIOP);

   end

end ^

CREATE TRIGGER PPOPTGBU FOR PPOP 
ACTIVE BEFORE UPDATE POSITION 0 
as
declare variable prodetapas char(1);
begin

    -- Verifica se tabela est em manuteno // caso no esteja inicia procedimentos
    if ( new.emmanut is null) then
        new.emmanut='N';

    if ( not ( (new.emmanut='S') or ( (old.emmanut='S') and (old.emmanut is not null) )) ) then
    begin

        new.DTALT=cast('now' AS DATE);
        new.IDUSUALT=USER;
        new.HALT = cast('now' AS TIME);
        SELECT REFPROD FROM EQPRODUTO WHERE CODEMP=new.CODEMP AND
        CODFILIAL=new.CODFILIAL AND CODPROD=new.CODPROD INTO new.REFPROD;
    
        -- Buscando preferncias de produo
        select coalesce(p5.prodetapas,'N') from sgprefere5 p5 where p5.codemp=new.codemp and p5.codfilial=new.codfilial
        into :prodetapas;
    
        if('S'=:prodetapas) then
        begin
    
            if( new.qtdfinalprodop>=new.qtdprevprodop ) then
            begin
                select coalesce(tm.codemptm,tm.codemp),coalesce(tm.codfilialtm,tm.codfilial),coalesce(tm.codtipomovtm,tm.codtipomov)
                from eqtipomov tm, ppop op
                where tm.codemp=op.codemptm and tm.codfilial=op.codfilialtm and tm.codtipomov=op.codtipomov
                and op.codemp=new.codemp and op.codfilial=new.codfilial and op.codop=new.codop
                and op.seqop=new.seqop
                into new.codemptm,new.codfilialtm,new.codtipomov;
                if (new.sitop<>'CA') then 
                	new.sitop='FN';
            end
    
        end
        else
        begin
            if(new.qtdfinalprodop>0 and new.qtdfinalprodop<>old.qtdfinalprodop) then
            begin
                select coalesce(tm.codemptm,tm.codemp),coalesce(tm.codfilialtm,tm.codfilial),coalesce(tm.codtipomovtm,tm.codtipomov)
                from eqtipomov tm, ppop op
                where tm.codemp=op.codemptm and tm.codfilial=op.codfilialtm and tm.codtipomov=op.codtipomov
                and op.codemp=new.codemp and op.codfilial=new.codfilial and op.codop=new.codop
                and op.seqop=new.seqop
                into new.codemptm,new.codfilialtm,new.codtipomov;
                if (new.sitop<>'CA') then 
	                new.sitop='FN';
            end
         end
    
         if(new.sitop='CA' and old.sitop<>'CA') then
         begin
             new.idusucanc=USER;
             new.dtcanc=cast('now' AS DATE);
             new.hcanc = cast('now' AS TIME);
         end
    end

end ^

CREATE TRIGGER PPOPTGAU FOR PPOP 
ACTIVE AFTER UPDATE POSITION 0 
as
declare variable preco decimal(15,5);
declare variable codempoc integer;
declare variable codfilialoc smallint;
declare variable tipoorc char(1);
declare variable codorc integer;
declare variable coditorc smallint;
declare variable prodetapas char(1);
declare variable qtdprodorc decimal(15,5);

begin

    if ( not ( (new.emmanut='S') or ( (old.emmanut='S') and (old.emmanut is not null) )) ) then
    begin

        -- Buscando preferncias de produo
    
        select coalesce(p5.prodetapas,'N') from sgprefere5 p5 where p5.codemp=new.codemp and p5.codfilial=new.codfilial
        into :prodetapas;
    
        /*Cancelamento de O.P */
        
        if(old.sitop!='CA' and new.sitop = 'CA') then
        begin
    
            /* Cancelamento de movimentao de estoque */
    
            -- Se o processo de finalizao no for em etapas deve gerar movimentao de estoque vinculada diretamente a O.P.
            if( :prodetapas = 'N' ) then
            begin
                execute procedure eqmovprodiudsp('D',new.codemppd, new.codfilialpd, new.codprod,
                    new.CODEMPLE, new.CODFILIALLE, new.codlote, new.codemptm,
                    new.codfilialtm, new.codtipomov, null, null, null ,null, null,
                    null, null, null, null, null, null,null, null, null, null, null,
                    new.codemp, new.codfilial,new.codop,new.seqop, null, null, null, null,
                    new.dtfabrop, new.codop, null, new.qtdfinalprodop,:preco,
                    new.codempax, new.codfilialax, new.codalmox, null, 'S', 'N' );
            end
            else
            begin
    
                delete from ppopentrada et where et.codemp=new.codemp and et.codfilial=new.codfilial and et.codop=new.codop and et.seqop=new.seqop;
    
            end
    
            -- Desfazendo vinculos com tem de oramento
            delete from ppopitorc oi where oi.codemp=new.codemp and oi.codfilial=new.codfilial
            and oi.codop=new.codop and oi.seqop=new.seqop;
    
            -- Cancelando as RMAs vinculadas
            update eqrma rma set rma.sitrma='CA', rma.motivocancrma='Ordem de produo original cancelada!'
            where rma.codempof=new.codemp and rma.codfilialof=new.codfilial and rma.codop=new.codop and rma.seqop=new.seqop;
    
            -- Excluindo subproducao
            delete from ppopsubprod where codemp=new.codemp and codfilial=new.codfilial and codop=new.codop and seqop = new.seqop;
    
        end
        else if (old.sitop!='FN' and new.sitop='FN') then
        begin
            -- Atualizando status do tem de oramento na finalizao da OP
            for select oi.codempoc,oi.codfilialoc, oi.tipoorc, oi.codorc, oi.coditorc
            from ppopitorc oi
            where oi.codemp=new.codemp and oi.codfilial=new.codfilial and oi.codop=new.codop and oi.seqop=new.seqop
            into :codempoc, :codfilialoc, :tipoorc, :codorc, :coditorc do
            begin
                update vditorcamento io set io.sitproditorc = 'PD'
                where io.codemp=:codempoc and io.codfilial=:codfilialoc and io.tipoorc=:tipoorc
                and io.codorc=:codorc and io.coditorc=:coditorc;
            end
    
            if( :prodetapas = 'N' ) then
            begin
                -- Buscando custo do produto acabado
               if ( (new.qtdfinalprodop is null) or (new.qtdfinalprodop=0) ) then
               begin
                  preco = 0;
               end
               else
               begin
                   select cast(cast(sum( cast((select cast(ncustompm as decimal(15,5)) 
                   from eqprodutosp01(it.codemppd,it.codfilialpd,it.codprod,null,null,null)) as decimal(15,5)) * it.qtditop ) 
                   as decimal(15,5)) / new.qtdfinalprodop as decimal(15,5))
                       from ppitop it, eqproduto pd
                       where it.codemp=new.codemp and it.codfilial=it.codfilial
                       and it.codop=new.codop and it.seqop=new.seqop
                       and pd.codemp=it.codemppd and pd.codfilial=it.codfilialpd
                       and pd.codprod=it.codprod
                   into :preco;
               end
    
               execute procedure eqmovprodiudsp('U',new.codemppd, new.codfilialpd, new.codprod,
                    new.CODEMPLE, new.CODFILIALLE, new.codlote, new.codemptm,
                    new.codfilialtm, new.codtipomov, null, null, null ,null, null,
                    null, null, null, null, null, null,null, null, null, null, null,
                    new.codemp, new.codfilial,new.codop,new.seqop, null, null, null, null,
                    new.dtfabrop, new.codop, 'N', new.qtdfinalprodop,:preco,
                    new.codempax, new.codfilialax, new.codalmox, null, 'S', 'N' );
    
                -- Buscando quantidade de produto acabado destinado a oramentos;
                select cast(sum(oo.qtdprod) as decimal(15,5)) from ppopitorc oo
                where oo.codemp=new.codemp and oo.codfilial=new.codfilial and oo.codop=new.codop and oo.seqop=new.seqop
                into :qtdprodorc;
    
                -- Atualizando a quantidade final produzida por item de oramento;
    
                if(:qtdprodorc is not null and :qtdprodorc > 0 ) then
                begin
    
                    update ppopitorc oo set oo.qtdfinalproditorc = cast( ( cast(cast(oo.qtdprod as decimal(15,5)) /  cast(:qtdprodorc as decimal(15,5) ) as decimal(15,5)) * (cast(new.qtdfinalprodop as decimal(15,5)))) as decimal(15,5) )
                    where oo.codemp=new.codemp and oo.codfilial=new.codfilial and oo.codop=new.codop and oo.seqop=new.seqop;
    
                end
    
            end
            
            else
            begin    --se for em etapas executar a atualizao dos itens de RMA
                   execute procedure ppitopsp02(new.codemp, new.codfilial, new.codop, new.seqop);
            end
            
        end
    
        /* Outras aes */
    
        else
        begin
            if (old.qtdprevprodop <> new.qtdprevprodop ) then
            begin
                delete from ppitop
                    where codemp=new.codemp AND codfilial=new.codfilial
                        and codop=new.codop and seqop=new.seqop;
    
                delete from PPOPFASE
                    where codemp=new.codemp and codfilial=new.codfilial
                        and codop=new.codop and seqop=new.seqop;
    
                execute procedure ppitopsp01(new.codemp, new.codfilial, new.codop, new.seqop);
            end
    
            if( (old.qtdfinalprodop <> new.qtdfinalprodop) and (new.qtdfinalprodop>0) ) then
            begin
    
                if( :prodetapas = 'N' ) then
                begin
    
                    -- Buscando custo do produto acabado
                    select cast(sum((select ncustompm from eqprodutosp01(it.codemppd,it.codfilialpd,it.codprod,null,null,null)) * it.qtditop ) / new.qtdfinalprodop as decimal(15,5))
    
                    from ppitop it, eqproduto pd
                    where it.codemp=new.codemp and it.codfilial=it.codfilial
                    and it.codop=new.codop and it.seqop=new.seqop
                    and pd.codemp=it.codemppd and pd.codfilial=it.codfilialpd
                    and pd.codprod=it.codprod
                    into :preco;
    
                    execute procedure eqmovprodiudsp('U',new.codemppd, new.codfilialpd, new.codprod,
                    new.CODEMPLE, new.CODFILIALLE, new.codlote, new.codemptm,
                    new.codfilialtm, new.codtipomov, null, null, null ,null, null,
                    null, null, null, null, null, null,null, null, null, null, null,
                    new.codemp, new.codfilial,new.codop,new.seqop, null, null, null, null,
                    new.dtfabrop, new.codop, 'N', new.qtdfinalprodop,:preco,
                    new.codempax, new.codfilialax, new.codalmox, null, 'S', 'N' );
    
                end
    
                execute procedure ppitopsp02(new.codemp, new.codfilial, new.codop, new.seqop);
    
            end
            if (new.CODOPM is not null) then
                execute procedure ppatudistopsp(new.codempopm, new.codfilialopm, new.codopm,
                    new.seqopm, old.qtddistiop, new.qtddistiop);
    
        end
    end
end ^

CREATE TRIGGER PPOPTGAD FOR PPOP 
ACTIVE AFTER DELETE POSITION 0 
AS
declare variable preco decimal;
begin
  select sum(pd.custompmprod) from ppitop it, eqproduto pd where it.codemp=old.codemp and it.codfilial=it.codfilial and
    it.codop=old.codop and it.seqop=old.seqop and
    pd.codemp=it.codemppd and pd.codfilial=it.codfilialpd and pd.codprod=it.codprod into :preco;

   EXECUTE PROCEDURE EQMOVPRODIUDSP('D',old.CODEMPPD, old.CODFILIALPD, old.CODPROD,
        old.CODEMPLE, old.CODFILIALLE, old.codlote, old.codemptm,
        old.codfilialtm, old.codtipomov, null, null, null ,null, null,
        null, null, null, null, null, null,
        null, null, null, null, null, old.codemp, old.codfilial, old.codop, old.seqop, null,
        null, null, null,
        old.dtfabrop, old.codop, 'N', old.qtdfinalprodop,:preco,
        old.codempax, old.codfilialax, old.codalmox, null, 'S', 'N' );

   if (old.CODOPM is not null) then
      EXECUTE PROCEDURE PPATUDISTOPSP(old.CODEMPOPM, old.CODFILIALOPM, old.CODOPM,
        old.SEQOPM, old.QTDDISTIOP, 0);

end ^

CREATE TRIGGER PPOPACAOCORRETTGBU FOR PPOPACAOCORRET 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER PPOPCQTGBU FOR PPOPCQ 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT = cast('now' AS TIME);
  if (new.seqac is not null and new.seqac<>old.seqac) then
  begin
       new.status = 'CO';
  end
end ^

CREATE TRIGGER PPOPENTRADATGAI FOR PPOPENTRADA 
ACTIVE AFTER INSERT POSITION 0 
as
declare variable preco numeric;
declare variable qtdest numeric;
declare variable codemppd integer;
declare variable codfilialpd smallint;
declare variable codprod integer;
declare variable codemple integer;
declare variable codfilialle smallint;
declare variable codlote varchar(20);
declare variable codemptm integer;
declare variable codfilialtm smallint;
declare variable codtipomov integer;
declare variable codempax integer;
declare variable codfilialax smallint;
declare variable codalmox integer;
declare variable codempopm integer;
declare variable codfilialopm smallint;
declare variable codopm integer;
declare variable seqopm smallint;
declare variable qtddistiop decimal(15,5);
declare variable seqest integer;
declare variable prodetapas char(1);

begin

    -- Buscando preferncias de produo

    select coalesce(p5.prodetapas,'N') from sgprefere5 p5 where p5.codemp=new.codemp and p5.codfilial=new.codfilial
    into :prodetapas;

    -- Buscando informaes da OP
    select codemppd, codfilialpd, codprod, codemple, codfilialle, codlote, codemptm, codfilialtm, codtipomov, codempax, codfilialax, codalmox,
    codempopm, codfilialopm, codopm, seqopm, qtddistiop, seqest
    from ppop where codemp=new.codemp and codfilial=new.codfilial and codop=new.codop and seqop=new.seqop
    into
    :codemppd, :codfilialpd, :codprod, :codemple, :codfilialle, :codlote, :codemptm, :codfilialtm, :codtipomov, :codempax, :codfilialax, :codalmox,
    :codempopm, codfilialopm, :codopm, :seqopm, :qtddistiop, :seqest;

    select pe.qtdest from ppestrutura pe
    where pe.codemp=:codemppd and pe.codfilial=:codfilialpd and
    pe.codprod=:codprod and pe.seqest=:seqest into :qtdest;

    if (:codopm is not null) then
    begin
        execute procedure ppatudistopsp( :codempopm, :codfilialopm, :codopm, :seqopm, :qtddistiop, 0);
    end

    -- Se o processo de finalizao for em etapas deve gerar movimentao de estoque vinculada ao item de entrada da O.P.
    if( :prodetapas = 'S' ) then
    begin

        -- Buscando custo do produto acabado
        select sum((select ncustompm from eqprodutosp01(it.codemppd,it.codfilialpd,it.codprod,null,null,null)) * it.qtditop ) / op.qtdprevprodop
        from ppitop it, eqproduto pd, ppop op
        where it.codemp=new.codemp and it.codfilial=it.codfilial
        and it.codop=new.codop and it.seqop=new.seqop
        and pd.codemp=it.codemppd and pd.codfilial=it.codfilialpd
        and pd.codprod=it.codprod
        and op.codemp=new.codemp and op.codfilial=new.codfilial and op.codop=new.codop and op.seqop=new.seqop
        group by op.qtdprevprodop
        into :preco;

        execute procedure EQMOVPRODIUDSP('I', :CODEMPPD, :CODFILIALPD, :CODPROD,
        :CODEMPLE, :CODFILIALLE, :codlote, :codemptm,
        :codfilialtm, :codtipomov, null, null, null ,null, null,
        null, null, null, null, null, null,
        null, null, null, null, null,new.codemp, new.codfilial,new.codop, new.seqop, new.seqent,
        null, null,  null, new.dtent, new.codop,
        'S',new.qtdent,cast(:preco as numeric(15,5)),
        :codempax, :codfilialax, :codalmox, null, 'S', 'N' );

        -- Atualizando quantidade final produzida na O.P.
        update ppop op set
        op.qtdfinalprodop=( select sum(et.qtdent) from ppopentrada et
                            where et.codemp=new.codemp and et.codfilial=new.codfilial and et.codop=new.codop and et.seqop=new.seqop
                           )
        where op.codemp=new.codemp and op.codfilial=new.codfilial and op.codop=new.codop and op.seqop=new.seqop;

    end

    if (:CODOPM is not null) then EXECUTE PROCEDURE PPATUDISTOPSP(:CODEMPOPM, :CODFILIALOPM, :CODOPM, :SEQOPM, 0, :QTDDISTIOP);

end ^

CREATE TRIGGER PPOPENTRADATGBU FOR PPOPENTRADA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
    new.DTALT=cast('now' AS DATE);
    new.IDUSUALT=USER;
    new.HALT = cast('now' AS TIME);

end ^

CREATE TRIGGER PPOPENTRADATGAD FOR PPOPENTRADA 
ACTIVE AFTER DELETE POSITION 0 
AS
declare variable preco decimal;
declare variable codemppd integer;
declare variable codfilialpd smallint;
declare variable codprod integer;
declare variable codemple integer;
declare variable codfilialle smallint;
declare variable codlote varchar(20);
declare variable codemptm integer;
declare variable codfilialtm smallint;
declare variable codtipomov integer;
declare variable codempax integer;
declare variable codfilialax smallint;
declare variable codalmox integer;
declare variable codempopm integer;
declare variable codfilialopm smallint;
declare variable codopm integer;
declare variable seqopm smallint;
declare variable qtddistiop decimal(15,5);

begin

    -- Buscando custo do produto acabado
    select sum(pd.custompmprod) from ppitop it, eqproduto pd where it.codemp=old.codemp and it.codfilial=it.codfilial and
    it.codop=old.codop and it.seqop=old.seqop and
    pd.codemp=it.codemppd and pd.codfilial=it.codfilialpd and pd.codprod=it.codprod into :preco;

    -- Buscando informaes da OP
    select codemppd, codfilialpd, codprod, codemple, codfilialle, codlote, codemptm, codfilialtm, codtipomov, codempax, codfilialax, codalmox,
    codempopm, codfilialopm, codopm, seqopm, qtddistiop
    from ppop where
    codemp=old.codemp and codfilial=old.codfilial and codop=old.codop and seqop=old.seqop
    into
    :codemppd, :codfilialpd, :codprod, :codemple, :codfilialle, :codlote, :codemptm, :codfilialtm, :codtipomov, :codempax, :codfilialax, :codalmox,
    :codempopm, codfilialopm, :codopm, :seqopm, :qtddistiop;

    execute procedure eqmovprodiudsp('U', :codemppd, :codfilialpd, :codprod,
        :codemple, :codfilialle, :codlote, :codemptm,
        :codfilialtm, :codtipomov, null, null, null ,null, null,
        null, null, null, null, null, null,
        null, null, null, null, null, old.codemp, old.codfilial, old.codop, old.seqop, old.seqent,
        null, null, null,
        old.dtent, old.codop, 'N', 0,:preco,
        :codempax, :codfilialax, :codalmox, null, 'S', 'N' );

   if (:codopm is not null) then
   begin
      execute procedure ppatudistopsp( :codempopm, :codfilialopm, :codopm, :seqopm, :qtddistiop, 0);
   end
end ^

CREATE TRIGGER PPOPFASETGAI FOR PPOPFASE 
ACTIVE AFTER INSERT POSITION 0 
AS
declare variable ctipofase char(2);
declare variable imesesdesccp smallint;
declare variable ddtdescarte date;
declare variable ddtvalidop date;
declare variable icodempest integer;
declare variable icodfilialest smallint;
declare variable icodprodest integer;
declare variable iseqest smallint;
declare variable icodemppd integer;
declare variable icodfilialpd smallint;
declare variable icodprodpd integer;
declare variable icoditretcp smallint;
declare variable iqtd decimal(15,5);
declare variable numretcp integer;

begin
  select tipofase from ppfase where codemp=new.codempfs and codfilial=new.codfilialfs and codfase=new.codfase
      into :ctipofase;

  if(ctipofase='CQ') then
  begin

    select max(sg.mesesdesccp) from sgprefere5 sg where codemp=new.codemp and codfilial=new.codfilial
      into :imesesdesccp;

    select op.codemppd, op.codfilialpd, op.codprod, op.seqest, op.dtvalidpdop
        from ppop op
            where op.codemp = new.codemp and op.codfilial=new.codfilial and op.codop=new.codop
                and op.seqop=new.seqop
        into :icodempest,:icodfilialest,:icodprodest,:iseqest,:ddtvalidop;

    ddtdescarte = cast(addmonth(:ddtvalidop,:imesesdesccp) as date);

   -- Buscando o numero de contra provas (Deve haver apenas 1)
   select count(*) from ppretcp rc where rc.codemp=new.codemp and rc.codfilial=new.codfilial and rc.codop=new.codop and rc.seqop=new.seqop
   into :numretcp;
   
   if(:numretcp is null or :numretcp <1) then
   begin
       insert into ppretcp (codemp,codfilial,codop,seqop,dtdescarte)
       values(new.codemp,new.codfilial, new.codop,new.seqop,:ddtdescarte);


       for select it.codemppd,it.codfilialpd,it.codprodpd,it.seqitest,it.qtditest from ppitestrutura it
           where it.codemp = :icodempest and it.codfilial=:icodfilialest and it.codprod=:icodprodest
               and it.seqest = :iseqest and it.codempfs=new.codempfs and it.codfilialfs=new.codfilialfs
               and it.codfase = new.codfase
       into :icodemppd,:icodfilialpd,:icodprodpd,:icoditretcp,:iqtd do
       begin
           insert into ppitretcp (codemp,codfilial,codop,seqop,coditretcp,codemppd,codfilialpd,codprod,qtditret)
           values(new.codemp,new.codfilial,new.codop,new.seqop, :icoditretcp,:icodemppd,:icodfilialpd,:icodprodpd,:iqtd);
       end

    end
  end

  end ^

CREATE TRIGGER PPOPFASETGBU0 FOR PPOPFASE 
ACTIVE BEFORE UPDATE POSITION 0 
as
declare variable finaliza char(2);
declare variable qtdpe smallint;
declare variable icodemptm int;
declare variable icodfilialtm smallint;
declare variable icodtipomov integer;

begin

    new.DTALT=cast('now' AS DATE);
    new.IDUSUALT=USER;
    new.HALT = cast('now' AS TIME);

    if ((new.sitfs!='FN') and (new.datafimprodfs is not null)) then
    begin

        new.sitfs = 'FN';

        select ef.finalizaop
            from ppestrufase ef, ppopfase pf, ppop op
            where
                ef.codemp = op.codemppd and ef.codfilial = op.codfilialpd
                and ef.codprod = op.codprod and ef.seqest = op.seqest
                and ef.codempfs = pf.codempfs and ef.codfilialfs = pf.codfilialfs
                and ef.codfase = pf.codfase and pf.codemp = op.codemp
                and pf.codfilial = op.codfilial and pf.codop = op.codop
                and pf.seqop = op.seqop and pf.seqof = new.seqof
                and op.codemp=new.codemp and op.codfilial=new.codfilial
                and op.codop=new.codop and op.seqop=new.seqop and ef.seqef = pf.seqof
             into :finaliza;

        if (:finaliza='S') then
            begin
                select count(1)
                    from ppopfase pf
                    where pf.codemp = new.codemp and pf.codfilial=new.codfilial
                        and pf.codop=new.codop and pf.seqop=new.seqop and pf.sitfs<>'FN'
                into :qtdpe;

                if(:qtdpe>1) then
                begin
                    exception ppopfase 'O processo no poder ser concludo, pois existem fases pendentes!';
                end
                else
                begin
                    update ppop set sitop = 'FN'
                        where codemp = new.codemp and codfilial = new.codfilial
                            and codop = new.codop and seqop = new.seqop;
                end
            end
        end
end ^

CREATE TRIGGER PPOPFASETGAU FOR PPOPFASE 
ACTIVE AFTER UPDATE POSITION 0 
AS
declare variable seqsubprod smallint;
begin

    -- Buscando subproduo para finalizao

    if(old.datafimprodfs is null and new.datafimprodfs is not null) then
    begin
        for select sp.seqsubprod from ppopsubprod sp where sp.codemp=new.codemp and sp.codfilial=new.codfilial and sp.codop=new.codop and sp.seqop=new.seqop
        and sp.codempfs=new.codempfs and sp.codfilialfs=new.codfilialfs and sp.codfase=new.codfase and sp.seqof=new.seqof
        into :seqsubprod
        do
        begin

            update ppopsubprod sp set sp.dtsubprod=new.datafimprodfs
            where sp.codemp=new.codemp and sp.codfilial=new.codfilial and sp.codop=new.codop and sp.seqop=new.seqop
            and sp.codempfs=new.codempfs and sp.codfilialfs=new.codfilialfs and sp.codfase=new.codfase and sp.seqof=new.seqof
            and sp.seqsubprod=:seqsubprod;

        end
    end

end ^

CREATE TRIGGER PPOPITORCTGAI FOR PPOPITORC 
ACTIVE AFTER INSERT POSITION 0 
AS
begin
  -- Atualizando status do tem de oramento
  update vditorcamento io set io.sitproditorc='EP'
  where io.codemp=new.codempoc and io.codfilial=new.codfilialoc and
  io.codorc=new.codorc and io.coditorc=new.coditorc and io.tipoorc=new.tipoorc;
end ^

CREATE TRIGGER PPOPITORCTGBU FOR PPOPITORC 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER PPOPSUBPRODTGAI FOR PPOPSUBPROD 
ACTIVE AFTER INSERT POSITION 0 
AS
declare variable dtestoque date;
declare variable preco decimal(15,5);
declare variable codempax integer;
declare variable codfilialax smallint;
declare variable codalmox integer;
begin

    --Buscando almoxarifado do produto
    select codempax, codfilialax, codalmox from eqproduto where codemp=new.codemppd and codfilial=new.codfilialpd and codprod=new.codprod
    into :codempax, :codfilialax, :codalmox;

    -- Buscando custo do produto;
    select ncustompm from eqprodutosp01(new.codemppd,new.codfilialpd,new.codprod,null,null,null)
    into :preco;

    -- Buscando data de finalizao da fase
    select coalesce(fs.datafimprodfs,op.dtemitop) from ppopfase fs, ppop op
    where
    op.codemp=fs.codemp and op.codfilial=fs.codfilial and op.codop=fs.codop and op.seqop=fs.seqop and
    fs.codemp=new.codemp and fs.codfilial=new .codfilial and fs.codop=new.codop and fs.seqop=new.seqop and fs.codempfs=new.codempfs
    and fs.codfilialfs=new.codfilialfs and fs.codfase=new.codfase and fs.seqof=new.seqof
    into :dtestoque;

    EXECUTE PROCEDURE EQMOVPRODIUDSP('I',new.CODEMPPD, new.CODFILIALPD, new.CODPROD,
    new.CODEMPLE, new.CODFILIALLE, new.codlote, new.codemptm,
    new.codfilialtm, new.codtipomov, null, null, null ,null, null,
    null, null, null, null, null, null,
    null, null, null, null, null,new.codemp, new.codfilial,new.codop, new.seqop, null,
    null, null,  null, :dtestoque, new.codop,
    'N',0.00,cast(:preco as numeric(15,5)),
    :codempax, :codfilialax, :codalmox, new.seqsubprod, 'S', 'N' );

end ^

CREATE TRIGGER PPOPSUBPRODTGBU FOR PPOPSUBPROD 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  IF (new.EMMANUT IS NULL) THEN
     new.EMMANUT='N';
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
  BEGIN  
      SELECT REFPROD FROM EQPRODUTO WHERE CODEMP=new.CODEMPPD AND
        CODFILIAL=new.CODFILIALPD AND CODPROD=new.CODPROD INTO new.REFPROD;
  END
end ^

CREATE TRIGGER PPOPSUBPRODTGAU FOR PPOPSUBPROD 
ACTIVE AFTER UPDATE POSITION 0 
AS
declare variable preco decimal(15,5);
declare variable codempax integer;
declare variable codfilialax smallint;
declare variable codalmox integer;

begin
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
  BEGIN
    if ( new.qtditsp>0 and (old.dtsubprod is null and new.dtsubprod is not null) ) then
        begin

            --Buscando almoxarifado do produto
            select codempax, codfilialax, codalmox from eqproduto where codemp=new.codemppd and codfilial=new.codfilialpd and codprod=new.codprod
            into :codempax, :codfilialax, :codalmox;

            -- Buscando custo do produto;
            select ncustompm from eqprodutosp01(new.codemppd,new.codfilialpd,new.codprod,null,null,null)
            into :preco;

            execute procedure eqmovprodiudsp('U',new.codemppd, new.codfilialpd, new.codprod,
                new.CODEMPLE, new.CODFILIALLE, new.codlote, new.codemptm,
                new.codfilialtm, new.codtipomov, null, null, null ,null, null,
                null, null, null, null, null, null,null, null, null, null, null,
                new.codemp, new.codfilial,new.codop,new.seqop, null, null, null, null,
                new.dtsubprod , new.codop, 'N', new.qtditsp,:preco,
                :codempax, :codfilialax, :codalmox, new.seqsubprod, 'S', 'N' );
        end
  END
end ^

CREATE TRIGGER PPOPSUBPRODTGAD FOR PPOPSUBPROD 
ACTIVE AFTER DELETE POSITION 0 
AS
declare variable preco decimal(15,5);
declare variable codempax integer;
declare variable codfilialax smallint;
declare variable codalmox integer;
declare variable dtestoque date;
begin

    --Buscando almoxarifado do produto
    select codempax, codfilialax, codalmox from eqproduto where codemp=old.codemppd and codfilial=old.codfilialpd and codprod=old.codprod
    into :codempax, :codfilialax, :codalmox;

    -- Buscando custo do produto;
    select ncustompm from eqprodutosp01(old.codemppd,old.codfilialpd,old.codprod,null,null,null)
    into :preco;

    -- Buscando data de finalizao da fase
    select coalesce(fs.datafimprodfs,op.dtemitop) from ppopfase fs, ppop op
    where
    op.codemp=fs.codemp and op.codfilial=fs.codfilial and op.codop=fs.codop and op.seqop=fs.seqop and
    fs.codemp=old.codemp and fs.codfilial=old.codfilial and fs.codop=old.codop and fs.seqop=old.seqop and fs.codempfs=old.codempfs
    and fs.codfilialfs=old.codfilialfs and fs.codfase=old.codfase and fs.seqof=old.seqof
    into :dtestoque;

 
   EXECUTE PROCEDURE EQMOVPRODIUDSP('D',old.CODEMPPD, old.CODFILIALPD, old.CODPROD,
        old.CODEMPLE, old.CODFILIALLE, old.codlote, old.codemptm,
        old.codfilialtm, old.codtipomov, null, null, null ,null, null,
        null, null, null, null, null, null,
        null, null, null, null, null, old.codemp, old.codfilial, old.codop, old.seqop, null,
        null, null, null,
        :dtestoque, old.codop, 'N', old.qtditsp,:preco,
        :codempax, :codfilialax, :codalmox, old.seqsubprod, 'S', 'N' );
end ^

CREATE TRIGGER PPPROCESSAOPTMPTGBU FOR PPPROCESSAOPTMP 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER PPRECURSOTGBU FOR PPRECURSO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER PPRETCPTGBU FOR PPRETCP 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER PPTIPOANALISETGBU FOR PPTIPOANALISE 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER PPTIPORECTGBU FOR PPTIPOREC 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER PVCAIXATGBU FOR PVCAIXA 
ACTIVE BEFORE UPDATE POSITION 0 
as
  DECLARE VARIABLE ICOUNTSEQ INTEGER;
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT=cast('now' AS TIME);
  
  IF ((old.SEQINI<>new.SEQINI) or (old.SEQMAX<>new.SEQMAX) ) THEN
  BEGIN
     SELECT COUNT(SEQCAIXA) FROM PVSEQUENCIA
        WHERE CODEMP=new.CODEMP AND CODFILIAL=new.CODFILIAL
        AND CODCAIXA=new.CODCAIXA
        INTO :ICOUNTSEQ;
     IF (:ICOUNTSEQ > 0) THEN
        EXCEPTION PVSEQCAIXA01 'J EXISTEM VENDAS DENTRO DESTA FAIXA DE VENDA';
  END

  EXECUTE PROCEDURE PVVALIDFAIXACAIXASP(new.CODEMP, new.CODFILIAL, new.CODCAIXA, new.SEQINI, new.SEQMAX);

end ^

CREATE TRIGGER PVCAIXAIMPTGBU FOR PVCAIXAIMP 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER PVLEITURAXTGBU FOR PVLEITURAX 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER PVMOVCAIXATGBI FOR PVMOVCAIXA 
ACTIVE BEFORE INSERT POSITION 0 
as
declare variable iMov INTEGER;
declare variable dSaldo NUMERIC(15, 5);
begin
  if (new.vlrsldmov is NULL) then
  BEGIN
    SELECT MAX(NROMOV) FROM PVMOVCAIXA WHERE CODEMP=new.CODEMP
      AND CODFILIAL=new.CODFILIAL AND CODCAIXA=new.CODCAIXA
      AND DTAMOV=new.DTAMOV INTO iMov;
    SELECT coalesce(vlrsldmov,0) FROM PVMOVCAIXA WHERE CODEMP=new.CODEMP
      AND CODFILIAL=new.CODFILIAL AND CODCAIXA=new.CODCAIXA
      AND DTAMOV=new.DTAMOV AND NROMOV=:iMov INTO dSaldo;
    new.vlrsldmov = dSaldo + new.vlrmov;
  END
end ^

CREATE TRIGGER PVMOVCAIXATGBU FOR PVMOVCAIXA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER PVSEQMOVCAIXATGBU FOR PVSEQMOVCAIXA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER PVSEQUENCIATGBU FOR PVSEQUENCIA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER RHAREATGBU FOR RHAREA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER RHBENEFICIOTGBU FOR RHBENEFICIO 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
   new.DTALT=cast('now' AS DATE);
    new.IDUSUALT=USER;
    new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER RHCANDIDATOTGAI FOR RHCANDIDATO 
ACTIVE AFTER INSERT POSITION 0 
AS
begin
  INSERT INTO RHCANDIDATOSTATUS (CODEMP,CODFILIAL,CODCAND,STCAND,DTSTATUS,SQSTCAND)
  VALUES(NEW.codemp, NEW.codfilial, NEW.codcand, NEW.stcand ,NEW.dtultst,
  coalesce((SELECT max(SQSTCAND) FROM RHCANDIDATOSTATUS where CODEMP = NEW.codemp
  AND CODFILIAL = NEW.CODFILIAL AND CODCAND = NEW.CODCAND),0) + 1 );
end ^

CREATE TRIGGER RHCANDIDATOTGBU FOR RHCANDIDATO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER RHCANDIDATOTGAU01 FOR RHCANDIDATO 
ACTIVE AFTER UPDATE POSITION 0 
AS
begin
  if(new.stcand<>old.stcand) then
  begin
    insert into rhcandidatostatus (CODEMP,CODFILIAL,CODCAND,SQSTCAND,DTSTATUS,STCAND)
             VALUES (new.CODEMP,new.codfilial,new.codcand,
             (select coalesce(max(sqstcand),0) + 1 from rhcandidatostatus 
              where codemp=new.codemp and codfilial=new.codfilial
              and codcand=new.codcand)
             ,cast('now' AS DATE ),new.stcand);
  end
end ^

CREATE TRIGGER RHCANDIDATOTGBD FOR RHCANDIDATO 
ACTIVE BEFORE DELETE POSITION 0 
AS
begin
  delete from rhcandidatostatus r where r.codemp=old.codemp and r.codfilial=old.codfilial
  and r.codcand=old.codcand;
end ^

CREATE TRIGGER RHCANDIDATOCARACTGBU FOR RHCANDIDATOCARAC 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER RHCANDIDATOCURSOTGBU FOR RHCANDIDATOCURSO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER RHCANDIDATOFUNCTGBU FOR RHCANDIDATOFUNC 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER RHCANDIDATOSTATUSTGBU FOR RHCANDIDATOSTATUS 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER RHCARACTERISTICATGBI FOR RHCARACTERISTICA 
ACTIVE BEFORE INSERT POSITION 0 
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER RHCODGPSTGBU FOR RHCODGPS 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER RHCURSOTGBU FOR RHCURSO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER RHDEPTOTGBU FOR RHDEPTO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER RHEMPREGADOTGBU FOR RHEMPREGADO 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER RHEMPREGADOBENEFTGBU FOR RHEMPREGADOBENEF 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
   new.DTALT=cast('now' AS DATE);
    new.IDUSUALT=USER;
    new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER RHEMPREGADOSALTGBU FOR RHEMPREGADOSAL 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
   new.DTALT=cast('now' AS DATE);
    new.IDUSUALT=USER;
    new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER RHEXPEDIENTETGBU FOR RHEXPEDIENTE 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER RHEXPEDMESGBU FOR RHEXPEDMES 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER RHFUNCAOTGBU FOR RHFUNCAO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER RHNIVELCURSOTGBU FOR RHNIVELCURSO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER RHPONTOTGBU FOR RHPONTO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' as date);
  new.IDUSUALT=USER;
  new.HALT = cast('now' as time);
end ^

CREATE TRIGGER RHTABELAINSSTGBU FOR RHTABELAINSS 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.dtalt=cast('now' as date);
  new.idusualt=user;
  new.halt = cast('now' as time);
end ^

CREATE TRIGGER RHTABELAIRRFTGBU FOR RHTABELAIRRF 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.dtalt=cast('now' as date);
  new.idusualt=user;
  new.halt = cast('now' as time);
end ^

CREATE TRIGGER RHTURNOTGBU FOR RHTURNO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER RHVAGATGAI FOR RHVAGA 
ACTIVE AFTER INSERT POSITION 0 
AS
begin
  INSERT INTO RHVAGASTATUS (CODEMP,CODFILIAL,CODVAGA,STVAGA,DTSTATUS,SQSTVAGA)
  VALUES(NEW.codemp, NEW.codfilial, NEW.codvaga, NEW.stvaga ,NEW.dtultst,
  coalesce((SELECT MAX(SQSTVAGA) FROM RHVAGASTATUS where CODEMP = NEW.codemp
  AND CODFILIAL = NEW.CODFILIAL AND CODVAGA = NEW.CODVAGA),0) + 1 );
end ^

CREATE TRIGGER RHVAGATGBU FOR RHVAGA 
ACTIVE BEFORE UPDATE POSITION 0 
AS Declare variable I integer;
BEGIN I = 0; END ^

CREATE TRIGGER RHVAGATGAU FOR RHVAGA 
ACTIVE AFTER UPDATE POSITION 0 
AS
begin
    IF(OLD.stvaga!=NEW.stvaga) THEN
    BEGIN
      INSERT INTO RHVAGASTATUS (CODEMP,CODFILIAL,CODVAGA,STVAGA,DTSTATUS,SQSTVAGA)
      VALUES(NEW.codemp, NEW.codfilial, NEW.codvaga, NEW.stvaga ,NEW.dtultst,
      coalesce((SELECT MAX(SQSTVAGA) FROM RHVAGASTATUS where CODEMP = NEW.codemp
      AND CODFILIAL = NEW.CODFILIAL AND CODVAGA = NEW.CODVAGA),0) + 1 );
    END
end ^

CREATE TRIGGER RHVAGATGBD FOR RHVAGA 
ACTIVE BEFORE DELETE POSITION 0 
AS
begin
  delete from rhvagastatus r where r.codemp=old.codemp and r.codfilial=old.codfilial
  and r.codvaga=old.codvaga;
end ^

CREATE TRIGGER RHVAGACANDIDATOTGBI FOR RHVAGACANDIDATO 
ACTIVE AFTER INSERT POSITION 0 
AS
begin
    update RHCANDIDATO set STCAND=NEW.stvagacand WHERE
    CODEMP=NEW.codempca AND CODFILIAL=NEW.codfilialca AND
    CODCAND=NEW.codcand;

    insert into RHCANDIDATOSTATUS (CODEMP,CODFILIAL,CODCAND,STCAND,SQSTCAND,CODEMPVG,CODFILIALVG,CODVAGA)
      VALUES(NEW.codemp, NEW.codfilial, NEW.codcand, NEW.stvagacand ,
      coalesce((SELECT max(SQSTCAND) FROM RHCANDIDATOSTATUS where CODEMP = NEW.codemp
      AND CODFILIAL = NEW.CODFILIAL AND CODCAND = NEW.CODCAND),0) + 1 ,NEW.codemp,NEW.codfilial,NEW.codvaga);
end ^

CREATE TRIGGER RHVAGACANDIDATOTGBU FOR RHVAGACANDIDATO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER RHVAGACANDIDATOTGAU FOR RHVAGACANDIDATO 
ACTIVE AFTER UPDATE POSITION 0 
AS
begin
    update RHCANDIDATO set STCAND=NEW.stvagacand WHERE
    CODEMP=NEW.codempca AND CODFILIAL=NEW.codfilialca AND
    CODCAND=NEW.codcand;

    insert into RHCANDIDATOSTATUS (CODEMP,CODFILIAL,CODCAND,STCAND,SQSTCAND,CODEMPVG,CODFILIALVG,CODVAGA)
      VALUES(NEW.codemp, NEW.codfilial, NEW.codcand, NEW.stvagacand ,
      coalesce((SELECT max(SQSTCAND) FROM RHCANDIDATOSTATUS where CODEMP = NEW.codemp
      AND CODFILIAL = NEW.CODFILIAL AND CODCAND = NEW.CODCAND),0) + 1 ,NEW.codemp,NEW.codfilial,NEW.codvaga);
end ^

CREATE TRIGGER RHVAGACARACQUALITGBU FOR RHVAGACARACQUALI 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER RHVAGACARACRESTTGBU FOR RHVAGACARACREST 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER RHVAGACURSOTGBU FOR RHVAGACURSO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER RHVAGASTATUSTGBU FOR RHVAGASTATUS 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER SGACESSOEUTGBU FOR SGACESSOEU 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGACESSOMGTGBU FOR SGACESSOMG 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGACESSOMUTGBU FOR SGACESSOMU 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER SGAGENDATGBU FOR SGAGENDA 
ACTIVE BEFORE UPDATE POSITION 0 
AS -- Mecanismo de troca de usuario da agenda
declare variable codagd integer;
begin
    new.DTALT=cast('now' as date);
    new.IDUSUALT=USER;
    new.HALT = cast('now' as time);

  if(new.codage != old.codage) then
  begin
      select iseq from spgeranum(new.codemp,new.codfilial,'AG') into codagd;
      /*Insere o agendamento para o novo usurio*/
      insert into sgagenda (
            codemp, codfilial, codage, tipoage, codagd,
            dataagd, dtainiagd, hriniagd, dtafimagd, hrfimagd,
            assuntoagd, descagd, codempta, codfilialta, codtipoagd, prioragd, sitagd,
            codempae, codfilialae, codageemit, tipoageemit, caagd, resolucaomotivo,
            codempar,codfilialar,codagear,tipoagear,codagdar)
        values (
            new.codemp, new.codfilial, new.codage, new.tipoage, :codagd,
            new.dataagd, new.dtainiagd, new.hriniagd, new.dtafimagd, new.hrfimagd,
            new.assuntoagd, new.descagd, new.codempta, new.codfilialta, new.codtipoagd,
            new.prioragd, new.sitagd,new.codempae, new.codfilialae, new.codageemit, new.tipoageemit,
            new.caagd, new.resolucaomotivo, new.codempar, new.codfilialar, new.codagear, new.tipoagear,
            new.codagdar);

        new.codage = old.codage; -- Cancela a troca de usuario;
        new.sitagd = 'CA'; -- Cancela agendamento atual;
  end
end ^

CREATE TRIGGER SGAGENTETGBU FOR SGAGENTE 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGATRIBUICAOTGBU FOR SGATRIBUICAO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGATRIBUSUTGBU FOR SGATRIBUSU 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGBAIRROTGBU FOR SGBAIRRO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER SGCATIMGTGBU FOR SGCATIMG 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGCONEXAOTGBU FOR SGCONEXAO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER SGDEBUG_BI FOR SGDEBUG 
ACTIVE BEFORE INSERT POSITION 0 
AS
BEGIN
  IF (NEW.SEQ IS NULL) THEN
    NEW.SEQ = GEN_ID(GEN_SGDEBUG_ID,1);
END ^

CREATE TRIGGER SGEMPRESATGBU FOR SGEMPRESA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGEQVCLIFORTGBU0 FOR SGEQVCLIFOR 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT=cast('now' AS TIME);
end ^

CREATE TRIGGER SGESTACAOTGBU FOR SGESTACAO 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGESTACAOBALTGBU FOR SGESTACAOBAL 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGESTACAOIMPTGBU FOR SGESTACAOIMP 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGESTCIVILTGBU FOR SGESTCIVIL 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER SGFERIADOBTGU FOR SGFERIADO 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGFILIALTGBU FOR SGFILIAL 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGFILIALTGAU FOR SGFILIAL 
ACTIVE AFTER UPDATE POSITION 0 
AS
    declare variable filialpref smallint;
    declare variable geracodunif char(1);

begin
      -- Atualizao de descrio do cdigo unificador (SGUNIFCOD)

    select icodfilial from sgretfilial(new.codemp,'SGPREFERE1') into filialpref;
    select geracodunif from sgprefere1 where codemp=new.codemp and codfilial=:filialpref into :geracodunif;
    
    if(:geracodunif = 'S' and new.codunifcod is not null) then
    begin
        update sgunifcod set descunifcod=new.razfilial
        where codemp=new.codempuc and codfilial=new.codfilialuc and codunifcod=new.codunifcod;
    end
end ^

CREATE TRIGGER SGFLUXOTGBU FOR SGFLUXO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGGATILHOTGBU FOR SGGATILHO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGGRAUINSTTGBU FOR SGGRAUINST 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGGRPUSUTGBU FOR SGGRPUSU 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGIMAGEMTGBU FOR SGIMAGEM 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGIMPRESSORATGBU FOR SGIMPRESSORA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGITFLUXOTGBU FOR SGITFLUXO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGITPREFERE6TGBU FOR SGITPREFERE6 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGITPROCESSOTGBU FOR SGITPROCESSO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGITTABELATGBU FOR SGITTABELA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGLOGTGBU FOR SGLOG 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER SGMENUTGBI FOR SGMENU 
ACTIVE BEFORE INSERT POSITION 0 
AS
begin
  if (new.CODSIS=1) then
  begin
     if (new.NOMEMENU is null) then
        new.NOMEMENU = new.DESCMENU;
     if (new.ACAOMENU is null) then
        new.ACAOMENU = cast(new.CODMENU as CHAR(30));
  end 
end ^

CREATE TRIGGER SGMENUTGBU FOR SGMENU 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGMENUOBJTGBU FOR SGMENUOBJ 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGMODETIQUETATGBU FOR SGMODETIQUETA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGMODULOTGBU FOR SGMODULO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGMUNICIPIOTGBU FOR SGMUNICIPIO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER SGOBJETOTGBU FOR SGOBJETO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGOBJETOTBTGBU FOR SGOBJETOTB 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGPAISTGBU FOR SGPAIS 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER SGPAPELTGBU FOR SGPAPEL 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGPREFERE1TGBU FOR SGPREFERE1 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGPREFERE1TGAU FOR SGPREFERE1 
ACTIVE AFTER UPDATE POSITION 0 
AS
    declare variable scodfilialtm smallint;
begin
    /*Limpa flag de multiplos comissionados nos tipos de movimento.*/

    select rf.icodfilial from sgretfilial(new.codemp, 'EQTIPOMOV') rf
        into :scodfilialtm;

    if(old.multicomis = 'S' and new.multicomis = 'N') then
    begin
        update eqtipomov set mcomistipomov = 'N'
            where codemp=new.codemp and codfilial=:scodfilialtm
            and mcomistipomov='S';
    end
end ^

CREATE TRIGGER SGPREFERE2TGBU FOR SGPREFERE2 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGPREFERE3TGBU FOR SGPREFERE3 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGPREFERE4TGBU FOR SGPREFERE4 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGPREFERE5_BU0 FOR SGPREFERE5 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGPREFERE6TGBU FOR SGPREFERE6 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGPREFERE7_BU0 FOR SGPREFERE7 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGPREFERE8TGBU FOR SGPREFERE8 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGPROCESSOTGBU FOR SGPROCESSO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGPROXYWEBTGBU FOR SGPROXYWEB 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGSEQUENCIATGBU FOR SGSEQUENCIA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGSISTEMATGBU FOR SGSISTEMA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGTABELATGBU FOR SGTABELA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGTAREFATGBU FOR SGTAREFA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGTIPOAGENDATGBU FOR SGTIPOAGENDA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER SGTRATARETAI FOR SGTRATARET 
ACTIVE AFTER INSERT POSITION 0 
as
begin
-- Implementao intil pois no  possvel atribuir valor  variavel new.xxx
/*  IF (new.CODPROCGT IS NULL AND NOT new.SEQITPROCGT IS NULL) THEN
    new.CODPROCGT = new.CODPROC;*/

end ^

CREATE TRIGGER SGTRATARETTGBU FOR SGTRATARET 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER SGUFTGBU FOR SGUF 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER SGUNIFCODTGBU FOR SGUNIFCOD 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER SGUSUARIOTGBI FOR SGUSUARIO 
ACTIVE BEFORE INSERT POSITION 0 
AS
begin
   SELECT CODEMP, CODFILIAL, TIPOAGE, CODAGE
      FROM SGAGENTEUIDSP('I',new.CODEMP, 'SGUSU', null, new.NOMEUSU)
        INTO new.CODEMPAE, new.CODFILIALAE, new.TIPOAGE, new.CODAGE;
end ^

CREATE TRIGGER SGUSUARIOTGBU FOR SGUSUARIO 
ACTIVE BEFORE UPDATE POSITION 0 
as
  declare variable CUID char(1);
begin

    new.DTALT=cast('now' as date);
    new.IDUSUALT=USER;
    new.HALT = cast('now' as time);

    if (new.codage is null) then
        CUID = 'I';
    else
        CUID = 'U';

    select codemp, codfilial, tipoage, codage
    from sgagenteuidsp(:CUID,new.codemp, 'SGUSU', new.codage, new.nomeusu)
    into new.codempae, new.codfilialae, new.tipoage, new.codage;

end ^

CREATE TRIGGER SGVARIAVELTGBU FOR SGVARIAVEL 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT=cast('now'AS TIME);
end ^

CREATE TRIGGER SVAVALIACAOTGBU FOR SVAVALIACAO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER SVEXECUCAOTGBU FOR SVEXECUCAO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER SVITOSTGBU FOR SVITOS 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER SVOSTGBU FOR SVOS 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER TKATIVIDADETGBU FOR TKATIVIDADE 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER TKCAMPANHATGBU FOR TKCAMPANHA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER TKCAMPANHACLITGBU FOR TKCAMPANHACLI 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER TKCAMPANHACTOTGBU FOR TKCAMPANHACTO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER TKCAMPANHAEMAILTGBU FOR TKCAMPANHAEMAIL 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER TKCONFEMAILTGBU FOR TKCONFEMAIL 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER TKCONTATOTGBI FOR TKCONTATO 
ACTIVE BEFORE INSERT POSITION 0 
AS
    declare variable nomemuniccto CHAR(30);
begin

    /*Atualizao do campo cidade e estado (temporrio para retro-compatibilidade)*/

    if(new.codmunic is not null) then
    begin
        select substr(mun.nomemunic,1,30) from sgmunicipio mun
            where mun.codpais=new.codpais and mun.siglauf=new.siglauf and mun.codmunic=new.codmunic
                into :nomemuniccto;
        if (nomemuniccto is not null) then new.cidcto = nomemuniccto;
    end

    if(new.siglauf is not null) then
    begin
        new.ufcto=new.siglauf;
    end

    /* Fim da atualizao do campo cidade e estado*/

end ^

CREATE TRIGGER TKCONTATOTGBU FOR TKCONTATO 
ACTIVE BEFORE UPDATE POSITION 0 
as
  declare variable nomemuniccto CHAR(30);
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);

   /*Atualizao do campo cidade e estado (temporrio para retro-compatibilidade)*/

    if(old.codmunic != new.codmunic) then
    begin
        select substr(mun.nomemunic,1,30) from sgmunicipio mun
            where mun.codpais=new.codpais and mun.siglauf=new.siglauf and mun.codmunic=new.codmunic
                into :nomemuniccto;
        if (nomemuniccto is not null) then new.cidcto = nomemuniccto;
    end

    if(new.siglauf is not null) then
    begin
        new.ufcto=new.siglauf;
    end

    /* Fim da atualizao do campo cidade */

end ^

CREATE TRIGGER TKCONTCLIBU FOR TKCONTCLI 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
    new.DTALT=cast('now' AS DATE);
    new.IDUSUALT=user;
    new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER TKCTOATIVTGBU FOR TKCTOATIV 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER TKCTOGRPINTTGBU FOR TKCTOGRPINT 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER TKEMAILTGBU FOR TKEMAIL 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER TKHISTORICOTGBU FOR TKHISTORICO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER TKORIGCONTTGBU FOR TKORIGCONT 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);

end ^

CREATE TRIGGER TKSETORCTOTGBU FOR TKSETORCTO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER TKSITCAMPTGBU FOR TKSITCAMP 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER TKTIPOCONTTGBU FOR TKTIPOCONT 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);

end ^

CREATE TRIGGER TKTIPOIMPTGBU FOR TKTIPOIMP 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER VDAUXVENDATGBU FOR VDAUXVENDA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER VDCLASCLITGBU FOR VDCLASCLI 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER VDCLCOMISTGBI FOR VDCLCOMIS 
ACTIVE BEFORE INSERT POSITION 0 
AS
begin
  if ( (new.percfatclcomis+new.percpgtoclcomis) != 100.00) then
  begin
     exception VDCLCOMISEX01;
  end
  /* Trigger text */
end ^

CREATE TRIGGER VDCLCOMISTGBU FOR VDCLCOMIS 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin

  if ( (new.percfatclcomis+new.percpgtoclcomis) != 100.00) then
  begin
     exception VDCLCOMISEX01;
  end

  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT=cast('now'AS TIME);

end ^

CREATE TRIGGER VDCLIAUTPTGBU FOR VDCLIAUTP 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER VDCLICOMPLTGBU FOR VDCLICOMPL 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER VDCLICONTASTGBU FOR VDCLICONTAS 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER VDCLIENTETGBI FOR VDCLIENTE 
ACTIVE BEFORE INSERT POSITION 0 
as
    declare variable nomemuniccli CHAR(30);
    declare variable nomemunicent CHAR(30);
    declare variable nomemuniccob CHAR(30);
    declare variable filialpref smallint;
    declare variable geracodunif CHAR(1);
    declare variable codunifcod integer;
begin

    if (new.codpesq is null) then
    begin
        new.codemppq = new.codemp;
        new.codfilialpq = new.codfilial;
        new.codpesq = new.codcli;
    end

    -- Atualizao do campo cidade e estado (temporrio para retro-compatibilidade)

    if(new.codmunic is not null) then
    begin
        select substr(mun.nomemunic,1,30) from sgmunicipio mun
            where mun.codpais=new.codpais and mun.siglauf=new.siglauf and mun.codmunic=new.codmunic
                into :nomemuniccli;
        if (nomemuniccli is not null) then new.cidcli = nomemuniccli;
    end

    if(new.siglauf is not null) then
    begin
        new.ufcli=new.siglauf;
    end

    if(new.codmunicent is not null) then
    begin
        select substr(mun.nomemunic,1,30) from sgmunicipio mun
            where mun.codpais=new.codpaisent and mun.siglauf=new.siglaufent and mun.codmunic=new.codmunicent
                into :nomemunicent;

        if (nomemunicent is not null) then new.cident = nomemunicent;
    end

    if(new.siglaufent is not null) then
    begin
        new.ufent=new.siglaufent;
    end

    if(new.codmuniccob is not null) then
    begin
        select substr(mun.nomemunic,1,30) from sgmunicipio mun
            where mun.codpais=new.codpaiscob and mun.siglauf=new.siglaufcob and mun.codmunic=new.codmuniccob
                into :nomemuniccob;

        if (nomemuniccob is not null) then new.cidcob = nomemuniccob;
    end

    if(new.siglaufcob is not null) then
    begin
        new.ufcob=new.siglaufcob;
    end

    -- Fim da atualizao do campo cidade e estado

    -- Gerao de cdigo unificador (SGUNIFCOD)

    select icodfilial from sgretfilial(new.codemp,'SGPREFERE1') into filialpref;
    select geracodunif from sgprefere1 where codemp=new.codemp and codfilial=:filialpref into :geracodunif;
    
    if(:geracodunif = 'S') then
    begin

        select (coalesce(max(codunifcod),0)+1) from sgunifcod where codemp=new.codemp and codfilial=new.codfilial
        into :codunifcod;

        insert into sgunifcod (codemp, codfilial, codunifcod, tipounifcod, descunifcod)
        values (new.codemp, new.codfilial, :codunifcod, 'C', new.razcli);
        new.codempuc=new.codemp;
        new.codfilialuc=new.codfilial;
        new.codunifcod=:codunifcod;

    end
end ^

CREATE TRIGGER VDCLIENTETGBU FOR VDCLIENTE 
ACTIVE BEFORE UPDATE POSITION 0 
as
    declare variable nomemuniccli CHAR(30);
    declare variable nomemunicent CHAR(30);
    declare variable nomemuniccob CHAR(30);
    declare variable filialpref smallint;
    declare variable geracodunif char(1);
    declare variable codunifcod integer;

begin
    new.DTALT=cast('now' AS DATE);
    new.IDUSUALT=user;
    new.HALT = cast('now' AS TIME);

    if (new.codpesq is null) then
    begin
        new.codemppq = new.codemp;
        new.codfilialpq = new.codfilial;
        new.codpesq = new.codcli;
    end

    /*Atualizao do campo cidade e estado (temporrio para retro-compatibilidade)*/

    if ( ((old.codmunic is null) and (new.codmunic is not null)) or
         (old.codmunic<>new.codmunic) ) then
    begin
        select substr(mun.nomemunic,1,30) from sgmunicipio mun
            where mun.codpais=new.codpais and mun.siglauf=new.siglauf and mun.codmunic=new.codmunic
                into :nomemuniccli;
        if (nomemuniccli is not null) then new.cidcli = nomemuniccli;
    end

    if(new.siglauf is not null) then
    begin
        new.ufcli=new.siglauf;
    end

    if(old.codmunicent != new.codmunicent) then
    begin
        select substr(mun.nomemunic,1,30) from sgmunicipio mun
            where mun.codpais=new.codpaisent and mun.siglauf=new.siglaufent and mun.codmunic=new.codmunicent
                into :nomemunicent;

        if (nomemunicent is not null) then new.cident = nomemunicent;
    end

    if(new.siglaufent is not null) then
    begin
        new.ufent=new.siglaufent;
    end

    if(old.codmuniccob != new.codmuniccob) then
    begin
        select substr(mun.nomemunic,1,30) from sgmunicipio mun
            where mun.codpais=new.codpaiscob and mun.siglauf=new.siglaufcob and mun.codmunic=new.codmuniccob
                into :nomemuniccob;

        if (nomemuniccob is not null) then new.cidcob = nomemuniccob;
    end

    if(new.siglaufcob is not null) then
    begin
        new.ufcob=new.siglaufcob;
    end

    /* Dados da ltima reviso do cliente*/
    if ( (coalesce(old.sitrevcli,'N')='O') and (coalesce(new.sitrevcli,'O')='R') ) then
    begin
       new.dtrevcli = cast('now' as date);
       new.hrevcli = cast('now' as time);
       new.idusurevcli = upper(user);
    end 
    /* Fim da atualizao do campo cidade */

    -- Gerao de cdigo unificador (SGUNIFCOD)

    if (new.codunifcod is null) then
    begin
      select icodfilial from sgretfilial(new.codemp,'SGPREFERE1') into filialpref;
      select geracodunif from sgprefere1 where codemp=new.codemp and codfilial=:filialpref into :geracodunif;
    
      if( :geracodunif = 'S' ) then
      begin

         select (coalesce(max(codunifcod),0)+1) from sgunifcod where codemp=new.codemp and codfilial=new.codfilial
         into :codunifcod;

         insert into sgunifcod (codemp, codfilial, codunifcod, tipounifcod, descunifcod)
         values (new.codemp, new.codfilial, :codunifcod, 'C', new.razcli);

         new.codempuc=new.codemp;
         new.codfilialuc=new.codfilial;
         new.codunifcod=:codunifcod;

       end
    end

end ^

CREATE TRIGGER VDCLIENTETGAU FOR VDCLIENTE 
ACTIVE AFTER UPDATE POSITION 0 
AS
    declare variable filialpref smallint;
    declare variable geracodunif char(1);

begin
      -- Atualizao de descrio do cdigo unificador (SGUNIFCOD)

    select icodfilial from sgretfilial(new.codemp,'SGPREFERE1') into filialpref;
    select geracodunif from sgprefere1 where codemp=new.codemp and codfilial=:filialpref into :geracodunif;
    
    if(:geracodunif = 'S' and new.codunifcod is not null) then
    begin
        update sgunifcod set descunifcod=new.razcli
        where codemp=new.codempuc and codfilial=new.codfilialuc and codunifcod=new.codunifcod;
    end
end ^

CREATE TRIGGER VDCLIENTEFORTGBU FOR VDCLIENTEFOR 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER VDCLIIMOVTGBU FOR VDCLIIMOV 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER VDCLIMETAVENDTGBU FOR VDCLIMETAVEND 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER VDCLIREFCTGBU FOR VDCLIREFC 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER VDCLIREFPTGBU FOR VDCLIREFP 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER VDCLISOCIOSTGBU FOR VDCLISOCIOS 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER VDCLITERRATGBU FOR VDCLITERRA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER VDCLIVEICTGBU FOR VDCLIVEIC 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER VDCOMISSAOTGBI FOR VDCOMISSAO 
ACTIVE BEFORE INSERT POSITION 0 
AS
begin
  new.DTINS = cast('now' AS DATE);
  new.IDUSUINS=USER;
  new.HINS = cast('now' AS TIME);
  new.VLRAPAGCOMI = new.VLRCOMI - new.VLRPAGOCOMI;
  if (new.DTCOMPCOMI IS NULL) then
     new.DTCOMPCOMI = new.DATACOMI;
end ^

CREATE TRIGGER VDCOMISSAOTGBU FOR VDCOMISSAO 
ACTIVE BEFORE UPDATE POSITION 0 
AS
BEGIN
  if (new.EMMANUT IS NULL) then
     new.EMMANUT = 'N';
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
  BEGIN
     new.DTALT=cast('now' AS DATE);
     new.IDUSUALT=USER;
     new.HALT = cast('now' AS TIME);
     IF ( ( new.DTCOMPCOMI IS NULL ) OR ( new.DATACOMI<>old.DATACOMI ) ) THEN
        new.DTCOMPCOMI = new.DATACOMI;
     IF ( OLD.STATUSCOMI = 'CP' AND NEW.STATUSCOMI = 'C1' ) then
       EXCEPTION VDCOMISSAOEX01;
     ELSE if ( OLD.STATUSCOMI='CP' AND NEW.STATUSCOMI='CP' AND OLD.VLRCOMI!=NEW.VLRCOMI ) then
       EXCEPTION VDCOMISSAOEX01;
     ELSE IF ( OLD.STATUSCOMI = 'C1' AND NEW.STATUSCOMI = 'CP' ) then
       EXCEPTION VDCOMISSAOEX02;
     ELSE IF ( OLD.STATUSCOMI = 'CP' AND NEW.STATUSCOMI = 'CD' ) THEN /* Estorno de comisses */
     BEGIN
        new.STATUSCOMI ='C2';
        new.CODEMPCI = null;
        new.CODFILIALCI = null;
        new.CODPCOMI = null;
        new.VLRPAGOCOMI = 0;
     END
     IF ( new.VLRCOMI IS NULL) THEN
       new.VLRCOMI = 0;
     IF ( new.VLRPAGOCOMI IS NULL ) THEN
       new.VLRPAGOCOMI = 0;
     new.VLRAPAGCOMI = new.VLRCOMI - new.VLRPAGOCOMI;
  END
END ^

CREATE TRIGGER VDCOMISSAOTGBD FOR VDCOMISSAO 
ACTIVE BEFORE DELETE POSITION 0 
AS
BEGIN
  IF (old.STATUSCOMI = 'CP') THEN
    EXCEPTION VDCOMISSAOEX01;
END ^

CREATE TRIGGER VDCONSIGNACAOTGBU FOR VDCONSIGNACAO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER VDCONTRATOTGBU FOR VDCONTRATO 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER VDCONTRATOTGAU FOR VDCONTRATO 
ACTIVE AFTER UPDATE POSITION 0 
AS
declare variable seqlog integer;
begin
   if ( (old.dtprevfin is null and new.dtprevfin is not null) or 
        (old.sitcontr is null and new.sitcontr is not null) or 
        (old.descsitcontr is null and new.sitcontr is not null) or 
        (old.dtprevfin<>new.dtprevfin) or (old.sitcontr<>new.sitcontr) or 
        (old.descsitcontr<>new.descsitcontr ) ) then
   begin
      select coalesce(max(seqlog),0)+1 from vdlogsitcontr l
        where l.codemp=new.codemp and l.codfilial=new.codfilial and l.codcontr=new.codcontr
        into :seqlog;
        --exception vdvendaex01 'teste '||:seqlog;
      if (seqlog is null) then
      begin
        seqlog = 1;
      end
      insert into vdlogsitcontr (codemp, codfilial, codcontr, seqlog, sitcontr, dtprevfin, descsitcontr)
       values (new.codemp, new.codfilial, new.codcontr, :seqlog, new.sitcontr, new.dtprevfin, new.descsitcontr);
   end 
end ^

CREATE TRIGGER VDDETORCTGBU FOR VDDETORC 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER VDETIQCLITGBU FOR VDETIQCLI 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER VDFINCONTRTGAI FOR VDFINCONTR 
ACTIVE AFTER INSERT POSITION 0 
AS
begin
    update vdcontrato set sitcontr='FN' 
       where codemp=new.codemp and codfilial=new.codfilial and codcontr=new.codcontr;
end ^

CREATE TRIGGER VDFINCONTRTGBU FOR VDFINCONTR 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER VDFOTOPRODTGBU FOR VDFOTOPROD 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER VDFRETEVDTGAI FOR VDFRETEVD 
ACTIVE BEFORE INSERT POSITION 0 
as
declare variable vlrliqvenda numeric(15,5);
declare variable vlrbaseicmsfretevd numeric(15,5);
declare variable vlricmsfretevd numeric(15,5);
begin
    -- Buscando valor liquido da venda
    select vlrliqvenda from vdvenda
    where tipovenda=new.tipovenda and codvenda=new.codvenda and codemp=new.codemp and codfilial=new.codfilial
    into vlrliqvenda;
    
    -- Calcula o percentual do frete sobre o valor da venda
    if (not vlrliqvenda is null and vlrliqvenda > 0 and not new.percvendafretevd > 0) then
    begin
        new.percvendafretevd = (new.vlrfretevd/:vlrliqvenda)*100;
    end

    -- Atualizando valor do frete na tabela de venda.

    update vdvenda vd set vd.vlrfretevenda = new.vlrfretevd
    where vd.codemp=new.codemp and vd.codfilial=new.codfilial and vd.codvenda=new.codvenda and vd.tipovenda=new.tipovenda;

    -- Busca totais da base de calculo do icms do frete e valor do icms do frete
    select sum(lfi.vlrbaseicmsfreteitvenda), sum(lfi.vlricmsfreteitvenda) from lfitvenda lfi
    where lfi.codemp=new.codemp and lfi.codfilial=new.codfilial and lfi.codvenda=new.codvenda and lfi.tipovenda=new.tipovenda
    into :vlrbaseicmsfretevd, :vlricmsfretevd;

    -- Atualizando os valores (supondo que j houve o reprocessamento dos valores nos tens);
    new.vlrbaseicmsfretevd = :vlrbaseicmsfretevd;
    new.vlricmsfretevd =: vlricmsfretevd;

end ^

CREATE TRIGGER VDFRETEVDTGBU FOR VDFRETEVD 
ACTIVE BEFORE UPDATE POSITION 0 
as
    declare variable vlrliqvenda numeric(15,5);
    declare variable vlrbaseicmsfretevd numeric(15,5);
    declare variable vlricmsfretevd numeric(15,5);

begin

    -- Atualizando o log de alteraes
    new.dtalt=cast('now' as date);
    new.idusualt = user;
    new.halt = cast('now' as time);

    -- Buscando o valor liquido da venda
    select coalesce(vlrliqvenda,0) from vdvenda
    where tipovenda=new.tipovenda and codvenda=new.codvenda and codemp=new.codemp and codfilial=new.codfilial
    into vlrliqvenda;

    -- Calculando o percentual do frete sobre a venda
    if (vlrliqvenda > 0) then
    begin
        new.percvendafretevd = (new.vlrfretevd/:vlrliqvenda) * 100;
    end

    -- Verifica se o valor do frete foi alterado.
    if(new.vlrfretevd != old.vlrfretevd) then
    begin

        -- Atualizao do valor do frete na tabela de venda
        update vdvenda vd set vd.vlrfretevenda = new.vlrfretevd
        where vd.codemp=new.codemp and vd.codfilial=new.codfilial and vd.codvenda=new.codvenda and vd.tipovenda=new.tipovenda;

        -- Busca totais da base de calculo do icms do frete e valor do icms do frete
        select sum(lfi.vlrbaseicmsfreteitvenda), sum(lfi.vlricmsfreteitvenda) from lfitvenda lfi
        where lfi.codemp=new.codemp and lfi.codfilial=new.codfilial and lfi.codvenda=new.codvenda and lfi.tipovenda=new.tipovenda
        into :vlrbaseicmsfretevd, :vlricmsfretevd;

        -- Atualizando os valores (supondo que j houve o reprocessamento dos valores nos tens);
        new.vlrbaseicmsfretevd = :vlrbaseicmsfretevd;
        new.vlricmsfretevd =: vlricmsfretevd;

    end

end ^

CREATE TRIGGER VDGRUPORCTGBU FOR VDGRUPORC 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER VDITCONTRATOTGBU FOR VDITCONTRATO 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER VDITCUSTOORCTGBU FOR VDITCUSTOORC 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER VDITCUSTOVENDATGBU FOR VDITCUSTOVENDA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER VDITDETORCTGBU FOR VDITDETORC 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER VDITGRUPORCTGBU FOR VDITGRUPORC 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER VDITKITTGBI FOR VDITKIT 
ACTIVE BEFORE INSERT POSITION 0 
AS
begin
  new.DTINS=cast('now' AS DATE);
  new.IDUSUINS=USER;
  new.HINS = cast('now' AS TIME);
  SELECT REFPROD FROM EQREFPRODSP(new.CODEMP, new.CODFILIAL, new.CODPROD) INTO new.REFPROD;
end ^

CREATE TRIGGER VDITKITTGBU FOR VDITKIT 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  IF (new.EMMANUT IS NULL) THEN
     new.EMMANUT='N';
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
  BEGIN  
     SELECT REFPROD FROM EQREFPRODSP(new.CODEMP, new.CODFILIAL, new.CODPROD) INTO new.REFPROD;
  END
end ^

CREATE OR ALTER TRIGGER VDITORCAMENTOTGBI FOR VDITORCAMENTO 
ACTIVE BEFORE INSERT POSITION 0 
as
    declare variable refprod VARchar(20);
    declare variable vlripi numeric(15,5);
    declare variable contribipi char(1);
    declare variable adicfrete char(1);

begin

  if ( ( new.emmanut is null ) or ( new.emmanut='N' ) ) then
  begin
    select fi.contribipifilial from sgfilial fi where fi.codemp=new.codemp and fi.codfilial=new.codfilial
    into contribipi;

    if(contribipi = 'S') then
    begin
        select pt.vlripiitorc from vdprevtribitorc pt
        where pt.codemp=new.codemp and pt.codfilial=new.codfilial and pt.codorc=new.codorc and pt.tipoorc=new.tipoorc
        and pt.coditorc=new.coditorc
        into vlripi;
    end

    -- Garantindo valor vlido para IPI
    if (vlripi is null) then vlripi = 0;

    -- Garantindo valor vlido para desconto
    if (new.vlrdescitorc is null) then new.vlrdescitorc = 0;

    -- Garantindo valor vlido para vlrliqitorc
    if (new.vlrliqitorc is null) then new.vlrliqitorc = 0;

    select adicfrete from vdorcamento
    where codemp=new.codemp and codfilial=new.codfilial and codorc=new.codorc and tipoorc=new.tipoorc
    into adicfrete;

    -- Calculando valor liquido
    if (new.vlrliqitorc = 0) then
    begin
        new.vlrliqitorc = (new.qtditorc * new.precoitorc) - new.vlrdescitorc + vlripi;
    end

    if( adicfrete = 'S' ) then
    begin
       new.vlrliqitorc = new.vlrliqitorc + coalesce(new.vlrfreteitorc,0);
    end

    new.tipoorc = 'O';

    -- Garantindo a gravao da referncia do produto.

    if (new.refprod is null) then
    begin
        select p.refprod from eqproduto p
        where p.codprod=new.codprod and p.codemp=new.codemppd and p.codfilial=new.codfilialpd
        into refprod;

        new.refprod = refprod;
    end

    -- Atualizando a tabela de oramento

    update vdorcamento o set o.vlrdescitorc=o.vlrdescitorc + new.vlrdescitorc,
                             o.vlrprodorc = o.vlrprodorc + new.vlrproditorc,
                             o.vlrliqorc = o.vlrliqorc + new.vlrliqitorc
    where o.codorc=new.codorc and o.tipoorc=new.tipoorc and o.codemp=new.codemp and o.codfilial=new.codfilial;

  end
end ^

CREATE OR ALTER TRIGGER VDITORCAMENTOTGAI FOR VDITORCAMENTO 
ACTIVE AFTER INSERT POSITION 0 
AS
    declare variable visualizalucr char(1);
    declare variable custopeps numeric(15, 5);
    declare variable custompm numeric(15, 5);
    declare variable custouc numeric(15, 5);
begin
  if ( ( new.emmanut is null ) or ( new.emmanut='N' ) ) then
  begin
    -- Carregamento de preferencias
    select visualizalucr from sgprefere1 where codemp=new.codemp and codfilial = new.codfilial
    into :visualizalucr;

    -- Salvamento de custos no momento do oramento
    if( visualizalucr = 'S' ) then
    begin
        -- Busca do custo da ultima compra;
        select custounit from eqcustoprodsp(new.codemppd, new.codfilialpd, new.codprod,
            new.dtins,'U',new.codempax, new.codfilialax, new.codalmox,'N')
        into :custouc;

        -- Busca do custo mdio (MPM)
        select custounit from eqcustoprodsp(new.codemppd, new.codfilialpd, new.codprod,
            new.dtins,'M',new.codempax, new.codfilialax, new.codalmox,'N')
        into :custompm;

        -- Busca do custo peps
        select custounit from eqcustoprodsp(new.codemppd, new.codfilialpd, new.codprod,
            new.dtins,'P',new.codempax, new.codfilialax, new.codalmox,'N')
        into :custopeps;

        -- Inserindo registro na tabela de custos de item de venda
        insert into vditcustoorc (codemp,codfilial,codorc,tipoorc,coditorc,vlrprecoultcp, vlrcustompm, vlrcustopeps)
        values (new.codemp,new.codfilial,new.codorc,new.tipoorc,new.coditorc,:custouc,:custompm,:custopeps);

        -- Buscando e inserindo previso de tributos
        insert into vdprevtribitorc(codemp, codfilial, codorc, tipoorc, coditorc,
        vlricmsitorc, vlripiitorc, vlrpisitorc, vlrcofinsitorc, vlriritorc, vlrcsocialitorc, vlrissitorc)
        select new.codemp, new.codfilial, new.codorc, new.tipoorc, new.coditorc,
        vlricms, vlripi, vlrpis, vlrcofins, vlrir, vlrcsocial, vlriss
        from lfbuscaprevtriborc(new.codemp, new.codfilial, new.codorc, new.tipoorc, new.coditorc);

    end
  end
end ^

CREATE TRIGGER VDITORCAMENTOTGBU FOR VDITORCAMENTO 
ACTIVE BEFORE UPDATE POSITION 0 
as
    declare variable adicfrete char(1);
    declare variable tipoprod varchar(2);
    declare variable encorcprod char(1);
    declare variable vlripi decimal(15,5);
    declare variable contribipi char(1);

begin
    if ( new.emmanut is null) then
        new.emmanut='N';

    if(old.aprovitorc!=new.aprovitorc and new.aprovitorc='S') then -- Na aprovao do item de oramento
    begin
        new.statusitorc='OL';
        new.dtaprovitorc=cast('today' as date);

        if((new.qtdaprovitorc is null) or (new.qtdaprovitorc=0)) then
        begin
            new.qtdaprovitorc=new.qtditorc;
        end
    end
    else if(new.cancitorc='S' or new.statusitorc='CA' ) then
    begin
        new.aceiteitorc = 'N';
        new.aprovitorc = 'N';
        new.qtdaprovitorc = 0;
        new.statusitorc = 'CA';
        new.cancitorc = 'S';
    end
    
    new.qtdafatitorc = new.qtditorc - new.qtdfatitorc;
    
    if ( not ( (new.emmanut='S') or ( (old.emmanut='S') and (old.emmanut is not null) )) ) then
    begin

        new.dtalt = cast('now' as date);
        new.halt = cast('now' as time);
        new.idusualt = user;
        
        select fi.contribipifilial from sgfilial fi where fi.codemp=new.codemp and fi.codfilial=new.codfilial
        into contribipi;

        if(contribipi = 'S') then
        begin
            select pt.vlripiitorc from vdprevtribitorc pt
            where pt.codemp=new.codemp and pt.codfilial=new.codfilial and pt.codorc=new.codorc and pt.tipoorc=new.tipoorc
            and pt.coditorc=new.coditorc
            into vlripi;
        end

        -- Garantindo valor vlido para IPI
        if (vlripi is null) then vlripi = 0;

        if (new.qtdfatitorc>0) then
        begin
           if (new.qtdfatitorc<new.qtditorc) then
           begin
              new.fatitorc = 'P';
           end
           else
           begin
              new.fatitorc = 'S';
           end
        end
        else 
        begin
           new.fatitorc = 'N';
        end

        select adicfrete from vdorcamento
        where codemp=new.codemp and codfilial=new.codfilial and codorc=new.codorc and tipoorc=new.tipoorc
        into adicfrete;

        if (new.vlrproditorc is null) then new.vlrproditorc = 0;
        if (new.vlrdescitorc is null) then new.vlrdescitorc = 0;
        if (new.vlrliqitorc is null) then new.vlrliqitorc = 0;

        new.vlrliqitorc = (new.qtditorc * new.precoitorc) - new.vlrdescitorc + :vlripi;

        if( adicfrete = 'S' ) then
        begin
            new.vlrliqitorc = new.vlrliqitorc + coalesce(new.vlrfreteitorc,0);
        end

        -- Buscando nas preferencias de deve encaminhar oramento para a produo.
        select coalesce(p1.encorcprod,'N') from sgprefere1 p1
        where p1.codemp=new.codemp and p1.codfilial=new.codfilial
        into :encorcprod;
    
    
        -- Se for produto acabado e encaminhamento pull definido nas preferencias e item for aprovado dever sinalizar item para produo.
    
        if(new.statusitorc!=old.statusitorc and new.statusitorc='OL' and :encorcprod='S') then
        begin
    
            select tipoprod from eqproduto pd where pd.codemp=new.codemppd and pd.codfilial=new.codfilialpd and pd.codprod=new.codprod
            into :tipoprod;
    
            if(:tipoprod='F') then
            begin
                new.sitproditorc='PE';
            end
    
        end
    
        -- Atualiza status do item, quando produzido
        if( old.sitproditorc!=new.sitproditorc and new.sitproditorc='PD' ) then
        begin
           new.statusitorc = 'OP';
        end
        
    end

end ^

CREATE TRIGGER VDITORCAMENTOTGAU FOR VDITORCAMENTO 
ACTIVE AFTER UPDATE POSITION 0 
as
    declare variable visualizalucr char(1);
    declare variable custopeps numeric(15, 5);
    declare variable custompm numeric(15, 5);
    declare variable custouc numeric(15, 5);
    declare variable vlricmsitorc numeric(15,5);
    declare variable vlripiitorc numeric(15,5);
    declare variable vlrpisitorc numeric(15,5);
    declare variable vlrcofinsitorc numeric(15,5);
    declare variable vlriritorc numeric(15,5);
    declare variable vlrcsocialitorc numeric(15,5);
    declare variable vlrissitorc numeric(15,5);
    declare variable qtdstatusitem integer;
    declare variable qtdstatustot integer;
    declare variable tipoprod char(1);

begin
    if ( not ( (new.emmanut='S') or ( (old.emmanut='S') and (old.emmanut is not null) ) ) ) then
    begin

    if (old.vlrdescitorc<>new.vlrdescitorc
        or old.vlrproditorc<>new.vlrproditorc
        or old.vlrliqitorc<>new.vlrliqitorc ) then
    begin
      update vdorcamento set
        VLRDESCITORC = VLRDESCITORC - old.VLRDESCITORC + new.VLRDESCITORC,
        VLRPRODORC = VLRPRODORC - old.VLRPRODITORC + new.VLRPRODITORC,
        VLRLIQORC = VLRLIQORC - old.VLRLIQITORC + new.VLRLIQITORC
        where CODORC=new.CODORC and TIPOORC='O' and CODEMP=new.CODEMP and CODFILIAL=new.CODFILIAL;
    end

    -- Carregamento de preferencias
    select visualizalucr from sgprefere1 where codemp=new.codemp and codfilial = new.codfilial
    into :visualizalucr;

    if( visualizalucr = 'S' ) then
    begin
            select tipoprod from eqproduto where codemp=new.codemppd and codfilial=new.codfilialpd
               and codprod=new.codprod
            into :tipoprod;

            if (tipoprod='P') then
            begin

               -- Busca do custo da ultima compra;
               select custounit from eqcustoprodsp(new.codemppd, new.codfilialpd, new.codprod,
                   new.dtins,'U',new.codempax, new.codfilialax, new.codalmox,'N')
               into :custouc;

               -- Busca do custo mdio (MPM)
               select custounit from eqcustoprodsp(new.codemppd, new.codfilialpd, new.codprod,
                   new.dtins,'M',new.codempax, new.codfilialax, new.codalmox,'N')
               into :custompm;

               -- Busca do custo peps
               select custounit from eqcustoprodsp(new.codemppd, new.codfilialpd, new.codprod,
                   new.dtins,'P',new.codempax, new.codfilialax, new.codalmox,'N')
               into :custopeps;

               -- Atualizando registro na tabela de custos de item de oramento

               update vditcustoorc ico set vlrprecoultcp=:custouc, vlrcustompm=:custompm, vlrcustopeps=:custopeps
                   where ico.codemp=new.codemp and ico.codfilial=new.codfilial and ico.codorc=new.codorc
                   and ico.tipoorc=new.tipoorc and ico.coditorc=new.coditorc
                   -- Condio inserida para evitar cascade quando no for necessrio
                   and (vlrprecoultcp<>:custouc or vlrcustompm<>:custompm or vlrcustopeps<>:custopeps ) ;

            end 

            -- Buscando e inserindo previso de tributos
            select vlricms, vlripi, vlrpis, vlrcofins, vlrir, vlrcsocial, vlriss
            from lfbuscaprevtriborc(new.codemp, new.codfilial, new.codorc, new.tipoorc, new.coditorc)
            into :vlricmsitorc, :vlripiitorc, :vlrpisitorc, :vlrcofinsitorc, :vlriritorc, :vlrcsocialitorc, :vlrissitorc;

            update vdprevtribitorc po set
            po.vlricmsitorc=:vlricmsitorc, po.vlripiitorc=:vlripiitorc, po.vlrpisitorc=:vlrpisitorc,
            po.vlrcofinsitorc=:vlrcofinsitorc, po.vlriritorc=:vlriritorc, po.vlrcsocialitorc=:vlrcsocialitorc,
            po.vlrissitorc=:vlrissitorc
            where po.codemp=new.codemp and po.codfilial=new.codfilial and po.codorc=new.codorc
            and po.tipoorc=new.tipoorc and po.coditorc=new.coditorc
             -- Condio inserida para evitar cascade quando no for necessrio
             and ( po.vlricmsitorc<>:vlricmsitorc or po.vlripiitorc<>:vlripiitorc
              or po.vlrpisitorc<>:vlrpisitorc or po.vlrcofinsitorc<>:vlrcofinsitorc
              or po.vlriritorc<>:vlriritorc or po.vlrcsocialitorc<>:vlrcsocialitorc
              or po.vlrissitorc<>:vlrissitorc )
            ;

       end

       -- Se o status foi alterado para Aprovado (OL), deve atualizar o status das ordens de servio vinculadas
       -- para OA (Oramento aprovado)
       if(new.statusitorc!=old.statusitorc and new.statusitorc='OL' ) then
       begin
            update eqitrecmercitositorc ios set ios.status='OA'
            where ios.codempoc=new.codemp and ios.codfilialoc=new.codfilial and ios.codorc=new.codorc
            and ios.tipoorc=new.tipoorc and ios.coditorc=new.coditorc
            and ios.status<>'OA';
       end

       -- Contando a quantidade de itens do oramento com o status do item atual
       select count(*) from vditorcamento
       where CODORC=new.CODORC and TIPOORC=new.tipoorc and CODEMP=new.CODEMP and CODFILIAL=new.CODFILIAL and statusitorc=new.statusitorc
       into :qtdstatusitem;

       -- Contando a quantidade de itens total do oramento
       select count(*) from vditorcamento
       where CODORC=new.CODORC and TIPOORC=new.tipoorc and CODEMP=new.CODEMP and CODFILIAL=new.CODFILIAL 
       into :qtdstatustot;

       -- Se todos os itens do oramento tem o mesmo status, deve ataulizar o status do cabealho do oramento;
       if(:qtdstatusitem > 0 and :qtdstatusitem = :qtdstatustot) then
       begin
            update vdorcamento set statusorc=new.statusitorc
            where CODORC=new.CODORC and TIPOORC=new.tipoorc and CODEMP=new.CODEMP and CODFILIAL=new.CODFILIAL
            and statusorc<>new.statusitorc;
       end

    end
end ^

CREATE TRIGGER VDITORCAMENTOTGAD FOR VDITORCAMENTO 
ACTIVE AFTER DELETE POSITION 0 
AS
BEGIN
  IF ( not ( (old.EMMANUT='S') and (old.EMMANUT IS NOT NULL) ) ) THEN
  BEGIN

    UPDATE VDORCAMENTO SET VLRDESCITORC = VLRDESCITORC -old.VLRDESCITORC,
         VLRPRODORC = VLRPRODORC - old.VLRPRODITORC,
         VLRLIQORC = VLRLIQORC - old.VLRLIQITORC
         WHERE CODORC=old.CODORC AND TIPOORC=old.tipoorc AND
         CODEMP=old.CODEMP AND CODFILIAL=old.CODFILIAL;
  END
END ^

CREATE TRIGGER VDITROMANEIOTGBU FOR VDITROMANEIO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER VDITVENDATGBI FOR VDITVENDA 
ACTIVE BEFORE INSERT POSITION 0 
as
    declare variable srefprod VARchar(20);
    declare variable stipoprod varchar(2);
    declare variable percicmsst numeric(9,2);
    declare variable percicms numeric(9,2);
    declare variable precocomisprod numeric(15,5);
    declare variable redfisc numeric(9,2);
    declare variable redbasest char(1);
    declare variable ufcli char(2);
    declare variable ufemp char(2);
    declare variable percicmscm numeric(9,2);
    declare variable codempcl integer;
    declare variable codfilialcl smallint;
    declare variable codcli integer;
    declare variable codemptm integer;
    declare variable codfilialtm smallint;
    declare variable codtipomov integer;

  --DECLARE VARIABLE V_CHAVE VARCHAR(500);
  --DECLARE VARIABLE V_RECURSIVO INTEGER;
BEGIN

  --V_CHAVE = 'VDITVENDATGBI'; -- Nome do objeto (trigger ou procedure) a controlar recursividade
  --V_CHAVE = V_CHAVE || '_' || IIF(INSERTING, 'INS', IIF(UPDATING, 'UPD', 'DEL')); -- tipo de evento
  --V_CHAVE = V_CHAVE || '_' || CAST(NEW.CODVENDA AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
  --V_CHAVE = V_CHAVE || '_' || CAST(NEW.CODITVENDA AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
  --V_CHAVE = V_CHAVE || '_' || CAST(NEW.TIPOVENDA AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
  --V_CHAVE = V_CHAVE || '_' || CAST(NEW.CODFILIAL AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
  --V_CHAVE = V_CHAVE || '_' || CAST(NEW.CODEMP AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria

  --EXECUTE PROCEDURE PRO_RECURSIVO(:V_CHAVE) RETURNING_VALUES (:V_RECURSIVO);

  /* Verifica se  uma chamada recursiva ou no, se no for continua */
  --IF (V_RECURSIVO = 0) THEN
  --BEGIN

        -- Inicializando campos nulos.
        if (new.vlrdescitvenda is null) then new.vlrdescitvenda = 0;
        if (new.vlrbaseicmsitvenda is null) then new.vlrbaseicmsitvenda = 0;
        if (new.vlricmsitvenda is null) then new.vlricmsitvenda = 0;
        if (new.vlrbaseipiitvenda is null) then new.vlrbaseipiitvenda = 0;
        if (new.vlripiitvenda is null) then new.vlripiitvenda = 0;
        if (new.vlrliqitvenda is null) then new.vlrliqitvenda = 0;
        if (new.vlrcomisitvenda is null) then new.vlrcomisitvenda = 0;
        if (new.vlradicitvenda is null) then new.vlradicitvenda = 0;
        if (new.vlrissitvenda is null) then new.vlrissitvenda = 0;
        if (new.vlrfreteitvenda is null) then new.vlrfreteitvenda = 0;
        if (new.tipovenda is null) then new.tipovenda = 'V';
        if (new.vlrbaseicmsstitvenda is null) then new.vlrbaseicmsstitvenda = 0;
        if (new.vlrbaseicmsstretitvenda is null) then new.vlrbaseicmsstretitvenda = 0;
        if (new.vlricmsstitvenda is null) then new.vlricmsstitvenda = 0;
        if (new.vlricmsstretitvenda is null) then new.vlricmsstretitvenda = 0;
        if (new.vlrbasecomisitvenda is null) then new.vlrbasecomisitvenda = 0;
        
        if (new.tipovenda='E') then
        begin
           --Busca cdigo do cliente e tipo de movimento para utilizar na procedure lfbuscafiscal.
           select vd.codempcl, vd.codfilialcl, vd.codcli, vd.codemptm,  vd.codfilialtm, vd.codtipomov from vdvenda vd
               where vd.codemp=new.codemp and vd.codfilial=new.codfilial and vd.tipovenda=new.tipovenda and vd.codvenda=new.codvenda
               into :codempcl, :codfilialcl, :codcli, :codemptm,  :codfilialtm, :codtipomov;
                
           select  codempif, codfilialif, codfisc, coditfisc from lfbuscafiscalsp(new.codemppd,new.codfilialpd,new.codprod,:codempcl,:codfilialcl,:codcli,
               :codemptm,  :codfilialtm, :codtipomov, 'VD',
               new.codnat, null, null, null, null)  v
               into new.codempif, new.codfilialif, new.codfisc, new.coditfisc;
               
        end 
        

        -- Calculando valor liquido do tem quando zerado.
        if (new.vlrliqitvenda = 0) then
            new.vlrliqitvenda = (new.qtditvenda * new.precoitvenda) +
                new.vlradicitvenda + new.vlrfreteitvenda - new.vlrdescitvenda;

        -- Carregando almoxarifado padro do produto
        if (new.codalmox is null) then
            select codempax, codfilialax, codalmox from eqproduto
                where codemp=new.codemppd and codfilial=new.codfilialpd and codprod=new.codprod
            into new.codempax, new.codfilialax,new.codalmox;

        -- Acertando o codigo de empresa e filial da mensagem, caso a mensagem seja informada.
        if (not new.codmens is null) then
        begin
            select icodfilial from sgretfilial(new.codemp,'LFMENSAGEM') into new.codfilialme;
            new.codempme = new.codemp;
        end

        -- Buscando referncia do produto
        select p.refprod, p.tipoprod, p.precocomisprod from eqproduto p
            where p.codemp=new.codemppd and p.codfilial = new.codfilialpd and p.codprod=new.codprod
        into srefprod, stipoprod, precocomisprod;

        -- Acertando referncia quando nula
        if (new.refprod is null) then new.refprod = srefprod;

          
        -- Se o item vendido seja um SERVIO (Calculo do ISS);
        if (stipoprod = 'S') then
        begin
            -- Carregando aliquota do ISS
            select first 1 coalesce(c.aliqissfisc, f.percissfilial)
            from sgfilial f
            left outer join lfitclfiscal c on
            c.codemp=new.codempif and c.codfilial=new.codfilialif and c.codfisc=new.codfisc and c.coditfisc=new.coditfisc
            where f.codemp=new.codemp and f.codfilial=new.codfilial
            into new.percissitvenda;

            -- Calculando e computando base e valor do ISS;
            if (new.percissitvenda != 0) then
            begin
                new.vlrbaseissitvenda = new.vlrliqitvenda;
                new.vlrissitvenda = new.vlrbaseissitvenda*(new.percissitvenda/100);
            end
        end
        else -- Se o item vendido no for SERVIO zera ISS
            new.vlrbaseissitvenda = 0;

        -- Se produto for isento de ICMS
        if (new.tipofisc = 'II') then
        begin
            new.vlrisentasitvenda = new.vlrliqitvenda;
            new.vlrbaseicmsitvenda = 0;
            new.percicmsitvenda = 0;
            new.vlricmsitvenda = 0;
            new.vlroutrasitvenda = 0;
        end
        -- Se produto for de Substituio Tributria
        else if (new.tipofisc = 'FF') then
        begin

           if (new.tipost = 'SI' ) then -- Contribuinte Substitudo
                begin
                    new.vlroutrasitvenda = new.vlrliqitvenda;
                    new.vlrbaseicmsitvenda = 0;
                    new.percicmsitvenda = 0;
                    new.vlricmsitvenda = 0;
                    new.vlrisentasitvenda = 0;

                      -- Buscando estado do cliente e da empresa

                    select coalesce(cl.siglauf,cl.ufcli), fi.siglauf from vdcliente cl, vdvenda vd, sgfilial fi
                    where vd.codemp=new.codemp and vd.codfilial=new.codfilial and vd.codvenda=new.codvenda and vd.tipovenda=new.tipovenda and
                    cl.codemp=vd.codempcl and cl.codfilial=vd.codfilialcl and cl.codcli=vd.codcli
                    and fi.codemp=new.codemp and fi.codfilial=new.codfilial
                    into ufcli, ufemp;

                    -- Buscando aliquota do ICMS ST da tabela de classificao fiscal
                    select coalesce(ic.aliqfiscintra,0),coalesce(ic.aliqfisc,0), coalesce(ic.redfisc,0), coalesce(ic.redbasest,'S') 
                    from lfitclfiscal ic
                    where ic.codemp=new.codempif and ic.codfilial=new.codfilialif and ic.codfisc=new.codfisc and ic.coditfisc=new.coditfisc
                    into percicmsst, percicms, redfisc, redbasest;

                    -- Buscando aliquota do ICMS ST da tabela de alquotas (caso no encontre na busca anterior)
                    if (percicmsst = 0) then
                    begin
                        select coalesce(PERCICMSINTRA,0),coalesce(PERCICMS,0) from lfbuscaicmssp (new.codnat,:ufemp,new.codemp,new.codfilial)
                        into PERCICMSST, percicms;
                    end


                        if(redfisc>0 and redbasest='S') then
                        begin
    
                            -- Quando h reduo na base do icms st , deve usar o valor da base do icms proprio como parametro
    
                            new.vlrbaseicmsstretitvenda = ( (new.vlrproditvenda - new.vlrdescitvenda + new.vlripiitvenda )  / (1+(new.margemvlagritvenda / 100.00))) * (1-(redfisc/100.00)) ;
                            new.vlricmsstretitvenda = ((new.vlrproditvenda - new.vlrdescitvenda + new.vlripiitvenda ) * (:percicmsst / 100.00)) - (new.vlrbaseicmsstretitvenda * (:percicms/100.00));
    
                        end
                        else
                        begin
    
                            -- Quando no h reduo na base do icms st deve usar o valor da base bruto (rem reduo)
                            new.vlrbaseicmsstretitvenda = ( (new.vlrproditvenda - new.vlrdescitvenda + new.vlripiitvenda )  / (1+(new.margemvlagritvenda / 100.00))) ;
                            new.vlricmsstretitvenda = ((new.vlrproditvenda - new.vlrdescitvenda + new.vlripiitvenda ) * (:percicmsst / 100.00)) - (new.vlrbaseicmsstretitvenda * (:percicms/100.00));
    
                        end
                     end



            
            else if (new.tipost = 'SU' ) then -- Contribuinte Substituto
            begin
                percicmscm = 0.00;

                -- Buscando estado do cliente

                select coalesce(cl.siglauf,cl.ufcli) from vdcliente cl, vdvenda vd
                where vd.codemp=new.codemp and vd.codfilial=new.codfilial and vd.codvenda=new.codvenda and vd.tipovenda=new.tipovenda and
                cl.codemp=vd.codempcl and cl.codfilial=vd.codfilialcl and cl.codcli=vd.codcli
                into ufcli;

                -- Buscando aliquota do ICMS ST da tabela de classificao fiscal
                select coalesce(ic.aliqfiscintra,0), coalesce(ic.redfisc,0), coalesce(ic.redbasest,'S'), coalesce(ic.aliqicmsstcm,0.00) 
                from lfitclfiscal ic
                where ic.codemp=new.codempif and ic.codfilial=new.codfilialif and ic.codfisc=new.codfisc and ic.coditfisc=new.coditfisc
                into percicmsst, redfisc, redbasest, percicmscm  ;
                -- Buscando aliquota do ICMS ST da tabela de alquotas (caso no encontre na busca anterior)
                if (percicmsst = 0) then
                begin
                    select coalesce(PERCICMSINTRA,0) from lfbuscaicmssp (new.codnat,:ufcli,new.codemp,new.codfilial)
                    into PERCICMSST;
                end
                if(new.calcstcm = 'N') then
                begin

                    if(redfisc>0 and redbasest='S') then
                    begin
                        -- Quando h reduo na base do icms st , deve usar o valor da base do icms proprio como parametro
                        new.vlrbaseicmsstitvenda = (  (coalesce(new.margemvlagritvenda,0) + 100) / 100 )  * (  (coalesce(new.vlrbaseicmsitvenda,0) ) + (coalesce(new.vlripiitvenda,0)) );
    
                    end
                    else
                    begin
                        -- Quando no h reduo na base do icms st deve usar o valor da base bruto (rem reduo)
                        new.vlrbaseicmsstitvenda = (  (coalesce(new.margemvlagritvenda,0) + 100) / 100 )  * (  (coalesce(new.vlrbaseicmsbrutitvenda,0) ) + (coalesce(new.vlripiitvenda,0)) );
                    end
                    new.vlricmsstitvenda = ( (new.vlrbaseicmsstitvenda * :percicmsst) / 100 ) - (new.vlricmsitvenda) ;
                 end
                 else
                 begin
                    if(redfisc>0 and redbasest='S') then
                    begin

                         -- Quando h reduo na base do icms st , deve usar o valor da base do icms proprio como parametro
                         new.vlrbaseicmsstitvenda =   (new.vlricmsitvenda + ( (coalesce(new.vlrbaseicmsitvenda,0) + coalesce(new.vlripiitvenda,0) ) * (coalesce(percicmscm,0)/100) ))/(:PERCICMSST/100);
                    end
                    else
                    begin
                         new.vlrbaseicmsstitvenda =   (new.vlricmsitvenda + ( (coalesce(new.vlrbaseicmsbrutitvenda,0) + coalesce(new.vlripiitvenda,0) ) * (coalesce(percicmscm,0)/100) ))/(:PERCICMSST/100);
                    end
                         new.vlroutrasitvenda = 0;
                         new.vlrisentasitvenda = 0;
                         new.vlricmsstitvenda =  ( (coalesce(new.vlrbaseicmsitvenda,0) + coalesce(new.vlripiitvenda,0) ) * (coalesce(percicmscm,0)/100)  );
                 end
        end
        end
        -- Se produto no for tributado e no isento
        else if (new.tipofisc = 'NN') then
        begin
            new.vlroutrasitvenda = new.vlrliqitvenda;
            new.vlrbaseicmsitvenda = 0;
            new.percicmsitvenda = 0;
            new.vlricmsitvenda = 0;
            new.vlrisentasitvenda = 0;
        end
        -- Se produto for tributado integralmente
        else if (new.tipofisc = 'TT') then
        begin
            new.vlroutrasitvenda = 0;
            new.vlrisentasitvenda = 0;
        end

        -- Gerando preo especial para comissionamento
        if(precocomisprod is not null) then
        begin

            new.vlrbasecomisitvenda = new.qtditvenda * precocomisprod;

        end

        -- Atualizao de totais no cabealho da venda

        update vdvenda vd set vd.vlrdescitvenda = vd.vlrdescitvenda + new.vlrdescitvenda,
            vd.vlrprodvenda = vd.vlrprodvenda + new.vlrproditvenda,
            vd.vlrbaseicmsvenda = vd.vlrbaseicmsvenda + new.vlrbaseicmsitvenda,
            vd.vlricmsvenda = vd.VLRICMSVENDA + new.vlricmsitvenda,
            vd.vlrisentasvenda = vd.VLRISENTASVENDA + new.vlrisentasitvenda,
            vd.vlroutrasvenda = vd.VLROUTRASVENDA + new.vlroutrasitvenda,
            vd.vlrbaseipivenda = vd.VLRBASEIPIVENDA + new.vlrbaseipiitvenda,
            vd.vlripivenda = vd.VLRIPIVENDA + new.vlripiitvenda,
            vd.vlrliqvenda = vd.VLRLIQVENDA + new.vlrliqitvenda,
            vd.vlrbaseissvenda = vd.VLRBASEISSVENDA + new.vlrbaseissitvenda,
            vd.vlrissvenda = vd.VLRISSVENDA + new.vlrissitvenda,
            vd.vlrcomisvenda = vd.VLRCOMISVENDA + new.vlrcomisitvenda,
            vd.vlrbaseicmsstvenda = coalesce(vd.vlrbaseicmsstvenda,0) + new.vlrbaseicmsstitvenda,
            vd.vlricmsstvenda = coalesce(vd.vlricmsstvenda,0) + new.vlricmsstitvenda,
            vd.vlrbasecomis = coalesce(vd.vlrbasecomis, 0) + new.vlrbasecomisitvenda
         where vd.codvenda=new.codvenda and vd.tipovenda=new.tipovenda and
            vd.codemp=new.codemp and vd.codfilial=new.codfilial;


  --END

end ^

CREATE TRIGGER VDITVENDATGAI FOR VDITVENDA 
ACTIVE AFTER INSERT POSITION 0 
as
    declare variable dtvenda date ;
    declare variable flag char(1);
    declare variable docvenda integer;
    declare variable codemptm integer;
    declare variable codfilialtm smallint;
    declare variable codtipomov integer;
    declare variable preco numeric(15, 5);
    declare variable visualizalucr char(1);
    declare variable custopeps numeric(15, 5);
    declare variable custompm numeric(15, 5);
    declare variable custouc numeric(15, 5);
    declare variable subtipovenda char(2);
    declare variable estoqtipomovpd char(1);

  --DECLARE VARIABLE V_CHAVE VARCHAR(500);
  --DECLARE VARIABLE V_RECURSIVO INTEGER;
BEGIN

  --V_CHAVE = 'VDITVENDATGAI'; -- Nome do objeto (trigger ou procedure) a controlar recursividade
  --V_CHAVE = V_CHAVE || '_' || IIF(INSERTING, 'INS', IIF(UPDATING, 'UPD', 'DEL')); -- tipo de evento
  --V_CHAVE = V_CHAVE || '_' || CAST(NEW.CODVENDA AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
  --V_CHAVE = V_CHAVE || '_' || CAST(NEW.CODITVENDA AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
  --V_CHAVE = V_CHAVE || '_' || CAST(NEW.TIPOVENDA AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
  --V_CHAVE = V_CHAVE || '_' || CAST(NEW.CODFILIAL AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
  --V_CHAVE = V_CHAVE || '_' || CAST(NEW.CODEMP AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria

  --EXECUTE PROCEDURE PRO_RECURSIVO(:V_CHAVE) RETURNING_VALUES (:V_RECURSIVO);

  /* Verifica se  uma chamada recursiva ou no, se no for continua */
  --IF (V_RECURSIVO = 0) THEN
  --BEGIN

    estoqtipomovpd = 'S';
    
    -- Carregamento de preferencias
    select visualizalucr from sgprefere1 where codemp=new.codemp and codfilial = new.codfilial
    into :visualizalucr;

    -- Carregamento de informaes do cabealho da venda
    select vd.dtemitvenda, vd.flag, vd.docvenda, vd.codemptm, vd.codfilialtm, vd.codtipomov, vd.subtipovenda
        from eqtipomov tm, vdvenda vd
        where
            tm.codemp=vd.codemptm and tm.codfilial=vd.codfilialtm and tm.codtipomov=vd.codtipomov and
            vd.codemp=new.codemp and vd.codfilial=new.codfilial and vd.tipovenda=new.tipovenda and vd.codvenda=new.codvenda
    into :dtvenda, :flag, :docvenda, :codemptm, :codfilialtm, :codtipomov, :subtipovenda;

    if ( (subtipovenda is not null) and (subtipovenda='NC')) then
       estoqtipomovpd='N';
       
    -- Inicializando preco do item
    if (new.qtditvenda != 0 ) then
        preco = new.vlrliqitvenda/new.qtditvenda;
    else
        preco = new.precoitvenda;

    -- Executando movimentao do estoque
    execute procedure eqmovprodiudsp(
        'I', new.codemppd, new.codfilialpd, new.codprod,new.codemple, new.codfilialle, new.codlote, :codemptm, :codfilialtm,
        :codtipomov, null, null, null, null, null, null, null, new.codemp, new.codfilial, new.tipovenda, new.codvenda, new.coditvenda,
        null, null, null, null,null,null,null, null, null, new.codempnt, new.codfilialnt, new.codnat,:dtvenda, :docvenda, :flag, new.qtditvenda, :preco,
        new.codempax, new.codfilialax, new.codalmox, null, :estoqtipomovpd, 'N'
    );

    -- Salvamento de custos no momento da venda
    if( visualizalucr = 'S' ) then
    begin
        -- Busca do custo da ultima compra;
        select custounit from eqcustoprodsp(new.codemppd, new.codfilialpd, new.codprod,
            new.dtins,'U',new.codempax, new.codfilialax, new.codalmox,'N')
        into :custouc;

        -- Busca do custo mdio (MPM)
        select custounit from eqcustoprodsp(new.codemppd, new.codfilialpd, new.codprod,
            new.dtins,'M',new.codempax, new.codfilialax, new.codalmox,'N')
        into :custompm;

        -- Busca do custo peps
        select custounit from eqcustoprodsp(new.codemppd, new.codfilialpd, new.codprod,
            new.dtins,'P',new.codempax, new.codfilialax, new.codalmox,'N')
        into :custopeps;

        -- Inserindo registro na tabela de custos de item de venda
        insert into vditcustovenda (codemp,codfilial,codvenda,tipovenda,coditvenda,vlrprecoultcp, vlrcustompm, vlrcustopeps)
        values (new.codemp,new.codfilial,new.codvenda,new.tipovenda,new.coditvenda,:custouc,:custompm,:custopeps);

    end

     -- Executa procedure de gerao de tabela de vinculo para numeros de serie

    execute procedure vditvendaseriesp('I', new.codemp, new.codfilial, new.codvenda, new.tipovenda, new.coditvenda, new.codemppd, new.codfilialpd, new.codprod, new.numserietmp, new.qtditvenda);

    -- Inserindo registros na tabela de informaes fiscais complementares (LFITVENDA)

    execute procedure lfgeralfitvendasp(new.codemp, new.codfilial, new.codvenda, new.tipovenda, new.coditvenda);

    -- Inserindo registro na tabela de vinculo entre compras e vendas (devoluo)

    if(new.codcompra is not null and new.coditcompra is not null) then
    begin
        insert into cpdevolucao
            (codemp, codfilial, codcompra, coditcompra, qtddev,
             codempvd, codfilialvd, codvenda, tipovenda, coditvenda )
        values
            (new.codempcp, new.codfilialcp, new.codcompra, new.coditcompra,new.qtditvenda,
             new.codemp, new.codfilial,new.codvenda, new.tipovenda, new.coditvenda);
    end

    execute procedure cpgeradevolucaosp (
    new.codempcp,new.codfilialcp, new.codcompra, new.coditcompra, new.codemp, new.codfilial,
    new.codvenda, new.coditvenda, new.tipovenda, new.qtditvenda);

  --END
  
end ^

CREATE TRIGGER VDITVENDATGBU FOR VDITVENDA 
ACTIVE BEFORE UPDATE POSITION 0 
as
    declare variable srefprod VARchar(20);
    declare variable stipoprod varchar(2);
    declare variable ntmp numeric(15, 5);
    declare variable precocomisprod numeric(15, 5);
    declare variable percicmsst numeric(9,2);
    declare variable percicms numeric(9,2);
    declare variable ufcli char(2);
    declare variable ufemp char(2);
    declare variable redbasest char(1);
    declare variable redfisc numeric(9,2);
    declare variable codfilialpf smallint;
    declare variable fatorcparc char(1);
    declare variable percicmscm numeric(9,2);

  --DECLARE VARIABLE V_CHAVE VARCHAR(500);
  --DECLARE VARIABLE V_RECURSIVO INTEGER;
BEGIN

  --V_CHAVE = 'VDITVENDATGBU'; -- Nome do objeto (trigger ou procedure) a controlar recursividade
  --V_CHAVE = V_CHAVE || '_' || IIF(INSERTING, 'INS', IIF(UPDATING, 'UPD', 'DEL')); -- tipo de evento
  --V_CHAVE = V_CHAVE || '_' || CAST(NEW.CODVENDA AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
  --V_CHAVE = V_CHAVE || '_' || CAST(NEW.CODITVENDA AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
  --V_CHAVE = V_CHAVE || '_' || CAST(NEW.TIPOVENDA AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
  --V_CHAVE = V_CHAVE || '_' || CAST(NEW.CODFILIAL AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
  --V_CHAVE = V_CHAVE || '_' || CAST(NEW.CODEMP AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria

  --EXECUTE PROCEDURE PRO_RECURSIVO(:V_CHAVE) RETURNING_VALUES (:V_RECURSIVO);

  /* Verifica se  uma chamada recursiva ou no, se no for continua */
  --IF (V_RECURSIVO = 0) THEN
  --BEGIN

        percicmscm = 0.00;


        -- Verifica se tabela est em manuteno // caso no esteja inicia procedimentos
        if ( new.emmanut is null) then
            new.emmanut='N';

        if ( not ( (new.emmanut='S') or ( (old.emmanut='S') and (old.emmanut is not null) )) ) then
        begin

            -- Computando campos de log
            new.dtalt=cast('now' as date);
            new.idusualt=user;
            new.halt = cast('now' as time);

            -- Verifica se o produto foi alterado
            if (new.codprod != old.codprod) then
                exception vditvendaex01;

            -- Verifica se o lote foi alterado
            if (new.codlote != old.codlote) then
                exception vditvendaex02;

            -- Verifica se o cdigo do almoxarifa est nuloo, se estiver carrega o almoxarifado padro do produto
            if (new.codalmox is null) then
            begin
                select codempax,codfilialax,codalmox from eqproduto
                where codemp=new.codemppd and codfilial=new.codfilialpd and codprod=new.codprod
                into new.codempax, new.codfilialax,new.codalmox;
            end

            -- Verifica se o almoxarifado anterior estava nulo, se no informa que no  pode ser trocado
            if (old.codalmox is not null) then
            begin
                if (old.codalmox != new.codalmox) then
                    exception eqalmox01;
            end

            -- Carrega a referencia e tipo do produto
            select refprod, tipoprod, precocomisprod
            from eqproduto where codprod=new.codprod and codemp=new.codemppd and codfilial=new.codfilialpd
            into srefprod, stipoprod, precocomisprod;

            if (new.refprod is null) then new.refprod = srefprod;

            -- Caso a nota tenha sido cancelada
            if ( (new.cancitvenda is not null) and (new.cancitvenda = 'S') ) then
            begin
                new.qtditvenda = 0;
                new.vlrliqitvenda = 0;
                new.vlrproditvenda = 0;
                new.vlrbaseicmsitvenda = 0;
                new.vlrbaseipiitvenda = 0;
                new.vlrdescitvenda = 0;
            end

            -- Calculando o valor liquido o tem
            if ( (new.vlrliqitvenda = 0) and ( (new.cancitvenda is null) or (new.cancitvenda!='S') ) ) then
            begin
                new.vlrliqitvenda = (new.qtditvenda * new.precoitvenda) + new.vlradicitvenda + new.vlrfreteitvenda - new.vlrdescitvenda;
            end
            else if (new.vlrdescitvenda > 0 and new.qtditvenda > 0) then
            begin
                ntmp = new.vlrliqitvenda/new.qtditvenda;
                ntmp = ntmp * new.qtditvenda;
                new.vlrdescitvenda = new.vlrdescitvenda + (new.vlrliqitvenda-ntmp);

                -- Recalculando comisso sobre o tem
                new.vlrcomisitvenda = (new.perccomisitvenda * new.vlrliqitvenda ) / 100;
            end
            if ( (old.qtditvenda<>new.qtditvenda) and (new.qtditvenda<>0) ) then
            begin
               select icodfilial from sgretfilial(old.codemp,'SGPREFERE1') into :codfilialpf; 
               select fatorcparc from sgprefere1 p 
                    where p.codemp=old.codemp and p.codfilial=:codfilialpf
                 into :fatorcparc;
               if (fatorcparc='S') then
               begin
                  exception vditvendaex05;
               end 
            end
            -- Ser for um servio
            if (stipoprod = 'S') then
            begin
                -- Calculo do ISS
                select first 1 coalesce(c.aliqissfisc, f.percissfilial)
                from sgfilial f
                left outer join lfitclfiscal c on
                c.codemp=new.codempif and c.codfilial=new.codfilialif and c.codfisc=new.codfisc and c.coditfisc=new.coditfisc
                where f.codemp=new.codemp and f.codfilial=new.codfilial
                into new.percissitvenda;

                if (new.percissitvenda != 0) then
                begin
                    new.vlrbaseissitvenda = new.vlrliqitvenda;
                    new.vlrissitvenda = new.vlrbaseissitvenda * (new.percissitvenda/100);
                end
            end
            else
                new.vlrbaseissitvenda = 0;

            -- tem isento
            if (new.tipofisc = 'II') then
            begin
                new.vlrisentasitvenda = new.vlrliqitvenda;
                new.vlrbaseicmsitvenda = 0;
                new.percicmsitvenda = 0;
                new.vlricmsitvenda = 0;
                new.vlroutrasitvenda = 0;
            end
            -- Item com substituio tributria
            else if (new.tipofisc = 'FF') then
            begin
                if (new.tipost = 'SI' ) then -- Contribuinte Substitudo
                begin
                    new.vlroutrasitvenda = new.vlrliqitvenda;
                    new.vlrbaseicmsitvenda = 0;
                    new.percicmsitvenda = 0;
                    new.vlricmsitvenda = 0;
                    new.vlrisentasitvenda = 0;

                      -- Buscando estado do cliente e da empresa

                    select coalesce(cl.siglauf,cl.ufcli), fi.siglauf from vdcliente cl, vdvenda vd, sgfilial fi
                    where vd.codemp=new.codemp and vd.codfilial=new.codfilial and vd.codvenda=new.codvenda and vd.tipovenda=new.tipovenda and
                    cl.codemp=vd.codempcl and cl.codfilial=vd.codfilialcl and cl.codcli=vd.codcli
                    and fi.codemp=new.codemp and fi.codfilial=new.codfilial
                    into ufcli, ufemp;

                    -- Buscando aliquota do ICMS ST da tabela de classificao fiscal
                    select coalesce(ic.aliqfiscintra,0),coalesce(ic.aliqfisc,0), coalesce(ic.redfisc,0), coalesce(ic.redbasest,'S') 
                    from lfitclfiscal ic
                    where ic.codemp=new.codempif and ic.codfilial=new.codfilialif and ic.codfisc=new.codfisc and ic.coditfisc=new.coditfisc
                    into percicmsst, percicms, redfisc, redbasest ;

                    -- Buscando aliquota do ICMS ST da tabela de alquotas (caso no encontre na busca anterior)
                    if (percicmsst = 0) then
                    begin
                        select coalesce(PERCICMSINTRA,0),coalesce(PERCICMS,0) from lfbuscaicmssp (new.codnat,:ufemp,new.codemp,new.codfilial)
                        into PERCICMSST, percicms;
                    end

                    if(redfisc>0 and redbasest='S') then
                    begin

                        -- Quando h reduo na base do icms st , deve usar o valor da base do icms proprio como parametro

                        new.vlrbaseicmsstretitvenda = ( (new.vlrproditvenda - new.vlrdescitvenda + new.vlripiitvenda )  / (1+(new.margemvlagritvenda / 100.00))) * (1-(redfisc/100.00)) ;
                        new.vlricmsstretitvenda = ((new.vlrproditvenda - new.vlrdescitvenda + new.vlripiitvenda ) * (:percicmsst / 100.00)) - (new.vlrbaseicmsstretitvenda * (:percicms/100.00));

                    end
                    else
                    begin

                        -- Quando no h reduo na base do icms st deve usar o valor da base bruto (rem reduo)
                        new.vlrbaseicmsstretitvenda = ( (new.vlrproditvenda - new.vlrdescitvenda + new.vlripiitvenda )  / (1+(new.margemvlagritvenda / 100.00))) ;
                        new.vlricmsstretitvenda = ((new.vlrproditvenda - new.vlrdescitvenda + new.vlripiitvenda ) * (:percicmsst / 100.00)) - (new.vlrbaseicmsstretitvenda * (:percicms/100.00));

                    end
    

                end
                else if (new.tipost = 'SU' ) then -- Contribuinte Substituto
                begin
                     -- Buscando estado do cliente
                    select coalesce(cl.siglauf,cl.ufcli) from vdcliente cl, vdvenda vd
                    where vd.codemp=new.codemp and vd.codfilial=new.codfilial and vd.codvenda=new.codvenda and vd.tipovenda=new.tipovenda and
                    cl.codemp=vd.codempcl and cl.codfilial=vd.codfilialcl and cl.codcli=vd.codcli
                    into ufcli;

                   -- Buscando aliquota do ICMS ST da tabela de classificao fiscal
                    select coalesce(ic.aliqfiscintra,0), ic.redbasest, ic.redfisc, coalesce(ic.aliqicmsstcm,0.00)
                    from lfitclfiscal ic
                    where ic.codemp=new.codempif and ic.codfilial=new.codfilialif and ic.codfisc=new.codfisc and ic.coditfisc=new.coditfisc
                    into PERCICMSST,redbasest, redfisc, percicmscm;

                    -- Buscando aliquota do ICMS ST da tabela de alquotas (caso no encontre na busca naterior)
                    if (percicmsst = 0) then
                    begin
                        select coalesce(PERCICMSINTRA,0) from lfbuscaicmssp (new.codnat,:ufcli,new.codemp,new.codfilial)
                        into PERCICMSST;
                    end

                    new.vlroutrasitvenda = 0;
                    new.VLRISENTASITVENDA = 0;

                   if(new.calcstcm = 'N') then
                    begin
                        
                        if(redfisc>0 and redbasest='S') then
                        begin
                            -- Quando h reduo na base do icms st , deve usar o valor da base do icms proprio como parametro
                            new.vlrbaseicmsstitvenda = (  (coalesce(new.margemvlagritvenda,0) + 100) / 100 )  * (  (coalesce(new.vlrbaseicmsitvenda,0) ) + (coalesce(new.vlripiitvenda,0)) );
        
                        end
                        else
                        begin
                            -- Quando no h reduo na base do icms st deve usar o valor da base bruto (rem reduo)
                            new.vlrbaseicmsstitvenda = (  (coalesce(new.margemvlagritvenda,0) + 100) / 100 )  * (  (coalesce(new.vlrbaseicmsbrutitvenda,0) ) + (coalesce(new.vlripiitvenda,0)) );
                        end
        
                        --new.vlroutrasitvenda = 0;
                        --new.vlrisentasitvenda = 0;
                        new.vlricmsstitvenda = ( (new.vlrbaseicmsstitvenda * :percicmsst) / 100 ) - (new.vlricmsitvenda) ;
                     end
                     else
                     begin
                         
                        if(redfisc>0 and redbasest='S') then
                        begin
    
                             -- Quando h reduo na base do icms st , deve usar o valor da base do icms proprio como parametro
                             new.vlrbaseicmsstitvenda =   (new.vlricmsitvenda + ( (coalesce(new.vlrbaseicmsitvenda,0) + coalesce(new.vlripiitvenda,0) ) * (coalesce(:percicmscm,0)/100) ))/(:PERCICMSST/100);
                        end
                        else
                        begin
                             new.vlrbaseicmsstitvenda =   (new.vlricmsitvenda + ( (coalesce(new.vlrbaseicmsbrutitvenda,0) + coalesce(new.vlripiitvenda,0) ) * (coalesce(percicmscm,0)/100) ))/(:PERCICMSST/100);
                        end
                        new.vlroutrasitvenda = 0;
                        new.vlrisentasitvenda = 0;
                        new.vlricmsstitvenda =  ( (coalesce(new.vlrbaseicmsitvenda,0) + coalesce(new.vlripiitvenda,0) ) * (coalesce(percicmscm,0)/100)  );
                     end
                 end
            end
            -- No insidencia
            else if (new.tipofisc = 'NN') then
            begin
                new.vlroutrasitvenda = new.vlrliqitvenda;
                new.vlrbaseicmsitvenda = 0;
                new.percicmsitvenda = 0;
                new.vlricmsitvenda = 0;
                new.vlrisentasitvenda = 0;
            end
            -- Tributado integralmente
            else if (new.tipofisc = 'TT') then
            begin
                new.vlroutrasitvenda = 0;
                new.vlrisentasitvenda = 0;
            end
        end


       -- Atualizando preo especial para comissionamento
       if(precocomisprod is not null) then
       begin

           new.vlrbasecomisitvenda = new.qtditvenda * precocomisprod;

       end

  --END

end ^

CREATE TRIGGER VDITVENDATGAU FOR VDITVENDA 
ACTIVE AFTER UPDATE POSITION 0 
AS
  DECLARE VARIABLE DDTVENDA DATE;
  DECLARE VARIABLE CFLAG CHAR(1);
  DECLARE VARIABLE IDOCVENDA INTEGER;
  DECLARE VARIABLE ICODEMPTM INTEGER;
  DECLARE VARIABLE SCODFILIALTM SMALLINT;
  DECLARE VARIABLE ICODTIPOMOV INTEGER;
  DECLARE VARIABLE CSTATUS CHAR(2);
  DECLARE VARIABLE CTIPOPROD varCHAR(2);
  DECLARE VARIABLE NPRECO NUMERIC(15, 5);
  DECLARE VARIABLE visualizalucr CHAR(1);
  DECLARE VARIABLE custopeps NUMERIC(15, 5);
  DECLARE VARIABLE custompm NUMERIC(15, 5);
  DECLARE VARIABLE custouc NUMERIC(15, 5);
  declare variable subtipovenda char(2);
  declare variable estoqtipomovpd char(1);

  --DECLARE VARIABLE V_CHAVE VARCHAR(500);
  --DECLARE VARIABLE V_RECURSIVO INTEGER;
BEGIN

  --V_CHAVE = 'VDITVENDATGAU'; -- Nome do objeto (trigger ou procedure) a controlar recursividade
  --V_CHAVE = V_CHAVE || '_' || IIF(INSERTING, 'INS', IIF(UPDATING, 'UPD', 'DEL')); -- tipo de evento
  --V_CHAVE = V_CHAVE || '_' || CAST(NEW.CODVENDA AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
  --V_CHAVE = V_CHAVE || '_' || CAST(NEW.CODITVENDA AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
  --V_CHAVE = V_CHAVE || '_' || CAST(NEW.TIPOVENDA AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
  --V_CHAVE = V_CHAVE || '_' || CAST(NEW.CODFILIAL AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
  --V_CHAVE = V_CHAVE || '_' || CAST(NEW.CODEMP AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria

  --EXECUTE PROCEDURE PRO_RECURSIVO(:V_CHAVE) RETURNING_VALUES (:V_RECURSIVO);

  /* Verifica se  uma chamada recursiva ou no, se no for continua */
  --IF (V_RECURSIVO = 0) THEN
  --BEGIN
  
    estoqtipomovpd = 'S';
  
    select visualizalucr from sgprefere1 where codemp=new.codemp and codfilial = new.codfilial
      into :visualizalucr;

    IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT IS NOT NULL) ) ) ) THEN
    BEGIN
    
      SELECT VD.DTEMITVENDA,VD.DOCVENDA,VD.STATUSVENDA,VD.FLAG,
             VD.CODEMPTM, VD.CODFILIALTM, VD.CODTIPOMOV, VD.SUBTIPOVENDA
      FROM VDVENDA VD
      WHERE VD.CODVENDA = new.CODVENDA AND VD.TIPOVENDA = new.TIPOVENDA
            AND VD.CODEMP=new.CODEMP AND VD.CODFILIAL = new.CODFILIAL
      INTO :DDTVENDA, :IDOCVENDA, :CSTATUS, :CFLAG, :ICODEMPTM,
          :SCODFILIALTM, :ICODTIPOMOV, :SUBTIPOVENDA;
          
      if ( (subtipovenda is not null) and (subtipovenda='NC') ) then
          estoqtipomovpd = 'N';
          
      SELECT TIPOPROD FROM EQPRODUTO WHERE CODPROD=old.CODPROD
             AND CODEMP=old.CODEMPPD AND CODFILIAL = old.CODFILIALPD
         INTO CTIPOPROD;
      if (SUBSTRING(:CSTATUS FROM 1 FOR 1) not in ('C','N')) then
      BEGIN
        UPDATE VDVENDA SET VLRDESCITVENDA = VLRDESCITVENDA -old.VLRDESCITVENDA + new.VLRDESCITVENDA,
               VLRPRODVENDA = VLRPRODVENDA - old.VLRPRODITVENDA + new.VLRPRODITVENDA,
               VLRBASEICMSVENDA = VLRBASEICMSVENDA - old.VLRBASEICMSITVENDA + new.VLRBASEICMSITVENDA,
               VLRICMSVENDA = VLRICMSVENDA -old.VLRICMSITVENDA + new.VLRICMSITVENDA,
               VLRISENTASVENDA = VLRISENTASVENDA - old.VLRISENTASITVENDA + new.VLRISENTASITVENDA,
               VLROUTRASVENDA = VLROUTRASVENDA - old.VLROUTRASITVENDA + new.VLROUTRASITVENDA,
               VLRBASEIPIVENDA = VLRBASEIPIVENDA - old.VLRBASEIPIITVENDA + new.VLRBASEIPIITVENDA,
               VLRIPIVENDA = VLRIPIVENDA - old.VLRIPIITVENDA + new.VLRIPIITVENDA,
               VLRLIQVENDA = VLRLIQVENDA - old.VLRLIQITVENDA + new.VLRLIQITVENDA,
               VLRCOMISVENDA = VLRCOMISVENDA - old.VLRCOMISITVENDA + new.VLRCOMISITVENDA,
               VLRBASEISSVENDA = VLRBASEISSVENDA - old.VLRBASEISSITVENDA + new.VLRBASEISSITVENDA,
               VLRISSVENDA = VLRISSVENDA - old.VLRISSITVENDA + new.VLRISSITVENDA,
               VLRBASEICMSSTVENDA = VLRBASEICMSSTVENDA - OLD.vlrbaseicmsstitvenda + NEW.vlrbaseicmsstitvenda,
               VLRICMSSTVENDA = VLRICMSSTVENDA - OLD.vlricmsstitvenda + NEW.vlricmsstitvenda,
               vlrbasecomis = vlrbasecomis - old.vlrbasecomisitvenda + new.vlrbasecomisitvenda
               WHERE CODVENDA=new.CODVENDA AND TIPOVENDA=new.TIPOVENDA
               AND CODEMP=new.CODEMP AND CODFILIAL=new.CODFILIAL;
        
        IF (SUBSTRING(CSTATUS FROM 1 FOR 1) = 'P') THEN
          CSTATUS = 'PV';
        ELSE IF (SUBSTRING(CSTATUS FROM 1 FOR 1) = 'V') THEN
          CSTATUS = 'VD';
      END
      IF (new.QTDITVENDA = 0) THEN
         NPRECO = new.PRECOITVENDA;
      ELSE
         NPRECO = new.VLRLIQITVENDA/new.QTDITVENDA;
      EXECUTE PROCEDURE EQMOVPRODIUDSP('U',new.CODEMPPD, new.CODFILIALPD, new.CODPROD,
        new.CODEMPLE, new.CODFILIALLE, new.CODLOTE, :ICODEMPTM,
        :SCODFILIALTM, :ICODTIPOMOV, null, null, null ,null, null,
        null, null, new.CODEMP, new.CODFILIAL, new.TIPOVENDA, new.CODVENDA,
        new.CODITVENDA, null, null, null, null,null,null,null, null, null,
        new.CODEMPNT, new.CODFILIALNT,
        new.CODNAT, :DDTVENDA, :IDOCVENDA, :CFLAG, new.QTDITVENDA, :NPRECO,
        new.CODEMPAX, new.CODFILIALAX, new.CODALMOX, null, :estoqtipomovpd, 'N');


       if( visualizalucr = 'S' ) then
       begin

            -- Busca do custo da ultima compra;
            select custounit from eqcustoprodsp(new.codemppd, new.codfilialpd, new.codprod,
                new.dtins,'U',new.codempax, new.codfilialax, new.codalmox,'N')
            into :custouc;

            -- Busca do custo mdio (MPM)
            select custounit from eqcustoprodsp(new.codemppd, new.codfilialpd, new.codprod,
                new.dtins,'M',new.codempax, new.codfilialax, new.codalmox,'N')
            into :custompm;

            -- Busca do custo peps
            select custounit from eqcustoprodsp(new.codemppd, new.codfilialpd, new.codprod,
                new.dtins,'P',new.codempax, new.codfilialax, new.codalmox,'N')
            into :custopeps;

            -- Atualizando registro na tabela de custos de item de venda

            update vditcustovenda icv set vlrprecoultcp=:custouc, vlrcustompm=:custompm, vlrcustopeps=:custopeps
                where icv.codemp=new.codemp and icv.codfilial=new.codfilial and icv.codvenda=new.codvenda
                and icv.tipovenda=new.tipovenda and icv.coditvenda=new.coditvenda;

       end

        -- Executa procedure para atualizao de tabela de vinculo para numeros de serie
        execute procedure vditvendaseriesp('U', old.codemp, old.codfilial, old.codvenda, old.tipovenda, old.coditvenda, old.codemppd, old.codfilialpd, old.codprod, new.numserietmp, new.qtditvenda);


        -- Atualizando registros na tabela de informaes fiscais complementares (LFITVENDA)
        if(new.coditfisc is not null) then
        begin
            execute procedure lfgeralfitvendasp(
            new.codemp, new.codfilial, new.codvenda, new.tipovenda, new.coditvenda);
        end

        -- Atualizando informaes referentes  devoluo
        execute procedure cpgeradevolucaosp (
        new.codempcp,new.codfilialcp, new.codcompra, new.coditcompra, new.codemp, new.codfilial,
        new.codvenda, new.coditvenda, new.tipovenda, new.qtditvenda);


    END

  --END
  
END ^

CREATE TRIGGER VDITVENDATGBD FOR VDITVENDA 
ACTIVE BEFORE DELETE POSITION 0 
AS
    declare variable codfilial smallint;
    declare variable fatorcparc char(1);

--  DECLARE VARIABLE V_CHAVE VARCHAR(500);
--  DECLARE VARIABLE V_RECURSIVO INTEGER;
BEGIN

--  V_CHAVE = 'VDITVENDATGBD'; -- Nome do objeto (trigger ou procedure) a controlar recursividade
--  V_CHAVE = V_CHAVE || '_' || IIF(INSERTING, 'INS', IIF(UPDATING, 'UPD', 'DEL')); -- tipo de evento
--  V_CHAVE = V_CHAVE || '_' || CAST(OLD.CODVENDA AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
--  V_CHAVE = V_CHAVE || '_' || CAST(OLD.CODITVENDA AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
--  V_CHAVE = V_CHAVE || '_' || CAST(OLD.TIPOVENDA AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
--  V_CHAVE = V_CHAVE || '_' || CAST(OLD.CODFILIAL AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
--  V_CHAVE = V_CHAVE || '_' || CAST(OLD.CODEMP AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria

--  EXECUTE PROCEDURE PRO_RECURSIVO(:V_CHAVE) RETURNING_VALUES (:V_RECURSIVO);

  /* Verifica se  uma chamada recursiva ou no, se no for continua */
--  IF (V_RECURSIVO = 0) THEN
--  BEGIN

    select icodfilial from sgretfilial(old.codemp,'SGPREFERE1') into :codfilial; 
    select fatorcparc from sgprefere1 p 
       where p.codemp=old.codemp and p.codfilial=:codfilial
    into :fatorcparc; 
    
    -- Excluindo vnculos com o oramento;
    if (fatorcparc='N') then
    begin
       delete from vdvendaorc
       where codemp=old.codemp and codfilial=old.codfilial and tipovenda=old.tipovenda and codvenda=old.codvenda and coditvenda=old.coditvenda;
    end

    -- Executa procedure para excluso de tabela de vinculo para numeros de serie
    execute procedure vditvendaseriesp('D', old.codemp, old.codfilial, old.codvenda, old.tipovenda, old.coditvenda, old.codemppd, old.codfilialpd, old.codprod, null, old.qtditvenda);

  --END
  
end ^

CREATE TRIGGER VDITVENDATGAD FOR VDITVENDA 
ACTIVE AFTER DELETE POSITION 0 
AS
  DECLARE VARIABLE DDTVENDA DATE;
  DECLARE VARIABLE CFLAG CHAR(1);
  DECLARE VARIABLE IDOCVENDA INTEGER;
  DECLARE VARIABLE ICODEMPTM INTEGER;
  DECLARE VARIABLE SCODFILIALTM SMALLINT;
  DECLARE VARIABLE ICODTIPOMOV INTEGER;
  declare variable subtipovenda char(2);
  declare variable estoqtipomovpd char(1);

--  DECLARE VARIABLE V_CHAVE VARCHAR(500);
--  DECLARE VARIABLE V_RECURSIVO INTEGER;
BEGIN

--  V_CHAVE = 'VDITVENDATGAD'; -- Nome do objeto (trigger ou procedure) a controlar recursividade
--  V_CHAVE = V_CHAVE || '_' || IIF(INSERTING, 'INS', IIF(UPDATING, 'UPD', 'DEL')); -- tipo de evento
--  V_CHAVE = V_CHAVE || '_' || CAST(OLD.CODVENDA AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
 -- V_CHAVE = V_CHAVE || '_' || CAST(OLD.CODITVENDA AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
--  V_CHAVE = V_CHAVE || '_' || CAST(OLD.TIPOVENDA AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
--  V_CHAVE = V_CHAVE || '_' || CAST(OLD.CODFILIAL AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
--  V_CHAVE = V_CHAVE || '_' || CAST(OLD.CODEMP AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria

--  EXECUTE PROCEDURE PRO_RECURSIVO(:V_CHAVE) RETURNING_VALUES (:V_RECURSIVO);

  /* Verifica se  uma chamada recursiva ou no, se no for continua */
--  IF (V_RECURSIVO = 0) THEN
--  BEGIN

    IF ( not ( (old.EMMANUT='S') and (old.EMMANUT IS NOT NULL) ) ) THEN
    BEGIN
    
      estoqtipomovpd = 'S';
      
      UPDATE VDVENDA SET
         VLRPRODVENDA = VLRPRODVENDA - old.VLRPRODITVENDA,
         VLRBASEICMSVENDA = VLRBASEICMSVENDA - old.VLRBASEICMSITVENDA,
         VLRICMSVENDA = VLRICMSVENDA -old.VLRICMSITVENDA,
         VLRISENTASVENDA = VLRISENTASVENDA - old.VLRISENTASITVENDA,
         VLROUTRASVENDA = VLROUTRASVENDA - old.VLROUTRASITVENDA,
         VLRBASEIPIVENDA = VLRBASEIPIVENDA - old.VLRBASEIPIITVENDA,
         VLRIPIVENDA = VLRIPIVENDA - old.VLRIPIITVENDA,
         VLRLIQVENDA = VLRLIQVENDA - old.VLRLIQITVENDA,
         VLRCOMISVENDA = VLRCOMISVENDA - old.VLRCOMISITVENDA,
         VLRBASEISSVENDA = VLRBASEISSVENDA - old.VLRBASEISSITVENDA,
         VLRISSVENDA = VLRISSVENDA - old.VLRISSITVENDA,
         VLRDESCITVENDA = VLRDESCITVENDA - old.VLRDESCITVENDA,
         VLRBASEICMSSTVENDA = VLRBASEICMSSTVENDA - OLD.vlrbaseicmsstitvenda,
         VLRICMSSTVENDA = VLRICMSSTVENDA - OLD.vlricmsstitvenda,
         VLRBASECOMIS = VLRBASECOMIS - OLD.vlrbasecomisitvenda
         WHERE CODVENDA=old.CODVENDA AND TIPOVENDA=old.TIPOVENDA AND
         CODEMP=old.CODEMP AND CODFILIAL=old.CODFILIAL;
         
      SELECT V.DTEMITVENDA, V.FLAG, V.DOCVENDA,
          V.CODEMPTM, V.CODFILIALTM, V.CODTIPOMOV, V.SUBTIPOVENDA
       FROM VDVENDA V  WHERE V.CODVENDA = old.CODVENDA AND
          V.CODEMP=old.CODEMP AND V.CODFILIAL = old.CODFILIAL AND
          V.TIPOVENDA=old.TIPOVENDA
      INTO :DDTVENDA, :CFLAG, :IDOCVENDA, :ICODEMPTM, :SCODFILIALTM, :ICODTIPOMOV, :subtipovenda;
      
      if ( (subtipovenda is not null) and (subtipovenda='NC') ) then
         estoqtipomovpd = 'N';
         
      EXECUTE PROCEDURE EQMOVPRODIUDSP('D', old.CODEMPPD, old.CODFILIALPD,
         old.CODPROD, old.CODEMPLE, old.CODFILIALLE, old.CODLOTE,
         :ICODEMPTM, :SCODFILIALTM, :ICODTIPOMOV, null, null, null,
         null, null, null, null,
         old.CODEMP, old.CODFILIAL, old.TIPOVENDA, old.CODVENDA, old.CODITVENDA,
          null, null, null, null,null,null, null, null, null,
         old.CODEMPNT, old.CODFILIALNT, old.CODNAT, :DDTVENDA,
         :IDOCVENDA, :CFLAG, old.QTDITVENDA, old.PRECOITVENDA,
         old.CODEMPAX, old.CODFILIALAX, old.CODALMOX, null, :estoqtipomovpd, 'N');
      
    END

--  END
  
END ^

CREATE TRIGGER VDITVENDASERIETGBIBU FOR VDITVENDASERIE 
ACTIVE BEFORE INSERT POSITION 0 
as
    declare variable temserie smallint;
begin
    -- Verifica se numero de srie j foi inserido nessa VENDA
    select count(*) from vditvendaserie its
    where its.codemp = new.codemp and its.codfilial=new.codfilial and its.codvenda=new.codvenda
    and its.tipovenda=new.tipovenda and its.codemppd=new.codemppd and its.codfilialpd=new.codfilialpd and its.codprod=new.codprod
    and its.numserie = new.numserie and its.numserie is not null and its.seqitserie!=new.seqitserie
    into temserie;

    if(temserie > 0) then
    begin
        exception vditvendaex04 new.numserie;
    end


end ^

CREATE TRIGGER VDITVENDASERIETGBU FOR VDITVENDASERIE 
ACTIVE BEFORE UPDATE POSITION 0 
as
    declare variable temserie smallint;
begin
    -- Atualizando log
    new.DTALT=cast('now' as date);
    new.IDUSUALT=USER;
    new.HALT = cast('now' as time);

    -- Verificando se foi inserido um numero de srie
    if(old.numserie is null and new.numserie is not null) then
    begin
        -- Verificando se o nmero de srie informado, j existe.
        select count(*) from eqserie sr
        where sr.codemp = new.codemppd and sr.codfilial = new.codfilialpd and sr.codprod = new.codprod and sr.numserie = new.numserie
        into :temserie;

        -- se o nmero de srie informado no existe, deve inseri-lo;
        if (temserie = 0) then
        begin
            insert into eqserie (codemp, codfilial, codprod, numserie)
            values(new.codemppd, new.codfilialpd, new.codprod, new.numserie);
        end

    end

end ^

CREATE TRIGGER VDITVENDASERIETGAI FOR VDITVENDASERIE 
ACTIVE BEFORE INSERT OR UPDATE POSITION 0 
AS
    declare variable estoqtipomov char(1);
    declare variable codemptm integer;
    declare variable codfilialtm integer;
    declare variable codtipomov integer;
    declare variable tipomovserie smallint;

begin
    if(new.numserie is not null)then
        begin

            select v.codemptm, v.codfilialtm, v.codtipomov, tm.estoqtipomov
            from vdvenda v, eqtipomov tm
            where v.codemp = new.codemp and v.codfilial = new.codfilial and v.codvenda = new.codvenda
            and tm.codemp=v.codemptm and tm.codfilial=v.codfilialtm and tm.codtipomov=v.codtipomov
            into :codemptm, :codfilialtm, :codtipomov, :estoqtipomov;

            if('S' = :estoqtipomov) then
            begin
                tipomovserie = -1;
            end
            else
            begin
                tipomovserie = 0;
            end

            insert into eqmovserie (codemp, codfilial, codemppd, codfilialpd, codprod,
                    codempvd, codfilialvd, codvenda, coditvenda, tipovenda,
                    codemptm, codfilialtm, codtipomov,
                    numserie, dtmovserie, tipomovserie)
            values(new.codemp, new.codfilial, new.codemppd, new.codfilialpd, new.codprod,
                    new.codemp, new.codfilial, new.codvenda, new.coditvenda, new.tipovenda,
                    :codemptm, :codfilialtm, :codtipomov,
                    new.numserie,  current_timestamp , :tipomovserie);
        end
end ^

CREATE TRIGGER VDKITTGBI FOR VDKIT 
ACTIVE BEFORE INSERT POSITION 0 
AS
begin
  new.DTINS=cast('now' AS DATE);
  new.IDUSUINS=USER;
  new.HINS = cast('now' AS TIME);
  SELECT REFPROD FROM EQREFPRODSP(new.CODEMP, new.CODFILIAL, new.CODPROD) INTO new.REFPROD;
end ^

CREATE TRIGGER VDKITTGBU FOR VDKIT 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  IF (new.EMMANUT IS NULL) THEN
     new.EMMANUT='N';
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
  BEGIN  
     SELECT REFPROD FROM EQREFPRODSP(new.CODEMP, new.CODFILIAL, new.CODPROD) INTO new.REFPROD;
  END
end ^

CREATE TRIGGER VDMOTORISTATGAI FOR VDMOTORISTA 
ACTIVE AFTER INSERT POSITION 0 
AS
begin

    -- Insere na tabela de vinculos entre transportadoras e motoristas

    if( new.codtran is not null ) then
    begin

        insert into vdtranspmot (codemp, codfilial, codtran, codempmt, codfilialmt, codmot)
        values(new.codemptn, new.codfilialtn, new.codtran, new.codemp,  new.codfilial, new.codmot);

    end

end ^

CREATE TRIGGER VDMOTORISTATGBU FOR VDMOTORISTA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER VDMOTORISTATGAU FOR VDMOTORISTA 
ACTIVE AFTER UPDATE POSITION 0 
AS
begin
    -- Insere na tabela de vinculos entre transportadoras e motoristas

    if( new.codtran is not null and old.codtran <> new.codtran ) then
    begin

        insert into vdtranspmot (codemp, codfilial, codtran, codempmt, codfilialmt, codmot)
        values(new.codemptn, new.codfilialtn, new.codtran, new.codemp,  new.codfilial, new.codmot);

    end
end ^

CREATE TRIGGER VDOBSCLITGBU FOR VDOBSCLI 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER VDORCAMENTOTGBI FOR VDORCAMENTO 
ACTIVE BEFORE INSERT POSITION 0 
AS
BEGIN
  IF (new.VLRPRODORC IS NULL) THEN new.VLRPRODORC = 0;
  IF (new.VLRDESCORC IS NULL) THEN new.VLRDESCORC = 0;
  IF (new.VLRADICORC IS NULL) THEN new.VLRADICORC = 0;
  IF (new.VLRDESCITORC IS NULL) THEN new.VLRDESCITORC = 0;
  IF (new.VLRLIQORC IS NULL) THEN new.VLRLIQORC = 0;
  IF (new.CODCONV IS NOT NULL AND new.CODCLI IS NULL) THEN
  BEGIN
       SELECT CODCLI,CODEMPCL,CODFILIALCL,CODTPCONV,CODFILIALTC,CODEMPTC FROM ATCONVENIADO
          WHERE CODEMP=new.CODEMPCV AND CODFILIAL=new.CODFILIALCV
          AND CODCONV=new.CODCONV INTO new.CODCLI,new.CODEMPCL,new.CODFILIALCL,
          new.CODTPCONV,new.CODFILIALTC,new.CODEMPTC;
  END
  EXECUTE PROCEDURE VDCLIENTEATIVOSP(new.CODEMPCL, new.CODFILIALCL, new.CODCLI);
END ^

CREATE TRIGGER VDORCAMENTOTGAI FOR VDORCAMENTO 
ACTIVE AFTER INSERT POSITION 0 
AS
DECLARE VARIABLE iCodFilialTb SMALLINT;
DECLARE VARIABLE iCodFilialSt SMALLINT;
BEGIN
  SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'VDSTATUSORC') INTO :iCodFilialSt;
  SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'SGTABELA') INTO :iCodFilialTb;
  INSERT INTO VDSTATUSORC (CODEMP,CODFILIAL,TIPOORC,CODORC,CODEMPTB,CODFILIALTB,CODTB,CODITTB,MOTIVOSTORC)
     SELECT new.CODEMP, new.CODFILIAL, new.TIPOORC, new.CODORC, new.CODEMP,
         :iCodFilialTb, OTB.CODTB, ITB.CODITTB,'SITUAO INICIAL'
      FROM SGOBJETOTB OTB,SGITTABELA ITB WHERE OTB.CODEMP=new.CODEMP AND OTB.CODFILIALTB=:iCodFilialTb AND
        OTB.IDOBJ='VDSTATUSORC' AND ITB.CODEMP=new.CODEMP AND ITB.CODFILIAL=OTB.CODFILIALTB AND
        ITB.CODTB=OTB.CODTB AND ITB.PADRAOITTB='S';
END ^

CREATE TRIGGER VDORCAMENTOTGBU FOR VDORCAMENTO 
ACTIVE BEFORE UPDATE POSITION 0 
as

    declare variable codatendo integer;
    declare variable codsetor integer;
    declare variable filialpref integer;
    declare variable filialusu integer;
    declare variable vlradic numeric(15,5);

begin

    if (new.emmanut is null) then
        new.emmanut = 'N';

    if ( not ( (new.emmanut='S') or ( (old.emmanut='S') and (old.emmanut is not null)) ) ) then
    begin
        new.dtalt = cast('now' as date);
        new.idusualt = user;
        new.halt = cast('now' as time);

        if(new.codcli is null and new.codconv is not null) then
        begin

            select codcli, codempcl, codfilialcl, codtpconv, codfilialtc, codemptc
            from atconveniado
            where codemp=new.codempcv and codfilial=new.codfilialcv and codconv=new.codconv into
            new.codcli, new.codempcl, new.codfilialcl, new.codtpconv, new.codfilialtc, new.codemptc;

        end

        if ( (not new.codconv = old.codconv) and (new.codconv is not null) ) then
        begin
            select codcli, codempcl, codfilialcl
            from atconveniado
            where codemp=new.codempcv and codfilial=new.codfilialcv and codconv=new.codconv into
            new.codcli, new.codempcl, new.codfilialcl;
        end

        if (old.statusorc = 'OA' and new.statusorc = 'OC') then
        begin
            select icodfilial from sgretfilial(new.codemp,'SGPREFERE2') into filialpref;
            select icodfilial from sgretfilial(new.codemp,'SGUSUARIO') into filialusu;
            select codsetat2, codtpatendo3 from sgprefere2 where codemp=new.codemp and codfilial=:filialpref into
            codsetor,codatendo;

            if(new.codconv is not null) then
            begin
                execute procedure atadicatendimentosp(new.codconv,:codatendo,new.codatend, codsetor, null, new.codemp, :filialusu, new.codorc );
            end

        end

        if (old.statusorc!='OL' and new.statusorc = 'OL') then -- Caso oramento tenha sido aprovado
        begin
           new.dtaprovorc = cast('today' as date);
        end
        
        execute procedure vdclienteativosp(new.codempcl, new.codfilialcl, new.codcli);

        if (new.vlrdescorc is null) then
            new.vlrdescorc = 0;

        new.vlrdescorc = new.vlrdescorc - old.vlrdescitorc;
        new.vlrdescorc = new.vlrdescorc + new.vlrdescitorc;

        vlradic = 0;

        if(new.adicfrete='S' and new.vlrfreteorc is not null and new.vlrfreteorc>0) then
        begin
            vlradic = vlradic + new.vlrfreteorc;
        end

        new.vlrliqorc = new.vlrprodorc - new.vlrdescorc + new.vlradicorc + vlradic;

    end
end ^

CREATE TRIGGER VDORCAMENTOTGAU FOR VDORCAMENTO 
ACTIVE AFTER UPDATE POSITION 0 
as

    declare variable coditorc integer;
    declare variable percitfrete numeric(15, 5);
    declare variable vlritfrete numeric(15, 5);
    declare variable vlrproditorc numeric(15, 5);

begin

    for select io.coditorc, io.vlrproditorc
    from vditorcamento io
    where io.codemp=new.codemp and io.codfilial=new.codfilial and io.codorc=new.codorc and io.tipoorc=new.tipoorc
    into :coditorc, :vlrproditorc
    do
    begin

        -- distribuio do frete
        if ( (new.vlrfreteorc != old.vlrfreteorc) or (new.adicfrete!=old.adicfrete)  ) then
        begin
           percitfrete = :vlrproditorc / new.vlrprodorc ;
           vlritfrete =  :percitfrete * new.vlrfreteorc ;


           -- atualizando tabela de tens
            update vditorcamento io set
            io.vlrfreteitorc = :vlritfrete
            where
            io.codemp=new.codemp and io.codfilial=new.codfilial and io.codorc=new.codorc and
            io.coditorc=:coditorc and io.tipoorc=new.tipoorc;
        end

        -- Atualizao do STATUS desde que o oramento no tenha sido faturado parcialmente.
        if(old.statusorc != new.statusorc) then
        begin
            update vditorcamento io set io.statusitorc=new.statusorc
            where io.codemp=new.codemp and io.codfilial=new.codfilial
            and io.codorc=new.codorc and io.tipoorc=new.tipoorc
            and io.statusitorc!=new.statusorc;
        end

    end

end ^

CREATE TRIGGER VDORCAMENTOTGBD FOR VDORCAMENTO 
ACTIVE BEFORE DELETE POSITION 0 
as
begin
  DELETE FROM atatendimentoorc WHERE CODORC=old.CODORC
    AND CODFILIAL=old.CODFILIAL AND CODEMP=old.CODEMP;
end ^

CREATE TRIGGER VDPRAZOENTTGBU FOR VDPRAZOENT 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER VDPRECOPRODTGAI FOR VDPRECOPROD 
ACTIVE AFTER INSERT POSITION 0 
AS
begin
    
    -- Se a origem do preco foi o preo base deve indicar no log do produto que o preo foi processado
    if(new.tipoprecoprod='B') then
    begin
    
        update eqprodutolog set precoproc = 'S'
        where codemp=new.codemp and codfilial=new.codfilial and codprod=new.codprod;

    end

end ^

CREATE TRIGGER VDPRECOPRODTGBU FOR VDPRECOPROD 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);

  --Verifica se o preo foi realmente alterado;
  if(new.precoprod != old.precoprod) then
  begin

     new.precoant = old.precoprod;
     new.dtaltpreco = cast('now' as date);
     new.halt = cast('now' as time);
     new.idusualtpreco=USER;

  end

end ^

CREATE TRIGGER VDPRECOPRODTGAU FOR VDPRECOPROD 
ACTIVE AFTER UPDATE POSITION 0 
AS
begin

    -- Se a origem do preco foi o preo base deve indicar no log do produto que o preo foi processado
    if(new.tipoprecoprod='B') then
    begin
    
        update eqprodutolog set precoproc = 'S'
        where codemp=new.codemp and codfilial=new.codfilial and codprod=new.codprod;

    end


end ^

CREATE TRIGGER VDPREVTRIBITORCTGBU FOR VDPREVTRIBITORC 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER VDREGCOMISDESC_BU0 FOR VDREGCOMISDESC 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
new.DTALT=cast('now' AS DATE);
new.IDUSUALT=USER;
new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER VDREGRACOMISTGBU FOR VDREGRACOMIS 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER VDREMCONSIGTGBU FOR VDREMCONSIG 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER VDROMANEIOTGAI FOR VDROMANEIO 
ACTIVE AFTER INSERT POSITION 0 
AS
begin

    -- Atualiza vinculo com expedio

    if(new.ticket is not null) then
    begin

        update eqexpedicao ex set ex.codempro=new.codemp, ex.codfilialro=new.codfilial, ex.codroma=new.codroma
        where ex.codemp=new.codempex and ex.codfilial=new.codfilialex and ex.ticket=new.ticket;

    end

end ^

CREATE TRIGGER VDROMANEIOTGBU FOR VDROMANEIO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin

  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER VDROMANEIOTGAU FOR VDROMANEIO 
ACTIVE AFTER UPDATE POSITION 0 
AS
begin
    -- Atualiza vinculo com expedio
    if(new.ticket is not null and old.ticket is null) then
    begin

        update eqexpedicao ex set ex.codempro=new.codemp, ex.codfilialro=new.codfilial, ex.codroma=new.codroma
        where ex.codemp=new.codempex and ex.codfilial=new.codfilialex and ex.ticket=new.ticket;

    end

    if(old.ticket is not null and new.ticket is null) then
    begin

        update eqexpedicao ex set ex.codempro=null, ex.codfilialro=null, ex.codroma=null
        where ex.codemp=old.codempex and ex.codfilial=old.codfilialex and ex.ticket=old.ticket;

    end

end ^

CREATE TRIGGER VDSETORTGBU FOR VDSETOR 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER VDSETORROTATGBU FOR VDSETORROTA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER VDSTATUSORCTGBU FOR VDSTATUSORC 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER VDTABPRECOTGBU FOR VDTABPRECO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER VDTEFTGBU FOR VDTEF 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER VDTIPOCLITGBU FOR VDTIPOCLI 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER VDTIPOVENDTGBU FOR VDTIPOVEND 
ACTIVE BEFORE UPDATE POSITION 0 
AS
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER VDTRANSPTGBI FOR VDTRANSP 
ACTIVE BEFORE INSERT POSITION 0 
AS
    declare variable nomemunictran CHAR(30);
    declare variable geracodunif char(1);
    declare variable filialpref smallint;
    declare variable codunifcod integer;
begin

    /*Atualizao do campo cidade e estado (temporrio para retro-compatibilidade)*/

    if(new.codmunic is not null) then
    begin
        select substr(mun.nomemunic,1,30) from sgmunicipio mun
            where mun.codpais=new.codpais and mun.siglauf=new.siglauf and mun.codmunic=new.codmunic
                into :nomemunictran;
        if (nomemunictran is not null) then new.cidtran = nomemunictran;
    end

    if(new.siglauf is not null) then
    begin
        new.uftran=new.siglauf;
    end

    /* Fim da atualizao do campo cidade e estado*/

    -- Gerao de cdigo unificador (SGUNIFCOD)

    select icodfilial from sgretfilial(new.codemp,'SGPREFERE1') into filialpref;
    select geracodunif from sgprefere1 where codemp=new.codemp and codfilial=:filialpref into :geracodunif;
    
    if(:geracodunif = 'S') then
    begin

        select (coalesce(max(codunifcod),0)+1) from sgunifcod where codemp=new.codemp and codfilial=new.codfilial
        into :codunifcod;

        insert into sgunifcod (codemp, codfilial, codunifcod, tipounifcod, descunifcod)
        values (new.codemp, new.codfilial, :codunifcod, 'T', new.raztran);
        new.codempuc=new.codemp;
        new.codfilialuc=new.codfilial;
        new.codunifcod=:codunifcod;

    end

end ^

CREATE TRIGGER VDTRANSPTGBU FOR VDTRANSP 
ACTIVE BEFORE UPDATE POSITION 0 
as
    declare variable nomemunictran CHAR(30);
begin
    new.DTALT=cast('now' AS DATE);
    new.IDUSUALT=USER;
    new.HALT = cast('now' AS TIME);

    /*Atualizao do campo cidade e estado (temporrio para retro-compatibilidade)*/

    if(old.codmunic != new.codmunic) then
    begin
        select substr(mun.nomemunic,1,30) from sgmunicipio mun
            where mun.codpais=new.codpais and mun.siglauf=new.siglauf and mun.codmunic=new.codmunic
                into :nomemunictran;
        if (nomemunictran is not null) then new.cidtran = nomemunictran;
    end

    if(new.siglauf is not null) then
    begin
        new.uftran=new.siglauf;
    end

    /* Fim da atualizao do campo cidade */


end ^

CREATE TRIGGER VDTRANSPTGAU FOR VDTRANSP 
ACTIVE AFTER UPDATE POSITION 0 
AS
    declare variable filialpref smallint;
    declare variable geracodunif char(1);

begin
      -- Atualizao de descrio do cdigo unificador (SGUNIFCOD)

    select icodfilial from sgretfilial(new.codemp,'SGPREFERE1') into filialpref;
    select geracodunif from sgprefere1 where codemp=new.codemp and codfilial=:filialpref into :geracodunif;
    
    if(:geracodunif = 'S' and new.codunifcod is not null) then
    begin
        update sgunifcod set descunifcod=new.raztran
        where codemp=new.codempuc and codfilial=new.codfilialuc and codunifcod=new.codunifcod;
    end
end ^

CREATE TRIGGER VDVEICULOTGAI FOR VDVEICULO 
ACTIVE AFTER INSERT POSITION 0 
AS
begin

    -- Insere na tabela de vinculos entre transportadoras e veiculos

    if( new.codtran is not null ) then
    begin

        insert into vdtranspveic (codemp, codfilial, codtran, codempve, codfilialve, codveic)
        values(new.codemptn, new.codfilialtn, new.codtran, new.codemp,  new.codfilial, new.codveic);

    end

end ^

CREATE TRIGGER VDVEICULOTGBU FOR VDVEICULO 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
  /* Trigger Text */
end ^

CREATE TRIGGER VDVEICULOTGAU FOR VDVEICULO 
ACTIVE AFTER UPDATE POSITION 0 
AS
begin
    -- Insere na tabela de vinculos entre transportadoras e veiculos

    if( new.codtran is not null and old.codtran <> new.codtran ) then
    begin

        insert into vdtranspveic (codemp, codfilial, codtran, codempve, codfilialve, codveic)
        values(new.codemptn, new.codfilialtn, new.codtran, new.codemp,  new.codfilial, new.codveic);

    end
end ^

CREATE TRIGGER VDVENDATGBI FOR VDVENDA 
ACTIVE BEFORE INSERT POSITION 0 
AS
  DECLARE VARIABLE sTipoMov CHAR(2);
--  DECLARE VARIABLE V_CHAVE VARCHAR(500);
--  DECLARE VARIABLE V_RECURSIVO INTEGER;
BEGIN

--  V_CHAVE = 'VDVENDATGBI'; -- Nome do objeto (trigger ou procedure) a controlar recursividade
--  V_CHAVE = V_CHAVE || '_' || IIF(INSERTING, 'INS', IIF(UPDATING, 'UPD', 'DEL')); -- tipo de evento
--  V_CHAVE = V_CHAVE || '_' || CAST(NEW.CODVENDA AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
--  V_CHAVE = V_CHAVE || '_' || CAST(NEW.TIPOVENDA AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
--  V_CHAVE = V_CHAVE || '_' || CAST(NEW.CODFILIAL AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
--  V_CHAVE = V_CHAVE || '_' || CAST(NEW.CODEMP AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria

--  EXECUTE PROCEDURE PRO_RECURSIVO(:V_CHAVE) RETURNING_VALUES (:V_RECURSIVO);

  /* Verifica se  uma chamada recursiva ou no, se no for continua */
--  IF (V_RECURSIVO = 0) THEN
--  BEGIN

    EXECUTE PROCEDURE VDCLIENTEATIVOSP(new.CODEMPCL, new.CODFILIALCL, new.CODCLI);
    /*  EXECUTE PROCEDURE FNLIBCREDSP(new.CODVENDA,new.CODCLI,new.CODEMPCL,new.CODFILIALCL,null); */
    IF (new.VLRPRODVENDA IS NULL) THEN new.VLRPRODVENDA = 0;
    IF (new.VLRDESCVENDA IS NULL) THEN new.VLRDESCVENDA = 0;
    IF (new.VLRDESCITVENDA IS NULL) THEN new.VLRDESCITVENDA = 0;
    IF (new.VLRVENDA IS NULL) THEN new.VLRVENDA = 0;
    IF (new.VLRBASEICMSVENDA IS NULL) THEN new.VLRBASEICMSVENDA = 0;
    IF (new.VLRICMSVENDA IS NULL) THEN new.VLRICMSVENDA = 0;
    IF (new.VLRPISVENDA IS NULL) THEN new.VLRPISVENDA = 0;
    IF (new.VLRIRVENDA IS NULL) THEN new.VLRIRVENDA = 0;
    IF (new.VLRCSOCIALVENDA IS NULL) THEN new.VLRCSOCIALVENDA = 0;
    IF (new.VLRISENTASVENDA IS NULL) THEN new.VLRISENTASVENDA = 0;
    IF (new.VLROUTRASVENDA IS NULL) THEN new.VLROUTRASVENDA = 0;
    IF (new.VLRBASEIPIVENDA IS NULL) THEN new.VLRBASEIPIVENDA = 0;
    IF (new.VLRIPIVENDA IS NULL) THEN new.VLRIPIVENDA = 0;
    IF (new.VLRLIQVENDA IS NULL) THEN new.VLRLIQVENDA = 0;
    IF (new.VLRCOMISVENDA IS NULL) THEN new.VLRCOMISVENDA = 0;
    IF (new.VLRFRETEVENDA IS NULL) THEN new.VLRFRETEVENDA = 0;
    IF (new.VLRADICVENDA IS NULL) THEN new.VLRADICVENDA = 0;
    IF (new.TIPOVENDA IS NULL) THEN new.TIPOVENDA = 'V';
    IF (new.VLRBASEISSVENDA IS NULL) THEN new.VLRBASEISSVENDA = 0;
    IF (new.VLRISSVENDA IS NULL) THEN new.VLRISSVENDA = 0;
    IF (new.VLRPISVENDA IS NULL) THEN new.VLRPISVENDA = 0;
    IF (new.VLRIRVENDA IS NULL) THEN new.VLRIRVENDA = 0;
    IF (new.VLRCSOCIALVENDA IS NULL) THEN new.VLRCSOCIALVENDA = 0;
    IF (new.vlrbasepisvenda IS NULL) THEN new.vlrbasepisvenda = 0;
    IF (new.vlrbasecofinsvenda IS NULL) THEN new.vlrbasecofinsvenda = 0;
    IF (new.vlrpisvenda IS NULL) THEN new.vlrpisvenda = 0;
    IF (new.vlrcofinsvenda IS NULL) THEN new.vlrcofinsvenda = 0;
    IF (new.vlrbasecomis IS NULL) THEN new.vlrbasecomis = 0;
    if (new.sitdoc is null) then new.sitdoc='00';
    if (new.dtcompvenda is null) then new.dtcompvenda=new.dtemitvenda;

    IF (new.CODCAIXA IS NULL) THEN
        SELECT CODTERM FROM SGRETCAIXA INTO new.CODCAIXA;

    SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP,'PVCAIXA') INTO new.CODFILIALCX;

    new.CODEMPCX = new.CODEMP;

    IF (NOT new.tipovenda = 'E') THEN -- Se for ECF no precisa buscar o DOC, porque o DOC  o numero do cupom.
        SELECT DOC FROM LFNOVODOCSP(new.Serie,new.CODEMPSE,new.CODFILIALSE) INTO new.DocVenda;

    SELECT TIPOMOV,FISCALTIPOMOV FROM EQTIPOMOV WHERE CODTIPOMOV=new.CODTIPOMOV
         AND CODEMP=new.CODEMP AND CODFILIAL = new.CODFILIALTM INTO sTipoMov,new.FLAG;

    IF ( new.FLAG <> 'S') THEN
    BEGIN
        new.FLAG = 'N';
    END

    if ((new.STATUSVENDA is null) OR (TRIM(new.STATUSVENDA) = '*')) then
    BEGIN
        IF (sTipoMov = 'VD') THEN new.STATUSVENDA = 'V1';
            ELSE new.STATUSVENDA = 'P1';
    END

--  END

END ^

CREATE TRIGGER VDVENDATGAI FOR VDVENDA 
ACTIVE AFTER INSERT POSITION 0 
AS
--  DECLARE VARIABLE V_CHAVE VARCHAR(500);
--  DECLARE VARIABLE V_RECURSIVO INTEGER;
BEGIN

--  V_CHAVE = 'VDVENDATGAI'; -- Nome do objeto (trigger ou procedure) a controlar recursividade
--  V_CHAVE = V_CHAVE || '_' || IIF(INSERTING, 'INS', IIF(UPDATING, 'UPD', 'DEL')); -- tipo de evento
-- V_CHAVE = V_CHAVE || '_' || CAST(NEW.CODVENDA AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
--  V_CHAVE = V_CHAVE || '_' || CAST(NEW.TIPOVENDA AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
--  V_CHAVE = V_CHAVE || '_' || CAST(NEW.CODFILIAL AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
--  V_CHAVE = V_CHAVE || '_' || CAST(NEW.CODEMP AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria

--  EXECUTE PROCEDURE PRO_RECURSIVO(:V_CHAVE) RETURNING_VALUES (:V_RECURSIVO);

  /* Verifica se  uma chamada recursiva ou no, se no for continua */
--  IF (V_RECURSIVO = 0) THEN
--  BEGIN

    insert into vdvendacomis
    (codemp,codfilial,codvenda,tipovenda,seqvc,
    codemprc, codfilialrc, codregrcomis, seqitrc,
    percvc)
    select vd.codemp, vd.codfilial, vd.codvenda,vd.tipovenda,irc.seqitrc,
        irc.codemp,irc.codfilial,irc.codregrcomis,irc.seqitrc,irc.perccomisitrc
        from
            vdvenda vd, eqtipomov tm, vditregracomis irc
        where
            tm.codemp=vd.codemptm and tm.codfilial=vd.codfilialtm and tm.codtipomov=vd.codtipomov
            and irc.codemp=tm.codemprc and irc.codfilial=tm.codfilialrc and irc.codregrcomis=tm.codregrcomis
            and vd.codemp=NEW.codemp and vd.codfilial=NEW.codfilial and vd.codvenda=NEW.codvenda
            and vd.tipovenda=NEW.tipovenda;

--  END

end ^

CREATE TRIGGER VDVENDATGBU FOR VDVENDA 
ACTIVE BEFORE UPDATE POSITION 0 
AS
  DECLARE VARIABLE ICODFILIAL INTEGER;
  DECLARE VARIABLE ICODITVENDA INTEGER;
  DECLARE VARIABLE iCodTipoMov INTEGER;
  DECLARE VARIABLE sSerie CHAR(4);
  DECLARE VARIABLE credicmssimples CHAR(1);
  DECLARE VARIABLE iCodFilialPref smallint;
  DECLARE VARIABLE dDesc NUMERIC(15, 5);
  DECLARE VARIABLE PERCPISFILIAL NUMERIC(9,2);
  DECLARE VARIABLE PERCCOFINSFILIAL NUMERIC(9,2);
  DECLARE VARIABLE PERCIRFILIAL NUMERIC(9,2);
  DECLARE VARIABLE PERCCSOCIALFILIAL NUMERIC(9,2);
  DECLARE VARIABLE PERCSIMPLESFILIAL NUMERIC(9,2);
  DECLARE VARIABLE VLRPRODITVENDA NUMERIC(15, 5);
  DECLARE VARIABLE QTDITVENDA NUMERIC(9,2);
  DECLARE VARIABLE VLRCOMISITVENDA NUMERIC(15, 5);
  DECLARE VARIABLE VLRDESCITVENDA NUMERIC(15, 5);
  DECLARE VARIABLE PERCCOMISITVENDA NUMERIC(9,2);
  DECLARE VARIABLE SIMPLESFILIAL CHAR(1);
  DECLARE VARIABLE SIMPLESCLI CHAR(1);
  DECLARE VARIABLE PESSOACLI CHAR(1);          
  DECLARE VARIABLE NVLRFRETE NUMERIC(15,5);
  DECLARE VARIABLE CADICFRETEVD CHAR(1);
  DECLARE VARIABLE PERCIT NUMERIC(9,2);
  DECLARE VARIABLE RETENSAOIMP CHAR(1);

  --DECLARE VARIABLE V_CHAVE VARCHAR(500);
  --DECLARE VARIABLE V_RECURSIVO INTEGER;
BEGIN

  --V_CHAVE = 'VDVENDATGBU'; -- Nome do objeto (trigger ou procedure) a controlar recursividade
  --V_CHAVE = V_CHAVE || '_' || IIF(INSERTING, 'INS', IIF(UPDATING, 'UPD', 'DEL')); -- tipo de evento
  --V_CHAVE = V_CHAVE || '_' || CAST(NEW.CODVENDA AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
  --V_CHAVE = V_CHAVE || '_' || CAST(NEW.TIPOVENDA AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
  --V_CHAVE = V_CHAVE || '_' || CAST(NEW.CODFILIAL AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
  --V_CHAVE = V_CHAVE || '_' || CAST(NEW.CODEMP AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria

  --EXECUTE PROCEDURE PRO_RECURSIVO(:V_CHAVE) RETURNING_VALUES (:V_RECURSIVO);

  /* Verifica se  uma chamada recursiva ou no, se no for continua */
  --IF (V_RECURSIVO = 0) THEN
  --BEGIN

    retensaoimp = 'N';

    IF (new.EMMANUT IS NULL) THEN
      new.EMMANUT='N';

    if (new.BLOQVENDA IS NULL) then
      new.BLOQVENDA='N';

    IF ( not ( (new.EMMANUT='S') or ( (old.EMMANUT='S') and (old.EMMANUT is not null)) ) ) THEN
    BEGIN

      if ( ( (old.BLOQVENDA IS  NULL) OR (old.BLOQVENDA='N') ) AND (new.BLOQVENDA='S') )  then
      begin
          new.DTALT=cast('now' AS DATE);
          new.IDUSUALT=user;
          new.HALT=cast('now' AS TIME);
      end

      IF ( (new.DTCOMPVENDA is null) or (old.DTEMITVENDA<>new.DTEMITVENDA)  ) THEN
         new.DTCOMPVENDA=new.DTEMITVENDA;

      SELECT ICODFILIAL FROM SGRETFILIAL(new.CODEMP, 'SGPREFERE1') INTO iCodFilialPref;

      EXECUTE PROCEDURE VDCLIENTEATIVOSP(new.CODEMPCL, new.CODFILIALCL, new.CODCLI);

      if ( ( (old.BLOQVENDA IS NOT NULL AND old.BLOQVENDA='S') or (new.BLOQVENDA='S') ) and coalesce(old.chavenfevenda,'')=coalesce(new.chavenfevenda,'')) then
         EXCEPTION VDVENDAEX07 'ESTA VENDA EST BLOQUEADA!!!';

      new.DTALT=cast('now' AS DATE);
      new.IDUSUALT=user;
      new.HALT=cast('now' AS TIME);
      SELECT CODFILIALSEL FROM SGCONEXAO WHERE NRCONEXAO=CURRENT_CONNECTION AND
          CONECTADO > 0 INTO ICODFILIAL;
      IF (SUBSTRING(old.STATUSVENDA FROM 1 FOR 1) = 'C' and SUBSTRING(new.STATUSVENDA FROM 1 FOR 1) <> 'C' and old.chavenfevenda=new.chavenfevenda ) THEN
        EXCEPTION VDVENDAEX05;
      IF (SUBSTRING(old.STATUSVENDA FROM 1 FOR 1) = 'D' and SUBSTRING(old.STATUSVENDA FROM 1 FOR 1) <> 'D' and old.chavenfevenda=new.chavenfevenda) THEN
        EXCEPTION VDVENDAEX05 'ESTA VENDA FOI DEVOLVIDA!';
      IF (SUBSTRING(old.STATUSVENDA FROM 1 FOR 1) = 'N' and SUBSTRING(old.STATUSVENDA FROM 1 FOR 1) <> 'N' and old.chavenfevenda=new.chavenfevenda) THEN
        EXCEPTION VDVENDAEX05 'ESTA VENDA FOI DENEGADA!';
      IF ((SUBSTRING(old.STATUSVENDA FROM 1 FOR 1) = 'P') AND (SUBSTRING(new.STATUSVENDA FROM 1 FOR 1) = 'V' ) AND new.IMPNOTAVENDA = 'N') THEN
      BEGIN
        if ( new.subtipovenda = 'NC' ) then
        begin
             SELECT T2.CODTIPOMOV, T2.SERIE FROM EQTIPOMOV T2, EQTIPOMOV T WHERE T2.CODEMP=T.CODEMPTC
               AND T2.CODFILIAL=T.CODFILIALTC AND T2.CODTIPOMOV = T.CODTIPOMOVTC
               AND T.CODEMP=new.CODEMPTM AND T.CODFILIAL=new.CODFILIALTM AND T.CODTIPOMOV=new.CODTIPOMOV
               INTO :iCodTipoMov, :sSerie;
        end
        if ( ( new.subtipovenda <> 'NC') or (iCodTipoMov is null) ) then 
        begin
             SELECT T2.CODTIPOMOV
             , (case when p.tipoemissaonfe='3' then coalesce(T2.SERIEC, T2.SERIE) else T2.SERIE end) SERIE 
             FROM EQTIPOMOV T2, EQTIPOMOV T, SGPREFERE1 P 
             WHERE T2.CODEMP=T.CODEMPTM
               AND T2.CODFILIAL=T.CODFILIALTM AND T2.CODTIPOMOV = T.CODTIPOMOVTM
               AND T.CODEMP=new.CODEMPTM AND T.CODFILIAL=new.CODFILIALTM AND T.CODTIPOMOV=new.CODTIPOMOV
               AND P.CODEMP=T.CODEMP AND P.CODFILIAL=:iCodFilialPref
               INTO :iCodTipoMov, :sSerie;
        end
        IF (iCodTipoMov IS NULL) THEN
          SELECT T.CODTIPOMOV, T.SERIE FROM SGPREFERE1 P, EQTIPOMOV T 
          WHERE P.CODEMPTM=T.CODEMP AND
                 P.CODFILIALTM=T.CODFILIAL AND P.CODTIPOMOV = T.CODTIPOMOV
                 AND P.CODEMP=new.CODEMP AND P.CODFILIAL = :iCodFilialPref INTO :iCodTipoMov, :sSerie;
        new.CODTIPOMOV = :iCodTipoMov;
        new.SERIE = :sSerie;
        IF ( ( not (old.IMPNOTAVENDA = 'S') ) AND ( not (new.IMPNOTAVENDA = 'S') ) ) THEN
        BEGIN
            SELECT DOC FROM LFNOVODOCSP(new.Serie,new.CODEMPSE,new.CODFILIALSE) INTO new.DocVenda;
            new.IMPNOTAVENDA = 'S';
        END
      END
      SELECT FISCALTIPOMOV FROM EQTIPOMOV WHERE CODTIPOMOV=new.CODTIPOMOV
             AND CODEMP=new.CODEMP AND CODFILIAL = new.codfilialtm INTO new.FLAG;
      IF (new.FLAG<>'S') THEN
        new.FLAG = 'N';
      SELECT VLRFRETEVD, ADICFRETEVD FROM VDFRETEVD WHERE CODVENDA=old.CODVENDA AND TIPOVENDA=old.TIPOVENDA AND ADICFRETEVD = 'S'
             AND CODEMP=old.CODEMP AND CODFILIAL = old.codfilial INTO new.VLRFRETEVENDA, :CADICFRETEVD;
      IF (new.VLRDESCVENDA IS NULL) THEN
        new.VLRDESCVENDA = 0;
      IF (new.VLRDESCITVENDA IS NULL) THEN
        new.VLRDESCITVENDA = 0;
      IF (new.VLRADICVENDA IS NULL) THEN
        new.VLRADICVENDA = 0;
      IF (new.VLRFRETEVENDA IS NULL) THEN
        new.VLRFRETEVENDA = 0;
      IF (new.VLRPRODVENDA IS NULL) THEN
        new.VLRPRODVENDA = 0;
      IF (new.VLRIPIVENDA IS NULL) THEN
        new.VLRIPIVENDA = 0;
      IF (new.VLRBASEICMSVENDA IS NULL) THEN
        new.VLRBASEICMSVENDA = 0;
      IF (new.VLRDESCITVENDA > 0) THEN
        dDesc = new.VLRDESCITVENDA;
      ELSE
        dDesc = new.VLRDESCVENDA;
      IF (new.VLRBASEICMSSTVENDA IS NULL) THEN
        new.VLRBASEICMSSTVENDA = 0;
      IF (new.VLRICMSSTVENDA IS NULL) THEN
        new.VLRICMSSTVENDA = 0;

      SELECT C.SIMPLESCLI,C.PESSOACLI FROM VDCLIENTE C WHERE C.CODCLI=new.CODCLI AND
        C.CODFILIAL=new.CODFILIALCL AND C.CODEMP=new.CODEMPCL INTO SIMPLESCLI,PESSOACLI;
      SELECT SIMPLESFILIAL,PERCPISFILIAL,PERCCOFINSFILIAL,PERCIRFILIAL,PERCCSOCIALFILIAL,coalesce(PERCSIMPLESFILIAL,0)
        FROM SGFILIAL WHERE CODEMP=new.CODEMP AND CODFILIAL=:ICODFILIAL
        INTO SIMPLESFILIAL,PERCPISFILIAL,PERCCOFINSFILIAL,PERCIRFILIAL,PERCCSOCIALFILIAL,PERCSIMPLESFILIAL;
      IF (SIMPLESFILIAL = 'N') THEN
      BEGIN
        new.VLRIRVENDA = (new.vlrliqvenda/100)*PERCIRFILIAL;
        new.VLRCSOCIALVENDA = (new.vlrliqvenda/100)*PERCCSOCIALFILIAL;
      END
      ELSE
      BEGIN
        new.VLRIRVENDA = 0;
        new.VLRCSOCIALVENDA = 0;

        /*Verifica se deve destacar crdito de icms (simples)*/
        select p1.credicmssimples,p1.retensaoimp from sgprefere1 p1 where p1.codemp=new.codemp and p1.codfilial=:icodfilialpref
        into credicmssimples,retensaoimp;

        if(credicmssimples='S') then
        begin
            new.vlricmssimples = (new.vlrprodvenda/100) * percsimplesfilial ;
            new.percicmssimples = percsimplesfilial;
        end

      END
      if (CADICFRETEVD = 'S') then
         NVLRFRETE = new.VLRFRETEVENDA;
      else
         NVLRFRETE = 0;

      new.VLRLIQVENDA = coalesce(new.VLRPRODVENDA,0)
                      - coalesce(dDesc,0)
                      + coalesce(new.VLRADICVENDA,0)
                      + coalesce(:NVLRFRETE,0)
                      + coalesce(new.VLRIPIVENDA,0)
                      + coalesce(new.vlricmsstvenda,0);

      if (SIMPLESCLI = 'N' AND PESSOACLI = 'J' AND RETENSAOIMP = 'S') then
      begin
        new.VLRLIQVENDA =
             cast(
                (coalesce(new.VLRLIQVENDA,0)) -
                (case when new.calcpisvenda='S' then coalesce(new.vlrpisvenda,0) else 0 end) -
                (case when new.calccofinsvenda='S' then coalesce(new.vlrcofinsvenda,0) else 0 end) -
                (case when new.calcirvenda='S' then coalesce(new.vlrirvenda,0) else 0 end) -
                (case when new.calccsocialvenda='S' then coalesce(new.vlrcsocialvenda,0) else 0 end)
            as numeric(15, 5));
      end

      IF ((SUBSTRING(old.STATUSVENDA FROM 1 FOR 1) IN ('P','V')) AND (SUBSTRING(new.STATUSVENDA FROM 1 FOR 1) IN ('C','N'))) THEN
      BEGIN
          new.VLRDESCITVENDA = 0;
          new.VLRPRODVENDA = 0;
          new.VLRBASEICMSVENDA = 0;
          new.VLRICMSVENDA = 0;
          new.VLRISENTASVENDA = 0;
          new.VLROUTRASVENDA = 0;
          new.VLRBASEIPIVENDA = 0;
          new.VLRIPIVENDA = 0;
          new.VLRLIQVENDA = 0;
          new.VLRCOMISVENDA = 0;
          new.VLRISSVENDA = 0;
          new.VLRBASEISSVENDA = 0;
          new.vlrpisvenda = 0;
          new.vlrcofinsvenda = 0;
          new.vlrirvenda = 0;
          new.vlrcsocialvenda =0;
          new.vlrbaseicmsstvenda=0;
          new.vlricmsstvenda=0;
      END
      /**
       COMISSAO
      **/
      IF ((NOT NEW.VLRCOMISVENDA IS NULL) AND
          (NEW.VLRLIQVENDA > 0) AND
          ((NOT NEW.VLRDESCVENDA = OLD.VLRDESCVENDA) OR (NOT NEW.PERCMCOMISVENDA = OLD.PERCMCOMISVENDA))) then
      BEGIN
        /* Distribuindo a comissao: */
        FOR SELECT CODITVENDA,VLRPRODITVENDA,QTDITVENDA,coalesce(VLRCOMISITVENDA,0),coalesce(vlrdescitvenda,0),
            coalesce(iv.perccomisitvenda,0)
            FROM VDITVENDA IV
            WHERE CODEMP=new.CODEMP AND CODFILIAL=new.CODFILIAL AND CODVENDA=new.CODVENDA and tipovenda=new.tipovenda
            INTO ICODITVENDA,VLRPRODITVENDA,QTDITVENDA,VLRCOMISITVENDA,VLRDESCITVENDA,PERCCOMISITVENDA DO
        BEGIN
          /* Calculo do item.: */
          /* INCLUIDO PARA DISTRIBUIR A COMISSAO MENOS O DESCONTO PROPORCIONALMENTE*/
          PERCIT = 0;
          IF (new.VLRPRODVENDA > 0 AND NOT new.VLRDESCITVENDA > 0 AND new.VLRDESCVENDA > 0) THEN
          BEGIN
            PERCIT = (100*VLRPRODITVENDA) / new.VLRPRODVENDA;
            VLRDESCITVENDA = (new.VLRDESCVENDA  * PERCIT) / 100;
          END
          IF (new.VLRPRODVENDA > 0 AND new.PERCMCOMISVENDA > 0) THEN
          BEGIN
            PERCCOMISITVENDA = new.PERCMCOMISVENDA;
            /* Retira.. */
            new.VLRCOMISVENDA = new.VLRCOMISVENDA - VLRCOMISITVENDA;
            /* Atualiza.. */
            VLRCOMISITVENDA = ((VLRPRODITVENDA - VLRDESCITVENDA) * PERCCOMISITVENDA) / 100;
            /* Adiciona.. */
            new.VLRCOMISVENDA = new.VLRCOMISVENDA + VLRCOMISITVENDA;
          END
          ELSE IF (new.PERCMCOMISVENDA=0) then
          BEGIN
              VLRCOMISITVENDA = 0;
              PERCCOMISITVENDA = 0;
              new.VLRCOMISVENDA = 0;
          END
          UPDATE VDITVENDA SET VLRCOMISITVENDA=:VLRCOMISITVENDA,PERCCOMISITVENDA=:PERCCOMISITVENDA
          WHERE CODITVENDA=:ICODITVENDA AND CODVENDA=new.CODVENDA AND TIPOVENDA=new.TIPOVENDA AND CODEMP=new.CODEMP AND CODFILIAL=new.CODFILIAL;
        END
      END
      /* Calcula o percentual medio da comissao */
      ELSE IF (new.PERCMCOMISVENDA = old.PERCMCOMISVENDA AND new.VLRLIQVENDA > 0) THEN
      begin
        -- new.PERCMCOMISVENDA = (new.VLRCOMISVENDA/new.VLRLIQVENDA)*100.000;
        -- Modificado, pois causava divergencia em vendas geradas a partir de oramentos.
        if ((new.vlrprodvenda-new.vlrdescvenda)>0) then
        begin
          new.PERCMCOMISVENDA = (new.VLRCOMISVENDA/(new.vlrprodvenda-new.vlrdescvenda)) * 100;
        end
        else
        begin
          new.PERCMCOMISVENDA = 0;
        end
      end

      IF (new.STATUSVENDA = 'V4') THEN
      BEGIN
        new.IMPNOTAVENDA = 'S';
        new.STATUSVENDA = 'V3';
      END
      IF ((new.IMPNOTAVENDA = 'S') AND (old.IMPNOTAVENDA = 'S')) THEN
      BEGIN
        new.DOCVENDA = old.DOCVENDA;
      END
    END

    -- Atualizando o status do documento fiscal para 02 - Documento cancelado, quando nota for cancelado pelo sistema.
    IF (SUBSTRING(new.STATUSVENDA FROM 1 FOR 1) IN ('C','N') and new.sitdoc!='02') THEN
    begin
      new.sitdoc = '02';
    end

    if(old.chavenfevenda is null and new.chavenfevenda is not null) then
    begin
      new.emmanut = 'N';
    end

  --END

END ^

CREATE TRIGGER VDVENDATGAU FOR VDVENDA 
ACTIVE AFTER UPDATE POSITION 0 
as
    declare variable icodrec integer;
    declare variable scodfilialrc smallint;
    declare variable icoditvenda integer;
    declare variable percred numeric(15,5);
    declare variable percit numeric(15,5);
    declare variable percicmsitvenda numeric(15,5);
    declare variable percipiitvenda numeric(15,5);
    declare variable tipofisc char(2);
    declare variable vlrdescitvenda numeric(15, 5);
    declare variable vlrbaseipiitvenda numeric(15, 5);
    declare variable vlrbaseicmsitvenda numeric(15, 5);
    declare variable vlrbaseicmsfreteitvenda numeric(15, 5);
    declare variable vlripiitvenda numeric(15, 5);
    declare variable vlrproditvenda numeric(15, 5);
    declare variable vlrliqitvenda numeric(15, 5);
    declare variable vlricmsitvenda numeric(15, 5);
    declare variable vlricmsfreteitvenda numeric(15, 5);
    declare variable tipomov char(2);
    declare variable vlrmfintipomov char(1);
    declare variable vlrtmp numeric(15, 5);
    declare variable qtditvenda numeric(15,5);
    declare variable nvlrparcrec numeric(15, 5);
    declare variable nvlrcomirec numeric(15, 5);
    declare variable percitfrete numeric(15, 5);
    declare variable vlritfrete numeric(15, 5);
    declare variable snroparcrec smallint;
    declare variable codempif integer;
    declare variable codfilialif smallint;
    declare variable codfisc char(13);
    declare variable coditfisc integer;
    declare variable dtrec date;
    declare variable gerarecemis char(1);
    declare variable tpredicms char(1);
    declare variable redbasefrete char(1);
    declare variable vlrretensaoiss numeric(15, 5);
    declare variable icodmodnota integer;

  --DECLARE VARIABLE V_CHAVE VARCHAR(500);
  --DECLARE VARIABLE V_RECURSIVO INTEGER;
BEGIN

  --V_CHAVE = 'VDVENDATGAU'; -- Nome do objeto (trigger ou procedure) a controlar recursividade
  --V_CHAVE = V_CHAVE || '_' || IIF(INSERTING, 'INS', IIF(UPDATING, 'UPD', 'DEL')); -- tipo de evento
  --V_CHAVE = V_CHAVE || '_' || CAST(NEW.CODVENDA AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
  --V_CHAVE = V_CHAVE || '_' || CAST(NEW.TIPOVENDA AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
  --V_CHAVE = V_CHAVE || '_' || CAST(NEW.CODFILIAL AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
  --V_CHAVE = V_CHAVE || '_' || CAST(NEW.CODEMP AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria

  --EXECUTE PROCEDURE PRO_RECURSIVO(:V_CHAVE) RETURNING_VALUES (:V_RECURSIVO);

  /* Verifica se  uma chamada recursiva ou no, se no for continua */
  --IF (V_RECURSIVO = 0) THEN
  --BEGIN

        if ( not ( (new.emmanut='S') or ( (old.emmanut='S') and (old.emmanut is not null) )) ) then
        begin

        -- buscando preferncias
        select gerarecemis from sgprefere1 p1 where p1.codemp=new.codemp and p1.codfilial=new.codfilial
        into :gerarecemis;

        -- Se foi dado desconto ou alterado o valor do frete da venda

        if ((not new.vlrdescvenda = old.vlrdescvenda) or (not new.vlrfretevenda = old.vlrfretevenda) ) then
        begin

            -- distribuindo o desconto e frete csocial e ir:

            for select coditvenda,percicmsitvenda,vlrdescitvenda,
                vlrliqitvenda,vlrproditvenda,qtditvenda,codempif,codfilialif,codfisc,coditfisc
                from vditvenda
                where codemp=new.codemp and codfilial=new.codfilial and codvenda=new.codvenda and tipovenda=new.tipovenda
                into icoditvenda,percicmsitvenda,
                vlrdescitvenda,vlrliqitvenda,vlrproditvenda,qtditvenda,codempif,codfilialif,codfisc,coditfisc
            do
            begin

                -- distribuio do desconto
                percit = 0;
                if (new.vlrprodvenda > 0 and not new.vlrdescitvenda > 0 and new.vlrdescvenda > 0) then
                begin
                    percit = (100*vlrproditvenda) / new.vlrprodvenda;
                    vlrdescitvenda = (new.vlrdescvenda  * percit) / 100;
                end

                -- distribuio do frete
                if ( new.vlrfretevenda > 0 and ( not new.vlrfretevenda = old.vlrfretevenda) ) then
                begin
                    percitfrete = :vlrproditvenda / new.vlrprodvenda ;
                    vlritfrete =  :percitfrete * new.vlrfretevenda ;
                end

                -- busca informaes fiscais.:
                select first 1 i.redfisc, i.aliqipifisc, i.tipofisc, i.tpredicmsfisc, i.redbasefrete
                from lfitclfiscal i
                where i.codemp=:codempif and i.codfilial=:codfilialif and i.codfisc=:codfisc and i.coditfisc=:coditfisc
                into percred, percipiitvenda, tipofisc, tpredicms, redbasefrete;

                if (percred is null) then
                    percred = 0;

                if (percipiitvenda is null) then
                    percipiitvenda = 0;

                if (percicmsitvenda is null) then
                    percicmsitvenda = 0;

                vlrliqitvenda = vlrproditvenda - vlrdescitvenda;
                vlrbaseipiitvenda = 0;
                vlrbaseicmsitvenda = 0;
                vlricmsitvenda = 0;
                vlripiitvenda = 0;

                if (qtditvenda > 0) then
                begin
                    vlrtmp = vlrliqitvenda/qtditvenda;
                    vlrdescitvenda = vlrproditvenda - (vlrtmp*qtditvenda);
                    vlrliqitvenda = vlrproditvenda - vlrdescitvenda;
                end

                if ( tipofisc = 'II' ) then -- Isento de ICMS
                begin
                    percicmsitvenda = 0;
                    vlricmsitvenda = 0;
                    vlrbaseicmsfreteitvenda = 0;
                    vlrbaseicmsitvenda = 0;
                    percipiitvenda = 0;
                    vlripiitvenda = 0;
                    vlrbaseipiitvenda = 0;
                end
                else if ( tipofisc = 'FF' ) then -- Substituio tributria do icms
                begin
                    vlrbaseicmsitvenda = vlrliqitvenda - (vlrproditvenda*(percred/100));
                    vlricmsitvenda = vlrbaseicmsitvenda*(percicmsitvenda/100);
                    vlrbaseipiitvenda = vlrliqitvenda;
                    vlripiitvenda = vlrbaseipiitvenda*(percipiitvenda/100);
                end
                else if ( tipofisc = 'NN') then -- No insidncia do icms
                begin
                    percicmsitvenda = 0;
                    vlricmsitvenda = 0;
                    vlrbaseicmsitvenda = 0;
                    vlrbaseicmsfreteitvenda = 0;
                    percipiitvenda = 0;
                    vlripiitvenda = 0;
                    vlrbaseipiitvenda = 0;
                end
                else if ( tipofisc = 'TT') then -- Tributado integralmente o icms
                begin

                    vlrbaseicmsitvenda = vlrliqitvenda;
                    vlrbaseicmsfreteitvenda = vlritfrete;

                    if(percred>0) then
                    begin
                        if(:tpredicms='B') then
                        begin
                            --Se deve reduzir a base do icms do frete...

                            if(:redbasefrete='S' and vlritfrete>0) then
                            begin
                                vlrbaseicmsfreteitvenda = vlritfrete - ( vlritfrete *(percred/100) );
                                vlricmsfreteitvenda = vlrbaseicmsfreteitvenda*(percicmsitvenda/100);
                            end
                            else
                            begin
                                vlrbaseicmsfreteitvenda = vlritfrete;
                            end

                            --vlrbaseicmsitvenda = vlrliqitvenda - (vlrproditvenda*(percred/100));
                            -- Revisao 12/07/2010 - Robson Sanchez
                            -- Foram separados os calculos de ICMS do frete e da venda.
                            -- Em virtude disso a formacao da base de calculo nao pode ser sobre o valor liquido,
                            -- pois o valor liquido pode conter valor adicional de frete, causando duplicacao de impostos.

                            vlrbaseicmsitvenda = (vlrproditvenda + vlripiitvenda - vlrdescitvenda)*(1-(percred/100));

                            vlricmsitvenda = vlrbaseicmsitvenda*(percicmsitvenda/100);

                        end
                        else if(:tpredicms='V') then
                        begin
                            vlricmsitvenda = ( vlrbaseicmsitvenda*(percicmsitvenda/100) );
                            vlricmsitvenda = vlricmsitvenda - ( vlricmsitvenda * (percred/100) );

                            vlricmsfreteitvenda = vlrbaseicmsfreteitvenda*(percicmsitvenda/100);
                            vlricmsfreteitvenda = vlricmsfreteitvenda - ( vlricmsfreteitvenda * (percred/100) );

                        end
                    end
                    else
                    begin
                        vlricmsitvenda = vlrbaseicmsitvenda*(percicmsitvenda/100);
                        vlricmsfreteitvenda = vlrbaseicmsfreteitvenda*(percicmsitvenda/100);
                    end

                    vlrbaseipiitvenda = vlrliqitvenda;
                    vlripiitvenda = vlrbaseipiitvenda*(percipiitvenda/100);

                end

                -- atualizando tabela de tens
                update vditvenda set
                vlrbaseicmsitvenda = :vlrbaseicmsitvenda, vlrbaseipiitvenda = :vlrbaseipiitvenda,
                vlricmsitvenda = :vlricmsitvenda, vlripiitvenda = :vlripiitvenda,
                vlrdescitvenda = :vlrdescitvenda, vlrliqitvenda = :vlrliqitvenda,
                vlrfreteitvenda = :vlritfrete
                where
                codemp=new.codemp and codfilial=new.codfilial and codvenda=new.codvenda and
                coditvenda=:icoditvenda and tipovenda=new.tipovenda;

                -- Atualizando tabela de tributos referente ao frete
                if(new.vlrfretevenda != old.vlrfretevenda) then
                begin
                    update lfitvenda set
                    vlrbaseicmsfreteitvenda = :vlrbaseicmsfreteitvenda,
                    vlricmsfreteitvenda = :vlricmsfreteitvenda
                    where
                    codemp=new.codemp and codfilial=new.codfilial and codvenda=new.codvenda and
                    coditvenda=:icoditvenda and tipovenda=new.tipovenda;
                end

            end
        end


    -- Busca informaes do tipo de movimento da venda
    select tipomov, vlrmfintipomov
    from eqtipomov
    where codtipomov=new.codtipomov and codemp=new.codemptm and codfilial=new.codfilialtm
    into tipomov, vlrmfintipomov;

    -- Busca informaes do contas a receber da venda
    select codrec
    from fnreceber
    where codvenda=new.codvenda and tipovenda=new.tipovenda and codemp=new.codemp and codfilialva=new.codfilial
    into icodrec;

    -- Verifica de
    if ((not tipomov in ('DV','TR')) and ((icodrec is null) or ((new.codplanopag != old.codplanopag) or
        (new.codcli != old.codcli) or (new.codvend != old.codvend) or (new.vlrliqvenda != old.vlrliqvenda) or
        (new.dtemitvenda != old.dtemitvenda) or (new.docvenda != old.docvenda) or (new.codbanco != old.codbanco)))) then

    begin

        if(gerarecemis = 'S') then
        begin
            dtrec = new.dtemitvenda;
        end
        else
        begin
            dtrec = new.dtsaidavenda;
        end


        -- Verica se deve haver retenso de ISS

        select sum(coalesce(iv.vlrissitvenda,0))
        from vditvenda iv left outer join lfitclfiscal cf on
        cf.codemp=iv.codempif and cf.codfilial=iv.codfilialif and cf.codfisc=iv.codfisc and cf.coditfisc=iv.coditfisc and cf.retensaoiss='S'
        where iv.codemp=new.codemp and iv.codfilial=new.codfilial and iv.codvenda=new.codvenda and iv.tipovenda=new.tipovenda
        and iv.vlrissitvenda>0
        into :vlrretensaoiss;

        if(:vlrretensaoiss is null) then
        begin
            vlrretensaoiss = 0;
        end

        -- De pedido para Venda
        if ((SUBSTRING(old.statusvenda FROM 1 FOR 1) = 'P') and (SUBSTRING(new.statusvenda FROM 1 FOR 1) = 'V' ) or
        ( (not new.vlrcomisvenda=old.vlrcomisvenda ) and (not new.statusvenda in ('P1','V1') ) ) ) then

        begin
           if (new.vlrliqvenda > 0) then
           begin

              execute procedure fnadicrecebersp01(
                   new.tipovenda, new.codvenda,
                   new.codemptc, new.codfilialtc, new.codtipocob,
                   new.codemppg,new.codfilialpg,new.codplanopag,
                   new.codempcl,new.codfilialcl,new.codcli,
                   new.codempvd,new.codfilialvd,new.codvend,
                   new.vlrliqvenda,dtrec, new.dtcompvenda, new.vlrcomisvenda,new.docvenda,
                   new.codempbo,new.codfilialbo,new.codbanco,
                   new.codemp,new.codfilial,
                   new.codempcb, new.codfilialcb, new.codcartcob, 
                   new.codempca, new.codfilialca, new.numconta,
                   new.flag, new.obsrec, new.vlrbasecomis, :vlrretensaoiss);
           end
           else
           begin
               delete from fnreceber where codvenda = new.codvenda and tipovenda=new.tipovenda and codemp=new.codemp and codfilialva = new.codfilial;
           end
           
           SELECT CODMODNOTA FROM EQTIPOMOV m WHERE m.codemp=new.codemptm and m.codfilial=new.codfilialtm and m.codtipomov=new.codtipomov INTO ICODMODNOTA;
           --execute procedure sgdebugsp 'vdvendatgbu', 'PEGOU O MODELO DE NOTA:'||:ICODMODNOTA;
           IF(:ICODMODNOTA=55) THEN
           BEGIN
             --execute procedure sgdebugsp 'vdvendatgbu', 'ENTROU NO IF MODELO DA NOTA  IGUAL A 55:';
             execute procedure sggeracnfsp('VD', new.codemp, new.codfilial, new.tipovenda, new.codvenda,null,null,null);
           END
        end
        -- De pedido ou venda aberto mudou para finalizado
        if ((new.statusvenda in ('P2','V2')) and (old.statusvenda in ('P1','V1'))) then
        begin
           if (new.vlrliqvenda > 0) then
               execute procedure fnadicrecebersp01(
                   new.tipovenda, new.codvenda,
                   new.codemptc, new.codfilialtc, new.codtipocob,
                   new.codemppg,new.codfilialpg,new.codplanopag,
                   new.codempcl,new.codfilialcl,new.codcli,
                   new.codempvd,new.codfilialvd,new.codvend,
                   new.vlrliqvenda,new.dtsaidavenda, new.dtcompvenda, new.vlrcomisvenda,new.docvenda,
                   new.codempbo,new.codfilialbo,new.codbanco,
                   new.codemp,new.codfilial,
                   new.codempcb, new.codfilialcb, new.codcartcob, 
                   new.codempca, new.codfilialca, new.numconta,
                   new.flag, new.obsrec, new.vlrbasecomis, :vlrretensaoiss);
           else
           begin
               delete from fnreceber where codvenda = new.codvenda and tipovenda=new.tipovenda and codemp=new.codemp and codfilialva = new.codfilial;
           end
        end
        -- De pedido fechado para venda fechada ou venda fechada para pedido fechado, ou sem alterao (em processo de fechamento)
        else if ((new.statusvenda in ('P2','V2')) and (old.statusvenda in ('P2','V2'))) then
        begin
           if (new.vlrliqvenda > 0) then
               execute procedure fnadicrecebersp01(
                   new.tipovenda, new.codvenda,
                   new.codemptc, new.codfilialtc, new.codtipocob,
                   new.codemppg,new.codfilialpg,new.codplanopag,
                   new.codempcl,new.codfilialcl,new.codcli,
                   new.codempvd,new.codfilialvd,new.codvend,
                   new.vlrliqvenda,new.dtsaidavenda, new.dtcompvenda, new.vlrcomisvenda,new.docvenda,
                   new.codempbo,new.codfilialbo,new.codbanco,
                   new.codemp,new.codfilial,
                   new.codempcb, new.codfilialcb, new.codcartcob, 
                   new.codempca, new.codfilialca, new.numconta,
                   new.flag, new.obsrec, new.vlrbasecomis, :vlrretensaoiss);
           else
           begin
                delete from fnreceber where codvenda = new.codvenda and tipovenda=new.tipovenda and codemp=new.codemp and codfilialva = new.codfilial;
           end
        end
        -- De pedido emitido para venda emitida ou venda emitida para pedido emitido, ou sem alterao
        else if ((new.statusvenda in ('P3','V3')) and (old.statusvenda in ('P3','V3'))) then
        begin
           if (new.vlrliqvenda > 0) then
               execute procedure fnadicrecebersp01(
                   new.tipovenda, new.codvenda,
                   new.codemptc, new.codfilialtc, new.codtipocob,
                   new.codemppg,new.codfilialpg,new.codplanopag,
                   new.codempcl,new.codfilialcl,new.codcli,
                   new.codempvd,new.codfilialvd,new.codvend,
                   new.vlrliqvenda,new.dtsaidavenda, new.dtcompvenda, new.vlrcomisvenda,new.docvenda,
                   new.codempbo,new.codfilialbo,new.codbanco,
                   new.codemp,new.codfilial,
                   new.codempcb, new.codfilialcb, new.codcartcob,
                   new.codempca, new.codfilialca, new.numconta,
                   new.flag, new.obsrec, new.vlrbasecomis, :vlrretensaoiss);
           else
           begin
               delete from fnreceber where codvenda = new.codvenda and tipovenda=new.tipovenda and codemp=new.codemp and codfilialva = new.codfilial;
           end
        end
      end
      if (old.vlrcomisvenda != new.vlrcomisvenda) then
      begin
          update fnreceber set vlrcomirec=new.vlrcomisvenda
          where codvenda=new.codvenda and tipovenda=new.tipovenda and codempvd=new.codemp and
                codfilialvd=new.codfilial;
      end
      else if (old.codclcomis != new.codclcomis) then
      begin
          select r.codfilial,r.codrec,r.vlrparcrec,r.vlrcomirec,r.nroparcrec
              from fnreceber r
              where r.codvenda=new.codvenda and r.tipovenda=new.tipovenda
              and r.codempva=new.codemp and r.codfilialva=new.codfilial
              into :scodfilialrc, :icodrec, :nvlrparcrec, :nvlrcomirec, :snroparcrec;
          execute procedure fnitrecebersp01(new.codemp,:scodfilialrc,:icodrec,
                :nvlrparcrec,:nvlrcomirec,:snroparcrec,'S');
      end

      /**
        testa valor das parcelas x valor da venda
      **/
      if ((old.statusvenda in ('P2','V2')) and (new.statusvenda in ('P3','V3')) and (vlrmfintipomov<>'S') ) then
      begin
        select vlrparcrec from fnreceber
            where codvenda=new.codvenda and tipovenda=new.tipovenda
            and codempva=new.codemp and codfilialva = new.codfilial
            into :nvlrparcrec;

       if (new.vlrliqvenda-:vlrretensaoiss != :nvlrparcrec) then
        begin
            exception vdvendaex06;
        end

      end

      -- Caso a data ou o tipo de movimento tenham sido alterados, deve disparar o trigger da vditvenda
    if ( (new.dtsaidavenda != old.dtsaidavenda) or (new.codtipomov!=old.codtipomov) or ( new.docvenda != old.docvenda )  ) then
    begin
        -- Update necessrio para disparar o trigger da tabela vditvenda
        update vditvenda set coditvenda=coditvenda
        where codvenda = old.codvenda and tipovenda = old.tipovenda and codemp=old.codemp and codfilial=old.codfilial;
    end
    else if ((SUBSTRING(new.statusvenda FROM 1 FOR 1) IN ('C','N')) and (SUBSTRING(old.statusvenda FROM 1 FOR 1) in ('P','V'))) then
    begin

        delete from vdvendaorc where codemp=new.codemp and codfilial=new.codfilial and
        codvenda=new.codvenda and tipovenda=new.tipovenda;

        update vditvenda set qtditvendacanc=qtditvenda, qtditvenda=0 where codvenda=new.codvenda and tipovenda=new.tipovenda and
        codemp=new.codemp and codfilial=new.codfilial;

        delete from fnreceber where codvenda=new.codvenda and tipovenda=new.tipovenda and
        codemp=new.codemp and codfilialva=new.codfilial;

      end
      -- Verificao se existem registros na tabela eqmovserie com o mesmo cdigo de venda
      -- caso existam registros, os mesmos devem ser atualizados para o novo documento de venda,
      -- para que sejam listados no mdulo GMS Consulta Mov. Srie, com o documento correto de sada.
      -- antes desta alterao havia apenas a insero de registros na tabela eqmovserie com nmero
      -- de documento de pedido, no sendo atualizado aps o pedido se transforme em PV PS PR PD
      if (old.docvenda<>new.docvenda) then 
      begin
         update eqmovserie eqm set eqm.docmovserie=new.docvenda 
            where eqm.codempvd=new.codemp and eqm.codfilialvd=new.codfilial and 
              eqm.tipovenda=new.tipovenda and eqm.codvenda=new.codvenda and eqm.docmovserie<>new.docvenda;
      end

    end

  --END
  
end ^

CREATE TRIGGER VDVENDATGBD FOR VDVENDA 
ACTIVE BEFORE DELETE POSITION 0 
AS
  --DECLARE VARIABLE V_CHAVE VARCHAR(500);
  --DECLARE VARIABLE V_RECURSIVO INTEGER;
BEGIN

  --V_CHAVE = 'VDVENDATGBD'; -- Nome do objeto (trigger ou procedure) a controlar recursividade
  --V_CHAVE = V_CHAVE || '_' || IIF(INSERTING, 'INS', IIF(UPDATING, 'UPD', 'DEL')); -- tipo de evento
  --V_CHAVE = V_CHAVE || '_' || CAST(OLD.CODVENDA AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
  --V_CHAVE = V_CHAVE || '_' || CAST(OLD.TIPOVENDA AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
  --V_CHAVE = V_CHAVE || '_' || CAST(OLD.CODFILIAL AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria
  --V_CHAVE = V_CHAVE || '_' || CAST(OLD.CODEMP AS VARCHAR(50)); -- concatenao dos campos que formam a chave primria

  --EXECUTE PROCEDURE PRO_RECURSIVO(:V_CHAVE) RETURNING_VALUES (:V_RECURSIVO);

  /* Verifica se  uma chamada recursiva ou no, se no for continua */
  --IF (V_RECURSIVO = 0) THEN
  --BEGIN

    IF ( not ( ( old.EMMANUT='S') and (old.EMMANUT IS NOT NULL) ) ) THEN
    BEGIN

        if ( (old.BLOQVENDA IS NOT NULL) AND (old.BLOQVENDA='S') ) then
          EXCEPTION VDVENDAEX05 'ESTA VENDA EST BLOQUEADA!!!';
        DELETE FROM VDFRETEVD WHERE CODVENDA=old.CODVENDA  AND TIPOVENDA=old.TIPOVENDA
          AND CODEMP=old.CODEMP AND CODFILIAL = old.CODFILIAL;

    END

  --END

END ^

CREATE TRIGGER VDVENDACOMISTGBU FOR VDVENDACOMIS 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER VDVENDACONSIGTGBU FOR VDVENDACONSIG 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=user;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER VDVENDAENTREGATGBU FOR VDVENDAENTREGA 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT = cast('now' AS TIME);
end ^

CREATE TRIGGER VDVENDAORCTGAI FOR VDVENDAORC 
ACTIVE AFTER INSERT POSITION 0 
AS
    declare variable qtditvenda numeric(15,5);
begin
    -- Insero de registro de movimentao de numero de srie,
    -- para faturamento de sevios de conserto (recmerc/Ordens de servio)
   -- EXECUTE PROCEDURE sgdebugsp 'vdvendaorctgai, orc.: '||new.codorc, 'inicio do vdvendaorctgai '|| cast('now' as time);

    insert into eqmovserie (
        codemp      , codfilial     , codmovserie   , codemppd      , codfilialpd   , codprod    ,
        numserie    , codempvd      , codfilialvd   , codvenda      , coditvenda    , tipovenda  ,
        dtmovserie  , tipomovserie  , docmovserie
    )
    select
        ir.codemp, ir.codfilial, coalesce((select max(codmovserie) + 1 from eqmovserie where codemp=vd.codemp and codfilial=vd.codfilial),1), ir.codemppd, ir.codfilialpd, ir.codprod,
        ir.numserie, new.codemp, new.codfilial, new.codvenda, new.coditvenda, new.tipovenda, vd.dtsaidavenda, -1, vd.docvenda
    from eqitrecmercitositorc ro, eqitrecmerc ir, vdvenda vd, vditvenda iv
    where
        ro.codemp=new.codempor and ro.codfilial=new.codfilialor and ro.codorc=new.codorc and ro.tipoorc=new.tipoorc and ro.coditorc=new.coditorc and
        ir.codemp=ro.codemp and ir.codfilial=ro.codfilial and ir.ticket=ro.ticket and ir.coditrecmerc=ro.coditrecmerc and
        iv.codemp=new.codemp and iv.codfilial=new.codfilial and iv.codvenda=new.codvenda and iv.tipovenda=new.tipovenda and iv.coditvenda=new.coditvenda and
        vd.codemp=iv.codemp and vd.codfilial=iv.codfilial and vd.tipovenda=iv.tipovenda and vd.codvenda=iv.codvenda and
        ir.numserie is not null;

--    EXECUTE PROCEDURE sgdebugsp 'vdvendaorctgai, orc.: '||new.codorc, 'aps insert no eqmovserie '|| cast('now' as time);

    -- Atualizando status do item de oramento indicando que o mesmo foi faturado.
    select iv.qtditvenda from vditvenda iv where iv.codemp=new.codemp and iv.codfilial=new.codfilial and 
       iv.tipovenda=new.tipovenda and iv.codvenda=new.codvenda and iv.coditvenda=new.coditvenda
       into :qtditvenda;

--    EXECUTE PROCEDURE sgdebugsp 'vdvendaorctgai, orc.: '||new.codorc, 'aps select vditvenda '|| cast('now' as time);
       
    update vditorcamento io set
    --io.emmanut='S',
    io.statusitorc='OV', io.qtdfatitorc=coalesce(io.qtdfatitorc,0)+coalesce(:qtditvenda,0)
    where io.codemp=new.codempor and io.codfilial=new.codfilialor and io.codorc=new.codorc and io.tipoorc=new.tipoorc and io.coditorc=new.coditorc
    and (io.statusitorc<>'OV' or io.qtdfatitorc is null or io.qtdfatitorc<>coalesce(io.qtdfatitorc,0)+coalesce(:qtditvenda,0) ) ;

--    update vditorcamento io set io.emmanut='N'
--     where io.codemp=new.codempor and io.codfilial=new.codfilialor and io.codorc=new.codorc and io.tipoorc=new.tipoorc and io.coditorc=new.coditorc
--    and io.emmanut='S'
--    and (io.statusitorc<>'OV' or io.qtdfatitorc is null or io.qtdfatitorc<>coalesce(io.qtdfatitorc,0)+coalesce(:qtditvenda,0) ) ;
--    EXECUTE PROCEDURE sgdebugsp 'vdvendaorctgai, orc.: '||new.codorc, 'aps update vditorcamento '|| cast('now' as time);


end ^

CREATE TRIGGER VDVENDAORCTGBU FOR VDVENDAORC 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
new.DTALT=cast('now' as date);
new.IDUSUALT=USER;
new.HALT = cast('now' as time);
end ^

CREATE TRIGGER VDVENDAORCTGAD FOR VDVENDAORC 
ACTIVE AFTER DELETE POSITION 0 
AS
begin
  UPDATE VDITORCAMENTO SET EMITITORC='N', FATITORC='N'
    , QTDFATITORC=COALESCE(QTDFATITORC,0)-
       COALESCE((SELECT QTDITVENDA FROM VDITVENDA IV WHERE IV.CODEMP=old.CODEMP and IV.CODFILIAL=old.CODFILIAL and
       IV.TIPOVENDA=old.TIPOVENDA and IV.CODVENDA=old.CODVENDA and IV.CODITVENDA=old.CODITVENDA ),0)
    , QTDAFATITORC=COALESCE(QTDFATITORC,0)+
       COALESCE((SELECT QTDITVENDA FROM VDITVENDA IV WHERE IV.CODEMP=old.CODEMP and IV.CODFILIAL=old.CODFILIAL and
       IV.TIPOVENDA=old.TIPOVENDA and IV.CODVENDA=old.CODVENDA and IV.CODITVENDA=old.CODITVENDA ),0)
    WHERE CODEMP=old.CODEMPOR AND CODFILIAL=old.CODFILIALOR AND
       TIPOORC=old.TIPOORC AND CODORC=old.CODORC AND CODITORC=old.CODITORC;
  UPDATE VDORCAMENTO SET STATUSORC='OL'
    WHERE CODEMP=old.CODEMPOR AND CODFILIAL=old.CODFILIALOR AND
       TIPOORC=old.TIPOORC AND CODORC=old.CODORC;
end ^

CREATE TRIGGER VDVENDEDORTGBU FOR VDVENDEDOR 
ACTIVE BEFORE UPDATE POSITION 0 
as
begin
  new.DTALT=cast('now' AS DATE);
  new.IDUSUALT=USER;
  new.HALT=cast('now'AS TIME);
end ^

COMMIT WORK ^
SET TERM ; ^

/* Grant roles for this database */

/* Role: ADM, Owner: SYSDBA */
CREATE ROLE ADM;

/* Grant permissions for this database */
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON ATAGENDA TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON ATATENDENTE TO ROLE ADM;
GRANT SELECT ON ATATENDENTE TO PROCEDURE CRCARREGAPONTOSP;
GRANT SELECT ON ATATENDENTE TO PROCEDURE TKGERACAMPANHACTO;
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON ATATENDIMENTO TO ROLE ADM;
GRANT INSERT, SELECT, UPDATE ON ATATENDIMENTO TO PROCEDURE ATADICATENDIMENTOSP;
GRANT DELETE, SELECT ON ATATENDIMENTO TO TRIGGER PEFALTATGAD;
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON ATATENDIMENTOITREC TO ROLE ADM;
GRANT INSERT ON ATATENDIMENTOITREC TO PROCEDURE ATADICATENDIMENTOSP;
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON ATATENDIMENTOORC TO ROLE ADM;
GRANT INSERT ON ATATENDIMENTOORC TO PROCEDURE ATADICATENDIMENTOSP;
GRANT SELECT ON ATATENDIMENTOVW01 TO ROLE ADM;
GRANT SELECT ON ATATENDIMENTOVW02 TO ROLE ADM;
GRANT SELECT ON ATATENDIMENTOVW02 TO PROCEDURE ATRESUMOATENDOSP01;
GRANT SELECT ON ATATENDIMENTOVW02 TO PROCEDURE VDCONTRATOTOTSP;
GRANT SELECT ON ATATENDIMENTOVW03 TO ROLE ADM;
GRANT SELECT ON ATATENDIMENTOVW04 TO ROLE ADM;
GRANT SELECT ON ATATENDIMENTOVW05 TO ROLE ADM;
GRANT SELECT ON ATATENDIMENTOVW06 TO ROLE ADM;
GRANT SELECT ON ATATENDIMENTOVW07 TO ROLE ADM;
GRANT SELECT ON ATATENDIMENTOVW08 TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON ATATRIBUICAO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON ATCLASATENDO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON ATCONVATRIB TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON ATCONVATRIBTB TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON ATCONVENIADO TO ROLE ADM;
GRANT SELECT ON ATCONVENIADO TO PROCEDURE ATBUSCAPRECOSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON ATENCAMINHADOR TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON ATESPECATEND TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON ATMODATENDO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON ATSETOR TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON ATSETORATENDENTE TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON ATTIPOATEND TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON ATTIPOATENDO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON ATTIPOATENDOSETOR TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON ATTIPOCONV TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON CPCOMPRA TO ROLE ADM;
GRANT INSERT, SELECT ON CPCOMPRA TO PROCEDURE CPADICCOMPRAPEDSP;
GRANT SELECT ON CPCOMPRA TO PROCEDURE CPADICITCOMPRAPEDSP;
GRANT SELECT, UPDATE ON CPCOMPRA TO PROCEDURE CPBLOQCOMPRASP;
GRANT INSERT ON CPCOMPRA TO PROCEDURE CPGERAENTRADASP;
GRANT SELECT ON CPCOMPRA TO PROCEDURE CPGERAITENTRADASP;
GRANT SELECT, UPDATE ON CPCOMPRA TO PROCEDURE CPUPCOMPRAPEDSP;
GRANT SELECT ON CPCOMPRA TO PROCEDURE EQRELGIROPROD;
GRANT SELECT ON CPCOMPRA TO PROCEDURE EQRELGIROPRODPERI;
GRANT SELECT ON CPCOMPRA TO PROCEDURE LFBUSCATRIBCOMPRA;
GRANT SELECT ON CPCOMPRA TO PROCEDURE LFGERALFITCOMPRASP;
GRANT INSERT, SELECT ON CPCOMPRA TO PROCEDURE VDADICCOMPRAPEDSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON CPCOMPRALCCHAVE TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON CPCOMPRAPED TO ROLE ADM;
GRANT INSERT ON CPCOMPRAPED TO PROCEDURE CPUPCOMPRAPEDSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON CPCOMPRASOL TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON CPCOMPRAVENDA TO ROLE ADM;
GRANT INSERT, SELECT ON CPCOMPRAVENDA TO PROCEDURE CPGERAITENTRADASP;
GRANT DELETE, INSERT, SELECT, UPDATE ON CPCOTACAO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON CPDEVOLUCAO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON CPDEVOLUCAO TO PROCEDURE CPGERADEVOLUCAOSP;
GRANT DELETE, INSERT, SELECT ON CPDEVOLUCAO TO PROCEDURE CPGERALDEVOLUCAOSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON CPEQUIVCFOP TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON CPFORNECED TO ROLE ADM;
GRANT INSERT, SELECT ON CPFORNECED TO PROCEDURE CPADICFORSP;
GRANT SELECT ON CPFORNECED TO PROCEDURE CPADICITCOMPRAPEDSP;
GRANT SELECT ON CPFORNECED TO PROCEDURE LFBUSCANATSP;
GRANT SELECT ON CPFORNECED TO PROCEDURE LFBUSCATRIBCOMPRA;
GRANT SELECT ON CPFORNECED TO PROCEDURE LFGERALFITCOMPRASP;
GRANT DELETE, INSERT, SELECT, UPDATE ON CPFRETECP TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON CPHOMOLOGFOR TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON CPIMPORTACAO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON CPIMPORTACAOADIC TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON CPIMPORTACAOCOMPL TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON CPITCOMPRA TO ROLE ADM;
GRANT SELECT ON CPITCOMPRA TO PROCEDURE CPADICCOMPRAPEDSP;
GRANT INSERT, SELECT ON CPITCOMPRA TO PROCEDURE CPADICITCOMPRAPEDSP;
GRANT INSERT ON CPITCOMPRA TO PROCEDURE CPGERAITENTRADASP;
GRANT SELECT, UPDATE ON CPITCOMPRA TO PROCEDURE CPREORGCOMPRASP;
GRANT SELECT, UPDATE ON CPITCOMPRA TO PROCEDURE CPUPCOMPRAPEDSP;
GRANT SELECT ON CPITCOMPRA TO PROCEDURE EQRELGIROPROD;
GRANT SELECT ON CPITCOMPRA TO PROCEDURE EQRELGIROPRODPERI;
GRANT SELECT ON CPITCOMPRA TO PROCEDURE LFGERALFITCOMPRASP;
GRANT SELECT ON CPITCOMPRA TO PROCEDURE VDADICCOMPRAPEDSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON CPITCOMPRAITCOMPRA TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON CPITCOMPRASERIE TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON CPITIMPORTACAO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON CPITSOLICITACAO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON CPITSOLITSOL TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON CPITSUMSOL TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON CPPRODFOR TO ROLE ADM;
GRANT INSERT, SELECT ON CPPRODFOR TO PROCEDURE EQCOPIAPROD;
GRANT DELETE, INSERT, SELECT, UPDATE ON CPRATEIO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON CPSOLICITACAO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON CPSUMSOL TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON CPTABFOR TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON CPTIPOFOR TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON CRCHAMADO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON CRCHAMADOANEXO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON CRMARCADOR TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON CRQUALIFICACAO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON CRTAREFA TO ROLE ADM;
GRANT SELECT ON CRTAREFA TO PROCEDURE VDCONTRATOTOTSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON CRTAREFAPER TO ROLE ADM;
GRANT SELECT ON CRTAREFAPER TO PROCEDURE VDCONTRATOTOTSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON CRTIPOCHAMADO TO ROLE ADM;
GRANT INSERT ON CRTOTAL TO PROCEDURE CRTOTAL01ISP;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQALMOX TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQALMOXFILIAL TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQCLIFOR TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQCODALTPROD TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQETIQPROD TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQEXPEDAMOSTRAGEM TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQEXPEDICAO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQFATCONV TO ROLE ADM;
GRANT INSERT, SELECT ON EQFATCONV TO PROCEDURE EQCOPIAPROD;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQGRUPO TO ROLE ADM;
GRANT SELECT ON EQGRUPO TO PROCEDURE EQRELDEMANDASP;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQGUIATRAF TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQINVPROD TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQITEXPEDICAO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQITMODGRADE TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQITRECMERC TO ROLE ADM;
GRANT SELECT ON EQITRECMERC TO PROCEDURE CPADICITORCRECMERCSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQITRECMERCITCP TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQITRECMERCITOS TO ROLE ADM;
GRANT SELECT ON EQITRECMERCITOS TO PROCEDURE VDADICITORCRECMERCSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQITRECMERCITOSITORC TO ROLE ADM;
GRANT INSERT ON EQITRECMERCITOSITORC TO PROCEDURE CPADICITORCRECMERCSP;
GRANT INSERT ON EQITRECMERCITOSITORC TO PROCEDURE VDADICITORCRECMERCSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQITRECMERCSERIE TO ROLE ADM;
GRANT DELETE, INSERT, SELECT ON EQITRECMERCSERIE TO PROCEDURE EQITRECMERCSERIESP;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQITRMA TO ROLE ADM;
GRANT INSERT, SELECT ON EQITRMA TO PROCEDURE EQGERARMAOSSP;
GRANT INSERT, SELECT ON EQITRMA TO PROCEDURE NEW_PROCEDURE;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQITSIMILAR TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQITVARGRADE TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQLANCTOEXP TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQLOCDESCARGA TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQLOTE TO ROLE ADM;
GRANT SELECT ON EQLOTE TO PROCEDURE CPADICITCOMPRAPEDSP;
GRANT SELECT ON EQLOTE TO PROCEDURE EQGERARMAOSSP;
GRANT SELECT, UPDATE ON EQLOTE TO PROCEDURE EQMOVPRODATEQSP;
GRANT SELECT, UPDATE ON EQLOTE TO PROCEDURE EQSALDOLOTEATEQSP;
GRANT SELECT ON EQLOTE TO PROCEDURE PPITOPSP01;
GRANT SELECT ON EQLOTE TO PROCEDURE VDADICITEMPDVSP;
GRANT SELECT ON EQLOTE TO PROCEDURE VDADICITVENDAORCSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQMARCA TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQMODGRADE TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQMODLOTE TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQMOVEXP TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQMOVPROD TO ROLE ADM;
GRANT SELECT ON EQMOVPROD TO PROCEDURE EQCALCMPMSP;
GRANT SELECT ON EQMOVPROD TO PROCEDURE EQCALCPEPSSP;
GRANT SELECT ON EQMOVPROD TO PROCEDURE EQCUSTOPRODSP;
GRANT DELETE, SELECT ON EQMOVPROD TO PROCEDURE EQMOVPRODDSP;
GRANT INSERT ON EQMOVPROD TO PROCEDURE EQMOVPRODISP;
GRANT SELECT, UPDATE ON EQMOVPROD TO PROCEDURE EQMOVPRODPRCSLDSP;
GRANT SELECT ON EQMOVPROD TO PROCEDURE EQMOVPRODRETCODSP;
GRANT SELECT ON EQMOVPROD TO PROCEDURE EQMOVPRODSLDSP;
GRANT SELECT, UPDATE ON EQMOVPROD TO PROCEDURE EQMOVPRODUSP;
GRANT SELECT ON EQMOVPROD TO PROCEDURE EQPRODUTOSP01;
GRANT SELECT ON EQMOVPROD TO PROCEDURE EQRELDEMANDASP;
GRANT SELECT ON EQMOVPROD TO PROCEDURE EQRELGIROPROD;
GRANT SELECT ON EQMOVPROD TO PROCEDURE EQRELGIROPRODPERI;
GRANT SELECT ON EQMOVPROD TO PROCEDURE EQRELPEPSSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQMOVSERIE TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQPREVESTOQLOG TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQPROCEXPED TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQPROCRECMERC TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQPRODACESSO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQPRODPLAN TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQPRODUTO TO ROLE ADM;
GRANT SELECT ON EQPRODUTO TO PROCEDURE CPADICCOMPRAPEDSP;
GRANT SELECT ON EQPRODUTO TO PROCEDURE CPADICITCOMPRAPEDSP;
GRANT SELECT ON EQPRODUTO TO PROCEDURE CPADICITORCRECMERCSP;
GRANT INSERT, SELECT ON EQPRODUTO TO PROCEDURE EQADICPRODUTOSP;
GRANT INSERT, SELECT ON EQPRODUTO TO PROCEDURE EQCOPIAPROD;
GRANT SELECT ON EQPRODUTO TO PROCEDURE EQCUSTOPRODSP;
GRANT SELECT ON EQPRODUTO TO PROCEDURE EQGERARMAOSSP;
GRANT SELECT ON EQPRODUTO TO PROCEDURE EQITRECMERCSERIESP;
GRANT SELECT, UPDATE ON EQPRODUTO TO PROCEDURE EQMOVPRODATCUSTSP;
GRANT SELECT, UPDATE ON EQPRODUTO TO PROCEDURE EQMOVPRODATEQSP;
GRANT SELECT ON EQPRODUTO TO PROCEDURE EQMOVPRODCKCPSP;
GRANT SELECT ON EQPRODUTO TO PROCEDURE EQREFPRODSP;
GRANT SELECT ON EQPRODUTO TO PROCEDURE EQRELDEMANDASP;
GRANT SELECT ON EQPRODUTO TO PROCEDURE EQRELGIROPROD;
GRANT SELECT ON EQPRODUTO TO PROCEDURE EQRELGIROPRODPERI;
GRANT SELECT ON EQPRODUTO TO PROCEDURE EQRELINVPRODSP;
GRANT SELECT ON EQPRODUTO TO PROCEDURE EQRELPEPSSP;
GRANT SELECT ON EQPRODUTO TO PROCEDURE LFBUSCAFISCALSP;
GRANT SELECT ON EQPRODUTO TO PROCEDURE LFBUSCANATSP;
GRANT SELECT ON EQPRODUTO TO PROCEDURE LFBUSCAPREVTRIBORC;
GRANT SELECT ON EQPRODUTO TO PROCEDURE LFBUSCATRIBCOMPRA;
GRANT SELECT ON EQPRODUTO TO PROCEDURE NEW_PROCEDURE;
GRANT SELECT ON EQPRODUTO TO PROCEDURE PPCUSTOPRODSP;
GRANT SELECT ON EQPRODUTO TO PROCEDURE PPGERAOP;
GRANT SELECT ON EQPRODUTO TO PROCEDURE PPGERAOPAGRUP;
GRANT SELECT ON EQPRODUTO TO PROCEDURE PPGERAOPDET;
GRANT SELECT ON EQPRODUTO TO PROCEDURE PPRELPEPSSP;
GRANT SELECT ON EQPRODUTO TO PROCEDURE VDADICCOMPRAPEDSP;
GRANT SELECT ON EQPRODUTO TO PROCEDURE VDADICITEMPDVSP;
GRANT SELECT ON EQPRODUTO TO PROCEDURE VDADICITVENDAORCSP;
GRANT SELECT ON EQPRODUTO TO PROCEDURE VDADICVENDAORCSP;
GRANT SELECT ON EQPRODUTO TO PROCEDURE VDBUSCAPRECOSP;
GRANT SELECT ON EQPRODUTO TO PROCEDURE VDITVENDASERIESP;
GRANT SELECT, UPDATE ON EQPRODUTO TO PROCEDURE VDPRECOPRODSP01;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQPRODUTOLOG TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQRECAMOSTRAGEM TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQRECMERC TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQRMA TO ROLE ADM;
GRANT INSERT, SELECT ON EQRMA TO PROCEDURE EQGERARMAOSSP;
GRANT INSERT, SELECT ON EQRMA TO PROCEDURE NEW_PROCEDURE;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQRMAAL TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQSALDOLOTE TO ROLE ADM;
GRANT INSERT, SELECT, UPDATE ON EQSALDOLOTE TO PROCEDURE EQSALDOLOTEATEQSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQSALDOPROD TO ROLE ADM;
GRANT SELECT, UPDATE ON EQSALDOPROD TO PROCEDURE EQMOVPRODATEQSP;
GRANT INSERT, SELECT, UPDATE ON EQSALDOPROD TO PROCEDURE EQSALDOPRODATEQSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQSECAO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQSERIE TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQSIMILAR TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQTIPOEXP TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQTIPOEXPEDICAO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQTIPOMOV TO ROLE ADM;
GRANT SELECT ON EQTIPOMOV TO PROCEDURE CPADICCOMPRAPEDSP;
GRANT SELECT ON EQTIPOMOV TO PROCEDURE CPGERAENTRADASP;
GRANT SELECT ON EQTIPOMOV TO PROCEDURE EQCALCPEPSSP;
GRANT SELECT ON EQTIPOMOV TO PROCEDURE EQMOVPRODCKTMSP;
GRANT SELECT ON EQTIPOMOV TO PROCEDURE EQMOVPRODCKUTMSP;
GRANT SELECT ON EQTIPOMOV TO PROCEDURE EQRELDEMANDASP;
GRANT SELECT ON EQTIPOMOV TO PROCEDURE EQRELGIROPRODPERI;
GRANT SELECT ON EQTIPOMOV TO PROCEDURE LFBUSCATRIBCOMPRA;
GRANT SELECT ON EQTIPOMOV TO PROCEDURE PPGERAOP;
GRANT SELECT ON EQTIPOMOV TO PROCEDURE PPGERAOPAGRUP;
GRANT SELECT ON EQTIPOMOV TO PROCEDURE PPGERAOPDET;
GRANT SELECT ON EQTIPOMOV TO PROCEDURE VDADICCOMPRAPEDSP;
GRANT SELECT ON EQTIPOMOV TO PROCEDURE VDADICVENDAORCSP;
GRANT SELECT ON EQTIPOMOV TO PROCEDURE VDBUSCAPRECOSP;
GRANT SELECT ON EQTIPOMOV TO PROCEDURE VDEVOLUVENDAS;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQTIPOMOVUSU TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQTIPORECMERC TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQITTROCAREFPROD TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQTROCAREFPROD TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQITTROCARPLOG TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQUNIDADE TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON EQVARGRADE TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNBANCO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNBORDERO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNCARTCOB TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNCC TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNCHEQUE TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNCONTA TO ROLE ADM;
GRANT SELECT ON FNCONTA TO PROCEDURE FNADICLANCASP01;
GRANT SELECT ON FNCONTA TO PROCEDURE FNADICLANCASP02;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNCONTAUSU TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNCONTAVINCULADA TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNCOTMOEDA TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNFBNCLI TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNFBNCODRET TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNFBNREC TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNFINALIDADE TO ROLE ADM;
GRANT SELECT ON FNFLUXOCAIXAVW01 TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNHISTPAD TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNITBORDERO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNITFBNCODRET TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNITMODBOLETO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNITPAGAR TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNITRECEBER TO ROLE ADM;
GRANT INSERT, SELECT, UPDATE ON FNITRECEBER TO PROCEDURE FNADICITRECEBERSP01;
GRANT SELECT, UPDATE ON FNITRECEBER TO PROCEDURE FNADICRECEBERSP01;
GRANT SELECT ON FNITRECEBER TO PROCEDURE FNCHECAPGTOATRASOSP;
GRANT SELECT ON FNITRECEBER TO PROCEDURE FNCHECAPGTOSP;
GRANT SELECT, UPDATE ON FNITRECEBER TO PROCEDURE FNITRECEBERSP01;
GRANT SELECT ON FNITRECEBER TO PROCEDURE VDESTORNACOMISSAOSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNITRENEGREC TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNITTBJUROS TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNLANCA TO ROLE ADM;
GRANT INSERT ON FNLANCA TO PROCEDURE FNADICLANCASP01;
GRANT INSERT ON FNLANCA TO PROCEDURE FNADICLANCASP02;
GRANT SELECT ON FNLANCA TO PROCEDURE FNDELETARECEBERSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNLIBCRED TO ROLE ADM;
GRANT SELECT, UPDATE ON FNLIBCRED TO PROCEDURE FNLIBCREDSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNMODBOLETO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNMOEDA TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNMOVIMENTO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNPAGAR TO ROLE ADM;
GRANT SELECT ON FNPAGAR TO PROCEDURE FNADICLANCASP02;
GRANT INSERT ON FNPAGAR TO PROCEDURE FNADICPAGARSP01;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNPAGCHEQ TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNPAGTOCOMI TO ROLE ADM;
GRANT INSERT ON FNPAGTOCOMI TO PROCEDURE VDBAIXACOMISSAOSP;
GRANT DELETE, SELECT ON FNPAGTOCOMI TO PROCEDURE VDDESBAIXACOMISSAOSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNPARCPAG TO ROLE ADM;
GRANT SELECT ON FNPARCPAG TO PROCEDURE FNGERAITRECEBERSP01;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNPLANEJAMENTO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNPLANOPAG TO ROLE ADM;
GRANT SELECT ON FNPLANOPAG TO PROCEDURE FNADICRECEBERSP01;
GRANT SELECT ON FNPLANOPAG TO PROCEDURE FNGERAITRECEBERSP01;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNRECEBER TO ROLE ADM;
GRANT SELECT ON FNRECEBER TO PROCEDURE FNADICLANCASP01;
GRANT SELECT ON FNRAZFORVW01 TO ROLE ADM;
GRANT SELECT ON FNRAZCLIVW01 TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNRECEBER TO PROCEDURE FNADICRECEBERSP01;
GRANT SELECT ON FNRECEBER TO PROCEDURE FNCHECAPGTOATRASOSP;
GRANT SELECT ON FNRECEBER TO PROCEDURE FNCHECAPGTOSP;
GRANT DELETE, SELECT ON FNRECEBER TO PROCEDURE FNDELETARECEBERSP;
GRANT SELECT ON FNRECEBER TO PROCEDURE VDBAIXACOMISSAOSP;
GRANT SELECT ON FNRECEBER TO PROCEDURE VDDESBAIXACOMISSAOSP;
GRANT SELECT ON FNRECEBER TO PROCEDURE VDESTORNACOMISSAOSP;
GRANT SELECT ON FNRECEBER TO PROCEDURE VDGERACOMISSAOSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNRENEGREC TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON FNRESTRICAO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNSALDOLANCA TO ROLE ADM;
GRANT INSERT, SELECT, UPDATE ON FNSALDOLANCA TO PROCEDURE FNSALDOPLANSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNSINAL TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNSUBLANCA TO ROLE ADM;
GRANT INSERT ON FNSUBLANCA TO PROCEDURE FNADICLANCASP01;
GRANT INSERT ON FNSUBLANCA TO PROCEDURE FNADICLANCASP02;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNTALAOCHEQ TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNTBJUROS TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNTIPOCOB TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON FNTIPOCRED TO ROLE ADM;
GRANT SELECT ON FNTIPOCRED TO PROCEDURE FNLIBCREDSP;
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON FNTIPORESTR TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON LFCALCCUSTO TO ROLE ADM;
GRANT SELECT ON LFCALCCUSTO TO PROCEDURE LFCALCCUSTOSP01;
GRANT DELETE, INSERT, SELECT, UPDATE ON LFCLFISCAL TO ROLE ADM;
GRANT SELECT ON LFCLFISCAL TO PROCEDURE LFBUSCAFISCALSP;
GRANT SELECT ON LFCLFISCAL TO PROCEDURE LFBUSCANATSP;
GRANT SELECT ON LFCLFISCAL TO PROCEDURE VDADICITEMPDVSP;
GRANT SELECT ON LFCLFISCAL TO PROCEDURE VDADICITVENDAORCSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON LFCSOSN TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON LFFRETE TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON LFFRETECOMPRA TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON LFFRETEVENDA TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON LFITCALCCUSTO TO ROLE ADM;
GRANT SELECT ON LFITCALCCUSTO TO PROCEDURE LFCALCCUSTOSP01;
GRANT DELETE, INSERT, SELECT, UPDATE ON LFITCLFISCAL TO ROLE ADM;
GRANT SELECT ON LFITCLFISCAL TO PROCEDURE LFBUSCAFISCALSP;
GRANT SELECT ON LFITCLFISCAL TO PROCEDURE LFBUSCAFISCALSP02;
GRANT SELECT ON LFITCLFISCAL TO PROCEDURE LFBUSCAPREVTRIBORC;
GRANT SELECT ON LFITCLFISCAL TO PROCEDURE LFBUSCATRIBCOMPRA;
GRANT SELECT ON LFITCLFISCAL TO PROCEDURE LFGERALFITCOMPRASP;
GRANT SELECT ON LFITCLFISCAL TO PROCEDURE LFGERALFITVENDASP;
GRANT DELETE, INSERT, SELECT, UPDATE ON LFITCOMPRA TO ROLE ADM;
GRANT INSERT, SELECT, UPDATE ON LFITCOMPRA TO PROCEDURE LFGERALFITCOMPRASP;
GRANT DELETE, INSERT, SELECT, UPDATE ON LFITNATOPER TO ROLE ADM;
GRANT SELECT ON LFITNATOPER TO PROCEDURE LFBUSCAICMSSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON LFITREGRAFISCAL TO ROLE ADM;
GRANT SELECT ON LFITREGRAFISCAL TO PROCEDURE LFBUSCANATSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON LFITVENDA TO ROLE ADM;
GRANT INSERT, SELECT, UPDATE ON LFITVENDA TO PROCEDURE LFGERALFITVENDASP;
GRANT DELETE, INSERT, SELECT, UPDATE ON LFLIVROFISCAL TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON LFMENSAGEM TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON LFMODDOCFISC TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON LFMODNOTA TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON LFNATOPER TO ROLE ADM;
GRANT SELECT ON LFNATOPER TO PROCEDURE LFBUSCAICMSSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON LFNBM TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON LFNCM TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON LFNCMNBM TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON LFREGRAFISCAL TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON LFSEQSERIE TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON LFSEQSERIE TO PROCEDURE LFNOVODOCSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON LFSERIE TO ROLE ADM;
GRANT SELECT, UPDATE ON LFSERIE TO PROCEDURE LFNOVODOCSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON LFSERVICO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON LFSITTRIB TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON LFTABICMS TO ROLE ADM;
GRANT SELECT ON LFTABICMS TO PROCEDURE LFBUSCAICMSSP;
GRANT SELECT ON LFTABICMS TO PROCEDURE LFBUSCATRIBCOMPRA;
GRANT DELETE, INSERT, SELECT, UPDATE ON LFTIPOFISCCLI TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON LFTRATTRIB TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON MGPRODUTO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON PEBATIDA TO ROLE ADM;
GRANT SELECT ON PEBATIDA TO PROCEDURE CRCARREGAPONTOSP;
GRANT INSERT ON PEBATIDA TO PROCEDURE CRINSEREBATIDASP;
GRANT DELETE, INSERT, SELECT, UPDATE ON PEBATIDALOG TO TRIGGER PEBATIDATGAD;
GRANT DELETE, INSERT, SELECT, UPDATE ON PEFALTA TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON PPDISTRIB TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON PPESTRUANALISE TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON PPESTRUFASE TO ROLE ADM;
GRANT SELECT ON PPESTRUFASE TO PROCEDURE PPGERAOP;
GRANT SELECT ON PPESTRUFASE TO PROCEDURE PPGERAOPAGRUP;
GRANT SELECT ON PPESTRUFASE TO PROCEDURE PPGERAOPCQ;
GRANT SELECT ON PPESTRUFASE TO PROCEDURE PPGERAOPDET;
GRANT SELECT ON PPESTRUFASE TO PROCEDURE PPITOPSP01;
GRANT DELETE, INSERT, SELECT, UPDATE ON PPESTRUTURA TO ROLE ADM;
GRANT SELECT ON PPESTRUTURA TO PROCEDURE PPGERAOPCQ;
GRANT SELECT ON PPESTRUTURA TO PROCEDURE PPITOPSP01;
GRANT DELETE, INSERT, SELECT, UPDATE ON PPFASE TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON PPFOTOMTAN TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON PPITESTRUTURA TO ROLE ADM;
GRANT SELECT ON PPITESTRUTURA TO PROCEDURE PPITOPSP01;
GRANT DELETE, INSERT, SELECT, UPDATE ON PPITESTRUTURASUBPROD TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON PPITOP TO ROLE ADM;
GRANT SELECT, UPDATE ON PPITOP TO PROCEDURE EQGERARMAOSSP;
GRANT SELECT ON PPITOP TO PROCEDURE NEW_PROCEDURE;
GRANT INSERT ON PPITOP TO PROCEDURE PPITOPSP01;
GRANT DELETE, INSERT, SELECT, UPDATE ON PPITRETCP TO ROLE ADM;
GRANT SELECT ON PPLISTAOPVW01 TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON PPMETODOANALISE TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON PPOP TO ROLE ADM;
GRANT INSERT, SELECT ON PPOP TO PROCEDURE PPGERAOP;
GRANT INSERT, SELECT ON PPOP TO PROCEDURE PPGERAOPAGRUP;
GRANT SELECT ON PPOP TO PROCEDURE PPGERAOPCQ;
GRANT INSERT, SELECT ON PPOP TO PROCEDURE PPGERAOPDET;
GRANT SELECT ON PPOP TO PROCEDURE PPITOPSP01;
GRANT DELETE, INSERT, SELECT, UPDATE ON PPOPACAOCORRET TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON PPOPCQ TO ROLE ADM;
GRANT INSERT ON PPOPCQ TO PROCEDURE PPGERAOPCQ;
GRANT DELETE, INSERT, SELECT, UPDATE ON PPOPENTRADA TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON PPOPFASE TO ROLE ADM;
GRANT SELECT ON PPOPFASE TO PROCEDURE EQGERARMAOSSP;
GRANT SELECT ON PPOPFASE TO PROCEDURE NEW_PROCEDURE;
GRANT SELECT, UPDATE ON PPOPFASE TO PROCEDURE PPGERAOP;
GRANT SELECT, UPDATE ON PPOPFASE TO PROCEDURE PPGERAOPAGRUP;
GRANT INSERT ON PPOPFASE TO PROCEDURE PPGERAOPCQ;
GRANT SELECT, UPDATE ON PPOPFASE TO PROCEDURE PPGERAOPDET;
GRANT INSERT ON PPOPFASE TO PROCEDURE PPITOPSP01;
GRANT DELETE, INSERT, SELECT, UPDATE ON PPOPITORC TO ROLE ADM;
GRANT INSERT ON PPOPITORC TO PROCEDURE PPGERAOP;
GRANT INSERT ON PPOPITORC TO PROCEDURE PPGERAOPAGRUP;
GRANT INSERT ON PPOPITORC TO PROCEDURE PPGERAOPDET;
GRANT DELETE, INSERT, SELECT, UPDATE ON PPOPSUBPROD TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON PPPROCESSAOPTMP TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON PPRECURSO TO ROLE ADM;
GRANT SELECT ON PPRECURSO TO PROCEDURE PPITOPSP01;
GRANT DELETE, INSERT, SELECT, UPDATE ON PPRETCP TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON PPTIPOANALISE TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON PPTIPOREC TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON PVCAIXA TO ROLE ADM;
GRANT SELECT ON PVCAIXA TO PROCEDURE FNLIBCREDSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON PVCAIXAIMP TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON PVLEITURAX TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON PVMOVCAIXA TO ROLE ADM;
GRANT INSERT ON PVMOVCAIXA TO PROCEDURE PVABRECAIXASP;
GRANT INSERT ON PVMOVCAIXA TO PROCEDURE PVADICMOVCAIXASP01;
GRANT INSERT ON PVMOVCAIXA TO PROCEDURE PVFECHACAIXASP;
GRANT INSERT ON PVMOVCAIXA TO PROCEDURE PVFECHAVENDASP;
GRANT SELECT ON PVMOVCAIXA TO PROCEDURE PVRETMOVCAIXASP;
GRANT INSERT ON PVMOVCAIXA TO PROCEDURE PVSANGRIASP;
GRANT INSERT ON PVMOVCAIXA TO PROCEDURE PVSUPRIMENTOSP;
GRANT SELECT ON PVMOVCAIXA TO PROCEDURE PVVERIFCAIXASP;
GRANT DELETE, INSERT, SELECT, UPDATE ON PVSEQMOVCAIXA TO ROLE ADM;
GRANT INSERT, SELECT, UPDATE ON PVSEQMOVCAIXA TO PROCEDURE PVABRECAIXASP;
GRANT DELETE, INSERT, SELECT, UPDATE ON PVSEQUENCIA TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON RHAREA TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON RHBENEFICIO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON RHCANDIDATO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON RHCANDIDATOCARAC TO ROLE ADM;
GRANT SELECT ON RHCANDIDATOCARAC TO PROCEDURE RHLISTAVAGACANDSP;
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON RHCANDIDATOCURSO TO ROLE ADM;
GRANT SELECT ON RHCANDIDATOCURSO TO PROCEDURE RHLISTAVAGACANDSP;
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON RHCANDIDATOFUNC TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON RHCANDIDATOSTATUS TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON RHCARACTERISTICA TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON RHCODGPS TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON RHCURSO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON RHDEPTO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON RHEMPREGADO TO ROLE ADM;
GRANT SELECT ON RHEMPREGADO TO PROCEDURE CRCARREGAPONTOSP;
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON RHEMPREGADOBENEF TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON RHEMPREGADOR TO ROLE ADM;
GRANT SELECT ON RHEMPREGADOR TO PROCEDURE RHLISTAVAGACANDSP;
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON RHEMPREGADOSAL TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON RHEXPEDIENTE TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON RHEXPEDMES TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON RHFUNCAO TO ROLE ADM;
GRANT SELECT ON RHFUNCAO TO PROCEDURE RHLISTAVAGACANDSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON RHNIVELCURSO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON RHTABELAINSS TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON RHTABELAIRRF TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON RHTURNO TO ROLE ADM;
GRANT SELECT ON RHTURNO TO PROCEDURE CRCARREGAPONTOSP;
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON RHVAGA TO ROLE ADM;
GRANT SELECT ON RHVAGA TO PROCEDURE RHLISTAVAGACANDSP;
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON RHVAGACANDIDATO TO ROLE ADM;
GRANT SELECT ON RHVAGACANDIDATO TO PROCEDURE RHLISTAVAGACANDSP;
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON RHVAGACARACQUALI TO ROLE ADM;
GRANT SELECT ON RHVAGACARACQUALI TO PROCEDURE RHLISTAVAGACANDSP;
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON RHVAGACARACREST TO ROLE ADM;
GRANT SELECT ON RHVAGACARACREST TO PROCEDURE RHLISTAVAGACANDSP;
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON RHVAGACURSO TO ROLE ADM;
GRANT SELECT ON RHVAGACURSO TO PROCEDURE RHLISTAVAGACANDSP;
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON RHVAGASTATUS TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGACESSOEU TO ROLE ADM;
GRANT SELECT ON SGACESSOEU TO PUBLIC;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGACESSOMG TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGACESSOMU TO ROLE ADM;
GRANT DELETE, INSERT, SELECT ON SGACESSOMU TO PROCEDURE SGUPACESSOMUSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGAGENDA TO ROLE ADM;
GRANT INSERT, SELECT, UPDATE ON SGAGENDA TO PROCEDURE SGSETAGENDASP;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGAGENTE TO ROLE ADM;
GRANT INSERT, SELECT ON SGAGENTE TO PROCEDURE SGAGENTEISP;
GRANT DELETE, SELECT ON SGAGENTE TO PROCEDURE SGAGENTEUIDSP;
GRANT SELECT, UPDATE ON SGAGENTE TO PROCEDURE SGAGENTEUSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGATRIBUICAO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGATRIBUSU TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGBAIRRO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGCATIMG TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGCNAE TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGCONEXAO TO ROLE ADM;
GRANT SELECT ON SGCONEXAO TO PROCEDURE FNLIBCREDSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGCONEXAO TO PROCEDURE SGFIMCONSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGCONEXAO TO PROCEDURE SGINICONSP;
GRANT SELECT ON SGCONEXAO TO PROCEDURE SGLOGSP01;
GRANT SELECT ON SGCONEXAO TO PROCEDURE SGRETCAIXA;
GRANT SELECT ON SGCONEXAO TO PROCEDURE SGRETFILIAL;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGDEBUG TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON SGEMPRESA TO ROLE ADM;
GRANT SELECT ON SGEMPRESA TO PROCEDURE SGATUALIZABDSP;
GRANT INSERT, SELECT ON SGEMPRESA TO PROCEDURE SGDADOSINISP;
GRANT SELECT ON SGEMPRESA TO PROCEDURE SGINICONSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGEQVCLIFOR TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGESTACAO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGESTACAOBAL TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGESTACAOIMP TO ROLE ADM;
GRANT SELECT, UPDATE ON SGESTACAOIMP TO PROCEDURE SGESTACAOIMPSP01;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGESTCIVIL TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGFERIADO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGFERIADO TO PROCEDURE SGCALCVENCSP;
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON SGFILIAL TO ROLE ADM;
GRANT SELECT ON SGFILIAL TO PROCEDURE CPADICITCOMPRAPEDSP;
GRANT SELECT ON SGFILIAL TO PROCEDURE LFBUSCAFISCALSP;
GRANT SELECT ON SGFILIAL TO PROCEDURE LFBUSCAFISCALSP02;
GRANT SELECT ON SGFILIAL TO PROCEDURE LFBUSCAICMSSP;
GRANT SELECT ON SGFILIAL TO PROCEDURE LFBUSCANATSP;
GRANT SELECT ON SGFILIAL TO PROCEDURE LFBUSCAPREVTRIBORC;
GRANT SELECT ON SGFILIAL TO PROCEDURE LFBUSCATRIBCOMPRA;
GRANT SELECT ON SGFILIAL TO PUBLIC;
GRANT INSERT ON SGFILIAL TO PROCEDURE SGDADOSINISP;
GRANT SELECT ON SGFILIAL TO PROCEDURE SGRETFILIAL;
GRANT SELECT ON SGFILIAL TO PROCEDURE VDADICITEMPDVSP;
GRANT SELECT ON SGFILIAL TO PROCEDURE VDADICITVENDAORCSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGFLUXO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGGATILHO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGGRAUINST TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGGRPUSU TO ROLE ADM;
GRANT SELECT ON SGGRPUSU TO PUBLIC;
GRANT INSERT, SELECT ON SGGRPUSU TO PROCEDURE SGDADOSINISP;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGIMAGEM TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGIMPRESSORA TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGITFLUXO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGITPREFERE6 TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGITPROCESSO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGITTABELA TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGLOG TO ROLE ADM;
GRANT INSERT ON SGLOG TO PROCEDURE SGLOGSP01;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGLOGCRUD TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGMENU TO ROLE ADM;
GRANT INSERT, SELECT, UPDATE ON SGMENU TO PROCEDURE SGUPMENUSP01;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGMENUOBJ TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGMODETIQUETA TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGMODULO TO ROLE ADM;
GRANT INSERT, SELECT ON SGMODULO TO PROCEDURE SGUPMENUSP01;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGMUNICIPIO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGOBJETO TO ROLE ADM;
GRANT SELECT ON SGOBJETO TO PROCEDURE SGGRANTADMSP;
GRANT INSERT, SELECT ON SGOBJETO TO PROCEDURE SGOBJETOINSTBSP;
GRANT SELECT ON SGOBJETO TO PROCEDURE SGRETFILIAL;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGOBJETOTB TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON SGPAIS TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGPAPEL TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGPREFERE1 TO ROLE ADM;
GRANT SELECT ON SGPREFERE1 TO PROCEDURE ATBUSCAPRECOSP;
GRANT SELECT ON SGPREFERE1 TO PROCEDURE CPADICFORSP;
GRANT SELECT ON SGPREFERE1 TO PROCEDURE CPADICITCOMPRAPEDSP;
GRANT SELECT ON SGPREFERE1 TO PROCEDURE CPCOMPRASP01;
GRANT SELECT ON SGPREFERE1 TO PROCEDURE CPGERAENTRADASP;
GRANT SELECT ON SGPREFERE1 TO PROCEDURE EQGERARMAOSSP;
GRANT SELECT ON SGPREFERE1 TO PROCEDURE FNLIBCREDSP;
GRANT SELECT ON SGPREFERE1 TO PROCEDURE SGRETMULTIALMOXSP;
GRANT SELECT ON SGPREFERE1 TO PROCEDURE VDADICVENDAORCSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGPREFERE2 TO ROLE ADM;
GRANT SELECT ON SGPREFERE2 TO PROCEDURE ATADICATENDIMENTOSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGPREFERE3 TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGPREFERE4 TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGPREFERE5 TO ROLE ADM;
GRANT SELECT ON SGPREFERE5 TO PROCEDURE EQGERARMAOSSP;
GRANT SELECT ON SGPREFERE5 TO PROCEDURE PPGERAOP;
GRANT SELECT ON SGPREFERE5 TO PROCEDURE PPGERAOPAGRUP;
GRANT SELECT ON SGPREFERE5 TO PROCEDURE PPGERAOPDET;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGPREFERE6 TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGPREFERE7 TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGPREFERE8 TO ROLE ADM;
GRANT SELECT ON SGPREFERE8 TO PROCEDURE CPADICCOMPRAPEDSP;
GRANT SELECT ON SGPREFERE8 TO PROCEDURE VDADICCOMPRAPEDSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGPROCESSO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGPROXYWEB TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGSEQUENCE_ID TO ROLE ADM;
GRANT INSERT, SELECT, UPDATE ON SGSEQUENCE_ID TO PROCEDURE SGSEQUENCE_IDSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGSEQUENCIA TO ROLE ADM;
GRANT INSERT, SELECT, UPDATE ON SGSEQUENCIA TO PROCEDURE SPGERANUM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGSISTEMA TO ROLE ADM;
GRANT INSERT, SELECT ON SGSISTEMA TO PROCEDURE SGUPMENUSP01;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGTABELA TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGTAREFA TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGTIPOAGENDA TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGTRATARET TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGUF TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGUNIFCOD TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGUSUARIO TO ROLE ADM;
GRANT SELECT ON SGUSUARIO TO PUBLIC;
GRANT INSERT, SELECT ON SGUSUARIO TO PROCEDURE SGDADOSINISP;
GRANT SELECT ON SGUSUARIO TO PROCEDURE SGGRANTUSERSP;
GRANT SELECT ON SGUSUARIO TO PROCEDURE SGINICONSP;
GRANT UPDATE ON SGUSUARIO TO PROCEDURE SGRETINFOUSU;
GRANT DELETE, INSERT, SELECT, UPDATE ON SGVARIAVEL TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SPNATOPER TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SVAVALIACAO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SVEXECUCAO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SVITOS TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON SVOS TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON TKATIVIDADE TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON TKCAMPANHA TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON TKCAMPANHACLI TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON TKCAMPANHACTO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON TKCAMPANHACTO TO PROCEDURE TKGERACAMPANHACTO;
GRANT DELETE, INSERT, SELECT, UPDATE ON TKCAMPANHAEMAIL TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON TKCONFEMAIL TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON TKCONTATO TO ROLE ADM;
GRANT SELECT ON TKCONTATO TO PROCEDURE TKCONTCLISP;
GRANT SELECT ON TKCONTATO TO PROCEDURE TKCONTTOCLI;
GRANT INSERT, SELECT ON TKCONTCLI TO PROCEDURE TKCONTCLISP;
GRANT SELECT ON TKCONTCLIVW01 TO ROLE ADM;
GRANT SELECT ON TKCONTCLIVW02 TO ROLE ADM;
GRANT SELECT ON TKCONTCLIVW03 TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON TKCTOATIV TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON TKCTOGRPINT TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON TKEMAIL TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON TKHISTORICO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON TKHISTORICO TO PROCEDURE TKGERACAMPANHACTO;
GRANT DELETE, INSERT, SELECT, UPDATE ON TKORIGCONT TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON TKSETORCTO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON TKSITCAMP TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON TKSITCAMP TO PROCEDURE TKGERACAMPANHACTO;
GRANT DELETE, INSERT, SELECT, UPDATE ON TKTIPOCONT TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON TKTIPOIMP TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON VDAUXVENDA TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDCLASCLI TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON VDCLCOMIS TO ROLE ADM;
GRANT SELECT ON VDCLCOMIS TO PROCEDURE VDGERACOMISSAOSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDCLIAUTP TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDCLICOMPL TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDCLICONTAS TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDCLIENTE TO ROLE ADM;
GRANT SELECT ON VDCLIENTE TO PROCEDURE ATRESUMOATENDOSP02;
GRANT SELECT ON VDCLIENTE TO PROCEDURE CPADICFORSP;
GRANT SELECT ON VDCLIENTE TO PROCEDURE FNLIBCREDSP;
GRANT SELECT ON VDCLIENTE TO PROCEDURE LFBUSCAFISCALSP;
GRANT SELECT ON VDCLIENTE TO PROCEDURE LFBUSCANATSP;
GRANT INSERT, SELECT ON VDCLIENTE TO PROCEDURE TKCONTCLISP;
GRANT INSERT, SELECT ON VDCLIENTE TO PROCEDURE TKCONTTOCLI;
GRANT SELECT ON VDCLIENTE TO PROCEDURE VDADICITEMPDVSP;
GRANT SELECT ON VDCLIENTE TO PROCEDURE VDADICITVENDAORCSP;
GRANT SELECT ON VDCLIENTE TO PROCEDURE VDBUSCAPRECOSP;
GRANT SELECT ON VDCLIENTE TO PROCEDURE VDCLIENTEATIVOSP;
GRANT INSERT, SELECT ON VDCLIENTE TO PROCEDURE VDCOPIACLIENTE;
GRANT SELECT ON VDCLIENTE TO PROCEDURE VDEVOLUVENDAS;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDCLIENTEFOR TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDCLIIMOV TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDCLIMETAVEND TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDCLIREFC TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDCLIREFP TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDCLISOCIOS TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDCLITERRA TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDCLIVEIC TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDCOMISSAO TO ROLE ADM;
GRANT SELECT, UPDATE ON VDCOMISSAO TO PROCEDURE FNESTORNACOMISSAOSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDCOMISSAO TO PROCEDURE VDADICCOMISSAOSP;
GRANT SELECT, UPDATE ON VDCOMISSAO TO PROCEDURE VDBAIXACOMISSAOSP;
GRANT SELECT, UPDATE ON VDCOMISSAO TO PROCEDURE VDDESBAIXACOMISSAOSP;
GRANT SELECT, UPDATE ON VDCOMISSAO TO PROCEDURE VDESTORNACOMISSAOSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDCONSIGNACAO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDCONTRATO TO ROLE ADM;
GRANT SELECT ON VDCONTRATO TO PROCEDURE ATRESUMOATENDOSP02;
GRANT SELECT ON VDCONTRATOVW01 TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDDETORC TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDETIQCLI TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDFINCONTR TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDFOTOPROD TO ROLE ADM;
GRANT INSERT, SELECT ON VDFOTOPROD TO PROCEDURE EQCOPIAPROD;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDFRETEVD TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDGRUPORC TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDITCONTRATO TO ROLE ADM;
GRANT SELECT ON VDITCONTRATO TO PROCEDURE ATRESUMOATENDOSP01;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDITCONTRATOAND TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDITCUSTOORC TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDITCUSTOVENDA TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDITDETORC TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDITGRUPORC TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDITKIT TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDITORCAMENTO TO ROLE ADM;
GRANT INSERT ON VDITORCAMENTO TO PROCEDURE CPADICITORCRECMERCSP;
GRANT SELECT ON VDITORCAMENTO TO PROCEDURE LFBUSCAPREVTRIBORC;
GRANT SELECT ON VDITORCAMENTO TO PROCEDURE LFBUSCATRIBCOMPRA;
GRANT SELECT, UPDATE ON VDITORCAMENTO TO PROCEDURE PPGERAOP;
GRANT SELECT, UPDATE ON VDITORCAMENTO TO PROCEDURE PPGERAOPAGRUP;
GRANT SELECT, UPDATE ON VDITORCAMENTO TO PROCEDURE PPGERAOPDET;
GRANT INSERT, SELECT ON VDITORCAMENTO TO PROCEDURE VDADICITORCRECMERCSP;
GRANT SELECT, UPDATE ON VDITORCAMENTO TO PROCEDURE VDADICITVENDAORCSP;
GRANT SELECT ON VDITORCAMENTO TO PROCEDURE VDADICVENDAORCSP;
GRANT INSERT, SELECT ON VDITORCAMENTO TO PROCEDURE VDCOPIAORCSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDITREGRACOMIS TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDITROMANEIO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDITVENDA TO ROLE ADM;
GRANT SELECT ON VDITVENDA TO PROCEDURE CPGERAITENTRADASP;
GRANT SELECT ON VDITVENDA TO PROCEDURE EQRELGIROPROD;
GRANT SELECT ON VDITVENDA TO PROCEDURE EQRELGIROPRODPERI;
GRANT SELECT ON VDITVENDA TO PROCEDURE LFBUSCAFISCALSP02;
GRANT SELECT ON VDITVENDA TO PROCEDURE LFGERALFITVENDASP;
GRANT INSERT, SELECT ON VDITVENDA TO PROCEDURE VDADICITEMPDVSP;
GRANT INSERT, SELECT ON VDITVENDA TO PROCEDURE VDADICITVENDAORCSP;
GRANT SELECT, UPDATE ON VDITVENDA TO PROCEDURE VDREORGVENDASP;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDITVENDASERIE TO ROLE ADM;
GRANT DELETE, INSERT, SELECT ON VDITVENDASERIE TO PROCEDURE VDITVENDASERIESP;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDITVENDAVDITCONTR TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDKIT TO ROLE ADM;
GRANT SELECT ON VDLOGSITCONTR TO ROLE ADM;
GRANT INSERT, SELECT ON VDLOGSITCONTR TO TRIGGER VDCONTRATOTGAU;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDMOTORISTA TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON VDOBSCLI TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDORCAMENTO TO ROLE ADM;
GRANT INSERT ON VDORCAMENTO TO PROCEDURE ATADICATENDIMENTOSP;
GRANT SELECT ON VDORCAMENTO TO PROCEDURE CPADICITORCRECMERCSP;
GRANT SELECT ON VDORCAMENTO TO PROCEDURE LFBUSCAPREVTRIBORC;
GRANT SELECT ON VDORCAMENTO TO PROCEDURE VDADICITORCRECMERCSP;
GRANT SELECT, UPDATE ON VDORCAMENTO TO PROCEDURE VDADICITVENDAORCSP;
GRANT SELECT ON VDORCAMENTO TO PROCEDURE VDADICVENDAORCSP;
GRANT SELECT ON VDORCAMENTO TO PROCEDURE VDATUDESCVENDAORCSP;
GRANT INSERT, SELECT ON VDORCAMENTO TO PROCEDURE VDCOPIAORCSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDPRAZOENT TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDPRECOPROD TO ROLE ADM;
GRANT INSERT, SELECT ON VDPRECOPROD TO PROCEDURE EQADICPRODUTOSP;
GRANT INSERT, SELECT ON VDPRECOPROD TO PROCEDURE EQCOPIAPROD;
GRANT SELECT ON VDPRECOPROD TO PROCEDURE VDBUSCAPRECOSP;
GRANT INSERT, SELECT, UPDATE ON VDPRECOPROD TO PROCEDURE VDPRECOPRODSP01;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDPREVTRIBITORC TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDREGCOMISDESC TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDREGRACOMIS TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDREMCONSIG TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDROMANEIO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDSETOR TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDSETORROTA TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDSTATUSORC TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDTABPRECO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDTEF TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDTIPOCLI TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDTIPOVEND TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDTRANSP TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDTRANSPMOT TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDTRANSPVEIC TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDVEICULO TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDVENDA TO ROLE ADM;
GRANT SELECT, UPDATE ON VDVENDA TO PROCEDURE CPGERAENTRADASP;
GRANT SELECT ON VDVENDA TO PROCEDURE EQRELGIROPROD;
GRANT SELECT ON VDVENDA TO PROCEDURE EQRELGIROPRODPERI;
GRANT SELECT ON VDVENDA TO PROCEDURE VDADICITEMPDVSP;
GRANT SELECT ON VDVENDA TO PROCEDURE VDADICITVENDAORCSP;
GRANT INSERT, SELECT ON VDVENDA TO PROCEDURE VDADICVENDAORCSP;
GRANT INSERT, SELECT ON VDVENDA TO PROCEDURE VDATUDESCVENDAORCSP;
GRANT SELECT, UPDATE ON VDVENDA TO PROCEDURE VDBLOQVENDASP;
GRANT SELECT ON VDVENDA TO PROCEDURE VDEVOLUVENDAS;
GRANT SELECT ON VDVENDA TO PROCEDURE VDGERACOMISSAOSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDVENDACOMIS TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDVENDACONSIG TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDVENDAENTREGA TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDVENDAORC TO ROLE ADM;
GRANT INSERT ON VDVENDAORC TO PROCEDURE VDADICITVENDAORCSP;
GRANT DELETE, INSERT, SELECT, UPDATE ON VDVENDEDOR TO ROLE ADM;
GRANT SELECT ON VDVENDEDOR TO PROCEDURE VDADICVENDAORCSP;
GRANT SELECT ON VWCUSTOPROJ01 TO ROLE ADM;
GRANT DELETE, INSERT, SELECT, UPDATE ON VWPROD_PRECO_CUSTO TO ROLE ADM;
GRANT ADM TO SYSDBA WITH ADMIN OPTION;
GRANT EXECUTE ON PROCEDURE ARREDDOUBLE TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE ARREDDOUBLE TO PROCEDURE CPCOMPRASP01;
GRANT EXECUTE ON PROCEDURE ARREDDOUBLE TO PROCEDURE FNGERAITRECEBERSP01;
GRANT EXECUTE ON PROCEDURE ATADICATENDIMENTOCLISP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE ATADICATENDIMENTOSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE ATBUSCAPRECOSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE ATRESUMOATENDOSP01 TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE ATRESUMOATENDOSP01 TO PROCEDURE ATRESUMOATENDOSP02;
GRANT EXECUTE ON PROCEDURE ATRESUMOATENDOSP02 TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE CPADICCOMPRAPEDSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE CPADICFORSP TO PROCEDURE CPGERAENTRADASP;
GRANT EXECUTE ON PROCEDURE CPADICITCOMPRAPEDSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE CPADICITCOMPRARECMERCSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE CPBLOQCOMPRASP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE CPCOMPRASP01 TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE CPGERADEVOLUCAOSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE CPGERAITENTRADASP TO PROCEDURE CPGERAENTRADASP;
GRANT EXECUTE ON PROCEDURE CPITCOMPRASERIESP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE CPREORGCOMPRASP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE CPUPCOMPRAPEDSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE CPUPCOMPRAPEDSP TO PROCEDURE CPADICCOMPRAPEDSP;
GRANT EXECUTE ON PROCEDURE CRCARREGAPONTOSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE CRINSEREBATIDASP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE CRTOTAL01ISP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE CRTOTAL02TAREFASP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE EQADICPRODUTOSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE EQBUSCASIMILARSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE EQCALCPEPSSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE EQCALCPEPSSP TO PROCEDURE EQCUSTOPRODSP;
GRANT EXECUTE ON PROCEDURE EQCALCPEPSSP TO PROCEDURE EQPRODUTOSP01;
GRANT EXECUTE ON PROCEDURE EQCALCPEPSSP TO PROCEDURE EQRELINVPRODSP;
GRANT EXECUTE ON PROCEDURE EQCALCPEPSSP TO PROCEDURE EQRELPEPSSP;
GRANT EXECUTE ON PROCEDURE EQCOPIAPROD TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE EQCUSTOPRODSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE EQGERARMAOSSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE EQGERARMASP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE EQITRECMERCSERIESP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE EQITRECMERCSERIESP TO PROCEDURE EQITRECMERCSERIESP;
GRANT EXECUTE ON PROCEDURE EQMOVPRODATEQSP TO TRIGGER EQMOVPRODTGAD;
GRANT EXECUTE ON PROCEDURE EQMOVPRODATEQSP TO TRIGGER EQMOVPRODTGAI;
GRANT EXECUTE ON PROCEDURE EQMOVPRODATEQSP TO TRIGGER EQMOVPRODTGAU;
GRANT EXECUTE ON PROCEDURE EQMOVPRODCKCPSP TO TRIGGER EQMOVPRODTGAI;
GRANT EXECUTE ON PROCEDURE EQMOVPRODCKCPSP TO TRIGGER EQMOVPRODTGAU;
GRANT EXECUTE ON PROCEDURE EQMOVPRODCKTMSP TO PROCEDURE EQMOVPRODCSLDSP;
GRANT EXECUTE ON PROCEDURE EQMOVPRODCKUTMSP TO PROCEDURE EQMOVPRODUSP;
GRANT EXECUTE ON PROCEDURE EQMOVPRODCSLDSP TO PROCEDURE EQMOVPRODCKTMSP;
GRANT EXECUTE ON PROCEDURE EQMOVPRODCSLDSP TO PROCEDURE EQMOVPRODISP;
GRANT EXECUTE ON PROCEDURE EQMOVPRODCSLDSP TO PROCEDURE EQMOVPRODPRCSLDSP;
GRANT EXECUTE ON PROCEDURE EQMOVPRODCSLDSP TO PROCEDURE EQMOVPRODUSP;
GRANT EXECUTE ON PROCEDURE EQMOVPRODDSP TO PROCEDURE EQMOVPRODIUDSP;
GRANT EXECUTE ON PROCEDURE EQMOVPRODISP TO PROCEDURE EQMOVPRODIUDSP;
GRANT EXECUTE ON PROCEDURE EQMOVPRODIUDSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE EQMOVPRODIUDSP TO TRIGGER CPITCOMPRATGAD;
GRANT EXECUTE ON PROCEDURE EQMOVPRODIUDSP TO TRIGGER CPITCOMPRATGAI;
GRANT EXECUTE ON PROCEDURE EQMOVPRODIUDSP TO TRIGGER CPITCOMPRATGAU;
GRANT EXECUTE ON PROCEDURE EQMOVPRODIUDSP TO TRIGGER EQINVPRODTGAD;
GRANT EXECUTE ON PROCEDURE EQMOVPRODIUDSP TO TRIGGER EQINVPRODTGAI;
GRANT EXECUTE ON PROCEDURE EQMOVPRODIUDSP TO TRIGGER EQINVPRODTGAU;
GRANT EXECUTE ON PROCEDURE EQMOVPRODIUDSP TO TRIGGER VDITVENDATGAD;
GRANT EXECUTE ON PROCEDURE EQMOVPRODIUDSP TO TRIGGER VDITVENDATGAI;
GRANT EXECUTE ON PROCEDURE EQMOVPRODIUDSP TO TRIGGER VDITVENDATGAU;
GRANT EXECUTE ON PROCEDURE EQMOVPRODPRCSLDSP TO PROCEDURE EQMOVPRODDSP;
GRANT EXECUTE ON PROCEDURE EQMOVPRODPRCSLDSP TO PROCEDURE EQMOVPRODISP;
GRANT EXECUTE ON PROCEDURE EQMOVPRODPRCSLDSP TO PROCEDURE EQMOVPRODUSP;
GRANT EXECUTE ON PROCEDURE EQMOVPRODRETCODSP TO PROCEDURE EQMOVPRODDSP;
GRANT EXECUTE ON PROCEDURE EQMOVPRODRETCODSP TO PROCEDURE EQMOVPRODUSP;
GRANT EXECUTE ON PROCEDURE EQMOVPRODSEQSP TO PROCEDURE EQMOVPRODISP;
GRANT EXECUTE ON PROCEDURE EQMOVPRODSLDSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE EQMOVPRODSLDSP TO PROCEDURE EQMOVPRODDSP;
GRANT EXECUTE ON PROCEDURE EQMOVPRODSLDSP TO PROCEDURE EQMOVPRODISP;
GRANT EXECUTE ON PROCEDURE EQMOVPRODSLDSP TO PROCEDURE EQMOVPRODUSP;
GRANT EXECUTE ON PROCEDURE EQMOVPRODSLDSP TO PROCEDURE EQRELINVPRODSP;
GRANT EXECUTE ON PROCEDURE EQMOVPRODUSP TO PROCEDURE EQMOVPRODIUDSP;
GRANT EXECUTE ON PROCEDURE EQPRODUTOSP01 TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE EQPRODUTOSP01 TO PROCEDURE EQGERARMAOSSP;
GRANT EXECUTE ON PROCEDURE EQRELDEMANDASP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE EQRELGIROPROD TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE EQRELGIROPRODPERI TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE EQRELINVPRODSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE EQRELPEPSSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE EQSALDOLOTEATEQSP TO PROCEDURE EQMOVPRODATEQSP;
GRANT EXECUTE ON PROCEDURE EQSALDOPRODATEQSP TO PROCEDURE EQMOVPRODATEQSP;
GRANT EXECUTE ON PROCEDURE FNADICITRECEBERSP01 TO PROCEDURE FNGERAITRECEBERSP01;
GRANT EXECUTE ON PROCEDURE FNADICLANCASP01 TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE FNADICLANCASP02 TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE FNADICPAGARSP01 TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE FNADICRECEBERSP01 TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE FNCHECAPGTOATRASOSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE FNCHECAPGTOSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE FNDELETARECEBERSP TO TRIGGER VDVENDATGAU;
GRANT EXECUTE ON PROCEDURE FNESTORNACOMISSAOSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE FNGERAITRECEBERSP01 TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE FNGERAITRECEBERSP01 TO TRIGGER FNRECEBERTGAI;
GRANT EXECUTE ON PROCEDURE FNGERAITRECEBERSP01 TO TRIGGER FNRECEBERTGAU;
GRANT EXECUTE ON PROCEDURE FNGERASEQNOSSONUMERO TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE FNITRECEBERSP01 TO TRIGGER FNRECEBERTGAU;
GRANT EXECUTE ON PROCEDURE FNITRECEBERSP01 TO TRIGGER VDVENDATGAU;
GRANT EXECUTE ON PROCEDURE FNITRECEBERSP01 TO TRIGGER VDVENDATGBU;
GRANT EXECUTE ON PROCEDURE FNLIBCREDSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE FNSALDOPLANSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE GERAEXPEDIENTESP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE LFBUSCAFISCALSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE LFBUSCAFISCALSP TO PROCEDURE CPADICCOMPRAPEDSP;
GRANT EXECUTE ON PROCEDURE LFBUSCAFISCALSP TO PROCEDURE LFBUSCAPREVTRIBORC;
GRANT EXECUTE ON PROCEDURE LFBUSCAFISCALSP TO PROCEDURE LFBUSCATRIBCOMPRA;
GRANT EXECUTE ON PROCEDURE LFBUSCAFISCALSP TO PROCEDURE VDADICITEMPDVSP;
GRANT EXECUTE ON PROCEDURE LFBUSCAFISCALSP TO PROCEDURE VDADICITVENDAORCSP;
GRANT EXECUTE ON PROCEDURE LFBUSCAFISCALSP02 TO PROCEDURE LFGERALFITCOMPRASP;
GRANT EXECUTE ON PROCEDURE LFBUSCAFISCALSP02 TO PROCEDURE LFGERALFITVENDASP;
GRANT EXECUTE ON PROCEDURE LFBUSCAICMSSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE LFBUSCAICMSSP TO PROCEDURE CPADICITCOMPRAPEDSP;
GRANT EXECUTE ON PROCEDURE LFBUSCAICMSSP TO PROCEDURE LFGERALFITCOMPRASP;
GRANT EXECUTE ON PROCEDURE LFBUSCAICMSSP TO PROCEDURE VDADICITEMPDVSP;
GRANT EXECUTE ON PROCEDURE LFBUSCAICMSSP TO PROCEDURE VDADICITVENDAORCSP;
GRANT EXECUTE ON PROCEDURE LFBUSCANATSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE LFBUSCANATSP TO PROCEDURE CPADICITCOMPRAPEDSP;
GRANT EXECUTE ON PROCEDURE LFBUSCANATSP TO PROCEDURE CPGERAITENTRADASP;
GRANT EXECUTE ON PROCEDURE LFBUSCANATSP TO PROCEDURE VDADICITEMPDVSP;
GRANT EXECUTE ON PROCEDURE LFBUSCANATSP TO PROCEDURE VDADICITVENDAORCSP;
GRANT EXECUTE ON PROCEDURE LFBUSCAPREVTRIBORC TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE LFBUSCAPREVTRIBORC TO TRIGGER VDITORCAMENTOTGAI;
GRANT EXECUTE ON PROCEDURE LFBUSCAPREVTRIBORC TO TRIGGER VDITORCAMENTOTGAU;
GRANT EXECUTE ON PROCEDURE LFBUSCATRIBCOMPRA TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE LFCALCCUSTOSP01 TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE LFGERALFITCOMPRASP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE LFGERALFITCOMPRASP TO TRIGGER VDITCOMPRATGAI;
GRANT EXECUTE ON PROCEDURE LFGERALFITCOMPRASP TO TRIGGER VDITCOMPRATGAU;
GRANT EXECUTE ON PROCEDURE LFGERALFITVENDASP TO TRIGGER VDITVENDATGAI;
GRANT EXECUTE ON PROCEDURE LFGERALFITVENDASP TO TRIGGER VDITVENDATGAU;
GRANT EXECUTE ON PROCEDURE LFNOVODOCSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE LFNOVODOCSP TO PROCEDURE CPGERAENTRADASP;
GRANT EXECUTE ON PROCEDURE PPATUDISTOPSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE PPGERAOP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE PPGERAOPCQ TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE PPITOPSP01 TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE PPITOPSP02 TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE PVABRECAIXASP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE PVADICMOVCAIXASP01 TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE PVADICMOVCAIXASP01 TO PROCEDURE PVSEQMOVCAIXASP;
GRANT EXECUTE ON PROCEDURE PVFECHACAIXASP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE PVFECHAVENDASP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE PVRETMOVCAIXASP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE PVSANGRIASP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE PVSEQMOVCAIXASP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE PVSUPRIMENTOSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE PVVERIFCAIXASP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE RHLISTACANDVAGASP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE RHLISTAVAGACANDSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE SGAGENTEISP TO PROCEDURE SGAGENTEUIDSP;
GRANT EXECUTE ON PROCEDURE SGAGENTEUIDSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE SGAGENTEUIDSP TO PUBLIC;
GRANT EXECUTE ON PROCEDURE SGAGENTEUSP TO PROCEDURE SGAGENTEUIDSP;
GRANT EXECUTE ON PROCEDURE SGATUALIZABDSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE SGATUALIZABDSP TO PROCEDURE SGINICONSP;
GRANT EXECUTE ON PROCEDURE SGCALCVENCSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE SGCALCVENCSP TO PROCEDURE FNGERAITRECEBERSP01;
GRANT EXECUTE ON PROCEDURE SGDADOSINISP TO PROCEDURE SGATUALIZABDSP;
GRANT EXECUTE ON PROCEDURE SGDEBUGSP TO PROCEDURE SGGERACNFSP;
GRANT EXECUTE ON PROCEDURE SGESTACAOIMPSP01 TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE SGFIMCONSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE SGFIMCONSP TO PUBLIC;
GRANT EXECUTE ON PROCEDURE SGGERACNFSP TO PUBLIC;
GRANT EXECUTE ON PROCEDURE SGGRANTADMSP TO PROCEDURE SGATUALIZABDSP;
GRANT EXECUTE ON PROCEDURE SGGRANTUSERSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE SGGRANTUSERSP TO PROCEDURE SGATUALIZABDSP;
GRANT EXECUTE ON PROCEDURE SGINICONSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE SGINICONSP TO PUBLIC;
GRANT EXECUTE ON PROCEDURE SGLOGSP01 TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE SGOBJETOINSTBSP TO PROCEDURE SGATUALIZABDSP;
GRANT EXECUTE ON PROCEDURE SGRETCAIXA TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE SGRETCAIXA TO TRIGGER VDVENDATGBI;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO PROCEDURE ATADICATENDIMENTOCLISP;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO PROCEDURE ATADICATENDIMENTOSP;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO PROCEDURE CPADICCOMPRAPEDSP;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO PROCEDURE CPADICFORSP;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO PROCEDURE CPADICITCOMPRAPEDSP;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO PROCEDURE CPGERAENTRADASP;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO PROCEDURE CPGERAITENTRADASP;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO PROCEDURE CRTOTAL01ISP;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO PROCEDURE EQGERARMAOSSP;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO PROCEDURE EQMOVPRODSEQSP;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO PROCEDURE FNADICLANCASP01;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO PROCEDURE FNADICLANCASP02;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO PROCEDURE FNADICPAGARSP01;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO PROCEDURE FNADICRECEBERSP01;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO PROCEDURE FNCHECAPGTOATRASOSP;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO PROCEDURE FNCHECAPGTOSP;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO PROCEDURE FNLIBCREDSP;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO PROCEDURE FNSALDOPLANSP;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO PROCEDURE NEW_PROCEDURE;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO PROCEDURE PVFECHAVENDASP;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO PROCEDURE PVSANGRIASP;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO PROCEDURE PVSUPRIMENTOSP;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO PROCEDURE SGAGENTEUIDSP;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO PROCEDURE SGCALCVENCSP;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO PROCEDURE SGRETMULTIALMOXSP;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO PROCEDURE SGSETAGENDASP;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO PROCEDURE TKCONTCLISP;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO PROCEDURE TKCONTTOCLI;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO PROCEDURE TKGERACAMPANHACTO;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO PROCEDURE TKSETHISTSP;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO PROCEDURE VDADICCOMISSAOSP;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO PROCEDURE VDADICCOMPRAPEDSP;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO PROCEDURE VDADICITEMPDVSP;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO PROCEDURE VDADICITVENDAORCSP;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO PROCEDURE VDADICVENDAORCSP;
GRANT EXECUTE ON PROCEDURE SGRETFILIAL TO PROCEDURE VDBAIXACOMISSAOSP;
GRANT EXECUTE ON PROCEDURE SGRETINFOUSU TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE SGRETINFOUSU TO PROCEDURE EQGERARMAOSSP;
GRANT EXECUTE ON PROCEDURE SGRETINFOUSU TO PROCEDURE NEW_PROCEDURE;
GRANT EXECUTE ON PROCEDURE SGRETINFOUSU TO PROCEDURE TKGERACAMPANHACTO;
GRANT EXECUTE ON PROCEDURE SGRETMULTIALMOXSP TO PROCEDURE EQMOVPRODIUDSP;
GRANT EXECUTE ON PROCEDURE SGRETMULTIALMOXSP TO PROCEDURE EQRELINVPRODSP;
GRANT EXECUTE ON PROCEDURE SGRETMULTICOMISSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE SGRETMULTICOMISSP TO PROCEDURE ATADICATENDIMENTOCLISP;
GRANT EXECUTE ON PROCEDURE SGRETMULTICOMISSP TO PROCEDURE VDGERACOMISSAOSP;
GRANT EXECUTE ON PROCEDURE SGRETVERSAO TO PUBLIC;
GRANT EXECUTE ON PROCEDURE SGSEQUENCE_IDSP TO PUBLIC;
GRANT EXECUTE ON PROCEDURE SGSEQUENCE_IDSP TO PROCEDURE SGGERACNFSP;
GRANT EXECUTE ON PROCEDURE SGSETAGENDASP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE SGUPACESSOMUSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE SGUPMENUSP01 TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE SGVALUES TO PUBLIC;
GRANT EXECUTE ON PROCEDURE SPGERANUM TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE SPGERANUM TO PROCEDURE ATADICATENDIMENTOCLISP;
GRANT EXECUTE ON PROCEDURE SPGERANUM TO PROCEDURE ATADICATENDIMENTOSP;
GRANT EXECUTE ON PROCEDURE SPGERANUM TO PROCEDURE CPADICCOMPRAPEDSP;
GRANT EXECUTE ON PROCEDURE SPGERANUM TO PROCEDURE CPGERAENTRADASP;
GRANT EXECUTE ON PROCEDURE SPGERANUM TO PROCEDURE CRTOTAL01ISP;
GRANT EXECUTE ON PROCEDURE SPGERANUM TO PROCEDURE EQMOVPRODSEQSP;
GRANT EXECUTE ON PROCEDURE SPGERANUM TO PROCEDURE FNADICLANCASP01;
GRANT EXECUTE ON PROCEDURE SPGERANUM TO PROCEDURE FNADICLANCASP02;
GRANT EXECUTE ON PROCEDURE SPGERANUM TO PROCEDURE FNADICPAGARSP01;
GRANT EXECUTE ON PROCEDURE SPGERANUM TO PROCEDURE FNADICRECEBERSP01;
GRANT EXECUTE ON PROCEDURE SPGERANUM TO PROCEDURE PVADICMOVCAIXASP01;
GRANT EXECUTE ON PROCEDURE SPGERANUM TO PROCEDURE PVFECHACAIXASP;
GRANT EXECUTE ON PROCEDURE SPGERANUM TO PROCEDURE PVFECHAVENDASP;
GRANT EXECUTE ON PROCEDURE SPGERANUM TO PROCEDURE PVSANGRIASP;
GRANT EXECUTE ON PROCEDURE SPGERANUM TO PROCEDURE PVSUPRIMENTOSP;
GRANT EXECUTE ON PROCEDURE SPGERANUM TO PROCEDURE SGLOGSP01;
GRANT EXECUTE ON PROCEDURE SPGERANUM TO PROCEDURE SGSETAGENDASP;
GRANT EXECUTE ON PROCEDURE SPGERANUM TO PROCEDURE TKGERACAMPANHACTO;
GRANT EXECUTE ON PROCEDURE SPGERANUM TO PROCEDURE VDADICCOMPRAPEDSP;
GRANT EXECUTE ON PROCEDURE SPGERANUM TO PROCEDURE VDADICVENDAORCSP;
GRANT EXECUTE ON PROCEDURE SPGERANUM TO PROCEDURE VDBAIXACOMISSAOSP;
GRANT EXECUTE ON PROCEDURE SPGERANUM TO PROCEDURE VDCOPIAORCSP;
GRANT EXECUTE ON PROCEDURE TKCONTCLISP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE TKGERACAMPANHACTO TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE TKSETHISTSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE VDADICCOMISSAOSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE VDADICCOMISSAOSP TO PROCEDURE FNESTORNACOMISSAOSP;
GRANT EXECUTE ON PROCEDURE VDADICCOMISSAOSP TO PROCEDURE VDESTORNACOMISSAOSP;
GRANT EXECUTE ON PROCEDURE VDADICCOMISSAOSP TO PROCEDURE VDGERACOMISSAOSP;
GRANT EXECUTE ON PROCEDURE VDADICITEMPDVSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE VDADICITORCRECMERCSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE VDADICITVENDAORCSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE VDADICVENDAORCSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE VDATUDESCVENDAORCSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE VDBAIXACOMISSAOSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE VDBLOQVENDASP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE VDBUSCAPRECOSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE VDBUSCAPRECOSP TO PROCEDURE ATBUSCAPRECOSP;
GRANT EXECUTE ON PROCEDURE VDBUSCAPRECOSP TO PROCEDURE CPADICITORCRECMERCSP;
GRANT EXECUTE ON PROCEDURE VDBUSCAPRECOSP TO PROCEDURE VDADICITORCRECMERCSP;
GRANT EXECUTE ON PROCEDURE VDCLIENTEATIVOSP TO TRIGGER VDORCAMENTOTGBI;
GRANT EXECUTE ON PROCEDURE VDCLIENTEATIVOSP TO TRIGGER VDORCAMENTOTGBU;
GRANT EXECUTE ON PROCEDURE VDCLIENTEATIVOSP TO TRIGGER VDVENDATGBI;
GRANT EXECUTE ON PROCEDURE VDCLIENTEATIVOSP TO TRIGGER VDVENDATGBU;
GRANT EXECUTE ON PROCEDURE VDCONTRATOTOTSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE VDCOPIACLIENTE TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE VDCOPIAORCSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE VDDESBAIXACOMISSAOSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE VDEVOLUVENDAS TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE VDGERACOMISSAOSP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE VDGERACOMISSAOSP TO PROCEDURE FNITRECEBERSP01;
GRANT EXECUTE ON PROCEDURE VDGERACOMISSAOSP TO TRIGGER FNITRECEBERTGAI;
GRANT EXECUTE ON PROCEDURE VDGERACOMISSAOSP TO TRIGGER FNITRECEBERTGAU;
GRANT EXECUTE ON PROCEDURE VDITVENDASERIESP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE VDITVENDASERIESP TO PROCEDURE VDITVENDASERIESP;
GRANT EXECUTE ON PROCEDURE VDREORGVENDASP TO ROLE ADM;
GRANT EXECUTE ON PROCEDURE VDUPVENDAORCSP TO ROLE ADM;

/* Comments for database objects. */
COMMENT ON TABLE        ATATENDENTE IS 'Atendentes.';
COMMENT ON    COLUMN    ATATENDIMENTO.DATAATENDOFIN IS 'Data final do atendimento';
COMMENT ON    COLUMN    ATATENDIMENTO.HORAATENDOFIN IS 'Hora final do atendimento.';
COMMENT ON    COLUMN    ATATENDIMENTO.OBSINTERNO IS 'Campo para observaes de interesse interno.';
COMMENT ON    COLUMN    ATATENDIMENTO.CODEMPCT IS 'Cdigo da empresa do contrato.';
COMMENT ON    COLUMN    ATATENDIMENTO.CODFILIALCT IS 'Cdigo da filial do contrato.';
COMMENT ON    COLUMN    ATATENDIMENTO.CODCONTR IS 'Cdigo do contrato.';
COMMENT ON    COLUMN    ATATENDIMENTO.CODITCONTR IS 'Cdigo do tem de contrato.';
COMMENT ON    COLUMN    ATATENDIMENTO.CODEMPCH IS 'Cdigo da empresa do chamado.';
COMMENT ON    COLUMN    ATATENDIMENTO.CODFILIALCH IS 'Cdigo da filial do chamado.';
COMMENT ON    COLUMN    ATATENDIMENTO.CODCHAMADO IS 'Cdigo do Chamado.';
COMMENT ON    COLUMN    ATATENDIMENTO.CONCLUICHAMADO IS 'Indica se o atendimento deve concluir o chamado';
COMMENT ON    COLUMN    ATATENDIMENTO.CODEMPEA IS 'Cdigo da empresa na tabela de especificao.';
COMMENT ON    COLUMN    ATATENDIMENTO.CODFILIALEA IS 'Cdigo da filial na tabela de especificao.';
COMMENT ON    COLUMN    ATATENDIMENTO.CODESPEC IS 'Cdigo de especificao.';
COMMENT ON TABLE        ATATENDIMENTOITREC IS 'Tabela para vinculo entre item de contas a receber e atendimentos, a fim de registrar contatos e atendimentos,
referentes a cobranas e negociaes de ttulos.';
COMMENT ON TABLE        ATCLASATENDO IS 'Tabela para classificar um atendimento.
ex.: bug, cortesia, garantia, etc.';
COMMENT ON    COLUMN    ATCLASATENDO.GERACOB IS 'Indica se deve gerar cobrana no relatrio de atendimentos.';
COMMENT ON    COLUMN    ATCLASATENDO.GERAREL IS 'Indica se deve aparecer no relatrio de atendimentos.';
COMMENT ON    COLUMN    ATCONVENIADO.CODEMPEC IS 'Cdigo da empresa - Encaminhador
';
COMMENT ON    COLUMN    ATCONVENIADO.CODFILIALEC IS 'Cdigo da filial na tabela de encaminhador.
';
COMMENT ON    COLUMN    ATCONVENIADO.CODENC IS 'Cdigo do encaminhador.
';
COMMENT ON    COLUMN    ATCONVENIADO.CODEMPFC IS 'Cdigo da empresa na tabela RHFUNCAO';
COMMENT ON    COLUMN    ATCONVENIADO.CODFILIALFC IS 'Cdigo da filial na tabela RHFUNCAO.';
COMMENT ON    COLUMN    ATCONVENIADO.CODFUNC IS 'Cdigo da funo.';
COMMENT ON    COLUMN    ATCONVENIADO.DDDCONV IS 'Cdigo DDD do telefone principal do conveniado.';
COMMENT ON    COLUMN    ATCONVENIADO.DDDFAXCONV IS 'CDIGO DDD DO FAX DO CONVENIADO.';
COMMENT ON    COLUMN    ATCONVENIADO.DDDCELCONV IS 'CDIGO DDD DO CELULAR DO CONVENIADO.';
COMMENT ON TABLE        ATENCAMINHADOR IS 'Tabela de empresas encaminhadoras de conveniados';
COMMENT ON    COLUMN    ATENCAMINHADOR.CODEMP IS 'Cdigo da empresa
';
COMMENT ON    COLUMN    ATENCAMINHADOR.CODFILIAL IS 'Cdigo da filial
';
COMMENT ON    COLUMN    ATENCAMINHADOR.CODENC IS 'Cdigo do encaminhador
';
COMMENT ON    COLUMN    ATENCAMINHADOR.NOMEENC IS 'Nome do encaminhador
';
COMMENT ON    COLUMN    ATENCAMINHADOR.ENDENC IS 'Endereo
';
COMMENT ON    COLUMN    ATENCAMINHADOR.NUMENC IS 'Nmero do logradouro
';
COMMENT ON    COLUMN    ATENCAMINHADOR.COMPLENC IS 'Complemento do endereo
';
COMMENT ON    COLUMN    ATENCAMINHADOR.CIDENC IS 'Cidade
';
COMMENT ON    COLUMN    ATENCAMINHADOR.BAIRENC IS 'Bairro
';
COMMENT ON    COLUMN    ATENCAMINHADOR.UFENC IS 'Estado UF
';
COMMENT ON    COLUMN    ATENCAMINHADOR.CEPENC IS 'Cep
';
COMMENT ON    COLUMN    ATENCAMINHADOR.FONEENC IS 'Telefone
';
COMMENT ON    COLUMN    ATENCAMINHADOR.FAXENC IS 'Nmero do fax
';
COMMENT ON TABLE        ATESPECATEND IS 'Especificao dos atendimentos';
COMMENT ON    COLUMN    ATESPECATEND.CODEMP IS 'Cdigo da empresa.';
COMMENT ON    COLUMN    ATESPECATEND.CODFILIAL IS 'Cdigo da filial.';
COMMENT ON    COLUMN    ATESPECATEND.CODESPEC IS 'Cdigo da especificao.';
COMMENT ON    COLUMN    ATESPECATEND.DESCESPEC IS 'Descrio da especificao.';
COMMENT ON    COLUMN    ATESPECATEND.PGCOMIESPEC IS 'Paga comisso (S/N).';
COMMENT ON    COLUMN    ATESPECATEND.COBCLIESPEC IS 'Cobrar do cliente (S/N).';
COMMENT ON    COLUMN    ATESPECATEND.CONTMETAESPEC IS 'Contabiliza para meta (S/N).';
COMMENT ON    COLUMN    ATESPECATEND.TEMPOMINCOBESPEC IS 'Tempo mnimo a contabilizar.';
COMMENT ON    COLUMN    ATESPECATEND.TEMPOMAXCOBESPEC IS 'Tempo mximo a contabilizar.';
COMMENT ON    COLUMN    ATESPECATEND.PERCCOMIESPEC IS 'Percentual de comisso do atendente.';
COMMENT ON    COLUMN    ATESPECATEND.DTINS IS 'Data de insero.';
COMMENT ON    COLUMN    ATESPECATEND.IDUSUINS IS 'Id do usurio que inseriu.';
COMMENT ON    COLUMN    ATESPECATEND.DTALT IS 'Data da ltima alterao.';
COMMENT ON    COLUMN    ATESPECATEND.IDUSUALT IS 'Id do usurio que fez a ltima alterao.';
COMMENT ON    COLUMN    ATESPECATEND.HINS IS 'Hora de insero.';
COMMENT ON    COLUMN    ATESPECATEND.HALT IS 'Hora da ltima alterao.';
COMMENT ON    COLUMN    ATTIPOATENDO.TIPOATENDO IS 'Tipo de atendimento.
C - Contato
A - Atendimento
';
COMMENT ON TABLE        CBCONTAEXT IS 'Tabela de contas contbeis externas.';
COMMENT ON    COLUMN    CPCOMPRA.DTCOMPCOMPRA IS 'Data de competncia.';
COMMENT ON    COLUMN    CPCOMPRA.VLRBASEICMSSTCOMPRA IS 'Valor da base de clculo do ICMS de substituio tributria.';
COMMENT ON    COLUMN    CPCOMPRA.VLRICMSSTCOMPRA IS 'Valor do ICMS de substituio tributria.';
COMMENT ON    COLUMN    CPCOMPRA.VLRFUNRURALCOMPRA IS 'Valor da reteno referente ao Funrural.';
COMMENT ON    COLUMN    CPCOMPRA.CODEMPTC IS 'Cdigo da empresa na tabela tipo de cobrana.
';
COMMENT ON    COLUMN    CPCOMPRA.CODFILIALTC IS 'Cdigo da filial na tabela tipo de cobrana.
';
COMMENT ON    COLUMN    CPCOMPRA.CODTIPOCOB IS 'Cdigo do tipo de cobrana.
';
COMMENT ON    COLUMN    CPCOMPRA.IMPNOTACOMPRA IS 'Flag que indica se a nota fiscal foi impressa (S/N).';
COMMENT ON    COLUMN    CPCOMPRA.BLOQCOMPRA IS 'Flag de bloqueio de compra.';
COMMENT ON    COLUMN    CPCOMPRA.EMMANUT IS 'Flag que indica se a tabela est em manuteno (S/N).';
COMMENT ON    COLUMN    CPCOMPRA.ADICFRETECOMPRA IS 'Flag que indica se soma o valor do frete ao custo do produto.';
COMMENT ON    COLUMN    CPCOMPRA.TIPOFRETECOMPRA IS 'Tipo do frete na compra.';
COMMENT ON    COLUMN    CPCOMPRA.OBS01 IS 'Campo "coringa" para outras observaes.';
COMMENT ON    COLUMN    CPCOMPRA.OBS02 IS 'Campo "coringa" para outras observaes.';
COMMENT ON    COLUMN    CPCOMPRA.OBS03 IS 'Campo "coringa" para outras observaes.';
COMMENT ON    COLUMN    CPCOMPRA.OBS04 IS 'Campo "coringa" para outras observaes.';
COMMENT ON    COLUMN    CPCOMPRA.ADICADICCOMPRA IS 'Flag que indica se soma o valor adicional ao custo do produto.';
COMMENT ON    COLUMN    CPCOMPRA.QTDFRETECOMPRA IS 'Quantidade de volumes na nota de entrada.';
COMMENT ON    COLUMN    CPCOMPRA.ADICFRETEBASEICMS IS 'Indica se deve adicionar o valor do frete  base de calculo do icms.';
COMMENT ON    COLUMN    CPCOMPRA.ADICADICBASEICMS IS 'Indica se deve somar os valores adicionais  base de calculo do ICMS.';
COMMENT ON    COLUMN    CPCOMPRA.ADICIPIBASEICMS IS 'Indica se deve adicionar o valor do IPI  base de calculo do ICMS.';
COMMENT ON    COLUMN    CPCOMPRA.CHAVENFECOMPRA IS 'Chave de acesso da nota fiscal eletrnica de compra.';
COMMENT ON    COLUMN    CPCOMPRA.STATUSCOMPRA IS 'P1 - Pendente;
P2 - Em aberto;
P3 - Em aberto;
C2 - Emitida;
C3 - Emitida;
EP - Pedido de compra emitida parcialmente em outra compra;
ET - Pedido de compra emitido totalmente em outra compra;
X - Cancelada;';
COMMENT ON    COLUMN    CPCOMPRA.NRODI IS 'Nmero do documento de importao DI/DSI/DA';
COMMENT ON    COLUMN    CPCOMPRA.DTREGDI IS 'Data de registro da DI';
COMMENT ON    COLUMN    CPCOMPRA.LOCDESEMBDI IS 'Loca de desembara da DI';
COMMENT ON    COLUMN    CPCOMPRA.SIGLAUFDESEMBDI IS 'Estado onde ocorreu o desembarao da DI';
COMMENT ON    COLUMN    CPCOMPRA.CODPAISDESEMBDI IS 'Cdigo do pas onde ocorreu o desembarao da DI (ser sempre o pais da filial, mantido por integridade referencial tabela SGUF)';
COMMENT ON    COLUMN    CPCOMPRA.DTDESEMBDI IS 'Data do desembarao da DI';
COMMENT ON    COLUMN    CPCOMPRA.IDENTCONTAINER IS 'Identificao do container da compra (importao)';
COMMENT ON    COLUMN    CPCOMPRA.CALCTRIB IS 'Indica se deve realizar o calculo de tributos';
COMMENT ON    COLUMN    CPCOMPRA.CODEMPRM IS 'Cdigo da empresa do recebimento de mercadoria vinculado.';
COMMENT ON    COLUMN    CPCOMPRA.CODFILIALRM IS 'Cdigo da filial do recebimento de mercadoria vinculado.';
COMMENT ON    COLUMN    CPCOMPRA.TICKET IS 'Ticket do recebimento de mercadoria vinculado.';
COMMENT ON    COLUMN    CPCOMPRA.CODEMPCT IS 'Cdigo da empresa da conta.';
COMMENT ON    COLUMN    CPCOMPRA.CODFILIALCT IS 'Cdigo da filial da compra.';
COMMENT ON    COLUMN    CPCOMPRA.NUMCONTA IS 'Nmero da conta.';
COMMENT ON    COLUMN    CPCOMPRA.CODEMPCC IS 'Cdigo da empresa do centro de custos';
COMMENT ON    COLUMN    CPCOMPRA.CODFILIALCC IS 'Cdigo da filial do centro de custos.';
COMMENT ON    COLUMN    CPCOMPRA.ANOCC IS 'Ano do centro de custo';
COMMENT ON    COLUMN    CPCOMPRA.CODCC IS 'Cdigo do centro de custos';
COMMENT ON    COLUMN    CPCOMPRA.CODEMPPN IS 'Cdigo da empresa do planejamento financeiro.';
COMMENT ON    COLUMN    CPCOMPRA.CODFILIALPN IS 'Cdigo do filial do planejamento financeiro.';
COMMENT ON    COLUMN    CPCOMPRA.CODPLAN IS 'Cdigo do planejamento financeiro.';
COMMENT ON    COLUMN    CPCOMPRA.INFCOMPL IS 'Informaes complementares (interesse do fisco)';
COMMENT ON    COLUMN    CPCOMPRA.NUMACDRAW IS 'Nmero do ato concessrio do regime drawback (importao)';
COMMENT ON    COLUMN    CPCOMPRA.TIPODOCIMP IS 'Tipo de documento de importao:
0 - Declarao de importao
1 - Declarao simplificada de importao';
COMMENT ON    COLUMN    CPCOMPRA.SITDOC IS 'Situao do documento fiscal:
00-Documento regular;
01-Documento regular expontneo;
02-Documento cancelado;
03-Documento cancelado expontneo
04-NFE Denegada;
05-NFE Numerao inutilizada;
06-Documento fiscal complementar;
07-Documento fiscal complementar expontneo;
08-Documento emitido com base em Regime Especial ou Norma Especfica;';
COMMENT ON    COLUMN    CPCOMPRA.OBSNFE IS 'Observacao gerada na emissao de nfe.';
COMMENT ON    COLUMN    CPCOMPRA.CODEMPIM IS 'Cdigo da empresa de importao.';
COMMENT ON    COLUMN    CPCOMPRA.CODFILIALIM IS 'Cdigo da filial da importao.';
COMMENT ON    COLUMN    CPCOMPRA.CODIMP IS 'Cdigo da importao.
';
COMMENT ON    COLUMN    CPCOMPRA.VLRBASEIICOMPRA IS 'Valor da base de calculo do imposto de importao.
';
COMMENT ON    COLUMN    CPCOMPRA.VLRIICOMPRA IS 'Valor do imposto de importao da compra.
';
COMMENT ON TABLE        CPCOMPRASOL IS 'Tabela de vinculos para amarrao entre solicitaes de compra
e pedidos/nf de compra.';
COMMENT ON    COLUMN    CPCOMPRASOL.CODCOMPRA IS 'Cdigo da compra.';
COMMENT ON    COLUMN    CPCOMPRASOL.CODSOL IS 'Cdigo da solicitao de compra.';
COMMENT ON    COLUMN    CPCOTACAO.DTVALIDCOT IS 'Data de validade da proposta de preo.';
COMMENT ON    COLUMN    CPCOTACAO.SITCOMPITSOL IS '"PE" - Pendente;
"FN" - Finalizada;';
COMMENT ON    COLUMN    CPCOTACAO.SITAPROVITSOL IS '"PE" - Pendente;
"AP" - Aprovada;';
COMMENT ON    COLUMN    CPCOTACAO.SITITSOL IS '"PE" - Pendente;
"FN" - Finalizada;';
COMMENT ON    COLUMN    CPCOTACAO.USARENDACOT IS 'Indica se deve usar o critrio da renda na busca do preo de cotaes.';
COMMENT ON    COLUMN    CPCOTACAO.RENDACOT IS 'Indica a renda (qualidade) do produto cotado.';
COMMENT ON    COLUMN    CPCOTACAO.CODEMPPP IS 'Cdigo da empresa do plano de pagamento.';
COMMENT ON    COLUMN    CPCOTACAO.CODFILIALPP IS 'Cdigo da filial do plano de pagamento.';
COMMENT ON    COLUMN    CPCOTACAO.CODPLANOPAG IS 'Cdigo do plano de pagamento.';
COMMENT ON TABLE        CPDEVOLUCAO IS 'Tabela para relacionamento entre itens de compra e venda, caracterizando a devoluo de mercadorias.';
COMMENT ON    COLUMN    CPDEVOLUCAO.CODEMP IS 'Cdigo da empresa da compra.';
COMMENT ON    COLUMN    CPDEVOLUCAO.CODFILIAL IS 'Cdigo da filial da compra.';
COMMENT ON    COLUMN    CPDEVOLUCAO.CODCOMPRA IS 'Cdigo da compra.';
COMMENT ON    COLUMN    CPDEVOLUCAO.CODITCOMPRA IS 'Cdigo do tem de compra.';
COMMENT ON    COLUMN    CPDEVOLUCAO.QTDDEV IS 'Quantidade devolvida.';
COMMENT ON    COLUMN    CPDEVOLUCAO.CODEMPVD IS 'Cdigo da empresa da venda (devoluo)';
COMMENT ON    COLUMN    CPDEVOLUCAO.CODFILIALVD IS 'Cdigo da filial da venda (devoluo)';
COMMENT ON    COLUMN    CPDEVOLUCAO.CODVENDA IS 'Cdigo da venda (devoluo)';
COMMENT ON    COLUMN    CPDEVOLUCAO.TIPOVENDA IS 'Tipo da venda (devoluo)';
COMMENT ON    COLUMN    CPDEVOLUCAO.CODITVENDA IS 'Cdigo do tem da venda (devoluo)';
COMMENT ON    COLUMN    CPFORNECED.CELFOR IS 'Nmero do celular
';
COMMENT ON    COLUMN    CPFORNECED.SSPFOR IS 'Orgo de espedio do rg.';
COMMENT ON    COLUMN    CPFORNECED.DDDFONEFOR IS 'DDD do telefone principal.';
COMMENT ON    COLUMN    CPFORNECED.DDDFAXFOR IS 'DDD do fax do fornecedor.';
COMMENT ON    COLUMN    CPFORNECED.DDDCELFOR IS 'DDD do celular do fornecedor.';
COMMENT ON    COLUMN    CPFORNECED.SITEFOR IS 'Endereo eletrnico do site do fornecedor.';
COMMENT ON    COLUMN    CPFORNECED.CODFORCONTAB IS 'Cdigo contabil';
COMMENT ON    COLUMN    CPFORNECED.CODUNIFCOD IS 'Cdigo na tabela de unificao de cdigos (SGUNIFCOD).';
COMMENT ON    COLUMN    CPFORNECED.CODEMPFF IS 'Cdigo da empresa do tipo fiscal do fornecedor.';
COMMENT ON    COLUMN    CPFORNECED.CODFILIALFF IS 'Cdigo da filial do tipo fiscal do fornecedor.';
COMMENT ON    COLUMN    CPFORNECED.CODFISCFOR IS 'Cdigo do tipo fiscal do fornecedor';
COMMENT ON    COLUMN    CPFORNECED.SUFRAMAFOR IS 'Cdigo do SUFRAMA do fornecedor.';
COMMENT ON    COLUMN    CPFORNECED.NRODEPENDFOR IS 'Nmero de dependes do fornecedor (pessoa fsica) (calculo de irrf)';
COMMENT ON    COLUMN    CPFORNECED.INSCCONREG IS 'Inscrio no conselho regional (contabilidae, administrao, medicina, etc..)';
COMMENT ON    COLUMN    CPFRETECP.VLRSEGFRETECP IS 'Valor do seguro no frete.';
COMMENT ON TABLE        CPIMPORTACAO IS 'Tabela de informaes sobre importaes.';
COMMENT ON    COLUMN    CPIMPORTACAO.CODEMP IS 'Cdigo da empresa.';
COMMENT ON    COLUMN    CPIMPORTACAO.CODFILIAL IS 'Cdigo da filial';
COMMENT ON    COLUMN    CPIMPORTACAO.CODIMP IS 'Cdigo da importao';
COMMENT ON    COLUMN    CPIMPORTACAO.CODEMPMI IS 'Cdigo da empresa da moeda de importao.';
COMMENT ON    COLUMN    CPIMPORTACAO.CODFILIALMI IS 'Cdigo da filial da moeda de importao.';
COMMENT ON    COLUMN    CPIMPORTACAO.CODMOEDA IS 'Cdigo da moeda de importao.';
COMMENT ON    COLUMN    CPIMPORTACAO.COTACAOMOEDA IS 'Fator de converso da moeda de importao para moeda corrente.';
COMMENT ON    COLUMN    CPIMPORTACAO.CODEMPPG IS 'Cdigo da empresa do plano de pagamento.';
COMMENT ON    COLUMN    CPIMPORTACAO.CODFILIALPG IS 'Cdigo da filial do plano de pagamento';
COMMENT ON    COLUMN    CPIMPORTACAO.CODPLANOPAG IS 'Cdigo do plano de pagamento acordado no invoice.';
COMMENT ON    COLUMN    CPIMPORTACAO.CODEMPFR IS 'Cdigo da empresa do fornecedor.';
COMMENT ON    COLUMN    CPIMPORTACAO.CODFILIALFR IS 'Cdigo da filial do fornecedor.';
COMMENT ON    COLUMN    CPIMPORTACAO.CODFOR IS 'Cdigo do fornecedor na importao.';
COMMENT ON    COLUMN    CPIMPORTACAO.TIPOIMP IS 'Tipo de importao - O = Original / C = Complementar';
COMMENT ON    COLUMN    CPIMPORTACAO.INVOICE IS 'Identificao do invoice (pedido de compra de importao)';
COMMENT ON    COLUMN    CPIMPORTACAO.DI IS 'Nmero da declarao de importao .';
COMMENT ON    COLUMN    CPIMPORTACAO.MANIFESTO IS 'Identificao do manifesto de carga.';
COMMENT ON    COLUMN    CPIMPORTACAO.CERTORIGEM IS 'Certificado de origem da mercadoria.';
COMMENT ON    COLUMN    CPIMPORTACAO.LACRE IS 'Identificao do lacre';
COMMENT ON    COLUMN    CPIMPORTACAO.PRESCARGA IS 'Presena de carga';
COMMENT ON    COLUMN    CPIMPORTACAO.IDENTHOUSE IS 'Identificao House B/L';
COMMENT ON    COLUMN    CPIMPORTACAO.CONHECCARGA IS 'Identificao do conhecimento de carga.';
COMMENT ON    COLUMN    CPIMPORTACAO.IDENTCONTAINER IS 'Identificao do container';
COMMENT ON    COLUMN    CPIMPORTACAO.TIPOMANIFESTO IS 'Tipo de manifesto.';
COMMENT ON    COLUMN    CPIMPORTACAO.DTIMP IS 'Data da importao';
COMMENT ON    COLUMN    CPIMPORTACAO.DTEMB IS 'Data de embarque.';
COMMENT ON    COLUMN    CPIMPORTACAO.DTCHEGADA IS 'Data de chegada';
COMMENT ON    COLUMN    CPIMPORTACAO.DTDESEMBDI IS 'Data do desembarao da declarao de importao';
COMMENT ON    COLUMN    CPIMPORTACAO.DTREGDI IS 'Data de registro da declarao de importao.';
COMMENT ON    COLUMN    CPIMPORTACAO.LOCALEMB IS 'Local do desembarao da declarao de importao.';
COMMENT ON    COLUMN    CPIMPORTACAO.RECINTOADUANEIRO IS 'Recinto Aduaneiro';
COMMENT ON    COLUMN    CPIMPORTACAO.CODPAISDESEMBDI IS 'Cdigo do pas do desembarao da DI';
COMMENT ON    COLUMN    CPIMPORTACAO.SIGLAUFDESEMBDI IS 'Sigla da unidade da federao do desembarao da DI';
COMMENT ON    COLUMN    CPIMPORTACAO.LOCDESEMBDI IS ' Local de desembarao da DI.';
COMMENT ON    COLUMN    CPIMPORTACAO.OBS IS 'Observaes';
COMMENT ON    COLUMN    CPIMPORTACAO.VEICULO IS 'Identificao do veculo (ex.: Nome do navio)';
COMMENT ON    COLUMN    CPIMPORTACAO.PESOBRUTO IS 'Peso bruto total.';
COMMENT ON    COLUMN    CPIMPORTACAO.PESOLIQUIDO IS 'Peso lquido total';
COMMENT ON    COLUMN    CPIMPORTACAO.VLRFRETEMI IS 'Valor do frete na moeda de importao';
COMMENT ON    COLUMN    CPIMPORTACAO.VLRFRETE IS 'Valor do frete na moeda corrente.';
COMMENT ON    COLUMN    CPIMPORTACAO.VMLEMI IS 'Valor liquido sem o frete na moeda de importao.';
COMMENT ON    COLUMN    CPIMPORTACAO.VMLDMI IS 'Valor liquido mais o frete na moeda de importao.';
COMMENT ON    COLUMN    CPIMPORTACAO.VMLE IS 'Valor liquido sem o frete na moeda corrente.';
COMMENT ON    COLUMN    CPIMPORTACAO.VMLD IS 'Valor liquido mais o frete na moeda corrente.';
COMMENT ON    COLUMN    CPIMPORTACAO.VLRSEGUROMI IS 'Valor do seguro na moeda de importao.';
COMMENT ON    COLUMN    CPIMPORTACAO.VLRSEGURO IS 'Valor do seguro na moeda corrente.';
COMMENT ON    COLUMN    CPIMPORTACAO.VLRII IS 'Valor do imposto de importao.';
COMMENT ON    COLUMN    CPIMPORTACAO.VLRIPI IS 'Valor do  IPI';
COMMENT ON    COLUMN    CPIMPORTACAO.VLRPIS IS 'Valor do PIS';
COMMENT ON    COLUMN    CPIMPORTACAO.VLRCOFINS IS 'Valor do cofins';
COMMENT ON    COLUMN    CPIMPORTACAO.VLRDIREITOSAD IS 'Valor de direitos antidumping.';
COMMENT ON    COLUMN    CPIMPORTACAO.VLRTHC IS 'Valor da taxa de manuteno no terminal (Terminal Handling Charges)';
COMMENT ON    COLUMN    CPIMPORTACAO.VLRTHCMI IS 'Valor do THC em moeda de importao';
COMMENT ON    COLUMN    CPIMPORTACAO.VLRTXSISCOMEX IS 'Valor da taxa siscomex.';
COMMENT ON    COLUMN    CPIMPORTACAO.VLRAD IS 'Valor aduaneiro valor da mercadoria + frete +seguro +thc
';
COMMENT ON    COLUMN    CPIMPORTACAO.VLRADMI IS 'Valor aduaneiro em moeda de importao
';
COMMENT ON    COLUMN    CPIMPORTACAO.VLRBASEICMS IS 'Base de calculo do icms
';
COMMENT ON    COLUMN    CPIMPORTACAO.VLRCOMPL IS 'Valor para nota fiscal complementar';
COMMENT ON    COLUMN    CPIMPORTACAO.EMMANUT IS 'Flag que indica se a tabela est em manuteno (S/N).';
COMMENT ON    COLUMN    CPIMPORTACAO.DTINS IS 'Data de insero do registro.';
COMMENT ON    COLUMN    CPIMPORTACAO.HINS IS 'Hora de insero do registro.';
COMMENT ON    COLUMN    CPIMPORTACAO.IDUSUINS IS 'Identificao do usurio que inseriu o registro';
COMMENT ON    COLUMN    CPIMPORTACAO.DTALT IS 'Data de alterao do registro';
COMMENT ON    COLUMN    CPIMPORTACAO.HALT IS 'Hora de alterao do registro.';
COMMENT ON    COLUMN    CPIMPORTACAO.IDUSUALT IS 'Identificao do usurio que alterou o registro.';
COMMENT ON TABLE        CPIMPORTACAOADIC IS 'Tabela de adies da importao.';
COMMENT ON    COLUMN    CPIMPORTACAOADIC.CODEMP IS 'Cdigo da empresa';
COMMENT ON    COLUMN    CPIMPORTACAOADIC.CODFILIAL IS 'Cdigo da filial';
COMMENT ON    COLUMN    CPIMPORTACAOADIC.CODIMP IS 'Cdigo da importao';
COMMENT ON    COLUMN    CPIMPORTACAOADIC.CODNCM IS 'Cdigo da NCM';
COMMENT ON    COLUMN    CPIMPORTACAOADIC.CODADIC IS 'Cdigo da adicao';
COMMENT ON    COLUMN    CPIMPORTACAOADIC.VLRTXSISCOMEX IS 'Valor da taxa siscomex para a adico';
COMMENT ON    COLUMN    CPIMPORTACAOADIC.DTINS IS 'Data de insero do registro';
COMMENT ON    COLUMN    CPIMPORTACAOADIC.HINS IS 'Hora de insero do registro';
COMMENT ON    COLUMN    CPIMPORTACAOADIC.IDUSUINS IS 'Identificao do usurio de inseriu o registro';
COMMENT ON    COLUMN    CPIMPORTACAOADIC.DTALT IS 'Data da alterao do registro';
COMMENT ON    COLUMN    CPIMPORTACAOADIC.HALT IS 'Hora da alterao do registro';
COMMENT ON    COLUMN    CPIMPORTACAOADIC.IDUSUALT IS 'Identificao do usurio que alterou o registro';
COMMENT ON    COLUMN    CPITCOMPRA.CODEMPAX IS 'Cdigo da empresa na tabela de almoxarifados.';
COMMENT ON    COLUMN    CPITCOMPRA.CODFILIALAX IS 'Cdigo da filial na tabela de almoxarifados.';
COMMENT ON    COLUMN    CPITCOMPRA.CODALMOX IS 'Cdigo do almoxarifado.';
COMMENT ON    COLUMN    CPITCOMPRA.QTDITCOMPRACANC IS 'Quantidade cancelada';
COMMENT ON    COLUMN    CPITCOMPRA.VLRBASEFUNRURALITCOMPRA IS 'Valor para base de calculo da reteno do funrural.';
COMMENT ON    COLUMN    CPITCOMPRA.ALIQFUNRURALITCOMPRA IS 'Percentual de reteno do funrural no item de compra.';
COMMENT ON    COLUMN    CPITCOMPRA.VLRFUNRURALITCOMPRA IS 'Valor de reteno do funrural do item.';
COMMENT ON    COLUMN    CPITCOMPRA.CUSTOVDITCOMPRA IS 'Custo para formao de preos
';
COMMENT ON    COLUMN    CPITCOMPRA.CODEMPIF IS 'Codigo da empresa do item de classificao (regra no momento da insero)';
COMMENT ON    COLUMN    CPITCOMPRA.CODFILIALIF IS 'Codigo da filial do item de classificao (regra no momento da insero)';
COMMENT ON    COLUMN    CPITCOMPRA.CODFISC IS 'Codigo da classificao (regra no momento da insero)';
COMMENT ON    COLUMN    CPITCOMPRA.EMMANUT IS 'Flag que indica se a tabela est em manuteno.';
COMMENT ON    COLUMN    CPITCOMPRA.CODEMPNS IS 'Cdigo da empresa do nmero de srie';
COMMENT ON    COLUMN    CPITCOMPRA.CODFILIALNS IS 'Cdigo da filial do nmero de srie
';
COMMENT ON    COLUMN    CPITCOMPRA.NUMSERIETMP IS 'Campo para abrigar temporariamente o nmero de serie do produto (para uso do trigger quando produto for unitrio)
';
COMMENT ON    COLUMN    CPITCOMPRA.NADICAO IS 'Nmero da adicao (entrada de importao)';
COMMENT ON    COLUMN    CPITCOMPRA.SEQADIC IS 'Nmero sequencial do tem dentro da adio.';
COMMENT ON    COLUMN    CPITCOMPRA.DESCDI IS 'Valor do desconto do item da DI
';
COMMENT ON    COLUMN    CPITCOMPRA.APROVPRECO IS 'Indica se o preo da compra foi aprovado (veio de cotao anterior);';
COMMENT ON    COLUMN    CPITCOMPRA.EMITITCOMPRA IS 'Indica se o tem de compra j foi emitido em compra compra (processo de faturamento de pedidos de compra)';
COMMENT ON TABLE        CPITCOMPRASERIE IS 'Tabela de vinculo entre item de compra e seus respectivos numeros de serie.';
COMMENT ON TABLE        CPITIMPORTACAO IS 'Tabela de item de importao.';
COMMENT ON    COLUMN    CPITIMPORTACAO.CODEMP IS 'Cdigo da empresa.';
COMMENT ON    COLUMN    CPITIMPORTACAO.CODFILIAL IS 'Cdigo da filial.';
COMMENT ON    COLUMN    CPITIMPORTACAO.CODIMP IS 'Cdigo da importao.';
COMMENT ON    COLUMN    CPITIMPORTACAO.CODITIMP IS 'Cdigo do item de importao.';
COMMENT ON    COLUMN    CPITIMPORTACAO.CODEMPPD IS 'Cdigo da empresa do produto.';
COMMENT ON    COLUMN    CPITIMPORTACAO.CODFILIALPD IS 'Cdigo da filial do produto.';
COMMENT ON    COLUMN    CPITIMPORTACAO.CODPROD IS 'Cdigo do produto.';
COMMENT ON    COLUMN    CPITIMPORTACAO.REFPROD IS 'Referncia do produto.';
COMMENT ON    COLUMN    CPITIMPORTACAO.QTD IS 'Quantidade de itens.';
COMMENT ON    COLUMN    CPITIMPORTACAO.CODEMPUN IS 'Cdigo da empresa da unidade de medida.';
COMMENT ON    COLUMN    CPITIMPORTACAO.CODFILIALUN IS 'Cdigo da filial da unidade de medida.';
COMMENT ON    COLUMN    CPITIMPORTACAO.CODUNID IS 'Cdigo da unidade de medida
';
COMMENT ON    COLUMN    CPITIMPORTACAO.PESOLIQUIDO IS 'Peso liquido';
COMMENT ON    COLUMN    CPITIMPORTACAO.PESOBRUTO IS 'Peso bruto';
COMMENT ON    COLUMN    CPITIMPORTACAO.PRECOMI IS 'Preco na moeda de importao';
COMMENT ON    COLUMN    CPITIMPORTACAO.PRECO IS 'Preo na moeda corrente.';
COMMENT ON    COLUMN    CPITIMPORTACAO.VMLEMI IS 'Valor bruto da mercadoria na moeda de importao.';
COMMENT ON    COLUMN    CPITIMPORTACAO.VMLDMI IS 'Valor bruto da mercadoria + frete e seguro, na moeda de importao.';
COMMENT ON    COLUMN    CPITIMPORTACAO.VMLE IS 'Valor bruto da mercadoria na moeda corrente.';
COMMENT ON    COLUMN    CPITIMPORTACAO.VMLD IS 'Valor bruto da mercadoria + frete e seguro, na moeda corrente.';
COMMENT ON    COLUMN    CPITIMPORTACAO.VLRFRETEMI IS 'Valor do frete na moeda de importao.';
COMMENT ON    COLUMN    CPITIMPORTACAO.VLRFRETE IS 'Valor do frete na moeda corrente.';
COMMENT ON    COLUMN    CPITIMPORTACAO.VLRSEGUROMI IS 'Valor do seguro na moeda de importao.';
COMMENT ON    COLUMN    CPITIMPORTACAO.VLRSEGURO IS 'Valor do seguro na moeda corrente.';
COMMENT ON    COLUMN    CPITIMPORTACAO.VLRTHCMI IS 'Valor do THC na moeda de importao.';
COMMENT ON    COLUMN    CPITIMPORTACAO.VLRTHC IS 'Valor do THC';
COMMENT ON    COLUMN    CPITIMPORTACAO.VLRADMI IS 'Valor aduaneiro (Valor bruto+frete+seguro+thc) em moeda de importao.';
COMMENT ON    COLUMN    CPITIMPORTACAO.VLRAD IS 'Valor aduaneiro (Valor bruto+frete+seguro+thc) na moeda corrente.';
COMMENT ON    COLUMN    CPITIMPORTACAO.ALIQICMSIMP IS 'Aliquota do ICMS de importao.';
COMMENT ON    COLUMN    CPITIMPORTACAO.ALIQICMSUF IS 'Aliquota do ICMS da UF (Operao futura)';
COMMENT ON    COLUMN    CPITIMPORTACAO.PERCDIFERICMS IS 'Percentual do diferimento do ICMS.';
COMMENT ON    COLUMN    CPITIMPORTACAO.ALIQIPI IS 'Aliquota de IPI';
COMMENT ON    COLUMN    CPITIMPORTACAO.ALIQPIS IS 'Aliquota do PIS';
COMMENT ON    COLUMN    CPITIMPORTACAO.ALIQCOFINS IS 'Aliquota do cofins';
COMMENT ON    COLUMN    CPITIMPORTACAO.ALIQII IS 'Aliquota do imposto de importao.';
COMMENT ON    COLUMN    CPITIMPORTACAO.VLRII IS 'Valor do imposto de importao.';
COMMENT ON    COLUMN    CPITIMPORTACAO.VLRIPI IS 'Valor do IPI';
COMMENT ON    COLUMN    CPITIMPORTACAO.VLRPIS IS 'Valor do PIS';
COMMENT ON    COLUMN    CPITIMPORTACAO.VLRCOFINS IS 'Valor do cofins';
COMMENT ON    COLUMN    CPITIMPORTACAO.VLRBASEICMS IS 'Valor da base do ICMS.';
COMMENT ON    COLUMN    CPITIMPORTACAO.VLRICMS IS 'Valor do ICMS bruto';
COMMENT ON    COLUMN    CPITIMPORTACAO.VLRICMSDIFERIDO IS 'Valor do ICMS diferido';
COMMENT ON    COLUMN    CPITIMPORTACAO.VLRICMSDEVIDO IS 'Valor do ICMS devido';
COMMENT ON    COLUMN    CPITIMPORTACAO.VLRICMSCREDPRESUM IS 'Valor do crdito do ICMS presumido.';
COMMENT ON    COLUMN    CPITIMPORTACAO.VLRICMSRECOLHIMENTO IS 'Valor do ICMS a recolher.';
COMMENT ON    COLUMN    CPITIMPORTACAO.VLRTXSISCOMEX IS 'Valor da taxa siscomex rateada por tem.
';
COMMENT ON    COLUMN    CPITIMPORTACAO.VLRVMCV IS 'Valor bruto
';
COMMENT ON    COLUMN    CPITIMPORTACAO.CODEMPCF IS 'Cdigo da empresa do da classificao fiscal.';
COMMENT ON    COLUMN    CPITIMPORTACAO.CODFILIALCF IS 'Cdigo da filial da classificao fiscal.';
COMMENT ON    COLUMN    CPITIMPORTACAO.CODFISC IS 'Codigo da classificao fiscal.';
COMMENT ON    COLUMN    CPITIMPORTACAO.CODITFISC IS 'Cdigo do item de classificao fiscal.';
COMMENT ON    COLUMN    CPITIMPORTACAO.CODNCM IS 'Cdigo da NCM';
COMMENT ON    COLUMN    CPITIMPORTACAO.SEQADIC IS 'Sequencia do item na adio.
';
COMMENT ON    COLUMN    CPITIMPORTACAO.DTINS IS 'Data de insero do registro.';
COMMENT ON    COLUMN    CPITIMPORTACAO.HINS IS 'Hora da insero do registro.';
COMMENT ON    COLUMN    CPITIMPORTACAO.IDUSUINS IS 'Identificao do usurio que inseriu o registro.';
COMMENT ON    COLUMN    CPITIMPORTACAO.DTALT IS 'Data da alterao do registro.';
COMMENT ON    COLUMN    CPITIMPORTACAO.HALT IS 'Hora da alterao do registro.';
COMMENT ON    COLUMN    CPITIMPORTACAO.IDUSUALT IS 'Identificao do usurio que alterou o registro.';
COMMENT ON    COLUMN    CPITSOLICITACAO.CODEMP IS 'Cdigo da empresa';
COMMENT ON    COLUMN    CPITSOLICITACAO.CODFILIAL IS 'Cdigo da filial';
COMMENT ON    COLUMN    CPITSOLICITACAO.CODSOL IS 'Cdigo da solicitao';
COMMENT ON    COLUMN    CPITSOLICITACAO.CODITSOL IS 'Nmero sequencial do item';
COMMENT ON    COLUMN    CPITSOLICITACAO.CODEMPPD IS 'Cdigo da empresa para produtos';
COMMENT ON    COLUMN    CPITSOLICITACAO.CODFILIALPD IS 'Cdigo da filial para produtos';
COMMENT ON    COLUMN    CPITSOLICITACAO.CODPROD IS 'Cdigo do produto ou servio';
COMMENT ON    COLUMN    CPITSOLICITACAO.REFPROD IS 'Referncia do produto.';
COMMENT ON    COLUMN    CPITSOLICITACAO.QTDITSOL IS 'Quantidade solicitada';
COMMENT ON    COLUMN    CPITSOLICITACAO.QTDAPROVITSOL IS 'Quantidade aprovada';
COMMENT ON    COLUMN    CPITSOLICITACAO.IDUSUITSOL IS 'Id do usurio que solicitou';
COMMENT ON    COLUMN    CPITSOLICITACAO.DTITSOL IS 'Data da solicitao do item';
COMMENT ON    COLUMN    CPITSOLICITACAO.IDUSUAPROVITSOL IS 'Id do usurio que aprovou';
COMMENT ON    COLUMN    CPITSOLICITACAO.DTAPROVITSOL IS 'Data da aprovao do item';
COMMENT ON    COLUMN    CPITSOLICITACAO.SITAPROVITSOL IS 'Situao da aprovao do item:
PE - Pendente
AP - Aprovao parcial
AT - Aprovao total
NA - No aprovada';
COMMENT ON    COLUMN    CPITSOLICITACAO.SITCOMPITSOL IS 'Situao da compra:
PE - Pendente
CP - Compra parcial
CT - Compra total
';
COMMENT ON    COLUMN    CPITSOLICITACAO.SITITSOL IS 'Situao do item da solicitao:
PE - Pendente
FN - Solicitao finalizada
CA - Cancelada';
COMMENT ON    COLUMN    CPRATEIO.CODEMP IS 'Cdigo da empresa.';
COMMENT ON    COLUMN    CPRATEIO.CODFILIAL IS 'Cdigo da filial.';
COMMENT ON    COLUMN    CPRATEIO.CODCOMPRA IS 'Cdigo da compra.';
COMMENT ON    COLUMN    CPRATEIO.SEQRATEIO IS 'Nmero sequencial do rateio.';
COMMENT ON    COLUMN    CPRATEIO.CODEMPFN IS 'Cdigo da empresa na tabela FNPLANEJAMENTO';
COMMENT ON    COLUMN    CPRATEIO.CODFILIALFN IS 'Cdigo da filial na tabela FNPLANEJAMENTO.';
COMMENT ON    COLUMN    CPRATEIO.CODPLAN IS 'Cdigo do planejamento.';
COMMENT ON    COLUMN    CPRATEIO.CODEMPCC IS 'Cdigo da empresa na tabela FNCC.';
COMMENT ON    COLUMN    CPRATEIO.CODFILIALCC IS 'Cdigo da filial na tabela FNCC';
COMMENT ON    COLUMN    CPRATEIO.ANOCC IS 'Ano do centro de custo.';
COMMENT ON    COLUMN    CPRATEIO.CODCC IS 'Cdigo do centro de custo.';
COMMENT ON    COLUMN    CPRATEIO.PERCRATEIO IS 'Percentual de rateio.';
COMMENT ON    COLUMN    CPRATEIO.VLRRATEIO IS 'Valor do rateio.';
COMMENT ON    COLUMN    CPRATEIO.SITRATEIO IS 'Situao da conciliao do rateio:
N-Pendente
P-Parcial
T-Total';
COMMENT ON    COLUMN    CPRATEIO.DTINS IS 'Data de insero.';
COMMENT ON    COLUMN    CPRATEIO.HINS IS 'Hora de insero.';
COMMENT ON    COLUMN    CPRATEIO.IDUSUINS IS 'ID do usurio que inseriu.';
COMMENT ON    COLUMN    CPRATEIO.DTALT IS 'Data da ltima alterao.';
COMMENT ON    COLUMN    CPRATEIO.HALT IS 'Hora da ltima alterao.';
COMMENT ON    COLUMN    CPRATEIO.IDUSUALT IS 'ID do usurio que fez a ltima alterao.';
COMMENT ON    COLUMN    CPSOLICITACAO.CODEMP IS 'Cdigo da empresa';
COMMENT ON    COLUMN    CPSOLICITACAO.CODFILIAL IS 'Cdigo da filial';
COMMENT ON    COLUMN    CPSOLICITACAO.CODSOL IS 'Cdigo da solicitao';
COMMENT ON    COLUMN    CPSOLICITACAO.DTEMITSOL IS 'Data de emisso da solicitao';
COMMENT ON    COLUMN    CPSOLICITACAO.SITSOL IS 'PE - Pendente
CT - Em Cotao
EF - Finalizada
CA - Cancelada';
COMMENT ON    COLUMN    CPSOLICITACAO.ORIGSOL IS 'Origem da solicitao
RM - RMA
AX - ALMOXARIFE';
COMMENT ON    COLUMN    CPSOLICITACAO.MOTIVOSOL IS 'Motivo de cancelamento.';
COMMENT ON    COLUMN    CPSOLICITACAO.DTINS IS 'Data de insero';
COMMENT ON    COLUMN    CPSOLICITACAO.HINS IS 'Hora de insero';
COMMENT ON    COLUMN    CPSOLICITACAO.IDUSUINS IS 'ID do usurio que inseriu';
COMMENT ON    COLUMN    CPSOLICITACAO.DTALT IS 'Data da ltima alterao';
COMMENT ON    COLUMN    CPSOLICITACAO.HALT IS 'Hora da ltima alterao';
COMMENT ON    COLUMN    CPSOLICITACAO.IDUSUALT IS 'ID do usurio da ltima alterao';
COMMENT ON TABLE        CPTIPOFOR IS 'Tabela de tipos de fornecedores.';
COMMENT ON    COLUMN    CPTIPOFOR.RETENCAOINSS IS 'Indica se deve realizar a reteno do inss nos pagamentos (autonomo).';
COMMENT ON    COLUMN    CPTIPOFOR.PERCBASEINSS IS 'Percentual de base de calculo do INSS.';
COMMENT ON    COLUMN    CPTIPOFOR.RETENCAOOUTROS IS 'Indica se deve calcular outras retenes agregadas ao INSS ex.: SEST/SENAT';
COMMENT ON    COLUMN    CPTIPOFOR.PERCRETOUTROS IS 'Percentual de reteno de outros tributos agregados ao inss (SEST/SENAT)';
COMMENT ON    COLUMN    CPTIPOFOR.RETENCAOIRRF IS 'Indica se deve realizar a reteno do imposto de renda nos pagamentos (autonomo).';
COMMENT ON    COLUMN    CPTIPOFOR.PERCBASEIRRF IS 'Percentual de base de calculo do IRRF.';
COMMENT ON    COLUMN    CRCHAMADO.FATOGERADOR IS 'Identificao da ao que gerou o problema.';
COMMENT ON    COLUMN    CRCHAMADO.AMBIENTE IS 'Informaes sobre o ambiente onde ocorreu o fato;
';
COMMENT ON    COLUMN    CRCHAMADO.OBSCHAMADO IS 'Outras observaes sobre o chamado';
COMMENT ON    COLUMN    CRCHAMADO.PRIORIDADE IS 'Ordem de prioridade:
1 - Muito Alta
2 - Alta
3 - Media
4 - Baixa
5 - Muito Baixa';
COMMENT ON    COLUMN    CRCHAMADO.CODEMPTC IS 'Cdigo da empresa do tipo de chamado';
COMMENT ON    COLUMN    CRCHAMADO.CODFILIALTC IS 'Cdigo da filial do tipo de chamado';
COMMENT ON    COLUMN    CRCHAMADO.CODTPCHAMADO IS 'Cdigo do tipo de chamado.';
COMMENT ON    COLUMN    CRCHAMADO.STATUS IS 'Status do chamado:
PE - Pendente
AN - Em analise
EA - Em andamento
CA - Cancelado
CO - Concludo';
COMMENT ON    COLUMN    CRCHAMADO.DTCHAMADO IS 'Data de abertura do chamado.';
COMMENT ON    COLUMN    CRCHAMADO.DTPREVISAO IS 'Data de previso do encerramento.';
COMMENT ON    COLUMN    CRCHAMADO.QTDHORASPREVISAO IS 'Quantidade de horas prevista pra execuo do chamado.';
COMMENT ON    COLUMN    CRCHAMADO.DTCONCLUSAO IS 'Data de concluso do chamado';
COMMENT ON    COLUMN    CRCHAMADO.CODEMPAE IS 'Cdigo da empresa do atendente designado.';
COMMENT ON    COLUMN    CRCHAMADO.CODFILIALAE IS 'Codigo da filial do atendente designado.';
COMMENT ON    COLUMN    CRCHAMADO.CODATEND IS 'Cdigo do atendente designado.';
COMMENT ON    COLUMN    CRCHAMADO.CODEMPOS IS 'Cdigo da empresa do item de ordem de servio.';
COMMENT ON    COLUMN    CRCHAMADO.CODFILIALOS IS 'Cdigo da filial da ordem de servio.';
COMMENT ON    COLUMN    CRCHAMADO.TICKET IS 'Ticket da ordem de servio.';
COMMENT ON    COLUMN    CRCHAMADO.CODITRECMERC IS 'Cdigo do tem de recebimento de mercadorias.';
COMMENT ON    COLUMN    CRCHAMADO.CODITOS IS 'Cdigo do tem da ordem de servio.';
COMMENT ON    COLUMN    CRCHAMADO.EMATENDIMENTO IS 'Indica se o chamado est sendo atendido neste momento.';
COMMENT ON    COLUMN    CRCHAMADO.CODEMPQL IS 'Cdigo da empresa da qualificao do chamado';
COMMENT ON    COLUMN    CRCHAMADO.CODFILIALQL IS 'Cdigo da filial da qualificao do chamado.
';
COMMENT ON    COLUMN    CRCHAMADO.CODQUALIFIC IS 'Cdigo da qualificao do atendimento.
';
COMMENT ON    COLUMN    CRCHAMADOANEXO.CODEMP IS 'Cdigo da empresa do anexo';
COMMENT ON    COLUMN    CRCHAMADOANEXO.CODFILIAL IS 'Cdigo da filial do anexo;';
COMMENT ON    COLUMN    CRCHAMADOANEXO.CODCHAMADO IS 'Cdiugo do chamado;';
COMMENT ON    COLUMN    CRCHAMADOANEXO.CODANEXO IS 'Cdigo do anexo;';
COMMENT ON    COLUMN    CRCHAMADOANEXO.DESCANEXO IS 'Descrio do anexo;';
COMMENT ON    COLUMN    CRCHAMADOANEXO.ANEXO IS 'Arquivo Binrio.
';
COMMENT ON    COLUMN    CRCHAMADOANEXO.DTINS IS 'Data de insero do registro no banco de dados;';
COMMENT ON    COLUMN    CRCHAMADOANEXO.HINS IS 'Hora de insero do registro no banco de dados';
COMMENT ON    COLUMN    CRCHAMADOANEXO.IDUSUINS IS 'Usurio que inseriu o registro no banco de dados;';
COMMENT ON    COLUMN    CRCHAMADOANEXO.DTALT IS 'Data de alterao do registro no banco de dados;';
COMMENT ON    COLUMN    CRCHAMADOANEXO.HALT IS 'Hora de alterao do registro no banco de dados;';
COMMENT ON    COLUMN    CRCHAMADOANEXO.IDUSUALT IS 'Usurio que alterou o registro no banco de dados;';
COMMENT ON TABLE        CRQUALIFICACAO IS 'Tabela para qualificao de chamados/atendimentos.';
COMMENT ON    COLUMN    CRQUALIFICACAO.CODEMP IS 'Cdigo da empresa.';
COMMENT ON    COLUMN    CRQUALIFICACAO.CODFILIAL IS 'Cdigo da filial';
COMMENT ON    COLUMN    CRQUALIFICACAO.CODQUALIFIC IS 'Cdigo da qualificao';
COMMENT ON    COLUMN    CRQUALIFICACAO.DESCQUALIFIC IS 'Descrio da qualificao';
COMMENT ON    COLUMN    CRQUALIFICACAO.FINALIZA IS 'Indica se a qualificao finaliza o processo (chamado/atendimento)
"S" - Sim
"N" - No';
COMMENT ON    COLUMN    CRQUALIFICACAO.DTINS IS 'Data de insero do registro';
COMMENT ON    COLUMN    CRQUALIFICACAO.HINS IS 'Hora de insero do registro';
COMMENT ON    COLUMN    CRQUALIFICACAO.IDUSUINS IS 'Identificao do usurio que inseriu o registro';
COMMENT ON    COLUMN    CRQUALIFICACAO.DTALT IS 'Data de altereo do registro';
COMMENT ON    COLUMN    CRQUALIFICACAO.HALT IS 'Hora de alterao do registro';
COMMENT ON    COLUMN    CRQUALIFICACAO.IDUSUALT IS 'Identificao do usurio que alterou o registro';
COMMENT ON TABLE        EQALMOX IS 'Tabela de almoxarifados.';
COMMENT ON TABLE        EQALMOXFILIAL IS 'Amarrao Almoxarifado x Filiais.';
COMMENT ON    COLUMN    EQALMOXFILIAL.CODEMP IS 'Cdigo da empresa na tabela EQALMOX.';
COMMENT ON    COLUMN    EQALMOXFILIAL.CODFILIAL IS 'Cdigo da filial na tabela EQALMOX.';
COMMENT ON    COLUMN    EQALMOXFILIAL.CODALMOX IS 'Cdigo do almoxarifado.';
COMMENT ON    COLUMN    EQALMOXFILIAL.CODEMPAF IS 'Cdigo da empresa na tabela SGFILIAL.';
COMMENT ON    COLUMN    EQALMOXFILIAL.CODFILIALAF IS 'Cdigo da filial na tabela SGFILIAL.';
COMMENT ON    COLUMN    EQALMOXFILIAL.BAIXAESTOQAF IS 'Flag que indica se  possvel baixar o estoque dessa filial.';
COMMENT ON TABLE        EQCLIFOR IS 'Amarrao Cliente x Fornecedor.';
COMMENT ON TABLE        EQCODALTPROD IS 'Tabela de cdigos alternativos para produtos.';
COMMENT ON    COLUMN    EQFATCONV.TIPOCONV IS 'Indica o tipo de converso:
"U" - Apenas converte a unidade no mesmo produto;
"P" - Executa processo de converso de produtos atravs de estrutura;';
COMMENT ON    COLUMN    EQFATCONV.CPFATCONV IS 'Flag que indica se a unidade  preferencial para compras.';
COMMENT ON    COLUMN    EQFATCONV.CODPRODET IS 'Cdigo do produto da estrutura de converso.';
COMMENT ON    COLUMN    EQGRUPO.ESTNEGGRUP IS 'Flag para permitir o estoque negativo de produtos.';
COMMENT ON    COLUMN    EQGRUPO.ESTLOTNEGGRUP IS 'Flag que define se permite estoque negativo de lotes.';
COMMENT ON    COLUMN    EQINVPROD.OBSINVP IS 'Observaes relativas ao inventrio, como motivo, justificativa, etc.';
COMMENT ON TABLE        EQITRECMERC IS 'Mdia entre as amostragens.';
COMMENT ON    COLUMN    EQITRECMERC.DESCITRECMERC IS 'Descrio detalhada do item recebido.';
COMMENT ON    COLUMN    EQITRECMERC.NUMSERIE IS 'Nmero de srie.
';
COMMENT ON    COLUMN    EQITRECMERC.GARANTIA IS 'Indica se o produto recebido est na garantia - (S/N)';
COMMENT ON    COLUMN    EQITRECMERC.REFPROD IS 'Referncia do produto
';
COMMENT ON    COLUMN    EQITRECMERC.CODEMPTP IS 'Cdigo da empresa do processo de recebimento.';
COMMENT ON    COLUMN    EQITRECMERC.CODFILIALTP IS 'Cdigo da filial do processo de recebimento.';
COMMENT ON    COLUMN    EQITRECMERC.CODTIPORECMERC IS 'Cdigo do tipo de recebimento de mercadorial.';
COMMENT ON    COLUMN    EQITRECMERC.CODPROCRECMERC IS 'Cdigo do processo de recepo de mercadoria.';
COMMENT ON    COLUMN    EQITRECMERC.MEDIAAMOSTRAGEM IS '0';
COMMENT ON    COLUMN    EQITRECMERC.RENDAAMOSTRAGEM IS 'Renda amostragem *';
COMMENT ON    COLUMN    EQITRECMERC.QTDITRECMERC IS 'Quantidade de itens recebidos (Coleta)
';
COMMENT ON    COLUMN    EQITRECMERC.STATUSITRECMERC IS 'Status do processo de recebimento.
PE - Pendente;
AN - Em analise;
EA - Em andamento;
FN - Finalizado;';
COMMENT ON    COLUMN    EQITRECMERC.DEFEITOITRECMERC IS 'Indica o defeito reclamado do item recebido para concerto.
';
COMMENT ON    COLUMN    EQITRECMERC.CONDICOESITRECMERC IS 'Campo para informar as condicoes do item para concerto no momento da recepcao.
';
COMMENT ON    COLUMN    EQITRECMERC.SERVICOSOLICITRECMERC IS 'Campo para informar o servio solicitado pelo cliente no item recebido.
';
COMMENT ON    COLUMN    EQITRECMERC.OBSITRECMERC IS 'Campo para informar os acessrios que acompanham o item recebido.';
COMMENT ON TABLE        EQITRECMERCITCP IS 'Tabela de vinculo entre tens de recebimento de mercadoria e itens de compra.';
COMMENT ON TABLE        EQITRECMERCITOS IS 'Tabela para lanamento de componentes e servios utilizando em ordem de produo /eqitrecmerc.';
COMMENT ON    COLUMN    EQITRECMERCITOS.CODITOS IS 'Cdigo sequencial do item de ordem de servio.
';
COMMENT ON    COLUMN    EQITRECMERCITOS.QTDITOS IS 'Quantidade de produtos ou servicos';
COMMENT ON    COLUMN    EQITRECMERCITOS.STATUSITOS IS '"PE" - Item pendente / previsto / Orado
"EC" - Encaminhado / Chamado aberto / RMA aberta
"EA" - Em andamento
"CO" - Item Concludo;';
COMMENT ON    COLUMN    EQITRECMERCITOS.GERARMA IS 'Indica se deve gerar RMA para o tem de O.S.';
COMMENT ON    COLUMN    EQITRECMERCITOS.GERACHAMADO IS 'Indica se deve gerar chamado para esse item.';
COMMENT ON    COLUMN    EQITRECMERCITOS.GERANOVO IS 'Indica se o item de OS  um produto novo para substituio, 
ao com defeito;';
COMMENT ON    COLUMN    EQITRECMERCITOSITORC.STATUS IS 'Coluna de status para repasse via triggers  tabela de ordem de sevio na atualizao do status do oramento.
(Vide status da ordem de sevio).';
COMMENT ON TABLE        EQITRECMERCSERIE IS 'Tabela de vinculo entre item de recebimento de mercadoria e seus respectivos numeros de serie."';
COMMENT ON TABLE        EQITRMA IS 'tens de RMA.';
COMMENT ON    COLUMN    EQITRMA.CODEMPAX IS 'Cdigo da empresa na tabela de almoxarifados.';
COMMENT ON    COLUMN    EQITRMA.CODFILIALAX IS 'Cdigo da filail na tabela de almoxarifados.';
COMMENT ON    COLUMN    EQITRMA.CODALMOX IS 'Cdigo do almoxarifado.';
COMMENT ON    COLUMN    EQITRMA.DTAPROVITRMA IS 'Data da aprovao do item.';
COMMENT ON    COLUMN    EQITRMA.SITITRMA IS 'Situao geral do item de rma:
PE - Pendente 
EA - Em andamento
AF - Aprovao finalizada
EF - Expedio finalizada
CA - Cancelado 
';
COMMENT ON    COLUMN    EQITRMA.SITAPROVITRMA IS 'Situao da aprovao do item:
"PE" - Aprovao pendente
"AP" - Aprovao parcial
"AT" - Aprovao total
"NA" - No aprovado';
COMMENT ON    COLUMN    EQITRMA.SITEXPITRMA IS 'Situao da expedio do item:
"PE" - Expedio pendente
"EP" - Expedio parcial
"ET" - Expedio total
"NE" - No expedida';
COMMENT ON    COLUMN    EQITRMA.MOTIVOCANCITRMA IS 'Motivo do cancelamento do tem de rma.';
COMMENT ON    COLUMN    EQITRMA.PRIORITRMA IS 'Prioridade da RMA.
(B-Baixa, M-Media, A-Alta).
';
COMMENT ON    COLUMN    EQITRMA.MOTIVOPRIORITRMA IS 'Motivo de prioridade para item de RMA.
';
COMMENT ON    COLUMN    EQITRMA.CODEMPOS IS 'Cdigo da empresa da ordem de servio vinculada.';
COMMENT ON    COLUMN    EQITRMA.CODFILIALOS IS 'Cdigo da filial da ordem de servio vinculada.';
COMMENT ON    COLUMN    EQITRMA.TICKET IS 'Ticket da ordem de servio vinculada.';
COMMENT ON    COLUMN    EQITRMA.CODITRECMERC IS 'Item de recebimento da ordem de servio vinculada';
COMMENT ON    COLUMN    EQITRMA.CODITOS IS 'Item de suplemento da ordem de servio vinculada.';
COMMENT ON    COLUMN    EQLOTE.QTDPRODLOTE IS 'Quantidade de produtos no lote (nfe - medicamentos)';
COMMENT ON    COLUMN    EQLOTE.DIASAVISOLOTE IS 'Indica quantos dias antes do vencimento do lote deve emitir aviso.';
COMMENT ON TABLE        EQMODLOTE IS 'Tabela de modelos de lotes, para gerao automatica de lotes a partir da Ordem de produo.';
COMMENT ON    COLUMN    EQMODLOTE.CODEMP IS 'Cdigo da empresa do modelo de lote.';
COMMENT ON    COLUMN    EQMODLOTE.CODFILIAL IS 'Filial do modelo de lote.';
COMMENT ON    COLUMN    EQMODLOTE.CODMODLOTE IS 'Cdigo do modelo de lote.';
COMMENT ON    COLUMN    EQMODLOTE.DESCMODLOTE IS 'Descrio do modelo de lote.';
COMMENT ON    COLUMN    EQMOVPROD.CODEMPAX IS 'Cdigo da empresa na tabela de almoxarifados.';
COMMENT ON    COLUMN    EQMOVPROD.CODFILIALAX IS 'Cdigo da filial na tabela de almoxarifados.';
COMMENT ON    COLUMN    EQMOVPROD.CODALMOX IS 'Cdigo do almoxarifado.';
COMMENT ON    COLUMN    EQMOVPROD.CODEMPOP IS 'Cdigo da empresa da ordem de produo.';
COMMENT ON    COLUMN    EQMOVPROD.CODFILIALOP IS 'Codigo da filial da Ordem de produo.';
COMMENT ON    COLUMN    EQMOVPROD.CODOP IS 'Cdigo da Ordem de produo.';
COMMENT ON    COLUMN    EQMOVPROD.SEQOP IS 'Nmero sequencial da OP.';
COMMENT ON    COLUMN    EQMOVPROD.SEQENTOP IS 'Sequencial de entrada da ordem de produo ';
COMMENT ON    COLUMN    EQMOVPROD.SEQSUBPROD IS 'Sequencial de subproduto.
';
COMMENT ON TABLE        EQMOVSERIE IS 'Tabela de controle de movimentaes de nemeros de srie de produtos.';
COMMENT ON    COLUMN    EQMOVSERIE.CODMOVSERIE IS 'Cdigo da movimentao da srie do produto.';
COMMENT ON    COLUMN    EQMOVSERIE.CODPROD IS 'Cdigo do produto.';
COMMENT ON    COLUMN    EQMOVSERIE.NUMSERIE IS 'Nmero de srie.';
COMMENT ON    COLUMN    EQMOVSERIE.CODVENDA IS 'Cdigo da venda';
COMMENT ON    COLUMN    EQMOVSERIE.CODCOMPRA IS 'Cdigo da compra.';
COMMENT ON    COLUMN    EQMOVSERIE.CODINVPROD IS 'Cdigo do inventrio.';
COMMENT ON    COLUMN    EQMOVSERIE.DTMOVSERIE IS 'Data da movimentao.';
COMMENT ON    COLUMN    EQMOVSERIE.TIPOMOVSERIE IS 'Quantidade movimentada:
1 - Entrada em estoque;
0 - Sem movimentao de estoque;
-1 - Sada de estoque;';
COMMENT ON    COLUMN    EQMOVSERIE.CODLOTE IS 'Cdigo do lote do produto.
';
COMMENT ON    COLUMN    EQMOVSERIE.CODEMPLE IS 'Cdigo da empresa do lote.
';
COMMENT ON    COLUMN    EQMOVSERIE.CODFILIALLE IS 'Codigo da filial do lote.
';
COMMENT ON    COLUMN    EQMOVSERIE.CODALMOX IS 'Cdigo do almoxarifado.';
COMMENT ON    COLUMN    EQMOVSERIE.CODEMPAX IS 'Cdigo da empresa do almoxarifado.';
COMMENT ON    COLUMN    EQMOVSERIE.CODFILIALAX IS 'Cdigo da filial do almoxarifado.';
COMMENT ON    COLUMN    EQMOVSERIE.CODEMPRC IS 'Cdigo da empresa do recebimento de mercadoria.';
COMMENT ON    COLUMN    EQMOVSERIE.CODFILIALRC IS 'Cdigo da filial do recebimento de mercadoria.
';
COMMENT ON    COLUMN    EQMOVSERIE.TICKET IS 'Cdigo do recebimento de mercadoria.';
COMMENT ON    COLUMN    EQMOVSERIE.CODITRECMERC IS 'Cdigo do tem de recebimento de mercadoria.';
COMMENT ON    COLUMN    EQPROCRECMERC.TIPOPROCRECMERC IS 'PI - Pesagem inicial
TR - Descarregamento/tiragem de renda
PF - Pesagem final';
COMMENT ON    COLUMN    EQPROCRECMERC.NROAMOSTPROCRECMERC IS 'Indica o numero de amostras necessrias para finalizar o processo.';
COMMENT ON TABLE        EQPRODACESSO IS 'Tabela de controle de acesso do produto para RMA, PDV e outras implementaes futuras.';
COMMENT ON    COLUMN    EQPRODACESSO.CODEMP IS 'Cdigo da empresa.';
COMMENT ON    COLUMN    EQPRODACESSO.CODFILIAL IS 'Cdigo da filial.';
COMMENT ON    COLUMN    EQPRODACESSO.CODPROD IS 'Cdigo do produto.';
COMMENT ON    COLUMN    EQPRODACESSO.TIPOPA IS 'Tipo do acesso (RMA, PDV).
';
COMMENT ON    COLUMN    EQPRODACESSO.CODPA IS 'Cdigo do acesso.';
COMMENT ON    COLUMN    EQPRODACESSO.CODEMPCC IS 'Cdigo da empresa na tabela de centro de custos.';
COMMENT ON    COLUMN    EQPRODACESSO.CODFILIALCC IS 'Cdigo da filial na tabela de centro de custos.';
COMMENT ON    COLUMN    EQPRODACESSO.ANOCC IS 'Ano do centro de custo.';
COMMENT ON    COLUMN    EQPRODACESSO.CODCC IS 'Cdigo do centro de custo.';
COMMENT ON    COLUMN    EQPRODACESSO.CODEMPCX IS 'Cdigo da empresa na tabela de caixa ECF.';
COMMENT ON    COLUMN    EQPRODACESSO.CODFILIALCX IS 'Cdigo da filial na tabela de caixa ECF.';
COMMENT ON    COLUMN    EQPRODACESSO.CODCAIXA IS 'Cdigo do caixa ECF.';
COMMENT ON    COLUMN    EQPRODACESSO.DTINS IS 'Data de insero.';
COMMENT ON    COLUMN    EQPRODACESSO.HINS IS 'Horrio de insero.';
COMMENT ON    COLUMN    EQPRODACESSO.IDUSUINS IS 'ID. do usurio que inseriu o registro.';
COMMENT ON    COLUMN    EQPRODACESSO.DTALT IS 'Data da ltima alterao.';
COMMENT ON    COLUMN    EQPRODACESSO.HALT IS 'Hora da ltima alterao.';
COMMENT ON    COLUMN    EQPRODACESSO.IDUSUALT IS 'ID. do usurio que fez a ltima alterao.';
COMMENT ON TABLE        EQPRODPLAN IS 'Tabela de vnculo produto x planejamento, para uso nos rateios.';
COMMENT ON    COLUMN    EQPRODPLAN.CODEMP IS 'Cdigo da empresa na tabela EQPRODUTO';
COMMENT ON    COLUMN    EQPRODPLAN.CODFILIAL IS 'Cdigo da filial na tabela EQPRODUTO';
COMMENT ON    COLUMN    EQPRODPLAN.CODPROD IS 'Cdigo do produto.';
COMMENT ON    COLUMN    EQPRODPLAN.SEQPP IS 'Nmero sequencial.';
COMMENT ON    COLUMN    EQPRODPLAN.TIPOPP IS 'Tipo (R-Receita / D-Despesa).';
COMMENT ON    COLUMN    EQPRODPLAN.CODEMPPN IS 'Cdigo da empresa na tabela EQPLANEJAMENTO.';
COMMENT ON    COLUMN    EQPRODPLAN.CODFILIALPN IS 'Cdigo da filial na tabela EQPLANEJAMENTO.';
COMMENT ON    COLUMN    EQPRODPLAN.CODPLAN IS 'Cdigo do planejamento.';
COMMENT ON    COLUMN    EQPRODPLAN.CODEMPCC IS 'Cdigo da empresa na tabela FNCC.';
COMMENT ON    COLUMN    EQPRODPLAN.CODFILIALCC IS 'Cdigo da filial na tabela FNCC.';
COMMENT ON    COLUMN    EQPRODPLAN.ANOCC IS 'Ano do centro de custo.';
COMMENT ON    COLUMN    EQPRODPLAN.CODCC IS 'Cdigo do centro de custo.';
COMMENT ON    COLUMN    EQPRODPLAN.PERCPP IS 'Percentual de rateio.';
COMMENT ON    COLUMN    EQPRODPLAN.DTINS IS 'Data de insero.';
COMMENT ON    COLUMN    EQPRODPLAN.HINS IS 'Hora de insero.';
COMMENT ON    COLUMN    EQPRODPLAN.IDUSUINS IS 'ID do usurio que inseriu.';
COMMENT ON    COLUMN    EQPRODPLAN.DTALT IS 'Data da ltima alterao.';
COMMENT ON    COLUMN    EQPRODPLAN.HALT IS 'Hora da ltima alterao.';
COMMENT ON    COLUMN    EQPRODPLAN.IDUSUALT IS 'Id do usurio da ltima alterao.';
COMMENT ON    COLUMN    EQPRODUTO.TIPOPROD IS 'Tipo de produto (campo "fluxo" do cadastro de produtos)
P  - Mercadoria p/revenda
S  - Servio
E  - Equipamento
F  - Produto acabado
M  - Matria prima
O  - Ativo imobilizado
C  - Material de Consumo
02 - Embalagem
03 - Em processo
05 - SubProduto
06 - Produto Intermedirio
10 - Outros insumos
99 - Outros';
COMMENT ON    COLUMN    EQPRODUTO.CVPROD IS 'Indica se o produto e de compra ou venda:
V - Venda
C - Compra
A - Ambos';
COMMENT ON    COLUMN    EQPRODUTO.CLOTEPROD IS 'Indica se o produto  controlado em lotes.';
COMMENT ON    COLUMN    EQPRODUTO.SERIEPROD IS 'Indica se ser exigido o nmero de srie para o produto.';
COMMENT ON    COLUMN    EQPRODUTO.CUSTOINFOPROD IS 'Custo informado do produto. Pode incluir os custos de aquisio, tributos, e rateio de custos fixo.';
COMMENT ON    COLUMN    EQPRODUTO.PRECOBASEPROD IS 'Preo base do produto (primeiro preo de venda) base para gerao de outras tabelas de preo.';
COMMENT ON    COLUMN    EQPRODUTO.PRECOCOMISPROD IS 'Preo base do produto para clculo de comisses especiais.';
COMMENT ON    COLUMN    EQPRODUTO.VERIFPROD IS '"S" - Exige senha para venda abaixo de custo deste produto
"N" - Bloqueado (depende de parametro nas preferencias)
"L" - Liberado sem senha para o produto.';
COMMENT ON    COLUMN    EQPRODUTO.LOCALPROD IS 'Local de armazenamento do produto (Prateleira)
';
COMMENT ON    COLUMN    EQPRODUTO.RMAPROD IS 'Flag que indica se podem ser feitas RMAs do produto.';
COMMENT ON    COLUMN    EQPRODUTO.CODEMPPE IS 'Cdigo da empresa do prazo de entrega padro.';
COMMENT ON    COLUMN    EQPRODUTO.CODFILIALPE IS 'Cdigo da filial do prazo de entrega padro.';
COMMENT ON    COLUMN    EQPRODUTO.CODPE IS 'Cdigo do prazo de entrega.';
COMMENT ON    COLUMN    EQPRODUTO.USARECEITAPROD IS 'Flag indicando se o produto nescessita de receita.';
COMMENT ON    COLUMN    EQPRODUTO.USATELAADICPDV IS 'Flag indicando se o produto abre uma tela para informaes adicionais na venda do PDV';
COMMENT ON    COLUMN    EQPRODUTO.VLRDENSIDADE IS 'Valor da densidade';
COMMENT ON    COLUMN    EQPRODUTO.VLRCONCENT IS 'Valor da concentrao.';
COMMENT ON    COLUMN    EQPRODUTO.COMPRIMENTO IS 'Comprimento do produto em cm.';
COMMENT ON    COLUMN    EQPRODUTO.LARGURA IS 'Largura do produto em cm.';
COMMENT ON    COLUMN    EQPRODUTO.ESPESSURA IS 'Espessura do produto em cm.';
COMMENT ON    COLUMN    EQPRODUTO.QTDEMBALAGEM IS 'Quantidade unitaria contida na embalagem.';
COMMENT ON    COLUMN    EQPRODUTO.CODEANPROD IS 'GTIN-8,GTIN-12,GTIN-13 ou GTIN-14';
COMMENT ON    COLUMN    EQPRODUTO.CODEMPSC IS 'Cdigo da empresa da seo de produo/estoque.';
COMMENT ON    COLUMN    EQPRODUTO.CODFILIALSC IS 'Cdigo da filial da seo de produo/estoque.';
COMMENT ON    COLUMN    EQPRODUTO.CODSECAO IS 'Cdigo da seco de produo/estoque.';
COMMENT ON    COLUMN    EQPRODUTO.CODEMPTC IS 'Cdigo da empresa do tipo de chamado vinculado ao servio (Integrao CRM/GMS)';
COMMENT ON    COLUMN    EQPRODUTO.CODFILIALTC IS 'Cdigo da filial do tipo de chamado vinculado ao servio (Integrao CRM/GMS)';
COMMENT ON    COLUMN    EQPRODUTO.CODTPCHAMADO IS 'Cdigo do tipo de chamado vinculado ao servio (Integrao CRM/GMS)';
COMMENT ON    COLUMN    EQPRODUTO.QTDHORASSERV IS 'Quantidade de horas padro para execuo do servio (Integraao CRM/GMS)';
COMMENT ON    COLUMN    EQPRODUTO.NRODIASVALID IS 'Nmero de dias para validade do produto.';
COMMENT ON    COLUMN    EQPRODUTO.DESCCLI IS 'Indica se deve aplicar o desconto padro do cliente.';
COMMENT ON    COLUMN    EQPRODUTO.QTDPORPLANO IS 'Indica a quantidade de produto acabado por plano da folha (industria grfica/etiquetas)';
COMMENT ON    COLUMN    EQPRODUTO.NROPLANOS IS 'Indica o nmero de planos por folha (industria grfica/etiquetas)';
COMMENT ON    COLUMN    EQPRODUTO.CERTFSC IS 'Indica se o produto participa da Certificao FSC.
Forest Stewardship Council (Conselho de Manejo Florestal).
"S" - Sim
"N" - No
';
COMMENT ON    COLUMN    EQPRODUTO.FATORFSC IS 'Fator para calculo dos relatrios FSC em folhas.
';
COMMENT ON    COLUMN    EQPRODUTOLOG.CODEMP IS 'Cdigo da empresa';
COMMENT ON    COLUMN    EQPRODUTOLOG.CODFILIAL IS 'Cdigo da filial';
COMMENT ON    COLUMN    EQPRODUTOLOG.CODPROD IS 'Cdigo do produto';
COMMENT ON    COLUMN    EQPRODUTOLOG.PRECOBASEPRODANT IS 'Preco base anterior.';
COMMENT ON    COLUMN    EQPRODUTOLOG.PRECOBASEPRODNOVO IS 'Novo preo base.';
COMMENT ON    COLUMN    EQPRODUTOLOG.SEQLOG IS 'Sequncia do log';
COMMENT ON    COLUMN    EQPRODUTOLOG.PRECOPROC IS 'Indica se o preo base j foi processado (tabelas de preo)';
COMMENT ON    COLUMN    EQPRODUTOLOG.DTINS IS 'Data de insero do registro';
COMMENT ON    COLUMN    EQPRODUTOLOG.HINS IS 'Hora de insero do registro';
COMMENT ON    COLUMN    EQPRODUTOLOG.IDUSUINS IS 'Usurio que inseriu o registro';
COMMENT ON    COLUMN    EQPRODUTOLOG.DTALT IS 'Data de alterao do registro';
COMMENT ON    COLUMN    EQPRODUTOLOG.HALT IS 'Hora de alterao do registro';
COMMENT ON    COLUMN    EQPRODUTOLOG.IDUSUALT IS 'Usurio que alterou o registro.';
COMMENT ON    COLUMN    EQRECAMOSTRAGEM.PESOAMOST IS 'Peso 1 (Pesagem comum)';
COMMENT ON    COLUMN    EQRECAMOSTRAGEM.PESOAMOST2 IS 'Peso 2 (Pesagem em balana hidrosttica)';
COMMENT ON    COLUMN    EQRECAMOSTRAGEM.SEQAMOSTRAGEM IS 'Nmero sequencia para controle das pesagens.';
COMMENT ON TABLE        EQRECMERC IS 'Tabela de registro de informaes do recebimento de cargas de mercadorias.';
COMMENT ON    COLUMN    EQRECMERC.TICKET IS 'Ticket de entrada do recebimento ou coleta.';
COMMENT ON    COLUMN    EQRECMERC.REFPROD IS 'Referncia do produto';
COMMENT ON    COLUMN    EQRECMERC.CODEMPTR IS 'Cdigo da empresa do tipo de recepo de mercadorias.';
COMMENT ON    COLUMN    EQRECMERC.CODFILIALTR IS 'Cdigo da filial to tipo de recepo de mercadorias.';
COMMENT ON    COLUMN    EQRECMERC.CODTIPORECMERC IS 'Cdigo do tipo de recepo de mercadorias.';
COMMENT ON    COLUMN    EQRECMERC.STATUS IS 'Status do recebimento da mercadoria.
PE - Pendente;
AN - Em anlise (OS)
EA - Em andamento (OS)
PT - Pronto (OS)
EO - Em oramento (entrada para concerto);
CA - Cancelada;
OA - Oramento aprovado (entrada para concerto);
E1 - Em andamento finalizada primeira etapa;
E2 - Em andamento finalizada segunda etapa;
FN - Finalizado;
PC - Pedido de compra emitido;
NE - Nota de entrada emitida;';
COMMENT ON    COLUMN    EQRECMERC.TIPOFRETE IS 'Tipo de frete:
Na compra:
C - CIF frete por conta sua conta.
F - FOB frete por conta do fornecedor.';
COMMENT ON    COLUMN    EQRECMERC.DTENT IS 'Data da entrada da coleta.';
COMMENT ON    COLUMN    EQRECMERC.DTPREVRET IS 'Data prevista para retorno da mercadoria (concerto)';
COMMENT ON    COLUMN    EQRECMERC.DOCRECMERC IS 'Nmero do documento (nota de entrada)';
COMMENT ON    COLUMN    EQRECMERC.CODEMPVD IS 'Cdigo da empresa do vendedor (coleta)';
COMMENT ON    COLUMN    EQRECMERC.CODFILIALVD IS 'Cdigo da filial do vendedor (coleta)';
COMMENT ON    COLUMN    EQRECMERC.CODVEND IS 'Cdigo do vendedor (coleta)';
COMMENT ON    COLUMN    EQRECMERC.CODEMPCL IS 'Cdigo da empresa do cliente (coleta)
';
COMMENT ON    COLUMN    EQRECMERC.CODFILIALCL IS 'Cdigo da filial do cliente (coleta)
';
COMMENT ON    COLUMN    EQRECMERC.CODCLI IS 'Cdigo do cliente (coleta)
';
COMMENT ON    COLUMN    EQRECMERC.SOLICITANTE IS 'Nome do solicitante do servio/entrega da mercadoria.';
COMMENT ON    COLUMN    EQRECMERC.MEDIAAMOSTRAGEM IS 'Media geral da amostragem.';
COMMENT ON    COLUMN    EQRECMERC.RENDAAMOSTRAGEM IS 'Renda media geral da amostragem';
COMMENT ON    COLUMN    EQRECMERC.CODEMPAX IS 'Cdigo da empresa do almoxarifado de descarregamento da mercadoria.';
COMMENT ON    COLUMN    EQRECMERC.CODFILIALAX IS 'Cdigo da filial do almoxarifado de descarregamento da mercadoria.';
COMMENT ON    COLUMN    EQRECMERC.CODALMOX IS 'Cdigo do almoxarifado de descarregamento da mercadoria.';
COMMENT ON    COLUMN    EQRECMERC.OBSRECMERC IS 'Observaes.
';
COMMENT ON    COLUMN    EQRECMERC.DESCONTO IS 'Percentual de desconto ao peso total do recebimento da mercadoria.
';
COMMENT ON    COLUMN    EQRMA.MOTIVORMA IS 'Motivo da solicitao.';
COMMENT ON    COLUMN    EQRMA.MOTIVOCANCRMA IS 'Motivo do cancelamento.';
COMMENT ON    COLUMN    EQRMA.SITRMA IS 'Situao geral da rma:
PE - Pendente (no foi realizado nenhum procedimento de aprovao, ou expedio)
EA - Em andamento
AF - Aprovao finalizada
EF - Expedio finalizada
CA - Cancelada (requisio foi cancelada)
';
COMMENT ON    COLUMN    EQRMA.DTAREQRMA IS 'Data da requisio.';
COMMENT ON    COLUMN    EQRMA.DTAEXPRMA IS 'Data da expedio da RMA.';
COMMENT ON    COLUMN    EQRMA.SITAPROVRMA IS 'Status da aprovao da RMA.
"PE" - Aprovao pendente.
"AP" - Aprovao parcial.
"AT" - Aprovao total.
"NA" - No aprovada.';
COMMENT ON    COLUMN    EQRMA.SITEXPRMA IS 'Status da expedio da RMA.
"PE" - Expedio pendente.
"EP" - Expedida parcial.
"ET" - Expedida total.
"NE" - No expedida.';
COMMENT ON    COLUMN    EQRMA.IDUSUAPROV IS 'ID do usurio que aprovou/aprovar a RMA.';
COMMENT ON    COLUMN    EQRMA.CODEMPUA IS 'Cdigo da empresa do usurio que aprovou/aprovar a RMA.';
COMMENT ON    COLUMN    EQRMA.CODFILIALUA IS 'Cdigo da filial do usurio que aprovou/aprovar a RMA.';
COMMENT ON    COLUMN    EQRMA.IDUSUEXP IS 'ID do usurio que expediu/expedir a RMA.';
COMMENT ON    COLUMN    EQRMA.CODEMPUE IS 'Cdigo da empresa do usurio que expediu/expedir a RMA.';
COMMENT ON    COLUMN    EQRMA.CODFILIALUE IS 'Cdigo da filial do usurio que expediu/expedir a RMA.';
COMMENT ON    COLUMN    EQRMA.DTAAPROVRMA IS 'Data da aprovao da RMA.';
COMMENT ON    COLUMN    EQRMA.CODEMPOF IS 'Cdigo da empresa a OP/Fase';
COMMENT ON    COLUMN    EQRMA.CODFILIALOF IS 'Cdigo da filial da OP X Fase';
COMMENT ON    COLUMN    EQRMA.CODOP IS 'Cdigo da ordem de produo.';
COMMENT ON    COLUMN    EQRMA.SEQOP IS 'Nmero sequencial da OP.';
COMMENT ON    COLUMN    EQRMA.SEQOF IS 'Sequencial da fase de produo.';
COMMENT ON    COLUMN    EQRMA.CODEMPCT IS 'Cdigo da empresa do contrato/projeto';
COMMENT ON    COLUMN    EQRMA.CODFILIALCT IS 'Cdigo da filial da empresa/contrato';
COMMENT ON    COLUMN    EQRMA.CODCONTR IS 'Cdigo do contrato/projeto';
COMMENT ON    COLUMN    EQRMA.CODITCONTR IS 'Cdigo do tem de contrato/projeto';
COMMENT ON    COLUMN    EQRMA.CODEMPOS IS 'Codigo da empresa da ordem de servio.';
COMMENT ON    COLUMN    EQRMA.CODFILIALOS IS 'Cdigo da filial da ordem de servio.';
COMMENT ON    COLUMN    EQRMA.TICKET IS 'Nmero do ticket da ordem de servio vinculada.';
COMMENT ON    COLUMN    EQRMA.CODITRECMERC IS 'Cdigo do tem de recebimento de mercadoria (Ordem de servio)';
COMMENT ON TABLE        EQSALDOLOTE IS 'Tabelas de saldos por lote e almoxarifado.';
COMMENT ON TABLE        EQSECAO IS 'Tabela de sees de produo/estoque.';
COMMENT ON TABLE        EQSERIE IS 'Tabela para controle de nmeros de srie de produtos.';
COMMENT ON    COLUMN    EQSERIE.DTFABRICSERIE IS 'Data de fabricao do produto';
COMMENT ON    COLUMN    EQSERIE.DTVALIDSERIE IS 'Data de validade do produto';
COMMENT ON    COLUMN    EQSERIE.OBSSERIE IS 'Observaes
';
COMMENT ON    COLUMN    EQTIPOMOV.ESTOQTIPOMOV IS 'Indica se o tipo de movimento movimenta estoque.';
COMMENT ON    COLUMN    EQTIPOMOV.IMPPEDTIPOMOV IS 'Flag que indica se imprime pedido.';
COMMENT ON    COLUMN    EQTIPOMOV.IMPNFTIPOMOV IS 'Flag que indica se imprime NF.';
COMMENT ON    COLUMN    EQTIPOMOV.IMPBOLTIPOMOV IS 'Flag que indica se imprime boleto.';
COMMENT ON    COLUMN    EQTIPOMOV.IMPRECTIPOMOV IS 'Flag que indica se imprime recibo no fechamento da venda.';
COMMENT ON    COLUMN    EQTIPOMOV.REIMPNFTIPOMOV IS 'Flag que indica se reimprime NF.';
COMMENT ON    COLUMN    EQTIPOMOV.TUSUTIPOMOV IS 'Flag que indica se todos os usurios podem utilizar o tipo de movimento.';
COMMENT ON    COLUMN    EQTIPOMOV.SOMAVDTIPOMOV IS 'Indica se as movimentaes geradas com esse tipo de movimento devem aparecer nos relatrios de venda.';
COMMENT ON    COLUMN    EQTIPOMOV.SEQNFTIPOMOV IS 'Flag que indica alocao do nmero da nota fiscal.
';
COMMENT ON    COLUMN    EQTIPOMOV.VLRMFINTIPOMOV IS 'Permite valor financeiro menor que total da nota.';
COMMENT ON    COLUMN    EQTIPOMOV.MCOMISTIPOMOV IS 'Indica se o sistema de comisses  com mltiplos comissionados.';
COMMENT ON    COLUMN    EQTIPOMOV.OPERTIPOMOV IS 'Operao:
"C" - Conjugada;
"P" - Produto;
"S" - Servio;
';
COMMENT ON    COLUMN    EQTIPOMOV.CTIPOFRETE IS 'flag de preferencia para o tipo de frete na venda com este tipo de movimento.';
COMMENT ON    COLUMN    EQTIPOMOV.CODEMPTN IS 'Cdigo da empresa da transportadora padro para o tipo de movimento.';
COMMENT ON    COLUMN    EQTIPOMOV.CODFILIALTN IS 'Cdigo da filial da transportadora padro para o tipo de movimento.';
COMMENT ON    COLUMN    EQTIPOMOV.CODTRAN IS 'Cdigo da transportadora padro para o tipo de movimento.';
COMMENT ON    COLUMN    EQTIPOMOV.EMITNFCPMOV IS 'Indica se a nota ser digitada ou emitida na entrada.';
COMMENT ON    COLUMN    EQTIPOMOV.CODEMPDF IS 'Codigo da empresa do modelo de documento fiscal.';
COMMENT ON    COLUMN    EQTIPOMOV.CODFILIALDF IS 'Codigo da filial do modelo de documento fiscal.';
COMMENT ON    COLUMN    EQTIPOMOV.CODMODDOCFISC IS 'Codigo do modelo do documento fiscal.';
COMMENT ON    COLUMN    EQTIPOMOV.CODEMPPP IS 'Cdigo da empresa para o plano de pagamento preferencial
';
COMMENT ON    COLUMN    EQTIPOMOV.CODFILIALPP IS 'Cdigo da filial para o plano de pagamento preferencial
';
COMMENT ON    COLUMN    EQTIPOMOV.CODPLANOPAG IS 'Cdigo do plano de pagamento preferencial
';
COMMENT ON TABLE        EQTIPOMOVUSU IS 'Tabela de vnculo de tipos de movimento com usurios.';
COMMENT ON    COLUMN    EQTIPOMOVUSU.CODEMP IS 'Cdigo da empresa na tabela de tipos de movimento.';
COMMENT ON    COLUMN    EQTIPOMOVUSU.CODFILIAL IS 'Cdigo da filial na tabela de tipos de movimento.';
COMMENT ON    COLUMN    EQTIPOMOVUSU.CODTIPOMOV IS 'Cdigo do tipo de movimento.';
COMMENT ON    COLUMN    EQTIPOMOVUSU.CODEMPUS IS 'Cdigo de empresa na tabela de usurios.';
COMMENT ON    COLUMN    EQTIPOMOVUSU.CODFILIALUS IS 'Cdigo da filial na tabela de usurios.';
COMMENT ON    COLUMN    EQTIPOMOVUSU.IDUSU IS 'ID do usurio.';
COMMENT ON TABLE        EQTIPORECMERC IS 'Tabela de tipos de recebimento de mercadorias.';
COMMENT ON    COLUMN    EQTIPORECMERC.TIPORECMERC IS 'Tipo de recepo de mercadoria:
"RP" - Recebimento com pesagem;
"CM" - Coleta de materiais;
';
COMMENT ON    COLUMN    EQTIPORECMERC.CODEMPTC IS 'Codigo da empresa do tipo de movimento para compra.';
COMMENT ON    COLUMN    EQTIPORECMERC.CODFILIALTC IS 'Codigo da filial para o tipo de movimento para compra.';
COMMENT ON    COLUMN    EQTIPORECMERC.CODTIPOMOVCP IS 'Codigo do tipo de movimento para compra.';
COMMENT ON    COLUMN    EQTIPORECMERC.CODEMPPD IS 'Cdigo da empresa do produto padro para recebimento de mercadorias.';
COMMENT ON    COLUMN    EQTIPORECMERC.CODFILIALPD IS 'Cdigo da filial do produto padro para recebimeno de mercadorias.';
COMMENT ON    COLUMN    EQTIPORECMERC.CODPROD IS 'Cdigo do produto padro para recebimento de mercadorias.';
COMMENT ON    COLUMN    EQUNIDADE.CASASDEC IS 'Nmero de casas decimais utilizadas para a unidade.';
COMMENT ON    COLUMN    EQUNIDADE.CALCVOLEMB IS 'Indica se deve calcular o numero de volumes baseado na quantidade por embalagem.';
COMMENT ON TABLE        FNBANCO IS 'Bancos.';
COMMENT ON    COLUMN    FNBANCO.DVBANCO IS 'Dgito verificador do banco.';
COMMENT ON    COLUMN    FNBANCO.LAYOUTCHEQBANCO IS 'Layout de impresso de cheques.';
COMMENT ON    COLUMN    FNBORDERO.STATUSBOR IS 'Status do bordero:
BA - Aberto
BC - Completo
BF - Finalizado';
COMMENT ON TABLE        FNCARTCOB IS 'Carteiras de cobrana.';
COMMENT ON    COLUMN    FNCARTCOB.CODEMPBO IS 'Cdigo da empresa na tabela FNBANCO.';
COMMENT ON    COLUMN    FNCARTCOB.CODFILIALBO IS 'Cdigo da filial na tabela FNBANCO.';
COMMENT ON    COLUMN    FNCARTCOB.CODBANCO IS 'Cdigo do banco.';
COMMENT ON    COLUMN    FNCARTCOB.CODEMP IS 'Cdigo da empresa.';
COMMENT ON    COLUMN    FNCARTCOB.CODFILIAL IS 'Cdigo da filial.';
COMMENT ON    COLUMN    FNCARTCOB.CODCARTCOB IS 'Cdigo da carteira de cobrana.';
COMMENT ON    COLUMN    FNCARTCOB.VARIACAOCARTCOB IS 'Variao da carteira de cobrana.';
COMMENT ON    COLUMN    FNCARTCOB.DESCCARTCOB IS 'Descrio da carteira de cobrana.';
COMMENT ON    COLUMN    FNCARTCOB.CARTCOBCNAB IS 'Carteira de cobrana para CNAB.';
COMMENT ON TABLE        FNCHEQUE IS 'Tabela de cheques.';
COMMENT ON    COLUMN    FNCHEQUE.CODEMP IS 'Cdigo da empresa';
COMMENT ON    COLUMN    FNCHEQUE.CODFILIAL IS 'Cdigo da filial';
COMMENT ON    COLUMN    FNCHEQUE.CODEMPBO IS 'Cdigo empresa na tabela banco.';
COMMENT ON    COLUMN    FNCHEQUE.SEQCHEQ IS 'Sequencia.';
COMMENT ON    COLUMN    FNCHEQUE.CODFILIALBO IS 'Cdigo da filial na tabela banco.';
COMMENT ON    COLUMN    FNCHEQUE.CODBANC IS 'Cdigo do banco.';
COMMENT ON    COLUMN    FNCHEQUE.AGENCIACHEQ IS 'Agncia.';
COMMENT ON    COLUMN    FNCHEQUE.CONTACHEQ IS 'Nmero da conta
';
COMMENT ON    COLUMN    FNCHEQUE.NUMCHEQ IS 'Nmero do cheque.';
COMMENT ON    COLUMN    FNCHEQUE.NOMEEMITCHEQ IS 'Nome do emitente.';
COMMENT ON    COLUMN    FNCHEQUE.NOMEFAVCHEQ IS 'Nome do favorecido.';
COMMENT ON    COLUMN    FNCHEQUE.DTEMITCHEQ IS 'Emisso';
COMMENT ON    COLUMN    FNCHEQUE.DTVENCTOCHEQ IS 'Data de vencimento.';
COMMENT ON    COLUMN    FNCHEQUE.DTCOMPCHEQ IS 'Data de compensao';
COMMENT ON    COLUMN    FNCHEQUE.TIPOCHEQ IS 'Tipo de cheque.
PF - Pagamento de fornecedor;
RC - Recebimento de cliente.';
COMMENT ON    COLUMN    FNCHEQUE.PREDATCHEQ IS 'Cheque pr-datado (S/N)
';
COMMENT ON    COLUMN    FNCHEQUE.SITCHEQ IS 'Situao do cheque.
CA - Cadastrado;
ED - Emitido;
CD - Compensado;
DV - Devolvido.
';
COMMENT ON    COLUMN    FNCHEQUE.VLRCHEQ IS 'Valor do cheque';
COMMENT ON    COLUMN    FNCHEQUE.HISTCHEQ IS 'Histrico.';
COMMENT ON    COLUMN    FNCHEQUE.DDDFAVCHEQ IS 'DDD do favorecido do cheque';
COMMENT ON    COLUMN    FNCHEQUE.DDDEMITCHEQ IS 'DDD Tel. emitente.
';
COMMENT ON    COLUMN    FNCHEQUE.FONEEMITCHEQ IS 'Telefone emitente.';
COMMENT ON    COLUMN    FNCHEQUE.FONEFAVCHEQ IS 'Telefone do favorecido';
COMMENT ON    COLUMN    FNCHEQUE.DTINS IS 'Data de insero.';
COMMENT ON    COLUMN    FNCHEQUE.HINS IS 'Hora de insero.';
COMMENT ON    COLUMN    FNCHEQUE.IDUSUINS IS 'Ident. do usurio que inseriu.';
COMMENT ON    COLUMN    FNCHEQUE.DTALT IS 'Data de alterao.
';
COMMENT ON    COLUMN    FNCHEQUE.HALT IS 'Hora de alterao.';
COMMENT ON    COLUMN    FNCHEQUE.IDUSUALT IS 'Ident. usurio que alterou.';
COMMENT ON    COLUMN    FNCONTA.TIPOCONTA IS 'Indica o tipo de conta:
"C" - Baixa
"B" - Bancos';
COMMENT ON    COLUMN    FNCONTA.CODEMPHP IS 'Cdigo da empresa na tabela de histrico padro.';
COMMENT ON    COLUMN    FNCONTA.CODFILIALHP IS 'Cdigo da filial na tabela de histrico padro.';
COMMENT ON    COLUMN    FNCONTA.CODHIST IS 'Cdigo do histrico padro.';
COMMENT ON    COLUMN    FNCONTA.CODCONTDEB IS 'Cdigo da conta dbito contbil.';
COMMENT ON    COLUMN    FNCONTA.CODCONTCRED IS 'Cdigo da conta crdito contbil.';
COMMENT ON    COLUMN    FNCONTA.CONVCOBCONTA IS 'Convnio de cobrana';
COMMENT ON    COLUMN    FNCONTA.ATIVACONTA IS 'Indica se a conta est ativa.';
COMMENT ON    COLUMN    FNCONTA.TIPOCAIXA IS 'Indica o tipo de caixa
"F" - Fsico
"P" - Previsionamentos';
COMMENT ON TABLE        FNCONTAVINCULADA IS 'Tabela de vinculo entre contas para composiso de saldo interno/externo';
COMMENT ON    COLUMN    FNCONTAVINCULADA.CODEMPCV IS 'Cdigo da empresa da conta vinculada';
COMMENT ON    COLUMN    FNCONTAVINCULADA.CODFILIALCV IS 'Cdigo da filial da conta vinculada.';
COMMENT ON    COLUMN    FNCONTAVINCULADA.NUMCONTACV IS 'Nmero da conta vinculada.';
COMMENT ON    COLUMN    FNCONTAVINCULADA.CONTACHEQUE IS 'Indica se a conta  para controle de compensao de cheques.';
COMMENT ON    COLUMN    FNFBNCLI.STIPOFEBRABAN IS 'Sub-Tipo Febraban 01=Dbito em folha / 02=Dbito em conta corrente.';
COMMENT ON    COLUMN    FNFBNCODRET.TIPORET IS 'Indica o tipo de ocorrncia:
RE - Rejeio de entrada;
CE - Confirmao de entrada;
AD - Advertncia;
CB - Confirmao de baixa;
RB - Rejeio de baixa;
IN - Indefinido;
';
COMMENT ON    COLUMN    FNFBNREC.STIPOFEBRABAN IS 'Sub-Tipo Febraban 01=Dbito em folha / 02=Dbito em conta corrente.';
COMMENT ON    COLUMN    FNFBNREC.SITREMESSA IS 'Situao da remessa 00=Selecionado / 01=Exportada';
COMMENT ON    COLUMN    FNFBNREC.SITRETORNO IS 'Situao do retorno. 00=Sem retorno.';
COMMENT ON    COLUMN    FNFBNREC.NOMEARQUIVO IS 'Nome do arquivo de remessa em que o registro foi exportado.
';
COMMENT ON TABLE        FNFINALIDADE IS 'Classificao de finalidade das contas financeiras.';
COMMENT ON    COLUMN    FNFINALIDADE.CODFIN IS 'Cdigo da finalidade.';
COMMENT ON    COLUMN    FNFINALIDADE.DESCFIN IS 'Descrio da finalidade.';
COMMENT ON    COLUMN    FNFINALIDADE.ESFIN IS 'Define se  entrada ou sada (E/S).';
COMMENT ON    COLUMN    FNFINALIDADE.CLASFIN IS 'Classificao operacional ou no operacional (O/N).';
COMMENT ON TABLE        FNHISTPAD IS 'Tabela de histrico padro.';
COMMENT ON    COLUMN    FNHISTPAD.TXAHISTPAD IS 'Campo para criao de modelo dinmico de histrico padro.';
COMMENT ON TABLE        FNITMODBOLETO IS 'Tabela de amarrao modelo de boleto e banco';
COMMENT ON    COLUMN    FNITMODBOLETO.CODEMP IS 'Cdigo da empresa';
COMMENT ON    COLUMN    FNITMODBOLETO.CODFILIAL IS 'Cdigo filial.';
COMMENT ON    COLUMN    FNITMODBOLETO.CODMODBOL IS 'Cdigo do modelo de boleto.';
COMMENT ON    COLUMN    FNITMODBOLETO.CODEMPBO IS 'Cdigo da empresa na tabela FNBANCO.';
COMMENT ON    COLUMN    FNITMODBOLETO.CODFILIALBO IS 'Cdigo da filial na tabela FNBANCO.';
COMMENT ON    COLUMN    FNITMODBOLETO.CODBANCO IS 'Cdigo do banco.';
COMMENT ON    COLUMN    FNITMODBOLETO.CODEMPCB IS 'Cdigo da empresa na tabela FNCARTCOB.';
COMMENT ON    COLUMN    FNITMODBOLETO.CODFILIALCB IS 'Cdigo da filial na tabela FNCARTCOB.';
COMMENT ON    COLUMN    FNITMODBOLETO.CODCARTCOB IS 'Cdigo da carteira de cobrana.';
COMMENT ON    COLUMN    FNITMODBOLETO.CONVCOB IS 'Convnio de cobrana.';
COMMENT ON    COLUMN    FNITMODBOLETO.DVCONVCOB IS 'Dgito do codigo da empresa.';
COMMENT ON    COLUMN    FNITMODBOLETO.SEQNOSSONUMERO IS 'Sequencia do nosso numero, para gerao de nosso numero no padro "S" SGPREFER1.TPNOSSONUMERO.';
COMMENT ON    COLUMN    FNITPAGAR.VLRDEVITPAG IS 'Valor das devolues de compra da parcela.';
COMMENT ON    COLUMN    FNITPAGAR.DTCOMPITPAG IS 'Data de competncia.';
COMMENT ON    COLUMN    FNITPAGAR.STATUSITPAG IS 'P1 - Pendente
PL - Pagamento parcial
PP - Pagamento total
CP - Cancelado';
COMMENT ON    COLUMN    FNITPAGAR.CODEMPSN IS 'Cdigo da empresa do sinalizador.
';
COMMENT ON    COLUMN    FNITPAGAR.CODFILIALSN IS 'Cdigo da filial do sinalizador.
';
COMMENT ON    COLUMN    FNITPAGAR.CODSINAL IS 'Cdigo do sinalizador.
';
COMMENT ON    COLUMN    FNITRECEBER.VLRDESCITREC IS 'Valor do desconto.';
COMMENT ON    COLUMN    FNITRECEBER.VLRMULTAITREC IS 'Valor da multa.';
COMMENT ON    COLUMN    FNITRECEBER.VLRJUROSITREC IS 'Valor dos juros.';
COMMENT ON    COLUMN    FNITRECEBER.VLRDEVITREC IS 'Valor de devoluo da parcela.';
COMMENT ON    COLUMN    FNITRECEBER.VLRPARCITREC IS 'Valor original da parcela.';
COMMENT ON    COLUMN    FNITRECEBER.VLRPAGOITREC IS 'Valor pago da parcela.';
COMMENT ON    COLUMN    FNITRECEBER.VLRAPAGITREC IS 'Valor a pagar.';
COMMENT ON    COLUMN    FNITRECEBER.VLRCOMIITREC IS 'Valor de comisso por parcela.';
COMMENT ON    COLUMN    FNITRECEBER.VLRBASECOMIS IS 'Valor base para comissionamento especial';
COMMENT ON    COLUMN    FNITRECEBER.DESCPONT IS 'Indica se o desconto e do tipo pontualidade.';
COMMENT ON    COLUMN    FNITRECEBER.DTCOMPITREC IS 'Data de competncia.
';
COMMENT ON    COLUMN    FNITRECEBER.DTPREVITREC IS 'Data prevista para o recebimento.';
COMMENT ON    COLUMN    FNITRECEBER.DTPAGOITREC IS 'Data de pagamento ou data de compensao.';
COMMENT ON    COLUMN    FNITRECEBER.DTLIQITREC IS 'Data de liquidao do ttulo.
';
COMMENT ON    COLUMN    FNITRECEBER.STATUSITREC IS 'R1 (Conta em aberto)
RP (Recebimento total)
RB (Em Bordero)
RL (Recebimento parcial)
RN (Recebimento Renegociado) 
RR (Recebimento em Renegociacao)';
COMMENT ON    COLUMN    FNITRECEBER.CODEMPTC IS 'Cdigo da filial em FNTIPOCOB.';
COMMENT ON    COLUMN    FNITRECEBER.CODFILIALTC IS 'Cdigo filial em FNTIPOCOB.';
COMMENT ON    COLUMN    FNITRECEBER.CODTIPOCOB IS 'Cdigo do tipo de cobrana.';
COMMENT ON    COLUMN    FNITRECEBER.CODEMPCB IS 'Cdigo da empresa na tabela FNCARTCOB.';
COMMENT ON    COLUMN    FNITRECEBER.CODFILIALCB IS 'Cdigo filial na tabela FNCARTCOB.';
COMMENT ON    COLUMN    FNITRECEBER.CODCARTCOB IS 'Cdigo da carteira de cobrana.';
COMMENT ON    COLUMN    FNITRECEBER.IMPRECIBOITREC IS 'Flag que indica se ser impresso recibo.';
COMMENT ON    COLUMN    FNITRECEBER.RECIBOITREC IS 'Armazena o nmero do recibo.';
COMMENT ON    COLUMN    FNITRECEBER.ALTUSUITREC IS 'Flag que indica se est sendo feita alterao de item de contas a receber pelo usurio.';
COMMENT ON    COLUMN    FNITRECEBER.PDVITREC IS 'Indica se foi recebido pelo PDV.';
COMMENT ON    COLUMN    FNITRECEBER.RECEMCOB IS 'Definie se recebimento est em processo de cobrana';
COMMENT ON    COLUMN    FNITRECEBER.DTINIEMCOB IS 'Data de inicio de cobrana';
COMMENT ON    COLUMN    FNITRECEBER.DTFIMEMCOB IS 'Fim do processo de cobrana';
COMMENT ON    COLUMN    FNITRECEBER.SEQNOSSONUMERO IS 'Sequencial do nosso nmero.';
COMMENT ON    COLUMN    FNITRECEBER.NOSSONUMERO IS 'Nosso nmero (utilizado para armazenar o nosso nmero quando gerado pelo banco e retornado atravs do CNAB)
';
COMMENT ON    COLUMN    FNITRECEBER.EMMANUT IS 'Coloca registro em estado de manuteno.
';
COMMENT ON TABLE        FNITTBJUROS IS 'Itens das tabelas de juros.
';
COMMENT ON    COLUMN    FNLANCA.DTCOMPLANCA IS 'Data de competncia.';
COMMENT ON    COLUMN    FNLANCA.HISTBLANCA IS 'Histrico bancrio.';
COMMENT ON    COLUMN    FNLANCA.PDVITREC IS 'Indica se foi recebido pelo PDV';
COMMENT ON    COLUMN    FNLANCA.CODCLI IS 'Cdigo do cliente, para vnculo com contas a receber.';
COMMENT ON    COLUMN    FNLANCA.CODEMPCL IS 'Cdigo da empresa do cliente';
COMMENT ON    COLUMN    FNLANCA.CODFILIALCL IS 'Cdigo da filial do cliente.';
COMMENT ON    COLUMN    FNLANCA.EMMANUT IS 'Estado de manuteno (S/N).
';
COMMENT ON    COLUMN    FNLIBCRED.VLRVENDACRED IS 'Valor da venda no momento da liberao de crdito.';
COMMENT ON    COLUMN    FNMODBOLETO.PREIMPMODBOL IS 'Flag para indicar se usa boleto pre-impresso.[ S ]';
COMMENT ON    COLUMN    FNMODBOLETO.CARTCOB IS 'Carteira de cobrana.';
COMMENT ON    COLUMN    FNMODBOLETO.MDECOB IS 'Modalidade de cobrana.';
COMMENT ON    COLUMN    FNMODBOLETO.ACEITEMODBOL IS 'Flag indicador para aceitao do boleto pelo cliente.';
COMMENT ON    COLUMN    FNMODBOLETO.DESCLPMODBOL IS 'Descrio do local de pagamento do boleto.';
COMMENT ON    COLUMN    FNMODBOLETO.INSTPAGMODBOL IS 'Instrues para o pagamento do boleto.';
COMMENT ON    COLUMN    FNMODBOLETO.IMPINFOPARC IS 'Indica se deve imprimir informaes da parcela nas intrues de cobrana para boletos grficos.';
COMMENT ON    COLUMN    FNMOEDA.CODFBNMOEDA IS 'Cdigo da moeda padro Febraban.';
COMMENT ON    COLUMN    FNMOVIMENTO.TIPOMOV IS 'Tipo de movimento:
"R" - Receber
"P" - Pagar';
COMMENT ON    COLUMN    FNMOVIMENTO.SITMOV IS 'Situao do movimento:
"E" - Edio
"B" - Baixa
"D" - Devoluo
"C" - Cancelada
"P" - Pagar';
COMMENT ON    COLUMN    FNMOVIMENTO.STATUSOLD IS 'Status antigo.';
COMMENT ON    COLUMN    FNPAGAR.VLRDESCPAG IS 'Valor dos descontos. (Deve ser incluidos as retenes se houverem)';
COMMENT ON    COLUMN    FNPAGAR.VLRDEVPAG IS 'Valor das devolues de compra.';
COMMENT ON    COLUMN    FNPAGAR.DTCOMPPAG IS 'Data de competncia.';
COMMENT ON    COLUMN    FNPAGAR.VLRBASEIRRF IS 'Valor da base de calculo do IRRF (Pagamento de autonomos)';
COMMENT ON    COLUMN    FNPAGAR.VLRBASEINSS IS 'Valor da base de calculo do INSS (Pagamento de autonomos)';
COMMENT ON    COLUMN    FNPAGAR.VLRRETIRRF IS 'Valor de desconto/reteno do IRRF (Pagamento de autonomos)';
COMMENT ON    COLUMN    FNPAGAR.VLRRETINSS IS 'Valor do desconto/reteno do INSS (Pagamento de autonomos)';
COMMENT ON    COLUMN    FNPAGAR.CODEMPPN IS 'Cdigo da empresa do planejamento financeiro.';
COMMENT ON    COLUMN    FNPAGAR.CODFILIALPN IS 'Cdigo da filial do planejamento financeiro.';
COMMENT ON    COLUMN    FNPAGAR.CODPLAN IS 'Cdigo do planejamento financeiro.';
COMMENT ON    COLUMN    FNPAGAR.CODEMPCC IS 'Cdigo da empresa do centro de custo.';
COMMENT ON    COLUMN    FNPAGAR.CODFILIALCC IS 'Cdigo da filial do centro de custo.';
COMMENT ON    COLUMN    FNPAGAR.ANOCC IS 'Ano do centro de custo.';
COMMENT ON    COLUMN    FNPAGAR.CODCC IS 'Cdigo do centro de custo.';
COMMENT ON    COLUMN    FNPAGCHEQ.CODEMP IS 'Cdigo da empresa na tabela FNPAGAR.';
COMMENT ON    COLUMN    FNPAGCHEQ.CODFILIAL IS 'Cdigo da filial na tabela FNPAGAR.';
COMMENT ON    COLUMN    FNPAGCHEQ.CODPAG IS 'Cdigo do pagamento.';
COMMENT ON    COLUMN    FNPAGCHEQ.NPARCPAG IS 'Nmero sequencial.';
COMMENT ON    COLUMN    FNPAGCHEQ.CODEMPCH IS 'Cdigo da empresa na tabela FNCHEQUE.';
COMMENT ON    COLUMN    FNPAGCHEQ.CODFILIALCH IS 'Cdigo filial na tabela FNCHEQUE.';
COMMENT ON    COLUMN    FNPAGCHEQ.SEQCHEQ IS 'Sequencia de cheque.';
COMMENT ON    COLUMN    FNPAGCHEQ.BAIXA IS 'Indica se deve realizar a baixa do titulo vinculado (gatilho cheque emitido)
S - Sim;
N - No;
';
COMMENT ON    COLUMN    FNPAGCHEQ.TRANSFERE IS 'Indica se deve transferir o titulo vinculado da conta de cheques para conta real (gatilho cheque compensado)
S - Sim;
N - No;';
COMMENT ON    COLUMN    FNPAGCHEQ.DTINS IS 'Data de insero.';
COMMENT ON    COLUMN    FNPAGCHEQ.HINS IS 'Hora de insero.';
COMMENT ON    COLUMN    FNPAGCHEQ.IDUSUINS IS 'Id. do usurio que inseriu.';
COMMENT ON    COLUMN    FNPAGCHEQ.DTALT IS 'Data de alterao.';
COMMENT ON    COLUMN    FNPAGCHEQ.HALT IS 'Hora de alterao.';
COMMENT ON    COLUMN    FNPAGCHEQ.IDUSUALT IS 'Id. do usurio que alterou.';
COMMENT ON    COLUMN    FNPAGTOCOMI.DTCOMPPCOMI IS 'Data de competncia.';
COMMENT ON    COLUMN    FNPAGTOCOMI.EMMANUT IS 'Estado de manuteno (S/N).';
COMMENT ON    COLUMN    FNPARCPAG.AUTOBAIXAPARC IS 'Flag para marcar baixa automtica da parcela.';
COMMENT ON    COLUMN    FNPLANEJAMENTO.CODREDPLAN IS 'Cdigo reduzido';
COMMENT ON    COLUMN    FNPLANEJAMENTO.FINPLAN IS 'Finalidade do planejamento.';
COMMENT ON    COLUMN    FNPLANEJAMENTO.COMPSLDCXPLAN IS 'Flag indicando se compe saldo de caixa.';
COMMENT ON    COLUMN    FNPLANEJAMENTO.CODCONTCRED IS 'Cdigo da conta crdito para contabilidade.';
COMMENT ON    COLUMN    FNPLANEJAMENTO.CODCONTDEB IS 'Cdigo da conta dbido para contabilidade.';
COMMENT ON    COLUMN    FNPLANEJAMENTO.ESFINPLAN IS 'Natureza da categoria E-Entrada / S-Sada';
COMMENT ON    COLUMN    FNPLANEJAMENTO.CLASFINPLAN IS 'Classificao da categoria O-Operacional / N-No Operacional.';
COMMENT ON    COLUMN    FNPLANOPAG.APORCPLANOPAG IS 'Flag que indica se oramento ser aprovado por padro na tela de fechamento de oramento.';
COMMENT ON    COLUMN    FNPLANOPAG.ATIVOPLANOPAG IS 'Flag que indica se o plano de pagamento est ativo "S" ou inativo "N".';
COMMENT ON    COLUMN    FNPLANOPAG.CVPLANOPAG IS 'Indica se o plano de pagamento  para compra "C", venda "V" ou ambos "A", deve ser usado como filtro nas telas correspondentes.';
COMMENT ON    COLUMN    FNPLANOPAG.CODEMPTBJ IS 'Cdigo da empresa da tabela de juros.';
COMMENT ON    COLUMN    FNPLANOPAG.CODFILIALTBJ IS 'Cdigo da filial da tabela de juros.';
COMMENT ON    COLUMN    FNPLANOPAG.CODTBJ IS 'Cdigo da tabela de juros.';
COMMENT ON    COLUMN    FNPLANOPAG.PERCDESC IS 'Percentual de desconto.';
COMMENT ON    COLUMN    FNPLANOPAG.REGRVCTOPLANOPAG IS 'Regra de para vencimento.
N - Nenhuma
A - Antecipar
P - Prorrogar';
COMMENT ON    COLUMN    FNPLANOPAG.RVSABPLANOPAG IS 'Define se a regra de vencimento vale para os sbados.';
COMMENT ON    COLUMN    FNPLANOPAG.RVDOMPLANOPAG IS 'Define se a regra de vencimento vale para os domingos.';
COMMENT ON    COLUMN    FNPLANOPAG.RVFERPLANOPAG IS 'Define se a regra de vencimento vale para os feriados.';
COMMENT ON    COLUMN    FNPLANOPAG.RVDIAPLANOPAG IS 'Regra do dia de vencimento
A - Automtico
F - Dia fixo
U - Dia util
';
COMMENT ON    COLUMN    FNPLANOPAG.DIAVCTOPLANOPAG IS 'Dia fixo ou til para o vencimento.';
COMMENT ON    COLUMN    FNRECEBER.CODEMPTC IS 'Cdigo da empresa em FNTIPOCOB.';
COMMENT ON    COLUMN    FNRECEBER.CODFILIALTC IS 'Cdigo da filial em FNTIPOCOB.';
COMMENT ON    COLUMN    FNRECEBER.CODTIPOCOB IS 'Cdigo do tipo de cobrana.';
COMMENT ON    COLUMN    FNRECEBER.CODEMPCB IS 'Cdigo da empresa na tabela FNCARTCOB.';
COMMENT ON    COLUMN    FNRECEBER.CODFILIALCB IS 'Cdigo da filial na tabela FNCARTCOB.';
COMMENT ON    COLUMN    FNRECEBER.CODCARTCOB IS 'Cdigo da carteira de cobrana.';
COMMENT ON    COLUMN    FNRECEBER.VLRDEVREC IS 'Valor total das devolues.';
COMMENT ON    COLUMN    FNRECEBER.VLRBASECOMIS IS 'Valor da base de calculo de comissionamento especial';
COMMENT ON    COLUMN    FNRECEBER.VLRRETENSAOISS IS 'VALOR DO ISS RETIDO PELO CLIENTE.';
COMMENT ON    COLUMN    FNRECEBER.DTCOMPREC IS 'Data de competncia.';
COMMENT ON    COLUMN    FNRECEBER.CODEMPPN IS 'Cdigo da empresa do planejamento financeiro.';
COMMENT ON    COLUMN    FNRECEBER.CODFILIALPN IS 'Cdigo da filial do planejamento financeiro.';
COMMENT ON    COLUMN    FNRECEBER.CODPLAN IS 'Cdigo do planejamento financeiro.';
COMMENT ON    COLUMN    FNRECEBER.CODEMPCC IS 'Cdigo da empresa do centro de custo.';
COMMENT ON    COLUMN    FNRECEBER.CODFILIALCC IS 'Cdigo da filial do centro de custo.';
COMMENT ON    COLUMN    FNRECEBER.ANOCC IS 'Ano do centro de custo.';
COMMENT ON    COLUMN    FNRECEBER.CODCC IS 'Cdigo do centro de custo.';
COMMENT ON    COLUMN    FNRECEBER.CODEMPRR IS 'Cdigo da empresa da renegociao.';
COMMENT ON    COLUMN    FNRECEBER.CODFILIALRR IS 'Cdigo da filial da renegociao.';
COMMENT ON    COLUMN    FNRECEBER.CODRENEGREC IS 'Cdigo da renegociao.';
COMMENT ON    COLUMN    FNRECEBER.EMMANUT IS 'Estado de manuteno (S/N).';
COMMENT ON TABLE        FNRENEGREC IS 'Tabela para gerenciamento de ttulos renegociados.';
COMMENT ON TABLE        FNRESTRICAO IS 'Tabela de restries dos clientes.';
COMMENT ON    COLUMN    FNRESTRICAO.SITRESTR IS 'Situaao da restrio 
I - Incluso
C - Cancelada';
COMMENT ON    COLUMN    FNSALDOLANCA.FECHADO IS 'Indica se o caixa foi fechado para este dia, se "S" no dever permitir lanamentos para esta data.';
COMMENT ON    COLUMN    FNSALDOLANCA.EMMANUT IS 'Indica se o registro est em processo de manuteno.';
COMMENT ON TABLE        FNSINAL IS 'Tabela de sinalizao de lanamentos.';
COMMENT ON    COLUMN    FNSINAL.CODEMP IS 'Cdigo da empresa.';
COMMENT ON    COLUMN    FNSINAL.CODFILIAL IS 'Cdigo da filial.';
COMMENT ON    COLUMN    FNSINAL.CODSINAL IS 'Cdigo de sinalizao';
COMMENT ON    COLUMN    FNSINAL.DESCSINAL IS 'Descrio da sinalizao';
COMMENT ON    COLUMN    FNSINAL.CORSINAL IS 'Cor da sinalizao';
COMMENT ON    COLUMN    FNSINAL.DTINS IS 'Data de insero';
COMMENT ON    COLUMN    FNSINAL.HINS IS 'Hora da insero';
COMMENT ON    COLUMN    FNSINAL.IDUSUINS IS 'ID do usurio que inseriu';
COMMENT ON    COLUMN    FNSINAL.DTALT IS 'Data da lt. alterao';
COMMENT ON    COLUMN    FNSINAL.HALT IS 'Hora da lt. alterao';
COMMENT ON    COLUMN    FNSINAL.IDUSUALT IS 'ID do usurio que alterou';
COMMENT ON    COLUMN    FNSUBLANCA.DTCOMPSUBLANCA IS 'Data de competncia.';
COMMENT ON    COLUMN    FNSUBLANCA.TIPOSUBLANCA IS 'Tipo de lanamento (P-Padro, D-Desconto, J-Juros, M-Multa)';
COMMENT ON    COLUMN    FNSUBLANCA.CODEMPCT IS 'Cdigo da empresa do contrato/projeto';
COMMENT ON    COLUMN    FNSUBLANCA.CODFILIALCT IS 'Cdigo da filial da empresa/contrato';
COMMENT ON    COLUMN    FNSUBLANCA.CODCONTR IS 'Cdigo do contrato/projeto';
COMMENT ON    COLUMN    FNSUBLANCA.CODITCONTR IS 'Cdigo do tem de contrato/projeto';
COMMENT ON    COLUMN    FNSUBLANCA.EMMANUT IS 'Estado de manuteno (S/N).';
COMMENT ON TABLE        FNTALAOCHEQ IS 'Tabela de talonrio de cheques.';
COMMENT ON    COLUMN    FNTALAOCHEQ.CODEMP IS 'Cdigo da empresa';
COMMENT ON    COLUMN    FNTALAOCHEQ.CODFILIAL IS 'Cdigo da filial.';
COMMENT ON    COLUMN    FNTALAOCHEQ.NUMCONTA IS 'Nmero da conta';
COMMENT ON    COLUMN    FNTALAOCHEQ.SEQTALAO IS 'Sequencia do talo.';
COMMENT ON    COLUMN    FNTALAOCHEQ.DTTALAO IS 'Data do talo.';
COMMENT ON    COLUMN    FNTALAOCHEQ.CHEQINITALAO IS 'Nmero do cheque inicial.';
COMMENT ON    COLUMN    FNTALAOCHEQ.CHEQFIMTALAO IS 'Nmero final do cheque.';
COMMENT ON    COLUMN    FNTALAOCHEQ.CHEQATUALTALAO IS 'ltimo cheque impresso.';
COMMENT ON    COLUMN    FNTALAOCHEQ.ATIVOTALAO IS 'Talonrio ativo (S/N).';
COMMENT ON TABLE        FNTBJUROS IS 'Tabela de juros financeiros
';
COMMENT ON    COLUMN    FNTBJUROS.TIPOTBJ IS 'Tipo da tabela de juros: 
"D" = Dirio
"M" = Mensal
"B" = Bimestral
"T" = Trimestral
"S" = Semestral
"A" = Anual
"F" = Fixo';
COMMENT ON    COLUMN    FNTIPOCOB.TIPOFEBRABAN IS 'Define se  febraban. 00=no / 01-SIACC / 02-CNAB';
COMMENT ON    COLUMN    FNTIPOCOB.TIPOSPED IS 'Indicador do tipo de ttulo de crdito para o SPED:
00 - Duplicata
01 - Cheque
02 - Promissria
03 - recibo
';
COMMENT ON    COLUMN    FNTIPOCOB.OBRIGCARTCOB IS 'Define se  obrigatrio carteira de cobrana.';
COMMENT ON    COLUMN    FNTIPOCOB.CODEMPCT IS 'Cdigo da empresa na tabela de contas.
';
COMMENT ON    COLUMN    FNTIPOCOB.CODFILIALCT IS 'Cdigo da filial na tabela de contas.';
COMMENT ON    COLUMN    FNTIPOCOB.NUMCONTA IS 'Nmero da conta para impresso de cheques.
';
COMMENT ON    COLUMN    FNTIPOCOB.SEQTALAO IS 'Sequencia do talonrio.';
COMMENT ON    COLUMN    FNTIPOCOB.NRODIASCOMP IS 'Numero de dias para compensao do valor.';
COMMENT ON TABLE        FNTIPORESTR IS 'Tipos de restries.';
COMMENT ON    COLUMN    FNTIPORESTR.BLOQTPRESTR IS 'Define se a restrio bloqueia os lanamentos.';
COMMENT ON    COLUMN    LFCLFISCAL.TIPOFISC IS 'Campo inutilizado (mantido por retrocompatibilidade)';
COMMENT ON    COLUMN    LFCLFISCAL.TPREDICMSFISC IS 'Campo inutilizado (mantido por retrocompatibilidade)';
COMMENT ON    COLUMN    LFCLFISCAL.ALIQFISC IS 'Campo inutilizado (mantido por retrocompatibilidade)';
COMMENT ON    COLUMN    LFCLFISCAL.ALIQLFISC IS 'Campo inutilizado (mantido por retrocompatibilidade)';
COMMENT ON    COLUMN    LFCLFISCAL.REDFISC IS 'Campo inutilizado (mantido por retrocompatibilidade)';
COMMENT ON    COLUMN    LFCLFISCAL.ALIQIPIFISC IS 'Campo inutilizado (mantido por retrocompatibilidade)';
COMMENT ON    COLUMN    LFCLFISCAL.ORIGFISC IS 'Campo inutilizado (mantido por retrocompatibilidade)';
COMMENT ON    COLUMN    LFCLFISCAL.CODEMPTT IS 'Campo inutilizado (mantido por retrocompatibilidade)';
COMMENT ON    COLUMN    LFCLFISCAL.CODFILIALTT IS 'Campo inutilizado (mantido por retrocompatibilidade)';
COMMENT ON    COLUMN    LFCLFISCAL.CODTRATTRIB IS 'Campo inutilizado (mantido por retrocompatibilidade)';
COMMENT ON    COLUMN    LFCLFISCAL.CODEMPME IS 'Campo inutilizado (mantido por retrocompatibilidade)';
COMMENT ON    COLUMN    LFCLFISCAL.CODFILIALME IS 'Campo inutilizado (mantido por retrocompatibilidade)';
COMMENT ON    COLUMN    LFCLFISCAL.CODMENS IS 'Campo inutilizado (mantido por retrocompatibilidade)';
COMMENT ON    COLUMN    LFCLFISCAL.SITPISFISC IS 'Campo inutilizado (mantido por retrocompatibilidade)';
COMMENT ON    COLUMN    LFCLFISCAL.SITCOFINSFISC IS 'Campo inutilizado (mantido por retrocompatibilidade)';
COMMENT ON    COLUMN    LFCLFISCAL.TIPOST IS 'Campo inutilizado (mantido por retrocompatibilidade)';
COMMENT ON    COLUMN    LFCLFISCAL.MARGEMVLAGR IS 'Campo inutilizado (mantido por retrocompatibilidade)';
COMMENT ON    COLUMN    LFCLFISCAL.CODSERV IS 'Cdigo do servio (tabela de servios)';
COMMENT ON TABLE        LFCSOSN IS 'Tabela de situao da operao no simples nacional.';
COMMENT ON    COLUMN    LFCSOSN.CSOSN IS 'Cdigo de situao da operao no simples nacional.';
COMMENT ON    COLUMN    LFCSOSN.DESCCSOSN IS 'Descrio da situao da operao no simples nacional.';
COMMENT ON TABLE        LFFRETE IS 'Tabela para lanamento de conhecimentos de frete.';
COMMENT ON    COLUMN    LFFRETE.CODNAT IS 'Natureza da operao.';
COMMENT ON    COLUMN    LFFRETE.TIPOFRETE IS 'Modalidade do frete "1" CIF ou "2" FOB.';
COMMENT ON    COLUMN    LFFRETE.TIPOPGTO IS 'Tipo de pagamento do frete "P" pago ou "A" a pagar.';
COMMENT ON    COLUMN    LFFRETE.CODREMET IS 'Cdigo do remetente. Relacionada  tabela de cdigos unificados SGUNIFCOD
Pode ser cliente, fornecedor, empresa, etc...';
COMMENT ON    COLUMN    LFFRETE.CODDESTINAT IS 'Cdigo do destinatario. Relacionada  tabela de cdigos unificados SGUNIFCOD
Pode ser cliente, fornecedor, empresa, etc...';
COMMENT ON    COLUMN    LFFRETE.DTEMITFRETE IS 'Data de emisso do conhecimento de frete.';
COMMENT ON    COLUMN    LFFRETE.QTDFRETE IS 'Quantidade de volumes.';
COMMENT ON    COLUMN    LFFRETE.VLRMERCADORIA IS 'Valor da mercadoria transportada.';
COMMENT ON    COLUMN    LFFRETE.VLRFRETE IS 'Valor cobrado pelo frete.';
COMMENT ON    COLUMN    LFFRETE.VLRFRETENOTA IS 'Valor do frete destacado na nota fiscal.';
COMMENT ON    COLUMN    LFFRETE.PESOBRUTO IS 'Peso bruto da mercadoria transportada.';
COMMENT ON    COLUMN    LFFRETE.PESOLIQUIDO IS 'Peso liquido da mercadoria transportada.';
COMMENT ON    COLUMN    LFFRETE.VLRBASEICMSFRETE IS 'Base do ICMS.';
COMMENT ON    COLUMN    LFFRETE.CODPAG IS 'Codigo no contas a pagar.';
COMMENT ON    COLUMN    LFFRETE.SERIE IS 'Srie do documento de conhecimento de frete.';
COMMENT ON    COLUMN    LFFRETE.CODEMPRM IS 'Cdigo da empresa do recebimento de mercadorias.';
COMMENT ON    COLUMN    LFFRETE.CODFILIALRM IS 'Cdigo da filial do recebimento de mercadorias.';
COMMENT ON    COLUMN    LFFRETE.TICKET IS 'Ticket do recebimento de mercadoria.';
COMMENT ON    COLUMN    LFFRETE.CHAVECTE IS 'Chave do conhecimento de transporte eletronico.';
COMMENT ON    COLUMN    LFFRETE.CODEMPTT IS 'Cdigo da empresa do tratamento tributario do icms.';
COMMENT ON    COLUMN    LFFRETE.CODFILIALTT IS 'Cdigo da filial do tratamento tributrio do ICMS';
COMMENT ON    COLUMN    LFFRETE.CODTRATTRIB IS 'Cdigo do tratamento tributrio do ICMS';
COMMENT ON    COLUMN    LFITCLFISCAL.ORIGFISC IS 'Origem da mercadoria:
0 - Nacional
1 - Estrangeira Importao direta
2 - Estrangeira - Adquirida no mercado interno';
COMMENT ON    COLUMN    LFITCLFISCAL.TPREDICMSFISC IS 'Tipo de reduo de ICMS
B - BASE DE CLCULO
V - VALOR DO ICMS';
COMMENT ON    COLUMN    LFITCLFISCAL.ALIQFISC IS 'Alquota interestadual do produto.';
COMMENT ON    COLUMN    LFITCLFISCAL.ALIQFISCINTRA IS 'Alquota intraestadual de ICMS.';
COMMENT ON    COLUMN    LFITCLFISCAL.ALIQLFISC IS 'Aliquota de livros fiscais (uso pdv)';
COMMENT ON    COLUMN    LFITCLFISCAL.ALIQIPIFISC IS 'Alquota de IPI';
COMMENT ON    COLUMN    LFITCLFISCAL.ALIQPISFISC IS 'Alquota diferenciada do PIS para a classificao fiscal (sobrepe aliquota da filial)';
COMMENT ON    COLUMN    LFITCLFISCAL.ALIQCOFINSFISC IS 'Alquota diferenciada do Cofins para a classificao fiscal (sobrepe alquota da filial)';
COMMENT ON    COLUMN    LFITCLFISCAL.ALIQCSOCIALFISC IS 'Aliquota da contribuio social.';
COMMENT ON    COLUMN    LFITCLFISCAL.ALIQIRFISC IS 'Aliquota do imposto de renda.';
COMMENT ON    COLUMN    LFITCLFISCAL.ALIQFUNRURALFISC IS 'Aliquota de recolhimento do Funrural.';
COMMENT ON    COLUMN    LFITCLFISCAL.ALIQIIFISC IS 'Aliquota do imposto de importao para a classificao fiscal.';
COMMENT ON    COLUMN    LFITCLFISCAL.TIPOST IS 'Tipo da Substituio tributria.
SU - Substituto (Responsvel pela reteno e recolhimento de todo o imposto (subsequente tambm);
SI - Substitudo (Imposto pago pelo contribuite substituto);';
COMMENT ON    COLUMN    LFITCLFISCAL.MARGEMVLAGR IS 'Margem de valor agregado para calculo da base de calculo do icms de substituio tributria.';
COMMENT ON    COLUMN    LFITCLFISCAL.GERALFISC IS 'Indica se  a regra geral da classificao fiscal.';
COMMENT ON    COLUMN    LFITCLFISCAL.CODEMPSP IS 'Cdigo da empresa da situao tributria do PIS.';
COMMENT ON    COLUMN    LFITCLFISCAL.CODFILIALSP IS 'Cdigo da filial da situao tributria do PIS';
COMMENT ON    COLUMN    LFITCLFISCAL.CODSITTRIBPIS IS 'Cdigo da situao tributrio do PIS.';
COMMENT ON    COLUMN    LFITCLFISCAL.IMPSITTRIBPIS IS 'Cdigo do imposto da situao tributria do PIS.';
COMMENT ON    COLUMN    LFITCLFISCAL.CODEMPSC IS 'Cdigo da empresa da situao tributria do COFINS.';
COMMENT ON    COLUMN    LFITCLFISCAL.CODFILIALSC IS 'Cdigo da situao tributria do COFINS.';
COMMENT ON    COLUMN    LFITCLFISCAL.CODSITTRIBCOF IS 'Cdigo da situao tributria do COFINS.';
COMMENT ON    COLUMN    LFITCLFISCAL.IMPSITTRIBCOF IS 'Cdigo do imposto da situao tributria do COFINS.';
COMMENT ON    COLUMN    LFITCLFISCAL.CODEMPSI IS 'Cdigo da empresa da situao tributria do IPI';
COMMENT ON    COLUMN    LFITCLFISCAL.CODFILIALSI IS 'Cdigo da filial da situao tributria do IPI';
COMMENT ON    COLUMN    LFITCLFISCAL.CODSITTRIBIPI IS 'Cdigo da situao tributria do IPI';
COMMENT ON    COLUMN    LFITCLFISCAL.IMPSITTRIBIPI IS 'Cdigo do imposto da situao tributria do IPI';
COMMENT ON    COLUMN    LFITCLFISCAL.TPCALCIPI IS 'Tipo de clculo do IPI 
P - Percentual
V - Valor';
COMMENT ON    COLUMN    LFITCLFISCAL.VLRIPIUNIDTRIB IS 'Valor do IPI por unidade tributvel.
Utilizado caso o TPCALCIPI = V';
COMMENT ON    COLUMN    LFITCLFISCAL.MODBCICMS IS 'Modalidade de determinao da base de clculo do ICMS.
0 - Margem Valor Agregado (%)
1 - Pauta (Valor)
2 - Preo Tabelado Max. (valor)
3 - Valor da operao';
COMMENT ON    COLUMN    LFITCLFISCAL.MODBCICMSST IS 'Modalidade de determinao da base de clculo do ICMS substituio tributria.
0 - Preo tabelado ou mximo sugerido;
1 - Lista Negativa (valor)
2 - Lista Positiva (valor)
3 - Lista Neutra (valor)
4 - Margem Valor Agregado (%);
5 - Pauta (valor)';
COMMENT ON    COLUMN    LFITCLFISCAL.CODPAIS IS 'Cdigo do pas para amarrao com estado.';
COMMENT ON    COLUMN    LFITCLFISCAL.SIGLAUF IS 'Sigla da UF';
COMMENT ON    COLUMN    LFITCLFISCAL.VLRPISUNIDTRIB IS 'Valor de tributao do PIS por unidade vendida.';
COMMENT ON    COLUMN    LFITCLFISCAL.VLRCOFUNIDTRIB IS 'Valor de tributao do COFINS por unidade vendida.';
COMMENT ON    COLUMN    LFITCLFISCAL.TIPOUSOITFISC IS 'Tipo de uso para a regra de classificao fiscal:
VD - Venda
CP - Compra';
COMMENT ON    COLUMN    LFITCLFISCAL.REDBASEST IS 'Indica se h reduo na base do icms de substituio tributria.';
COMMENT ON    COLUMN    LFITCLFISCAL.REDBASEFRETE IS 'Indica se deve reduzir o valor do frete adicionado a base do icms.';
COMMENT ON    COLUMN    LFITCLFISCAL.CODEMPIS IS 'Cdigo da empresa da situao tributrio para o ISS.';
COMMENT ON    COLUMN    LFITCLFISCAL.CODFILIALIS IS 'Cdigo da filial para a situao tributria do ISS';
COMMENT ON    COLUMN    LFITCLFISCAL.CODSITTRIBISS IS 'Cdigo da situao tributria para o ISS';
COMMENT ON    COLUMN    LFITCLFISCAL.IMPSITTRIBISS IS 'Sigla do imposto definido para situao tributria do ISS';
COMMENT ON    COLUMN    LFITCLFISCAL.ALIQISSFISC IS 'Alquota do ISS';
COMMENT ON    COLUMN    LFITCLFISCAL.RETENSAOISS IS 'Indica se deve ISS deve ser retido pelo cliente na fonte (pago pelo cliente e descontado na nota);';
COMMENT ON    COLUMN    LFITCLFISCAL.INDAPURIPI IS 'Indicativo de apurao do IPI
0 - Mensal
1 - Decendial';
COMMENT ON    COLUMN    LFITCLFISCAL.CODEMPCN IS 'Cdigo da empresa do CSOSN
';
COMMENT ON    COLUMN    LFITCLFISCAL.CODFILIALCN IS 'Cdigo da filial do CSOSN
';
COMMENT ON    COLUMN    LFITCLFISCAL.CSOSN IS 'Cdigo de situao da operao no simples nacional.
';
COMMENT ON    COLUMN    LFITCLFISCAL.ALIQICMSIMP IS 'Aliquota do ICMS de importao.
';
COMMENT ON TABLE        LFITCOMPRA IS 'Tabela auxiliar de informaes fiscais do item de compra.';
COMMENT ON    COLUMN    LFITCOMPRA.ALIQREDBCICMS IS 'Alquota da reduo da base de calculo do ICMS.';
COMMENT ON    COLUMN    LFITCOMPRA.ALIQREDBCICMSST IS 'Aliquota da reduo da base de calculo do ICMS Substituio tributria.';
COMMENT ON    COLUMN    LFITCOMPRA.ALIQICMSST IS 'Aliquota do icms de substituio tributria.';
COMMENT ON    COLUMN    LFITCOMPRA.ALIQPIS IS 'Alquota do PIS';
COMMENT ON    COLUMN    LFITCOMPRA.VLRPISUNIDTRIB IS 'Valor tributvel para o PIS';
COMMENT ON    COLUMN    LFITCOMPRA.VLRBASEPIS IS 'Valor da base de clculo do PIS';
COMMENT ON    COLUMN    LFITCOMPRA.VLRBASECOFINS IS 'Valor da base de clculo do COFINS';
COMMENT ON    COLUMN    LFITCOMPRA.VLRCOFUNIDTRIB IS 'Valor tributvel do pis por unidade comprada.';
COMMENT ON    COLUMN    LFITCOMPRA.VLRIR IS 'Valor do IR sobre o tem de compra.';
COMMENT ON    COLUMN    LFITCOMPRA.VLRPIS IS 'Valor do PIS sobre o tem de compra.';
COMMENT ON    COLUMN    LFITCOMPRA.VLRCOFINS IS 'Valor do COFINS sobre o item de compra.';
COMMENT ON    COLUMN    LFITCOMPRA.VLRCSOCIAL IS 'Valor da Contribuio Social sobre o item de venda.';
COMMENT ON    COLUMN    LFITCOMPRA.ORIGFISC IS 'Origem da mercadoria:
0 - Nacional
1 - Estrangeira Importao direta
2 - Estrangeira - Adquirida no mercado interno';
COMMENT ON    COLUMN    LFITCOMPRA.CODTRATTRIB IS 'Cdigo do tratamento tributrio.';
COMMENT ON    COLUMN    LFITCOMPRA.PERCICMSSIMPLES IS 'Percentual de crdito de icms (simples)
';
COMMENT ON    COLUMN    LFITCOMPRA.EMMANUT IS 'Indica se a tabela est em manuteno.';
COMMENT ON    COLUMN    LFITCOMPRA.VLRBASEICMSSTITRETCOMPRA IS 'Base de calculo do icms st retido na operao anterior.';
COMMENT ON    COLUMN    LFITCOMPRA.VLRICMSSTRETITCOMPRA IS 'Valor do ICMS ST retido na operao anterior.
';
COMMENT ON    COLUMN    LFITCOMPRA.ALIQII IS 'Aliquota do imposto de importao do item.
';
COMMENT ON    COLUMN    LFITCOMPRA.VLRBASEII IS 'Valor da base de calculo do imposto de importao do item.
';
COMMENT ON    COLUMN    LFITCOMPRA.VLRII IS 'Valor do imposto de importao do item.
';
COMMENT ON    COLUMN    LFITCOMPRA.VLRICMSDIFERIDO IS 'Valor do ICMS diferido.';
COMMENT ON    COLUMN    LFITCOMPRA.VLRICMSDEVIDO IS 'Valor do ICMS devido.';
COMMENT ON    COLUMN    LFITCOMPRA.VLRICMSCREDPRESUM IS 'Valor do crdito presumido do ICMS';
COMMENT ON TABLE        LFITVENDA IS 'Tabela auxiliar de informaes fiscais do item de venda.';
COMMENT ON    COLUMN    LFITVENDA.ALIQREDBCICMS IS 'Alquota da reduo da base de calculo do ICMS.';
COMMENT ON    COLUMN    LFITVENDA.ALIQREDBCICMSST IS 'Aliquota da reduo da base de calculo do ICMS Substituio tributria.';
COMMENT ON    COLUMN    LFITVENDA.ALIQICMSST IS 'Aliquota do icms de substituio tributria.';
COMMENT ON    COLUMN    LFITVENDA.ALIQPIS IS 'Alquota do PIS';
COMMENT ON    COLUMN    LFITVENDA.VLRPISUNIDTRIB IS 'Valor tributvel para o PIS';
COMMENT ON    COLUMN    LFITVENDA.VLRBASEPIS IS 'Valor da base de clculo do PIS';
COMMENT ON    COLUMN    LFITVENDA.VLRBASECOFINS IS 'Valor da base de clculo do COFINS';
COMMENT ON    COLUMN    LFITVENDA.VLRCOFUNIDTRIB IS 'Valor tributvel do pis por unidade vendida';
COMMENT ON    COLUMN    LFITVENDA.VLRIR IS 'Valor do IR sobre o tem de venda.';
COMMENT ON    COLUMN    LFITVENDA.VLRPIS IS 'Valor do PIS sobre o tem de venda.';
COMMENT ON    COLUMN    LFITVENDA.VLRCOFINS IS 'Valor do COFINS sobre o item de venda.';
COMMENT ON    COLUMN    LFITVENDA.VLRCSOCIAL IS 'Valor da Contribuio Social sobre o item de venda.';
COMMENT ON    COLUMN    LFITVENDA.VLRBASEICMSITVENDA IS 'Valor da base de calculo do icms sobre o frete do item.';
COMMENT ON    COLUMN    LFITVENDA.VLRBASEICMSFRETEITVENDA IS 'Valor da base de calculo do icms do item de venda.';
COMMENT ON    COLUMN    LFITVENDA.VLRICMSFRETEITVENDA IS 'Valor do icms do frete no item de venda.';
COMMENT ON    COLUMN    LFITVENDA.VLRBASENCM IS 'Valor base de clculo para estimativa de impostos, referente a lei de transparncia';
COMMENT ON    COLUMN    LFITVENDA.ALIQNACNCM IS 'Alquota estimada de tributos nacionais, referente a lei de transparncia';
COMMENT ON    COLUMN    LFITVENDA.ALIQIMPNCM IS 'Alquota estimada de tributos de importao, referente a lei de transparncia';
COMMENT ON    COLUMN    LFITVENDA.VLRNACNCM IS 'Valor estimado de tributos nacionais, referente a lei de transparncia';
COMMENT ON    COLUMN    LFITVENDA.VLRIMPNCM IS 'Valor estimado de tributos de importao, referente a lei de transparncia';
COMMENT ON    COLUMN    LFLIVROFISCAL.SITUACAOLF IS 'Situao do registro:
"N" - Documento fiscal normal;
"S" - Documento fiscal cancelado;
"E" - Documento fiscal extemporneo;
"X" - Documento fiscal extemporneo cancelado;';
COMMENT ON    COLUMN    LFMODNOTA.TIPOMODNOTA IS 'N - Normal
E - Nota fiscal Eletronica
O - Outras';
COMMENT ON    COLUMN    LFNATOPER.IMPDTSAIDANAT IS 'Flag para impresso de data de saida na nota fiscal.
';
COMMENT ON TABLE        LFNCM IS 'NCM Nomenclatura Comum do Mercosul';
COMMENT ON TABLE        LFSEQSERIE IS 'Tabela de sequencia de sries.';
COMMENT ON    COLUMN    LFSEQSERIE.CODEMP IS 'Cdigo da empresa conforme a tabela LFSERIE.';
COMMENT ON    COLUMN    LFSEQSERIE.CODFILIAL IS 'Cdigo da filial conforme a tabela LFSERIE.';
COMMENT ON    COLUMN    LFSEQSERIE.SERIE IS 'Cdigo da srie.';
COMMENT ON    COLUMN    LFSEQSERIE.CODEMPSS IS 'Cdigo da empresa.';
COMMENT ON    COLUMN    LFSEQSERIE.CODFILIALSS IS 'Cdigo da filial.';
COMMENT ON    COLUMN    LFSEQSERIE.SEQSERIE IS 'Sequencia da srie.';
COMMENT ON    COLUMN    LFSEQSERIE.DOCSERIE IS 'Nmero sequencia do documento.';
COMMENT ON    COLUMN    LFSEQSERIE.ATIVSERIE IS 'Define se a sequencia est ativa (S/N).';
COMMENT ON    COLUMN    LFSEQSERIE.DTINS IS 'Data de insero.';
COMMENT ON    COLUMN    LFSEQSERIE.HINS IS 'Hora de insero.';
COMMENT ON    COLUMN    LFSEQSERIE.IDUSUINS IS 'ID do usurio que inseriu.';
COMMENT ON    COLUMN    LFSEQSERIE.DTALT IS 'Data de alterao.';
COMMENT ON    COLUMN    LFSEQSERIE.HALT IS 'Hora de alterao.';
COMMENT ON    COLUMN    LFSEQSERIE.IDUSUALT IS 'ID do usurio que alterou.';
COMMENT ON TABLE        LFSITTRIB IS 'Tabela de situaes tributrias para os impostos:
PIS e Cofins.';
COMMENT ON    COLUMN    LFSITTRIB.IMPSITTRIB IS 'Imposto, pode ser: CO (Cofins),PI (PIS),IC (ICMS),IR (IMPOSTO DE RENDA),CS (Contribuio Social), IP (IPI), IS (ISS)';
COMMENT ON    COLUMN    LFSITTRIB.OPERACAO IS 'Operacao de (S) - Saida, (E) - Entrada';
COMMENT ON    COLUMN    LFTABICMS.UFTI IS 'Sigla do estado';
COMMENT ON    COLUMN    LFTABICMS.ALIQTI IS 'Aliquota de icms interestadual';
COMMENT ON    COLUMN    LFTABICMS.ALIQINTRATI IS 'Aliquota de icms intraestadual.';
COMMENT ON    COLUMN    LFTIPOFISCCLI.CALCCOFINSTF IS 'Indica se deve calcular o cofins.';
COMMENT ON    COLUMN    LFTIPOFISCCLI.CALCCSOCIALTF IS 'Indica se calcula a contribuio social.';
COMMENT ON    COLUMN    LFTIPOFISCCLI.CALCICMSTF IS 'Indica se calcula o ICMS.';
COMMENT ON    COLUMN    LFTIPOFISCCLI.CALCIPITF IS 'Indica se calcula o IPI.';
COMMENT ON    COLUMN    LFTIPOFISCCLI.CALCIRTF IS 'Indica se calcula o IR.';
COMMENT ON    COLUMN    LFTIPOFISCCLI.CALCISSTF IS 'Indica se calcula o iss.';
COMMENT ON    COLUMN    LFTIPOFISCCLI.CALCPISTF IS 'Indica se calcula o PIS.';
COMMENT ON    COLUMN    LFTIPOFISCCLI.IMPCOFINSTF IS 'Indica se imprime o cofins.';
COMMENT ON    COLUMN    LFTIPOFISCCLI.IMPCSOCIALTF IS 'indica se imprime a contribuio social.';
COMMENT ON    COLUMN    LFTIPOFISCCLI.IMPICMSTF IS 'indica se imprime o ICMS.';
COMMENT ON    COLUMN    LFTIPOFISCCLI.IMPISSTF IS 'indica se imprime o ISS.';
COMMENT ON    COLUMN    LFTIPOFISCCLI.IMPIPITF IS 'indica se imprime o IPI.';
COMMENT ON    COLUMN    LFTIPOFISCCLI.IMPIRTF IS 'indica se imprime o IR.';
COMMENT ON    COLUMN    LFTIPOFISCCLI.IMPPISTF IS 'indica se imprime o PIS.';
COMMENT ON    COLUMN    LFTIPOFISCCLI.CODEMPOC IS 'Cdigo da empresa para o tipo de movimento de oramento para o tipo fiscal de cliente.';
COMMENT ON    COLUMN    LFTIPOFISCCLI.CODFILIALOC IS 'Cdigo da filial para o tipo de movimento de oramento para o tipo fiscal de cliente.';
COMMENT ON    COLUMN    LFTIPOFISCCLI.CODTIPOMOVOC IS 'Cdigo do tipo de movimento de oramento para o tipo fiscal de cliente.';
COMMENT ON TABLE        LFTRATTRIB IS 'Tabela de tratamentos tributrios de ICMS.';
COMMENT ON TABLE        PPDISTRIB IS 'Distribuio da estrutura para mais de um produto final.';
COMMENT ON    COLUMN    PPDISTRIB.CODEMP IS 'Cdigo da empresa.';
COMMENT ON    COLUMN    PPDISTRIB.CODFILIAL IS 'Cdigo da filial.';
COMMENT ON    COLUMN    PPDISTRIB.CODPROD IS 'Cdigo do produto referente a estrutura.';
COMMENT ON    COLUMN    PPDISTRIB.SEQEST IS 'Nmero sequencial da estrutura.';
COMMENT ON    COLUMN    PPDISTRIB.SEQEF IS 'Sequencia da fase.';
COMMENT ON    COLUMN    PPDISTRIB.CODEMPFS IS 'Cdigo da empresa na tabela PPFASE.';
COMMENT ON    COLUMN    PPDISTRIB.CODFILIALFS IS 'Cdigo da filial na tabela PPFASE.';
COMMENT ON    COLUMN    PPDISTRIB.CODFASE IS 'Cdigo da fase.';
COMMENT ON    COLUMN    PPDISTRIB.SEQDE IS 'Sequencia da distribuio da estrutura.';
COMMENT ON    COLUMN    PPDISTRIB.CODEMPDE IS 'Cdigo da empresa para vnculo com estrutura usada para distribuio.';
COMMENT ON    COLUMN    PPDISTRIB.CODFILIALDE IS 'Cdigo da filial para estrutura de distribuio.';
COMMENT ON    COLUMN    PPDISTRIB.CODPRODDE IS 'Cdigo do produto para estrutura de distribuio.';
COMMENT ON    COLUMN    PPDISTRIB.SEQESTDE IS 'Nmero sequencial da estrutura de distribuio.';
COMMENT ON TABLE        PPESTRUANALISE IS 'Cadastro de etapas de analise e controle de qualidade, previstas para a estrutura de um produto.';
COMMENT ON    COLUMN    PPESTRUANALISE.CODEMP IS 'Cdigo da empresa.';
COMMENT ON    COLUMN    PPESTRUANALISE.CODFILIAL IS 'Cdigo da filial.';
COMMENT ON    COLUMN    PPESTRUANALISE.CODESTANALISE IS 'Cdigo da estrutra x analise.';
COMMENT ON    COLUMN    PPESTRUANALISE.CODPROD IS 'Cdigo do produto vinculado a estrutura.';
COMMENT ON    COLUMN    PPESTRUANALISE.SEQEST IS 'Sequncia da estrutura.';
COMMENT ON    COLUMN    PPESTRUANALISE.SEQEF IS 'Sequncia da estrutura x fase.';
COMMENT ON    COLUMN    PPESTRUANALISE.CODEMPFS IS 'Cdigo da emprea da estrutura x fase.';
COMMENT ON    COLUMN    PPESTRUANALISE.CODFILIALFS IS 'Cdigo da filial da estrutura x fase.';
COMMENT ON    COLUMN    PPESTRUANALISE.CODFASE IS 'Cdigo da fase.';
COMMENT ON    COLUMN    PPESTRUANALISE.CODEMPTA IS 'Cdigo da empresa do tipo de analise.';
COMMENT ON    COLUMN    PPESTRUANALISE.CODFILIALTA IS 'Cdigo da filial do tipo de analise.';
COMMENT ON    COLUMN    PPESTRUANALISE.CODTPANALISE IS 'Cdigo do tipo de anlise.';
COMMENT ON    COLUMN    PPESTRUANALISE.VLRMIN IS 'Valor mnimo de tolerncia.';
COMMENT ON    COLUMN    PPESTRUANALISE.VLRMAX IS 'Valor mximo de tolerncia.';
COMMENT ON    COLUMN    PPESTRUANALISE.ESPECIFICACAO IS 'Espessificao padro da anlise, utilizada quando a anlise  descritiva.';
COMMENT ON    COLUMN    PPESTRUANALISE.EMITCERT IS 'Indica se a analise deve sair no certificado de analises.';
COMMENT ON    COLUMN    PPESTRUANALISE.DTINS IS 'Data de insero do registro.';
COMMENT ON    COLUMN    PPESTRUANALISE.HINS IS 'Hora de insero do registro.';
COMMENT ON    COLUMN    PPESTRUANALISE.IDUSUINS IS 'Usurio que inseriu o registro.';
COMMENT ON    COLUMN    PPESTRUANALISE.DTALT IS 'Data de alterao do registro.';
COMMENT ON    COLUMN    PPESTRUANALISE.HALT IS 'Hora da ultima alterao no registro.';
COMMENT ON    COLUMN    PPESTRUANALISE.IDUSUALT IS 'Usurio que alterou o registro.';
COMMENT ON TABLE        PPESTRUFASE IS 'Vnculo estrutura, fase de produo e recursos de produo.
';
COMMENT ON    COLUMN    PPESTRUFASE.SEQEST IS 'Nmero sequencial da estrutura.';
COMMENT ON    COLUMN    PPESTRUFASE.FINALIZAOP IS 'Indica se a fase finaliza o processo de produo (S/N).';
COMMENT ON    COLUMN    PPESTRUFASE.INSTRUCOES IS 'Instrues da fase de produo para a estrutura.';
COMMENT ON TABLE        PPESTRUTURA IS 'Estrutura de produtos.';
COMMENT ON    COLUMN    PPESTRUTURA.SEQEST IS 'Nmero sequencial da estrutura.';
COMMENT ON    COLUMN    PPESTRUTURA.ATIVOEST IS 'Indica se a estrutura est ativa.(S/N)';
COMMENT ON    COLUMN    PPESTRUTURA.CODEMPML IS 'Cdigo da empresa para o modelo de lote.';
COMMENT ON    COLUMN    PPESTRUTURA.CODFILIALML IS 'Cdigo da filial do modelo de lote.';
COMMENT ON    COLUMN    PPESTRUTURA.CODMODLOTE IS 'Cdigo do modelo de lote.';
COMMENT ON    COLUMN    PPESTRUTURA.NRODIASVALID IS 'Nmero de dias de validade do produto fabricado.';
COMMENT ON    COLUMN    PPESTRUTURA.GLOTEOPP IS 'Flag que indica, se quando distribuido, produto gera codigo do lote a partir do produto da op principal.';
COMMENT ON    COLUMN    PPESTRUTURA.OBSERVACAO IS 'Observacoes sobre a estrutura.';
COMMENT ON    COLUMN    PPESTRUTURA.ESTDINAMICA IS 'Indica se a estrutura  dinmica.';
COMMENT ON TABLE        PPFASE IS 'Fases de produo
';
COMMENT ON    COLUMN    PPFASE.TIPOFASE IS '"EX" = Execuo;
"CQ" = Controle de qualidade;
"EB" = Embalagem.
';
COMMENT ON    COLUMN    PPFASE.EXTERNAFASE IS 'Indica se a fase  realizada externamente (terceirizao)
S - Sim
N - Nao
';
COMMENT ON TABLE        PPFOTOMTAN IS 'Fotos das caractersticas dos mtodos analticos.';
COMMENT ON    COLUMN    PPFOTOMTAN.CODMTANALISE IS 'Cdigo do mtodo analtico.';
COMMENT ON    COLUMN    PPFOTOMTAN.CODFOTOMTAN IS 'Cdigo da foto.';
COMMENT ON    COLUMN    PPFOTOMTAN.DESCFOTOMTAN IS 'Descrio da foto.';
COMMENT ON TABLE        PPITESTRUTURA IS 'tens de estrutura de produtos.';
COMMENT ON    COLUMN    PPITESTRUTURA.SEQEST IS 'Nmero sequencial da estrutura.';
COMMENT ON    COLUMN    PPITESTRUTURA.REFPROD IS 'Referencia do produto (estrutura)';
COMMENT ON    COLUMN    PPITESTRUTURA.REFPRODPD IS 'Referencia do produto (item).';
COMMENT ON    COLUMN    PPITESTRUTURA.SEQEF IS 'Sequencia da fase.';
COMMENT ON    COLUMN    PPITESTRUTURA.RMAAUTOITEST IS 'Flag para gerao de RMA automtica (S/N)';
COMMENT ON    COLUMN    PPITESTRUTURA.CPROVA IS 'Indica se o tem ser utilizado para reteno de contra-prova (controle de qualidade).';
COMMENT ON    COLUMN    PPITESTRUTURA.QTDVARIAVEL IS 'Indica se a quantidade varia em virtude da quantidade final produzida.';
COMMENT ON    COLUMN    PPITESTRUTURA.QTDFIXA IS 'Indica se a quantidade no deve ser multiplicada pela quantidade de itens de estrutura produzida.';
COMMENT ON    COLUMN    PPITESTRUTURA.PERMITEAJUSTEITEST IS 'Indica se deve permitir o ajuste da quantidade a ser utilizad na produo no momento da OP.
';
COMMENT ON    COLUMN    PPITESTRUTURA.TIPOEXTERNO IS 'Tipo de fluxo externo
E - Envio/Remessa
R - Retorno

';
COMMENT ON TABLE        PPITOP IS 'tens de ordens de produo.';
COMMENT ON    COLUMN    PPITOP.SEQOP IS 'Nmero sequencial da OP.';
COMMENT ON    COLUMN    PPITOP.REFPROD IS 'Referencia do produto.';
COMMENT ON    COLUMN    PPITOP.CODEMPLE IS 'Cdigo da empresa - lote
';
COMMENT ON    COLUMN    PPITOP.CODFILIALLE IS 'Cdigo da filial - Lote
';
COMMENT ON    COLUMN    PPITOP.CODLOTE IS 'Cdigo do lote
';
COMMENT ON    COLUMN    PPITOP.SEQITOPCP IS 'Sequncia do tem copiado (utilizado no rateamento automtico de lotes)';
COMMENT ON    COLUMN    PPITOP.CODLOTERAT IS 'Cdigo do lote rateado';
COMMENT ON    COLUMN    PPITOP.QTDCOPIAITOP IS 'Quantidade da inserida na cpia do item. Este valor dispara o trigger para criao da cpia.';
COMMENT ON    COLUMN    PPITOP.GERARMA IS 'Indica se deve gerar rma para o item. pode ser que no deva ser gerado por padro, ou por j ter sido gerado.';
COMMENT ON    COLUMN    PPITOP.SEQAC IS 'Sequencial da ao corretiva.';
COMMENT ON    COLUMN    PPITOP.BLOQOP IS 'Marca se item bloqueou op.';
COMMENT ON    COLUMN    PPITOP.PERMITEAJUSTEITOP IS 'Indica se deve permitir o ajuste de quantidades.
S/N
';
COMMENT ON    COLUMN    PPITOP.TIPOEXTERNO IS 'Tipo de fluxo externo
E - Envio/Remessa
R - Retorno';
COMMENT ON    COLUMN    PPITOP.CODEMPVD IS 'Cdigo da empresa da venda (remessa ou retorno industrializao);
';
COMMENT ON    COLUMN    PPITOP.CODFILIALVD IS 'Cdigo da filial da venda (remessa ou retorno industrializao);';
COMMENT ON    COLUMN    PPITOP.TIPOVENDA IS 'Tipo da venda (remessa ou retorno industrializao);';
COMMENT ON    COLUMN    PPITOP.CODVENDA IS 'Cdigo da venda (remessa ou retorno industrializao);';
COMMENT ON TABLE        PPMETODOANALISE IS 'Cadastro de mtodos de anlise.';
COMMENT ON    COLUMN    PPMETODOANALISE.DESCMTANALISE IS 'Descrio do tipo de anlise.';
COMMENT ON    COLUMN    PPMETODOANALISE.TITULOANALISE IS 'Ttulo do mtodo analtico.';
COMMENT ON    COLUMN    PPMETODOANALISE.FONTEMTANALISE IS 'Fonte do mtodo analtico.';
COMMENT ON    COLUMN    PPMETODOANALISE.MATANALISE IS 'Material utilizado para a anlise.';
COMMENT ON    COLUMN    PPMETODOANALISE.REAGANALISE IS 'Reagente da anlise.';
COMMENT ON    COLUMN    PPMETODOANALISE.PROCANALISE IS 'Procedimentos';
COMMENT ON    COLUMN    PPMETODOANALISE.DTINS IS 'Data de insero do registro.';
COMMENT ON    COLUMN    PPMETODOANALISE.HINS IS 'Hora da insero do registro.';
COMMENT ON    COLUMN    PPMETODOANALISE.IDUSUINS IS 'Usurio que inseriu o registro';
COMMENT ON    COLUMN    PPMETODOANALISE.DTALT IS 'Data da ultima alterao do registro.';
COMMENT ON    COLUMN    PPMETODOANALISE.HALT IS 'Hora da ultima alterao no registro.';
COMMENT ON    COLUMN    PPMETODOANALISE.IDUSUALT IS 'Usurio que realizou a ultima alterao no registro.';
COMMENT ON TABLE        PPOP IS 'Ordens de produo.';
COMMENT ON    COLUMN    PPOP.CODOP IS 'Cdigo da ordem de produo.';
COMMENT ON    COLUMN    PPOP.SEQOP IS 'Nmero sequencial da OP.';
COMMENT ON    COLUMN    PPOP.DTEMITOP IS 'Data de emisso
';
COMMENT ON    COLUMN    PPOP.CODEMPPD IS 'Cdigo da empresa do produto acabado.';
COMMENT ON    COLUMN    PPOP.CODFILIALPD IS 'Cdigo da filial do produto acabado.';
COMMENT ON    COLUMN    PPOP.CODPROD IS 'Cdigo do produto acabado.';
COMMENT ON    COLUMN    PPOP.SEQEST IS 'Numero sequencial da estrutura.';
COMMENT ON    COLUMN    PPOP.REFPROD IS 'Referencia do produto acabado.';
COMMENT ON    COLUMN    PPOP.DTFABROP IS 'Data de fabricao do produto acabado.';
COMMENT ON    COLUMN    PPOP.QTDSUGPRODOP IS 'Quantidade final sugerida de produo.';
COMMENT ON    COLUMN    PPOP.QTDPREVPRODOP IS 'Quantidade prevista a ser produzida.';
COMMENT ON    COLUMN    PPOP.QTDFINALPRODOP IS 'Quantidade realmente produzida.';
COMMENT ON    COLUMN    PPOP.QTDDISTPOP IS 'Quantidade distribuda referente a OP principal.';
COMMENT ON    COLUMN    PPOP.QTDDISTIOP IS 'Quantidade distribuda referente a OP de distribuio.';
COMMENT ON    COLUMN    PPOP.DTVALIDPDOP IS 'Data de validade do lote do produto acabado.';
COMMENT ON    COLUMN    PPOP.CODEMPLE IS 'Cdigo da empresa do lote do produto acabado.';
COMMENT ON    COLUMN    PPOP.CODFILIALLE IS 'Cdigo da filial do lote do produto acabado.';
COMMENT ON    COLUMN    PPOP.CODLOTE IS 'Cdigo do Lote para o produto acabado.';
COMMENT ON    COLUMN    PPOP.CODEMPTM IS 'Cdigo da empresa do tipo de movimento.';
COMMENT ON    COLUMN    PPOP.CODFILIALTM IS 'Cdigo da filial do tipo de movimento.';
COMMENT ON    COLUMN    PPOP.CODTIPOMOV IS 'Cdigo do tipo de movimento.';
COMMENT ON    COLUMN    PPOP.CODEMPAX IS 'Cdigo da empresa do almoxarifado.';
COMMENT ON    COLUMN    PPOP.CODFILIALAX IS 'Codigo da filial do almoxarifado.';
COMMENT ON    COLUMN    PPOP.CODALMOX IS 'Cdigo do almoxarifado';
COMMENT ON    COLUMN    PPOP.CODEMPOPM IS 'Cdigo da empresa da ordem de produo mestre (principal).';
COMMENT ON    COLUMN    PPOP.CODFILIALOPM IS 'Cdigo da filial da ordem de produo mestre (principal).';
COMMENT ON    COLUMN    PPOP.CODOPM IS 'Cdigo da ordem de produo mestre (principal).';
COMMENT ON    COLUMN    PPOP.SEQOPM IS 'Sequencial da ordem de produo mestre (principal).';
COMMENT ON    COLUMN    PPOP.SITOP IS 'Situao da OP.
PE - Pendente;
CA - Cancelada;
FN - Finalizada;
BL - Bloqueada;';
COMMENT ON    COLUMN    PPOP.OBSOP IS 'Campo para observaes a cerca da ordem de produo.';
COMMENT ON    COLUMN    PPOP.JUSTFICQTDPROD IS 'Justificativa pela divergencia entre quantidade prevista e quantidade produzida.';
COMMENT ON    COLUMN    PPOP.JUSTIFICCANC IS 'Justificativa relativa ao cancelamento da OP.';
COMMENT ON    COLUMN    PPOP.DTCANC IS 'Data e hora do cancelamento da O.P.';
COMMENT ON    COLUMN    PPOP.IDUSUCANC IS 'Id do usurio que cancelou a O.P.';
COMMENT ON    COLUMN    PPOP.HCANC IS 'Hora do cancelamento da O.P.';
COMMENT ON    COLUMN    PPOP.CODEMPCP IS 'Cdigo da empresa do item de compra vinculado  OP (converso de produtos)';
COMMENT ON    COLUMN    PPOP.CODFILIALCP IS 'Cdigo da filial do item de compra vinculado  OP (converso de produtos)';
COMMENT ON    COLUMN    PPOP.CODCOMPRA IS 'Cdigo da compra do item vinculado  OP (converso de produtos)';
COMMENT ON    COLUMN    PPOP.CODITCOMPRA IS 'Cdigo do item de compra vinculado  OP (converso de produtos)';
COMMENT ON    COLUMN    PPOP.ESTDINAMICA IS 'Indica se a ordem de produo deve utilizar o mecanismo de estruturas dinmicas.';
COMMENT ON    COLUMN    PPOP.GARANTIA IS 'Indica se a ordem de produo e proveniente de garantia.';
COMMENT ON    COLUMN    PPOP.CODEMPOS IS 'Cdigo da empresa da Ordem de servio vinculada.';
COMMENT ON    COLUMN    PPOP.CODFILIALOS IS 'Cdigo da filial da ordem de servio vinculada.';
COMMENT ON    COLUMN    PPOP.TICKET IS 'Ticket da ordem de servio vinculada.';
COMMENT ON    COLUMN    PPOP.CODITRECMERC IS 'Cdigo do item de recebimento da OS vinculada.';
COMMENT ON    COLUMN    PPOP.CODITOS IS 'Cdigo do item da OS vinculada.';
COMMENT ON    COLUMN    PPOP.DTINS IS 'Data de insero do registro.';
COMMENT ON    COLUMN    PPOP.HINS IS 'Hora de insero do registro.';
COMMENT ON    COLUMN    PPOP.IDUSUINS IS 'ID do usurio que inseriu o registro.';
COMMENT ON    COLUMN    PPOP.DTALT IS 'Data da ltima alterao no registro.';
COMMENT ON    COLUMN    PPOP.HALT IS 'Hora da ltima alterao no registro.';
COMMENT ON    COLUMN    PPOP.IDUSUALT IS 'Id do usurio que realizou a ultima alterao no registro.';
COMMENT ON TABLE        PPOPACAOCORRET IS 'Cadastro de aes corretivas.';
COMMENT ON    COLUMN    PPOPACAOCORRET.TPCAUSA IS 'Tipo de causas fundamentais:
"1M" - Material;
"2M" - Mquina;
"3M" - Mtodo;
"4M" - Meio ambiente;
"5M" - Mo-de-obra;
"6M" - Medida;


';
COMMENT ON    COLUMN    PPOPACAOCORRET.TPACAO IS 'Tipo de ao corretiva pr-definida:
"II" - Incluso de insumos;
"DP" - Descarte da produo;';
COMMENT ON TABLE        PPOPCQ IS 'Cadastros de lanamento de resultados de anlises de controle de qualidade.';
COMMENT ON    COLUMN    PPOPCQ.CODEMP IS 'Cdigo da empresa.';
COMMENT ON    COLUMN    PPOPCQ.CODFILIAL IS 'Cdigo da filial.';
COMMENT ON    COLUMN    PPOPCQ.CODOP IS 'Cdigo da ordem de produo.';
COMMENT ON    COLUMN    PPOPCQ.SEQOP IS 'Sequncia da ordem de produo.';
COMMENT ON    COLUMN    PPOPCQ.SEQOPCQ IS 'Sequncia do controle de qualidade.';
COMMENT ON    COLUMN    PPOPCQ.SEQAC IS 'Sequencial da ao corretiva para o problema detectado.';
COMMENT ON    COLUMN    PPOPCQ.CODEMPEA IS 'Cdigo da empresa da estrutura x analise.';
COMMENT ON    COLUMN    PPOPCQ.CODFILIALEA IS 'Cdigo da filial da estrutura x analise.';
COMMENT ON    COLUMN    PPOPCQ.CODESTANALISE IS 'Cdigo da estrutura x analise.';
COMMENT ON    COLUMN    PPOPCQ.SEQEF IS 'Sequencial da fase na estrutura.
';
COMMENT ON    COLUMN    PPOPCQ.VLRAFER IS 'Valor da aferio.';
COMMENT ON    COLUMN    PPOPCQ.DESCAFER IS 'Descritivo da aferio.';
COMMENT ON    COLUMN    PPOPCQ.STATUS IS 'Status da anlise de controle de qualidade.
"PE" - Pendente;
"AP" - Aprovado;
"RC" - Recusado;
"CO" - Corrigido.';
COMMENT ON    COLUMN    PPOPCQ.DTINS IS 'Data de insero do registro.';
COMMENT ON    COLUMN    PPOPCQ.HINS IS 'Hora de insero do registro.';
COMMENT ON    COLUMN    PPOPCQ.IDUSUINS IS 'Usurio que inseriu o registro.';
COMMENT ON    COLUMN    PPOPCQ.DTALT IS 'Data de alterao no registro.';
COMMENT ON    COLUMN    PPOPCQ.HALT IS 'Hora de alterao do registro.';
COMMENT ON    COLUMN    PPOPCQ.IDUSUALT IS 'Usurio que alterou o registro.';
COMMENT ON    COLUMN    PPOPENTRADA.DTENT IS 'Data da entrada.';
COMMENT ON    COLUMN    PPOPENTRADA.HENT IS 'Hora da entrada.';
COMMENT ON TABLE        PPOPFASE IS 'Vnculo OP x Fase
';
COMMENT ON    COLUMN    PPOPFASE.SEQOP IS 'Nmero sequencial da OP.';
COMMENT ON    COLUMN    PPOPFASE.CODEMPTR IS 'Cdigo da empresa para tabela de tipos de recurso.';
COMMENT ON    COLUMN    PPOPFASE.CODFILIALTR IS 'Cdigo da filial para tabela de tipos de recurso.';
COMMENT ON    COLUMN    PPOPFASE.CODTPREC IS 'Cdigo do tipo de recurso.';
COMMENT ON    COLUMN    PPOPFASE.DATAINIPRODFS IS 'Data de inicio da produo da fase.';
COMMENT ON    COLUMN    PPOPFASE.HINIPRODFS IS 'Hora de inicio da produo da fase.';
COMMENT ON    COLUMN    PPOPFASE.DATAFIMPRODFS IS 'Data de termino da produo da fase.';
COMMENT ON    COLUMN    PPOPFASE.HFIMPRODFS IS 'Hora final da produo da fase.';
COMMENT ON    COLUMN    PPOPFASE.OBSFS IS 'Observaes referentes a fase de produo.';
COMMENT ON    COLUMN    PPOPFASE.SITFS IS 'Indica se da fase est pendente ou finalizada.
"PE" - Pendente
"FN" - Finalizada';
COMMENT ON    COLUMN    PPOPITORC.QTDPROD IS 'Quantidade do item de oramento que dever ser produzida nessa OP. (previso)';
COMMENT ON    COLUMN    PPOPITORC.QTDFINALPRODITORC IS 'Quantidade final produzida para atendimento a este tem de oramento.
';
COMMENT ON TABLE        PPOPSUBPROD IS 'Tabela para lanamento de sub-produtos em ordens de produo.';
COMMENT ON    COLUMN    PPOPSUBPROD.SEQOF IS 'Sequencial da fase
';
COMMENT ON    COLUMN    PPOPSUBPROD.CODEMPTM IS 'Cdigo da empresa do tipo de movimento.';
COMMENT ON    COLUMN    PPOPSUBPROD.CODFILIALTM IS 'Cdigo da filial do tipo de movimento';
COMMENT ON    COLUMN    PPOPSUBPROD.CODTIPOMOV IS 'Cdigo do tipo de movimento.';
COMMENT ON    COLUMN    PPOPSUBPROD.DTSUBPROD IS 'Data para entrada da subproducao (finalizao da fase)
';
COMMENT ON TABLE        PPPROCESSAOPTMP IS 'Tabela temporria para gerao de ordens de produo com base em oramentos.';
COMMENT ON    COLUMN    PPPROCESSAOPTMP.CODEMPET IS 'Cdigo da empresa da estao de trabalho.';
COMMENT ON    COLUMN    PPPROCESSAOPTMP.CODFILIALET IS 'Cdiga da filial da estao de trabalho.';
COMMENT ON    COLUMN    PPPROCESSAOPTMP.CODEST IS 'Cdigo da estao de trabalho.';
COMMENT ON TABLE        PPRECURSO IS 'Recursos de produo
';
COMMENT ON TABLE        PPRETCP IS 'Reteno de contra-provas (controle de qualidade).';
COMMENT ON TABLE        PPTIPOANALISE IS 'Tabela para cadastro dos tipos de anlise de controle de qualidade.';
COMMENT ON    COLUMN    PPTIPOANALISE.CODEMP IS 'Cdigo da empresa.';
COMMENT ON    COLUMN    PPTIPOANALISE.CODFILIAL IS 'Cdigo da filial.';
COMMENT ON    COLUMN    PPTIPOANALISE.CODTPANALISE IS 'Cdigo do tipo de anlise.';
COMMENT ON    COLUMN    PPTIPOANALISE.DESCTPANALISE IS 'Descrio do tipo de anlise.';
COMMENT ON    COLUMN    PPTIPOANALISE.OBSTPANALISE IS 'Observao relativa ao tipo de anlise, pode descrever o mtodo de anlise, instrues de coleta e/ou aferio, etc...';
COMMENT ON    COLUMN    PPTIPOANALISE.TIPOEXPEC IS 'Tipo de registro de especificaes.
"MM" - Mnimo e mximo;
"DT" - Descritivo.';
COMMENT ON    COLUMN    PPTIPOANALISE.CODEMPUD IS 'Cdigo da empresa da unidade.';
COMMENT ON    COLUMN    PPTIPOANALISE.CODFILIALUD IS 'Cdigo da filial da unidade.';
COMMENT ON    COLUMN    PPTIPOANALISE.CODUNID IS 'Cdigo da unidade de medida da anlise.';
COMMENT ON    COLUMN    PPTIPOANALISE.CODEMPMA IS 'Cdigo da empresa do mtodo analtico.';
COMMENT ON    COLUMN    PPTIPOANALISE.CODFILIALMA IS 'Cdigo da filial do mtodo analtico.';
COMMENT ON    COLUMN    PPTIPOANALISE.CODMTANALISE IS 'Cdigo do mtodo analtico.';
COMMENT ON    COLUMN    PPTIPOANALISE.DTINS IS 'Data de insero do registro.';
COMMENT ON    COLUMN    PPTIPOANALISE.HINS IS 'Hora de insero do registro.';
COMMENT ON    COLUMN    PPTIPOANALISE.IDUSUINS IS 'Usurio que inseriu o registro.';
COMMENT ON    COLUMN    PPTIPOANALISE.DTALT IS 'Data da alterao no registro.';
COMMENT ON    COLUMN    PPTIPOANALISE.HALT IS 'Hora da alterao no registro.';
COMMENT ON    COLUMN    PPTIPOANALISE.IDUSUALT IS 'Usurio que alterou o registro.';
COMMENT ON TABLE        PPTIPOREC IS 'Tipos de recurso de produo.
';
COMMENT ON    COLUMN    PVCAIXA.CODEMPET IS 'Cdigo da empresa na tabela de estao de trabalho.';
COMMENT ON    COLUMN    PVCAIXA.CODFILIALET IS 'Cdigo da filial na tabela de estaes de trabalho.';
COMMENT ON    COLUMN    PVCAIXA.CODEST IS 'Cdigo da estao de trabalho.';
COMMENT ON    COLUMN    PVCAIXA.SEQINI IS 'FAIXA INICIAL PARA SEQUENCIA DE VENDA DE ECF';
COMMENT ON    COLUMN    PVCAIXA.SEQMAX IS 'FAIXA FINAL PARA SEQUENCIA DE VENDA DE ECF';
COMMENT ON    COLUMN    PVCAIXA.ORCCAIXA IS 'Habilita a venda para pdv somente com oramento.';
COMMENT ON TABLE        RHAREA IS 'Areas de negcio para cursos e vagas mdulo RH (Recrutamento e seleo).';
COMMENT ON    COLUMN    RHAREA.CODAREA IS 'Cdigo da rea.';
COMMENT ON TABLE        RHBENEFICIO IS 'Cadastro de benefcios.';
COMMENT ON TABLE        RHCANDIDATO IS 'Cadastro de candidatos a vaga para uso no mdulo de recrutamento e seleo.';
COMMENT ON    COLUMN    RHCANDIDATO.UFCAND IS 'Unidade federativa do candidato.';
COMMENT ON    COLUMN    RHCANDIDATO.OUTROSEMPREGOS IS 'Outros empregos.';
COMMENT ON    COLUMN    RHCANDIDATO.CODEMPES IS 'Cdigo da empresa do estado civil.';
COMMENT ON    COLUMN    RHCANDIDATO.CODFILIALES IS 'Cdigo da filial do estado civil.';
COMMENT ON    COLUMN    RHCANDIDATO.CODESTCIVIL IS 'Cdigo do estado civil.';
COMMENT ON    COLUMN    RHCANDIDATO.PRETENSAOSAL IS 'Pretenso salarial.';
COMMENT ON    COLUMN    RHCANDIDATO.STCAND IS 'Status do candidato:
"IN" - Inativo;
"DI" - Disponvel;
"EN" - Encaminhado;
"EL" - Eliminado de processo seletivo;
"EF" - Efetivado;
"EM" - Empregado;
"EV" - Entrevistado;
"DL" - Desligado;';
COMMENT ON    COLUMN    RHCANDIDATO.OBSCAND IS 'Observaes do candidato.';
COMMENT ON    COLUMN    RHCANDIDATO.NROFILHOS IS 'Nmero de filhos.';
COMMENT ON    COLUMN    RHCANDIDATO.ISENCTRANSP IS 'Indica se candidato  isento de tarifa de transporte - S/N';
COMMENT ON TABLE        RHCANDIDATOCARAC IS 'Tabela de vinculo entre candidatos e suas caracteristicas.';
COMMENT ON TABLE        RHCANDIDATOCURSO IS 'Tabela de vinculo entre candidatos e cursos.';
COMMENT ON TABLE        RHCANDIDATOFUNC IS 'Tabela de vinculo entre candidatos e funcoes exercidas.';
COMMENT ON TABLE        RHCANDIDATOSTATUS IS 'Tabela de histrico dos status do candidato.';
COMMENT ON    COLUMN    RHCANDIDATOSTATUS.DTSTATUS IS 'Data do status.';
COMMENT ON TABLE        RHCARACTERISTICA IS 'Cadastro de caracteristicas pessoais.';
COMMENT ON TABLE        RHCURSO IS 'Cadastro de cursos para utilizao no mdulo de RH (Recrutamento e seleo).';
COMMENT ON    COLUMN    RHCURSO.DESCCURSO IS 'Descrio do curso.';
COMMENT ON    COLUMN    RHCURSO.CONTPROGCURSO IS 'Contedo programtico do curso.';
COMMENT ON    COLUMN    RHCURSO.INSTITUICAOCURSO IS 'Instituio de ensino onde foi realizado o curso.';
COMMENT ON    COLUMN    RHCURSO.DURACAOCURSO IS 'Durao do curso (em meses).';
COMMENT ON    COLUMN    RHCURSO.CODAREA IS 'Cdigo da rea ';
COMMENT ON    COLUMN    RHCURSO.CODEMPAR IS 'Cdigo da empresa da rea.';
COMMENT ON    COLUMN    RHCURSO.CODFILIALAR IS 'Cdigo da filial da rea.';
COMMENT ON    COLUMN    RHCURSO.CODNIVELCURSO IS 'Nvel do curso';
COMMENT ON    COLUMN    RHCURSO.CODEMPNC IS 'Cdigo da empresa do nvel do curso.';
COMMENT ON    COLUMN    RHCURSO.CODFILIALNC IS 'Cdigo da filial do nvel do curso.';
COMMENT ON TABLE        RHDEPTO IS 'Cadastro de departamentos.';
COMMENT ON TABLE        RHEMPREGADO IS 'Cadastro de empregados.';
COMMENT ON    COLUMN    RHEMPREGADO.APELIDOEMPR IS 'Nome reduzido ou apelido para uso no cracha do empregado.';
COMMENT ON    COLUMN    RHEMPREGADO.DTADMISSAO IS 'Data de admisso do empregado.';
COMMENT ON    COLUMN    RHEMPREGADO.FOTOEMPR IS 'Foto do empregado.';
COMMENT ON    COLUMN    RHEMPREGADO.STATUSEMPR IS 'Status do empregado
"AD" - Admitido;
"DE" - Demitido;
"EF" - Em frias;
"LM" - Licena maternidade;
"AI" - Afastamento INSS;
"AP" - Aposentado;';
COMMENT ON    COLUMN    RHEMPREGADO.SEXOEMPR IS 'Sexo do empregado';
COMMENT ON    COLUMN    RHEMPREGADO.DTNASCEMPR IS 'Data de nascimento do empregado.';
COMMENT ON    COLUMN    RHEMPREGADO.CTPSEMPR IS 'Identificao da Carteira de Trabalho e Previdncia Social.';
COMMENT ON    COLUMN    RHEMPREGADO.SERIECTPSEMPR IS 'Srie da carteira de trabalho e previdncia social.';
COMMENT ON    COLUMN    RHEMPREGADO.UFCTPSEMPR IS 'Estado de emisso da carteira de trabalho e previdncia social.';
COMMENT ON    COLUMN    RHEMPREGADO.CERTRESERVEMPR IS 'Certificado de reservista (Exrcito)';
COMMENT ON    COLUMN    RHEMPREGADO.PISPASEPEMPR IS 'PIS PASEP do empregado.';
COMMENT ON    COLUMN    RHEMPREGADO.RGEMPR IS 'RG do empregado.';
COMMENT ON    COLUMN    RHEMPREGADO.ORGEXPRHEMPR IS 'Orgo de expedio do RG do Empregado.';
COMMENT ON    COLUMN    RHEMPREGADO.CPFEMPR IS 'CPF do Empregado.';
COMMENT ON    COLUMN    RHEMPREGADO.UFRGEMPR IS 'Estado de expedio do RG.';
COMMENT ON    COLUMN    RHEMPREGADO.DTEXPRGEMPR IS 'Data de expedio do RG.';
COMMENT ON    COLUMN    RHEMPREGADO.TITELEITEMPR IS 'Titulo de eleitor.';
COMMENT ON    COLUMN    RHEMPREGADO.ZONAELEITEMPR IS 'Zona eleitoral do empregado.';
COMMENT ON    COLUMN    RHEMPREGADO.SECAOELEITEMPR IS 'Secao eleitoral do empregado.';
COMMENT ON    COLUMN    RHEMPREGADO.CNHEMPR IS 'Carteira nacional de habilitao do empregado.';
COMMENT ON    COLUMN    RHEMPREGADO.MAEEMPR IS 'Nome da me do empregado.';
COMMENT ON    COLUMN    RHEMPREGADO.PAIEMPR IS 'Nome do pai do empregado.';
COMMENT ON    COLUMN    RHEMPREGADO.COMPLENDEMPR IS 'Complemento do endereo do empregado.';
COMMENT ON    COLUMN    RHEMPREGADO.UFEMPR IS 'Estado do empregado (Endereo).';
COMMENT ON    COLUMN    RHEMPREGADO.DTDEMISSAOEMPR IS 'Data de demisso do empregado.';
COMMENT ON    COLUMN    RHEMPREGADO.DDDEMPR IS 'DDD do telefone do cliente.';
COMMENT ON    COLUMN    RHEMPREGADO.FONE2EMPR IS 'Segundo telefone do empregado.';
COMMENT ON    COLUMN    RHEMPREGADO.CELEMPR IS 'Telefone celular do empregado.';
COMMENT ON    COLUMN    RHEMPREGADO.EMAILEMPR IS 'Email do empregado.';
COMMENT ON TABLE        RHEMPREGADOBENEF IS 'Tabela de vnculos entre empregados e seus benefcios.';
COMMENT ON TABLE        RHEMPREGADOR IS 'Cadastro de empregadores conveniados para mdulo de recrutamento e seleo.';
COMMENT ON    COLUMN    RHEMPREGADOR.NOMEEMPR IS 'Nome do empregador conveniado.';
COMMENT ON    COLUMN    RHEMPREGADOR.ATIVOEMPR IS 'Indica se empregador est (A) ativo ou inativo (I).';
COMMENT ON    COLUMN    RHEMPREGADOR.CNPJEMPR IS 'CNPJ do empregador conveniado.';
COMMENT ON    COLUMN    RHEMPREGADOR.INSCEMPR IS 'Inscrio estadual do empregador conveniado.';
COMMENT ON    COLUMN    RHEMPREGADOR.ENDEMPR IS 'Endereo do empregador conveniado.';
COMMENT ON    COLUMN    RHEMPREGADOR.NUMEMPR IS 'Nmero do endereo do empregador conveniado.';
COMMENT ON TABLE        RHEMPREGADOSAL IS 'Table de histrio salarial do empregado.';
COMMENT ON    COLUMN    RHEMPREGADOSAL.VALORSAL IS 'Valor do salrio mensal.';
COMMENT ON    COLUMN    RHEMPREGADOSAL.CUSTOHORATRAB IS 'Custo da hora trabalhada.';
COMMENT ON    COLUMN    RHEMPREGADOSAL.DTVIGOR IS 'Data de vigor do novo salrio.';
COMMENT ON    COLUMN    RHEMPREGADOSAL.OBSSAL IS 'Observaes a respeito do salrio.';
COMMENT ON TABLE        RHFUNCAO IS 'Tabela de funes profissionais.';
COMMENT ON    COLUMN    RHFUNCAO.CBOFUNC IS 'Cdigo brasileiro de ocupaes (CBO)';
COMMENT ON TABLE        RHNIVELCURSO IS 'Cadastro dos nveis dos cursos do mdulo de RH (Recrutamento e seleo).';
COMMENT ON TABLE        RHPONTO IS 'Tabela para registro do ponto dos funcionrios.';
COMMENT ON    COLUMN    RHTABELAIRRF.DEDUCAO IS 'Deduo';
COMMENT ON TABLE        RHTURNO IS 'Tabela de turnos.';
COMMENT ON    COLUMN    RHTURNO.DESCTURNO IS 'Descrio do turno.';
COMMENT ON    COLUMN    RHTURNO.NHSTURNO IS 'Nmero de horas semanais.';
COMMENT ON    COLUMN    RHTURNO.TIPOTURNO IS 'Tipo de turno:
N - Normal (Manh e tarde)
M - Manh
T - Tarde
O - Noite
E - Especial
';
COMMENT ON    COLUMN    RHTURNO.HINITURNO IS 'Hora inicial do turno.';
COMMENT ON    COLUMN    RHTURNO.HFIMTURNO IS 'Hora final do turno.';
COMMENT ON    COLUMN    RHTURNO.HINIINTTURNO IS 'Hora inicial do intervalo.';
COMMENT ON    COLUMN    RHTURNO.HFIMINTTURNO IS 'Hora final do intervalo.';
COMMENT ON    COLUMN    RHTURNO.TOLENTRADA IS 'Tolerncia na entrada (minutos).';
COMMENT ON    COLUMN    RHTURNO.TOLSAIDA IS 'Tolerncia na sada (minutos).';
COMMENT ON TABLE        RHVAGA IS 'Cadastro de vagas de emprego.';
COMMENT ON    COLUMN    RHVAGA.CODVAGA IS 'Cdigo da vaga.';
COMMENT ON    COLUMN    RHVAGA.CODEMPR IS 'Cdigo do empregador.';
COMMENT ON    COLUMN    RHVAGA.CODFUNC IS 'Cdigo da funo.';
COMMENT ON    COLUMN    RHVAGA.CODEMPTN IS 'Cdigo da empresa do turno.';
COMMENT ON    COLUMN    RHVAGA.CODFILIALTN IS 'Cdigo da filial do turno.';
COMMENT ON    COLUMN    RHVAGA.CODTURNO IS 'Cdigo do turno.';
COMMENT ON    COLUMN    RHVAGA.STVAGA IS 'Status da vaga:
"AB" - Aberta;
"SL" - Em processo de seleo;
"CA" - Cancelada;
"PR" - Preenchida;';
COMMENT ON    COLUMN    RHVAGA.DTULTST IS 'Data do ultimo status.';
COMMENT ON TABLE        RHVAGACANDIDATO IS 'Tabela de vnculo entre vaga e candidatos.';
COMMENT ON    COLUMN    RHVAGACANDIDATO.STVAGACAND IS 'Situao do candidato na vaga:
"EN" Encaminhado
"EF" Efetivado ';
COMMENT ON TABLE        RHVAGACARACQUALI IS 'Tabela de relacionamento entre vagas e caracteristicas qualificativas.';
COMMENT ON TABLE        RHVAGACARACREST IS 'Tabela de relacionamento entre vagas e atribuies restritivas.';
COMMENT ON TABLE        RHVAGACURSO IS 'Tabela de vnculo entre vagas e cursos.';
COMMENT ON TABLE        RHVAGASTATUS IS 'Tabela histrica dos status das vagas.';
COMMENT ON    COLUMN    RHVAGASTATUS.CODVAGA IS 'Cdigo da vaga.';
COMMENT ON    COLUMN    RHVAGASTATUS.SQSTVAGA IS 'Sequencial do status da vaga.';
COMMENT ON    COLUMN    RHVAGASTATUS.STVAGA IS 'Status da vaga:
""AB"" - Aberta;
""SL"" - Em processo de seleo;
""CA"" - Cancelada;
""PR"" - Preenchida;';
COMMENT ON    COLUMN    RHVAGASTATUS.DTSTATUS IS 'Data do ustatus.';
COMMENT ON    COLUMN    SGAGENDA.TIPOAGE IS 'Tipo do agente.';
COMMENT ON    COLUMN    SGAGENDA.CODAGE IS 'Cdigo do agente.';
COMMENT ON    COLUMN    SGAGENDA.SITAGD IS 'Status do agendamento:
"PE" - Pendente;
"CA" - Cancelado;
"FN" - Finalizado;';
COMMENT ON    COLUMN    SGAGENDA.CODAGEEMIT IS 'Cdigo do agente criador do agendamento';
COMMENT ON    COLUMN    SGAGENDA.CAAGD IS 'Controle de acesso ao agendamento
"PU" - publico
"PR" - privado
';
COMMENT ON    COLUMN    SGAGENDA.CODTIPOAGD IS 'Cdigo do tipo de agendamento.';
COMMENT ON    COLUMN    SGAGENDA.CODEMPAR IS 'Cdigo da empresa do agendamento vinculado (repetitivos).';
COMMENT ON    COLUMN    SGAGENDA.CODFILIALAR IS 'Cdigo da filial do agendamento vinculado (repetitivos).';
COMMENT ON    COLUMN    SGAGENDA.TIPOAGEAR IS 'Cdigo da tipo do agendamento vinculado (repetitivos).';
COMMENT ON    COLUMN    SGAGENDA.CODAGEAR IS 'Cdigo do agente do agendamento vinculado (repetitivos).';
COMMENT ON    COLUMN    SGAGENDA.CODAGDAR IS 'Cdigo do agendamento vinculado (repetitivos).';
COMMENT ON    COLUMN    SGAGENDA.DIATODO IS 'Indica se compromisso ocupar o dia inteiro.';
COMMENT ON TABLE        SGAGENTE IS 'Tabela de pessoas, recursos e outros para os quais podemos agendar tarefas.';
COMMENT ON    COLUMN    SGAGENTE.CODEMP IS 'Cdigo da empresa
';
COMMENT ON    COLUMN    SGAGENTE.CODFILIAL IS 'Cdigo da filial';
COMMENT ON    COLUMN    SGAGENTE.TIPOAGE IS 'Tipo do agente:
SGUSU - Usurio
';
COMMENT ON    COLUMN    SGAGENTE.CODAGE IS 'Cdigo do agente.';
COMMENT ON    COLUMN    SGAGENTE.DESCAGE IS 'Descrio ou nome do agente.';
COMMENT ON    COLUMN    SGATRIBUSU.DTINS IS 'Data de insero.';
COMMENT ON    COLUMN    SGATRIBUSU.HINS IS 'Hora de insero.';
COMMENT ON    COLUMN    SGATRIBUSU.IDUSUINS IS 'ID do usurio que inseriu.';
COMMENT ON    COLUMN    SGATRIBUSU.DTALT IS 'Data da ltima alterao.';
COMMENT ON    COLUMN    SGATRIBUSU.HALT IS 'Hora da ltima alterao.';
COMMENT ON    COLUMN    SGATRIBUSU.IDUSUALT IS 'ID do ltimo usurio que alterou.';
COMMENT ON TABLE        SGBAIRRO IS 'Tabela de cadastro de bairros.';
COMMENT ON    COLUMN    SGBAIRRO.VLRFRETE IS 'Valor de frete estimado para carga vinda deste bairro.';
COMMENT ON    COLUMN    SGBAIRRO.QTDFRETE IS 'Quantidade referente ao valor de frete.';
COMMENT ON TABLE        SGCNAE IS 'Tabela de atividades padro CNAE.';
COMMENT ON    COLUMN    SGEMPRESA.MULTIALMOXEMP IS 'Flag que indica se o estoque ser controlado por multiplos almoxarifados.';
COMMENT ON    COLUMN    SGEMPRESA.PERCISSEMP IS 'Campo inutilizado (transferncia para a tabela SGFILIAL)';
COMMENT ON    COLUMN    SGEMPRESA.CODPAISEMP IS 'Campo inutilizado (transferncia para a tabela SGPAIS)';
COMMENT ON    COLUMN    SGESTACAO.MODODEMOEST IS 'Indica se a estao est em modo demonstrativo.';
COMMENT ON    COLUMN    SGESTACAO.NFEEST IS 'Habilita NFE para estao de trabalho (S/N).';
COMMENT ON    COLUMN    SGESTACAO.TAMFONTETXT IS 'Tamanho da fonte para visualizao dos relatrios texto.';
COMMENT ON    COLUMN    SGESTACAO.FONTETXT IS 'Nome da fonte para visualizao dos relatrios texto.';
COMMENT ON    COLUMN    SGESTACAO.DTINS IS 'Data de insero.';
COMMENT ON    COLUMN    SGESTACAO.HINS IS 'Hora de insero.';
COMMENT ON    COLUMN    SGESTACAO.IDUSUINS IS 'ID do usurio que inseriu.';
COMMENT ON    COLUMN    SGESTACAO.DTALT IS 'Data da ltima alterao.';
COMMENT ON    COLUMN    SGESTACAO.HALT IS 'Hora da ltima alterao.';
COMMENT ON    COLUMN    SGESTACAO.IDUSUALT IS 'ID do ltimo usurio que alterou.';
COMMENT ON    COLUMN    SGESTACAOBAL.DRIVERBAL IS 'Driver de comunicao com a balana.';
COMMENT ON    COLUMN    SGESTACAOBAL.TIPOPROCRECMERC IS 'Indica o uso principal da balana.
"TO" - Todos;
"PI" - Pesagem inicial;
"TR" - Tiragem de renda/descarregamento;
"PF" - Pesagem final;';
COMMENT ON    COLUMN    SGESTACAOIMP.CODFILIAL IS 'Cdigo da filial na tabela de estaes de trabalho.';
COMMENT ON    COLUMN    SGESTACAOIMP.CODEST IS 'Cdigo da estao de trabalho.';
COMMENT ON    COLUMN    SGESTACAOIMP.NROIMP IS 'Nmero da impressora na estao.';
COMMENT ON    COLUMN    SGESTACAOIMP.CODEMPIP IS 'Cdigo da empresa na tabela de impressoras.';
COMMENT ON    COLUMN    SGESTACAOIMP.CODFILIALIP IS 'Cdigo da filial na tabela de impressoras.';
COMMENT ON    COLUMN    SGESTACAOIMP.CODIMP IS 'Cdigo da impressora.';
COMMENT ON    COLUMN    SGESTACAOIMP.CODEMPPP IS 'Cdigo da empresa na tabela de papel.';
COMMENT ON    COLUMN    SGESTACAOIMP.CODFILIALPP IS 'Cdigo da filial na tabela papel.';
COMMENT ON    COLUMN    SGESTACAOIMP.CODPAPEL IS 'Cdigo do papel.';
COMMENT ON    COLUMN    SGESTACAOIMP.PORTAWIN IS 'Porta de impresso no windows.';
COMMENT ON    COLUMN    SGESTACAOIMP.PORTALIN IS 'Porta de impresso no linux.';
COMMENT ON    COLUMN    SGESTACAOIMP.IMPPAD IS 'Flag que define se a impressora  padro.';
COMMENT ON    COLUMN    SGESTACAOIMP.TIPOUSOIMP IS 'Tipo de uso da impressora.:
NF - Nota fiscal;
NS - Nota fiscal - servio;
PD - Pedido;
RS - Relatrio simples;
RG - Relatrio grfico;
TO - Todos;
';
COMMENT ON    COLUMN    SGESTACAOIMP.IMPGRAFICA IS 'Flag que define se a impresso  grfica.';
COMMENT ON    COLUMN    SGESTACAOIMP.DTINS IS 'Data de insero do registro.';
COMMENT ON    COLUMN    SGESTACAOIMP.HINS IS 'Hora da insero.';
COMMENT ON    COLUMN    SGESTACAOIMP.IDUSUINS IS 'ID do usurio que inseriu.';
COMMENT ON    COLUMN    SGESTACAOIMP.DTALT IS 'Data da ltima alterao.';
COMMENT ON    COLUMN    SGESTACAOIMP.HALT IS 'Hora da ltima alterao.';
COMMENT ON    COLUMN    SGESTACAOIMP.IDUSUALT IS 'ID do ltimo usurio que alterou.';
COMMENT ON TABLE        SGESTCIVIL IS 'Tabela de estados civis.';
COMMENT ON    COLUMN    SGESTCIVIL.DESCESTCIVIL IS 'Descrio do estado civil.';
COMMENT ON    COLUMN    SGFERIADO.BANCFER IS 'Indica se  um feriado bancrio.';
COMMENT ON    COLUMN    SGFERIADO.TRABFER IS 'Indica se  um feriado trabalhista.';
COMMENT ON    COLUMN    SGFILIAL.DDDFILIAL IS 'DDD da filial';
COMMENT ON    COLUMN    SGFILIAL.PERCSIMPLESFILIAL IS 'Percentual de tributao da empresa, no caso de enquadramento no simples.';
COMMENT ON    COLUMN    SGFILIAL.CODUNIFCOD IS 'Cdigo na tabela de unificao de cdigos (SGUNIFCOD).';
COMMENT ON    COLUMN    SGFILIAL.INSCMUNFILIAL IS 'Inscrio municipal';
COMMENT ON    COLUMN    SGFILIAL.CNAEFILIAL IS 'Classificao Nacional de Atividades Econmicas (CNAE).';
COMMENT ON    COLUMN    SGFILIAL.PERCISSFILIAL IS 'Percentual de ISS pago pela filial.';
COMMENT ON    COLUMN    SGFILIAL.CONTRIBIPIFILIAL IS 'Indica se a filial  contribuinte do IPI.';
COMMENT ON    COLUMN    SGFILIAL.PERFILFILIAL IS 'Perfil de apresentacao do arquivo fiscal (SPED-EFD)
A - Perfil A
B - Perfil B
C - Perfil C';
COMMENT ON    COLUMN    SGFILIAL.INDATIVFILIAL IS 'Indicador de tipo de atividadade  (SPED-EFD)
0 - Industrial ou equiparado a industrial
1 - Outros';
COMMENT ON    COLUMN    SGFILIAL.CODEMPCO IS 'Cdigo da empresa do fornecedor (contador)';
COMMENT ON    COLUMN    SGFILIAL.CODFILIALCO IS 'Cdigo da filial do fornecedor (contador)';
COMMENT ON    COLUMN    SGFILIAL.CODFOR IS 'Cdigo do fornecedor (contador)';
COMMENT ON    COLUMN    SGFILIAL.SUFRAMA IS 'Cdigo da filial no suframa';
COMMENT ON TABLE        SGITPREFERE6 IS 'Tabela de preferncias Febraban detalhada por banco e tipo (SIACC E CNAB)';
COMMENT ON    COLUMN    SGITPREFERE6.TIPOFEBRABAN IS 'Tipo de layout SIACC=01 ou CNAB=02';
COMMENT ON    COLUMN    SGITPREFERE6.CODCONV IS 'Cdigo do convnio.';
COMMENT ON    COLUMN    SGITPREFERE6.CONVCOB IS 'Convnio de cobrana do bloqueto.';
COMMENT ON    COLUMN    SGITPREFERE6.VERLAYOUT IS 'Verso do layout.';
COMMENT ON    COLUMN    SGITPREFERE6.IDENTSERV IS 'Identificao do servio.';
COMMENT ON    COLUMN    SGITPREFERE6.CONTACOMPR IS 'Conta compromisso.';
COMMENT ON    COLUMN    SGITPREFERE6.IDENTAMBCLI IS 'Identificao de ambiente do cliente. P=Produo - T=Teste.';
COMMENT ON    COLUMN    SGITPREFERE6.IDENTAMBBCO IS 'Identificao do ambiente do banco. P=Produo - T=Teste.';
COMMENT ON    COLUMN    SGITPREFERE6.NUMCONTA IS 'Nmero da conta corrente.';
COMMENT ON    COLUMN    SGITPREFERE6.FORCADTIT IS 'Forma de cadastramento do titulo.
1 - Com cadastro.
2 - Sem cadastro.';
COMMENT ON    COLUMN    SGITPREFERE6.TIPODOC IS 'Tipo de documento.
1 - Tradicional.
2 - Escrutiral.
';
COMMENT ON    COLUMN    SGITPREFERE6.IDENTEMITBOL IS 'Identificao da emisso de bloqueto.
1 - Banco emite.
2 - Cliente emite.
3 - Banco pr-emite e o cliente completa.
4 - Banco reemite.
5 - Banco no reemite.
6 - Cobrana sem papel.
Obs.: Os campos 4 e 5 s sero aceitos para cdigo de movimento para remessa 31.';
COMMENT ON    COLUMN    SGITPREFERE6.IDENTDISTBOL IS 'Identificao da distribuio.
1 - Banco.
2 - Cliente.';
COMMENT ON    COLUMN    SGITPREFERE6.ESPECTIT IS 'Especie do titulo.
01 - CH Cheque.
02 - DM Duplicata mercantl.
03 - DMI Duplicata mercantl p/ indicao.
04 - DS Duplicata de servio.
05 - DSI DUplicata de servi p/ indicao.
06 - DR Duplicata rural.
07 - LC Letra de cambio.
08 - NCC Nota de crdito comercial.
09 - NCE Nota de crdito a exportao.
10 - NCI Nota de crdito indstria.
11 - NCR Nota de crdito rural.
12 - NP Nota promissria.
13 - NPR Nota promissria rural.
14 - TM Triplicata mercantl.
15 - TS Triplicata de servio.
16 - NS Nota de seguro.
17 - RC Recibo.
18 - FAT Fatura.
19 - ND Nota de dbito.
20 - AP Apolice de seguro.
21 - ME Mensalidade escolar.
22 - PC Parcela de consrcio.
99 - Outros.

';
COMMENT ON    COLUMN    SGITPREFERE6.CODJUROS IS 'Cdigo do juros de mora.
1 - Valor por dia.
2 - Taxa nensal.
3 - Isento.
';
COMMENT ON    COLUMN    SGITPREFERE6.VLRPERCJUROS IS 'Valor ou percentual do juros.
';
COMMENT ON    COLUMN    SGITPREFERE6.CODDESC IS 'Cdigo do desconto.
1 - Valor fixo at a data informada.
2 - Percentual at a data informada.
3 - Valor por antecipao por dia corrido.
4 - Valor por antecipao por dia util.
5 - Percentual sobre o valor nominal dia corrido.
6 - Percentual sobre o valor nominal dia util.
Obs.: Para as opes 1 e 2 ser obrigatrio a informao da data.';
COMMENT ON    COLUMN    SGITPREFERE6.VLRPERCDESC IS 'Valor ou percentual do desconto.';
COMMENT ON    COLUMN    SGITPREFERE6.CODPROT IS 'Cdigo para protesto.
1 - Dias corridos.
2 - Dias utis.
3 - No protestar.';
COMMENT ON    COLUMN    SGITPREFERE6.DIASPROT IS 'Nmero de dias para protesto.';
COMMENT ON    COLUMN    SGITPREFERE6.CODBAIXADEV IS 'Cdigo para baixa/devoluo.
1 - Baixar/Devolver.
2 - No baixar/ No devolver.';
COMMENT ON    COLUMN    SGITPREFERE6.DIASBAIXADEV IS 'Nmero de dias para a Baixa / Devoluo.';
COMMENT ON    COLUMN    SGITPREFERE6.ACEITE IS 'Defini o aceite do arquivo de cnab S - sim e N - no';
COMMENT ON    COLUMN    SGITPREFERE6.PADRAOCNAB IS 'Indica o padro CNAB, pode ser: 240 ou 400
';
COMMENT ON    COLUMN    SGITPREFERE6.PADRAOSIACC IS 'Indica o padro SIACC, pode ser: 150 ou 240
';
COMMENT ON    COLUMN    SGLOG.CLASLOG IS 'Classificacao do log
PR - Procedimento
ER - Erro 
';
COMMENT ON    COLUMN    SGLOG.TIPOLOG IS 'Tipo do log:
LIB - Liberao de venda abaixo do custo
';
COMMENT ON    COLUMN    SGLOG.DESCLOG IS 'Descrio resumida da operao
';
COMMENT ON    COLUMN    SGLOG.OBSLOG IS 'Descrio completa e observaes sobre a operao
';
COMMENT ON TABLE        SGLOGCRUD IS 'Log das aes de insert, update e delete.';
COMMENT ON    COLUMN    SGLOGCRUD.ID IS 'Identificao';
COMMENT ON    COLUMN    SGLOGCRUD.TABLENAME IS 'Nome da tabela';
COMMENT ON    COLUMN    SGLOGCRUD.OPERATION IS 'Operao:
U - Update
D - Delete
I - Insert
';
COMMENT ON    COLUMN    SGLOGCRUD.EVENTLOG IS 'Evento:
B - Before antes da operaco
A - After aps a operao';
COMMENT ON    COLUMN    SGLOGCRUD.DTLOG IS 'Data da operao';
COMMENT ON    COLUMN    SGLOGCRUD.HLOG IS 'Hora da operao';
COMMENT ON    COLUMN    SGLOGCRUD.IDUSU IS 'ID do usurio';
COMMENT ON    COLUMN    SGLOGCRUD.XML IS 'Contedo do registro antes ou depois da alterao.';
COMMENT ON    COLUMN    SGMODETIQUETA.EECMODETIQ IS 'Nmero de espaos entre colunas.';
COMMENT ON    COLUMN    SGMODETIQUETA.COMPRIMIDO IS 'Indica se deve imprimir comprimido.';
COMMENT ON    COLUMN    SGMODETIQUETA.POSSCRIPT IS 'indica se a etiqueta  ps script.';
COMMENT ON    COLUMN    SGMODETIQUETA.MODETIQ IS 'indica o nome do jasper.';
COMMENT ON TABLE        SGMUNICIPIO IS 'Tabela de municipios.';
COMMENT ON TABLE        SGPAIS IS 'Tabela de Paises';
COMMENT ON    COLUMN    SGPAIS.CODPAIS IS 'Cdigo do pas segundo o ISO 3166-1';
COMMENT ON    COLUMN    SGPAIS.SIGLA3CPAIS IS 'Sigla do pas com 3 caracteres.';
COMMENT ON    COLUMN    SGPAIS.DDIPAIS IS 'Cdigo de discagem direta a distancia do pais (ddi)';
COMMENT ON    COLUMN    SGPAIS.SIGLA2CPAIS IS 'Sigla do pais com 2 caracteres';
COMMENT ON    COLUMN    SGPAIS.CODBACENPAIS IS 'Cdigo do pas na tabela do BACEN (Brasil=1058)';
COMMENT ON    COLUMN    SGPAIS.CODEANPAIS IS 'Cdigo do pas na tabela EAN.';
COMMENT ON TABLE        SGPREFERE1 IS 'Preferncias do mdulo STD (Gerais).';
COMMENT ON    COLUMN    SGPREFERE1.USAORCSEQ IS 'FLAG QUE INDICA SE USA PEDIDO SEQUENCIAL NO ORAMENTO';
COMMENT ON    COLUMN    SGPREFERE1.CODTIPOMOV2 IS 'Tipo de movimento para oramento';
COMMENT ON    COLUMN    SGPREFERE1.TIPOPREFCRED IS 'Indica quando deve ser feita a verificao do crdito:
FV - Fechamento de venda;
II - Insero de tem;
AB - Ambos;';
COMMENT ON    COLUMN    SGPREFERE1.CODTIPOMOV4 IS 'Tipo de movimento para servios';
COMMENT ON    COLUMN    SGPREFERE1.TABFRETEVD IS 'Indica se a aba frete ser obrigatria na tela de vendas.
';
COMMENT ON    COLUMN    SGPREFERE1.TABADICVD IS 'Indica se a aba adicionais ser obrigatria na tela de vendas.
';
COMMENT ON    COLUMN    SGPREFERE1.TRAVATMNFVD IS 'Trava tela de venda para no receber tipo de movimento de NF na insero.
';
COMMENT ON    COLUMN    SGPREFERE1.TIPOVALIDORC IS 'Opo de validade para impresso nos oramentos:
"N"=nmero de dias ; 
"D" data 
';
COMMENT ON    COLUMN    SGPREFERE1.CLIMESMOCNPJ IS 'Permitir clientes com mesmo CNPJ:
S-SIM N-NO
';
COMMENT ON    COLUMN    SGPREFERE1.CNPJOBRIGCLI IS 'CNPJ Obrigatrio para o cadastro de clientes S ou N
';
COMMENT ON    COLUMN    SGPREFERE1.CODEMPTN IS 'Cdigo da empresa para transportadora';
COMMENT ON    COLUMN    SGPREFERE1.CODFILIALTN IS 'Cdigo da filial para transportadora.';
COMMENT ON    COLUMN    SGPREFERE1.CODTRAN IS 'Cdigo da transportadora.';
COMMENT ON    COLUMN    SGPREFERE1.ESTLOTNEG IS 'Permitir estoque de lote negativo
';
COMMENT ON    COLUMN    SGPREFERE1.NATVENDA IS 'CFOP habilitada na tela de venda
';
COMMENT ON    COLUMN    SGPREFERE1.IPIVENDA IS 'Habilita campo IPI ';
COMMENT ON    COLUMN    SGPREFERE1.CUSTOSICMS IS 'Preo de custo na compra sem ICMS.';
COMMENT ON    COLUMN    SGPREFERE1.CASASDECFIN IS 'Define as casas decimas para assuntos financeiros';
COMMENT ON    COLUMN    SGPREFERE1.COMISPDUPL IS 'Clculo de comisses por duplicata
"S" calcula pelas parcelas do contas a receber.
"N" calcula pelo valor da venda.';
COMMENT ON    COLUMN    SGPREFERE1.CODEMPT6 IS 'Cdigo da empresa para tipo de movimento de inventrio';
COMMENT ON    COLUMN    SGPREFERE1.CODFILIALT6 IS 'Cdigo da filial para tipo de movimento de inventrio';
COMMENT ON    COLUMN    SGPREFERE1.CODTIPOMOV6 IS 'Cdigo de tipo de movimento de inventrio';
COMMENT ON    COLUMN    SGPREFERE1.BLOQCOMPRA IS 'FLAG PARA BLOQUEAR A COMPRA';
COMMENT ON    COLUMN    SGPREFERE1.VENDAMATPRIM IS 'Flag para permitir venda de matria prima (S/N).';
COMMENT ON    COLUMN    SGPREFERE1.VENDAPATRIM IS 'Flag para permitir venda de matria prima (S/N)';
COMMENT ON    COLUMN    SGPREFERE1.PEPSPROD IS 'Flag que indica se deve aparecer o campo custo peps na tela de cadastro de produtos.';
COMMENT ON    COLUMN    SGPREFERE1.CNPJFOROBRIG IS 'Flag que indica se o CNPJ do fornecedor  obrigatrio.';
COMMENT ON    COLUMN    SGPREFERE1.INSCESTFOROBRIG IS 'Flag que indica se a insc. est. do fornecedor  obrigatria.';
COMMENT ON    COLUMN    SGPREFERE1.BUSCAPRODSIMILAR IS 'Flag que indica se ao entrar com cdigo de produto em textfield dever buscar os produtos similares.';
COMMENT ON    COLUMN    SGPREFERE1.MULTIALMOX IS 'Flag que indica o trabalho com multiplos almoxarifados.';
COMMENT ON    COLUMN    SGPREFERE1.CODEMPT8 IS 'Cod. emp. do tipo de movimento padro para RMA.';
COMMENT ON    COLUMN    SGPREFERE1.CODFILIALT8 IS 'Cod. filial do tipo de movimento padro para RMA.';
COMMENT ON    COLUMN    SGPREFERE1.CODTIPOMOV8 IS 'Codigo do tipo de movimento padro para RMA.';
COMMENT ON    COLUMN    SGPREFERE1.ESTNEGGRUP IS 'Define se controla o estoque negativo por grupo.';
COMMENT ON    COLUMN    SGPREFERE1.USATABPE IS 'Flag para usar tabela de prazos de entrega.';
COMMENT ON    COLUMN    SGPREFERE1.DESCCOMPPED IS 'Indica se ser utilizada a descrio completa nos oramentos e pedidos.';
COMMENT ON    COLUMN    SGPREFERE1.OBSCLIVEND IS 'Flag para mostrar observaes do cliente na tela de venda.';
COMMENT ON    COLUMN    SGPREFERE1.CONTESTOQ IS 'Flag que define se o sistema vai trabalhar com estoque.';
COMMENT ON    COLUMN    SGPREFERE1.DIASPEDT IS 'S - mostra data de entrega no pedido
N - mostra nmero de dias para entrega';
COMMENT ON    COLUMN    SGPREFERE1.RECALCPCVENDA IS 'flag que marca se deve recalcular os valores do item quando alterar o cabealho';
COMMENT ON    COLUMN    SGPREFERE1.RECALCPCORC IS 'flag que marca se deve recalcular os valores do item quando alterar o cabealho';
COMMENT ON    COLUMN    SGPREFERE1.USALAYOUTPED IS 'define se usa layout proprio para pedido';
COMMENT ON    COLUMN    SGPREFERE1.VERIFALTPARCVENDA IS 'FLAG INDICA SE FAZ VERIFICAO PARA ALTERAR PARCELA DA VENDA';
COMMENT ON    COLUMN    SGPREFERE1.BUSCACODPRODGEN IS 'BUSCA GENERICA DO CDIGO DO PRODUTO';
COMMENT ON    COLUMN    SGPREFERE1.FILBUSCGENPROD IS 'FILTAR POR PRODUTO NA BUSCA COM O CDIGO DE BARRAS';
COMMENT ON    COLUMN    SGPREFERE1.FILBUSCGENREF IS 'FILTAR POR REFERENCIA NA BUSCA COM O CDIGO DE BARRAS';
COMMENT ON    COLUMN    SGPREFERE1.FILBUSCGENCODBAR IS 'FILTAR POR CODIGO DE BARRAS NA BUSCA COM O CDIGO DE BARRAS';
COMMENT ON    COLUMN    SGPREFERE1.FILBUSCGENCODFAB IS 'FILTAR POR CODIGO DO FABRICANTE NA BUSCA COM O CDIGO DE BARRAS';
COMMENT ON    COLUMN    SGPREFERE1.FILBUSCGENCODFOR IS 'Busca produro por cdigo de fornecedor.';
COMMENT ON    COLUMN    SGPREFERE1.BUSCAVLRULTCOMPRA IS 'Busca o valor da ultima compra na tela de compras.';
COMMENT ON    COLUMN    SGPREFERE1.USAIMGASSORC IS 'Flag para usar imagem de assinatura no oramento.';
COMMENT ON    COLUMN    SGPREFERE1.IMGASSORC IS 'Imagem de assinatura pra oramento.';
COMMENT ON    COLUMN    SGPREFERE1.CONSISTCPFCLI IS 'Indica se deve consistir CPF no cliente';
COMMENT ON    COLUMN    SGPREFERE1.CONSISTEIECLI IS 'Indica se deve consistir IE no cliente';
COMMENT ON    COLUMN    SGPREFERE1.CONSISTEIEFOR IS 'Indica se deve consistir IE no fornecedor.';
COMMENT ON    COLUMN    SGPREFERE1.CONSISTECPFFOR IS 'Indica se deve validar o CPF do fornecedor pessoa fsica.';
COMMENT ON    COLUMN    SGPREFERE1.USANOMEVENDORC IS 'Flag "S" para indicar o uso de nome do vendedor no oramento, caso contrrio utilizar o nome da empresa.';
COMMENT ON    COLUMN    SGPREFERE1.SISCONTABIL IS 'Seleciona o sistema de contabilidade utilizado.
00 - Nenhum
01 - Freedom Contbil
02 - Safe Contbil
';
COMMENT ON    COLUMN    SGPREFERE1.ATBANCOIMPBOL IS 'Flag que indica se o banco poder ser atualizado na tela de impresso de boleto.';
COMMENT ON    COLUMN    SGPREFERE1.TIPOCODBAR IS 'Tipo de cdigo de barras.
1-EAN
2-39';
COMMENT ON    COLUMN    SGPREFERE1.ADICORCOBSPED IS 'Flag que indica se deve carregar os cdigos dos oramentos nas observaes dos pedidos, gerados a partir de oramentos.';
COMMENT ON    COLUMN    SGPREFERE1.CODEMPMENSORC IS 'Cdigo da empresa para a mensagem padro para oramento.';
COMMENT ON    COLUMN    SGPREFERE1.CODFILIALMENSORC IS 'Cdigo da filial para mensagem padro para oramento.';
COMMENT ON    COLUMN    SGPREFERE1.CODMENSORC IS 'Cdigo da mensagem padro para oramento.';
COMMENT ON    COLUMN    SGPREFERE1.CUSTOCOMPRA IS 'Habilita para digitao campo de custo na compra.';
COMMENT ON    COLUMN    SGPREFERE1.TABTRANSPCP IS 'Indica se deve mostrar aba de transportadora na tela de compra.';
COMMENT ON    COLUMN    SGPREFERE1.TABTRANSPORC IS 'Indica se deve mostrar aba de transportadora na tela de oramento.';
COMMENT ON    COLUMN    SGPREFERE1.TABSOLCP IS 'Habilita e desabilita aba de solicitao na tela de compras.';
COMMENT ON    COLUMN    SGPREFERE1.ADICFRETEBASEICM IS 'Indica se deve permitir adicionar frete  base de calculo do ICMS.
';
COMMENT ON    COLUMN    SGPREFERE1.PRECOCPREL IS 'Indica se deve mostrar o preo de compra nos relatrios de compra.';
COMMENT ON    COLUMN    SGPREFERE1.MULTICOMIS IS 'Habilita e desabilita multi-comissionados.';
COMMENT ON    COLUMN    SGPREFERE1.USUATIVCLI IS 'S - Define controle de acesso para ativao de cliente por usurio.';
COMMENT ON    COLUMN    SGPREFERE1.CODEMPHISTREC IS 'Cdigo da empresa do histrico padro para lanamentos financeiros provenientes do contas a receber.';
COMMENT ON    COLUMN    SGPREFERE1.CODFILIALHISTREC IS 'Cdigo da filial do histrico padro para lanamentos financeiros provenientes do contas a receber.';
COMMENT ON    COLUMN    SGPREFERE1.CODHISTREC IS 'Cdigo do histrico padro para lanamentos financeiros provenientes do contas a receber.';
COMMENT ON    COLUMN    SGPREFERE1.CODEMPHISTPAG IS 'Cdigo da empresa do histrico padro para lanamentos financeiros provenientes do contas a pagar.';
COMMENT ON    COLUMN    SGPREFERE1.CODFILIALHISTPAG IS 'Cdigo da filial do histrico padro para lanamentos financeiros provenientes do contas a pagar.';
COMMENT ON    COLUMN    SGPREFERE1.CODHISTPAG IS 'Cdigo do histrico padro para lanamentos financeiros provenientes do contas a pagar.';
COMMENT ON    COLUMN    SGPREFERE1.ESTITRECALTDTVENC IS 'Flag que indica se estorna recebimento ao alterar data de vencimento da parcela com baixa automatica.';
COMMENT ON    COLUMN    SGPREFERE1.LCREDGLOBAL IS 'Indica se a liberao de crdito deve ser agrupada, para clientes com sub-clientes.';
COMMENT ON    COLUMN    SGPREFERE1.VDMANUTCOMOBRIG IS 'Indica se o filtro de vendedor  obrigatria na tela de manuteno de comisses.';
COMMENT ON    COLUMN    SGPREFERE1.CLASSPED IS 'Classe padro para pedidos grficos.';
COMMENT ON    COLUMN    SGPREFERE1.TIPOCLASSPED IS 'Indica o tipo de classe padro para oramentos.
QA - Resultset como parmetro (Query na Aplicao);
QJ - Parametros de filtro (Query no Jasper).
';
COMMENT ON    COLUMN    SGPREFERE1.USAIBGECLI IS 'Indica se deve usar a tabela de IBGE de cidades para o cadastro de clientes.';
COMMENT ON    COLUMN    SGPREFERE1.USAIBGEFOR IS 'Indica se deve usar a tabela de IBGE de cidades para o cadastro de fornecedores.';
COMMENT ON    COLUMN    SGPREFERE1.USAIBGETRANSP IS 'Indica se deve usar a tabela de IBGE de cidades para o cadastro de transportadoras.';
COMMENT ON    COLUMN    SGPREFERE1.SOMAVOLUMES IS 'Indica se deve somar as quantidades dos itens de venda e lanar no campo "volumes".';
COMMENT ON    COLUMN    SGPREFERE1.BUSCACEP IS 'Indica se deve habilitar o boto para busca de ceps nos cadastros.';
COMMENT ON    COLUMN    SGPREFERE1.URLWSCEP IS 'URL do web service de busca de endereo pelo cep.';
COMMENT ON    COLUMN    SGPREFERE1.CLASSCP IS 'Classe padro para pedido de compra.';
COMMENT ON    COLUMN    SGPREFERE1.LABELOBS01CP IS 'Descrio para o campo coringa obs01 da tabela CPCOMPRA.';
COMMENT ON    COLUMN    SGPREFERE1.LABELOBS02CP IS 'Descrio para o campo coringa obs02 da tabela CPCOMPRA.';
COMMENT ON    COLUMN    SGPREFERE1.LABELOBS03CP IS 'Descrio para o campo coringa obs03 da tabela CPCOMPRA.';
COMMENT ON    COLUMN    SGPREFERE1.LABELOBS04CP IS 'Descrio para o campo coringa obs04 da tabela CPCOMPRA.';
COMMENT ON    COLUMN    SGPREFERE1.CONSISTEIEPF IS 'Indica se deve consistir a inscrio estadual de clientes do tipo pessoa fsica.';
COMMENT ON    COLUMN    SGPREFERE1.CREDICMSSIMPLES IS 'Indica se deve destacar crdito de ICMS (empesa simples.)';
COMMENT ON    COLUMN    SGPREFERE1.CODEMPMS IS 'Cdigo da empresa da mensagem de destaque de ICMS de empresa enquadrada no simples.';
COMMENT ON    COLUMN    SGPREFERE1.CODFILIALMS IS 'Cdigo da filial da mensagem de destaque de ICMS para empresa enquadrada no simples.';
COMMENT ON    COLUMN    SGPREFERE1.CODMENSICMSSIMPLES IS 'Cdigo da mensagem a ser destacada na nota fiscal, quando empresa destacar crdito de icms, estando enquadrada no simples.';
COMMENT ON    COLUMN    SGPREFERE1.GERACOMISVENDAORC IS 'Indica se deve gerar gerar comisso padro nas vendas 
geradas atravs de busca de oramentos.';
COMMENT ON    COLUMN    SGPREFERE1.GERACODUNIF IS 'Indica se deve gerar cdigo unificado na tabela SGUNIFCOD 
para uso como destinatario ou remetente no conhecimento de frete.';
COMMENT ON    COLUMN    SGPREFERE1.CODTIPOMOV9 IS 'Cdigo do tipo de movimento padro para conhecimento de frete.';
COMMENT ON    COLUMN    SGPREFERE1.CODFILIALT9 IS 'Cdigo da filial do tipo de movimento para conheciemento de frete.';
COMMENT ON    COLUMN    SGPREFERE1.CODEMPT9 IS 'Cdigo da empresa do tipo de moviento padro para conhecimento de frete.';
COMMENT ON    COLUMN    SGPREFERE1.CODEMPJP IS 'Cdigo da empresa da conta de planejamento de Juros Pagos.';
COMMENT ON    COLUMN    SGPREFERE1.CODFILIALJP IS 'Cdigo da filial da conta de planejamento de Juros Pagos.';
COMMENT ON    COLUMN    SGPREFERE1.CODPLANJP IS 'Cdigo da conta de planejamento de Juros Pagos.';
COMMENT ON    COLUMN    SGPREFERE1.CODEMPJR IS 'Cdigo da empresa da conta de planejamento de Juros Recebidos.';
COMMENT ON    COLUMN    SGPREFERE1.CODFILIALJR IS 'Cdigo da filial da conta de planejamento de Juros Recebidos.';
COMMENT ON    COLUMN    SGPREFERE1.CODPLANJR IS 'Cdigo da conta de planejamento de Juros Recebidos.';
COMMENT ON    COLUMN    SGPREFERE1.CODEMPDR IS 'Cdigo da empresa da conta de planejamento de Descontos recebidos.';
COMMENT ON    COLUMN    SGPREFERE1.CODFILIALDR IS 'Cdigo da filial da conta de planejamento de Descontos recebidos.';
COMMENT ON    COLUMN    SGPREFERE1.CODPLANDR IS 'Cdigo da conta de planejamento de Descontos recebidos.';
COMMENT ON    COLUMN    SGPREFERE1.CODEMPDC IS 'Cdigo da empresa da conta de planejamento de Descontos concedidos.';
COMMENT ON    COLUMN    SGPREFERE1.CODFILIALDC IS 'Cdigo da filial da conta de planejamento de Descontos concedidos.';
COMMENT ON    COLUMN    SGPREFERE1.CODPLANDC IS 'Cdigo da conta de planejamento de Descontos concedidos.';
COMMENT ON    COLUMN    SGPREFERE1.GERAPAGEMIS IS 'Gerao de contas a pagar por data de emisso.';
COMMENT ON    COLUMN    SGPREFERE1.LANCAFINCONTR IS 'Indica se deve habilitar o vinculo entre lanamento financeiro (fnsublanca) e contrato/projeto. Para
apurao de custos.';
COMMENT ON    COLUMN    SGPREFERE1.LANCARMACONTR IS 'Indica se eve habilitar o vinculo entre rma e contrato/projeto. Para apurao de custos.';
COMMENT ON    COLUMN    SGPREFERE1.VISUALIZALUCR IS 'Indica se deve habilitar a aba "Lucratividade" na tela de venda.';
COMMENT ON    COLUMN    SGPREFERE1.CLASSNFE IS 'Classe do plugin de integrao Nfe';
COMMENT ON    COLUMN    SGPREFERE1.DIRNFE IS 'Diretrio padro para arquivos NFE (windows).';
COMMENT ON    COLUMN    SGPREFERE1.DIRNFELIN IS 'Diretrio padro para arquivos NFE (linux).';
COMMENT ON    COLUMN    SGPREFERE1.FORMATODANFE IS '1 - Retrato, 2 - Paisagem';
COMMENT ON    COLUMN    SGPREFERE1.AMBIENTENFE IS '1 - Produo, 2 - Homologao';
COMMENT ON    COLUMN    SGPREFERE1.PROCEMINFE IS 'Identificador do processo de emisso da NFe:
0 - emisso de NF-e com aplicativo do contribuinte;
3 - emisso NF-e pelo contribuinte com aplicativo fornecido pelo Fisco.';
COMMENT ON    COLUMN    SGPREFERE1.VERPROCNFE IS 'Identificador da verso do processo de emisso (informar a erso do aplicativo emissor de NFe)';
COMMENT ON    COLUMN    SGPREFERE1.KEYLICNFE IS 'Chave de licenciamento NFE.
';
COMMENT ON    COLUMN    SGPREFERE1.DTVENCTONFE IS 'Data de vencimento da licena NFE.
';
COMMENT ON    COLUMN    SGPREFERE1.INFADPRODNFE IS 'Indica se deve incluir as informaes adicionais do produto na nota fiscal eletronica (Campo HinfAdProd)';
COMMENT ON    COLUMN    SGPREFERE1.CODEMPNF IS 'Cdigo da empresa do email padro para envio de nfe.';
COMMENT ON    COLUMN    SGPREFERE1.CODFILIALNF IS 'Cdigo da filial do email padro para envio nfe';
COMMENT ON    COLUMN    SGPREFERE1.CODEMAILNF IS 'Cdigo do email padro para envio de nfe.';
COMMENT ON    COLUMN    SGPREFERE1.EXIBEPARCOBSDANFE IS 'Indica se deve adicionar o desdobramento das parcelas nas observaes da DANFE.';
COMMENT ON    COLUMN    SGPREFERE1.REGIMETRIBNFE IS 'Regime tributrio para NFE.
1 - Simples Nacional
2 - Simples Nacional (excesso de sub-limite)
3 - Normal';
COMMENT ON    COLUMN    SGPREFERE1.INFCPDEVOLUCAO IS 'Indica se deve informar a compra na devoluo.';
COMMENT ON    COLUMN    SGPREFERE1.INFVDREMESSA IS 'Indica de informa nota de remessa.';
COMMENT ON    COLUMN    SGPREFERE1.GERARECEMIS IS 'Indica se deve gerar contas a receber a partir da data de emisso do pedido.';
COMMENT ON    COLUMN    SGPREFERE1.RETENSAOIMP IS 'Indica se deve realizar a retenso de impostos na emisso da nota, reduzindo o valor liquido da nota fiscal.';
COMMENT ON    COLUMN    SGPREFERE1.TIPOCUSTOLUC IS 'Informa qual o tipo de custo deve ser usado no clculo de lucratividade de oramentos/pedidos.
U - Ultima compra;
M - MPM
P - PEPS';
COMMENT ON    COLUMN    SGPREFERE1.TABIMPORTCP IS 'Indica se deve habilitar a aba importao na tela de compras.';
COMMENT ON    COLUMN    SGPREFERE1.HABVLRTOTITORC IS 'Indica se deve habilitar o valor total do item para digitao, na tela de oramentos.';
COMMENT ON    COLUMN    SGPREFERE1.USABUSCAGENPRODCP IS 'Indica se deve realizar a busca genrica de produtos na compra.';
COMMENT ON    COLUMN    SGPREFERE1.ADICOBSORCPED IS 'Indica se deve transferir as observaes do oramento para o pedido.';
COMMENT ON    COLUMN    SGPREFERE1.USAPRECOCOT IS 'Indica se deve utilizar o preo de cotaes para pedidos de compras.';
COMMENT ON    COLUMN    SGPREFERE1.BLOQPRECOAPROV IS 'Indica se deve bloquear o faturamento de pedido de compra com preo no aprovado.';
COMMENT ON    COLUMN    SGPREFERE1.CODEMPFT IS 'Cdigo da empresa do tipo de fornecedor para transportadoras.';
COMMENT ON    COLUMN    SGPREFERE1.CODFILIALFT IS 'Cdigo da filial do tipo de fornecedor para transportadoras.';
COMMENT ON    COLUMN    SGPREFERE1.CODTIPOFORFT IS 'Cdigo do tipo de fornecedor para transportadoras.';
COMMENT ON    COLUMN    SGPREFERE1.USAPRECOCOMIS IS 'Indica se deve utilizar o preo para comissionamento do cadastro de produtos, para calculo de comissioament especial por seo de produo.';
COMMENT ON    COLUMN    SGPREFERE1.ESPECIALCOMIS IS 'Indica se deve utilizar o mecanismo de comissionamento especial (por setor de produo)';
COMMENT ON    COLUMN    SGPREFERE1.CODFILIALTS IS 'Cdigo da filial do tipo de movimento para oramentos de servio.';
COMMENT ON    COLUMN    SGPREFERE1.CODTIPOMOVS IS 'Cdigo do tipo de movimento para oramentos de servio.';
COMMENT ON    COLUMN    SGPREFERE1.CODEMPTS IS 'Cdigo da empresa do tipo de movimento para oramentos de servio.';
COMMENT ON    COLUMN    SGPREFERE1.CODEMPSV IS 'Cdigo da empresa de plano de pagamento sem valor financeiro para uso em devolues e afins.';
COMMENT ON    COLUMN    SGPREFERE1.CODFILIALSV IS 'Cdigo da filial de plano de pagamento sem valor financeiro para uso em devolues e afins.';
COMMENT ON    COLUMN    SGPREFERE1.CODPLANOPAGSV IS 'Cdigo de plano de pagamento sem valor financeiro para uso em devolues e afins.';
COMMENT ON    COLUMN    SGPREFERE1.ARREDPRECO IS 'Indice de arredondamento de precos:
null ou 0 = sem arredondamento;
> 0 fator de arredondamento decimal';
COMMENT ON    COLUMN    SGPREFERE1.CODEMPPC IS 'Cdigo da empresa padro planejamento para pagamento com cheques.';
COMMENT ON    COLUMN    SGPREFERE1.CODFILIALPC IS 'Cdigo da empresa para o planejamento padro para pagamento com cheques.';
COMMENT ON    COLUMN    SGPREFERE1.CODPLANPC IS 'Cdigo do planejamento padro para pagamento com cheques.';
COMMENT ON    COLUMN    SGPREFERE1.TPNOSSONUMERO IS 'Indica o padro para gerao do nosso nmero (boletos e arquivos de remessa)
D - Nmero do documento (doc)
R - Nmero do contas a receber (codrec)
S - Sequencial nico (recomendado)';
COMMENT ON    COLUMN    SGPREFERE1.IMPDOCBOL IS 'Define se o nmero  NF ser impresso no campo documento do boleto (S/N).
';
COMMENT ON    COLUMN    SGPREFERE1.FECHACAIXA IS 'Indica se deve bloquear caixas para lanamentos retroativos.';
COMMENT ON    COLUMN    SGPREFERE1.FECHACAIXAAUTO IS 'Indica se deve realizar o fechamento de caixas automaticamente, 
ou atravs de procedimento manual.';
COMMENT ON    COLUMN    SGPREFERE1.NUMDIGIDENTTIT IS 'Numero de digitos para campo de identificacao do titulo em arquivos de remessa padrao cnab (parametro corretivo para periodo intermediario entre a versao 1.2.4.1 e 1.2.4.2);';
COMMENT ON    COLUMN    SGPREFERE1.KEYLICEFD IS 'Chave de licenciamento do mdulo Sped EFD.';
COMMENT ON    COLUMN    SGPREFERE1.DTVENCTOEFD IS 'Data de vencimento da licencao do SPED Efd.';
COMMENT ON    COLUMN    SGPREFERE1.ENCORCPROD IS 'Indica se deve encaminhar oramentos contendo produtos acabados para a produo (Sistema Pull)
';
COMMENT ON    COLUMN    SGPREFERE1.CODEMPIM IS 'Cdigo do tipo de movimento para NF de importao.';
COMMENT ON    COLUMN    SGPREFERE1.CODFILIALIM IS 'Cdigo da filial do tipo de movimento para NF de importao';
COMMENT ON    COLUMN    SGPREFERE1.CODTIPOMOVIM IS 'Cdigo do tipo de movimento para nota fiscal de importao.';
COMMENT ON    COLUMN    SGPREFERE1.COMISSAODESCONTO IS 'Indica se deve habilitar o mecanismo de comissionamento progressivo, de acordo com o desconto concedido.
"S" - Sim
"N" - No
';
COMMENT ON    COLUMN    SGPREFERE1.CODEMPHC IS 'Cdigo da empresa para histrico padro para baixa CNAB.
';
COMMENT ON    COLUMN    SGPREFERE1.CODFILIALHC IS 'Cdigo da filial para histrico padro para baixa CNAB.
';
COMMENT ON    COLUMN    SGPREFERE1.CODHISTCNAB IS 'Cdigo do histrico padro para baixa CNAB.
';
COMMENT ON    COLUMN    SGPREFERE1.ALINHATELALANCA IS 'Indica se deve alinhar a tela de lanamentos financeiros a direta.
S - Sim
N - No
';
COMMENT ON    COLUMN    SGPREFERE1.IDENTCLIBCO IS 'Identificao cliente (SIACC)- D - Documento - CPF/CNPJ / C - Cdigo do cliente ';
COMMENT ON    COLUMN    SGPREFERE1.VDPRODQQCLAS IS 'Permite venda de produto independentemente da classificao.';
COMMENT ON    COLUMN    SGPREFERE1.UTILIZATBCALCCA IS 'Utiliza tabela para clculo do custo de aquisio.';
COMMENT ON    COLUMN    SGPREFERE1.BLOQPEDVD IS 'Bloqueia pedido de venda aps emisso.';
COMMENT ON TABLE        SGPREFERE2 IS 'Preferncias do mdulo ATD.';
COMMENT ON    COLUMN    SGPREFERE2.CABTERMR01 IS 'Cabealho 1 do termo de recebimento.';
COMMENT ON    COLUMN    SGPREFERE2.CABTERMR02 IS 'Cabealho 2 do termo de recebimento.';
COMMENT ON    COLUMN    SGPREFERE2.RODTERMR IS 'Rodap do termo de recebimento.';
COMMENT ON TABLE        SGPREFERE3 IS 'Preferencias do mdulo TMK.';
COMMENT ON    COLUMN    SGPREFERE3.AUTOHORATEND IS 'Define se utiliza contagem automatica do tempo de atendimento.';
COMMENT ON    COLUMN    SGPREFERE3.CODATIVCE IS 'Cdigo da atividade padro para envio de campanha.';
COMMENT ON    COLUMN    SGPREFERE3.CODATIVTE IS 'Cdigo da atividade padro para envio de campanha frustrado.';
COMMENT ON    COLUMN    SGPREFERE3.BLOQATENDCLIATRASO IS 'Indica se deve bloquear atendimentos para clientes em atraso. S - Sim
N - No
';
COMMENT ON    COLUMN    SGPREFERE3.MOSTRACLIATRASO IS 'Indica se deve exibir informao de cliente em atraso, na tela de gerenciamento de atendimentos.
S - Sim
N - No';
COMMENT ON    COLUMN    SGPREFERE3.CODEMPNC IS 'Cdigo da empresa do email de notificao de chamados a tcnicos designados.';
COMMENT ON    COLUMN    SGPREFERE3.CODFILIALNC IS 'Cdigo da filial do email de notificao de chamados a tcnicos designados.';
COMMENT ON    COLUMN    SGPREFERE3.CODEMAILNC IS 'Cdigo do email de notificao de chamados a tcnicos designados.';
COMMENT ON    COLUMN    SGPREFERE3.CODEMPEC IS 'Cdigo da empresa do email de notificao de chamados ao cliente.
';
COMMENT ON    COLUMN    SGPREFERE3.CODFILIALEC IS 'Cdigo da filial do email de notificao de chamados ao cliente.
';
COMMENT ON    COLUMN    SGPREFERE3.CODEMAILEC IS 'Cdigo do email de notificao de chamados ao cliente.
';
COMMENT ON TABLE        SGPREFERE4 IS 'Preferncias do mdulo de PDV
';
COMMENT ON    COLUMN    SGPREFERE4.CODEMPCL IS 'Cdigo da empresa para cliente.';
COMMENT ON    COLUMN    SGPREFERE4.CODFILIALCL IS 'Cdigo filial para cliente.';
COMMENT ON    COLUMN    SGPREFERE4.CODCLI IS 'Cdigo do cliente padro para venda.';
COMMENT ON    COLUMN    SGPREFERE4.CODEMPPD IS 'CODIGO DA EMPRESA DO PRODUTO PARA FRETE';
COMMENT ON    COLUMN    SGPREFERE4.CODFILIALPD IS 'CODIGO DA FILIAL DO PRODUTO PARA FRETE';
COMMENT ON    COLUMN    SGPREFERE4.CODPROD IS 'CODIGO DO PRODUTO PRA FRETE';
COMMENT ON    COLUMN    SGPREFERE4.ADICPDV IS 'flag que indica se mostra frete no fechamento da venda no PDV';
COMMENT ON    COLUMN    SGPREFERE4.APROVORC IS 'FLAG QUE PERMITE APROVAO DO ORAMENTO DA TELA DE CADASTRO DO ORAMENTO';
COMMENT ON    COLUMN    SGPREFERE4.DIASVENCORC IS 'DIAS PARA O VENCIMENTO DO ORAMENTO.';
COMMENT ON    COLUMN    SGPREFERE4.USABUSCAGENPROD IS 'indica se abilita o campo para fazer a busca generica de produtos';
COMMENT ON    COLUMN    SGPREFERE4.AUTOFECHAVENDA IS 'Flag indica se chama a tela de fecha venda automatico quando buscar oramento.';
COMMENT ON    COLUMN    SGPREFERE4.USALOTEORC IS 'Flag que indica se usa lote na tela de oramento.';
COMMENT ON    COLUMN    SGPREFERE4.HABRECEBER IS 'Habilita aba de receber no fechamento da venda de ECF.';
COMMENT ON TABLE        SGPREFERE5 IS 'Preferncias do mdulo de PCP
';
COMMENT ON    COLUMN    SGPREFERE5.MESESDESCCP IS 'Nmero de meses para descarte de anlises de contra-prova.';
COMMENT ON    COLUMN    SGPREFERE5.CODTIPOMOV IS 'Cdigo do tipo de movimento padro para Ordem de produo.';
COMMENT ON    COLUMN    SGPREFERE5.CODEMPTM IS 'Cdigo da empresa do tipo de movimento padro para Ordem de Produo.';
COMMENT ON    COLUMN    SGPREFERE5.CODFILIALTM IS 'Cdigo da filial do tipo de movimento padro para Ordem de Produo.';
COMMENT ON    COLUMN    SGPREFERE5.SITRMAOP IS 'Situao da RMA gerada pela OP.
Pode ser:
"PE" - Pendente
"AF" - Aprovada 
"EF" - Expedida ';
COMMENT ON    COLUMN    SGPREFERE5.IMGASSRESP IS 'Imagem da assinatura do responsvel tcnico.';
COMMENT ON    COLUMN    SGPREFERE5.BAIXARMAAPROV IS 'Indica se deve baixar o estoque de insumos em RMA"s aprovadas no expedidas.';
COMMENT ON    COLUMN    SGPREFERE5.RATAUTO IS 'Defini rateio automatico de itens de OP.';
COMMENT ON    COLUMN    SGPREFERE5.APAGARMAOP IS 'Indica se deve permitir a excluso de RMAs geradas por outro usurio.
Regra se aplica apenas em RMA vinculadas a Ordens de produo.';
COMMENT ON    COLUMN    SGPREFERE5.NOMERELANAL IS 'Indica qual o nome a ser impresso no relatrio de anlise.
"U" - Usurio de cadastrou a anse;
"R" - Responsvel pela produo;';
COMMENT ON    COLUMN    SGPREFERE5.SITPADOP IS 'Status padro da OP aps insero.
"PE" Pendente
"FN" Finalizada';
COMMENT ON    COLUMN    SGPREFERE5.SITPADOPCONV IS 'Status padro da OP de converso de produtos aps insero.
"PE" Pendente
"FN" Finalizada';
COMMENT ON    COLUMN    SGPREFERE5.HABCONVCP IS 'Indica se deve habilitar converso de produtos na compra.';
COMMENT ON    COLUMN    SGPREFERE5.PRODETAPAS IS 'Indica se deve permitir a finalizao de Ops em etapas.';
COMMENT ON    COLUMN    SGPREFERE5.CODEMPTS IS 'Cdigo da empresa para tipo de movimento para entrada de subprodutos.
';
COMMENT ON    COLUMN    SGPREFERE5.CODFILIALTS IS 'Cdigo da filial para tipo de movimento para entrada de subprodutos.
';
COMMENT ON    COLUMN    SGPREFERE5.CODTIPOMOVSP IS 'Cdigo do tipo de movimento para entrada de subprodutos.
';
COMMENT ON    COLUMN    SGPREFERE5.CODEMPEN IS 'Cdigo da empresa do tipo de movimento padro para envio de remessa para produo externa.';
COMMENT ON    COLUMN    SGPREFERE5.CODFILIALEN IS 'Cdigo da filial do tipo de movimento padro para envio de remessa para produo externa.';
COMMENT ON    COLUMN    SGPREFERE5.CODTIPOMOVEN IS 'Cdigo do tipo de movimento padro para envio de remessa para produo externa.';
COMMENT ON    COLUMN    SGPREFERE5.CODEMPRE IS 'Cdigo da empresa do tipo de movimento padro para retorno de produo externa.';
COMMENT ON    COLUMN    SGPREFERE5.CODFILIALRE IS 'Cdigo da filial do tipo de movimento padro para retorno de produo externa.';
COMMENT ON    COLUMN    SGPREFERE5.CODTIPOMOVRE IS 'Cdigo do tipo de movimento padro para retorno de produo externa.';
COMMENT ON TABLE        SGPREFERE6 IS 'Tabela de preferncias Febraban (SIACC E CNAB)';
COMMENT ON    COLUMN    SGPREFERE6.NOMEEMP IS 'Nome da empresa para remessa.';
COMMENT ON    COLUMN    SGPREFERE6.NOMEEMPCNAB IS 'Nome da empresa para cnab.';
COMMENT ON TABLE        SGPREFERE7 IS 'Tabela de preferncias para mecanismo de venda consignada.';
COMMENT ON    COLUMN    SGPREFERE7.CODTIPOMOVCO IS 'Tipo de movimento de consignao.';
COMMENT ON    COLUMN    SGPREFERE7.CODTIPOMOVTV IS 'Tipo de movimento de pedido de venda.';
COMMENT ON    COLUMN    SGPREFERE7.CODTIPOMOVTP IS 'Tipo de movimento de venda.';
COMMENT ON    COLUMN    SGPREFERE7.CODEMPPV IS 'Cdigo da empresa do planejamento padro para venda consignada.';
COMMENT ON    COLUMN    SGPREFERE7.CODEMPPC IS 'Cdigo da empresa do planejamento padro para consignao.';
COMMENT ON    COLUMN    SGPREFERE7.CODFILIALPC IS 'Cdigo da filial do planejamento padro para consignao.';
COMMENT ON    COLUMN    SGPREFERE7.CODPLANCONSIG IS 'Cdigo do planejamento padro para consignao.';
COMMENT ON    COLUMN    SGPREFERE7.CODFILIALPV IS 'Cdigo da filial do planejamento padro para venda consignada.';
COMMENT ON    COLUMN    SGPREFERE7.CODPLANVDCONSIG IS 'Cdigo do planejamento padro para venda consignada.';
COMMENT ON TABLE        SGPREFERE8 IS 'Tabela de preferencias do mdulo GMS.';
COMMENT ON    COLUMN    SGPREFERE8.CODEMPTR IS 'Cdigo da empresa para o tipo de recepo padro para recebimento com pesagem.';
COMMENT ON    COLUMN    SGPREFERE8.CODFILIALTR IS 'Cdigo da filial para o tipo de recepo padro para recebimento com pesagem.';
COMMENT ON    COLUMN    SGPREFERE8.CODTIPORECMERC IS 'Cdigo do tipo de recepo padro para recebimento com pesagem.';
COMMENT ON    COLUMN    SGPREFERE8.CODEMPCM IS 'Cdigo da empresa to tipo de recebimento para coletas';
COMMENT ON    COLUMN    SGPREFERE8.CODFILIALCM IS 'Cdigo da filial do tipo de recebimento para coleta.';
COMMENT ON    COLUMN    SGPREFERE8.CODTIPORECMERCCM IS 'Cdigo do tipo de recebimento para coleta.';
COMMENT ON    COLUMN    SGPREFERE8.CODEMPTC IS 'Cdigo da empresa para o tipo de movimento de compra gera a partir de pedidos de compra.';
COMMENT ON    COLUMN    SGPREFERE8.CODFILIALTC IS 'Cdigo da filial para o tipo de movimento de compra gerada a partir de pedidos de compra.';
COMMENT ON    COLUMN    SGPREFERE8.CODTIPOMOVTC IS 'Cdigo do tipo de movimento padro para compra, gerada a partir de pedidos de compra. ';
COMMENT ON    COLUMN    SGPREFERE8.GERACHAMADOOS IS 'Indica se deve gerar chamado (CRM) a partir de itens de ordem de servio.';
COMMENT ON    COLUMN    SGPREFERE8.USAPRECOPECASERV IS 'Indica se deve utilizar o preo do pea consertada no oramento de servios.';
COMMENT ON    COLUMN    SGPREFERE8.CODEMPDS IS 'Cdigo da empresa para o tipo de movimento padro para devoluo de peas consertadas.';
COMMENT ON    COLUMN    SGPREFERE8.CODFILIALDS IS 'Cdigo da filial para o tipo de movimento padro devoluo de peas consertadas.';
COMMENT ON    COLUMN    SGPREFERE8.CODTIPOMOVDS IS 'Cdigo do tipo de movimento padro para devoluo de peas consertadas.';
COMMENT ON    COLUMN    SGPREFERE8.CODEMPSE IS 'Cdigo da empresa do produto padro para servios.';
COMMENT ON    COLUMN    SGPREFERE8.CODFILIALSE IS 'Cdigo da filial para produto padro para servio.';
COMMENT ON    COLUMN    SGPREFERE8.CODPRODSE IS 'Cdigo do produto padro para servio.';
COMMENT ON    COLUMN    SGTABELA.SIGLATB IS 'Sigla da tabela.';
COMMENT ON    COLUMN    SGTIPOAGENDA.CODTIPOAGD IS 'Cdigo do tipo de agendamento';
COMMENT ON TABLE        SGUF IS 'Tabela de Unidades Federativas.';
COMMENT ON    COLUMN    SGUF.REGIAOUF IS 'Regio geogrfica
N - Norte
NE - Nordeste
S - Sul
SE - Sudeste
CO - Centro Oeste';
COMMENT ON TABLE        SGUNIFCOD IS 'Tabela de unificao de cdigos para realizao de vnculos em tabelas heterogneas;';
COMMENT ON    COLUMN    SGUNIFCOD.TIPOUNIFCOD IS 'Tipo de cdigo:
"C" - Cliente;
"F" - Fornecedor;
"T" - Transportadora;
"E" - Empresa/Filial;';
COMMENT ON    COLUMN    SGUNIFCOD.DESCUNIFCOD IS 'Descrio do cdigo unificado (no caso de cliente/fornecedor/transportadora utilizar a razo social).';
COMMENT ON    COLUMN    SGUSUARIO.BAIXOCUSTOUSU IS 'Indica se o usurio pode liberar venda abaixo do custo.';
COMMENT ON    COLUMN    SGUSUARIO.APROVCPSOLICITACAOUSU IS 'Indica o nvel de aprovao do usuario para solicitao de compras.
ND : Nenhuma
CC : Mesmo Centro de Custo
TD : Todas';
COMMENT ON    COLUMN    SGUSUARIO.APROVRMAUSU IS 'Indica o nvel de aprovao do usuario para RMA.
ND : Nenhuma
CC : Mesmo Centro de Custo
TD : Todas';
COMMENT ON    COLUMN    SGUSUARIO.ALTPARCVENDA IS 'FLAG INDICA DE PODE ALTERAR PARCELA DA VENDA';
COMMENT ON    COLUMN    SGUSUARIO.APROVRECEITA IS 'Permite que o usuario aprove venda de produto com receita.';
COMMENT ON    COLUMN    SGUSUARIO.ATIVCLI IS 'Define se o usurio tem acesso para ativar clientes.';
COMMENT ON    COLUMN    SGUSUARIO.CORAGENDA IS 'Cor representativa para visualizao na agenda corporativa.';
COMMENT ON    COLUMN    SGUSUARIO.CODEMPCE IS 'Cdigo da empresa para configurao de email.';
COMMENT ON    COLUMN    SGUSUARIO.CODFILIALCE IS 'Cdigo da filial para configurao de email.';
COMMENT ON    COLUMN    SGUSUARIO.CODCONFEMAIL IS 'Cdigo da configurao de email.';
COMMENT ON    COLUMN    SGUSUARIO.CANCELAOP IS 'Permite que o usurio cancele Ordens de Produo geradas
por outros usurios.';
COMMENT ON    COLUMN    SGUSUARIO.VENDAPATRIMUSU IS 'Define se o usurio pode liberar venda de produtos do patrimnio (imobilizado).';
COMMENT ON    COLUMN    SGUSUARIO.RMAOUTCC IS 'Indica se permite criar RMA em outros Centros de custo.';
COMMENT ON    COLUMN    SGUSUARIO.ATIVOUSU IS 'Indica se o usurio est ativo.';
COMMENT ON    COLUMN    SGUSUARIO.VISUALIZALUCR IS 'Indica se o usurio pode visualizar a aba lucratividade na tela de venda.';
COMMENT ON    COLUMN    SGUSUARIO.LIBERACAMPOPESAGEM IS 'Indica se o usurio possui permisso para digitao
do peso nas telas de pesagem (recebimento de mercadoria)';
COMMENT ON TABLE        SVOS IS 'Cabealho para ordem de servio.
';
COMMENT ON TABLE        TKATIVIDADE IS 'Tabela de atividades.';
COMMENT ON TABLE        TKCAMPANHA IS 'Tabela de cadastro de campanhas de marketing.';
COMMENT ON    COLUMN    TKCAMPANHA.CODCAMP IS 'Cdigo da campanha.';
COMMENT ON    COLUMN    TKCAMPANHA.DESCCAMP IS 'Descrio da campanha.';
COMMENT ON    COLUMN    TKCAMPANHA.OBSCAMP IS 'Observaes relativas  campanha.';
COMMENT ON TABLE        TKCAMPANHACLI IS 'Tabela de relacionamento entre clientes e campanhas.';
COMMENT ON    COLUMN    TKCAMPANHACLI.CODCAMP IS 'Cdigo da campanha.';
COMMENT ON    COLUMN    TKCAMPANHACLI.CODCLI IS 'Cdigo do cliente.';
COMMENT ON TABLE        TKCAMPANHACTO IS 'Tabela de relacionamento entre contatos e campanhas.';
COMMENT ON    COLUMN    TKCAMPANHACTO.CODCAMP IS 'Cdigo da campanha.';
COMMENT ON    COLUMN    TKCAMPANHACTO.CODCTO IS 'Cdigo do contato.';
COMMENT ON TABLE        TKCAMPANHAEMAIL IS 'Tabela de relacionamento entre campanhas e seus respectivos emails associados.';
COMMENT ON TABLE        TKCONFEMAIL IS 'Tabela de configuraes para utilizao nos emails de campanhas de marketing.';
COMMENT ON    COLUMN    TKCONFEMAIL.ASSINATREMET IS 'Assinatura do email, do remetente.';
COMMENT ON TABLE        TKCONTATO IS 'Tabela de contatos.';
COMMENT ON    COLUMN    TKCONTATO.CODORIGCONT IS 'Cdigo da origem do contato.';
COMMENT ON    COLUMN    TKCONTATO.CODEMPTO IS 'Cdigo da empresa do tipo de contato.';
COMMENT ON    COLUMN    TKCONTATO.CODFILIALTO IS 'Cdigo da filial do tipo de contato.';
COMMENT ON    COLUMN    TKCONTATO.CODTIPOCONT IS 'Cdigo do tipo de contato.';
COMMENT ON    COLUMN    TKCONTATO.CELCTO IS 'Nro de telefone celular do contato';
COMMENT ON TABLE        TKCTOATIV IS 'Tabela de relacionamento entre contatos e atividades.';
COMMENT ON TABLE        TKCTOGRPINT IS 'Tabela de relacionamento entre contatos e os grupos de interesse.';
COMMENT ON TABLE        TKEMAIL IS 'Tabela de emails para campanhas de marketing.';
COMMENT ON    COLUMN    TKEMAIL.FORMATO IS 'text/plain ou text/html';
COMMENT ON    COLUMN    TKEMAIL.CHARSET IS 'Formato da pagina de cdigos.';
COMMENT ON    COLUMN    TKHISTORICO.TIPOHISTTK IS 'Tipo de histrico: 
H - Histrico 
V - Visita ao cliente
N - Visita a novos clientes(no cadastrados)
C - Campanha
O - Cobrana
L - Ligao Pr-venda
P - Ligao Ps-venda
I - Indefinida';
COMMENT ON    COLUMN    TKHISTORICO.CODEMPCA IS 'Cdigo da empresa da campanha.';
COMMENT ON    COLUMN    TKHISTORICO.CODFILIALCA IS 'Cdigo da filial da campanha.';
COMMENT ON    COLUMN    TKHISTORICO.CODCAMP IS 'Cdigo da campanha.';
COMMENT ON    COLUMN    TKHISTORICO.SEQSITCAMP IS 'Sequencia da situao da campanha (para fk com tksitcamp)';
COMMENT ON TABLE        TKORIGCONT IS 'Tabela de origens de contatos ex: lista telefonica, pesquisa na internet, panfletagem, etc...';
COMMENT ON TABLE        TKSITCAMP IS 'Tabela da situao do cantato com relao  campanha, de acordo com a atividade desenvolvida.';
COMMENT ON    COLUMN    VDCLASCLI.SIGLACLASCLI IS 'Sigla ou abreviao da descrio da classificao do cliente (utilizado em alguns relatrios)';
COMMENT ON TABLE        VDCLCOMIS IS 'Classificao de comisses
';
COMMENT ON TABLE        VDCLIAUTP IS 'Pessoas autorizadas a comprar em nome do cliente';
COMMENT ON    COLUMN    VDCLIAUTP.NOMEAUTP IS 'Nome da pessoa autorizada a comprar em nome do cliente.';
COMMENT ON    COLUMN    VDCLIAUTP.ENDAUTP IS 'Endereco da pessoa autorizada a comprar em nome do cliente.';
COMMENT ON    COLUMN    VDCLIAUTP.NUMAUTP IS 'Nmero do endereo da pessoa autorizada a comprar em nome do cliente.';
COMMENT ON    COLUMN    VDCLIAUTP.COMPLAUTP IS 'Complemento do endereo da pessoa autorizada a comprar em nome do cliente.';
COMMENT ON TABLE        VDCLICOMPL IS 'Ficha de informaes complementares do cliente.';
COMMENT ON    COLUMN    VDCLICOMPL.CARGOTRABCLI IS 'Cargo ocupado pelo cliente.';
COMMENT ON    COLUMN    VDCLICOMPL.DTADMTRABCLI IS 'Data de admisso do cliente.';
COMMENT ON    COLUMN    VDCLICOMPL.DDDTRABCLI IS 'DDD do local de trabalho do cliente.';
COMMENT ON    COLUMN    VDCLICOMPL.FONETRABCLI IS 'Telefone do local de trabalho do cliente.';
COMMENT ON    COLUMN    VDCLICOMPL.ENDTRABCLI IS 'Endereo do trabalho do cliente.';
COMMENT ON    COLUMN    VDCLICOMPL.NUMTRABCLI IS 'Nmero do logradouro do trabalho do cliente.';
COMMENT ON    COLUMN    VDCLICOMPL.BAIRTRABCLI IS 'Bairro do trabalho do cliente.';
COMMENT ON    COLUMN    VDCLICOMPL.CIDTRABCLI IS 'Cidade do trabalho do cliente.';
COMMENT ON    COLUMN    VDCLICOMPL.UFTRABCLI IS 'Estado (UF) do trabalho do cliente.';
COMMENT ON    COLUMN    VDCLICOMPL.OUTRENDACLI IS 'Outras rendas do cliente.';
COMMENT ON    COLUMN    VDCLICOMPL.FONTRENDACLI IS 'Fonte das outras rendas do cliente.';
COMMENT ON    COLUMN    VDCLICOMPL.NOMECONJCLI IS 'Nome do conjuge do cliente.';
COMMENT ON    COLUMN    VDCLICOMPL.DTNASCCONJCLI IS 'Data de nascimento do conjuge do cliente.';
COMMENT ON    COLUMN    VDCLICOMPL.RENDACONJCLI IS 'Renda do conjuge do cliente.';
COMMENT ON    COLUMN    VDCLICOMPL.COMPLTRABCLI IS 'Complemento de endereco do trabalho do cliente.';
COMMENT ON    COLUMN    VDCLICOMPL.CEPTRABCLI IS 'Cep do trabalho do cliente.';
COMMENT ON    COLUMN    VDCLICOMPL.RAMALTRABCLI IS 'Ramal do trabalho do cliente.';
COMMENT ON    COLUMN    VDCLICOMPL.RGCONJCLI IS 'RG do conjuge.';
COMMENT ON    COLUMN    VDCLICOMPL.SSPCONJCLI IS 'Orgao de espedicao do RG do conjuge.';
COMMENT ON    COLUMN    VDCLICOMPL.CPFCONJCLI IS 'CPF do conjuge.';
COMMENT ON    COLUMN    VDCLICOMPL.NATCONJCLI IS 'Naturalidade do conjuge.';
COMMENT ON    COLUMN    VDCLICOMPL.UFNATCONJCLI IS 'Estado de onde e natural o conjuge.';
COMMENT ON    COLUMN    VDCLICOMPL.CARGOCONJCLI IS 'Cargo do conjuge.';
COMMENT ON    COLUMN    VDCLICOMPL.EMPTRABCONJCLI IS 'Empresa onde trabalha o conjuge.';
COMMENT ON    COLUMN    VDCLICOMPL.DTADMTRABCONJCLI IS 'Data de admissao do conjuge.';
COMMENT ON    COLUMN    VDCLICOMPL.NOMEAVALCLI IS 'Nome do avalista.';
COMMENT ON    COLUMN    VDCLICOMPL.DTNASCAVALCLI IS 'Data de nascimento do avalista do cliente.';
COMMENT ON    COLUMN    VDCLICOMPL.RGAVALCLI IS 'Rg do avalista.';
COMMENT ON    COLUMN    VDCLICOMPL.SSPAVALCLI IS 'Orgao de espedicao do Rg do avalista.';
COMMENT ON    COLUMN    VDCLICOMPL.CPFAVALCLI IS 'CPF do avalista do cliente.';
COMMENT ON    COLUMN    VDCLICOMPL.ENDAVALCLI IS 'Endereco do avalista do cliente.';
COMMENT ON    COLUMN    VDCLICOMPL.NUMAVALCLI IS 'Numero no endereco do avalista do cliente.';
COMMENT ON    COLUMN    VDCLICOMPL.BAIRAVALCLI IS 'Bairro do avalista do cliente.';
COMMENT ON    COLUMN    VDCLICOMPL.CIDVALCLI IS 'Cidade do avalista do cliente.';
COMMENT ON    COLUMN    VDCLICOMPL.CEPAVALCLI IS 'Cep do avalista do cliente.';
COMMENT ON    COLUMN    VDCLICOMPL.UFAVALCLI IS 'Estado do avalista do cliente.';
COMMENT ON    COLUMN    VDCLICOMPL.DDDAVALCLI IS 'DDD do telefone do avalista do cliente.';
COMMENT ON    COLUMN    VDCLICOMPL.FONEAVALCLI IS 'Fone do avalista do cliente.';
COMMENT ON    COLUMN    VDCLICOMPL.EMPTRABAVALCLI IS 'Empresa onde trabalha o avalista do cliente.';
COMMENT ON    COLUMN    VDCLICOMPL.DTADMTRABAVALCLI IS 'Data de admissao do avalista do cliente.';
COMMENT ON    COLUMN    VDCLICOMPL.CARGOAVALCLI IS 'Cargo do avalista do cliente.';
COMMENT ON TABLE        VDCLICONTAS IS 'Contas bancarias dos clientes.';
COMMENT ON TABLE        VDCLIENTE IS 'Clientes.';
COMMENT ON    COLUMN    VDCLIENTE.CODEMPEC IS 'Cdigo da empresa para tabela de estado civil.';
COMMENT ON    COLUMN    VDCLIENTE.CODFILIALEC IS 'Cdigo da filial para tabela de estado civil.';
COMMENT ON    COLUMN    VDCLIENTE.CODTBEC IS 'Cdigo da tabela de estado civil.';
COMMENT ON    COLUMN    VDCLIENTE.CODITTBEC IS 'Cdigo do estado civil.';
COMMENT ON    COLUMN    VDCLIENTE.CODEMPCB IS 'Cdigo da empresa na tabela FNCARTCOB.';
COMMENT ON    COLUMN    VDCLIENTE.CODFILIALCB IS 'Cdigo da filial na tabela FNCARTCOB.';
COMMENT ON    COLUMN    VDCLIENTE.CODCARTCOB IS 'Cdigo da carteira de cobrana.';
COMMENT ON    COLUMN    VDCLIENTE.INSCCLI IS ' Inscrio estadual do cliente.';
COMMENT ON    COLUMN    VDCLIENTE.SSPCLI IS 'Orgo de espedio do RG.';
COMMENT ON    COLUMN    VDCLIENTE.EMAILCOB IS 'Email de conbrana.';
COMMENT ON    COLUMN    VDCLIENTE.EMAILENT IS 'Email de entrega';
COMMENT ON    COLUMN    VDCLIENTE.EMAILNFECLI IS 'Email para envio de nota fiscal eletronica';
COMMENT ON    COLUMN    VDCLIENTE.DTINITR IS 'Data de abertura do crdito';
COMMENT ON    COLUMN    VDCLIENTE.CELCLI IS 'Nmero do Celular
';
COMMENT ON    COLUMN    VDCLIENTE.NATCLI IS 'Naturalidade do cliente';
COMMENT ON    COLUMN    VDCLIENTE.UFNATCLI IS 'UF ref. a naturalizade.';
COMMENT ON    COLUMN    VDCLIENTE.TEMPORESCLI IS 'Tempo de residncia do cliente';
COMMENT ON    COLUMN    VDCLIENTE.APELIDOCLI IS 'Apelido do cliente.';
COMMENT ON    COLUMN    VDCLIENTE.SITECLI IS 'Endereo eletrnico do site do cliente.';
COMMENT ON    COLUMN    VDCLIENTE.CODCONTDEB IS 'Cdigo contabil de debito.';
COMMENT ON    COLUMN    VDCLIENTE.CODCONTCRED IS 'Cdigo contabil de credito';
COMMENT ON    COLUMN    VDCLIENTE.CODCLICONTAB IS 'Cdigo contabil';
COMMENT ON    COLUMN    VDCLIENTE.FOTOCLI IS 'Foto do cliente.';
COMMENT ON    COLUMN    VDCLIENTE.IMGASSCLI IS 'Imagem da assinatura do cliente';
COMMENT ON    COLUMN    VDCLIENTE.CODMUNIC IS 'Cdigo do municipio (IBGE)';
COMMENT ON    COLUMN    VDCLIENTE.SIGLAUF IS 'Sigla da Unidade da Federeo (Estado)';
COMMENT ON    COLUMN    VDCLIENTE.CODPAIS IS 'Cdigo do pais.';
COMMENT ON    COLUMN    VDCLIENTE.CODMUNICENT IS 'Cdigo do municipio (IBGE) do endereo de entrega.';
COMMENT ON    COLUMN    VDCLIENTE.SIGLAUFENT IS 'Sigla da Unidade da Federao do endereo de entrega.';
COMMENT ON    COLUMN    VDCLIENTE.CODPAISENT IS 'Cdigo do pas do endereo de entrega.';
COMMENT ON    COLUMN    VDCLIENTE.CODMUNICCOB IS 'Cdigo do municipio (IBGE) do endereo de cobrana.';
COMMENT ON    COLUMN    VDCLIENTE.SIGLAUFCOB IS 'Sigla da Unidade da Federao do endereo de cobrana.';
COMMENT ON    COLUMN    VDCLIENTE.CODPAISCOB IS 'Cdigo do pas do endereo de cobrana.';
COMMENT ON    COLUMN    VDCLIENTE.CODUNIFCOD IS 'Cdigo na tabela de unificao de cdigos (SGUNIFCOD).';
COMMENT ON    COLUMN    VDCLIENTE.SUFRAMACLI IS 'Cdigo do SUFRAMA do cliente.';
COMMENT ON    COLUMN    VDCLIENTE.CTOCLI IS 'C - Cliente
O - Contato';
COMMENT ON    COLUMN    VDCLIENTE.CODCNAE IS 'Cdigo da atividade principal, padro CNAE.
';
COMMENT ON    COLUMN    VDCLIENTE.INSCMUNCLI IS 'Inscrio municipal do cliente.';
COMMENT ON    COLUMN    VDCLIENTE.PERCDESCCLI IS 'Percentual padro de desconto para o cliente.';
COMMENT ON    COLUMN    VDCLIENTE.CONTCLICOB IS 'Contato no cliente, para cobrana.';
COMMENT ON    COLUMN    VDCLIENTE.CONTCLIENT IS 'Contato no cliente, para entrega.';
COMMENT ON    COLUMN    VDCLIENTE.DESCIPI IS 'Indica se deve haver o desconto do IPI ao preo da mercadoria.
';
COMMENT ON    COLUMN    VDCLIENTE.IDENTCLIBCO IS 'Identificao cliente (SIACC)- D - Documento - CPF/CNPJ / C - Cdigo do cliente ';
COMMENT ON    COLUMN    VDCLIENTEFOR.CODCPCLIFOR IS 'Cdigo complementar ou da campanha que o cliente participa  junto ao fornecedor.';
COMMENT ON TABLE        VDCLIIMOV IS 'Cadastro de imoveis do cliente.';
COMMENT ON    COLUMN    VDCLIIMOV.TIPOIMOV IS 'Tipo de imovel.';
COMMENT ON    COLUMN    VDCLIIMOV.CONSTRIMOV IS 'Tipo de construcao no imovel';
COMMENT ON    COLUMN    VDCLIIMOV.AREATERIMOV IS 'Area do terrano do imovel.';
COMMENT ON    COLUMN    VDCLIIMOV.VALORIMOV IS 'Valor do imovel.';
COMMENT ON    COLUMN    VDCLIMETAVEND.ANOMETAVEND IS 'Ano para a meta de vendas';
COMMENT ON    COLUMN    VDCLIMETAVEND.VLRMETAVEND IS 'Valor de meta para vendas.';
COMMENT ON    COLUMN    VDCLIMETAVEND.OBSMETAVEND IS 'Observaes referentes a meta de vendas para um determinado ano.';
COMMENT ON TABLE        VDCLIREFC IS 'Referncias comerciais do cliente.';
COMMENT ON    COLUMN    VDCLIREFC.NOMEEMPREFC IS 'Nome da empresa.';
COMMENT ON    COLUMN    VDCLIREFC.DDDREFC IS 'DDD da referencia comercial.';
COMMENT ON    COLUMN    VDCLIREFC.FONEREFC IS 'Fone da referencia comercial.';
COMMENT ON    COLUMN    VDCLIREFC.DTMAIORCP IS 'Data da maior compra do cliente na referencia comercial.';
COMMENT ON    COLUMN    VDCLIREFC.VLRMAIORCP IS 'Valor da maior compra do cliente na referencia comercial.';
COMMENT ON    COLUMN    VDCLIREFC.NROPARCMAIORCP IS 'Numero de parcelas da maior compra do cliente na referencia comercial.';
COMMENT ON    COLUMN    VDCLIREFC.DTULTCP IS 'Data da ultima compra do cliente na referencia comercial.';
COMMENT ON    COLUMN    VDCLIREFC.VLRULTCP IS 'Valor da ultima compra do cliente na referencia comercial.';
COMMENT ON    COLUMN    VDCLIREFC.NROPARCULTCP IS 'Nro de parcelas da ultima compra do cliente na referencia comercial.';
COMMENT ON    COLUMN    VDCLIREFC.DTPRIMCP IS 'Data da primeira compra do cliente na referencia comercial.';
COMMENT ON    COLUMN    VDCLIREFC.PONTUAL IS 'Flag que indica se o cliente  pontual na referencia comercial. (S ou N)';
COMMENT ON    COLUMN    VDCLIREFC.MEDIAATRASO IS 'Mdia de atraso do cliente na referencia comercial.';
COMMENT ON    COLUMN    VDCLIREFC.CONCEITO IS 'Conceito do cliente junto  referencia comercial.';
COMMENT ON    COLUMN    VDCLIREFC.AVALISTA IS 'Flag que indica se a empresa  avalista do cliente.';
COMMENT ON    COLUMN    VDCLIREFC.INFORMANTE IS 'Nome do informante na empresa.';
COMMENT ON    COLUMN    VDCLIREFC.OBSREFC IS 'Observaes.';
COMMENT ON    COLUMN    VDCLIREFP.CODEMP IS 'Codigo da empresa.';
COMMENT ON    COLUMN    VDCLIREFP.CODFILIAL IS 'Codigo da filial.';
COMMENT ON    COLUMN    VDCLIREFP.CODCLI IS 'Codigo do cliente.';
COMMENT ON    COLUMN    VDCLIREFP.NOMEREFP IS 'Nome da referncia pessoal.';
COMMENT ON    COLUMN    VDCLIREFP.ENDREFP IS 'Endereco.';
COMMENT ON    COLUMN    VDCLIREFP.NUMREFP IS 'Numero.';
COMMENT ON    COLUMN    VDCLIREFP.COMPLREFP IS 'Complemento do endereo.';
COMMENT ON    COLUMN    VDCLIREFP.BAIRREFP IS 'Bairro.';
COMMENT ON    COLUMN    VDCLIREFP.CIDREFP IS 'Cidade.';
COMMENT ON    COLUMN    VDCLIREFP.UFREFP IS 'Estado.';
COMMENT ON    COLUMN    VDCLIREFP.CEPREFP IS 'Cep.';
COMMENT ON    COLUMN    VDCLIREFP.DDDREFP IS 'DDD.';
COMMENT ON    COLUMN    VDCLIREFP.FONEREFP IS 'Fone.';
COMMENT ON    COLUMN    VDCLIREFP.CODREFP IS 'Codigo da referencia.';
COMMENT ON TABLE        VDCLISOCIOS IS 'Socios da empresa cliente.';
COMMENT ON TABLE        VDCLITERRA IS 'Terras do cliente.';
COMMENT ON    COLUMN    VDCLITERRA.ENDTERRA IS 'Endereo da terra.';
COMMENT ON TABLE        VDCLIVEIC IS 'Veculos do cliente.';
COMMENT ON    COLUMN    VDCLIVEIC.PLACAVEIC IS 'Placa do veculo.';
COMMENT ON    COLUMN    VDCLIVEIC.MODELOVEIC IS 'Modelo do veculo.';
COMMENT ON    COLUMN    VDCLIVEIC.ALIENADOVEIC IS 'Indica se o veculo est alienado.';
COMMENT ON    COLUMN    VDCLIVEIC.ANOVEIC IS 'Ano de fabricao.';
COMMENT ON    COLUMN    VDCLIVEIC.VALORVEIC IS 'Valor do veculo.';
COMMENT ON    COLUMN    VDCOMISSAO.TIPOCOMI IS 'Tipo de comisso:
F-Valor gerado no faturamento
R-Valor gerado no recebimento
E-Valor gerado no estorno de contas a receber
';
COMMENT ON    COLUMN    VDCOMISSAO.DTCOMPCOMI IS 'Data de competncia.
';
COMMENT ON    COLUMN    VDCOMISSAO.STATUSCOMI IS 'Situao da comisso:
C1 - Em aberto
C2 - Liberada
CP - Paga';
COMMENT ON    COLUMN    VDCOMISSAO.CODEMPVD IS 'Cdigo da empresa do vendedor.';
COMMENT ON    COLUMN    VDCOMISSAO.CODFILIALVD IS 'Cdigo da filial do vendedor.';
COMMENT ON    COLUMN    VDCOMISSAO.CODVEND IS 'Cdigo do vendedor.';
COMMENT ON    COLUMN    VDCOMISSAO.CODEMPVE IS 'Cdigo da empresa da venda vinculada (comissionamento especial)';
COMMENT ON    COLUMN    VDCOMISSAO.CODFILIALVE IS 'Cdigo da filial da venda vinculada (comissionamento especial)';
COMMENT ON    COLUMN    VDCOMISSAO.CODVENDA IS 'Cdigo da venda (comissionamento especial)';
COMMENT ON    COLUMN    VDCOMISSAO.TIPOVENDA IS 'Tipo da venda';
COMMENT ON    COLUMN    VDCOMISSAO.EMMANUT IS 'Estado de manuteno (S/N).';
COMMENT ON TABLE        VDCONSIGNACAO IS 'Table de vendas consignadas';
COMMENT ON    COLUMN    VDCONSIGNACAO.DOCCONSIG IS 'Documento da consignao';
COMMENT ON    COLUMN    VDCONSIGNACAO.CODEMPSL IS 'Cdigo da empresa do sub-lanamento financeiro.';
COMMENT ON    COLUMN    VDCONSIGNACAO.CODFILIALSL IS 'Cdigo da filial do sub-lanamento financeiro.';
COMMENT ON    COLUMN    VDCONSIGNACAO.CODLANCA IS 'Cdigo do lanamento financeiro.';
COMMENT ON    COLUMN    VDCONSIGNACAO.CODSUBLANCA IS 'Cdigo do sub-lanamento financeiro.';
COMMENT ON    COLUMN    VDCONSIGNACAO.CODEMPSD IS 'Cdigo da empresa do sub-lanamento financeiro de devoluo.';
COMMENT ON    COLUMN    VDCONSIGNACAO.CODFILIALSD IS 'Cdigo da filial do sub-lanamento financeiro de devoluo.';
COMMENT ON    COLUMN    VDCONSIGNACAO.CODLANCASD IS 'Cdigo do lanamento financeiro de devoluo.';
COMMENT ON    COLUMN    VDCONSIGNACAO.CODSUBLANCASD IS 'Cdigo do sub-lanamento financeiro de devoluo.';
COMMENT ON TABLE        VDCONTRATO IS 'Tabela de contratos.';
COMMENT ON    COLUMN    VDCONTRATO.CODCONTR IS 'Cdigo do contrato.';
COMMENT ON    COLUMN    VDCONTRATO.DESCCONTR IS 'Descrio do contrato.';
COMMENT ON    COLUMN    VDCONTRATO.MINUTACONTR IS 'Minuta do contrato.';
COMMENT ON    COLUMN    VDCONTRATO.CODEMPCL IS 'Cdigo da empresa do cliente';
COMMENT ON    COLUMN    VDCONTRATO.CODFILIALCL IS 'Cdigo da filial do cliente.';
COMMENT ON    COLUMN    VDCONTRATO.CODCLI IS 'Cdigo do cliente.';
COMMENT ON    COLUMN    VDCONTRATO.DTINICIO IS 'Data de inicio de vigor do contrato.';
COMMENT ON    COLUMN    VDCONTRATO.DTFIM IS 'Data do fim do contrato.';
COMMENT ON    COLUMN    VDCONTRATO.TPCOBCONTR IS 'Tipo de cobrana do contrato:
"ME" - Contrato Mensal
"BI" - Contrato Bimestral
"AN" - Contrato Anual
"ES" - Contrato Espordico';
COMMENT ON    COLUMN    VDCONTRATO.DIAVENCCONTR IS 'Dia de vencimento da cobrana.';
COMMENT ON    COLUMN    VDCONTRATO.DIAFECHCONTR IS 'Dia do mes para fechamento das cobranas.';
COMMENT ON    COLUMN    VDCONTRATO.TPCONTR IS 'Indica se tem caractersticas de contrato ou de projeto.
"C" - Contrato;
"P" - Projeto;
"S" - Sub-projeto';
COMMENT ON    COLUMN    VDCONTRATO.SITCONTR IS 'Situao do contrato:
"PE" - Pendente
"PA" - Em planejamento
"PF" - Planejado
"EE" - Em execuo
"EX" - Executado
"PO" - Paralizado
"CC" - Canc. cliente
"CP" - Canc. prestador
"FN" - Finalizado';
COMMENT ON TABLE        VDETIQCLI IS '  tabela temporria para impresso de etiquetas de cliente.';
COMMENT ON    COLUMN    VDFRETEVD.ADICFRETEVD IS 'FLAG QUE INDICA SE ADICIONA O VALOR DO FRETE NA NOTA';
COMMENT ON    COLUMN    VDFRETEVD.ADICFRETEBASEICM IS 'Indica se deve adicionar o valor do frete na base de calculo do icms da venda.';
COMMENT ON    COLUMN    VDFRETEVD.VLRBASEICMSFRETEVD IS 'Base de calculo do icms do frete.';
COMMENT ON    COLUMN    VDFRETEVD.ALIQICMSFRETEVD IS 'Aliquota de icms incidente no frete.';
COMMENT ON    COLUMN    VDFRETEVD.VLRSEGFRETEVD IS 'Valor do seguro do frete.';
COMMENT ON TABLE        VDITCONTRATO IS 'Tabela de tens de contrato.';
COMMENT ON    COLUMN    VDITCONTRATO.DESCITCONTR IS 'Descrio do item de contrato';
COMMENT ON    COLUMN    VDITCONTRATO.CODEMPPD IS 'Cdigo da empresa do produto.';
COMMENT ON    COLUMN    VDITCONTRATO.CODFILIALPD IS 'Cdigo da filial do produto.';
COMMENT ON    COLUMN    VDITCONTRATO.CODPROD IS 'Cdigo do produto.';
COMMENT ON    COLUMN    VDITCONTRATO.QTDITCONTR IS 'Quantidade do produto no tem de contrato.';
COMMENT ON    COLUMN    VDITCONTRATO.VLRITCONTR IS 'Valor contratado para o produto.';
COMMENT ON    COLUMN    VDITCONTRATO.CODEMPPE IS 'Cdigo da empresa do produto excedente.';
COMMENT ON    COLUMN    VDITCONTRATO.CODFILIALPE IS 'Cdigo da filial do produto excedente.';
COMMENT ON    COLUMN    VDITCONTRATO.CODPRODPE IS 'Cdigo do produto excedente.';
COMMENT ON    COLUMN    VDITCONTRATO.VLRITCONTREXCED IS 'Valor cobrado por excedente  quantidade contratada.';
COMMENT ON    COLUMN    VDITCONTRATO.KEYLIC IS 'Chave de licenciamento do produto/contrato.';
COMMENT ON    COLUMN    VDITCONTRATO.FRANQUIAITCONTR IS 'Agregar quantidade ao valor da franquia (S/N).';
COMMENT ON TABLE        VDITCONTRATOAND IS 'Tabela para lanamento do andamento de execuo de um projeto.';
COMMENT ON    COLUMN    VDITCONTRATOAND.CODCONTR IS 'Cdigo do contrato.';
COMMENT ON    COLUMN    VDITCONTRATOAND.CODITCONTR IS 'Cdigo do tem de contrato.';
COMMENT ON    COLUMN    VDITCONTRATOAND.OBSAND IS 'Observao sobre o andamento do projeto.';
COMMENT ON    COLUMN    VDITCONTRATOAND.PERCAND IS 'Percentual de concluso do projeto.';
COMMENT ON    COLUMN    VDITCONTRATOAND.DATAAND IS 'Data do andamento.';
COMMENT ON    COLUMN    VDITCONTRATOAND.HORAAND IS 'Hora do andamento.';
COMMENT ON    COLUMN    VDITORCAMENTO.CODEMPAX IS 'Cdigo da empresa na tabela de almoxarifados.';
COMMENT ON    COLUMN    VDITORCAMENTO.CODFILIALAX IS 'Cdigo da filial na tabela de almoxarifados.';
COMMENT ON    COLUMN    VDITORCAMENTO.CODALMOX IS 'Cdigo do almoxarifado.';
COMMENT ON    COLUMN    VDITORCAMENTO.QTDAPROVITORC IS 'Quantidade aprovada.';
COMMENT ON    COLUMN    VDITORCAMENTO.STATUSITORC IS '"*"  - Oramento em aberto;
"OA" - Oramento em aberto;
"OC" - Oramento completo/impresso;
"OL" - Oramento liberado/aprovado;
"OV" - Oramento faturado.
"OP" - Oramento produzido.
"CA" - Oramento Cancelado/No Aprovado.';
COMMENT ON    COLUMN    VDITORCAMENTO.CODEMPPE IS 'Cdigo da empresa do prazo de entrega.';
COMMENT ON    COLUMN    VDITORCAMENTO.CODFILIALPE IS 'Cdigo da filial do prazo de entrega.';
COMMENT ON    COLUMN    VDITORCAMENTO.CODPE IS 'Cdigo do prazo de entrega.';
COMMENT ON    COLUMN    VDITORCAMENTO.DIASPE IS 'Prazo de entrega (em dias) no tem.';
COMMENT ON    COLUMN    VDITORCAMENTO.EMMANUT IS 'Flag para por a tabela em manutenao (S/N).';
COMMENT ON    COLUMN    VDITORCAMENTO.SITENTITORC IS 'Situao da entrega 
N - No entregue
E - Entregue
';
COMMENT ON    COLUMN    VDITORCAMENTO.SITTERMRITORC IS 'Situao do termo de recebimento.
E - Emitir
N - No emitir
O - Emitido';
COMMENT ON    COLUMN    VDITORCAMENTO.CANCITORC IS 'Flag de cancelamento S/N.';
COMMENT ON    COLUMN    VDITORCAMENTO.FATITORC IS 'Flag de faturamento S/N/P
(Sim, no, parcial)';
COMMENT ON    COLUMN    VDITORCAMENTO.VLRCOMISITORC IS 'Valor previsto de comisso no item de oramento.';
COMMENT ON    COLUMN    VDITORCAMENTO.PERCCOMISITORC IS 'Percentual previsto de comisso no item de oramento.';
COMMENT ON    COLUMN    VDITORCAMENTO.VLRFRETEITORC IS 'Valor previsto de frete por item do oramento.';
COMMENT ON    COLUMN    VDITORCAMENTO.DTAPROVITORC IS 'Data de aprovao do tem de oramento.';
COMMENT ON    COLUMN    VDITORCAMENTO.SITPRODITORC IS 'Situao da produo do tem de oramento.
PE - Pendente
EP - Em produo
NP - No produzir
PD - Produzido';
COMMENT ON    COLUMN    VDITREGRACOMIS.CODEMPVD IS 'Cdigo da empresa do vendedor.';
COMMENT ON    COLUMN    VDITREGRACOMIS.CODFILIALVD IS 'Cdigo da filial do vendedor ';
COMMENT ON    COLUMN    VDITREGRACOMIS.CODVEND IS 'Cdigo do vendedor.';
COMMENT ON    COLUMN    VDITVENDA.CODEMPAX IS 'Cdigo da empresa na tabela de almoxarifados.';
COMMENT ON    COLUMN    VDITVENDA.CODFILIALAX IS 'Cdigo da filial na tabela de almoxarifados.';
COMMENT ON    COLUMN    VDITVENDA.CODALMOX IS 'Cdigo do almoxarifado.';
COMMENT ON    COLUMN    VDITVENDA.QTDITVENDACANC IS 'Quantidade cancelada';
COMMENT ON    COLUMN    VDITVENDA.VLRBASEICMSBRUTITVENDA IS 'Base de clculo do ICMS sem reduo e outras alteraes.';
COMMENT ON    COLUMN    VDITVENDA.VLRBASEICMSSTITVENDA IS 'Valor da base de calculo do ICMS da substituio tributria.';
COMMENT ON    COLUMN    VDITVENDA.VLRICMSSTITVENDA IS 'Valor do ICMS da substituio tributria.';
COMMENT ON    COLUMN    VDITVENDA.VLRBASECOMISITVENDA IS 'Valor base para comissionamento
Qtd x Preco comissao (cad.prod.)';
COMMENT ON    COLUMN    VDITVENDA.MARGEMVLAGRITVENDA IS 'Margem de valor agregado para calculo da base de calculo do icms de substituio tributria.';
COMMENT ON    COLUMN    VDITVENDA.TIPOST IS 'Tipo de substituio tributria.';
COMMENT ON    COLUMN    VDITVENDA.CANCITVENDA IS 'Flag para marcar se o item foi cancelado.';
COMMENT ON    COLUMN    VDITVENDA.CODEMPPE IS 'Cdigo da empresa do prazo de entrega.';
COMMENT ON    COLUMN    VDITVENDA.CODFILIALPE IS 'Cdigo da filial do prazo de entrega.';
COMMENT ON    COLUMN    VDITVENDA.CODPE IS 'Cdigo do prazo de entrega.';
COMMENT ON    COLUMN    VDITVENDA.DIASPE IS 'Prazo de entrega (em dias) no tem.';
COMMENT ON    COLUMN    VDITVENDA.CODCONV IS 'Cdigo do conveniado';
COMMENT ON    COLUMN    VDITVENDA.CODEMPIF IS 'Cdigo da empresa do item de classificao fiscal (fk transitria, utilizada no trigger que carrega a tabela lfitvenda)';
COMMENT ON    COLUMN    VDITVENDA.CODFILIALIF IS 'Cdigo da filial do item de classificao fiscal (fk transitria, utilizada no trigger que carrega a tabela lfitvenda)';
COMMENT ON    COLUMN    VDITVENDA.CODFISC IS 'Cdigo da classificao fiscal (fk transitria, utilizada no trigger que carrega a tabela lfitvenda)';
COMMENT ON    COLUMN    VDITVENDA.CODITFISC IS 'Cdigo do tem de classificao fiscal (fk transitria, utilizada no trigger que carrega a tabela lfitvenda)';
COMMENT ON    COLUMN    VDITVENDA.CODEMPCP IS 'Cdigo da empresa da compra (devoluo)';
COMMENT ON    COLUMN    VDITVENDA.CODFILIALCP IS 'Cdigo da filial da compra (devoluo)';
COMMENT ON    COLUMN    VDITVENDA.CODCOMPRA IS 'Cdigo da compra (devoluo)';
COMMENT ON    COLUMN    VDITVENDA.CODITCOMPRA IS 'Cdigo do tem da compra (devoluo)';
COMMENT ON    COLUMN    VDITVENDA.CODEMPVR IS 'Cdigo da empresa do item da nota de remessa';
COMMENT ON    COLUMN    VDITVENDA.CODFILIALVR IS 'Cdigo da filial do item de nota de remessa';
COMMENT ON    COLUMN    VDITVENDA.TIPOVENDAVR IS 'Tipo da venda do item de nota de remessa';
COMMENT ON    COLUMN    VDITVENDA.CODVENDAVR IS 'Cdigo da venda do item de nota de remessa';
COMMENT ON    COLUMN    VDITVENDA.CODITVENDAVR IS 'Cdigo do item de nota de remessa';
COMMENT ON    COLUMN    VDITVENDA.CODEMPNS IS 'Cdigo da empresa do numero de serie';
COMMENT ON    COLUMN    VDITVENDA.CODFILIALNS IS 'Cdigo da filial do nmero de srie.';
COMMENT ON    COLUMN    VDITVENDA.NUMSERIETMP IS 'Campo para abrigar temporariamente o nmero de srie do produto (para uso do trigger quando produto for unitrio)';
COMMENT ON    COLUMN    VDITVENDA.VLRBASEICMSSTRETITVENDA IS 'Valor da base de calculo do icms st retido na opearao anterior.';
COMMENT ON    COLUMN    VDITVENDA.VLRICMSSTRETITVENDA IS 'Valor do icms st retido na operao anterior.
';
COMMENT ON    COLUMN    VDITVENDA.EMMANUT IS 'Flag para manuteno da tabela (S/N).';
COMMENT ON TABLE        VDITVENDASERIE IS 'Tabela de vinculo entre item de venda e seus respectivos numeros de serie.';
COMMENT ON    COLUMN    VDORCAMENTO.STATUSORC IS '"*"  - Oramento em aberto;
"OA" - Oramento em aberto;
"OC" - Oramento completo/impresso;
"OL" - Oramento liberado/aprovado;
"OV" - Oramento faturado.
"OP" - Oramento produzido.
"CA" - Oramento Cancelado/No Aprovado.';
COMMENT ON    COLUMN    VDORCAMENTO.EMMANUT IS 'Flag para por a tabela em manutenao (S/N).';
COMMENT ON    COLUMN    VDORCAMENTO.CODCLCOMIS IS 'CODIGO DA CLASSIFICAO DA COMISSO';
COMMENT ON    COLUMN    VDORCAMENTO.CODEMPTN IS 'Cdigo da empresa da transportadora.';
COMMENT ON    COLUMN    VDORCAMENTO.CODFILIALTN IS 'Cdigo da filial da transportadora.';
COMMENT ON    COLUMN    VDORCAMENTO.CODTRAN IS 'Cdigo da transportadora.';
COMMENT ON    COLUMN    VDORCAMENTO.TIPOFRETE IS 'C - CIF ; F - FOB';
COMMENT ON    COLUMN    VDORCAMENTO.ADICFRETE IS 'Indica se deve adicionar o valor do frete ao total dos produtos.';
COMMENT ON    COLUMN    VDORCAMENTO.VLRFRETEORC IS 'Valor previsto em despesa com frete.';
COMMENT ON    COLUMN    VDORCAMENTO.VLRCOMISORC IS 'Valor previsto de comisso no oramento.';
COMMENT ON    COLUMN    VDORCAMENTO.CODEMPTM IS 'Cdigo da empresa do tipo de movimento previsto para o faturamento do oramento.';
COMMENT ON    COLUMN    VDORCAMENTO.CODFILIALTM IS 'Cdigo da filial do tipo de movimento previsto para o faturamento do oramento.';
COMMENT ON    COLUMN    VDORCAMENTO.CODTIPOMOV IS 'Cdigo do tipo de movimento previsto para o faturamento do oramento.';
COMMENT ON    COLUMN    VDORCAMENTO.DTAPROVORC IS 'Data da aprovao do oramento.';
COMMENT ON    COLUMN    VDORCAMENTO.JUSTIFICCANCORC IS 'Justificativa pelo cancelamento do oramento.';
COMMENT ON    COLUMN    VDORCAMENTO.ACORC IS 'Indica o recebedor do oramento (Aos cuidados de)';
COMMENT ON TABLE        VDPRAZOENT IS 'Prazos de entrega.';
COMMENT ON    COLUMN    VDPRAZOENT.CODEMP IS 'Cdigo da empresa.';
COMMENT ON    COLUMN    VDPRAZOENT.CODFILIAL IS 'Cdigo da filial';
COMMENT ON    COLUMN    VDPRAZOENT.CODPE IS 'Cd. prazo de entrega.';
COMMENT ON    COLUMN    VDPRAZOENT.DESCPE IS 'Descrio do prazo de entrega';
COMMENT ON    COLUMN    VDPRAZOENT.DIASPE IS 'Nmero de dias para entrega.';
COMMENT ON    COLUMN    VDPRECOPROD.TIPOPRECOPROD IS 'Indica qual o tipo de preo que originrio.
B - Preo Base
I - Custo informado;
O - Outros;
';
COMMENT ON    COLUMN    VDPRECOPROD.DTALTPRECO IS 'Data da alterao do preo.
';
COMMENT ON    COLUMN    VDPRECOPROD.HALTPRECO IS 'Hora de alterao do preo.
';
COMMENT ON    COLUMN    VDPRECOPROD.PRECOANT IS 'Preo anterior  ltima alterao.
';
COMMENT ON    COLUMN    VDPRECOPROD.IDUSUALTPRECO IS 'Usurio que realizou a alterao no preo.
';
COMMENT ON TABLE        VDREGRACOMIS IS 'Regras de comisses';
COMMENT ON    COLUMN    VDREGRACOMIS.PERCCOMISGERAL IS 'Percentual de comisso para o grupo de comissionados (comissionamento especial por producao)';
COMMENT ON    COLUMN    VDREMCONSIG.CODREMCO IS 'Cdigo da remessa de consignao.';
COMMENT ON    COLUMN    VDREMCONSIG.CODPROD IS 'Cdigo do produto remetido.';
COMMENT ON    COLUMN    VDREMCONSIG.QTDSAIDA IS 'Quantidade remetida';
COMMENT ON    COLUMN    VDREMCONSIG.QTDDEVOL IS 'Quantidade devolvida.';
COMMENT ON    COLUMN    VDREMCONSIG.QTDTROCA IS 'Quantidade remetida para troca.';
COMMENT ON    COLUMN    VDREMCONSIG.QTDBONIF IS 'Quantidade remetida em bonificao.';
COMMENT ON    COLUMN    VDREMCONSIG.PRECO IS 'Preo do produto remetido.';
COMMENT ON TABLE        VDSETORROTA IS 'Tela de rotas baseada no setor dos clientes.';
COMMENT ON TABLE        VDTEF IS 'Tabela para vendas com TEF vinculado';
COMMENT ON TABLE        VDTIPOCLI IS 'Tipos de clientes.';
COMMENT ON    COLUMN    VDTIPOCLI.CHEQTIPOCLI IS 'Flag que indica se haver aba adicional no cadastro de clientes (cheque).';
COMMENT ON    COLUMN    VDTIPOCLI.FISTIPOCLI IS 'Flag que indica se haver aba adicional no cadastro de clientes (pessoa fsica).';
COMMENT ON    COLUMN    VDTIPOCLI.JURTIPOCLI IS 'Flag que indica se haver aba adicional no cadastro de clientes (pessoa jurdica).';
COMMENT ON    COLUMN    VDTIPOCLI.FILTIPOCLI IS 'Flag que indica se haver aba adicional no cadastro de clientes (Filiao).';
COMMENT ON    COLUMN    VDTIPOCLI.LOCTRABTIPOCLI IS 'Flag que indica se haver aba adicional no cadastro de clientes (local de trabalho).';
COMMENT ON    COLUMN    VDTIPOCLI.REFCOMLTIPOCLI IS 'Flag que indica se haver aba adicional no cadastro de clientes (Referncias comerciais).';
COMMENT ON    COLUMN    VDTIPOCLI.BANCTIPOCLI IS 'Flag que indica se haver aba adicional no cadastro de clientes (Dados bancrios).';
COMMENT ON    COLUMN    VDTIPOCLI.REFPESTIPOCLI IS 'Flag que indica se haver aba adicional no cadastro de clientes (referncias pessoais).';
COMMENT ON    COLUMN    VDTIPOCLI.CONJTIPOCLI IS 'Flag que indica se haver aba adicional no cadastro de clientes (dados do cnjuge jurdica).';
COMMENT ON    COLUMN    VDTIPOCLI.VEICTIPOCLI IS 'Flag que indica se haver aba adicional no cadastro de clientes (veculos).';
COMMENT ON    COLUMN    VDTIPOCLI.IMOVTIPOCLI IS 'Flag que indica se haver aba adicional no cadastro de clientes (imveis).';
COMMENT ON    COLUMN    VDTIPOCLI.TERRATIPOCLI IS 'Flag que indica se haver aba adicional no cadastro de clientes (terras).';
COMMENT ON    COLUMN    VDTIPOCLI.PESAUTCPTIPOCLI IS 'Flag para dados complementares (pessoa autorizada a comprar).';
COMMENT ON    COLUMN    VDTIPOCLI.AVALTIPOCLI IS 'Flag para dados complementares (avalista).';
COMMENT ON    COLUMN    VDTIPOCLI.SOCIOTIPOCLI IS 'Flag para dados complementares (scios).';
COMMENT ON    COLUMN    VDTIPOCLI.PRODRURALTIPOCLI IS 'Flag que indica se cliente  produtor rural.';
COMMENT ON    COLUMN    VDTIPOCLI.SIGLATIPOCLI IS 'Sigla ou abreviao da descrio do tipo de cliente (utilizado em alguns relatrios)';
COMMENT ON TABLE        VDTIPOVEND IS 'Tipos de comissionados.';
COMMENT ON TABLE        VDTRANSP IS 'Transportadoras.';
COMMENT ON    COLUMN    VDTRANSP.CPFTRAN IS 'CPF do transportador';
COMMENT ON    COLUMN    VDTRANSP.DDDFONETRAN IS 'DDD do telefone principal.';
COMMENT ON    COLUMN    VDTRANSP.DDDFAXTRAN IS 'DDD do Fax.';
COMMENT ON    COLUMN    VDTRANSP.DDDCELTRAN IS 'DDD do celular da transportadora.';
COMMENT ON    COLUMN    VDTRANSP.CODFILIALUC IS 'Cdigo na tabela de unificao de cdigos (SGUNIFCOD).';
COMMENT ON    COLUMN    VDTRANSP.CODFOR IS 'Correspondente na tabela de fornecedores.';
COMMENT ON    COLUMN    VDTRANSP.CONJUGETRAN IS 'Nome do conjuge do transportado (pessoa fsica)';
COMMENT ON    COLUMN    VDTRANSP.PLACATRAN IS 'Placa do veculo do transportador (pessoa fsica)';
COMMENT ON    COLUMN    VDTRANSP.NRODEPENDTRAN IS 'Nmero de dependentes do transportador (pessoa fsica)';
COMMENT ON    COLUMN    VDTRANSP.RGTRAN IS 'Nmero da Identidade.';
COMMENT ON    COLUMN    VDTRANSP.CODGPS IS 'Cdigo de pagamento do gps/inss.';
COMMENT ON    COLUMN    VDTRANSP.NROPISTRAN IS 'Nmero do PIS.';
COMMENT ON    COLUMN    VDTRANSP.OBSTRAN IS 'Observaes.';
COMMENT ON    COLUMN    VDTRANSP.EMAILNFETRAN IS 'Email para envio do XML da Nfe.';
COMMENT ON    COLUMN    VDVENDA.SUBTIPOVENDA IS 'Subtipo da venda - NF = Nota fiscal / NC = Nota complementar.';
COMMENT ON    COLUMN    VDVENDA.DTCOMPVENDA IS 'Data de competncia.';
COMMENT ON    COLUMN    VDVENDA.CALCICMSVENDA IS 'Indica se deve calcular o valor do ICMS na nota.';
COMMENT ON    COLUMN    VDVENDA.IMPICMSVENDA IS 'Indica se deve imprimir o valor do ICMS na nota.';
COMMENT ON    COLUMN    VDVENDA.CALCIPIVENDA IS 'Indica se deve calcular o valor do IPI na nota.';
COMMENT ON    COLUMN    VDVENDA.IMPIPIVENDA IS 'Indica se deve imprimir o valor do IPI na nota.';
COMMENT ON    COLUMN    VDVENDA.CALCISSVENDA IS 'Indica se deve calcular o valor do ISS na nota.';
COMMENT ON    COLUMN    VDVENDA.IMPIISSVENDA IS 'Indica se deve imprimir o valor do ISS na nota.';
COMMENT ON    COLUMN    VDVENDA.CALCPISVENDA IS 'Indica se deve calcular o valor do PIS na nota.';
COMMENT ON    COLUMN    VDVENDA.IMPPISVENDA IS 'Indica se deve imprimir o valor do PIS na nota.';
COMMENT ON    COLUMN    VDVENDA.CALCCOFINSVENDA IS 'Indica se deve calcular o valor do COFINS na nota.';
COMMENT ON    COLUMN    VDVENDA.IMPCOFINSVENDA IS 'Indica se deve imprimir o valor do COFINS na nota.';
COMMENT ON    COLUMN    VDVENDA.CALCIRVENDA IS 'Indica se deve calcular o valor do IR na nota.';
COMMENT ON    COLUMN    VDVENDA.IMPIRVENDA IS 'Indica se deve imprimir o valor do IR na nota.';
COMMENT ON    COLUMN    VDVENDA.CALCCSOCIALVENDA IS 'Indica se deve calcular o valor da CONTRIBUICAO SOCIAL na nota.';
COMMENT ON    COLUMN    VDVENDA.IMPCSOCIALVENDA IS 'Indica se deve imprimir o valor da CONTRIBUICAO SOCIAL na nota.';
COMMENT ON    COLUMN    VDVENDA.CODEMPCB IS 'Cdigo da empresa na tabela FNCARTCOB.';
COMMENT ON    COLUMN    VDVENDA.CODFILIALCB IS 'Cdigo da filial na tabela FNCARTCOB.';
COMMENT ON    COLUMN    VDVENDA.CODCARTCOB IS 'Cdigo da carteira de cobrana.';
COMMENT ON    COLUMN    VDVENDA.PEDCLIVENDA IS 'Nmero do pedido do cliente.';
COMMENT ON    COLUMN    VDVENDA.VLRICMSSTVENDA IS 'Valor do icms da substituio tributria.';
COMMENT ON    COLUMN    VDVENDA.VLRBASEICMSSTVENDA IS 'Valor da base de calculo do icms de substituio tributria.';
COMMENT ON    COLUMN    VDVENDA.EMMANUT IS 'Flag que indica se a tabela est em manuteno (S/N).';
COMMENT ON    COLUMN    VDVENDA.VLRICMSSIMPLES IS 'Valor do crdito de ICMS destacado na venda quando do enquadramento no simples.';
COMMENT ON    COLUMN    VDVENDA.PERCICMSSIMPLES IS 'Alquota do crdito de ICMS destacado na venda quando do enquadramento no simples.';
COMMENT ON    COLUMN    VDVENDA.VLRBASECOMIS IS 'Valor base para calculo das comisses especiais.';
COMMENT ON    COLUMN    VDVENDA.CHAVENFEVENDA IS 'Chave de acesso da nota fiscal eletrnica.';
COMMENT ON    COLUMN    VDVENDA.OBSREC IS 'Observao a ser repassada para a tabela fnreceber no trigger/procedure de insero.';
COMMENT ON    COLUMN    VDVENDA.INFCOMPL IS 'Informaes complementares da nota fiscal ( de interesse do fisco );';
COMMENT ON    COLUMN    VDVENDA.SITDOC IS 'Situao do documento fiscal:
00-Documento regular;
01-Documento regular expontneo;
02-Documento cancelado;
03-Documento cancelado expontneo
04-NFE Denegada;
05-NFE Numerao inutilizada;
06-Documento fiscal complementar;
07-Documento fiscal complementar expontneo;
08-Documento emitido com base em Regime Especial ou Norma Especfica;';
COMMENT ON    COLUMN    VDVENDA.OBSNFE IS 'Observacoes geradas na emissao da nfe.';
COMMENT ON    COLUMN    VDVENDA.DESCIPIVENDA IS 'Indica se o valor do IPI foi descontado no preo dos tens.
';
COMMENT ON    COLUMN    VDVENDA.CODEMPOP IS 'Cdigo da OP vinculada (remessa industrializao)
';
COMMENT ON    COLUMN    VDVENDA.CODFILIALOP IS 'Cdigo da filial da OP vinculada (remessa industrializao)
';
COMMENT ON    COLUMN    VDVENDA.SEQOP IS 'Cdigo da sequencia da OP vinculada (remessa industrializao)
';
COMMENT ON    COLUMN    VDVENDA.CODOP IS 'CCdigo da OP vinculada (remessa industrializao)
';
COMMENT ON    COLUMN    VDVENDA.MOTIVOCANCVENDA IS 'Motivo do cancelamento da venda.';
COMMENT ON    COLUMN    VDVENDACOMIS.TIPOVENDA IS 'Tipo de venda
O = Oramento
V = Venda
E = Vencda Ecf
';
COMMENT ON TABLE        VDVENDACONSIG IS 'Tabela de vendas em consignao.';
COMMENT ON    COLUMN    VDVENDACONSIG.CODCONSIG IS 'Cdigo da consignao.';
COMMENT ON    COLUMN    VDVENDACONSIG.CODVENDACO IS 'Cdigo da venda em consignao.';
COMMENT ON    COLUMN    VDVENDACONSIG.CODCLI IS 'Cdigo do cliente.';
COMMENT ON    COLUMN    VDVENDACONSIG.CODPROD IS 'Cdigo do produto.';
COMMENT ON    COLUMN    VDVENDACONSIG.PRECO IS 'Preo praticado.';
COMMENT ON    COLUMN    VDVENDACONSIG.PRECOVENDA IS 'Preo aplicado ao cliente.';
COMMENT ON    COLUMN    VDVENDACONSIG.QTDVENDACO IS 'Quantidade vendida.';
COMMENT ON    COLUMN    VDVENDACONSIG.QTDTROCA IS 'Quantidade trocada.';
COMMENT ON    COLUMN    VDVENDACONSIG.QTDBONIF IS 'Quantidade de bonificaes.';
COMMENT ON    COLUMN    VDVENDACONSIG.DESCONTO IS 'Desconto praticado.';
COMMENT ON    COLUMN    VDVENDACONSIG.RECEBIDO IS 'Flag indicador de recebido.';
COMMENT ON    COLUMN    VDVENDACONSIG.CODEMPVD IS 'Cdigo da empresa do item de venda';
COMMENT ON    COLUMN    VDVENDACONSIG.CODFILIALVD IS 'Cdigo da filial do item de venda.';
COMMENT ON    COLUMN    VDVENDACONSIG.TIPOVENDA IS 'Tipo da venda do item de venda.';
COMMENT ON    COLUMN    VDVENDACONSIG.CODVENDA IS 'Cdigo da venda do item de venda.';
COMMENT ON    COLUMN    VDVENDACONSIG.CODITVENDA IS 'Cdigo do item de venda.';
COMMENT ON    COLUMN    VDVENDACONSIG.CODEMPSL IS 'Cdigo da empresa do sub-lanamento financeiro.';
COMMENT ON    COLUMN    VDVENDACONSIG.CODFILIALSL IS 'Cdigo da filial do sub-lanamento financeiro.';
COMMENT ON    COLUMN    VDVENDACONSIG.CODLANCA IS 'Cdigo do lanamento financeiro.';
COMMENT ON    COLUMN    VDVENDACONSIG.CODSUBLANCA IS 'Cdigo do sub-lanamento financeiro.';
COMMENT ON    COLUMN    VDVENDACONSIG.CODEMPSC IS 'Cdigo da empresa do sub-lanamento financeiro de contra-partida.';
COMMENT ON    COLUMN    VDVENDACONSIG.CODFILIALSC IS 'Cdigo da filial do sub-lanamento financeiro de contra-partida.';
COMMENT ON    COLUMN    VDVENDACONSIG.CODLANCASC IS 'Cdigo do lanamento financeiro de contra-partida.';
COMMENT ON    COLUMN    VDVENDACONSIG.CODSUBLANCASC IS 'Cdigo do sub-lanamento financeiro de contra-partida.';
COMMENT ON    COLUMN    VDVENDEDOR.CODFORNVEND IS 'CODIGO DO VENDEDOR NO FORNECEDOR
';
COMMENT ON    COLUMN    VDVENDEDOR.CODFUNC IS 'Funcao/Cargo do comissionado.';
COMMENT ON    COLUMN    VDVENDEDOR.CODEMPFU IS 'Cdigo da empresa da funcao/cargo do vendedor.';
COMMENT ON    COLUMN    VDVENDEDOR.CODFILIALFU IS 'Cdigo da filial da funcao do comissionado.';
COMMENT ON    COLUMN    VDVENDEDOR.DDDFONEVEND IS 'DDD do telefone do vendedor.';
COMMENT ON    COLUMN    VDVENDEDOR.DDDFAXVEND IS 'DDD do fax do vendedor.';
COMMENT ON    COLUMN    VDVENDEDOR.DDDCELVEND IS 'DDD do celular do vendedor.';
COMMENT ON    COLUMN    VDVENDEDOR.SSPVEND IS 'Orgo de emisso do RG do vendedor.';
COMMENT ON    COLUMN    VDVENDEDOR.OBSVEND IS 'Observaes do vendedor.';
COMMENT ON    COLUMN    VDVENDEDOR.ATIVOCOMIS IS 'Indica se o comissionado esta ativo.';
COMMENT ON    COLUMN    VDVENDEDOR.CODEMPCA IS 'Cdigo da empresa da conta do vendedor.';
COMMENT ON    COLUMN    VDVENDEDOR.CODFILIALCA IS 'Cdigo da filial da conta do vendedor.';
COMMENT ON    COLUMN    VDVENDEDOR.NUMCONTA IS 'Numero da conta do vendedor.';
COMMENT ON    COLUMN    VDVENDEDOR.VLRABONO IS 'Valor do abono (utilizado nos relatrios de comissionamento pela produo.';
COMMENT ON    COLUMN    VDVENDEDOR.VLRDESCONTO IS 'Valor do desconto (utilizado nos relatrios de comissionamento pela produo.';
COMMENT ON    PARAMETER EQMOVPRODISP.SEQSUBPROD IS 'Sequencial do subproduto';
COMMENT ON    PARAMETER EQMOVPRODIUDSP.SEQSUBPROD IS 'Sequencial de subproduto';
COMMENT ON    PARAMETER FNADICRECEBERSP01.VLRRETENSAOISS IS 'Indica se deve ser realizada a retenso do tributo ISS (descontando do valor final do ttulo)';
COMMENT ON    PARAMETER LFBUSCAFISCALSP.CODEMPCF IS 'Cdigo da empresa do cliente ou fornecedor';
COMMENT ON    PARAMETER LFBUSCAFISCALSP.CODFILIALCF IS 'Cdigo da filial do cliente ou fornecedor';
COMMENT ON    PARAMETER LFBUSCAFISCALSP.CODCF IS 'Cdigo do cliente ou fornecedor';
COMMENT ON    PARAMETER LFBUSCAFISCALSP.TIPOBUSCA IS 'Indica se a busca  para VD venda ou CP compra';
COMMENT ON    PARAMETER LFBUSCAFISCALSP.CODEMPIFP IS 'Cdigo da empresa do item de classificao fiscal ';
COMMENT ON    PARAMETER LFBUSCAFISCALSP.CODFILIALIFP IS 'Cdigo da filial do tem de classificao fiscal';
COMMENT ON    PARAMETER LFBUSCAFISCALSP.CODFISCP IS 'Cdigo da classificao fiscal';
COMMENT ON    PARAMETER LFBUSCAFISCALSP.CODITFISCP IS 'Cdigo do tem de classficiao fiscal';
COMMENT ON PROCEDURE    LFBUSCAFISCALSP02 IS 'Procedure para busca de informaes fiscais de um tem de venda, utilizada para preencher dados da tabela lfitvenda.';
COMMENT ON PROCEDURE    LFBUSCAPREVTRIBORC IS 'Procedure para busca de previso de tributos incidentes em tem de oramento para calculo da previso de lucratividade.';
COMMENT ON PROCEDURE    PPCUSTOPRODSP IS 'Retorna o custo unitrio do produto';
COMMENT ON    PARAMETER PPGERAOP.TIPOPROCESS IS 'Tipo de processamento (D=Detalhado, A=Agrupado, C=Comum)';
COMMENT ON    PARAMETER PPGERAOP.CODEMPOP IS 'Cdigo da empresa da ordem de produo';
COMMENT ON    PARAMETER PPGERAOP.CODFILIALOP IS 'Cdigo da filial da ordem de produo';
COMMENT ON    PARAMETER PPGERAOP.CODOP IS 'Cdigo da ordem de produo';
COMMENT ON    PARAMETER PPGERAOP.SEQOP IS 'Sequencia da ordem de produo';
COMMENT ON    PARAMETER PPGERAOP.CODEMPPD IS 'Cdigo da empresa do produto';
COMMENT ON    PARAMETER PPGERAOP.CODFILIALPD IS 'Cdigo da filial do produto';
COMMENT ON    PARAMETER PPGERAOP.CODPROD IS 'Cdigo do produto';
COMMENT ON    PARAMETER PPGERAOP.CODEMPOC IS 'Cdigo da emrpesa do oramento';
COMMENT ON    PARAMETER PPGERAOP.CODFILIALOC IS 'Cdigo da filial do oramento';
COMMENT ON    PARAMETER PPGERAOP.CODORC IS 'Cdigo do oramento';
COMMENT ON    PARAMETER PPGERAOP.TIPOORC IS 'Tipo de oramento';
COMMENT ON    PARAMETER PPGERAOP.CODITORC IS 'Cdigo do tem de oramento';
COMMENT ON    PARAMETER PPGERAOP.QTDSUGPRODOP IS 'Quantidade sugerida para fabricao';
COMMENT ON    PARAMETER PPGERAOP.DTFABROP IS 'Data de fabricao';
COMMENT ON    PARAMETER PPGERAOP.SEQEST IS 'Sequncia da estrutura';
COMMENT ON    PARAMETER PPGERAOP.CODEMPET IS 'Cdigo da empresa da estao de trabalho';
COMMENT ON    PARAMETER PPGERAOP.CODFILIALET IS 'Cdigo da filial da estao de trabalho';
COMMENT ON    PARAMETER PPGERAOP.CODEST IS 'Cdigo da estao de trabalho';
COMMENT ON    PARAMETER PPGERAOP.AGRUPDATAAPROV IS 'Indica se o agrupamento  por data de aprovao';
COMMENT ON    PARAMETER PPGERAOP.AGRUPDTFABROP IS 'Indica se o agrupamento  por data de fabricao';
COMMENT ON    PARAMETER PPGERAOP.AGRUPCODCLI IS 'Indica se o agrupamento  por cdigo de cliente';
COMMENT ON    PARAMETER PPGERAOP.CODEMPCL IS 'Cdigo da empresa do cliente do lote processado';
COMMENT ON    PARAMETER PPGERAOP.CODFILIALCL IS 'Cdigo da filial do cliente do lote processado';
COMMENT ON    PARAMETER PPGERAOP.CODCLI IS 'Cdigo do cliente do lote processado';
COMMENT ON    PARAMETER PPGERAOP.DATAAPROV IS 'Data de aprovao do lote processado';
COMMENT ON    PARAMETER PPGERAOP.CODEMPCP IS 'Cdigo da empresa do item de compra (converso de produtos)';
COMMENT ON    PARAMETER PPGERAOP.CODFILIALCP IS 'Cdigo da filial do item de compra (converso de produtos)';
COMMENT ON    PARAMETER PPGERAOP.CODCOMPRA IS 'Cdigo da compra (converso de produtos)';
COMMENT ON    PARAMETER PPGERAOP.CODITCOMPRA IS 'Cdigo do item de compra (converso de produtos)';
COMMENT ON    PARAMETER PPGERAOP.JUSTFICQTDPROD IS 'Justificativa por divergencias na quantidade final (converso de produtos)';
COMMENT ON    PARAMETER PPGERAOP.CODEMPPDENTRADA IS 'Cdigo da empresa do produto de entrada (converso de produtos)';
COMMENT ON    PARAMETER PPGERAOP.CODFILIALPDENTRADA IS 'Cdigo da filial do produto de entrada (converso de produtos)';
COMMENT ON    PARAMETER PPGERAOP.CODPRODENTRADA IS 'Cdigo do produto de entrada (converso de produtos)';
COMMENT ON    PARAMETER PPGERAOP.QTDENTRADA IS 'Quantidade do produto de entrada (converso de produtos)';
COMMENT ON PROCEDURE    PPGERAOPCQ IS 'Procedure disparada aps a insero na tabela PPOP, realiza varredura na estrutura do produto, verificando as anlises necessrias
no controle de qualidade e gerando registros referentes ao controle de qualidade na tabela PPOPCQ.';
COMMENT ON    PARAMETER RHLISTACANDVAGASP.ICODVAGA IS 'Cdigo da vaga';
COMMENT ON    PARAMETER RHLISTACANDVAGASP.ICODFUNC IS 'Cdigo da funo';
COMMENT ON PROCEDURE    TKGERACAMPANHACTO IS 'Procedure para gerao de registros nas tabelas TKCAMPANHACTO e TKSITCAMP.';
COMMENT ON PROCEDURE    VDRETULTVDCLIPROD IS 'Procedure para relatrio de ultimas vendas por cliente/produto.';
